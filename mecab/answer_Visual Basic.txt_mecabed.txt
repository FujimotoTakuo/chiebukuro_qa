３ 回 連続 、 という 条件 が よく 判り ませ ん 。 A 列 の 2 行 目 , 3 行 目 と 値 を 入力 し 、 4 行 目 が 入力 さ れ た 時点 で ユーザー フォーム を 開き たい の でしょ う か ？ その 場合 、 ユーザー フォーム を 閉じ た 後 で 5 行 目 を 入力 し た 時点 で 、 再び 「 3 , 4 , 5 行 目 に 連続 し て 入力 し た 」 と 見なし て ユーザー フォーム を 開く の でしょ う か ？ それとも 一旦 ユーザー フォーム を 開い たら 「 連続 」 の カウント を リセット する の でしょ う か ？ また A 2 , A3 , B 3 , C3 , A 4 という 順 に 入力 し た 場合 は 3回 連続 と 見なす の でしょ う か ？ 
一 例 です 。 対象 シート の シート タブ 上 で 右クリック → コード の 表示 → サンプル コード を 貼り 付け て お 試し ください 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim r As Range Set Target = Inter sect ( Target , Range (" A1 : A1 00 ")) If Target Is Nothing Then Exit Sub For Each r In Target If r = 5 Then MsgBox r . Address ( 0 , 0 ) & " に 【 ５ 】 が 入力 さ れ まし た ！" End If Next End Sub 
有り がち な の は 、 ・ 必要 階層 数 だけ 再帰 呼出 で ループ 変数 を 複製 ・ 最初 から 必要 階層 数 だけ の ループ 変数 を 配列 持ち の 何れ か では 。 例 として 、 ２ 進数 ３ ( 複数 ) 桁 を ループ で 列挙 する コード を 挙げ て み ます 。 [ VBScript / VBA / VB . Net の 種別 が 不明 な ので VBScript で 記述 。 他は 高 機能 版 な ので 変換 可 ] '' http   :   // code pa d.o rg / n 0 aMREJ 8 # コード は 後述 # Main 01 で は 、 フツー に i , j , k の ３つ の ループ 変数 を 使っ て 三重 ループ を 組ん で い ます が 、 Main 02 で は 、 必要 回数 だけ 再帰 呼出 で ループ 変数   i   を ３つ 分   確保 し て 使っ て い ます 。 Main 03 で は 、 ループ 変数 配列 a (*) を 確保 し て a (*) を ループ 内 で カウントアップ 調整 し ます 。 正直 言え ば 再帰 型 は 書き 易く とも デバッグ 他 保守 が 面倒 に なり がち な ので 、 可能 なら 配列 型 で 書く こと を オススメ し ます 。 重複 ・ 非 重複 に 関わら ず 、 順列   列挙 で あれ ば 配列 型 で 多重 ループ を 駆使 せ ず に 記述 出来 ます 。 [ 別 言語コード から の 移植 版 で 少々 煩雑 です が ] '' http   :   // code pa d.o rg / wmhnNDt 3 # コード は 後述 # '' http   :   // code pa d.o rg / n 0 aMREJ 8 # ２ 進数 ３ 桁 を 列挙 # Option   Explicit Sub   Main 01   '' 直接 ３ 重 ループ ''    Dim   i ,   j ,   k ,   lc    For   i   =   0   To   1      For   j   =   0   To   1        For   k   =   0   To   1          lc   =   Array ( i ,   j ,   k )          WS cri pt. Echo ( Join ( lc ,   ","))        Next      Next    Next End   Sub Sub   Main 02 ( n ,   m ,   o )   '' 再帰 型 多重 ループ ''    Dim   i    If   n   <=   m   Then      WS cri pt. Echo ( Mid ( o ,   2 ))    Else      For   i   =   0   To   1        Call   Main 02 ( n ,   m   +   1 ,   o   &   ","   &   CStr ( i ))      Next    End   If End   Sub Sub   Main 03 ( n )   '' 非 再帰 型 多重 ループ ''    Dim   i ,   j ,   a ()    ReDim   a ( n   -   1 )    For   i   =   0   To   n   -   1      a ( i )   =   0    Next    i   =   0    Do   While   0   <=   i      WS cri pt. Echo ( Join ( a ,   ","))      i   =   n   -   1      Do   While   0   <=   i        a ( i )   =   a ( i )   +   1        If   2   <=   a ( i )   Then          a ( i )   =   0          i   =   i   -   1        Else          Exit   Do        End   If      Loop    Loop End   Sub Call   Main 01 WS cri pt. Echo ("--------") Call   Main 02 ( 3 ,   0 ,   "") WS cri pt. Echo ("--------") Call   Main 03 ( 3 ) '' http   :   // code pa d.o rg / wmhnNDt 3 #( 非 ) 重複順列 4 Π 2 , 4 Ｐ 2 を 列挙 # ' Option   Explicit Const   SS   =   1   '' 開始 番号 '' Sub   RP ( n ,   r )   '' 重複順列 n Π r ''    Dim   i ,   j ,   o ,   a ()    ReDim   a ( r   -   1 )    For   i   =   0   To   r   -   1      a ( i )   =   SS    Next    i   =   0    Do   While   0   <=   i      o   =   ""      For   j   =   0   To   r   -   1        If   0   <   j   Then   o   =   o   &   ",   "        o   =   o   &   CStr ( a ( j ))      Next      WS cri pt. Echo (o)      i   =   r   -   1      Do   While   0   <=   i        a ( i )   =   a ( i )   +   1        If   SS   +   n   <=   a ( i )   Then          a ( i )   =   SS          i   =   i   -   1        Else          Exit   Do        End   If      Loop    Loop End   Sub Sub   NP ( n ,   r )   '' 非 重複順列 nＰr ''    Dim   i ,   j ,   o ,   a ()    ReDim   a ( n   -   1 )    For   i   =   0   To   n   -   1      a ( i )   =   i   +   SS    Next    i   =   0    Do   While   0   <=   i      o   =   ""      For   j   =   0   To   r   -   1        If   0   <   j   Then   o   =   o   &   ",   "        o   =   o   &   CStr ( a ( j ))      Next      WS cri pt. Echo (o)      i   =   r   -   1      Do   While   0   <=   i   And   i   <   n        a ( i )   =   a ( i )   +   1        If   SS   +   n   <=   a ( i )   Then          i   =   i   -   1        Else          For   j   =   0   To   i   -   1            If   a ( i )   =   a ( j )   Then   Exit   For          Next          If   j   >=   i   Then            i   =   i   +   1            If   i   <   n   Then   a ( i )   =   SS   -   1          End   If        End   If      Loop    Loop End   Sub Call   RP ( 4 , 2 ) WS cri pt. Echo ("--------") Call   NP ( 4 , 2 ) 
下記 の サイト は いかが でしょ う か ？ http:// www . excel - excel . com / vbachair / step 1 - 7 . html その ほか 「 vba デバッグ 」 で ググる と 様々 な サイト が ヒット し ます ので 、 ご 自分 で 判り やすい サイト を 探し て み て 下さい 。 
Sub sample () With Range (" B 1 ") . Copy . End ( xlDown ). Offset ( 1 ). PasteSpecial xlPasteValues End With End Sub 
アルゴリズム の 基本 が 分かっ て い て 、 他 の 言語 を 知っ て いる 状態 なら ば 、 ネット で 調べれ ば 十分 かも しれ ませ ん 。 命令 の 置き換 えと 、 VBA に 特 化 し た 命令 を 調べる だけ で 済み ます から 。 しかし 、 何 も 下地 が ない 状態 で は 、 かえって 混乱 を 招き かね ませ ん 。 せっかく 教本 が ある の です から 、 まずは 全部 読ん で 、 試し て みる の が 良い と 思い ます 。 その後 で 、 扱い 慣れ た と 思っ たら 、 自分 で 適当 な 例題 を 定め て 作っ て み て ください 。 そこ まで 来れ ば 、 効率 良く ネット で 調べ られる と 思い ます 。 例題 です が 、 知恵袋 で 回答 を 試みる の も 一案 です よ 。 
表示 し ない の で は なく 、 更新 し ない の です 。 つまり 値 の 変更 が あっ て も ノー ケア です 。 何 か の 理由 で 変に なっ て も そのまま です 。 タイトルバー は おそらく 手 は ない と 思い ます 。 
「 retNum 」 は Class 側 で > Public retNum As Double と Public 宣言 し て ます が 「 chcount 」 は し て ませ ん ね 。 それ が 原因 かも しれ ませ ん 。 ただ 、 私 は VBA で Class を 作っ た こと ありません が 、 一般 的 な オブジェクト指向 として は Class 内 に Public 変数 を 持っ た 時 の 動作 について VBA で どの よう に 扱わ れる か 疑問 は あり ます 。 クラス 変数 として 扱わ れる の か 、 インスタンス 変数 として 扱わ れる の か 。 どちら でしょ う ？ また 、 インスタンス 変数 として 扱わ れる 場合 でも Property として メソッド （ 関数 ） 定義 を 行っ て アクセス する 方法 が ない の か 、 可能 なら その ほう が 作法 として 適し て い ない か 調べ た ほう が いい の で は ない でしょ う か 。 Public 変数 だ と 読み込み 専用 に でき ない と 思い ます 。 誤っ て 標準 モジュール 側 で 値 を 変更 する と バグ に つながる 可能性 も あり ます 。 実 経験 が ない ので 「 こう す べき 」 と は 申し上げ られ ませ ん が 、 少し 調べ られ た ほう が いい と 思い ます 。 
添付 図 の よう な こと を し たい 、 という の で あれ ば Range (" A3 : C " & Range (" D " & Rows . Count ). End ( xlUp ). Row ). FillDown です 。 
基本的 に は tac hy on_ takion さん の 方法 で 良い の です が 、 少し 工夫 が 必要 です 。 仮に 「 処理 を 実行 し たい フォルダ の 場所 」 を ThisWorkbook . Path と 同じ フォルダ に し た と し ます 。 その フォルダ に は Test 1 . csv と Test 2 . csv が 存在 する と し ます 。 最初 の 検索 で Test 1 . csv が ヒット し て out . csv が 作ら れ ます 。 次 の ファイル の 検索 で は Test 2 . csv が ヒット し て out . csv に 追記 さ れ て いき ます 。 ところが 次 の ファイル の 検索 で 「 out . csv 」 まで ヒット し て しまい 、 tac hy on_ takion さん の テスト で 発生 し た よう に 「 " out . csv " が 既に 開い て いる と 言う エラー 」 が 発生 し て しまい ます 。 そこで CSV ファイル を 読み ながら 書き出す の で は なく 、 CSV ファイル を Collection オブジェクト に 格納 し 、 CSV ファイル を 全部 読み 終え て から 、 一気に 保存 ファイル へ 書き出す 、 という 方法 を 採れ ば 、 この エラー を 回避 する こと が でき ます 。 
下記 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim InputFileFolder As String , OutputFilePath As Variant Dim FileName As String Dim fn 1 As Integer , fn 2 As Integer Dim data As String , buf As New Collection , i As Long Dim IsFirstFile As Boolean , IsFirstLine As Boolean ' 統合 対象 の フォルダ の 場所 を 問い合わせる With Application . FileDialog ( msoFileDialogFolderPicker ) . Title = " 統合 対象 フォルダ 選択 " If .S how = True Then InputFileFolder = .S electedItems ( 1 ) & "\" Else ' キャンセル ボタン が 押さ れ たら 何 も し ない Exit Sub End If End With ' 処理 終了 後 の 保存 先 と ファイル 名 を 問い合わせる OutputFilePath = Application . GetSaveAsFilename ( _ InitialFileName :=" test . csv ", FileFilter :=" CSV ファイル (*. csv ), *. csv ", Title :=" 保存 先 ファイル 選択 ") If VarType ( OutputFilePath ) = vbBoolean Then ' キャンセル ボタン が 押さ れ たら 何 も し ない Exit Sub End If ' 保存 ファイル が 存在 し たら 削除 し て おく On Error Resume Next If Dir ( OutputFilePath ) <> "" Then Kill OutputFilePath End If ' CSV ファイル を 検索 する FileName = Dir ( InputFileFolder & "*. csv ") IsFirstFile = True Do Until FileName = "" ' CSV ファイル を 開く fn 2 = FreeFile Open InputFileFolder & FileName For Input As # fn 2 ' CSV ファイル を １ 行 ずつ 読み込む IsFirstLine = True Do Until EOF ( fn 2 ) Line Input # fn 2 , data ' ２つ 目 以降 の ファイル の １ 行 目 は 出力 し ない If Not IsFirstFile And IsFirstLine Then Else buf . Add data End If IsFirstLine = False Loop ' CSV ファイル を 閉じる Close # fn 2 ' 次 の CSV ファイル を 検索 する FileName = Dir () IsFirstFile = False Loop ' 保存 ファイル を 開く fn 1 = FreeFile Open OutputFilePath For Output As # fn 1 ' 保存 ファイル に 書き出す For i = 1 To buf . Count Print # fn 1 , buf ( i ) Next i ' 保存 先 ファイル を 閉じる Close # fn 1 End Sub 
実行 し て 見 まし た 。 > 一番 右 の 予約 表 ( 月 ) シート の C 2 か もしくは > コピー し た 予約 表 ( 月 ) シート の C 2 の 値 を ひろっ て しまい ます 。 という 現象 は 再現 でき ませ ん ね 。 やっ て みる の なら dt = Sheets ( 1 ). Range (" C 2 ") ↓ dt = Sheets (" 予約 表 ( 月 )"). Range (" C 2 ") として み て どう な の か 試し て みる の が １つ の 手段 です か ね 。 
" C :\ Users \ Pc - User \ Desktop \【 請求書 】 1234 -（” Ｐ 5 ” ）. pdf " を " C :\ Users \ Pc - User \ Desktop \【 請求書 】 1234 -” & Range (" P5 "). Value & ". pdf " と し て 下さい 。 表現 が 紛らわしい の です が 、 店舗 コード に () は つか ない もの と し て い ます 。 
ken m on_ 01 さん 、 こんにちは。 以下 Application . FileDialog オブジェクト を 使用 し た 一 例 です 。 変数 を 追加 し ます 。 Dim fname 以下 の コード を ' CSV ファイル を 開く の コメント の 下 に 挿入 し ます 。 With Application . FileDialog ( msoFileDialogFilePicker ) . InitialFileName = ThisWorkbook . Path ’ デフォルト パス を 指定 する . Filters . Add " CSVfiles ", "*. csv ", 1 ' 対象 ファイル の 拡張子 を 指定 する . FilterIndex = 1 If .S how = True Then fname = .S electedItems ( 1 ) End With If fname ="" Then Exit Sub ファイル を 開く コード を 変数 使用 に 変更 し ます 。 Open fname For Input As # fn *** 他 、 GetOpenFileName メソッド を 使う 方法 も あり ます 。 fname = Application . GetOpenFilename (" CSV Files (*. csv ), *. csv ") If fname = False Then Exit Sub こちら は デフォルト パス を 指定 する パラメータ は ない ので 、 他の方法 で カレントディレクトリ を 変更 し ます 。 いかが でしょ う か ？ 
If A = 6 Then も 書か ず に 下記 の よう に すれ ば すっきり し ます 。 Dim A As Integer For A = 1 To 6 Worksheets (" Sheet 1 "). Cells ( A + 1 , 1 ) = A Next 
Sub 件数 表示 () Dim myCri Dim LR Dim my R1 , my R2 On Error Resume Next LR = Cells ( Rows . Count , 1 ). End ( xlUp ). Row Set my R1 = Cells ( 2 , " B "). Resize ( LR - 1 ) Set my R2 = Cells ( 2 , " D "). Resize ( LR - 1 ) myCri = ActiveSheet . AutoFilter . Filters ( 4 ). Criteria 1 If IsEmpty ( myCri ) = False Then MsgBox WorksheetFunction . CountIfs ( my R1 , "<>[?]", _ my R2 , myCri ) Else MsgBox WorksheetFunction . CountIfs ( my R1 , "<>[?]") End If End Sub - - - - - - - - - - - - - - - - - - - - ------------------------- 【 フィルタ 列 D 列 、 抽出 条件 は 一つ だけ ( Criteria 1 )】 と し ます 。 Countifs ( B 列 , B 列 の 条件 , D 列 , D 列 の フィルタ 条件 ) Countifs 関数 は 、 フィルタ の 状態 に 関係 なく 、 全 データ に対して 条件 を 満たす 件数 を カウント し ます 。 フィルター の 列 が 複数 だっ たり 、 Criteria 2 が 指定 し て ある 場合 でも countifs 関数 の 検索 範囲 、 検索 条件 を 増やせ ば できる と 思い ます 。 
C 2 : = INDEX ( B $2 : B $5 , MATCH ("*"& SUBSTITUTE ( TRIM ( ASC ( A 2 ))," ","")&"*", SUBSTITUTE ( TRIM ( ASC ( B $2 : B $5 ))," ",""), 0 )) 【 お断り 】 上 式 は 必ず 配列 数式 として 入力 の こと 
小数点 を 入力 さ せる の で あれ ば 下記 の コード で どうでしょう か ？ 小数点 ボタン を 「 Command Button 10 」 と 仮定 し て い ます 。 Private Sub CommandButton 10 _ Click () If InStr ( TextBox 1 . Text , ".") = 0 Then TextBox 1 . Text = TextBox 1 . Text + "." End If End Sub 
ワーク シート に 実行 用 の ボタン が 貼り 付け て ある 場合 は 、 ワーク シート の モジュール に コード が 書か れ て いる かも しれ ませ ん 。 その 場合 は 、 VBA の ソリューション エクスプローラ で ボタン が 貼り 付け て ある ワーク シート を 右クリック → コード の 表示 で シート モジュール が 表示 さ れ ます 。 もしくは Ctrl + F で 検索 ダイアログ を 表示 。 検索 する 文字列 に sub を 設定 、 検索対象 を カレント プロジェクト に 設定 し て 検索 する と プロシージャ が 次々 に 表示 さ れる ので 、 それ らしい プロシージャ を 探し ます 。 Sub graph () Sheets (" 01 "). Activate ActiveSheet . ChartObject (" gr ap h2 "). Activate ActiveChart . ChartArea . Copy Sheets (" 02 "). Activate ActiveSheet . ChartObject ( 1 ). Delete ' グラフ を 削除 する (" A3 "). Select ActiveSheet . Paste End Sub コード は 実行 し て い ない ので 、 エラー し たら ご 容赦 。 
Crystal Report の 経験 は ありません が 、 FindWindow で ズーム ダイアログ の ウィンドウ ハンドル を 取得 。 SetParent で ズーム ダイアログ を 強制的 に ３ の 子 ウィンド に し て しまう 、 と か 。 
下記 の コード でいか が でしょ う か 。 新しい ブック を 作成 し 、 その ブック の Sheet 1 に 複数 の CSV ファイル の 11 行 目 以降 を コピー し ます 。 Option Explicit Sub Sample () Dim bkSrc As Workbook , stSrc As Worksheet Dim bkDst As Workbook , stDst As Worksheet Dim rDst As Long Dim fPath As String , fName As String ' CSV ファイル 読み込み 先 の フォルダ を 選択 する With Application . FileDialog ( msoFileDialogFolderPicker ) If .S how = False Then Exit Sub fPath = .S electedItems ( 1 ) End With ' エクセル の 再 描画 を 一時停止 する Application .S creenUpdating = False ' 新しい ブック を 作成 する Set bkDst = Workbooks . Add Set stDst = bkDst . Worksheets (" Sheet 1 ") ' 選択 さ れ た フォルダ の すべて の CSV ファイル を 検索 する fName = Dir ( fPath & "\*. csv ") Do While fName <> "" ' CSV ファイル を Excel で 開く Set bkSrc = Workbooks . Open ( fPath & "\" & fName ) Set stSrc = bkSrc . Worksheets ( 1 ) ' Sheet 1 の コピー 先 を 設定 する rDst = stDst . Range (" A " & Rows . Count ). End ( xlUp ). Row If rDst > 1 Then rDst = rDst + 1 ' 11 行 目 から 最終 行 まで を Sheet 1 に コピー する stSrc . Range (" 11 :" & stSrc . UsedRange . Rows . Count ). Copy stDst . Range (" A " & rDst ) ' CSV ファイル を 閉じる bkSrc . Close False ' 次 の CSV ファイル を 検索 する fName = Dir Loop ' エクセル の 再 描画 を 再開 する Application .S creenUpdating = False End Sub 
再帰 、 ファイル 一覧 で 検索 し て ください 。 
以下 で どう なり ます か 確認 は 、 新規 ファイル の 標準 モジュール に 以下 を 転記 し て DATA シート を 作っ て から 確認 用 データ 作成 testData を 実行 し Samp 1 を 実行 し て み ます やっ て いる こと は Dictionary を 使用 し 、 キー に は DATA シート 以外 の シート 名 を ････ 関連 する 値 部分 に は 次 の 書き出し 位置 を 覚え て おき ます 後 は 、 A 列 の 名前 を Dictionary に 覚え て い たら シート は ある 無かっ たら 、 シート を 追加 し て 、 １ 行 目 の 項目 部分 を コピー し て ･･･ 次 の 書き出し 位置 に A 2 を 覚え て ････ A 列 を 除い た 範囲 の 行 を コピー し 、 次 の 書き出し 位置 を 更新 ･･･ ※ Current Region から 処理 範囲 を 求め て いる ので 、 B ～ E 列 が B ～ F 列 に なっ て も 変更 は 不要 か と ･･･ ※ A 列 の 名前 を シート 名 に し て いる だけ な ので 、 シート 名 に 使え ない 文字 とか 入っ て いれ ば ･･･ エラー で 止まる と 思い ます Option Explicit Public Sub Samp 1 ()     Dim dic As Object     Dim ws As Worksheet     Dim vA As Variant     Dim i As Long     Set dic = CreateObject (" Scripting . Dictionary ")     Application .S creenUpdating = False     With Worksheets (" DATA ")        For Each ws In Worksheets           If ( ws . Name <> . Name ) Then              dic . Add ws . Name _                    , ws . Cells ( Rows . Count , " A "). End ( xlUp ). Offset ( 1 )           End If        Next        With . Range (" A1 "). Current Region           vA = . Columns ( 1 ). Value           With . Offset (, 1 ). Resize (, . Columns . Count - 1 )              For i = 2 To UBound ( vA )                 If ( Not dic . Exists ( vA ( i , 1 ))) Then                    Set ws = Worksheets . Add ( After := Worksheets ( dic . Count + 1 ))                    ws . Name = vA ( i , 1 )                    . Rows ( 1 ). Copy ws . Range (" A1 ")                    dic . Add ws . Name , ws . Range (" A 2 ")                 End If                 . Rows ( i ). Copy dic ( vA ( i , 1 ))                 Set dic ( vA ( i , 1 )) = dic ( vA ( i , 1 )). Offset ( 1 )              Next           End With        End With        . Activate     End With     Application .S creenUpdating = True     Set dic = Nothing End Sub ' 確認 用 データ 作成 Public Sub testData ()     Dim vC As Variant , v As Variant     Dim i As Long , j As Long     Const CRH As Long = 1000     vC = Array ( _           Array (" りんご ", " 果物 A "), Array (" バナナ ", " 果物 B "), _           Array (" 時計 ", " 小物 A "), Array (" ネクタイ ", " 小物 B "), _           Array (" 車 ", " 大物 "), Array (" 家 ", " 超 大物 ") _        )     Randomize     Application .S creenUpdating = False     With Worksheets (" DATA ")        . Cells . Delete        . Cells ( 1 , " A "). Resize (, 5 ). Value = _           Array (" 名前 ", " 区分 ", " 原価 ", " 在庫 ", " 原価 ")        For i = 2 To CRH           v = vC ( Int (( UBound ( vC ) + 1 ) * Rnd ()))           . Cells ( i , " A "). Resize (, 5 ). Value = _              Array ( v ( 0 ), v ( 1 ) _                 , ( Int ( 99 * Rnd ()) + 1 ) * 100 _                 , Int ( 99 * Rnd ()) + 1 _                 , ( Int ( 99 * Rnd ()) + 1 ) * 100 )        Next        . Columns . AutoFit     End With     Application .S creenUpdating = True End Sub 
Sub Macro 1 () Sheets (" Sheet 1 "). activate ActiveSheet . ChartObjects ( 1 ). Activate ActiveChart . ChartArea . Copy Sheets (" Sheet 2 "). Activate Range (" A1 "). Select ActiveSheet . Paste End Sub 他人 の マクロ は 置い とい て 、 目 の 前 に ある グラフ を シート ２ に コピー し ます 。 グラフ が １ 個 しか 無い なら 、 これ で 対応 出来る 筈 です 。 ただし 、 シート ２ に コピー し て も 元 データ は 変わり ませ ん 。 
Sub 一 例 です () Dim rng As Range , rngs As Range For Each rng In Range (" B 1 ", Cells ( Rows . Count , 2 ). End ( xlUp )) With rng If . Value Like "@*" Then If rngs Is Nothing Then Set rngs = . Cells Else Set rngs = Union ( rngs , . Cells ) End If End If End With Next rng If Not rngs Is Nothing Then rngs . EntireRow . Delete End If End Sub 
似 て いる と 言え ば 似 て ます けど 。 。 VB だ と こちら で 無料 版 を 使っ て みる の は どう です か ね 。 https :// www . visualstudio . com / products / vs - 2015 - product - editions 
Sub sample Ⅱ () Dim sh As Worksheet , xAry , i , xMsg As String If MsgBox (" すべて の シート 名 を A1 セル の 値 に し ます か ？", vbOKCancel ) = vbCancel Then Exit Sub xAry = Array (" Sheet 1 ", " Sheet 3 ") '★ For Each sh In Worksheets With sh i = Application . Match (. Name , xAry , 0 ) If IsError ( i ) Then On Error Resume Next . Name = . Range (" A1 "). Value If Err . Number <> 0 Then xMsg = xMsg & vbLf & . Name End If End With Next sh If xMsg <> "" Then MsgBox " 以下 の シート を 処理 中 に エラー が 発生 し まし た " & xMsg End Sub 
次 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim area As Range Dim rng As Range Dim fa As String ' 検索 範囲 を A 2 から A 列 の 最終 行 に 設定 する Set area = Range (" A 2 : A " & Range (" A " & Rows . Count ). End ( xlUp ). Row ) ' 検索 範囲 の 右 ２つ 分 の セル を 一旦 クリア する For Each rng In area rng . Offset (, 1 ). Resize (, 2 ). ClearContents Next rng ' 検索 範囲 から F1 1 に 一致 する セル を 検索 する Set rng = area . Find ( Range (" F1 1 "). Value ) ' 該当 する セル が 存在 し た とき If Not rng Is Nothing Then fa = rng . Address Do ' １つ 右 の セル に G11 の 内容 を コピー する rng . Offset (, 1 ). Value = Range (" G11 ") ' ２つ 右 の セル に H1 1 の 内容 を コピー する rng . Offset (, 2 ). Value = Range (" h1 1 ") ' 次に 一致 する セル を 検索 する Set rng = area . FindNext ( rng ) ' 一致 する セル が なくなる か 、 最初 に 一致 し た セル に なる まで 繰り返す Loop While Not rng Is Nothing And rng . Address <> fa End If End Sub 
ListBox 1 の ソース は シート でしょ う か 、 データ を 書き込ん で いる ん でしょ う か ？ シート が データソース ( RowSource ) が 設定 さ れ て いる なら 、 シート が 更新 さ れ たら 再 計算 の タイミング で 更新 さ れる はず です 。 コード の 進行 で application . Calculation = xlCalculationManual が あっ た なら Application . Calculate を 入れ て み て は いかが でしょ う か 。 ちなみに 、 提示 さ れ て いる コード は 何 を どう し たい か 全く わかり ませ ん 。 コード 左端 を クリック し て ● を つけ て コード を ブレーク し て F8 キー で ステップ 実行 し て 変数 に 何 が 入っ て 何 が 起こっ て いる か 観察 し て 考え て ください 。 
ヘルプ の バージョン 情報 から 。 http:// homepage 1 . nifty . com / rucio / main / kiso / Version . htm 
こんにちは。 変数 に 、 正しく 値 が 入っ て いる の か 、 再度 チェック し て ください 。 ubound と 、 for next で msgbox だし て ください 。 データ の チェック です が 、 i と j です か ？ 要素 1 なら 、 それぞれ の チェック 、 要素 2 の チェック と 、 ループ 1回 で 、 チェック する 気 が する の です けど 。 
maruc _ yh さん 、 こんにちは。 先 に ブック を 作成 し て から シート を コピー する と 、 どうしても 余分 な シート が でき て しまい ます 。 Worksheet . Copy メソッド で は 、 引数 before , after を 両方 省略 する と 、 自動的 に 新しい ブック を 生成 し て 、 そこ に コピー し たい シート だけ を 作成 し て くれる ので 、 Workbooks . Add st . Copy Before := ActiveWorkbook .S heets ( 1 ) を st . Copy だけ に すれ ば よい と 思い ます 。 
> CELL に 代入 する 行 を 入れる と これ の 意味 が 分かり ませ ん が 、 とりあえず 正常 動作 の よう に 見え ます 。 Exit For さ れ て おり 、 プロシージャ は 途中 終了 せ ず 最後 まで 進み ます 。 途中 で i , j の 値 を 見 たい よう です が 、 msgbox i & ", " & j と する と いい ですよ。 
"*" の 文字 自体 を 検索 する 場合 、 "[]" で 囲む 必要 が あり ます 。 次 の よう に 修正 し て ください 。 "***" -> "*[*]*" 
A 列 が 順番 に ならん で い ない ん です ね ？ Sub sample () Dim xDic , AP , xKey As String , i As Long Set xDic = CreateObject (" Scripting . Dictionary ") Set AP = Application For i = 1 To Cells ( Rows . Count , 1 ). End ( xlUp ) xKey = Join ( AP . Transpose ( AP . Transpose ( Cells ( i , 1 ). Resize (, 4 ). Value )), "/") If Not xDic . Exists ( xKey ) Then xDic . Add xKey , xKey Else Cells ( i , 2 ). Resize (, 3 ). ClearContents End If Next i End Sub 
WebBrowser に は 、 PictureBox の MouseMove の よう に コントロール 内 で の マウス の 動き を 検知 する イベント が 用意 さ れ て い ない ので 、 出来 ませ ん 。 Windows の 内部 動作 に 相当 詳しけれ ば 手段 は ある の です が 、 そう 簡単 に 習得 できる 技術 で は あり ませ ん ので 。 
たぶん PHP から twitter API を 使っ て 取得 し て いる ん です か ね ？ なら 、 user _ id や screen _ name 等 々 取得 でき ます よ 。 ぐぐ れ ば 色々 資料 が 出 て き ます 。 頑張っ て ください 。 
テスト し て ませ ん Private Sub コマンド 0 _ Click () Dim fDialog As Object Dim Rst As DAO . Recordset Dim file As String Set fDialog = Application . FileDialog ( 3 ) fDialog . InitialFileName = " 指定 の パス " fDialog .S how for each file in fDialog .S electedItems DoCmd . TransferText acImportDelim , " 新しい テキスト ドキュメント インポート 定義 ", " T 1 ", file , False Next End Sub 
バフッ と し た 説明 で 良い です か D 列 E 列 D0 01 AAA D0 01 BBB D0 01 AAA という データ が あっ た 時 Dictionary に は 、 D0 01 を キー 、 初め に 出現 し た AAA を 値 として 覚える 同じ キー が 出現 し た 時 に は 、 覚え て い た 値 と 比較 し 、 違っ たら 、 E 列 部分 から D0 01 を 探し て １ 巡 する まで 色 を 付ける まわる 誤動作 は し ない と 思い ます が 、 以下 データ なら D 列 E 列 D0 01 AAA D0 01 BBB D0 01 BBB D0 01 CCC D0 01 AAA ２ 行 目 データ で 色付け １ 巡 し て いる ので 、 ３ 行 目 以降 で 同じ 処理 を 繰り返す の は 無駄 この 処理 で 満足 なら 以下 スルー で また 、 多く て も 重複 する もの は １つ ･･･ なら スルー で Dictionary が 使える の なら 、 Dictionary を ２ 段 構成 に する とか ･･･ 以下 は ２ 段 構成 に し て 、 １ 段 目 キー ： D 列 の 値 ２ 段 目 キー ： E 列 の 値 関連 する 値 部分 に は 、 出現 し た 行番号 を 空白 区切り で Dictionary に １ 巡 覚え たら 、 １ 段 目 キー で ループ しながら ２ 段 目 の キー 数 が > 1 なら 、 E 列 の 値 は 複数 ある ので 、 覚え て い た 値 （ 行番号 ） を Split 展開 し て 個々 の 行番号 に 展開 し ながら 色付け ･･･ 無駄 に 繰り返す 処理 は 無くなっ た と 思い ます Option Explicit Public Sub Samp 1 ()     Dim dic As Object     Dim vA As Variant , vK As Variant , v As Variant     Dim i As Long     Const CSEP As String = " "     Set dic = CreateObject (" Scripting . Dictionary ")     With Range (" D4 ", Cells ( Rows . Count , " D "). End ( xlUp ))        vA = . Resize (, 2 ). Value        For i = 1 To UBound ( vA )           If ( vA ( i , 1 ) <> "") Then              If ( Not dic . Exists ( vA ( i , 1 ))) Then                 dic . Add vA ( i , 1 ), CreateObject (" Scripting . Dictionary ")              End If              dic ( vA ( i , 1 ))( vA ( i , 2 )) = _                    dic ( vA ( i , 1 ))( vA ( i , 2 )) & CSEP & i           End If        Next        Application .S creenUpdating = False        . Interior . Color Index = xlNone        For Each vK In dic . Keys           If ( dic ( vK ). Count > 1 ) Then              For Each vA In dic ( vK ). Items                 For Each v In Split ( Trim ( vA ), CSEP )                    . Cells ( v , 1 ). Interior . Color Index = 38                 Next              Next           End If        Next        Application .S creenUpdating = True     End With     Set dic = Nothing End Sub ' 確認 用 簡易 データ 作成 Public Sub testData ()     Dim r As Range     Dim i As Long , j As Long     Const CRH As Long = 35     Randomize     Application .S creenUpdating = False     Cells . Delete     For Each r In Range (" D1 : E 1 "). Resize ( CRH )        If ( r . Row >= 10 ) Then           If ( Rnd () > 0 . 5 ) Then              If ( r . Column = Range (" D1 "). Column ) Then                 i = Int ( r . Row * Rnd ())                 j = i                 r . Value = r . Offset (- i ). Address ( False , False )              Else                 i = Int ( r . Row * Rnd ())                 If ( Rnd () > 0 . 5 ) Then i = j                 r . Value = r . Offset (- i ). Address ( False , False )              End If           Else              r . Value = r . Address ( False , False )           End If        Else           r . Value = r . Address ( False , False )        End If     Next     Columns . AutoFit     Application .S creenUpdating = True End Sub 
= F1 & "-" & H1 & ( R1 * 10 ) A1 に ↑ の 式 を 入れ て 、 B 列 に コピペ する と = G1 & "-" & I 1 & ( S1 * 10 ) この よう に 、 列 参照 が 相対的 に 一つ ずれ ます 。 - - - - - - - - - - - - - - - - - ------------------------- Sub A 列 関数 を 下 まで コピー _ 相対 参照 () Range (" A1 "). Formula = "= F1 & ""-"" & H1 & ( R1 * 10 )" Range (" A1 "). Copy _ Destination := Range (" A1 ", Range (" A " & Rows . Count ). End ( xlUp )). Offset (, 1 ) End Sub - - - - - - - - - - - - - - - - - ------------------------- =$ F1 & "-" & $ H1 & ($ R1 * 10 ) 数式 を 絶対 参照 に する 場合 は 下記 の コード に なり ます 。 - - - - - - - - - - - - - - - - - ------------------------- Sub A 列 関数 を 下 まで コピー _ 絶対 参照 () Range (" A1 "). Formula = "=$ F1 & ""-"" & $ H1 & ($ R1 * 10 )" Range (" A1 "). Copy _ Destination := Range (" A1 ", Range (" A " & Rows . Count ). End ( xlUp )). Offset (, 1 ) End Sub 
お 示し に なっ た ２つ の プログラム と 、 質問 内容 と の 関係 が 解り ませ ん が 、 ↓ の よう な 例文 で よい の でしょ う か ？ Sub sample () Dim sh As Worksheet For Each sh In Worksheets With sh . Name = . Range (" A1 "). Value End With Next sh End Sub 
.NET です か ？ 実は 、 とっても 簡単 な ん です 。 追加 で 、 モジュール を 追加 し ます 。 そして 、 Module Module 1 Public Foo As Integer End Module なんて 書く と 、 プログラム の 何処 から でも 、 Module 1 . Foo で 読み書き でき ます 。 
こんち に は 。 テスト し たい ので 、 呼び出す ほう の コード な ん です が 、 web に あっ た サンプル だ と function openChild () { var obj = { text 1 : document . all . text 1 . value , tex t2 : document . all . tex t2 . value }; rtn = window .s howModalDialog ( " child . html ", obj , " dialogHeight : 200 px ; dialogWidth : 400 px ;"); document . getElementById (" res "). innerHTML = rtn ; } --> </ script > < body > < input type =" button " value =" window を 起動 し ます " onclick =" openChild ();">< br /> という ぶぶん で 、 変数 obj に {} 記号 で 、 配列 要素 を わたし て 、 child . html で は 、 window . dialogArguments として 、 受け取っ て い まし た 主 様 の 場合 は 、 「 文字列 」 として 渡し た よう な ん です が 、 この 場合 、 「 テスト 専用 の ファイル 」 を 作成 し た ほう が 、 いい です ね 。 そっち の アプローチ を し て み て ください 
考え方 は 同じ です 。 Sub Macro 3 結果 の 右 ズラ し () Dim i As Long Application .S creenUpdating = False For i = 15 To 6455 Step 280 Cells ( i , " AF "). Resize ( 12 ). Value = Cells ( i , " AA "). Resize ( 12 ). Value Cells ( i , " AA "). Resize ( 12 ). Value = "" Next i Application .S creenUpdating = True End Sub やっ て み て ください 。 。 
ActiveWindow .S mallScroll Down := 282 ActiveWindow .S mallScroll Down := 276 ↓ これ は 、 シート の スクロール な ので 処理 に 影響 ない と 思い ます 。 すべて 消去 し て み て 。 。 処理 中 に 画面 が 上下 に 動い て い た でしょ う 。 この 動き を 止める の が Application .S creenUpdating = False kkyy 5223 さん の 仰る とおり Range (" AA 10 "). Cut Range (" AB 10 "). Select ActiveSheet . Paste の よう に する と 良い と 思う けど 、 、 もし 、 AA 10 → AB 10 という 移動 を 280 行 ごと に する だけ なら 、 Sub Macro 1日 付 を 右 に ズラ す () Dim i As Long Application .S creenUpdating = False For i = 10 To 6450 Step 280 Cells ( i , " AB ") = Cells ( i , " AA ") Cells ( i , " AA ") = "" Next i Application .S creenUpdating = True End Sub これ だけ で 終わっ ちゃう よ 。 。 サンプル 作っ て 、 これ だけ 動作 さ せ て み たら … 
Dim WB 1 As Workbooks , Wb 2 As Workbooks を Dim WB 1 As Workbook , Wb 2 As Workbook として み て ください 。 
コード だけ とか フォーム の 画像 だけ で は 関連性 が 掴み にくい と 思う よ 必要 な の は 回答者 が 再現 する ため の 情報 だ けど 、 そもそも 質問者 さん が 混乱 し て いる なら プロジェクト 毎 頼む の も 良い かも しれ ない → 有償 ・ 無償 で 色んな 依頼 先 が ある けど せめて 画像 の どの コントロール が コード の どの コントロール に なる の か 、 画像 に 書き込む って の も ある よ 
◆ 入力 し た 情報 を きっちり セル 内 に 収める 方法 該当 する セル 範囲 を 選択 し 、 Ctrl ＋ 1 で [ セル の 書式 設定 ] ダイアログ を 表示 し ます 。 [ 配置 ] タブ を 選択 し 、 □ 縮小 し て 全体 を 表示 する に チェック を 入れ て OK し ます 。 これ で 、 セル 内 に 収まる よう Excel が フォント サイズ を 自動 調整 し て くれ ます 。 
やっ て みる 価値 は あり ます が 、 使い物 に なる か どう か は わかり ませ ん 。 access 2010 SharePoint リスト ADO 接続 http:// mukkumuku . blogspot . com / 2011 / 04 / access 2010 - sharepoint - ado . htm ... Access アプリ から SharePoint リスト へ 接続 http:// nanbo . org / accesssplist / Access ： SharePoint リスト の リンク - 1 - http:// nanbo . org / access - lt s1 / 
ユーザー フォーム を 使う 方法 が 見つかり まし た ので 回答 し ます 。 字数 が オーバー し ます ので 前 の 回答 を 取り消し と し まし た 。 新旧 対 の 二つ の ブック と 抽出 先 の ブック の ３つ の ブック を 扱う こと に し ます 。 新旧 対 の 二つ の ブック は ダイアログボックス で 任意 に 選ぶ こと が でき ます 。 抽出 先 の ブック の シート １ の ７ 行 目 から 下 に 抽出 さ れ た データ を 置き 、 この マクロ を 動かす ボタン を シート １ に 作り ます 。 シート ２ に は 作業 領域 が あり ます 。 ユーザー フォーム も 作り ます 。 ユーザー フォーム によって シート と 管理番号 を 指定 し て い ます 。 複数 の シート の うち どれ を 使う か を 名称 で なく 、 シート 番号 で 選ぶ こと に し て い ます 。 ユーザー フォーム に シート 番号 と 管理番号 を 書き込ん だ 後 、 コマンド ボタン を 押す と 、 条件 に 一致 し た データ が 、 抽出 先 の ブック の シート １ に まとめ られ ます 。 ユーザー フォーム の コマンド ボタン 用 の コード と シート １ の ボタン 用 の コード を 下 に 示し ます 。 シート １ の ボタン を 押す と ダイアログボックス が 現れ ます ので コントロールキー を 押し ながら 二つ の ブック を 選び ます 。 この あと ユーザー フォーム で 管理番号 、 シート 番号 を 指定 し て から 、 コマンド ボタン を 押し ます 。 ユーザー フォーム の コマンド ボタン 用 の コード Option Explicit Private Sub CommandButton 1 _ Click () Sheets ( 2 ). Cells ( 3 , 1 ) = TextBox 1 Sheets ( 2 ). Cells ( 3 , 2 ) = TextBox 2 Unload UserForm 1 End Sub シート １ の ボタン 用 の コード Sub M acr o2 () ' ' M acr o2 Macro ' ﾏｸﾛ 記録 日 : 2016 / 8 / 7 ﾕｰｻﾞｰ 名 : ' Dim ファイル 名 一覧 As Variant Dim ブック As Workbook Dim no As Integer Dim shtno As Integer Dim i As Integer Dim j As Integer Dim mygyo As Integer ファイル 名 一覧 = Application . GetOpenFilename (" Excel の ファイル ,*. xls ", MultiSelect := True ) If VarType ( ファイル 名 一覧 ) = vbBoolean Then Exit Sub Application . EnableEvents = False mygyo = 6 UserForm 1 .S how no = Sheets ( 2 ). Cells ( 3 , 1 ) shtno = Sheets ( 2 ). Cells ( 3 , 2 ) ' MsgBox no For i = 1 To UBound ( ファイル 名 一覧 ) Set ブック = Workbooks . Open ( ファイル 名 一覧 ( i )) For j = 2 To Cells ( 2 , 1 ). End ( xlDown ). Row If ブック . Worksheets ( shtno ). Cells ( j , 1 ). Value = no Then ブック . Worksheets ( shtno ). Cells ( j , 1 ). EntireRow . Copy ThisWorkbook . Worksheets ( shtno ). Cells ( mygyo , 1 ). PasteSpecial mygyo = mygyo + 1 End If Next Next ' End Sub 
Win32 API の GetSystemPowerStatus を 使用 する と でき そう です 。 https :// msdn . microsoft . com / ja - jp / library / ms 812491 . aspx 
↓ の 式 で 実現 できる こと を 、 わざわざ マクロ で やる の でしょ う か ？ = IF ( COUNTIF ( Sheet 2 ! A1 : A1 00 , Sheet 1 ! A1 )> 0 , 1 , 2 ) 
何 が 問題 な の か よく 解り ませ ん が 、 ↓ の プログラム で 上手く いく と 思い ます 。 Sub ブロック 消去 1 () ' ブロック 消去 Macro Dim myrng As Range , xrng As Range Dim sp As Variant Set myrng = Cells ( 4 , 2 ). Resize (, Range (" B2 "). Value ) For Each sp In ActiveSheet .S hapes On Error Resume Next Set xrng = Inter sect ( Range ( sp . TopLeftCell , sp . BottomRightCell ), myrng ) If Err . Number = 0 Then sp . Delete End If Next Set myrng = Nothing End Sub 
文字 同士 の 足し算 は ＋ では なく ＆ です ね 。 
【 追記 】 For ～ Next で 纏め られる の で は ？ ーーーーーーー バージョン が わから ない です が 、 正規表現 で 置換 と 言う 方法 も あり かも しれ ない です ね ところで 数字 を 変え て と は For i = 1 To 5 ' 置換 し たい 文字 を i & " の " や i & "／" と 変数 を 使う Next で も よい の で は ？ → ２ 桁 以上 で あっ て も 結局 数字 + の の １つ の 数字 を 使え ば 良い の でしょ ？ 
hope 35m さん 、 こんばんは 。 一 例 です 。 Sub Sample () Dim iTmp As Integer , iStart As Integer , iEnd As Integer Dim rg As Range , rg 2 As Range iStart = Range (" A1 "). Value iTmp = iStart Set rg = Range (" A 2 ") Set rg 2 = Range (" B 1 ") Do Until IsEmpty ( rg ) If rg . Value <> iTmp + 1 Then iEnd = iTmp If iStart = iEnd Then rg 2 . Value = iStart Else rg 2 . Resize (, 3 ). Value = Array ( iStart , "～", iEnd ) End If Set rg 2 = rg 2 . Offset ( 1 ) iStart = rg . Value iTmp = iStart Else iTmp = rg . Value End If Set rg = rg . Offset ( 1 ) Loop iEnd = iTmp If iStart = iEnd Then rg 2 . Value = iStart Else rg 2 . Resize (, 3 ). Value = Array ( iStart , "～", iEnd ) End If Set rg = Nothing Set rg 2 = Nothing End Sub 
おお ざっ ぱに は 、 西暦 年 だけ から 元号 に 出来 ます が 厳密 に する に は 日付 に し ない と いけ ませ ん 。 例えば 1989年 1月7日 は 、 昭和64年 1989年 1月8日 は 、 平成元年 
Private Sub CommandButton 1 _ Click () Worksheets (" Sheet 1 "). Cells ( 8 , Columns . Count ). End ( xlToLeft ). Offset (, 1 ). Value = TextBox 9. Value End Sub という こと です か ？ 
オブジェクト 変数 そのもの を 表示 し て いる ので 当然 の 結果 で は ない でしょ う か 。 内容 を 表示 し たい の で あれ ば 、 何らかの プロパティ を 指定 し ます 。 objTd ( 0 ). InnerText objTd ( 0 ). InnerHTML 
セル の 値 で も 代入 し て み たら ？ それでは 初期 値 が 表示 さ れる だけ で は ？ 
日本語 URL の 場合 は 、 URLエンコード を 行なわ なく て は なら ない の です が 、 それ は 行ない まし た か ？ 
これ で 試し て ください 。 Sub AAA () Dim i As Integer , j As Integer , k As Integer , df As Integer Dim vv , vx , ErFlg Dim 日付 () As Date , 最小 日 As Date , 最大 日 As Date , dt As Date Dim ID () As String , 名前 () As String , ct As Integer Dim rng As Range , rng 0 As Range , ws As Worksheet vv = Range ( Range (" B2 "), Range (" B2 "). End ( xlDown ). Offset ( 0 , 4 )) ReDim ID ( 0 ), 名前 ( 0 ) 最小 日 = CDate ( vv ( 1 , 3 )) 最大 日 = 最小 日 ct = 0 For i = 1 To UBound ( vv ) If 最小 日 > CDate ( vv ( i , 3 )) Then 最小 日 = CDate ( vv ( i , 3 )) If 最大 日 < CDate ( vv ( i , 3 )) Then 最大 日 = CDate ( vv ( i , 3 )) For j = 1 To ct If ID ( j ) = CStr ( vv ( i , 1 )) Then Exit For Next If j = ct + 1 Then ct = ct + 1 ReDim Preserve ID ( ct ), 名前 ( ct ) ID ( ct ) = CStr ( vv ( i , 1 )) 名前 ( ct ) = CStr ( vv ( i , 2 )) End If Next df = 最大 日 - 最小 日 ReDim vx ( ct , df + 2 ) ReDim ErFlg ( ct , df + 2 ) For i = 1 To ct vx ( i , 0 ) = ID ( i ) vx ( i , 1 ) = 名前 ( i ) Next vx ( 0 , 0 ) = " ID ": vx ( 0 , 1 ) = " 名前 " For i = 0 To df vx ( 0 , i + 2 ) = 最小 日 + i Next For i = 1 To UBound ( vv ) k = CDate ( vv ( i , 3 )) - 最小 日 + 2 For j = 1 To ct If ID ( j ) = CStr ( vv ( i , 1 )) Then vx ( j , k ) = vv ( i , 4 ) & vv ( i , 5 ) If vv ( i , 4 ) <> "" And vv ( i , 5 ) <> "" Then ErFlg ( j , k ) = 1 Else ErFlg ( j , k ) = 0 End If End If Next Next ' 出力 Set ws = Worksheets (" Sheet 2 ") Set rng 0 = ws . Range (" A1 ") Set rng = ws . Range ( rng 0 , rng 0 . Offset ( ct , df + 2 )) rng = vx ' 着色 クリアー With ws . Cells . Font . Bold = False . Color Index = xl Automatic . Italic = False End With ' 着色 For i = 1 To ct For j = 2 To df + 2 If ErFlg ( i , j ) = 1 Then With rng 0 . Offset ( i , j ). Font . Bold = True . Color = - 16776961 . Italic = True End With End If Next Next End Sub 
下図 の よう に 、 現在 の アクティブ セル ( ピンク色 ) から 水色 の セル に 相対的 に ジャンプ する 場合 でし たら 、 名前 を 定義 すれ ば 可能 です 。 とりあえず A1 を 選択 し て ―― 名前 の 定義 ・ 名前 ： 任意 （ とりあえず TGT ） ・ 参照 範囲 ：= OFFSET ( A1 , 1 , 1 ) で 、 任意 の セル で [ F5 ] → [ 参照 先 ] に TGT → [ OK ] 
http:// www . geocities .jp / maru 3128 / wmi . html # drive 上記 に ある ドライブ の 一覧 と ドライブ の 種類 を 参考 に し て 、 １つ の プログラム に 組み合わせれ ば 、 デバイス 毎 の 処理 を 記述 し なく て も いい ですよ。 例えば Option Explicit Dim QfeSet Dim Qfe Dim Locator Dim Service Dim Ret Set Locator = WS cri pt. CreateObject (" WbemScripting .S WbemLocator ") Set Service = Locator . ConnectServer Set QfeSet = Service . ExecQuery (" Select * From Win32 _ LogicalDisk ") For Each Qfe In QfeSet Ret = Ret & Qfe . Name & vbTab & Qfe . VolumeName & vbTab & Qfe . FileSystem & vbTab & Qfe . DriveType & vbCrLf Next Wscript . Echo Ret Set QfeSet = Nothing Set Qfe = Nothing Set Service = Nothing Set Locator = Nothing これ を そのまま 実行 する と 、 各 ドライブ の 名前 、 ボリューム 名 、 ファイルシステム 、 ドライブ タイプ が 表示 さ れ ます 。 な ので 、 For Each の 中 で 各 ドライブ の ドライブ タイプ を 調べ 、 ドライブ タイプ が 2 で あれ ば 、 Removable Disk ＝ USB 等 で 接続 さ れ て いる ドライブ 。 5 で あれ ば DVD Drive 等 に なり ます 。 という こと は 、 ドライブ タイプ が 2 で あれ ば その 時点 で USB が 刺さっ て いる こと に なる ので 、 処理 中断 し 、 windows の 終了 も さ せ ない 。 5 で あれ ば 、 ボリューム 名 が 入っ て いれ ば Disc が 入っ て いる と 思う ので 、 入っ て なけれ ば USB の 時 と 同じく windows を 終了 さ せ ない という 処理 を 行え ば いい はず です 。 
ご 自身 の 質問 で 解決 し て いる 内容 だ と 思い ます が 。 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1316267881 ... 違う 内容 なら 、 変数 の 内容 を 補足 し て 下さい 。 
下記 の コード でいか が でしょ う か ？ Sub Sample () Dim pt As String ' ActiveWorkbook が 保存 さ れ て いる フォルダ を 取得 する pt = ActiveWorkbook . Path ' ひとつ 上 の 階層 の フォルダ を 取得 する pt = Left $( pt , InStrRev ( pt , "\")) ' フォルダ C の フル パス を 取得 する pt = pt & " フォルダ C \" ' Shell 関数 を 使っ て フォルダ を 開く Shell " explorer . exe " & pt , vbNormalFocus End Sub 
ハッシュ ( SHA 256 ) で いいんじゃない の ？ 暗号化 に する ( 可逆 性 を 持た せる ) 意味 ある の ？ VB で SHA 256 を 使う なら 、 SHA 256 CryptoServiceProvider を 使え ば いい 参考 http:// www . atmarkit . co.jp / fdotnet / dotnet tips / 964 computehash / compute ... 
Sub Sample () Dim xTtl , i As Long , ii xTtl = Array (" 時間 ", " 名前 ", " 住所 ") For Each sh In Worksheets With sh For i = LBound ( xTtl ) To UBound ( xTtl ) ii = Application . Match ( xTtl ( i ), . Range (" A1 : J 1 "), 0 ) If Not IsError ( ii ) Then . Cells ( 1 , " K "). Offset (, i ). Value = . Cells ( Rows . Count , ii ). End ( xlUp ). Value End If Next i End With Next sh End Sub 
ＶＢＡ で クエリ を 動的 に 生成 し て 実行 する 方法 を ご存じ でしょ う か ？ 下記 で 解説 さ れ て い ます 。 ＳＱＬ 文 の ひな形 は クエリ で 作り 、 ＶＢＡ 上 で 条件 と なる 部分 を 変数 に 置き換え ます 。 ＳＱＬ は ＡＮＤ 条件 は 高速 に 処理 出来 ます 、 ＯＲ 条件 の 場合 処理 速度 が 極端 に 遅く なる 事 が 有り ます 。 そんな 時 は １ 条件 毎 に （ ＡＮＤ は まとめ て 実行 で ＯＫ ） ＳＱＬ 文 を 実行 し 、 一時 的 な テーブル に 書き出し 。 ＯＲ と なる 条件 で 再度 実行 し て 書き出し を 繰り返せ ば 最終 的 に 一時 的 な テーブル に 結果 は 得 られ ます 。 クエリ を 作ら ず に ＳＱＬ 文 を 実行 する http:// www . moug .net / tech / acvba / 0040010 . html 
で 、 それ を どう し たい と ？ その 問題 自体 を 考えろ という 質問 ？ 
文字数 が 多く て 、 返信 不可 な ので 、 一度 削除 し て後 再 投稿 です 。 あまり 、 はまっ て 考える 時間 も 無い ので 、 中途半端 です が アップ し ます 。 「 一覧 表 に 記入 する 」 「 知恵袋 の 質問 」 「 マーク を 消す 」 など は OK です 。 でも 、 「 今日 」 とか 「 漢字 一 文字 」 とか の 熟語 に 対応 でき ない です 。 もう 一息 みたい だ けど 、 、 これから が 大変 みたい … とりあえず 、 、 挫折 し ます 。 。 Sub Sample 2 () Dim c As Range Dim i As Long Dim j As Long Dim r As Long Dim r2 As Long Dim cnt As Long Dim myRow As Long Dim flag As Boolean Dim myLen As Long Dim myPh As String Dim myWdAll As String Dim myWd 0 As String Dim myWdH As String Application .S creenUpdating = False myRow = 1 For Each c In Range (" A1 : A " & Cells ( Rows . Count , 1 ). End ( xlUp ). Row ) r = 1 cnt = 0 myWdAll = Application . GetPhonetic ( c ) For i = 1 To Len ( c ) myWd 0 = Mid ( c , i , 1 ) If Asc ( myWd 0 ) > - 30559 And A sc ( myWd 0 ) < - 26373 Then ' 漢字 の とき myPh = Application . GetPhonetic ( myWd 0 ) Do myLen = Len ( myPh ) If myLen <= Len ( myWdAll ) Then If myPh = Mid ( myWdAll , cnt + 1 , Len ( myPh )) Then Exit Do End If End If myPh = Application . GetPhonetic () Loop Until myPh = "" If myPh = "" Then r2 = r cnt = cnt + 1 flag = True End If Cells ( myRow , r + 1 ) = StrConv ( myPh , vbHiragana ) Else Cells ( myRow , r + 1 ) = StrConv ( myWd 0 , vbHiragana ) cnt = Len ( Application . GetPhonetic ( Left ( c , r ))) End If r = r + 1 cnt = cnt + Len ( myPh ) myPh = "" Next i If flag = True Then myWdAll = StrConv ( myWdAll , vbHiragana ) For i = 1 To Cells ( myRow , Columns . Count ). End ( xlToLeft ). Column If Cells ( myRow , i + 1 ) <> "" Then If Cells ( myRow , i + 1 ) = Mid ( myWdAll , 1 , Len ( Cells ( myRow , i + 1 ))) Then myWdAll = Right ( myWdAll , Len ( myWdAll ) - Len ( Cells ( myRow , i + 1 ))) End If Else If WorksheetFunction . CountBlank ( Cells ( myRow , 2 ). Resize (, r - 1 )) = 1 Then For j = r2 To r myWdH = myWdH & Cells ( myRow , j + 1 ) Next j Cells ( myRow , i + 1 ) = Mid ( myWdAll , 1 , Len ( myWdAll ) - Len ( myWdH )) Exit For End If End If Next i End If flag = False myWdH = "" myRow = myRow + 1 r = 2 Next c Application .S creenUpdating = True End Sub 
> ダブルクリック する と 作成 する か 、 、 フォーム が 表示 さ れる > そこ で 作成 を する を 押し た とき に 、 「 別 シート の 名前 、 年齢 、 職 … ダブルクリック し た行 を 変数 「 myRow 」 に 入れ て 、 その シート モジュール から ユーザー フォーム を 立ち 上げ ます 。 Public myRow As Long は 標準 モジュール の 1番 上 に 。 。 シート モジュール に ↓ Option Explicit Private Sub Worksheet _ BeforeDoubleClick ( ByVal Target As Range , Cancel As Boolean ) If Target . Column <> 1 Then Exit Sub myRow = Target . Row Cancel = True Call 呼び出し End Sub Sub 呼び出し () UserForm 1 .S how End Sub _ _ _ _ _ _ _ _ _ _ _ _ _________________________ 標準 モジュール に ↓ Option Explicit Public myRow As Long _ _ _ _ _ _ _ _ _ _ _ _ _________________________ 作成 する の ボタン ユーザーフォームモジュール に ↓ Option Explicit Private Sub CommandButton 1 _ Click () Range (" B " & myRow ). Resize (, 3 ). Copy Sheets (" Sheet 2 "). Range (" A 2 ") End Sub _ _ _ _ _ _ _ _ _ _ _ _ _________________________ 
> Vcells ( , ) と し て み た ところ なに を どう しよ う として 、 そんな こと （ そんな こと 自体 も どんな 事 を 行っ た の か わかり ませ ん が ・ ・ ） を し た の か よく 解ら ない です 。 提示 さ れ た プログラム の おかしな 点 を 指摘 する なら ば 、 > Select Case V ( i - 1 , 1 ). Value > V ( i , 1 ). Value = V ( i - 1 , 1 ). Value > V ( i , 2 ). Value = V ( i , 3 ). Value 配列 に 、 「. Value 」 を 付ける の です か ？ 「. Value 」 は 、 セル や テキストボックス など に 入力 さ れ た値 の 取得 の ため の プロパティ 。 配列 に 使用 する もの で は あり ませ ん 。 他 の 場所 > If V ( i , 3 ) = " 合格 " Then で は 、 正しく コーディング さ れ て いる の に なぜ な ん です か ね ？ 
VBA の ソース なら 、 コピペ し て 質問 文 に 貼り 付け た 方 が 簡単 で 、 誰 に でも 分かり やすい 内容 に なる と 思い ます が ・ ・ ・ （ なぜ 、 写真 を ？ ） 写真 だ と 文字 が 小さ すぎ で 分かり にくい です 。 > この 写真 の コード だ と 、 エラー の メッセージ も 入力 チェック も 両方 出 て しまい ます 。 Msgbox が ２つ 並ん で いる ので 、 そりゃ 出る でしょ う ね 。 メッセージ を 表示 し て 、 戻り値 を 変数 に 入れ て いる だけ です 。 メッセージ は 出し たい ところ に 入れる の が 基本 です 。 また 、 エラー の 時 は Exit Sub で 処理 を 抜ける の で は ？ - - - - - ------------------------- With の 使い方 も おかしい 。 Range の 使い方 も おかしい 。 ここ で 全て 説明 する の は 大変 な ので 、 VBA の リファレンス サイト を 見 て 勉強 すれ ば 良い か と 思い ます 。 https :// www . google . co.jp / search ? num = 50 & newwindow = 1 & site =& source = hp &... 
こんにちは。 1 ) 手っ取り早く 、 タスク 専用 の ブック を 作成 する 。 2 ) タスク スケジュール の 設定 を 全部 確認 し て 、 資料 の とおり に 設定 する 。 早い の は 1 です あと 、 http:// www . ken 3 . org / vba / backno / vba 086 . html の 話 だ と 、 主 様 の コード は acess の 話 。 エクセル は 、 だめ です ブログ の 話 だ と 、 VBS で 動作 し て いる から タスク で 、 引数 を 渡し て い ませ ん 。 エクセル を ラッピング し て いる 。 ここら へん に 、 おちつき そう です 
> select case 文 を 使い Select Case 変数 Case 値 1 Set x = Range (" A1 ") Case 値 2 Set x = Range (" A 2 ") End Select Range (" B2 "). Interior . Color = x . Interior . Color 
ワンクッション は 作業 セル を 使わ なく て も 、 数式 中 で 良い です ね 。 H1 セル と I 1 セル に 名前 を 付け た 範囲 の 「 名前 」 が 項目 として 有る と し ます 。 リスト の 元 の 値 欄 に 次 式 を 入力 し ます 。 = INDIRECT ( IF ( OR ( A $1 = H $1 : I $1 ), A $1 ," O ")) 
COUNTA で 出来る と 思い ます 。 
Cells ( 1 , 1 ) は オブジェクト です 。 セル と いっ て も 色々 あっ て アドレス は A1 値 は 1 背景色 文字 色 高さ 幅 と 色々 あり ます 。 プロパティ と 言い ます 。 . Value は 値 を 示す プロパティ です 。 なので Cells ( 1 , 1 ). Value = 1 は セル の 値 を 1 に せよ と の 意味 で 正しい 表現 です 。 しかし 、 . Value は 使用 頻度 が 非常 に 高い ため 、 省略 し た 場合 は . Value に し ましょ う と 決め られ て ます 。 だから 無く て も いい の です 。 実際 、 どちら に す べき か は 、 何とも 言い がたい です ね 。 
フィルタ を かけ た データ 範囲 を 、 別 シート に そのまま コピペ すれ ば OK です 。 ----------------------- Sub フィルタ 後 の データ 範囲 を コピペ () Dim sh 1 , sh 2 Set sh 1 = Sheets (" サンプル ") Set sh 2 = Sheets (" 別 シート ") sh 2 . Cells . Clear sh 1 . Cells ( 1 ). Current Region . Copy _ Destination := sh 2 . Cells ( 1 ) End Sub 
>> VB で 2 個 の バイトデーター を 結合 する 方法 を 教え て 頂け ませ ん でしょ う か ？ Dim BArray () As Byte BArray = CStr (A) & CStr ( B ) >> 例えば 、 ０ ｘ D3 と ０ ｘFA という 2 個 の バイトデーター を 結合 し て 、 ０ ｘ D3 FA という 1 個 の Integer 型 の データー に し たい の です が 基本的 に は 、 ↓ の よう な 力 技 しか ない はず 。 http:// 7 ujm .net / VB / str _ integer . html 
↓ の よう な 感じ な の で は ？ If 容積 重量 . Value > 実 重量 . Value Then 配送 重量 . Value = 容積 重量 . Value Else 配送 重量 . Value = 実 重量 . Value End If 
ご 提示 の プログラム に は 、 コンパイル エラー が 残っ て ます 。 （ 大文字 ・ 小文字 、 「.」 と 「 ,」 の 間違い だけ で は ありません ） ↓ の よう に 書き直す と エラー は 解消 し ます が 、 あなた が 実際 に 実行 し た プログラム と 同じ もの な の でしょ う か ？ 確認 し て ください 。 あと 、 「 セル 値 が どの よう な 値 で 、 どんな 条件 で 、 どの よう な 結果 に なれ ば 嬉しい 」 の か を 説明 し て ください 。 「 上手く 出来 ない 」 だけ で は 、 回答者 は 「 エラー なく 実行 さ れ ます よ ！ 」 と 回答 する しか ない の は ご 承知 です よ ね ？ あと サンプル データ の 提示 もお 忘れ なく 。 Dim i As Integer Dim a As Integer Dim b As Integer Dim hantei As Boolean For b = 2 To 11 hantei = False If Cells ( b , 1 ) <> "" Then hantei = True Else Exit For End If Next b For i = 2 To 11 For a = 2 To 6 If hantei = True Then If Cells ( i , a ) <> "" Then hantei = False Else With Cells ( i , a ). Interior . Color = vb Yellow End With End If End If Next a Next i 
どんな コード な の です か ？ 
下記 の コード でいか が でしょ う か ？ 数式 が 入っ て い ない セル は チェック し ませ ん 。 Option Explicit Sub Sample () Dim rng As Range , f As String If TypeName ( Selection ) <> " Range " Then Exit Sub Application .S creenUpdating = False For Each rng In Selection If rng . FormulaR 1 C1 <> "" Then If f = "" Then f = rng . FormulaR 1 C1 MsgBox " 選択 範囲 の 数式 は すべて 同一 です " Else If f <> rng . FormulaR 1 C1 Then rng .S elect MsgBox " 数式 が 一致 し て い ませ ん 。 " Exit For End If End If End If Next rng Application .S creenUpdating = True End Sub 
＞ フォーム に 表示 さ れ た は Me . テキストボックス 名 で 取得 出来 ます 。 ＞ テーブル や クエリ の 条件 から 必要 な フィールド 名 は 下記 で 解説 さ れ て い ます 、 ( Access 2000 / 2002 / 2003 ) と 書か れ て い ます が 、 Access 2000 以後 なら 動作 する と 思い ます 、 クエリ 名 を 指定 すれ ば クエリ 内 の フィールド 名 も 取得 できる はず です 。 テーブル 内 の フィールド 名 の 一覧 を 取得 する https :// www . moug .net / tech / acvba / 0080049 . html 
> johnnys _ 19990915 _ arashi _ amnos さん 2016 / 8 / 1514 : 53 : 16 > csv 形式 の テキストファイル の 保存 方法 と 任意 の 名前 かつ 任意 の 場所 で 保存 する 方法 が わかり ませ ん 。 VBA の コード も どう 入力 し て いい か わかり ませ ん 。 書籍 を 購入 する 事 から 始める と いい と 思い ます 。 
下記 の コード でいか が でしょ う か 。 Option Explicit Private Index As Long Private Sub ComboBox 1 _ Change () Dim ListNo As Long , i As Long Dim txt As String With ComboBox 1 ListNo = . ListIndex If ListNo < 0 Then Exit Sub Application . EnableEvents = False For i = 0 To . ColumnCount - 1 txt = txt & . List ( ListNo , i ) If i < . ColumnCount - 1 Then txt = txt & vbTab Next . Text = txt Index = ListNo End With Application . EnableEvents = True End Sub Private Sub CommandButton 1 _ Click () Dim lRow As Long , i As Long If Index < 0 Then MsgBox " いずれ か の 行 を 選択 し て ください " Exit Sub End If With ActiveSheet lRow = . Range (" E " & Rows . Count ). End ( xlUp ). Offset ( 1 ). Row For i = 0 To ComboBox 1 . ColumnCount - 1 . Range (" C " & lRow ). Offset (, i ). Value = ComboBox 1 . List ( Index , i ) Next i End With ComboBox 1 . Value = "" Index = 0 End Sub ' - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ------------------------- Private Sub Command Bu t to n2 _ Click () Unload Me End Sub Private Sub UserForm _ Initialize () Dim LastR As Long Dim myData With Worksheets (" M ") LastR = . Range (" A " & Rows . Count ). End ( xlUp ). Row myData = . Range (" A 2 : C " & LastR ). Value End With With ComboBox 1 . ColumnCount = 3 . ColumnWidths = " 50 ; 50 ; 50 " . List = myData End With CheckBox 1 . Value = False End Sub 
添付 図 の 画像 は 小さ すぎ で 、 判別 付き ませ ん 。 ので 、 当てずっぽう 。 Sub sample () With Range (" F2 ") . Offset (- 1 , - 1 ). Copy Range (. Cells , . End ( xlToRight )). PasteSpecial Paste := xlPasteFormulas End With End Sub > その プログラム も ご 教示 いただける と ありがたい 画像 が 小さい せい な の か 、 全く 意味 が 通じ ませ ん 。 やり たい こと を 纏め て 、 新 スレ 立て て ください 。 
' Sheet 1 の データ 最終 行 は ､ B 列 で 判断 し て い ます ｡ Sub sample () Dim sh As Worksheet , xFrm , xTo , i As Long , ii As Long Set sh = Sheet 1 xFrm = Split (" B5 : D 5 , F5 , M 5 , S 5 : U 5 , AS 5 : AW 5 , AX 5 : BB 5 , BC 5 ", ",") xTo = Split (" B 9 : D 9 , D10 , E 9 , F 9 : H9 , I 9 : M9 , I 10 : M10 , N 9 ", ",") With Sheet 2 Do While sh . Range (" B5 "). Offset ( i ). Value <> "" For ii = LBound ( xFrm ) To UBound ( xFrm ) . Range ( xTo ( ii )). Offset ( i * 2 ). Value = sh . Range ( xFrm ( ii )). Offset ( i ). Value Next ii i = i + 1 Loop End With End Sub 
こう いっ た QA が あり ます ので 、 VBA から は 不可能 で は ない か と 思い ます 。 http:// www . go mplayer .jp / player / bbs / view . html ? intSeq = 1889 ActiveX オブジェクト という の は 、 簡単 に 言え ば 、 CreateObject で 作成 さ れる もの です 。 IE なら ば 、 Set ie = CreateObject (" InternetExplorer . Application ") など として 制御 用 に 取得 でき ます 。 
こんにちは。 とりあえず 、 ぱっと みため 、 違和感 の ある の は Set os = wmi . ExecQuery (" SELECT * FROM Win32 _ OperatingSystem ") です 。 FROM の 手前 に 、 スペース 一 文字 あり ませ ん よ ね 、 クエリ にとって は 、 それ って 致命 的 な ミス です 。 そこ を 修正 し て み て ください 。 あと は 、 もともと の コード を よく 確認 です 。 コピー ペースト だっ たら 、 スペース が 消える なんて 、 ない です し 、 手入力 し た の でし たら 、 全部 の 文字 、 確認 し て ください 。 他 の 心配 は 、 コード は 、 実績 の ある コード な ん です か ね 、 そこ だけ です 。 
会話 など 弾ま なけれ ば 、 しんどい か な 、 愛さ れ て ない か な と 不安 に なり ます よ ね 。 特に 遠距離 だ と そう 思う の も 仕方 あり ませ ん 。 ただ 『 釣っ た 魚 に 餌 は やら ない 』 じゃ ない です が 、 大抵 の 男 は 恋人 に なっ て しまう と 安心 し て しまう の か 、 それほど 話し て くれ なく なる もの です 。 男 は そういう もの だ と 割り切る より 他 ない かも 知れ ませ ん が 、 しかし 彼 の 趣味 を 勉強 し て 話題 を 増やす とか 貴方 が 出来る こと は ある はず です 。 また 遠距離恋愛 は 会っ て 話せ ない 分 だけ 互い の 気持ち を 確認 する 術 が なくなり ます から 、 自分 の 気持ち を 素直 に 出さ ない と 『 冷め られ た か な ？ 』 と 相手 も なっ て しまい ます 。 恥ずかしい でしょ う が 、 たま に は 好き だ と 伝える の も 必要 だ と 思い ます よ 
エクセル 散布図 補完 で ググる ここ など を 参考 に http:// hom ep ag e3 . nifty . com / gakuyu / excel / kin ji. html 正弦波 なら 、 3 次 で 近似 する の が いい 。 10 ノード あれ ば 、 人間 に は 正弦波 に 見える 。 要は 、 ① 近似 曲線 の 「 種類 」 タブ －②「 多項式 近似 」－③ 次数 「 ２ 」 －④ 近似 曲線 を 追加 する を し て から 、 散布図 の 点 を 見え なく すれ ば いい 。 
BitBlt 関数 を 利用 し ます 。 https :// msdn . microsoft . com / ja - jp / library / cc 428307 . aspx VB.NET です が 「 画面 を キャプチャ する 」 の 中 で 「 Win32 API を 使用 する 方法 」 に 参考 コード が あり ます よ 。 http:// dobon .net / vb / dotnet / graphics / screen capture . html 
If Cells （ 1 . 9 ） > then 59 が 抜け て ます 。 If Cells ( 1 . 9 ) < 60 Then Cells ( 1 . 1 ) = " 不可 " End If 上 の 方 で 59 点 を 超える 場合 の 処理 は 終わっ てる ので 、 この 行 で 残っ てる 人 は 全員 60 点 未満 です 。 つまり If Cells ( 1 . 9 ) < 60 Then は 不要 です 。 上記 で 対応 出来る の は 確か に １ 個 だけ です 。 For i = 1 to 10 If cells ( i , 9 )～ ～ Next i と やれ ば i の 値 によって 処理 を 変え て くれ ます 。 これ で とりあえず 動く よう に なっ たら （ その 気 が ある なら ） ElseIf を 使う とか 、 Select Case を 使う とか やっ て み ましょ う 。 
下記 の コード を Sheet 1 の 「 Private Sub Worksheet _ Change ( ByVal Target As Range )」 から 「 End Sub 」 と 置き換え て 下さい 。 Option Explicit Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim rng As Range , shp As Shape , w As Long Dim endCell As Range ' 変更 さ れ た すべて の セル を 検査 する For Each rng In Target . Cells ' B 列 が 変更 さ れ た とき If rng . Column = 2 Then w = Val ( rng . Value ) If w > 0 Then ' この シート の すべて の 図形 を 検索 する Set endCell = Nothing For Each shp In Me .S hapes ' 同じ 行 に ある オートシェイプ を 検索 する If shp . Type = msoAutoShape And _ shp . TopLeftCell . Row <= rng . Row And shp . BottomRightCell . Row >= rng . Row Then ' 該当 する 長方形 の 幅 ・ 高さ ・ 左端 位置 ・ 上端 位置 を 調整 する shp . Width = w * Range (" C 2 "). Width - 1 shp . Height = rng . Height / 2 shp . Left = shp . TopLeftCell . Left shp . Top = rng . Top + rng . Height / 4 Set endCell = shp . BottomRightCell End If Next shp ' 同じ 行 に オートシェイプ が 存在 し た とき If Not endCell Is Nothing Then ' この シート の すべて の 図形 を 検索 する For Each shp In Me .S hapes ' 同じ 行 に ある テキストボックス を 検索 する If shp . Type = msoTextBox And _ shp . TopLeftCell . Row <= rng . Row And shp . BottomRightCell . Row >= rng . Row Then ' テキストボックス の プロパティ を 変更 する shp . TextFrame 2 . WordWrap = msoFalse shp . TextFrame 2 . AutoSize = msoAutoSizeShapeToFitText ' 該当 する テキストボックス の 内容 を 変更 する shp . TextEffect . Text = Cells ( 2 , endCell . Column ). Value & "(" & rng . Value & ")" ' 該当 する テキストボックス の 左端 位置 ・ 上端 位置 を 調整 する shp . Left = endCell . Offset (, 1 ). Left If shp . Height > rng . Height Then shp . Top = rng . Top - ( shp . Height - rng . Height ) / 2 Else shp . Top = rng . Top + ( rng . Height - shp . Height ) / 2 End If End If Next shp End If End If End If Next rng End Sub 
h8 38170 さん 、 こんにちは。 EXCEL は 、 多重起動 する こと が でき ます 。 つまり EXCEL の ウインドウ そのもの を 複数 立ち 上げる こと が でき ます 。 この 時 、 例えば １つ の Window で Book 1 . xlsx を 、 もう １つ の ウインドウ で Boo k2 . xlsx を 開い て いる と する と 、 Book 1 から VBA project を 見 て も 、 Boo k2 は 見え ませ ん 。 （ その 逆 も しかり です 。 ） つまり 、 それぞれ 独立 し て 生成 さ れ た EXCEL インスタンス の 上 に ある ので 、 相互 に 認識 が 取れ ない 状態 に ある もの と 思わ れ ます 。 な ので 、 社内 開発 し た ソフト から Book 1 . xlsx を 開い た 後 で 、 同じ インスタンス 上 で 質問者 様 の マクロ ファイル を 開け ば 問題 なく 操作 できる の で は ない か と 思い ます 。 どんな 場合 でも 対処 できる ( EXCEL インスタンス を またい で 認識 さ せる ) 方法 は 、 浅学 の ため 私 に は 判り ませ ん 。 すみません 。 ( 他 の 回答者 様 の 知恵 頼み です 。 ) 
Select 状態 に 出来る の は アクティブ シート 上だけ です から 、 先 に Sheet 2 を アクティブ に し て ください 。 Sheets (" Sheet 2 "). Activate Sheets (" Sheet 2 "). Range (" B2 "). Select 
> 前者 の 方 が いい 理由 は あり ます か ？ > 下 の ほう が キレイ に まとまっ て 見える 提示 さ れ た コード の 範囲 で は 、 あなた の 意見 に 全面的 に 賛成 です 。 異論 の 余地 は ない です ね 。 
オートシェイプ と テキストボックス を 同時に 変更 する コード です 。 Option Explicit Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim rng As Range , shp As Shape , w As Long Dim endCell As Range ' 変更 さ れ た すべて の セル を 検査 する For Each rng In Target . Cells ' B 列 が 変更 さ れ た とき If rng . Column = 2 Then w = Val ( rng . Value ) If w > 0 Then ' この シート の すべて の 図形 を 検索 する Set endCell = Nothing For Each shp In Me .S hapes ' 同じ 行 に ある オートシェイプ を 検索 する If shp . Type = msoAutoShape And _ shp . TopLeftCell . Row <= rng . Row And shp . BottomRightCell . Row >= rng . Row Then ' 該当 する 長方形 の 幅 ・ 高さ ・ 左端 位置 ・ 上端 位置 を 調整 する shp . Width = w * Range (" C 2 "). Width - 1 shp . Height = rng . Height / 2 shp . Left = shp . TopLeftCell . Left shp . Top = rng . Top + rng . Height / 4 Set endCell = shp . BottomRightCell End If Next shp ' 同じ 行 に オートシェイプ が 存在 し た とき If Not endCell Is Nothing Then ' この シート の すべて の 図形 を 検索 する For Each shp In Me .S hapes ' 同じ 行 に ある テキストボックス を 検索 する If shp . Type = msoTextBox And _ shp . TopLeftCell . Row <= rng . Row And shp . BottomRightCell . Row >= rng . Row Then ' テキストボックス の プロパティ を 変更 する shp . TextFrame 2 . WordWrap = msoFalse shp . TextFrame 2 . AutoSize = msoAutoSizeShapeToFitText ' 該当 する テキストボックス の 内容 を 変更 する shp . TextEffect . Text = Cells ( 2 , endCell . Column ). Value & "(" & rng . Value & ")" ' 該当 する テキストボックス の 左端 位置 ・ 上端 位置 を 調整 する shp . Left = endCell . Offset (, 1 ). Left If shp . Height > rng . Height Then shp . Top = rng . Top - ( shp . Height - rng . Height ) / 2 Else shp . Top = rng . Top + ( rng . Height - shp . Height ) / 2 End If End If Next shp End If End If End If Next rng End Sub 
下記 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st 2 As Worksheet Dim cMax As Long , c1 As Long Dim r1 As Long , r2 As Long Set st 1 = Worksheets (" シート １ ") Set st 2 = Worksheets (" シート ２ ") ' シート １ の 最終 列 を 求める cMax = st 1 . Cells ( 1 , Columns . Count ). End ( xlToLeft ). Column ' エクセル の 再 描画 を 停止 する Application .S creenUpdating = False ' シート ２ を 一旦 クリア する st 2 . Cells . Clear ' シート ２ に 見出し を 書き込む st 2 . Range (" A1 : E 1 "). Value = Array (" 品番 ", " 原価 ", " 売価 ", " 店名 ", " 数量 ") r2 = 2 ' シート １ の 4 行 目 から 最終 行 まで 繰り返す For r1 = 4 To st 1 . Range (" A " & Rows . Count ). End ( xlUp ). Row ' シート ２ に 品番 の 数 だけ 転記 する For c1 = 2 To cMax With st 2 . Range (" A " & r2 ) . Offset (, 0 ). Value = st 1 . Cells ( 1 , c1 ). Value ' 品番 . Offset (, 1 ). Value = st 1 . Cells ( 2 , c1 ). Value ' 原価 . Offset (, 2 ). Value = st 1 . Cells ( 3 , c1 ). Value ' 売価 . Offset (, 3 ). Value = st 1 . Cells ( r1 , 1 ). Value ' 店名 . Offset (, 4 ). Value = st 1 . Cells ( r1 , c1 ). Value ' 数量 End With r2 = r2 + 1 Next c1 Next r1 ' シート ２ を 品番 および 店名 で ソート する r2 = r2 - 1 With st 2 .S ort .S ortFields . Clear .S ortFields . Add Key := Range (" A1 : A " & r2 ), SortOn := xlSortOnValues , Order := xlAscending , DataOption := xlSortNormal .S ortFields . Add Key := Range (" D1 : D " & r2 ), SortOn := xlSortOnValues , Order := xlAscending , DataOption := xlSortNormal .S etRange Rows (" 1 :" & r2 ) . Header = xlYes . MatchCase = False . Orientation = xlTopToBottom .S ortMethod = xlPinYin . Apply End With ' st 2 . Activate st 2 . Range (" A 2 "). Select ' エクセル の 再 描画 を 再開 する Application .S creenUpdating = True End Sub 
① は 例えば セル C1 0 の 関数 式 は = sumIf ( A5 : A10 ," 小 計 ", C5 : C1 0 ) と 普通 です 。 しかし ② は = sumif ( Range ( A5 : A10 )," 小 計 ", Range ( Cells ( 5 , x ), Cells ( ben , x ))) と Range 等 が 入っ て おり 関数 式 として は 誤り です 。 セル 範囲 Range で なく セル 範囲 の アドレス A5 : A10 で ある 必要 が あり ます 。 修正 は . address を 付ける だけ です 。 Cells ( num , x ). Formula = "= sumif (" & Range ( Cells ( 5 , " A "), Cells ( ben , " A ")). address & ","" 小 計 ""," & Range ( Cells ( 5 , x ), Cells ( ben , x )). address & ")" 
セキュリティ 上 、 指定 さ れ た 拡張子 以外 の ファイル は 読め ない よう に なっ て い ます 。 https :// support . microsoft . com / ja - jp / kb / 436329 
こんな 感じ です 。 ・ ・・・・・・・・・・・・ Sub 平均 () On Error Resume Next Dim a , b , c As Long Dim temp As Long temp = Range (" A " & Rows . Count ). End ( xlUp ). Row For a = 1 To temp For b = 1 To 3 c = c + Cells ( a , b ). Value Next Range (" D " & a ). Value = Int ( c / 3 ) c = 0 Next End Sub 
提示 の コード の [ フィールド 名 ] という の は オプション グループ の コントロール ソース です か 。 オプション グループ に 連結 し た フィールド に は 、 数値 しか 入力 でき ませ ん 。 オプション グループ の Value も 数値 です 。 もし 、 やり たい こと が フォーム 上 の テキストボックス に オプション グループ の 選択 に 対応 し た テキスト を 表示 さ せ たい という こと なら 、 ＶＢＡ は 必要 ない です 。 テキストボックス の コントロール ソース に 下記 の 式 を 設定 し て ください 。 = Choose ([ フレーム 名 ], " 東京 ", " 大阪 ", " 名古屋 , " 静岡 ", "") 
私 の 理解 し て いる 限り で は テーブル に 部分的 に 色 を 変える よう な 機能 は 有り ませ ん 。 テーブル 内容 を フォーム 上 の テキストボックス に 表示 できる よう に し て 、 条件 付き 書式 を 使う か 、 ＶＢＡ で 処理 し ます 。 
下 の 図 の よう な こと で 、 C5 セル に は 、 ① = LOOKUP ( 10 ^ 9 , LEFT ( B5 , ROW ($ 1 :$ 50 ))* 1 )* LOOKUP ( 10 ^ 9 , RIGHT ( LEFT ( B5 , LOOKUP ( 10 , MID ( B5 , ROW ($ 1 :$ 50 ), 1 )* 1 , ROW ($ 1 :$ 50 ))), ROW ($ 1 :$ 50 ))* 1 ) の 式 を 入れ て 、 下 に オート フィル （ コピー ） し て い ます 。 
sample : push each charactors to an array from 4 digit number string - JSFiddle https :// jsfiddle .net / sii _ side / t2r ahm 2 q / いくつ か 方法 が 思いつき ます が 、 文字列 を 空文字 で split する の が 最も 手軽か と 思い ます 。 ほとんど の 方法 で は 、 配列 に 格納 さ れ た 各 要素 が 文字列 型 で ある こと に 注意 し て ください 。 
ご 希望 の 操作 は 単純 に ワイルドカード 置換 で 対応 でき そう です 。 Ctrl + H で 置換 ダイアログ を 出し て 、 検索 する 文字列 に 「 点 （*)」 置換 後 の 文字列 に 何 も 記入 せ ず 「 すべて 置換 」 し ます 。 
こんにちは。 開く ファイル の 種類 も 、 ほぼ 決まっ て いる よう です し 、 具体 的 に 言っ て ください 。 たとえば 、 で いい ん です が 、 今 ある コード は 、 どの 程度 、 text ファイル は 、 「 この よう に 開く 」 jpeg は 、 こう する 、 という よう に 、 ファイル ごと に 様子 が 変化 し ます ファイル が 100 見つけ た とき 、 その 100 の ファイル を 全部 開く と は 、 思え ない から です 
① この マクロ を 統合 後 ファイル の 標準 モジュール に 記載 ② 統合 後 ファイル と 同一 フォルダ に 「 data 」 フォルダ を 作り 、 社員 データ の エクセル ファイル を 入れる ③ データ を コピー し たい シート を アクティブ に し て マクロ 起動 Sub Macro () Dim LastRow As Long , InputRow As Long Dim buf As String Const SttRow As Long = 7 With ActiveSheet buf = Dir ( ThisWorkbook . Path & "\ data \*. xlsx ") Do While buf <> "" InputRow = . Cells ( Rows . Count , " B "). End ( xlUp ). Row + 1 Workbooks . Open Filename := ThisWorkbook . Path & "\ data \" & buf LastRow = Cells ( Rows . Count , " A "). End ( xlUp ). Row Range ( Cells ( SttRow , " A "), Cells ( LastRow , " A ")). Copy Destination :=. Cells ( InputRow , " B ") Range ( Cells ( SttRow , " B "), Cells ( LastRow , " H ")). Copy Destination :=. Cells ( InputRow , " E ") Cells ( 4 , " C "). Copy Destination :=. Range (. Cells ( InputRow , " D "), . Cells ( InputRow + LastRow - SttRow , " D ")) Application . DisplayAlerts = False Workbooks ( buf ). Close savechanges := False Application . DisplayAlerts = True buf = Dir () Loop End With End Sub あなた 一 人 で 使う 分 に は 問題 ありません が 、 複数人 で 使う と なる と 、 あなた は 自動的 に この マクロ の 担当者 に なり ます 。 何 か 問題 が 起こる と 全部 あなたに 来 ます ので 、 この 機会 に VBA を 勉強 し て おく こと を 勧め ます 。 
下記 の コード でいか が でしょ う か ？ Option Explicit Sub Sample () Dim WSH As Object Dim Path As String Dim FSO As Object Dim Folder As Variant Dim folderObj As Object Dim fileObj As Object Set WSH = CreateObject (" Wscript .S hell ") Path = WS H. SpecialFolders (" Desktop ") & "\ AAA " Set FSO = CreateObject (" Scripting . FileSystemObject ") For Each folderObj In FSO . GetFolder ( Path ). SubFolders For Each fileObj In folderObj . Files If fileObj . Name Like " 0 _*" Then fileObj . Move Path & "\" End If Next Next Set FSO = Nothing Set folderObj = Nothing Set fileObj = Nothing End Sub 
データ が 大量 で あれ ば 、 マクロ 処理 が 良い と 思い ます 。 同じ データ で 重複 箇所 が 複数 ある かも しれ ない ので 、 Sheet 2 の データ を 基準 に チェック し まし た 。 Sub Sample () Dim i As Long Dim j As Long Dim myRow 1 As Long Dim myRow 2 As Long Dim sh 1 As Worksheet Dim sh 2 As Worksheet Dim flag As Boolean Dim c1 () As String Dim c 2 () As String Application .S creenUpdating = False Set sh 1 = Sheets (" Sheet 1 ") Set sh 2 = Sheets (" Sheet 2 ") myRow 1 = sh 1 . Cells ( Rows . Count , 1 ). End ( xlUp ). Row myRow 2 = sh 2 . Cells ( Rows . Count , 1 ). End ( xlUp ). Row ReDim c1 ( myRow 1 ) As String ReDim c 2 ( myRow 2 ) As String For i = 17 To myRow 1 c1 ( i - 16 ) = sh 1 . Cells ( i , 1 ) & "_" & sh 1 . Cells ( i , 49 ) Next i For i = 3 To myRow 2 c 2 ( i - 2 ) = sh 2 . Cells ( i , 1 ) & "_" & sh 2 . Cells ( i , 13 ) Next i For i = 1 To UBound ( c 2 ) - 2 For j = 1 To UBound ( c1 ) - 16 If c 2 ( i ) = c1 ( j ) Then sh 1 . Cells ( j + 16 , 50 ) = " 重複 " flag = True End If Next j If flag = False Then sh 2 . Rows ( i + 2 ). Interior . Color Index = 6 End If flag = False Next i Application .S creenUpdating = True End Sub << 標準 モジュール に 貼り 付ける >> マクロ の コード を 記述 ・ 編集 する とき は 、 別 の VBE という 画面 です 。 １ ． 上記 の マクロ コード を 全て ドラッグ し て 、 コピー し ます 。 ２ ． Alt キー を 押し ながら [ F1 1 ] キー を 押し ます 。 ３ ． 上 の 「 挿入 」 メニュー を クリック し て 、 「 標準 モジュール 」 を 挿入 する 。 ４ ． 右 の ウィンドウ の 「 マクロ を 書く ところ 」 に 貼り 付け ます 。 あと は 、 この 画面 は いら ない ので 、 右 上 の 「 × 」 で 閉じ ます 。 ココ を 参考 に し て ください 。 ↓ http:// office tanaka .net / excel / vba / beginner / 10 . htm << マクロ を 実行 する >> １ ． Alt キー を 押し ながら [ F8 ] キー を 押し ます 。 ２ ． 出 て き た マクロ の ダイアログ で 「 Sample 」 を 選択 し て 「 実行 」 
質問 内容 が 曖昧 で 、 状況 が 分かり ませ ん が ・ ・ ↓ 無料 で 使える 「 Visual Studio 」 を 使っ た の で は ？ https :// www . visualstudio . com / ja - jp / products / visual - studio - community ... 個人 利用 や 小規模 会社 で の 開発 なら 、 無料 でも 十分 な 機能 が あり ます 。 私 は この 無料 版 で ソフト 開発 し て 、 販売 し て い ます よ 。 もちろん 、 有料 版 も あり ます 。 （ 個人 利用 で は 不要 かも ・ ・ ） 
InputBox 関数 の 戻り値 は 文字列 な ので Dim a As Variant で も Dim a As String で も どっち でも 構い ませ ん 。 Sub 検索 () Dim a As String , b As String , c As Variant , d As Variant , e As Long a = InputBox (" 日付 を 入力 し て ください 。 例 210610 ") b = InputBox (" 社員 番号 を 入力 し て ください 。 ") If a = "" Or b = "" Then MsgBox " 入力 さ れ て い ませ ん " End If On Error GoTo Err _ Trap Worksheets (" Dt "). Activate c = Application . WorksheetFunction . Match ( a * 1 , Columns (" B "), 0 ) d = Application . WorksheetFunction . Match ( b * 1 , Columns (" C "), 0 ) MsgBox " 検索 値 は " & c & " 行 目 、 " & d & " 行 目 です " Exit Sub Err _ Trap : MsgBox " エラーコード No. " & Err . Number & vbCrLf & Err . Description MsgBox " 検索 値 が 見つかり ませ ん でし た " End Sub という 感じ で 検索 文字 に １ を 掛ける と 数値 に なる ので 検索 する なり 、 エラー 処理 に いく なり する と 思い ます 。 ちなみに WorkSheetFunction を 省略 する と マクロ は エラー で 止まら ず エラー 値 を 返す ので Sub 検索 () Dim a As String , b As String , c As Variant , d As Variant , e As Long a = InputBox (" 日付 を 入力 し て ください 。 例 210610 ") b = InputBox (" 社員 番号 を 入力 し て ください 。 ") If a = "" Or b = "" Then MsgBox " 入力 さ れ て い ませ ん " End If Worksheets (" Dt "). Activate c = Application . Match ( a * 1 , Columns (" B "), 0 ) d = Application . Match ( b * 1 , Columns (" C "), 0 ) If IsError ( c ) Or IsError ( d ) Then MsgBox " 検索 値 が 見つかり ませ ん でし た " Else MsgBox " 検索 値 は " & c & " 行 目 、 " & d & " 行 目 です " End If End Sub という の も アリ だ と 思い ます 。 
エラー の 原因 は 、 Union の 引数 に Range オブジェクト 以外 を 使用 し た から です ね 。 文字列 型 は 使え ませ ん 。 間違い を 起こす 原因 は 、 きちんと し た 記述 を する 癖 を 付け て い ない から でしょ う 。 Cells ( 1 , 3 ) これ は 確か に 、 1 行 3 列 の セル の 値 を 示し ます が 、 暗黙 の プロパティ が 含ま れ て いる 結果 です 。 正式 に は Cells ( 1 , 3 ). Value と 記述 し ます 。 省略 し た 場合 は 、 Value が 付く もの と する という 、 暗黙のルール が ある の です 。 本来 、 Range オブジェクト に プロパティ を 付け ない 場合 は 、 Range オブジェクト そのもの を 表わし ます 。 上記 の よう な 区別 が 付い て い て 、 Union の 書式 が 分かっ て いれ ば 、 暗黙 の プロパティ など を 使っ て は 混乱 する こと は 想像 に 難く ない の で は ない でしょ う か 。 Set S = Cells ( 1 , 3 ) Set R = Union ( Range ( Cells ( 1 , 1 ), Cells ( 1 , 2 ), S ) Range オブジェクト で 値 や 数式 を 扱う 場合 は 、 きちんと 適切 な プロパティ を 記述 する 癖 を 付け て み て ください 。 
A 2 = IFERROR ( INDEX ( Sheet 1 ! B $1 : B $10 , SMALL ( INDEX (( Sheet 1 ! A $1 : A $10 <> A $1 )* 10 ^ 5 + ROW ( A $1 : A $10 ),), ROW ( A1 ))),"") ★ 下 に コピー 
エラー ： 0 x 80041017 コード ： 80041017 ソース ：( null ) に なり ます か ？ もしか する と oClassSet に 何 も 入っ て い ない の かも 。 Set oClassSet = oService . ExecQuery (" Select * From Win32 _ Process Where Description = " & seetoo ) な ので 、 inputbox で 入力 さ れ た プロセス 名 が 正しく ない の かも しれ ませ ん ね （ サービス 名 と 一致 し て い ない ？ ） 
> エラー が 起こり ます 。 > If FoundCell . Address = FirstCell . Address Then これ を 再現 し て み ます まず 、 新規 ファイル を 開い て 標準 モジュール に 以下 を 転記 し ます Public Sub test ()     Dim r As Range     Set r = Cells . Find (" A ", LookAt := xlPart )     Debug . Print r . Address     Set r = Cells . FindNext ( r )     Debug . Print r . Address End Sub 上記 で は " A " を 検索 する もの に なっ て いる ので 、 今 アクティブ な シート の 何処 か １ か所 に A を 入力 し て おき ます 上記 test を ステップ 実行 する と 、 検索 後 の アドレス が イミディエイト ウィンドウ に 表示 さ れ ます ※ この 実行 で は おかしな ところ は あり ませ ん ね ？ A を 入力 し た セル と 右 横 の セル を 結合 し て 、 test を 実行 し て み ます おかしく なる ところ は あり ませ ん ね ？ その セル 結合 を 解除 し て 、 今度 は 下 の セル と 結合 し て 実行 し て み ます FindNext 後 の 、 Debug . Print で エラー に なり ます ね ･･･ この こと から 、 シート に は セル 結合 さ れ た 部分 が ある かも ･･･ これ を 前提 に 処理 記述 すれ ば 良い です ね > Dim date _ list ( 1000 , 5 ) これ は 、 事前 に MAX 行 数 分 用意 し て おい て ････ この よう な 場合 は 、 次元 を 入れ替え て ReDim が 使える よう に し て みる とか ･･･ 入れ替え て 作っ た 後 は 、 Transpose で 入れ替え て 設定 ･･･        i = 0        ReDim vA ( 1 To 2 , 1 To i + 1 )           i = i + 1           ReDim Preserve vA ( 1 To 2 , 1 To i )           With rng              vA ( 1 , i ) = . Offset (, 1 - . Column ). Value              vA ( 2 , i ) = . Value           End With        With Range (" A 2 "). Resize ( i , 2 )           . Value = WorksheetFunction . Transpose ( vA )        End With 雰囲気 以下 で どう なり ます か ※ F1 の 値 が どう の ･･･ チェック し て い ない ので ※ ※ 未検証 な ので 、 おかしかっ たら ごめんなさい Public Sub Samp 1 ()     Dim ws As Worksheet     Dim rng As Range , sAdr As String     Dim vA As Variant     Dim i As Long     Set ws = Worksheets (" 分け 方 ")     Set rng = ws . Cells . Find ( Range (" F1 "). Value , LookAt := xlPart )     If ( Not rng Is Nothing ) Then        i = 0        ReDim vA ( 1 To 2 , 1 To i + 1 )        sAdr = rng . Address        Do           i = i + 1           ReDim Preserve vA ( 1 To 2 , 1 To i )           With rng              vA ( 1 , i ) = . Offset (, 1 - . Column ). Value              vA ( 2 , i ) = . Value           End With           Set rng = ws . Cells . FindNext ( rng )           If ( rng Is Nothing ) Then Exit Do        Loop While ( rng . Address <> sAdr )        With Range (" A 2 "). Resize ( i , 2 )           . Value = WorksheetFunction . Transpose ( vA )        End With     End If End Sub 
正規表現 の 置換 で 処理 する の は 難しい と 思い ます 。 「 35 文字 以内 」 という 点 は 、 例えば 以下 の よう な 記述 で 可能 です 。 replaceallfast "^.{ 1 , 35 }(、|。|★)", "\\ 0 \\ n ", regular ; 行頭 から 改行 文字 以外 の 文字 が 、 1 個 以上 35 個 以下 連続 し た 後 に 、 「 、 」 か 「 。 」 か 「 ★ 」 が あっ た 場合 、 その 後ろ に 改行 文字 を 入れる 、 という マクロ です 。 「 一番 後ろ の 」 という 点 について は 、 正規表現 は 、 特に 何 も 指定 し なけれ ば 、 一番 長い 文字列 に ヒット し ます ので 、 問題 あり ませ ん 。 ただ この 場合 、 35 文字 以上 指定 文字 が ない 部分 が ある と 、 それ 以降 改行 さ れ ませ ん 。 パターン の 論理和 を 使っ て 「 35 文字 以内 に 指定 文字 が ない 場合 は 35 文字 で 改行 する 」 と 同時に 指定 でき ない もの か と 、 正規表現 を 色々 検討 し て 見 まし た が 、 私 の 知識 が 足ら ない せい な の か どうか 分かり ませ ん が 、 うまい 方法 を 見つける 事 が でき ませ ん でし た 。 指定 文字 で 改行 する マクロ と 、 35 文字 で 改行 する マクロ で 、 2回 に 分け て 行っ たら どう か 、 という 方法 も 検討 し まし た が 、 1 行 の 文字数 が ずれ て しまう ので 、 同時に 行う 必要 が ある と 思い ます 。 また 、 正規表現 で は 文字数 しか 指定 でき ませ ん が 、 整形 という 観点 から 言え ば 、 文字数 で は なく 桁 数 で 指定 し た 方 が いい の で は ない か 、 という 事 も あり ます 。 例文 の よう に 全て 全角 文字 なら いい です が 、 半角 文字 が 多い 行 は 短く なっ て しまい ます 。 結局 、 上 から 1 行 ずつ 処理 し て 行く の が いい 、 という 事 に なり まし た 。 以下 は サンプル マクロ です 。 setcompatiblemode 0 x2000 f ; // 改行 する 桁 数 の 定義 # lf _ column = 70 ; // 改行 する 指定 文字列 の 定義 $ lf _ str [ 0 ] ="、"; $ lf _ str [ 1 ] ="。"; $ lf _ str [ 2 ] ="？"; $ lf _ str [ 3 ] ="！"; $ lf _ str [ 4 ] ="★"; $ lf _ str [ 5 ] ="」"; $ lf _ str [ 6 ] ="（ 笑 ）"; $ lf _ str [ 7 ] =" ・ ・ ・ +"; // 中黒 が 3つ 以上 連続 # lf _ str _ num = 8 ; // 検索 用 文字列 の 作成 $ search _ str = $ lf _ str [ 0 ]; # i = 1 ; while ( # i < # lf _ str _ num ) { $ search _ str = $ search _ str + "|" + $ lf _ str [# i ]; # i = # i + 1 ; } begingroupundo ; disabled raw ; replaceallfast "\ n ", ""; // 改行 文字 を 一旦 全 削除 する gofiletop ; // 改行 挿入 ループ while ( 1 ) { beginsel ; move t o2 # lf _ column , lineno ; if ( code == eof ) break ; // ファイル の 最後 なら 終了 searchup 2 "(?\\ 2 )(" + $ search _ str + ")((?!" + $ search _ str + "))", regular , in select ; // ※ 1 insert "\ n \ n "; } escape ; // 選択 範囲 を 解除 insert "\ n "; // 最下 行 の 処理 gofiletop ; endgroupundo ; endmacro ; ※ 1 指定 文字列 が 見つから なけれ ば カーソル は 70 桁 目 から 動き ませ ん ので 、 検索 結果 に 関わら ず 、 カーソル 位置 で 改行 文字 を 挿入 し て い ます 。 (?\\ 2 ) は 、 秀丸 独自 の 「 ヒット し た 扱い に する タグ 指定 」 です 。 http:// hidemaruo . mydns .jp : 81 / helpsite / hidemaru / html / 190 _ CmdSearch _ R ... 普通 の 検索 で は 、 ヒット し た 文字列 の 頭 に カーソル が 移動 し ます ので 、 その 位置 で は 改行 文字 を 挿入 でき ませ ん 。 指定 文字列 が 固定 長 なら 、 検索 し た 後 に カーソル 移動 する など すれ ば いい です が 、 指定 文字列 が 可変長 な ので 、 こういう 方法 を 採っ て い ます 。 (?! … ) は 、 「 後方 不一致 指定 」 です 。 http:// hidemaruo . mydns .jp : 81 / helpsite / hidemaru / html / 190 _ CmdSearch _ R ... これ を 使わ ない と 、 指定 文字列 が 連続 し て いる 箇所 、 例えば 「 。 （ 笑 ） 」 の よう な 場合 に 、 「 。 」 の 後 で 改行 さ れ て しまい ます 。 指定 文字列 に 正規表現 の メタ文字 が 含ま れ て いる 場合 、 例えば 半角 の 「 ?」 など は 、 エスケープ し て 下さい 。 http:// www .s huiren . org / chuden / teach / hidemaru / seiki / 01 . htm $ lf _ str [ 8 ] ="!\\?"; // リテラル 文字 中 な ので 「 \」 は 2 個 必要 です 秀丸 独自 の タグ 付き 正規表現 で は 、 検索 文字列 の 最初 と 最後 に は 「 \ f 」 は 必要 あり ませ ん 。 また この 機能 は 制限 が 多い ので 「 一般的 正規表現 互換 の タグ 付き 正規表現 」 を 使っ た 方 が いい と 思い ます 。 
可能 で は ある の です が 、 具体 的 な URL や 、 その ページ の HTML ソース 全体 が ない と 、 方法 は 分かり ませ ん 。 具体 性 の ない 回答 なら ば 、 対象 タグ の 前 で 、 ID 属性 値 を 持つ タグ や 、 特定 できる NAME 属性 値 の タグ を 見つけ て 、 先 に それ を 取得 し 、 取得 し た もの から 更に 特徴 を 捉え て 絞り込み を 繰り返す 、 という 形 に なり ます 。 最終 的 に は 、 タグ 名 で 取得 し た もの の 中 から 順番 を 指定 する こと に なる でしょ う 。 
記載 の やり方 は テキストファイル 用 で あり ACCESS で は 通用 し ませ ん 。 というのも 、 ACCESS は DB ファイル を 開く と ファイル の 更新日 付 が その 時点 の 日時 に 書き 変わる から です 。 誤っ て 開い て しまっ た だけ で 即 更新 対象 です 。 運用方法 として は 何 通り か あり ます が 、 ここ で は DB の テーブル に バージョン 情報 を 持つ 方法 を 記し ます 。 DB ファイル として ３つ 必要 です 。 ( 1 ) 通常 運用 用 DB （ ローカル 配置 ） ( 2 ) 最新 版 DB （ サーバ 配置 ） ( 3 ) 更新 用 DB （ １ と 同じ 場所 ） DB ( 1 )( 2 ) に バージョン 管理 用 の テーブル を 設置 し ます 。 テーブル 名 を 「 tblVersion 」 と し ます 。 フィールド は とりあえず １つ で 、 名前 を 「 Version 」 と し ます 。 フィールド 型 は お 好み で どうぞ 。 DB ( 1 ) に 下記 の コード を 配置 し 、 DB スタート 時 に 起動 さ せ ます 。 '--- ここ から ↓ Const ttl = " バージョン チェック " Dim strRefDB Dim strQRY Dim RS Dim FLAG ' strRefDB = "【 配置 し た パス 】" & "\( 2 ) 最新 版 DB . accdb " strQRY = " Select * FROM tblVersion IN '' [ MS ACCESS ; DATABASE =" & strRefDB & ";]" On Error Resume Next Err . Clear Set RS = CurrentDb . OpenRecordset ( strQRY ) If Err . Number Then MsgBox " バージョンアップ 参照 の DB に 不具合 あり " & String ( 2 , 13 ) & Err . Number & vbCr & Err . Description , vbCritical , ttl Exit Sub ' Function End If On Error GoTo 0 FLAG = False If RS . RecordCount > 0 Then ' バージョン の 比較 If DLookup (" Version ", " tblVersion ") <> RS ! Version Then FLAG = True End If RS . Close Set RS = Nothing If FLAG Then If MsgBox (" 新しい バージョン が あり ます " & String ( 2 , 13 ) & " バージョンアップ し ます か ？", vbInformation + vbYesNo , ttl ) = vbYes Then ' 更新 用 DB を 起動 Shell """" & SysCmd ( acSysCmdAccessDir ) & " ms access . exe """ & " " & """" & CurrentProject . Path & "\( 3 ) 更新 用 DB . accdb """, vbNormalFocus ' そして 、 この DB は コピー 対象 と なる ので 終了 さ せる DoCmd . Quit End If End If '--- ここ まで ↑ あと は ( 3 ) 更新 用 DB で ファイル を コピー し 、 完了 し た 旨 を 告知 さ せ ます 。 ＜ 省略 ＞ （ もしか し たら ( 3 ) で ( 1 ) が 終了 する まで 待機 さ せる コード が 必要 かも ） 
Public Sub Samp 1 ()     Dim sS As String     Dim i As Long , k As Long     Const CROWF As Long = 5     Const CC F1 As String = "= SUM ( R [{% 1 }] C : R [- 1 ] C )"     Const CC F2 As String = "= IF ( RC [- 2 ]<> 0 , RC [- 1 ]/ RC [- 2 ],"""")"     Const CC F3 As String = _        "= SUMIF ( R [{% 1 }] C1 : R [- 1 ] C1 ,"" 小計 "", R [{% 1 }] C : R [- 1 ] C )"     Application .S creenUpdating = False     Application . Calculation = xlCalculationManual     k = CROWF     For i = CROWF To Cells ( Rows . Count , " A "). End ( xlUp ). Row        Select Case Cells ( i , " A "). Value           Case " 小計 "              sS = Replace ( CC F1 , "{% 1 }", k - i )              With Cells ( i , " C "). Resize (, 3 )                 . Cells ( 1 ). Resize (, 2 ). FormulaR 1 C1 = sS                 . Cells ( 3 ). FormulaR 1 C1 = CC F2                 . AutoFill . Resize (, Range (" AD 1 "). Column - 2 )              End With              k = i + 1           Case " 合計 "              sS = Replace ( CC F3 , "{% 1 }", CROWF - i )              With Cells ( i , " C "). Resize (, 3 )                 . Cells ( 1 ). Resize (, 2 ). FormulaR 1 C1 = sS                 . Cells ( 3 ). FormulaR 1 C1 = CC F2                 . AutoFill . Resize (, Range (" AD 1 "). Column - 2 )              End With              Exit For        End Select     Next     Application . Calculation = xlCalculationAutomatic     Application .S creenUpdating = True End Sub ' 確認 用 データ 作成 Public Sub testData ()     Dim r As Range     Dim i As Long , j As Long     Const CRH As Long = 130     Randomize     Application .S creenUpdating = False     Cells . Delete     For i = 5 To CRH - 1        With Cells ( i , " A ")           Select Case i              Case 5 , CRH - 1                 . Value = . Address ( False , False )                 For j = 2 To Range (" AD 1 "). Column - 1                    . Offset (, j ). Value = Int ( 100 * Rnd ()) + 1                 Next              Case Else                 If ((. Offset (- 1 ). Value <> " 小計 ") _                       And ( Rnd () > 0 . 8 )) Then                    . Value = " 小計 "                 Else                    . Value = . Address ( False , False )                    For j = 2 To Range (" AD 1 "). Column - 1                       . Offset (, j ). Value = Int ( 100 * Rnd ()) + 1                    Next                 End If           End Select        End With     Next     Cells ( i , " A "). Value = " 小計 "     Cells ( i + 1 , " A "). Value = " 合計 "     Columns . AutoFit     Application .S creenUpdating = True End Sub 
"([^,\(\)]+)(,|\(|$)" で どう です か 。 Public Sub Sample () Dim rex As RegExp Set rex = New RegExp rex . Pattern = "([^,\(\)]+)(,|\(|$)" rex . Global = True Dim s As String s = " 桜島 , 富士山 ( 静岡 ), 八ヶ岳 ( 長野 )" Dim mc As MatchCollection Set mc = rex . Execute ( s ) Dim i As Long For i = 0 To mc . Count - 1 Debug . Print mc ( i ). SubMatches ( 0 ) Next End Sub 
2015 の ほう から 古い プロジェクト を 開く と 「 古い んで コンバート し ます か ？ 」 って きい て き て 「 はい 」 んで コンパイル する と 警告 や エラー 出る んで 、 虱潰し に それ を 尚 し て ゆく だけ の 作業 です わ 
List の 配列 で もし ２ 列 が １ で ない なら ・ ・ ・ i を すっ 飛ばす から エラー に なる 。 List の 配列 は １つ ずつ 増加 する に は 別 の 変数 が 必要 。 Private Sub UserForm _ Initialize () Dim i As Long , j As Long Dim lastRow As Long ListBox 1 . ColumnCount = 2 For i = 2 To 6 If Worksheets ( 2 ). Cells ( i , 2 ) = 1 Then ListBox 1 . AddItem Worksheets ( 2 ). Cells ( i , 1 ) ListBox 1 . List ( j , 1 ) = Worksheets ( 2 ). Cells ( i , 2 ) j = j + 1 End If Next End Sub 
A さん が 9 : 30 から 10 : 30 に 予約 し た 場合 は 予約 シート に は どの よう に 記入 さ れる の でしょ う か ？ 日付 は 予約 券 印刷 の シート の どこ に 出力 すれ ば よい の でしょ う か ？ 予約 時間 は 予約 券 印刷 の シート の どこ に 出力 すれ ば よい の でしょ う か ？ 予約 さ れ た ID は 予約 券 印刷 の シート に 出力 し なく て も 良い の でしょ う か ？ 同 一 日 に 同 一 ID で 複数 の 予約 が 入る こと は ない の でしょ う か ？ 
質問 文 の 場合 だ と 、 それぞれ の 行 で 最大 に 色 を つける の です ね 。 VBA とか 今 の 設定 を どう 変更 さ せる か より 、 最初 から の 設定 方法 を 覚え た 方 が いい と 思い ます 。 先 に 条件 を 付け たい 範囲 を 範囲 指定 し て から 式 は = AND ( E 4 <>"", E 4 = MAX ($ E 4 :$ AJ 4 )) 適用 先 は 自動 で =$ E $4 :$ AJ $17 に なり ます 。 あえて E 4 <>"" を つけ た の は 、 行 全体 が 空白 の 場合 全て に 色 が つい て しまう の を 防ぐ ため です 。 条件 付き 書式 設定 の 数式 で は 、 適用 先 の セル 範囲 を 考え て 、 適宜 アドレス に $ を つける か つけ ない か が 決まっ て き ます 。 
Sub sample () Dim rng As Range For Each rng In Range (" A 4 : A3 3 , A3 8 : A 42 ") With rng . Value = StrConv (. Value , vbNarrow ) End With Next rng End Sub 繰返し の コード は 1回 で 済まし ましょ う 。 
CCS - C は 未経験 です が 、 調べ た ところ int i ; は ８ ビット 値 0 - 255 な ので long i ; 16 ビット 値 0 - 65535 に 変え て み て は ？ 参考 先 http:// www . pic fun. com / cinst 03 . html 
表 の 形 は わかり ませ ん が 、 コード を 実証 し まし た が エラー が 再現 し ませ ん でし た 。 どの 行 で エラー 起き て い ます か ？ ただ ↓ Select Case TCol の Tcol が 何 も 格納 さ れ て い ない ので 9 , 10 行 で なに も 起き ない～ やる なら i 文字 色 の 変数 に も なに も 格納 さ れ て い ない～ 変数 を 使わ ず 直接 指示 ブレークポイント を 使っ て コード の 実証 を し て ください 。 コード の 左端 を クリック し て ● を つけ たら 、 イベント コード で も そこ で 処理 が 一時停止 し ます 。 F8 キー で ステップ 実行 できる ので 、 あと は 変数 を マウスオン や ローカル ウィンドウ を 使っ て 確認 し て み ましょ う 。 
前提 が 各 数値 が １ セル ごと に 入っ て いる の で あれ ば 、 VBA にて 可能 です 。 ただ 明示 さ れ て い ませ ん が 、 ３ ポイント 離れ た 数値 と の 比較 は 真下 の セル だけ を 比較 でしょ う か ？ それとも フィーリング カップル ばり に すべて の 組み合わせ に ライン 成立 を 判定 する の でしょ う か ？ 
新しい プログラム を 作る 事 は 、 新しい 物 を 発明 しよ う と する の と 同じ で 、 失敗 の 繰り返し です 。 な ので 、 ある程度 どの よう に する か は 分かっ て いる よう です ので 、 作り 始める の が 一番 の 早道 です 。 作り ながら わから ない 部分 を 知ら べ 、 失敗 し ながら 作り上げる しか 無い です 。 尚 、 リレーショナル データベース は テーブル の 構造 が 簡単 な ２ 次元 の 表 で 持っ て いる ので 、 SQL も 簡単 で 、 命令 数 も 少ない ので 習得 は 容易 です が 、 簡単 な 分 、 実際 の プログラム 作り に は 知恵 が 必要 です ( 簡単 な 機能 を 組みあわせる 知恵 )、 また 、 RDBMS の 違い で 方言 の よう な 文法 の 異なる 部分 も 結構 沢山 ある ので 注意 が 必要 です 。 データ の 操作 する 部分 は SQL を 使う 事 で 、 全て プログラミング言語 で 対応 する より も 、 格段 に 簡単 に 早く 出来る ので 、 多分 、 データベース に データ を 登録 する まで は 早く 出来る と 思い ます 。 難しい の は 警告 を 出す 判断 の プログラム と 想定 し ます 。 
Clen 関数 なんて 無い と 思い ます 。 整数 に 丸める なら 、 Round ( 8030 / 81 , 0 ) です 。 
Private Sub Worksheet _ BeforeDoubleClick ( ByVal Target As Range , Cancel As Boolean ) Dim xhy If Target . Column = 5 Then With Me . Range (" E 4 "). Value = Target . Value MsgBox . Range (" E 4 "). Value & " を リンク 表示 し ます " Set xhy = . Hyperlinks . Add ( Anchor :=. Range (" E3 "), Address :=" https :// www . google . co.jp / maps / place /" _ & . Range (" E 4 "). Value , TextToDisplay :=" 地図 を 開く ") xhy . Follow NewWindow := True End With End If End Sub 関数 を Follow しよ う と する の は 無理 が ある の でしょ う ？ 
フロントエンド を サーバ 上 の 共有 フォルダー に 置く という 方法 も 考え られ ます が 、 破損 の 危険 性 が 高い らしく お 勧め でき ませ ん 。 また 、 ユーザー が 使用 中 は 上書き 更新 でき ませ ん ので 、 ユーザー が 使用 し て ない とき に しか 更新 でき ませ ん 。 フロントエンド は ローカル において 、 サーバー 上 の 共有 フォルダー に 最新 ファイル を おい て 、 ローカル と サーバー の ファイル の バージョン を 比較 し て 、 更新 さ れ て い たら コピー し て 上書き する という 方法 が いい か と 思い ます 。 下記 で WSH スクリプト を 紹介 し て い ます ので ご 参考 に 。 複数 ユーザー で 共有 し て いる 場合 の フロントエンド ファイル の バージョンアップ http:// hatenachips . blog 34 . fc2 . com / blog - entry - 422 . html ただし 、 上記 は フロントエンド の パス は 固定 な ので 、 下記 の 方法 で スクリプト の パス を 取得 し て それ を 利用 する よう に し て ください 。 スクリプト と フロントエンド は 同じ フォルダ に 置き ます 。 WSH で スクリプト ファイル 自身 が 存在 する フォルダ パス を 取得 する - Qiita http:// qiita . com / asterisk 9101 / items / 54 cdcedb 9 ef60 ea 0 bb 21 WSH スクリプト の 方法 を 紹介 し まし た が 、 Access 自身 で 起動 用 の プログラム を 作成 し て も いい でしょ う 。 
書籍 じゃ ない です が 、 、 ここ 。 http:// office tanaka .net / excel / 
下記 の コード でいか が でしょ う か 。 基本 的 な 考え方 は kotashiji 10 _ 10 さん の 作っ た プログラム に 合わせ て あり ます 。 ただし コピー 先 の 列 は 質問 に 合わせ て B ～ D 列 に し て あり ます 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st 2 As Worksheet Dim r1 As Long , fnd As Range , r2 As Long Application .S creenUpdating = False Set st 1 = ActiveWorkbook . Worksheets (" Sheet 1 ") Set st 2 = Workbooks (" データ 一覧 . xlsx "). Worksheets (" Sheet 1 ") ' 一旦 管理 シート の B 列 から D 列 を クリア する st 1 . Range (" B 3 : D " & Rows . Count ). ClearContents ' 管理 シート の A 列 を 3 行 目 から 最終 行 まで 繰り返す For r1 = 3 To st 1 . Range (" A " & Rows . Count ). End ( xlUp ). Row ' データ 一覧 の A 列 から 管理 シート の A 列 の 値 を 検索 する Set fnd = st 2 . Columns (" A "). Find ( st 1 . Range (" A " & r1 ). Value ) ' 存在 し て い たら データ を 転記 する If Not fnd Is Nothing Then ' 一致 し た データ の 行番号 を 取得 する r2 = fnd . Row st 1 . Range (" B " & r1 ). Value = st 2 . Range (" D " & r2 ). Value ' 管理 シート の B 列 に データ 一覧 の 4 列 目 ( D 列 ) の 値 を 転記 する st 1 . Range (" C " & r1 ). Value = st 2 . Range (" H " & r2 ). Value ' 管理 シート の C 列 に データ 一覧 の 8 列 目 ( H 列 ) の 値 を 転記 する st 1 . Range (" D " & r1 ). Value = st 2 . Range (" I " & r2 ). Value ' 管理 シート の D 列 に データ 一覧 の 9 列 目 ( I 列 ) の 値 を 転記 する Else ' 存在 し て い なかっ たら メッセージ を 表示 する MsgBox " 検索 でき ませ ん " End If Next r1 Application .S creenUpdating = True MsgBox " 終了 し まし た 。 " End Sub 
MouseMove イベント を 使い ます 。 MouseEventArgs . Button から 、 ボタン が 押さ れ て いる か どう か を 取得 し て ください 。 
回答 が つい て い ない よう な ので ・ ・ ・ http:// xfs .jp / WdQq 8 PW : 38 q 8 f1 1 s まじめ に 回答 を 求める なら 「 ID 非公開 」 は やめ 、 同 一 ＩＤ で 質問 す べし 。 
質問 主 様 こんにちは。 ● まず 、 名前 を 先 に 指定 さ せる に は 、 コード の 前後 入れ換え で よい です 。 fileName = ・ ・ ・ の 後 に ThisWorkbook .S aveAs ・ ・ ・ を 実行 すれ ば よい です 。 ● デスクトップ フォルダ 指定 の 末尾 に "\" を 付ける こと も 前 回答者 殿 の 指摘 通り です 。 ● 実行 時 エラー 1004 が 出る 理由 の 可能性 は ２ か所 あり ます 。 ( 1 ) コード から 読み取る と 、 セル E2 , E3 , I 4 に は 日付 が 入力 さ れ て いる と 思い ます が 、 日付 の スラッシュ ("/") 記号 は ファイル 名 として 使え ない 文字 です ので 、 含ま れ て いれ ば エラー に なり ます 。 ( 2 ) ファイル 保存形式 を マクロ 有効 テンプレート ファイル として 保存 する 意図 で 、 ファイル 名 の 最後 に 拡張子 . xltm を 付け て いる と 思い ます が 、 これ で は ファイル 保存形式 を 変更 する 指示 に は なり ませ ん 。 SaveAs 命令 に 追加 の 引数 が 必要 です 。 コード として は こんな 感じ です 。 ------------------------- Dim fileName As String ' ファイル 名 作成 ※ 拡張子 は 付け ない fileName = " 保存 名 " & Range (" B 8 ") & " 様 " & Range (" J 8 ") & " 日程 " & Range (" E2 ") & " ～" & Range (" E3 ") & " 会議 日 " & Range (" I 4 ") If MsgBox ( fileName & " で 保存 し ます か ？", vbYesNo ) <> vbYes Then Exit Sub ' 保存 する か 確認 し て 保存 し ない 場合 は 終了 Application . DisplayAlerts = False ' 同名 の ファイル が ある 場合 の 警告 禁止 ( 必要 なら ) ' 指定 フォルダ に 保存 ThisWorkbook .S aveAs " C :\ Users \ myname \ Desktop \" & fileName , xl O pen XMLTemplateMacroEnabled Application . DisplayAlerts = True ' 警告 許可 ( 上 で 警告 禁止 し た 場合 は 警告 許可 に 戻す ) ------------------------- あと 、 蛇足 です が 、 デスクトップ フォルダ は PC ごと に 違う ので 、 固定 で コード に 書き込ま ず に 環境変数 から 取得 する 方法 も あり ます 。 ( VBA 中級 テクニック です ) Dim wSH As Object Dim DT folder As String Set wSH = CreateObject (" WScript .S hell ") DT folder = wSH .S pecialFolders (" Desktop ") 
ActiveWorkbook .S ave の 前 に くっつけれ ば いい の だ と 思い ます が 。 （ シート 名 を 指定 し て い ない の が 気 に なり ます が ） 検索 は ” A " が なかっ た とき エラー に なら ない 、 ワーク シート 関数 の COUNTIF が 最適 です ね 。 Sub ボタン _ Click () '------------ Dim i As Long , r As Range Dim lastrow As Long '------------- Application .S creenUpdating = False Dim FileName As String ChDrive Left ( ThisWorkbook . Path , 2 ) ChDir ThisWorkbook . Path FileName = Dir ("*. xls *") Do While FileName > "" If FileName <> ThisWorkbook . Name Then Workbooks . Open FileName Range (" J : J , L : L , N : N , P : P , R : R "). Delete Shift := xlToLeft '-------------- lastrow = Cells .S pecialCells ( xlCellTypeLastCell ). Row For i = lastrow To 1 Step - 1 Set r = Range ( Cells ( i , 1 ), Cells ( i , 5 )) If WorksheetFunction . CountIf ( r , " A ") Then Rows ( i ). Delete End If Next '--------------- ActiveWorkbook .S ave ActiveWorkbook . Close End If FileName = Dir Loop Application .S creenUpdating = True End Sub 
こんな 感じ です 。 ・ ・・・・・・・・・・・・・・・・・・ Sub test () Dim temp As Range For Each temp In Range (" A1 : B2 0 ") If temp . Value >= 1 . 5 Then temp = temp & " ↑" End If Next End Sub 
ファイル を 開く とき に 入力 （ テキスト モード ） で 開い て いる ので 、 テキスト に なら ない データ は 無視 さ れ ます 。 ファイル を バイナリ モード で 開く Dim buf As Variant Open myFileName For Binary As # 1 buf = InputB ( 10 , # 1 ) では どうでしょう ？ 
下記 の コード でいか が でしょ う か ？ Public Function CellColor ( セル 位置 As String ) As Long CellColor = Range ( セル 位置 ). Interior . Color End Function Sub セル 色 数値 換算 () Dim Aa As Integer Dim Bb As Integer Aa = 4 Bb = 22 Range (" C " & Aa + 0 & ":" & " BI " & Aa + 0 ). Formula = "= cellcolor ("" C " & Bb + 0 & """)" Range (" C " & Aa + 1 & ":" & " BI " & Aa + 1 ). Formula = "= cellcolor ("" C " & Bb + 3 & """)" End Sub 
こんにちは。 単純 に 、 update の 設定 で 出来 ない 、 という の だ と 、 仕様 の 限界 かも しれ ませ ん 。 エクセル の 作業 ウィンド を 標準 に し て 、 画面 の 外 に 配置 し て 、 これら の コード を 実行 し て 、 正しい 位置 に 戻す 、 という 方法 は 、 試し て み て ください エクセルアプリ の ウィンド 制御 の コード です よ 。 
参照 設定 の 呪縛 から 逃れ たい の で あれ ば 、 Set cb = CreateObject (" new :{ 1 C3 B4 210 - F4 41 - 11 CE - B 9 EA - 00 AA 006 B 1 A6 9 }") With cb .S etText Cells ( 1 , 1 ). Value . PutInClipboard End With 
VB.NET http:// log . windows 78 .net / 2015 / 03 / 1295 / C# http:// tomosoft .jp / design /? p = 5543 DLL で 提供 さ れ て いる API を コール し て いく 形 に なる と 思い ます 。 C# の 参考 サイト が 自分 が 見 た 限り で は 、 基本 的 な 部分 を 抑え て いる と おもわ れる ので 、 こちら を 参考 に VB.NET へ 置き換える よう な 形 です と 、 いい か と 思い ます 。 
計算 結果 が セル A １ に 表示 さ れる と する と ・ ・ 。 Sub Message () If Range (" A1 "). Value < 0 Then MsgBox " マイナス だ よ " End If Ens Sub 
vanvalia さん 、 こんばんは 。 ストライク な 回答 で は ない です が ・ ・ ・ ・ 。 当方 の 環境 （ Windows 7 - 32 bit 、 EXCEL 2010 ） で 試し た ところ 、 非表示 範囲 きっちり で ない 行 指定 で 、 隠さ れ た行 の Hidden プロパティ False に し た行 は 、 問題 なく 表示 さ れ まし た 。 ( テスト で は 、 " 5 : 30 " 行 を 隠し た 状態 で 、 " 6 : 30 "、" 5 : 31 "、" 10 : 20 " など を 実行 し て み まし た 。 ) 非表示 行 に 結合 セル を 含む 場合 でも 問題 なかっ た です し 、 オート フィルタ 機能 で 隠さ れ た行 について も 問題 なく 実行 さ れ まし た 。 質問 内容 です と 、 「 何 も 起こら ない 」 という こと な ので 、 エラー 表示 も 何 も ない 、 という こと です ね ？ で あれ ば 、 . Hidden プロパティ の 設定 方法 そのもの に 問題 が ある の で なく て 、 別 の ところ に 問題 が あり そう な 気 が し ます 。 ( 例えば 、 コード 例 で は 、 Rows オブジェクト に ワーク シート の 修飾 子 が ない ので 、 アクティブ シート が 操作 の 対象 と なり 、 それ 以外 の シート に は 作用 し ない ので そういう 類 の 問題 で ない か と 推測 し ます 。 ) プログラム の コード と 、 その ブック の 環境 が 判ら ない ので 、 これ 以上 の 考察 は 難しい です 。 
すべて の コード から Worksheets (" テスト "). ← 最後 の ドット も 含む を 削除 し て み て は どう です か 。 
IF text 1 . text ="" then msgbox " メッセージ を 入力 し て ください " end if とか 
こんな 感じ です 。 ・ ・・・・・・・・・・・・ Private Sub CommandButton 1 _ Click () Randomize Dim a As Integer a = 6 Dim c , d , j , h As Integer Dim b ( 6 ) As Integer h = 0 owari : j = 0 d = Int ( Rnd () * a + 1 ) For c = 0 To a - 1 If b ( c ) = d Then j = 1 End If Next If j = 1 Then GoTo owari ElseIf h < a - 1 Then b ( h ) = d h = h + 1 GoTo owari End If If h = a - 1 Then b ( h ) = d End If For c = 0 To a - 1 TextBox 1 . Text = TextBox 1 . Text & b ( c ) & " " Next End Sub Private Sub Command Bu t to n2 _ Click () a = 0 TextBox 1 . Text = "" End Sub 
Change 等 の 他 の イベント で 動作 を 試さ れ まし た か ？ 
惜しい ！ > fun c1 ( tmp ()) fun c1 tmp 括弧 は 不要 です 。 
Set sh 1 = Sheets (" Sheet 1 ") Set sh 2 = Sheets (" Sheet 2 ") For i = 0 To sh 1 . Range (" C4 : C 23 "). Count - 1 sh 2 . Cells ( 6 , 7 + i * 2 ). MergeArea . Value = sh 1 . Cells ( 4 + i , 3 ). Value Next コピー 先 が 結合 さ れ て いる よう です ので 、 MergeArea を 使用 し て 値 を 設定 し ます 。 
数 か所 変数 名 に ミス が あり ます 「_ root . last _ pass _ 1 」 が 「 _ root ._ last _ pass _ 1 」 と なっ て いる 等々 作り は だいぶ 違い ます が 、 自分 が 以前 作っ た 時 に は 以下 の よう な スクリプト で やり まし た < 初期化 > _ root . last _ pass =""; < 左 > on ( release ){ _ root . last _ pass = _ root . last _ pass + " 左 "; } < 右 > on ( release ){ _ root . last _ pass = _ root . last _ pass + " 右 "; if (_ root . last _ pass . indexOf (" 左 左右 右 左右 ")!=- 1 ){ _ root . last _ flg = true ; // 正しい 順序 で 押し た 時 の 処理 } } 
「 メソッド 」 と 「 引数 」 の 区別 が 理解 でき て い ない よう です 。 VBA の 基本 的 な こと です から しっかり 理解 し て 下さい 。 コード は 下記 の よう に なり ます 。 Sub Macro 1 () ' 選択 し た セル 範囲 の 周囲 に 実線 を 引く Selection . BorderAround Line Style := xlContinuous ' 選択 し た セル の 水平 罫線 に 実線 を 引く Selection . Borders ( xlInsideVertical ). LineStyle = xlDot ' 選択 し た セル の 垂直 罫線 に 実線 を 引く Selection . Borders ( xlInsideHorizontal ). LineStyle = xlDot End Sub 
VB 2010 で 実行 し て み まし た が 、 線 は 途切れる こと が 有り ませ ん でし た よ ？ 何 か ブレイク ポイント とか つけ てる ん で は ない でしょ う か ？ 
自分 だっ たら 、 部分 一致 も 含め て instr を 使い ます ね 。 If instr ( sh 2 . Cells .(" i ", 4 ). Valuen , Books )> 0 And instr ( sh 2 . Cells .(" i ", 5 ). Value , authors )> 0 And instr ( sh 2 . Cells .(" i ", 6 ). Value , Series )> 0 Then 空白 なら すべて 一致 に なる し 、 テキストボックス で の 入力 なら 完全 一致 する ほど 記憶 が 完璧 じゃ ない ので 。 コピー 数 が 増える と 時間 が かかる ので Application .s creenupdating = false は 入れ とい た ほう が いい ですよ。 
日々 の 商品 の 流れ と 最終 日 の 在庫 を 分けて シート に すれ ば いい の で は text bo x1 = 日 付け textbox 2 = 品番 text bo x3 = 在庫 数 text bo x4 = 生産 数 他 に TEXTBOX 5 = 出荷 数 が 必要 でしょ う しかも TEXTBOX 3 , 5 出庫 数 と 在庫 数 を 入替え た ほう が 良い 在庫 数 は 入力 する もの で なく カウント する もの だ から 。 それ を 踏まえ て TEXTBOX 1 ～ TEXTBOX 4 は Ｓｈｅｅｔ １ の 日々 の 移動 状況 項目 が A 列 Ｂ 列 Ｃ 列 Ｄ 列 月日 品番 出庫 数 生産 数 SHEEＴ 2 に A 列 Ｂ 列 Ｃ 列 Ｄ 列 Ｅ 列 品番 出庫 数 生産 数 在庫 数 初期 在庫 出庫 数 は = SUMIF ( Sheet ! B : B , A 2 , Ｓｈｅｅｔ 1 ! C ; C ) で 品番 毎 の 出荷 数 が 生産 数 = SUMIF ( Sheet ! B : B , A 2 , Ｓｈｅｅｔ 1 ! Ｄ ; Ｄ ) で 品番 毎 の 生産 数 が 出 ます 。 在庫 は 各 初期 在庫 + 生産 数 - 出庫 数 で 最終 日 の 在庫 数 が 出 ます 。 日々 の 生産 数 と 出庫 数 は シート １ を ピボットテーブル で 表示 する 日々 の 在庫 まで 必要 で あれ ば シート ２ の 値 を シート ３ に 毎日 値 貼り 付け こんな 手 で は いかが でしょ う か ? 
売上 管理 A . xlsm と 同時に 開き たく ない ブック 全て に 、 下記 の Open イベント マクロ を 書く しか 方法 は ない の で は 、 と 思い ます 。 それぞれ の ThisWorkbook に 下記 を 記載 し て おけ ば 可能 です 。 Private Sub Workbook _ Open () Dim wb As Workbook For Each wb In Workbooks If wb . Name = " 売上 管理 A . xlsm " Then MsgBox "「 売上 管理 A . xlsm 」 が 開い て いる ので 他 の ブック は 開け ませ ん " ThisWorkbook . Close Exit For End If Next wb End Sub 
USB 接続 の バーコードリーダー は キーボード と 同等 な ので 、 単なる 文字 入力 として 扱い ます 。 セル の 属性 は 日本語 コントロールオフ 、 バーコードリーダー の 設定 は 改行 コード 付加 、 と し とけ ば 一 発 読む ごと に 次 の セル に 移動 し ます から 、 2つ の セル の 値 が 等しい か どう か 判定 し ましょ う 。 
以下 の プログラム を 、 各 オートシェープ に 登録 し て ください 。 線 の 長さ は 、 B 列 に 入力 し て ある もの と し て ます 。 Sub sample () Dim sh As Worksheet Set sh = ActiveSheet With sh .S hapes ( Application . Caller ) . Width = sh . Cells (. TopLeftCell . Row , " B "). Value End With End Sub 個人的 に は 、 「 B 列 の 値 を 変更 すれ ば 、 自動的 に 線 の 長さ が 変更 さ れる 」 という ほう が 使い やす そう に 思え ます が 。 。 。 。 
お 役 に 立て て 何より です 。 優先順位 と いう より は 、 製品 ごと に 生産 可能 な 日付 を 指定 する と 、 副次的 に 生産 する 順序 を 設定 する こと が でき ます 。 （ 実際 に は 生産 でき ない 日 の 生産量 を 0 に 制限 する ） 詳しい こと は 下記 に 追加 し て い ます 。 広め に 生産 可能 日 を 設定 する 方 が 平準化 が うまく いく かも 知れ ませ ん 。 http:// note . chiebukuro . yahoo . co.jp / detail / n3 89664 
貴方 の マクロ の 目的 は 良く 分かり ませ ん が 単純 に 挿入 で あれ ば Rows (" 36 : 36 "). Select Selection . Copy Rows (" 36 : 36 "). Select Selection . Insert Shift := xlDown 36 行 を コピー し て 36 行 に コピー し た行 を そのまま 挿入 です 。 こう すれ ば 36 行 目 に 入っ て いる 式 は そのまま 行き ます し 1 行 ずれ て 所 は 自動的 式 を 変更 し て くれ ます 。 もちろん 罫線 も 追随 し ます 。 36 行 目 を 式 のみ いれ て 空白 行 に し て おく 事 です 。 もし 37 行 目 に = SUM () の 式 が あれ ば = SUM ( A1 : A3 6 ) と 空白 行 まで 入れ て おけ ば = SUM () 行 が 38 行 目 に なっ た とき 自動的 に = SUM ( A1 : A3 7 ) と 成り ます 。 ５ 回 繰り返す 繰り返 し たい の なら Rows (" 36 : 36 "). Select は マクロ に せ ず まず 空白 行 を 選ん で マクロ を 実行 すれ ば よい 最初 から 5 行 と 決まっ て いる なら L = Active Cell . Row Rows (" L : L "). Select Selection . Copy Rows (" L : L + 5 "). Select Selection . Insert Shift := xlDown という 方法 も 有る 。 指定 し た行 Ｎｏ を 取得 し コピー し それ を その 行 から 5つ 下 の 行 まで コピー する という 方法 です 。 
> for next ステートメント は 他 に 使用 方法 が ある の でしょ う か 。 For ～ Next 文 は 、 変数 （ 今回 の 場合 「 a 」) の 値 を 、 開始 値 から 終了 値 まで 、 一定 の 増分 で 増やし ながら 、 For ～ Next で 挟ま れ た ステップ を 実行 する だけ 。 変数 が 実際 の 処理 に 使わ れよ う が 、 使わ れ まい が 関係 あり ませ ん 。 お 示し の コード で は 、 Next の 直前 の ステップ Base = Base + 17 で 、 変数 ： Base の 値 が 変更 さ れる ので 、 繰り返し の なか で 、 参照 さ れる セル が 17 行 ずつ 下 に ずれ て 処理 さ れ て い ます ね 。 次 の よう に 書く と 解り 易かっ た の かも 。 。 。 Base = 9 For a = 1 To 20 ↓ For Base = 9 To 349 Step 17 
お 使い の 構文 は 、 XL20 03 まで に 使用 さ れ て い た もの 。 XL20 03 まで は 、 並び 替え の キー は ３つ まで です 。 な ので 、 「 Key 4 」 など の キーワード は 使え ませ ん 。 XL20 07 以降 の 環境 で 、 並び 替え の 操作 を 行い 、 マクロ 記録 を 録 れ ば 、 コード の 元ネタ は 手 に 入り ます 。 
tmkzu 0801 さん 、 こんにちは。 データ を 書き換える 列 が 、 B 列 から G 列 に なっ た 、 という こと です ね 。 最小限 の 変更 で 対応 する なら ば 、 Dt = Range ( Range (" A 2 "), Cells ( Rows . Count , 1 ) _ . End ( xlUp )). Offset ( 0 , 1 ) を Dt = Range ( Range (" A 2 "), Cells ( Rows . Count , 1 ) _ . End ( xlUp )). Offset ( 0 , 6 ) に 、 Range ( Range (" B2 "), Cells ( UBound ( Dt ) + 1 , 2 )) = Dt を Range ( Range (" G2 "), Cells ( UBound ( Dt ) + 1 , 7 )) = Dt に すれ ば よい と 思い ます 。 
temp + 1 と 指定 すれ ば よろしい か と 思い ます 。 Sub test () Dim temp As Long temp = 1048576 Do While Range (" A " & temp ). Value = "" temp = temp - 1 Loop MsgBox temp End Sub 
変 数 a に 「 1 a 2b " 3 c4 " d 5 」 が 入っ て いる 場合 に 中身 の ダブルコーテ － ション を 二 重 に し たい なら a = Replace ( a , """", """""") で どう です か ？ 
ほんとに 、 「 連続 印刷 できる マクロ は 組め まし た 。 」 でき た ん です か ？ 文章 から は 、 ちゃんと し た もの が 組め た よう に 思え ませ ん 。 説明 が 大まか すぎ ます ｡ 他人 に は わかり ませ ん 。 シート の 追加 だけ 書き ます ｡ Dim 新 シート 名 As String Dim Ws 新 As Worksheet 新 シート 名 = Cells ( 2 ," E "). Value Set Ws 新 = Worksheets . Add Ws 新 . Name = 新 シート 名 ただ 、 動い た から 良い わけ で は あり ませ ん 。 VB の １ 行 １ 行 の 意味 を 理解 し て い ない と 応用 が 利き ませ ん 。 応用 が 利か ない という こと は 、 いつまでも 初心者 という こと です 。 
どの よう に 履歴 を 残し たい の か に も よる でしょ う ね 少なけれ ば テキストファイル に 書き出す と 言う の は あり ます が 、 ボタン を 押す たび に 書き込ん で は 面倒 だ から 、 リスト クラス に 順に 保存 し て おき 最後 に 書き出す とか ？ 希望 と は 違う なら スルー し て 下さい ちなみに 携帯 な ので 具体 的 コード は 提示 でき ませ ん っていう か 、 どの よう に 組み込め ば 良い か 検討 が つか ない 
＞ Run では なく できれ ば Ｃａｌｌ が いい です 。 Call で は でき ませ ん 。 Run を 使用 し て ください 。 
こんにちは。 主 様 、 コード は 、 set p = me. image 1 p . loadpicture という よう に 、 ターゲット は オブジェクト に し て ください 。 単純 に dim p as object だけ で は 、 実行 時 エラー に なり ます よ 
自動 で は なかっ た はず です 。 下記 を 参考 に し て 頑張っ て コマンド を 記述 し て ください 。 http:// language - and - engineering . hatena blog .jp / entry / 20130502 / Patter ... http:// www . atmarkit . co.jp / ait / articles / 1506 / 26 / news 026 . html 
以前 の 質問 の 続き で あれ ば 、 せめて 前 質問 の リンク を 示し て ください 。 初めて 見る 人 に は 伝わり ませ ん 。 新規 タブ が 発生 し ない の で あれ ば 、 そのまま 、 現状 の IE オブジェクト 変数 を 利用 する だけ です 。 「 IE 」 という 名前 で 使っ て いる の で あれ ば 、 それ を そのまま 利用 する だけ で 良い の です 。 同じ タブ ・ ウインドウ で ページ 遷移 し て いる 限り 、 制御 元 の 変数 は 同じ です 。 
グーグルスプレッドシート なら スクリプトエディタ を 開い て デフォルト の function myFunction (){} を 削除 し た 上 で 以下 を 記述 し て 保存 し ます 。 function onOpen () { Browser . msgBox (" 記入 漏れ が ない か 必ず 確認 し て ください "); } 保存 し たら いったん スプレッドシート を 閉じ 、 また 開い て 下さい 。 そう し たら メッセージ が 現れる と 思い ます 。 
star _ msr 0246 さん , こんにちは。 例えば 、 こんな 感じ です か 。 Sub hoge () ' 対象者 の シート を 追加 作成 Dim hoge As Range Dim er As Long For Each hoge In Worksheets (" Main "). Range ( Worksheets (" Main "). Range (" B 9 "), Worksheets (" Main "). Cells ( Rows . Count , " B "). End ( xlUp )) On Error Resume Next Worksheets ( hoge . Value ). Activate er = Err . Number On Error GoTo 0 If er <> 0 Then Sheets (" data "). Copy After := ActiveSheet ActiveSheet . Name = hoge . Value End If Next hoge Worksheets ( 1 ). Activate End Sub シート を 作る 前 に 、 その シート 名 で Activate メソッド を 実行 し ます 。 シート が なけれ ば エラー が 発生 し ます から 、 その エラー を On Error で 拾っ て 判定 さ せ て ます 。 
> エクセル 2013 の 関数 について 教え て ください 。 関数 に 別 セル に 何 か を 実行 する 機能 は 一切 あり ませ ん 。 関数 は 計算 結果 を 表示 する 為 の もの です 。 
以下 で どう なり ます か Public Sub Samp 1 ()     Dim r As Range     Dim v As Variant     Application .S creenUpdating = False     With ActiveSheet . UsedRange        With . Offset ( 1 , 2 ). Resize (. Rows . Count - 1 , . Columns . Count - 2 )           For Each r In .S pecialCells ( xlCellTypeConstants )              v = r . Value              Select Case v                 Case " 公休 ": v = " × "                 Case Is <= 0 : v = " × "                 Case 1 To 360 : v = "△"                 Case 390 To 510 : v = "▲"                 Case 540 To 1440 : v = "◎"              End Select              r . Value = v           Next        End With     End With     Application .S creenUpdating = True End Sub もしくは >     With ActiveSheet . UsedRange ↓     With ActiveSheet . Range (" A1 "). Current Region 
パスワード 付 で の 出力 は 、 Acrobat 付属 の Office 用 COM アド イン 「 Acrobat PDFMaker Office COM Addin 」 を 利用 する しか 方法 は 無い よう です 。 もし Acrobat が インストール さ れ て いる なら ば 下記 サイト 参照 下さい 。 https :// www . ka - net . org / blog /? p = 6209 名前 A ～ X の シート のみ を PDF 出力 （ パスワード 無し ） する の は 、 ． For Each ～ Next で 全 シート を ループ し ます 。 ． シート 名 を Like 演算子 で 調べ ます 。 Like " 名前 [ A - Z ]" ． ヒット し た シート を アクティブ に し ます 。 ． アクティブ シート を ExportAsFixedFormat Type := xlTypePDF で 出力 し ます 。 ※ 出力 先 は この マクロ が 保存 さ れ て いる フォルダ に し て い ます 。 ※ エラー 発生 時 の 処理 は 考慮 し て い ませ ん 。 －－－－－ サンプル コード －－－－－－ Sub PDF 出力 () Dim objSheet As Worksheet ' ループ 用 の 変数 Dim fName As String ' 保存 先 フォルダ パス ＆ ファイル 名 ' ブック の 全 シート を 1 つ ずつ ループ し て 処理 する For Each objSheet In ThisWorkbook . Worksheets If objSheet . Name Like " 名前 [ A - Z ]" Then objSheet .S elect fName = ThisWorkbook . Path & "\" & objSheet . Name & ". pdf " ActiveSheet . ExportAsFixedFormat Type := xlTypePDF , fileName := fName End If Next End Sub － － － － － － － － － －－－－－－－－－－－－－－－－－－－－－－－－－ 
現在 6 シート の ブック に 人数 分 300 シート も 追加 しよ う と し て いる の です よ ね ？ 一つ だけ シート を 追加 し て 、 名前 を 入力 で その 人 の データ を 表示 という 形式 で は だめ な の です か 。 無駄 に シート が 多く なる だけ の よう に 思い ます 。 印刷 が 目的 なら なおさら 、 そうした 方 が いい と 思い ます 。 
コード 例 です 。 A 列 の ２ 行 目 から 最終 行 まで の セル を 一 個 ずつ コピー し て B 1 セル 、 C1 セル 、 D1 セル 。 。 。 の よう に 貼り 付け ます 。 20 列 目 まで 貼り 付け たら 、 次 の 行 に 貼り 付け ます 。 Cells ( i , 1 ). Copy Destination := Cells ( j , m ) Destination で 貼り 付け 先 を 指定 し て い ます 。 - - ------------------------- Sub macro 1 () Dim i , j , m m = 2 j = 1 For i = 2 To Cells ( Rows . Count , 1 ). End ( xlUp ). Row Cells ( i , 1 ). Copy Destination := Cells ( j , m ) If m < 20 Then m = m + 1 ' m が 20 より 小さい 時 は 、 1 を 加算 Else m = 2 ' 1 ずつ 加算 し て いっ た m が 20 より 小さく なかっ た 場合 '( 20 列 目 まで ペースト し た 場合 ) ' m ( 貼り 付ける 列 ) を 2 に し ます 。 j = j + 1 ' j ( 貼り 付ける 行 ) を 1 、 加算 し ます 。 End If Next Application . CutCopyMode = False End Sub - - - ------------------------- 上 の コード の 場合 、 一 個 ずつ コピペ を 繰り返す ので 時間 が かかり ます 。 20 行 分 の セル を まとめ て コピー し て ( 行 ・ 列 を 入れ替え て 貼り 付け ） を する の が 下 の コード に なり ます 。 Transpose を True に する と 、 ( 行 ・ 列 を 入れ替え て 貼り 付け ) が でき ます 。 - - ------------------------- Sub ma cr o2 () Dim i , j j = 1 For i = 2 To Cells ( Rows . Count , 1 ). End ( xlUp ). Row Step 20 Cells ( i , 1 ). Resize ( 20 , 1 ). Copy Cells ( j , 2 ). PasteSpecial Paste := xlPasteValues , Transpose := True j = j + 1 Next Application . CutCopyMode = False End Sub 
こんにちは。 コード を ぱっと み た だけ な ん です が 、 For Each rng In sh . Range (" A 2 ", sh . Cells ( Rows . Count , 1 ). End ( xlUp )) On Error Resume Next Set sh 0 = Worksheets ( rng . Offset (, 1 ). Value ) これ 、 データ が 50 行 だ として 、 A 2 から A5 0 の セル の ループ で B2 から B5 0 の シート 名 を 処理 し て ます よ ね 、 For Each rng In sh . Range (" A 2 ", sh . Cells ( Rows . Count , 1 ). End ( xlUp )) On Error Resume Next if sh . Range (" W " & rng . row ). value = "○" then Set sh 0 = Worksheets ( rng . Offset (, 1 ). Value ) という よう に し たら いい ん です が 、 シート の コピー な ので 、 単一 ファイル に なっ て いる 、 という の でし たら 、 示し た if が 必要 な コード です 。 Next rng End With End Sub の 手前 に end if を 追加 し て ください 
リスト ボックス ２ 、 リスト ボックス ３ の SelectedIndex プロパティ を 設定 し たら どう です か ？ 
元々 シート が ５ 枚 あっ た として 、 シート １ から ５ まで 調べよ う と し た けど 、 途中 で 該当 シート を 削除 し て ４ 枚 に なっ た のに 、 予定 通り ５ 枚 目 を 調べよ う として エラー に なっ た の でしょ う 。 対策 ： 削除 する 時 は 最後 から 始め て 最初 に 戻る の が いい です 。 変更 前 ： For i = 1 To Worksheets . Count 変更 後 ： For i = Worksheets . Count To 1 Step - 1 
Sub sample () Dim i As Long i = 9 With Worksheets (" Main ") Do While . Cells ( i , " B "). Value <> "" . Hyperlinks . Add Anchor :=. Cells ( i , " B "), Address :="", SubAddress := _ . Cells ( i , " B "). Value & "! A1 " i = i + 1 Loop End With End Sub 
d 5 _ monkey さん 、 こんにちは。 Pictures オブジェクト で 挿入 さ れ た 画像 は 、 デフォルト で 縦横 比 が 固定 さ れ て いる 様子 です ので 、 画像 の 縦横 比 と セレクション 範囲 の 縦横 比 を 比較 し て 、 縦 ・ 横 どちら の 値 を 設定 する か 選択 する If 文 を 入れ て みる の が よい か と 思い ます 。 こんな 感じ です 。 ( 追加 修正 箇所 は '▽▽▽▽ と '△△△△ の 間 の 行 です 。 ) Sub 選択 セル に 合わせ て () Dim myFileName As String If TypeName ( Selection ) <> " Range " Then MsgBox " セル を 選択 し て 実行 し て 下さい 。 " Exit Sub End If myFileName = Application . GetOpenFilename ( _ FileFilter :=" 画像 ,*. jpg ; *. gif ; *. bmp ", MultiSelect := False ) If myFileName <> " False " Then With ActiveSheet . Pictures . Insert ( myFileName ) . Left = Selection . Left . Top = Selection . Top '▽▽▽▽ If . Width / . Height > Selection . Width / Selection . Height Then . Width = Selection . Width Else . Height = Selection . Height End If '△△△△ End With End If End Sub 
既に 回答 が つい て い ます が 、 C1 3 に 空白 が 入っ て い ませ ん か ？ もし 空白 も BLANK と 同一 と 見なし たい の で あれ ば IF ( ISBLANK ( TRIM ( C1 3 )), "", VLOOKUP ( C1 3 ,[★★ 一覧 ★★. xlsm ] 現場 一覧 !$ B $5 :$ C $70 , 2 , FALSE )) として み て 下さい 。 あるいは C1 3 に は 本当は 数値 の 0 が 入っ て い て 、 数式 設定 で 見かけ 上 何 も 表示 し ない よう に し て い ませ ん か ？ 更に ・ ・ ・ VLOOKUP の 結果 が ＃ N/A に なる 可能性 が ある の です から 、 その 場合 は どの よう な 値 に し たい の かも 考え て 下さい 。 もし 空欄 に し たい の で あれ ば = IF ( ISBLANK ( TRIM ( C1 3 )),"", IFERROR ( VLOOKUP ( C1 3 ,[★★ 一覧 ★★. xlsm ] 現場 一覧 !$ B $5 :$ C $70 , 2 , FALSE ),"")) と し て ください 。 
回答 を 修正 し まし た 。 A3 を 選択 し た 状態 で 、 [ Ctrl ][ Shift ][ アスタリスク (*)] を 同時に 押す と 選択 できる 範囲 を データ 範囲 と みなし ます 。 フィルタ の 条件 を 書き出す セル 範囲 AA 1 : AC 4 データ を 出力 する セル AE 3 と し て い ます 。 ● AE 3 から 数え て 、 下 に １ ０ ０ ０ 行 ： 右 に 100 列 の 範囲 ( AE 3 : DZ 1002 ) を データ 出力 前 に クリア し て から 出力 し ます ● - - - - - - ------------------------- Sub 複数 条件 フィルタ () Dim 検索 NO , 検索 NO2 , 検索 NO 3 Dim LR Dim 条件 範囲 LR = Cells ( Rows . Count , 1 ). End ( xlUp ). Row Set 条件 範囲 = Range (" AA 1 : AC 4 ") Range (" AE 3 "). Resize ( 1000 , 100 ). Clear Range (" A3 : C3 "). Copy Range (" AA 1 ") 検索 NO = InputBox (" 検索 NO ", Default :=" 22050 ") 検索 NO2 = InputBox (" 検索 NO2 ", Default :=" 3389770 ") 検索 NO 3 = InputBox (" 検索 NO 3 ", Default :=" 67312 H ") Range (" AA 2 ") = 検索 NO Range (" AB 3 ") = 検索 NO2 Range (" AC 4 ") = 検索 NO 3 Range (" A3 "). Current Region . AdvancedFilter _ xlFilterCopy , _ 条件 範囲 , Range (" AE 3 "), False Application . Goto 条件 範囲 , True End Sub 
A 21 は シャツワンピ と チェニックワンピ の 両方 が ヒット し ます が 、 その 場合 は どちら を 選ぶ の でしょ う か ？ 
こんにちは。 まず 、 編集 前 データ の シート に 2 行 目 の 「 空白 行 」 を 作成 し ます 。 rows () は 、 コピー し て 、 編集 前 データ に ペースト その あと rows () は delete し て ください 今 の 動作 は 、 仕様です 。 カット と 削除 は 、 まったく コード が 違い ます よ シート な ん です から 
私 は ID 非公開 で こういう 質問 を する 人 は 信用 し ない こと に し て ます ので 具体 的 な 回答 を する 気 は 全く ありません が 「 検索システム を 作ろ う 」 と いっ て いる の なら 人任せ に し て は いけ ない と 思い ます 。 あなた 自身 に VBA の 知識 が ない なら 無理 な 相談 です 。 ちゃんと 勉強 し て か ら 挑戦 し て 分から ない ところ を 質問 し て 下さい 。 という か マクロ 云々 の 前 に 一般 機能 を ちゃんと 勉強 し た 方 が いい です 。 フィルタ の 詳細 設定 を 記録 マクロ に する だけ でも できる でしょ う し デー タベースクエリ で パラメータ を 設定 する 形 なら マクロ も いらん でしょ う 。 言葉 が 厳しく なる の は ID 非公開 質問者 が 嫌い だ から なので あしからず 。 
質問 文 で 「 実行 し た ところ エラー が 発生 」 と 書か れ て い ます が 、 kuro _ neko _ g _ san さん の 回答 へ の 返信 を 見る と ビルド 時 の エラー です よ ね 。 ( 実行 まで 行け て い ない はず ) 技術 的 な 話 を する 場合 です ので 、 どういう 環境 で 、 どういう 事 を し た とき に 、 どういう エラー が 出 た 、 という の を 正確 に 記述 し なけれ ば 正しい 情報 の やりとり が 出来 ませ ん 。 本題 です が 、 その エラー 内容 は リンク 時 の エラー です ので lib ファイル の 参照 が 出来 て い ない という こと に なり ます 。 まず 、 MIDI IO d.l ib と MIDIIO . lib は 1つ の ビルド 構成 で 片方 のみ を 設定 し ます 。 ビルド 構成 という の は 「 Debug 」 とか 「 Release 」 とか 選択 を 切り替え られる やつ です 。 すなわち 、 「 Debug 」 ビルド 用 の 設定 で は 「 MIDI IO d.l ib 」 の 参照 を 。 「 Release 」 ビルド 用 の 設定 で は 「 MIDIIO . lib 」 の 参照 を 行い ます 。 ( プロジェクト の 設定 ダイアログ で も 左上 で どの ビルド 構成 を 対象 に し て いる か わかり ます ) 次に 正しい パス で 参照 を 行わ なけれ ば なり ませ ん 。 リンカ の 入力 欄 に 単に 「 MIDIIO . lib 」 など ファイル 名 のみ を 記述 し て も だめ です 。 lib ファイル を どこ に 置く か に より ます が 、 たとえば 「 MIDIIO . lib 」 を ソリューション ファイル (*. sln ) の ある 場所 に 作っ た 「 rls 」 フォルダ 内 に 置い た 場合 に は 、 リンカ 入力 に 「 $( Solution Dir ) rls \ MIDIIO . lib 」 と 指定 する こと に なり ます 。 よく 分から なけれ ば 、 ひとまず 動作 さ せる ため に フル パス で 指定 し て おい て 先 に 進む の も 手 です 。 ( その 場合 は 後で 理解 し て より メンテ し やすい 設定 に なおし ましょ う ) そして 、 サンプル の コード を 実行 し て 音 を 出す に は 上 に も すこし 書き まし た が 環境 も 影響 し て き ます 。 リンク 先 の サンプル コード で は 古い OS よう に なっ て い ます が 、 たとえば Windows 7 で あれ ば 「" Microsoft GS Wavetable SW Synth "」 の 部分 は 「 " Microsoft GS Wavetable Synth "」 に 変える 必要 が あり ます 。 ( あるいは 他 に インストール し て あれ ば その MIDI音源 名 ) 当方 の 環境 で 試し た ところ 、 それ らしい 音 が でる こと は 確認 出来 まし た 。 
Set Opnbook 2 = Workbooks . Open ( FPss ) で 、 Opnbook 2 は 、 絶対パス Fpss の ワークブック という ワークブック オブジェクト として い し て いる ので 、 Opnbook 2 . Activate で アクティブ に でき ます 。 Workbook (). Activate の 括弧 内 は 、 絶対パス で は なく 、 インデックス 番号 か 、 ワークブック オブジェクト の Name プロパティ に なり ます 。 例 ： book 1 . xlsx 
> マクロ ＆ VBA の 通信 講座 に 取り組ん で おり 、 下記 課題 が 分ら なく たぶん 、 課題 の ある 章 の 内容 で 答える の で は ・ ・ 。 問題 文 から する と 、 セル B2 の 文字 が A9 から A5 4 まで の 中 で あれ ば 、 その 文字 を 「 太字 」 という 文字列 に 置換 する と 考え ます 。 Sub 書式 の 置換 () Dim rng As Range , B2 As String , Word As String B2 = Range (" B2 ") Word = " 太字 " For Each rng In Range (" A9 : A5 4 ") rng . Value = Replace ( rng . Value , B2 , Word ) Next rng End Sub ただ 、 書式 の 置換 と なっ て いる ので 、 もしかして B2 の 文字 を 太字 という 書式 に し なさい と も 受け取れ ます ね 。 それなら 以下 で 可能 です 。 Sub 書式 の 置換 () Dim rng As Range For Each rng In Range (" A9 : A5 4 ") If rng . Value = Range (" B2 "). Value Then rng . Font . Bold = True End If Next rng End Sub 
https :// www . microsoft . com / ja - jp / download / details . aspx ? id = 26347 ここ から ダウンロード し まし た ？ また 、 Win 7 は 32 bit です か ？ 64 bit です か ？ x86 は 32 bit 用 です ので 、 64 bit の 場合 は 、 x64 版 を ダウンロード し て ください 。 
うむ 、 調べ たら 面白かっ た です 。 https :// social . msdn . microsoft . com / Forums / windows / ja - JP / ed 6960 a6 - 414 ... 
うむ 、 調べ たら 面白かっ た です 。 https :// social . msdn . microsoft . com / Forums / windows / ja - JP / ed 6960 a6 - 414 ... 
加工 指図 書 を 閉じる 時 に どう し て いる か じゃ ない か ？ そこ は 提示 さ れ て ない けど . Close False と し ない と . Close だ と 上書き保存 さ れる の かも 
Sub あああ () Dim S As Worksheet For Each S In Worksheets S . Cells . Copy S . Cells .S elect S .S election . PasteSpecial ( xlPasteValues ) Next S End Sub 
なんか 解り 難い ロジック です ね 。 移動 位置 が ずれ て いく ので 解り 難い の です か ね ？ 後ろ から 、 1番 前 に 移動 し て いけ ば 解り やすい でしょ う 。 Sub シート 設定 () Dim myRange As Range ' 表 を 格納 する 変数 Dim myCell As Range ' 表 を 格納 する 変数 For i = 4 To 1 Step - 1 For Each myCell In Range (" A1 : I 1 ") If Cells ( i , 10 ). Value = myCell . Value Then myCell . EntireColumn . Cut Columns ( 1 ). Insert shift := xlToRight Exit For End If Next Next End Sub 
例えば 、 j = Range (" A1 "). Cells ( Application . Match ( i , Range (" C1 : C80 "), 0 ), 1 ). Value エラー 回避 は 適宜 工夫 し て ください 。 
VBA で フィルタ で 抽出 し た データ は どう やっ て コピー し ます ？ たとえば ３ 列 ２ ０ 行 の 表 から ３ 列 ５ 行 が 抽出 さ れ た と し ます 。 これ を コピー し て A 25 に 貼り 付ける に は Range (" A1 : C 20 "). Copy Range (" A 25 ") または クリップボード を 使わ ない で Range (" A1 "). Current Region . Copy Destination := Range (" A 25 ") など と し ます ね 。 これ は どういう 意味 でしょ う か ？ HIdden を 使っ て 同じ よう に し た 表 を 同じ コード で コピー する と 全部 コピー さ れ て しまい ます 。 明らか に フィルタ と HIdden で は 違う こと を やっ て いる の が わかる と 思い ます 。 ちょっと 調べ て み て も わかり ませ ん でし た が フィルタ は 抽出 結果 の アドレス を 変換 し て いる の かも しれ ませ ん 。 HIdden の 場合 は Range (" A1 : C 20 "). SpecialCells ( xlCellTypeVisible ). Copy Destination := Range (" A 25 ") の SpecialCells ( xlCellTypeVisible ) で 変換 し て いる の で は ？ など と 妄想 し て み まし た 。 MS は OFFICE の コード を 公開 し て い ない らしい ので 調べる の は 大変 かも しれ ませ ん 。 また 記事 も 少ない と 思い ます 。 
管理 用 の シート を 追加 し て 、 ボタン に 以下 の 処理 を 追加 し て み て は どうでしょう か 。 Private Sub CommandButton 1 _ Click () With ActiveSheet ' 番号 を 取得 no = . Range (" B 3 "). Value ' 番号 に 一致 する 行 の データ を 取得 select _ row = Range (" B 6 : B2 2 "). Find ( no ). Row book _ path = . Cells ( select _ row , 3 ). Value active _ sheet = . Cells ( select _ row , 4 ). Value ' 対象 の ブック を 開く Workbooks . Open book _ path ' 対象 の シート を アクティブ 化 ActiveWorkbook .S heets ( active _ sheet ). Activate End With End Sub 
フィルター を 使用 する なら フィルター の 詳細 設定 を 利用 すれ ば 良い 他者 で 利用 事業者 が 東京 の データ を シート ２ に 出す なら 添付 の 画像 を 参照 下さい 。 シート ２ の １ 行 目 に は 図 で は シート １ の 千 項目 を コピー し て い ます 。 が 必要 な 項目 だけ また 並び 変え て コピー し て おき ます 。 そして Ｋ １ ： Ｌ １ に 条件 項目 を コピー し て おき ます 。 そして 実際 に Ｋ２ に 他社 Ｌ ２ に 東京 と 入力 し て おき ます 。 他社 大阪 の シート も 作成 し て おき ます 。 自社 の シート も 作成 但し 自社 の 条件 は 自社 だけ なら K 列 のみ 入力 これから が マクロ に なる ので マクロ も 記録 で 作成 すれ ば でき ます 。 が まず 記録 せ ず やっ て み て ください 。 東京 の 場合 シート ２ で A1 : H1 を 選択 後 フィルター の 詳細 設定 を クリック 画面 の オプション 設定 画面 が で て き ます 。 抽出 先 を 指定 し た 範囲 に チェック を 入れ リスト 範囲 を Ｓheet 1 ! A : H と 列 のみ 指定 （ 実際 SHEET 1 に 移り 選択 すれ ば 可 ） 検索 条件 を K 1 : L 2 と 入力 抽出 範囲 を 最初 に コピー さ れ た 必要 な 項目 全部 なら A1 : H1 0 と 入力 し ます 。 行 数 が 足り なく なる と 追加 する か どう か 聞い て くる ので 行 数 は 適当 で 可 これ で ＯＫ を おせ ば 他社 で 東京 だけ の データー が コピー さ れ ます 。 この 詳細 設定 を 押し て OK を 押す まで を マクロ と し て ください 。 一つ だけ なら マクロ も 必要 ない です が 部署 が 多い ので 一連 の マクロ に する か 地区 ごと に マクロ を つくる か 自由 です 。 ただ 最初 だけ リスト 含む など の 警告 が で ます が かまわ ず ＯＫ で 可 です 。 
ワーク シート の 名前 が 、 全 件 に なっ て い ない と 、 Set ws = ThisWorkbook . Worksheets (" 全 件 ") ここ で 出 ます よ 。 
Excel vba は Excel が 起動 し て い なけれ ば 動き ませ ん 。 Windows の タスクスケジューラ で その 時刻 に マクロ 付き の Excel ブック を 起動 さ せる こと が できる ので workbook _ open イベント を 記述 すれ ば 自動 実行 に なり ます 。 
全て 、 バラバラ に 覚え て ください 。 いま 、 ムリ に 連結 する と 混乱 し て 嫌 に なる と 思い ます 。 では 、 私 の 順番 で 説明 し ます 。 メソッド と は 、 命令 文 です 。 IF 文 とか 、 While 文 とか です 。 関数 と は 、 ある 機能 の 塊 です 。 Excel で SUM 関数 とか あり ます が 、 あれ は 実際 は 指定 さ れ た セル を 足し算 する 機能 が ある 関数 と なり ます 。 さき に 述べ た メソッド と の 違い は 、 プログラム や ソフト によって 名前 が 違う だけ 。 と 今 は 思っ て 下さい 。 VBA の IF 文 ( メソッド ) と EXCEL 関数 の IF 関数 の よう に 明らか に 同じ もの も あり ます が 、 関数 と 呼ぶ 単位 は 何 か ？ を 自分 で 作っ て 感じ ない と 理解 でき ない と 思い ます 。 変数 と は 、 プログラム における データ を 扱う 箱 の 事 です 。 データ型 と 一緒に 話 が 出 て くる の は 、 この 為 です 。 定数 と は 、 定数 、 定め られ て た 、 定め た 値 です 。 プログラム 上 、 固定 し て おき たい 値 です 。 Dim lngA as long で 変数 lngA を 宣言 し まし た 。 これ で 、 long の ルール に 基づく 値 を 格納 する 箱 が 生まれ まし た 。 static SyouhiZei as long = 1 . 08 これ で 、 slngA と 言う 名前 の 100 の 値 を プログラム 上 で 使える よう に なり まし た 。 この 違い は 、 lngA に は 、 long の ルール に 従う 限り 、 好き な 値 を 格納 でき ます が 、 SyouhiZei に は 値 を 格納 する 事 は 出来 ない と 言う こと です 。 正確 に は 、 SyouhiZei は 箱 で さえ ない です 。 lng 型 の 100 と 言う 値 に slngA と 言う 別名 を 付け た の です 。 宣言 に は 、 見え ない 言葉 も 隠れる 事 や 省略 記述 しか 許さ ない ソフト が あり ます 。 Dim lngA as long は 、 本当は 、 Dim lngA as new long と 現代 で は 記載 さ れる べき 内容 です 。 この 事 は 、 後で 述べる オブジェクト ( オブジェクト 思考 ) に 基づく もの です 。 さて 、 なぜ 定数 なんて 必要 か と 言う と 、 例えば SyouhiZei = 1 . 08 の よう な 値 を 毎回 1 . 08 と 記載 する と 、 全て の 処理 を 将来 は 1 . 10 に 書き換える 必要 が あり ます が 、 定数 化 する と 、 宣言 し た 所 だけ 1 . 10 に 書き換えれ ば 、 別名 ( 1 . 08 と 宣言 し た Syouhizei ) を 記載 し た 箇所 全て を 書きかえ た事 に なる から です 。 定数 と は 、 別名 を つける こと な の です 。 事実 、 コンパイル 時 に 全て の 定数 は 1 . 08 に 書き換え られ ます 。 これ が 定数 です 。 引数 の 説明 はしません 。 これ は 、 名前 だけ です 。 呼び方 です 。 覚え て ください 。 関数 に 渡す の が 引数 です 。 ステートメント 、 これ も 覚え て ください 。 メソッド に対して 、 指定 や 追加 命令 など の オプション を 施す 際 に 、 引数 の よう に 書く の です 。 オプション も 、 そのまま 覚え て ください 。 付加 。 付け加える 。 必要 な 情報 または 追加 情報 の 指定 です 。 optional は 、 指定 し たら その 値 を 使用 し 、 未 指定 なら 事前 に 決め た デフォルト 値 が 使用 さ れる だけ で 、 実際 に は 関数 など に 渡す 際 は 、 こちら が 各 手間 を 省い て いる だけ です 。 オプション 値 は 、 こちら が 指定 し なけれ ば 、 勝手 に 裏 で 記載 さ れ て い ます 。 見え て い ない だけ です 。 引数 の 値 渡し 、 参照 渡し に関して は 、 今回 は 省き ます 。 オブジェクト は 、 関数 や クラス の くくり です 。 関数 も オブジェクト です 。 クラス も オブジェクト です 。 つまり 、 枠 です 。 宣言 を し て 、 初めて 実体 ( 箱 ) を 持ち ます 。 具体 的 に は 、 オブジェクト と は 設計書 です 。 設計書 だけ で は 、 何 も 出来 ませ ん 。 それ を 元 に 作っ た の が 宣言 を し た 変数 です 。 ミカン の 箱 の 設計書 を 元 に 、 ミカン の 箱 ( 実体 ) を 作る ( 宣言 する ) の です 。 設計書 に は 、 ミカン ( 値 ) は 入り ませ ん が 、 箱 ( 実体 ) に は 入り ます よ ね 。 この 実体 を 別名 で インスタンス と 呼び ます 。 な ので 、 宣言 を インスタンス化 と 呼ぶ 書物 も あり ます 。 値 が 入る もの は 、 全て インスタンス化 し ない と 無理 です 。 紙 の 上 に 、 スープ は 注げ ませ ん 。 そんな 処 です 。 勘違い し ない で 頂き たい の は 、 入れる と は 、 A = X の よう に 書く とき だけ と は 、 限り ませ ん 。 関数 で も 引数 に は 実体 が 必要 です 。 メソッド に は 事前 に 用意 さ れ て いる だけ です 。 用意 済み の 箱 を メソッド は 持っ て い ます 。 ちなみに 、 箱 、 箱 と 書き まし た が 、 物理 的 な 話 を する と 、 例えば 、 lngA の 場合 は 、 long 型 、 つまり 64 bit を 、 物理 メモリ に 確保 する 事 を 指し ます 。 ここ は 、 lngA の 領域 だ と 、 CPU に 伝え て 確保 する の です 。 まあ 、 こんな 説明 が 限界 か なぁ 。 
sheriedolce さん 、 こんにちは。 まずは F8 で 逐次 実行 さ せ て 、 どこ の 行 で エラー が でる か 、 確認 し て み ましょ う 。 （ On Error は 一旦 無効 に し て 。 ） たぶん 怪しい の は 、 クエリ テーブル 削除 の 行 でしょ う 。 ws . Names (" CsvData "). Delete で なく て 、 ws . QueryTables (" CsvData "). Delete と す べき か と 思い ます 。 （ 元 の 書き方 で は 、 シート の セル 範囲 に 付け られ た 名前 を 削除 する 命令 に なる と 思い ます 。 ） ご 確認 ください マセ 。 
どの 程度 を エクセル を 使いこなせ て い ます か 。 1 クリック で 、 という の は マクロ を 作成 する 事 に なり ます 。 一般 的 な 考え方 です が 、 固定 情報 で ある 「 マスター 」 と 日々 の 来院 という 、 固定 で ない データ 「 トランザクション 」 を 別に 管理 する の が 基本 です 。 まず 顧客 マスター を 1つ の シート に 登録 し ます 。 これ が > また 、 No. に対し 氏名 、 年齢 、 住所 、 電話番号 など 、 > パーソナルデータ を 登録 さ せる こと は 可能 です か ？ の 回答 に なり ます 。 可能 か 、 では なく 登録 を し て 下さい 。 これ は 手作業 です 。 日々 の データ は 日付 、 顧客 、 担当者 など その 時 の 情報 を どんどん 入力 し て いき ます 。 この データ が あれ ば 、 色々 な 集計 は エクセル の 機能 を 使っ たり 関数 で 出来 ます 。 最終 形 だけ が イメージ に あっ て 、 ワン クリック で 、 と 考え て しまう と 、 融通 の きか ない もの に なっ て しまい ます 。 まずは 基本 に 沿っ て データ を 作成 する 事 が 大切 です 。 機能 や 関数 を 使いこなせ たら 、 その あと で マクロ の 処理 を 勉強 さ せる と いい と 思い ます 。 
元々 の アプリ が 最大 化 / 最小 化 に 対応 し て い ない （ ウインドウ サイズ 固定 ） な の で は ない です か ？ 
situmontarou 777 さん 、 こんばんは 。 画像 が 小さく て 質問 内容 が うまく 読み取れ ない です が 、 本文 と 合わせ て 推定 で 回答 し て み ます 。 元 と なる データ は Sheet 1 に あっ て 、 A 列 ＝ 入庫 日 、 B 列 ＝ 入庫 時間 、 C 列 ＝ 商品名 、 D 列 ＝ 入庫 数 、 E 列 ＝ 梱包 員数 、 F 列 ＝ 入庫 箱 数 、 と なっ て おり 、 ２ 行 目 が タイトル 行 で 、 ３ 行 目 以下 が データ 列 で ある と し ます 。 E 列 は １ 箱 に 入る 商品 数 の 最大 値 と し ます 。 Sheet 2 に 展開 し た 後 の データ を 書き込み ます 。 表 の フォーマット は Sheet 1 と 同じ で 、 データ セル は 空白 で ある と し ます 。 下 の コード を 標準 モジュール に コピペ し て 実行 し て み て ください 。 - - - - - - - - - - - - - - - - - ------------------------- Sub 入庫 展開 () Dim i As Long , j As Long , lp As Long Dim vData ( 1 To 1000 , 1 To 6 ) Dim inQty As Integer , inEnv As Integer , inBuf As Integer With Worksheets (" Sheet 1 "). Range (" A3 ") '▼ 展開 元 セル 指定 i = 1 j = 0 Do While . Cells ( i , 1 ). Value <> "" inQty = CInt (. Cells ( i , 4 ). Value ): inBuf = inQty inEnv = CInt (. Cells ( i , 5 ). Value ) Do While inBuf > 0 j = j + 1 vData ( j , 1 ) = . Cells ( i , 1 ). Value vData ( j , 2 ) = . Cells ( i , 2 ). Value vData ( j , 3 ) = . Cells ( i , 3 ). Value vData ( j , 4 ) = inQty vData ( j , 5 ) = -( inBuf > inEnv ) * inEnv - ( inBuf <= inEnv ) * inBuf vData ( j , 6 ) = 1 inBuf = inBuf - inEnv Loop i = i + 1 Loop End With Worksheets (" Sheet 2 "). Range (" A3 "). Resize ( j , 6 ). Value = vData '▲ 展開 先 セル 指定 End Sub - - - - - - - - - - - - - - - - - ------------------------- シート 構成 、 フォーマット が 違う 場合 は 、 コメント に ▼ ▲ が 書い て ある 行 の Worksheets 指定 と Range 指定 を 修正 し て もらえ ば よい です 。 また 、 扱える データ の サイズ は 、 展開 後 で 1000 行 まで に し て い ます 。 1000 行 を 超える 場合 は 、 Dim ｖData の 引数 を 適宜 変更 し て ください 。 まずは お 試し ください 。 
wantatta 01533 さん 、 こんばんは 。 書か れ た 説明 文 だけ で はやり たい こと を 理解 する の が 難しい です が 、 下記 の よう に 適当 に 推定 し て コード を 書い て み まし た 。 データ は Sheet 1 シート に あり 、 A 列 が グループ 番号 、 B 列 が なんらかの 数値 、 C 列 が グループ 番号 毎 の 数値 の 合計 値 が 書き込ま れ て いる と し ます 。 １ 行 目 は タイトル 行 として 、 ２ 行 目 から データ が 記入 さ れ て いる 、 と し ます 。 A 列 に ある グループ 番号 を 検索 キー として 、 A 列 を 検索 列 、 B 列 を 合計 列 として SUMIF を 取り 、 その 値 が C 列 の 値 と 一致 する か どう か を 比較 し ます 。 比較 結果 を D 列 に 一致 / 不一致 で 書き込み ます 。 下記 コード を 標準 モジュール に コピペ し て お 試し ください 。 - - - - ------------------------- Sub グループ カウント () Dim rg As Range Dim comp With Worksheets (" Sheet 1 ") ' 処理 シート 指定 Set rg = . Range (" A 2 ") ' 処理 開始 グループ 番号 セル 指定 Do While Not ( IsEmpty ( rg )) comp = WorksheetFunction .S umIf (. Range (" A : A "), rg . Value , . Range (" B : B ")) If rg . Offset (, 2 ). Value <> comp Then rg . Offset (, 3 ). Value = " 不一致 " Else rg . Offset (, 3 ). Value = " 一致 " End If Set rg = rg . Offset ( 1 ) Loop End With Set rg = Nothing End Sub - - - - ------------------------- 
試しに 手元 で 動かし て み た けど エラー に なら ない な 。 どこ で エラー 吐い てる か 教え て もらえる ？ 原因 不明 でも とりあえず 回避 し たい だけ なら 、 On Error を 使う と いい よ http:// office tanaka .net / excel / vba / statement / OnError . htm 
これ だけ なら マクロ なんか 作ら ない で 一覧 表 と SUMIF 関数 で 簡単 に できる の で は マクロ の 方 が 関数 より 優れ て いる わけ で は ない ですよ。 マクロ は あくまで 繰り返し 作業 の 手抜き で なにか トリガー が 必要 関数 は 瞬時 に 計算 し て くれ ます 。 マクロ の 勉強 という こと なら マクロ の 手順 を 繰り返す こと です 。 一つ 一つ 作業 を 行っ て 見る こと です 。 まず 店舗名 ごと これ は 店舗名 が 違っ て も 同じ シート 別 シート その 抜き出し 方 は わかっ て ます か ? 次に 同じ 店舗 で 商品 別 の データー 行 の 抽出 の 方法 は ? この よう に 作成 する 手順 を 一つ 一つ 分解 し て 命令 語 に 変え て いく の が マクロ です 。 関数 の よう に いきなり 結果 を 表示 できる もの で は あり ませ ん 。 マクロ を 勉強 しよ う と する なら この 手順 を 一つ 一つ 覚え て いく 必要 が 有り ます 。 やり方 は 人 によって いろいろ に なっ て き ます 。 その 一つ 一つ の 作業 の どこ が わから ない という 質問 なら 回答 でき ます 。 
ブック を 定義 し た 方 が いい と 思い ます 。 Dim wb As Workbook と 定義 し て Workbooks . Open file を Set wb = Workbooks . Open ( File ) と 書き ます 。 こうして おけ ば wb . Close False で 選択 し た ブック が 閉じ ます 。 
こんにちは。 全て の エクセル を 表示 ② に 近い コード です 。 開か れ て いる BooK を 全て 表示 モード に し て い ます 。 Option Explicit Sub Sample 1 () Dim Wb As Workbook For Each Wb In Workbooks Wb . Activate ActiveWindow . Visible = True Next Wb End Sub 
shell 関数 は プログラム を 実行 する もの な ので 、 パス だけ 指定 し て も 何 も 起こり ませ ん 。 実行 する プログラム が ない という エラー に なる だけ です 。 先 に 回答 なさっ て いる かた で " explorer " を 書け ば 良い と 書い て いらっしゃる ので それ で 良い と 思い ます が 念 の ため 、 explorer . exe まで 書け ば 確実 と 思い ます 。 それ と 質問 文 の "￥ 受注 データ " の 円 マーク が 大文字 に なっ て いる ので もと の VBA は 小文字 に なっ て いる かも ご 確認 ください ね 。 Shell " explorer . exe " & ActiveWorkbook . Path & "\ 受注 データ ", vbNormalFocus 
雰囲気 以下 で どう なり ます か > 図が 一つ の シート に 8 個 入っ て い ます 。 > （ 1月 ～ 7月 ） シート 内 に ・ どの よう に 配置 さ れ て いる ･･･？ ・ ８ 個 の 表 が 1月 ～ 7月 と 、 どう 対応付け さ れ て いる ･･･？ わから ない ので 、 ・ シート 内 を " 合計 " で 検索 し 、 ・ セル 結合 さ れ て いる " 合計 " の 場合 、 その 表 の 、 最終 列 、 最終 行 １つ 前 の セル 値 を 入手 し ます 以下 を 、 新規 ファイル の 標準 モジュール に 転記 し 、 Samp 1 を 実行 する と 、 ファイル 選択 に なり 、 選択 し た ファイル を 対象 に 拾い 集め て 、 アクティブ シート を きれい に し た 後 、 ２ 行 目 から 、 拾い 集め た 順 に 出力 し ます 結果 良けれ ば 、 １ 行 目 に 何 月 を 設定 し て ください また 、 必要 に 応じ て 並び 替え て ください Option Explicit Public Sub Samp 1 ()     Dim dic As Object , dicW As Object , oFso As Object     Dim ws As Worksheet     Dim vFile As Variant , vK As Variant , v As Variant , vA As Variant     Dim sS As String     Dim i As Long , j As Long     With Application . FileDialog ( msoFileDialogOpen )        . AllowMultiSelect = True        . FilterIndex = 2        If ( Not .S how ) Then Exit Sub        Set dic = CreateObject (" Scripting . Dictionary ")        Set oFso = CreateObject (" Scripting . FileSystemObject ")        Application .S creenUpdating = False        For Each vFile In .S electedItems           sS = oFso . GetBaseName ( vFile )           dic . Add sS , CreateObject (" Scripting . Dictionary ")           With Workbooks . Open ( vFile , ReadOnly := True )              For Each ws In . Worksheets                 Set dicW = CreateObject (" Scripting . Dictionary ")                 Call DicMk ( ws , dicW )                 If ( dicW . Count > 0 ) Then                    dic ( sS ). Add ws . Name , dicW                 End If              Next              . Close False           End With        Next     End With     Cells . Delete     i = 2     For Each vK In dic . Keys        For Each v In dic ( vK ). Keys           Cells ( i , " A "). Value = v           j = Cells ( i , " B "). Column           For Each vA In dic ( vK )( v ). Items              Cells ( i , j ). Value = vA ( 2 )              j = j + 1           Next           i = i + 1        Next     Next     Application .S creenUpdating = True     Set dic = Nothing     Set dicW = Nothing     Set oFso = Nothing End Sub Private Sub DicMk ( ws As Worksheet , dicW As Object )     Dim rng As Range     Dim sAdr As String     Dim i As Long , j As Long , k As Long     Const CMOJI As String = " 合計 "     Set rng = ws . Cells . Find ( CMOJI , LookAt := xlWhole )     If ( Not rng Is Nothing ) Then        sAdr = rng . Address        Do           If ( rng . MergeArea . Cells . Count > 1 ) Then              With rng . Current Region                 i = . Rows . Count - 1                 j = . Columns . Count                 k = dicW . Count + 1                 With . Cells ( i , j )                    dicW ( k ) = Array (. Row , . Column , . Value )                 End With              End With           End If           Set rng = ws . Cells . FindNext ( rng )           If ( rng Is Nothing ) Then Exit Do        Loop While ( rng . Address <> sAdr )     End If End Sub 
i が 最後 まで 回す 。 Private Sub CommandButton 1 _ Click () Dim i As Long i = 1 On Error Resume Next Do With ActiveSheet . QueryTables . Add ( Connect ion := _ " URL ; http:// info . finance . xxxxx . co.jp / ranking /? kd = 31 & tm = d & vl = a&m k = 3 & p =" & i , _ Destination := IIf ( Range (" b 3 "). Value = "", Range (" b 3 "), Range (" b " & Cells . Rows . Count ). End ( xlUp ). Offset ( 1 , 0 ))) . Name = "? kd = 31 & tm = d & vl = a&m k = 3 & p = 1 " . FieldNames = True . RowNumbers = False . FillAdjacentFormulas = False . PreserveFormatting = True . RefreshOnFileOpen = False . BackgroundQuery = True . RefreshStyle = xlInsertDeleteCells .S avePassword = False .S aveData = True . AdjustColumnWidth = True . RefreshPeriod = 0 . WebSelectionType = xlAllTables . WebFormatting = xlWebFormattingNone . WebP reFormattedTextToColumns = True . Web C onsecutiveDelimitersAsOne = True . WebSingleBlockTextImport = False . WebDisableDateRecognition = False . WebDisableRedirections = False . Refresh BackgroundQuery := False End With If Err . Number <> 0 Then Exit Do i = i + 1 Loop On Error GoTo 0 End Sub 
こんにちは。 出来る 気 が し ない です ブラウザー の セキュリティ 画面 の 扱い が 、 スクリプト レベル で 出来る 気 が し ませ ん 。 winAPI が 必要 だっ たり 、 何 も 見 ない で キー コード の 送信 も 、 信用 ない です 最近 で は 、 「 クラウド 環境 」 を 利用 し 、 クライアント 空間 に 、 保存 する と 、 バックグラウンド で 、 サーバー の ファイル を 差し替える 、 という 方法 が あり ます 。 そっち の ほう が 、 現実味 は あり ます 。 IE 画面 で データ を アップ さ せる 、 しかし 手動 で は なく 、 スクリプト で 自動 、 という の でし たら 、 自動 で データ を 集める 仕組み を クラウド で 考え て み て は どうでしょう か 。 
TextBox 6 に は 何 を 入力 する の です か ？ （ たぶん 原価 か と 思い ます が ） 一応 、 上記 コード で 、 TextBox 5 = 100 TextBox 6 = 50 と 入力 し た 場合 、 TextBox 7 ＝ 50 TextBox 8 ＝ 50 . 00 と なっ た ので 、 問題 ない と 思い ます が 。 val ( TextBox 7 ) / val ( TextBox 5 ) * 100 で 、 粗利率 ○ ○ ％ という 感じ で 出し て いる ん です よ ね ？ （ 粗利率 ＝ （ 売価 － 原価 ）/ 売価 で 計算 で いい ん です よ ね ？ ） 
現 段階 で 分から ない 点 が 複数 あっ て も 、 ひとつ ずつ 問題点 を クリア し て いっ て ください 。 １ スレ に 多数 質問 だ と 「 業者 に 頼み なさい 」 という 回答 が 返っ て 来る だけ です 。 とりあえず 、 質問 回答 より 先 に DB の 仕様 について 逆 に 質問 です 。 ( １ ) 1つ の 大会 で 複数 競技 に エントリー し て いる 人が い たら どう し ます か ？ ( ２ ) 年度 は 現状 で は ID が １ から 新しい 年度 に なっ て い ます が 、 次回 ( 未来 ) 開催 する 大会 に 不都合 は 出 ませ ん か ？ (３) VBA で 記述 さ れ た SQL 文 を 拝見 する と 「 名簿 テーブル 」 に セット さ れる 大会 に関する データ が 『 名称 』 に なっ て い ます が 、 あと から 名称 が 変わっ て しまっ た ( 間違っ て い た ・ 入力ミス ) 場合 は どう し ます か ？ まずは ↓ こんな テーブル 形態 ( 各 ID 同士 で リレーション ) に し て 再考 さ れ たら いかが です か 。 「 名簿 テーブル 」 名簿 ID : pk 氏名 性 別 「 参加 テーブル 」 名簿 ID 大会 ID 種目 ID 賞 ID 「 大会 テーブル 」 大会 ID : pk 年度 ( 検索 用 ) 開催 日 ( 開催 順 ソート 用 ) 大会 名 「 種目 テーブル 」 種目 ID : pk 種目 名 「 賞 テーブル 」 賞 ID : pk 賞 名 
テキストボックス は 「 MultiLine 」 プロパティ を True に すれ ば 複数 行 の 入力 が 可能 に なり ます よ ？ 
jdljnhdjmebjxjd さん 、 こんばんは 。 22 : 34 : 09 の 返信 を 読ん で 考える と 、 アクティブ セル を 含ん で 右側 ６ 個 の 中 に 、 Cells ( x , y ) で 指定 する セル が 含ま れる 場合 に 、 指定 する 処理 を し たい 、 という こと か と 理解 し まし た 。 お 書き の コード 意図 に従って If 文 を 作る なら If Active Cell . Address = Cells ( x , y ). Address Then という 感じ の コード に すれ ば よい か と 思い ます 。 あと 、 If 文 処理 の 中 に Exit For を 入れ て おけ ば 、 余分 な ループ を 回さ ず に 済み ます 。 また 、 ループ を 回さ ず に チェック する 方法 として 、 If Not ( Inter sect ( Active cell . Resize ( 1 , 6 ) , Cells ( x , y )) Is Nothing ) Then と すれ ば 、 アクティブ セル を 左端 と する １ 行 ６ 列 の セル 範囲 の 中 に 、 Cells ( x , y ) が 含ま れる 場合 を 判断 さ せる こと が でき ます 。 
以下 で どう なり ます か E 1 ～ の 表 は 事前 に 作っ て あっ て 、 その 中 で の 結果 を 埋める ････ この 辺 の 処理 は 、 私 の 中 で パターン 化 し て いる ので 、 前 質問 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1116242487 ... ここ から 大きく 変わっ て ませ ん 変わっ て いる 部分 は 、 ・ 春 夏 ･･･ E 1 ～ の 表 から 入手 ・ E2 ～ の 集計 範囲 を 事前 に 求め 、 一致 する もの だけ を 集計 する よう に 今回 、 Dictionary dic の ２ 段 構成 は 変わり ませ ん が １ 段 目 キー ： 書き出 し行 番号 ２ 段 目 キー ： 書き出し 列 番号 も し 、 E2 ～ は A 列 に 出現 し た 全部 を 調査 し た 結果 作る の で あれ ば 、 Samp 1 で の >     vC = Array (" とても よい ", " よい ", " ふつう ", " わるい ") ↓     vC = Array (" AA ", " BB ", " BC ") に し て 、 記号 化 部分 を 今回 のに 変更し 書き出し 部分 を 変更 すれ ば ････ パターン を 共有 できれ ば 、 可読性 云々 関係 なくなる 様 な ･･･ Public Sub Samp 2 ()     Dim dic As Object , dicE As Object , dicP As Object     Dim vA As Variant , vE As Variant , v As Variant     Dim vS As Variant , vC As Variant , vK As Variant     Dim sS As String     Dim i As Long , j As Long , k As Long , n As Long     vC = Array (" AA ", " BB ", " BC ")     Set dic = CreateObject (" Scripting . Dictionary ")     Set dicE = CreateObject (" Scripting . Dictionary ")     Set dicP = CreateObject (" Scripting . Dictionary ")     With Range (" E 1 "). Current Region        vS = . Value        For i = 2 To UBound ( vS )           dicP ( vS ( i , 1 )) = i        Next        For j = 2 To UBound ( vS , 2 )           dicE ( vS ( 1 , j )) = j        Next        vA = Range (" A1 "). Current Region . Resize (, 3 ). Value        For n = 1 To UBound ( vA )           If ( dicP . Exists ( vA ( n , 1 )) And dicE . Exists ( vA ( n , 2 ))) Then              i = dicP ( vA ( n , 1 ))              j = dicE ( vA ( n , 2 ))              For k = 0 To UBound ( vC )                 If ( vA ( n , 3 ) = vC ( k )) Then Exit For              Next              k = k + 1              If ( Not dic . Exists ( i )) Then                 dic . Add i , CreateObject (" Scripting . Dictionary ")              End If              v = dic ( i )( j )              If ( Not IsArray ( v )) Then                 ReDim v ( UBound ( vC ) + 2 )                 v ( 0 ) = 1                 v ( k ) = 1              Else                 v ( 0 ) = v ( 0 ) + 1                 v ( k ) = v ( k ) + 1              End If              dic ( i )( j ) = v           End If        Next        For Each vK In dicP . Keys           i = dicP ( vK )           If ( dic . Exists ( i )) Then              For Each vE In dicE . Keys                 j = dicE ( vE )                 sS = "-"                 v = dic ( i )( j )                 If ( IsArray ( v )) Then                    If ( v ( 1 ) > 0 ) Then                       sS = "○"                    ElseIf (( v ( 2 ) > 0 ) Or ( v ( 3 ) > 0 )) Then                       sS = "△"                    Else                       sS = "◎"                    End If                 End If                 vS ( i , j ) = sS              Next           Else              sS = "-"              For Each vE In dicE . Keys                 j = dicE ( vE )                 vS ( i , j ) = sS              Next           End If        Next        . Value = vS     End With     Set dic = Nothing     Set dicE = Nothing     Set dicP = Nothing End Sub 
ThisWorkbook . Worksheets ( i ). Range (" o 3 : s 8 "). Value ↓ ThisWorkbook . Worksheets ( CStr ( i )). Range (" o 3 : s 8 "). Value 文字列 に 変換 し て 使い ましょ う 。 いま の まま で は 、 「 左 から i 番目 の シート 」 という 意味 に なり ます よ ね 。 
Sub a () Set sh 1 = Sheets (" Sheet 1 ") Set sh 2 = Sheets (" Sheet 2 ") ' Sheet 1 の 最終 行 を 取得 sh 1 _ rows = sh 1 . Cells ( Rows . Count , 1 ). End ( xlUp ). Row ' Sheet 1 の 最終 行 まで ループ For i = 1 To sh 1 _ rows ' Sheet 2 の 最終 行 を 取得 sh 2 _ rows = sh 2 . Cells ( Rows . Count , 1 ). End ( xlUp ). Row ' Sheet 2 に 存在 し た か どう か の フラグ flag = False ' Sheet 2 の 最終 行 まで ループ For j = 1 To sh 2 _ rows ' 同じ 名称 が あっ た 場合 If sh 1 . Cells ( i , 1 ). Value = sh 2 . Cells ( j , 1 ). Value Then ' B 列 の 値 を 設定 sh 2 . Cells ( j , 2 ). Value = sh 1 . Cells ( i , 2 ). Value ' 存在 し た フラグ を True flag = True End If Next ' 存在 し なかっ た 場合 は 、 Sheet 2 の 最終 行 に 追加 If flag = False Then sh 2 . Cells ( sh 2 _ rows + 1 , 1 ). Value = sh 1 . Cells ( i , 1 ). Value sh 2 . Cells ( sh 2 _ rows + 1 , 2 ). Value = sh 1 . Cells ( i , 2 ). Value End If Next End Sub 
コード を 全部 書い て 下さい 。 txtGetPath . Value と は ？ > WPS Spreadsheets 原因 でしょ う か ？ それ 以前 に この まま で は エラー です 。 開き たい の は エクセル ファイル で は ない という 事 です か ？ そう なら 、 当方 は エクセル ファイル の 処理 しか わかり ませ ん が 。 
Dim ProcessStartInfo 1 As New ProcessStartInfo () ProcessStartInfo 1 . FileName = " C :\ Program Files \ Internet Explorer \ iexplore . exe " ProcessStartInfo 1 . Arguments = " http:// www . yahoo . co.jp " Process .S tart ( ProcessStartInfo 1 ) と すれ ば IE で Yahoo! を 開く こと が でき ます が ？ 開い た IE ページ に対して なんらかの アクション が し たい の で あれ ば Dim objIE As Object objIE = CreateObject (" InternetExplorer . Application ") objIE . Visible = True objIE . navigate (" http:// www . yahoo . co.jp ") と し た あと で objIE の メソッド を 利用 し ます 。 IE オブジェクト で 用意 さ れ て いる プロパティ ・ メソッド について は http:// www . vba - ie .net / ie object / index . html を 参考 に し て ください 。 
質問 ① コード の 一部分 だけ を 抜き出し て も 他 に 部分 に 原因 が ある 場合 も あり ます ので 、 できれ ば 全体 を 提示 する よう に し ましょ う 。 とりあえず 提示 さ れ て いる 部分 だけ で 、 回答 し ます と 。 最初 の If の 部分 は 、 「 大会 」 フィールド に対して BETWEEN 条件 、 次 の Else If 以降 は 「 賞 」 フィールド に対して 条件 を 設定 し て い ます が 、 矛盾 し て ませ ん か 。 まずは 、 どの フィールド に対して 、 どの よう な 条件 を 設定 し たい の か を 明確 に 説明 し て ください 。 あと 、 「 大会 」 「 賞 」 の 各 フィールド の データ型 も 明示 し て ください 。 質問 ② Null と "" は 別物 です ので 違い を しっかり 意識 し ましょ う 。 質問 ① では IsNull で 判断 し て い ます ので 、 "" を 代入 し た の で は IsNull で は 判定 でき ませ ん 。 Null を 代入 し ましょ う 。 txtID . Value = Null ～～～～～～～～～～～～～（”～” は 省略 部分 ） Me . コンボ 1 . Value = Null Me . コンボ 2 . Value = Null 
\ の 位置 と *. xisx が おかしい と 思い ます 。 fl _ name = Dir (" C :￥ GetPath \" & "*. xlsx ") と すれ ば 、 ファイル が 取得 でき ます 。 
上 の コード だ と contorol (" checkbox "& １ ). caption = worksheets (" リスト ") . cells ( 4 , 3 ). value ・ ・ contorol (" checkbox "& １ ). caption = worksheets (" リスト ") . cells ( 28 , 3 ). value の あと に contorol (" checkbox "& ２ ). caption = worksheets (" リスト ") . cells ( 4 , 3 ). value ・ ・ contorol (" checkbox "& ２ ). caption = worksheets (" リスト ") . cells ( 28 , 3 ). value と なり ます 。 すべて の checkbox が cells ( 28 , 3 ). value に なっ てる ん じゃ ない でしょ う か 。 2 重 の ループ の 場合 、 中 の ループ が 全部 終わっ た 後 に 外 の ループ が next さ れる ので i と j を 同時に 動かし たい 場合 は contorol (" checkbox "& i ). caption = worksheets (" リスト ") . cells ( i + 3 , 3 ). value と する か 中 の ループ を 外し て j = j + 1 を 追加 する か です ね 。 
"'[" & ThisWorkbook . Name & "] Sheet 1 '! R2 4 C3 1 : R1 30 C3 2 " で どうでしょう ThisWorkbook ： マクロ が 登録 さ れ て いる ブック 
アラート を 出 なく する だけ で あれ ば Range (. Offset ( 1 , 0 ), Active Cell . Offset ( 3 , 5 )). Merge を Application . DisplayAlerts = False Range (. Offset ( 1 , 0 ), Active Cell . Offset ( 3 , 5 )). Merge Application . DisplayAlerts = True と すれ ば よい の です が 、 添付 画像 の 状態 で コード を 実行 し て 意図 する 結果 が 得 られ て いる と は 思え ない の です が ・ ・ ・ Active Cell が C 6 で あれ ば zp = . Offset ( 1 , 1 ). Value は zp = Range (" D 7 "). Value と 同じ です が 正しい です か ？ adr = . Offset ( 2 , 1 ). Value は adr = Range (" D 8 "). Value と 同じ です が 正しい です か ？ . Offset ( 3 , 0 ). Value = zp & vbLf & adr & vbLf & nm & " さま " は Range (" C ９ "). Value = zp & vbLf & adr & vbLf & nm & " さま " と 同じ が 正しい です か ？ Range (. Offset ( 1 , 0 ), Active Cell . Offset ( 3 , 5 )). Merge は Range (" C 7 : H9 "). Merge と 同じ です が 正しい です か ？ Active Cell . Offset ( 1 ). Resize ( 3 ). EntireRow . Delete は Rows (" 7 : 9 "). Delete と 同じ です が 正しい です か ？ もう一度 、 初期 状態 で の データ の 設定 内容 と 、 最終 的 に どの セル に どの よう な データ を 設定 し たい の か を きちんと 確認 し た ほう が いい か と 思い ます 。 
同性 同名 の 場合 、 漢字 が 違え ば 、 問題 有り ませ ん が 、 全く 同じ 場合 、 判別 は 不可能 です 。 この 場合 、 別人 に する ため の 記号 など を 名前 に 付加 する 必要 が あり ます 。 しかし 名前 を いじる の は まずい ので 、 もう １ 列 、 判別 用 の 名前 を 作成 すれ ば 解決 し ます 。 こんな イメージ です 。 伊藤和夫 ＿ A ＿ 伊藤和夫 A 山田 俊樹 ＿ ＿ 山田 俊樹 伊藤和夫 ＿ B ＿ 伊藤和夫 B 手入力 に なり ます が 、 こんな 方法 しか ない でしょ う 。 回答 は 、 ２ 種類 用意 し まし た 。 Sheet 2 で は 、 記号 付き の 名前 を 入力 し 、 １ 行 目 の 項目 を Sheet 1 と 同じ 項目 名 を 入力 すれ ば 、 好き な 項目 を 選べ ます 。 順番 も 必要 あり ませ ん 。 回答 です レイアウト 例 は 画像 参照 ＜ Sheet 1 ＞ A 2 := C 2& B2 下方 へ ドラグコピー し ます 。 ＜ Sheet 2 ＞ B2 := IFERROR ( OFFSET ( Sheet 1 !$ A $1 , MATCH ($ A 2 , Sheet 1 !$ A :$ A , 0 )- 1 , MATCH ( B $1 , Sheet 1 !$ 1 :$ 1 , 0 )- 1 ),"") 右 方と 下方 へ ドラグコピー し ます 。 別式 B2 := IFERROR ( INDIRECT (" Sheet 1 !"& ADDRESS ( MATCH ($ A 2 , Sheet 1 !$ A :$ A , 0 ), MATCH ( B $1 , Sheet 1 !$ 1 :$ 1 , 0 ))),"") 右 方と 下方 へ ドラグコピー し ます 。 
こんな トラブル が 出る くらい です から 、 できる こと なら フォーム 名 を 変え た ほう が いい です ね 。 Forms ![ F - フォーム 名 ]. Requery 
Sub test () Dim i As Long , j As Long , k As Long Dim sh 2 As Worksheet j = 2 Set sh 2 = Sheets (" Sheet 2 ") With Sheets (" Sheet 1 ") For i = 2 To . Cells ( Rows . Count , 1 ). End ( xlUp ). Row For k = 1 To (. Cells ( i , Columns . Count ). End ( xlToLeft ). Column - 3 ) / 2 sh 2 . Cells ( j , 1 ). Resize (, 3 ) = . Cells ( i , 1 ). Resize (, 3 ). Value sh 2 . Cells ( j , 4 ). Resize (, 2 ) = . Cells ( i , 2 * k + 2 ). Resize (, 2 ). Value sh 2 . Cells ( j , 4 ). NumberFormatLocal = " yyyy / m / d " sh 2 . Cells ( i , 5 ). NumberFormatLocal = "#,## 0 " j = j + 1 Next k Next i End With sh 2 . Cells ( 1 , 1 ). Resize (, 5 ) = Array (" 県 名 ", " 食品 ", " 注 番 ", " 納期 ", " 数量 ") End Sub 
Forms ! 売上 伝票 ! 名前 = Me ! 名前 に ブレークポイント を 設定 し て Me ! 名前 の 変数 内容 を チェック し て み て 下さい 。 多分 見れ ない と 思い ます 。 Me . 名前 なら 見れる と 思い ます 。 
× Sheets ( Range (" A 2 "). Name ). select （ セル に 入力 ） ○ Sheets ( Range (" A 2 "). Value ). select 
データ > 外部 データ の 取り込み > テキストファイル の 操作 を マクロ 記録 に 録 って 、 手 を 加え て み まし た 。 C :\ AAA \ Test \ Test . txt が 取り込み 対象 ファイル です 。 Sub sample () Const xFile As String = " C :\ AAA \ cx \ Test . txt " ActiveWorkbook . Worksheets . Add With ActiveSheet . QueryTables . Add ( Connect ion :=" TEXT ;" & xFile , _ Destination := Range ("$ A $1 ")) . FillAdjacentFormulas = False .S aveData = True . AdjustColumnWidth = True . TextFilePromptOnRefresh = False . TextFileParseType = xlDelimited . TextFileTextQualifier = xl TextQualifierDoubleQuote . T ex tFileConsecutiveDelimiter = True . TextFileSpaceDelimiter = True . T ex tFileTrailingMinusNumbers = True . Refresh BackgroundQuery := False End With End Sub 
Worksheet _ calculate は 再 計算 さ れ た 時 に 発生 する イベント マクロ で どの セル が 再 計算 の 対象 か は 分かり ませ ん その 為 、 引数 ( Target ) が ない ので ｢ オブジェクト が 必要 です 」 の エラー に なり ます 再 計算 の トリガー と なる セル を 対象 として Worksheet _ Change を 使用 する と 出来 ない か な ? 
http:// excel - ubara . com / excelvba 4 / EXCEL 245 . html を 使え ば できる の で は ない でしょ う か 。 わたし は 、 やっ た こと が あり ませ ん し 、 今後 も 作る 予定 は ない ので 、 ぐたいてき な もの は つくれ ませ ん が 。 
VBA です 。 以下 の 形 で 如何 でしょ う か 。 Sheet 1 の マクロ に 記述 し て ください 。 -- ' マスター シート 名 Const MASTER _ SHEET _ NAME As String = " Sheet 2 " ' マスター シート User Name 列 Const USER _ NAME _ COLUMN As Integer = 1 ' マスター シート Sample Name 列 Const SAMPLE _ NAME _ COLUMN As Integer = 2 ' Sample Name リスト 行 Const SAMPLE _ NAME _ LIST _ ROW As Integer = 8 ' Sample Name リス ト列 Const SAMPLE _ NAME _ LIST _ COLUMN As Integer = 3 ' セル の 値 が 変更 さ れ た 場合 に 実行 Private Sub Worksheet _ Change ( ByVal Target As Range ) ' セル の 複数 選択 時 は 処理 し ない If Target . Cells . Count <> 1 Then Exit Sub ' User Name （ 1 行 目 C 列 ） が 変更 さ れ た 場合 に 実行 If Target . Row = 1 And Target . Column = 3 Then ' Sample Name の リスト Dim sample _ name _ list As String sample _ name _ list = "" ' リスト を 作成 Dim i As Integer : i = 2 ' 開始 行 With Worksheets ( MASTER _ SHEET _ NAME ) Do Until . Cells ( i , USER _ NAME _ COLUMN ) = "" If . Cells ( i , USER _ NAME _ COLUMN ) = Target . Value Then sample _ name _ list = sample _ name _ list + _ . Cells ( i , SAMPLE _ NAME _ COLUMN ). Value & " ," End If i = i + 1 Loop End With ' Sample Name リスト ボックス に リスト を 設定 Dim snl _ cell As Range Set snl _ cell = Cells ( SAMPLE _ NAME _ LIST _ ROW , SAMPLE _ NAME _ LIST _ COLUMN ) snl _ cell . ClearContents If sample _ name _ list = "" Then Exit Sub ' リスト が 空 snl _ cell . Validation . Delete snl _ cell . Validation . Add Type := xlValidateList , _ Formula 1 := sample _ name _ list End If End Sub 
添付 図 が 小さく て よく 内容 が 見え ない ので 、 考え方 、 計算 の 仕方 を 推定 で 回答 し ます 。 複数 の 商品 が 貸し出さ れ 、 返却 さ れ た 一覧 表 が あり 、 それ を ガントチャート に する 、 という 解釈 です 。 D 9 : AH 11 を 選択 し て 条件 付き 書式 、 新しい ルール 、 数式 を 使用 し て 書式 設定 する セル を 決定 、 書式 、 塗りつぶし を 設定 し て 数式 を = SUM (( D $4 >=$ D $16 :$ D $23 )*( D $4 <=$ E $16 :$ E $23 )*($ A9 =$ C $16 :$ C $23 )) として 、 OK を 押し ます 。 
実戦 で は １ ６ ７ 行 あれ ば １ ６ ７ 行 計算 する よう な こと は ない と 思う の です が 。 よほど 配列 数式 の よう な 重い 処理 を する 以外 で は １ ６ ７ 行 でも ２ ０ ０ 行 とか ３ ０ ０ 行 とか を コピー し て おく の で は ない でしょ う か ？ ただし D ２ に は IF ( A 2 ="","", B2 * C 2 ） の よう な 数式 に する と 思い ます 。 Sub M acr o2 () ' ' M acr o2 Macro ' Range (" D2 "). Select Selection . AutoFill Destination := Range (" D2 : D300 ") Range (" D2 : D300 "). Select Range (" A1 "). Select End Sub マクロ の 記録 は やたら Select する ので それ を 省略 する と Sub M acr o2 () Range (" D2 "). AutoFill Destination := Range (" D2 : D300 ") End Sub でも いい です ね 。 最終 行 （ セル ） の 取得 は マクロ の 記録 で は でき ない こと です 。 A 列 の 最終 行 は Cells ( Rows . Count , 1 ). End ( xlUp ) で 求め られる ので その 行 数 を 変数 に 入れ ます 。 n = Cells ( Rows . Count , 1 ). End ( xlUp ). ROW と する と １ ６ ７ 行 まで ある 表 なら n に １ ６ ７ が 入り ます 。 Sub M acr o2 () n = Cells ( Rows . Count , 1 ). End ( xlUp ). ROW Range (" D2 "). AutoFill Destination := Range (" D2 : D " & n ) End Sub と すれ ば きっちり 最終 行 まで コピー し ます 。 
ここ で どうでしょう 。 https :// support . office . com / ja - jp / article /% E 5 % 88 % 86 % E 6 % 9 E % 90 % E3 % 83 % 8 ... 
1 行 ずつ 削除 する なら 、 下 から 。 上 から だ と 、 行 削除 する こと によって 、 行番号 を 表す 変数 の 値 が 、 実際 の 行 と 違っ て き ます よ ね ？ あと 、 なぜ ２つ の ループ が 必要 な ん です か ？ Sub n () Dim i As Long Dim ss As Variant , s As Variant ss = Array (" S1 ", " S2 ", " S3 ") For i = Cells ( Rows . Count , 1 ). End ( xlUp ). Row To 2 Step - 1 For Each s In ss If InStr ( Cells ( i , 1 ). Value , s ) <> 0 Then Rows ( i ). Delete Exit For End If Next s Next i End Sub 
一般的 に 最終 行 を 求める 場合 、 下記 の よう に 書き ます 。 Dim MaxRow As Long MaxRow = Worksheets (" Sheet 1 "). Range (" A " & Rows . Count ). End ( xlUp ). Row この コード は Sheet 1 の Ａ 列 の 最終 行 を 求める 場合 です 。 
VSTO で Excel を 利用 し て 作ら れ て は どうでしょう か ? Excel 上 で ワーク シート を 編集 し て 、 最終 的 に は 画面 の キャプチャ を 画像 として 保存 する よう な イメージ 。 「 Office の 開発 」 https :// msdn . microsoft . com / ja - jp / library / fp 161347 . aspx 「 画面 を キャプチャ する 」 http:// dobon .net / vb / dotnet / graphics / screen capture . html 
VBA の 場合 です 。 Sheet 1 の 1 行 目 を Sheet 2 の 1 行 目 に コピー し ます 。 Sub sample () Dim w s1 As Worksheet Dim w s2 As Worksheet Dim lastColumn As Integer Dim c As Integer ' Set w s1 = Sheets (" Sheet 1 ") Set w s2 = Sheets (" Sheet 2 ") lastColumn = w s1 . Cells ( 1 , Columns . Count ). End ( xlToLeft ). Column For c = 1 To lastColumn w s2 . Cells ( 1 , c * 2 - 1 ). Value = w s1 . Cells ( 1 , c ). Value Next End Sub 
横 1 、 縦 を 空白 で 出し たい です 。 以下 コード です 。 縦 を 空白 という の は マクロ で も 手動 でも 無理 だ と おもい ます 。 貴方 の 目的 が 縦 の ページ 数 が 変動 で 指定 でき ない という 事 で 空白 に する という 事 なら 空白 で は なく 縦 の 数値 を 予測 の 倍 や １ ０ 倍 の 数値 で も 指定 し て おけ ば 横 幅 に 合わせ て 縮小 さ れ 縦 の ページ 数 は 必要 ページ 数 のみ 印刷 さ れ ます 。 
年 ブック が " C :\ sample \ 年 . xls " で 、 月 フォルダ が " C :\ sample \ 月 \" の 場合 で 、 VBA は 別 の ブック に ある 場合 です 。 Sub sample () Dim folder As String Dim wbNen As Workbook Dim wb As Workbook Dim f As String Dim y As String Dim m As String Dim d As String Dim s As String ' Application .S creenUpdating = False ' ちらつき 防止 ( 必要 なら ) folder = " C :\ sample \ 月 \" ' 月 フォルダ ( 最後 に \) Set wbNen = Workbooks . Open (" C :\ sample \ 年 . xls ") ' 年 ブック f = Dir ( folder & " D *. xls ") ' フォルダ 内 の 、 最初 が " D " で 始まる . xls ファイル 名 ( 日報 ) Do While f <> "" ' ファイル が ある 間 y = Mid ( f , 2 , 4 ) ' 年 の 部分 ( yyyy ) m = Mid ( f , 6 , 2 ) ' 月 の 部分 ( mm ) d = Mid ( f , 8 , 2 ) ' 日の 部分 ( dd ) s = Format ( DateSerial ( y , m , d ), " yyyy . m 月 ") ' 年 ブック の 月 シート 名 ( yyyy . m 月 )( 月 の 部分 が 必ず 2 桁 で ない ので 変換 する ) Set wb = Workbooks . Open ( folder & f ) ' 日報 を 開く wb .S heets (" Sheet 3 "). Range (" H12 : H3 5 "). Copy wbNen .S hee ts(s) . Cells ( 3 , d + 1 ) ' 日報 の Sheet 3 の H12 : H3 5 を 年 ブック の 対象 の 月 シート の 3 行 目 の 日 + 1 れつ から に コピー wb . Close False ' 日報 を 保存 せ ず に 閉じる f = Dir ' 次 の ファイル 名 Loop ' 繰り返す wbNen . Close True ' 年 ブック を 保存 し て 閉じる Application .S creenUpdating = True ' ちらつき 防止 解除 End Sub 
> OpenFileDialog クラス を 使用 し て でき ます か ? OpenFileDialog クラス は ダイアログ を 表示 し て ファイル 名 を 返す だけ です 。 Stream を 使っ て 文書 情報 を 読み書き する コード は 自分 で 書く 必要 が あり ます 。 失礼 かも しれ ませ ん が y 8 rj 2 w 9k さん 知識 レベル で は いきなり 画像 も 含め た 管理 プログラム を 組む の は 難しい と 思い ます 。 まず 練習 として ① 一 件 の 「 分類 ・ 文書 名 ・ 文書 ファイル の パス 」 の 情報 を ファイル から 読み 、 編集 し て ファイル に 書き出す ② 複数 の 「 分類 ・ 文書 名 ・ 文書 ファイル の パス 」 の 情報 を ファイル から 読み 、 編集 し て ファイル に 書き出す ③「 分類 ・ 文書 名 ・ 文書 ファイル の パス 」 の 情報 を 保持 する クラス を 作っ て 、 その 内容 を ファイル に 保存 、 復元 する という よう に 段々 レベル を 上げ て いく こと を お勧め し ます 。 ③ まで 出来 たら 、 その クラス に 画像 データ という プロパティ を 追加 する こと で 画像 まで 含め た 文書 管理 が 出来る よう に なり ます 。 私 は 下記 の サイト を よく 利用 し て い ます 。 http:// dobon .net / vb / dotnet / index . html 
Visual Basic の 話 なら 、 シリアル通信 で 調べ て シリアル モニター 相当 品 を 作り 、 ARDUINO から 受信 し た 内容 を " filename . csv " と 言う FILE に 保存 し たけれ ば その ファイル 名 で FILE を OPEN し て 保存 する だけ 、 その よう な シリアル通信 を 解説 し た HP は いくらでも ある 。 あと は EXCEL の VBA で 作れ ば ？ こっち の 方 が 簡単 か な 、 http:// hom ep ag e2 . nifty . com / nonnon / Chinamini / 20100001 / 20100302 . html ここ み て み なさい 
数式 自体 は 間違っ て い ませ ん 。 適用 先 が 違う の で は あり ませ ん か 。 ルール の 管理 の ダイアログボックス で 、 違っ て い たら 書き換え ましょ う 。 （ 別に 「 1 列 ずつ 個々 に 」 設定 する 必要 は あり ませ ん 。 また そう する なら $ マーク は 冗長 と 言う もの です 。 ） 
( vbs ) エクセル VBA で " MsgBox xlUp " と すれ ば "- 4162 " が 返り ます 。 xlUp は エクセル から 実行 中 、 又は エクセル 参照 設定 を 行っ た アクセス VBA や パワポ VBA から 指定 可能 です 。 その ため VBS や javascript など エクセル 外部 から エクセル を 利用 する 場合 は xlUp 部分 は "- 4162 " と し なけれ ば エラー と なり ます 。 ◆ 参考 1 Set xlSh = xlBK .S heets ( 1 ) Msgbox xlSh . Cells ( xlSh . Rows . Count , 1 ). End (- 4162 ). Row ◆ 参考 2 xlUp , xlWhole ⇒ " xl " で 始まる 場合 は エクセル のみ で 利用 可能 定数 ac Normal , acEntire ⇒ " ac " スタート は アクセス のみ olMailItem ⇒ " ol " スタート は アウトルック のみ vb Yellow , vbNarrow ⇒ " vb " スタート は VB 系 共通 adOpenStatic ⇒ " ad " スタート は VBA から ADO 外部 参照 し て いる 場合 上記 は 一 例 です が 、 xlUp ～ adOpenStatic など は VBS から は 数値 指定 が 必要 です 。 
こんにちは。 なぜ か 、 ヘルプ に 記載 が ある から です 。 指定 さ れ た ドライブ の 準備 が でき て いる 場合 は 真 ( true ) を 返し ます 。 準備 が でき て ない 場合 は 偽 ( false ) を 返し ます 。 object . IsReady object に は 、 Drive オブジェクト の 名前 を 指定 し ます 。 解説 リムーバブル ディスク ドライブ および CD-ROM ドライブ の 場合 は 、 ドライブ に メディア が セット さ れ て おり 、 アクセス できる 状態 に ある 場合 に だけ 真 ( true ) に なり ます 。 次 の コード は 、 IsReady プロパティ の 使用 例 です 。 [ JScript ] function ShowDriveInfo ( drvpath ) { var fso , d , s , t ; fso = new ActiveX Object (" Scripting . FileSystemObject ") d = fso . GetDrive ( drvpath ) switch ( d . DriveType ) { case 0 : t = " 不明 "; break ; case 1 : t = " リムーバブル ディスク "; break ; case 2 : t = " ハード ディスク "; break ; case 3 : t = " ネットワーク ドライブ "; break ; case 4 : t = " CD-ROM "; break ; case 5 : t = " RAM ディスク "; break ; } s = " ドライブ " + d . Drive Letter + ": - " + t ; if ( d . IsReady ) s += "< BR >" + " ドライブ の 準備 が でき て い ます 。 "; else s += "< BR >" + " ドライブ の 準備 が でき て い ませ ん 。 "; return ( s ); } [ VBScript ] Function ShowDriveInfo ( drvpath ) Dim fso , d , s , t Set fso = CreateObject (" Scripting . FileSystemObject ") Set d = fso . GetDrive ( drvpath ) Select Case d . DriveType Case 0 : t = " 不明 " Case 1 : t = " リムーバブル ディスク " Case 2 : t = " ハード ディスク " Case 3 : t = " ネットワーク ドライブ " Case 4 : t = " CD-ROM " Case 5 : t = " RAM ディスク " End Select s = " Drive " & d . Drive Letter & ": - " & t If d . IsReady Then s = s & "< BR >" & " ドライブ の 準備 が でき て い ます 。 " Else s = s & "< BR >" & " ドライブ の 準備 が でき て い ませ ん 。 " End If ShowDriveInfo = s End Function 主 様 、 こんなに わかり やすい ヘルプ です よ 、 手元 に 無い の でし たら 、 MS の スクリプト センター と ダウンロード の ファイル を 取得 し て 、 じっくり 読ん で ください 。 質問 が 変化 する でしょ う から 、 その とき また 。 
Excel の VBA の 場合 、 文字列 変数 に 格納 できる 文字列 は 最大 約 20 億 文字 まで 、 という 制限 が あり ます 。 ＣＳＶ ファイル が 全部 半角 文字 だ と する と 2G バイト です 。 全角 混じり なら もっと 少なく なり ます 。 itxt = ts . ReadAll で CSV ファイル の すべて を 一気に 文字列 変数 に 読み込ん で いる から で は ない です か ？ 
名前 を 変更 し ない もの と し ます 。 UserForm 1 に TextBox 11 を 入れ て Visible = False に プロパティ で 設定 し て おき ます 。 以下 UserForm 1 Private Sub CommandButton 1 _ Click () TextBox 11 . Value = 1 UserForm 2 .S how End Sub Private Sub Command Bu t to n2 _ Click () TextBox 11 . Value = 2 UserForm 2 .S how End Sub ・ ・ ・ Private Sub CommandButton 10 _ Click () TextBox 11 . Value = 10 UserForm 2 .S how End Sub 以下 UserForm ２ Private Sub ListBox 1 _ Click () UserForm 1 . Controls (" textbox " & UserForm 1 . TextBox 11 . Value ). Value = Me . ListBox 1 . Value End Sub ほか に Private Sub UserForm _ Initialize () など は 不明 です が 設定 し て ある もの と し ます 。 
[ コンピュータ テクノロジー ＞ プログラミング ＞ Visual Basic ] カテゴリ へ 投稿 さ れ て ます よ 。 
> skylavel さん 2016 / 7 / 2220 : 40 : 44 > 繰り返し 処理 の 一部 を 手動 で 行う よう な プログラム を 書く こと は 可能 です か ？ 繰り返し は 可能 です が 、 業務 作業 で 使える か は 別 の 話 に なり ます 。 
同じ 質問 を 繰り返し て ます ね 。 まず 、 簡単 な こと から 調べ て やっ て み ましょ う 。 最初 から 大きな 家 は 建て られ ませ ん 。 小さな 物 から つくる ん です 。 たとえば 、 Ａ シート の " A 2 " から Ｂ シート の ” A 2 " に データ を コピー する 。 ( 1 ) Worksheets (" Ｂ シート "). Range (" A 2 "). Value = Worksheets (" Ａ シート "). Range (" A 2 "). Value ( 2 ) Dim Ws 1 As WorkSheet , Ws 2 As WorkSheet , Y As Long , X As Long Set Ws 1 = Worksheets (" A シート ") Set Ws 2 = Worksheets (" B シート ") Y = 2 X = 1 Ws 2 . Cells ( Y , X ). Value = Ws 1 . Cells ( Y , X ). Value ( 1 ) と ( 2 ) は 、 同じ 結果 に なり ます 。 ただ 、 ( 2 ) の 方 が 、 ( 3 ) A 列 の 2 行 目 から 10 行 目 を コピー し たい とき に 応用 が きき ます 。 ( 3 ) X = 1 For Y = 2 To 10 Ws 2 . Cells ( Y , X ). Value = Ws 1 . Cells ( Y , X ). Value Next という こと で 、 VBA の 1 行 1 行 の 意味 を 理解 し て 行く こと が 大切 です 。 「 千里の道も 1 歩 から 」 です 。 
その ＤＧＶ と 言う 物 が 、 DataGridView で 環境 が Visual Basic 2010 の よう な .net 系 だ という 前提 で お話し し ます 。 普通に CellValueChanged イベント で 計算 すりゃ 良い ん じゃ ない です か ね ？ https :// msdn . microsoft . com / ja - jp / library / system . windows . forms . datag ... 気 に なっ て 調べ たら 、 CellFormatting イベント が 適正 な 模様 。 http:// www . itlab 51 . com /? p = 3657 
【 回答 に なっ て い ない 蛇足 】 Cells ( K ,   L )   =   i   And   K   =   K   +   1 と 書く と 、 Cells ( K ,   L )   =   ( i   And   k   =   ( K   +   1 )) に なっ て しまい ます 。 最初 の   =   は 代入 、 二 番目 の   =   は 等 値 比較 [ 代入 で は 無い ] です 。 ( k   =   k   +   1 )   は 必ず   0   [ False ] に なる ので 、 ( i   And   0 )   も 必ず   0   、 よって Cells ( K ,   L )   =   0 と 書い た の と 同じ 意味 に なっ て しまい ます 。 VBA で マルチ ステートメント に し たい 場合 、 Cells ( K ,   L )   =   i   :   K   =   K   +   1 の よう に コロン で 区切り ます 。 しかし 、 If   ～   Then   の 後 で コレ を 書く と 紛らわしく て 見辛い ので 、 基本的 に は ブロック If に す べき か と 。 If   ～   Then    Cells ( K ,   L )   =   i    K   =   K   +   1 End   If ＞ nagato _ blue _ noah さん >> And は If 文 の 条件 判定 の 中 だけ で しか 使え ませ ん 。 イヤ 、 VBA / VBScript の And は ビット演算 子 な ので 通常 の 数式 内 で 使え ます よ 。 Ｃ 言語 で いう   &   で &&   では 無い [ VBA に は   &&   相当 機能 は 無い ] です が 。 >> Cells は 極力 つかわ ず に Range を 使う よう に Cells で も Range (" B "   &   Rows . Count )    ''↓↓'' Cells ( Rows . Count ,   " B ") は 使え ます 。 まあ 範囲 指定 だ と 少し カッタルイ の は 確か な ので 、 Cells (～). Resize (～) など と 使い分け た 方 が 便利 です が 。 後 、 Range は 多分 少し 遅く て 便利 な 奴 な ので 、 「 極力 つかわ ず 」 は 言い過ぎ かも 。 Range (" A1 : C3 , D4 : F6 , G7 : I 9 ") みたい な 指定 も あっ て 、 Range は コレ を 翻訳 し ながら 動作 する ので Cells ( 数値 , 数値 ) に 比べる と 不利 な 面 が ある ので 。 
＞ Set sheetobj = Workbooks ( 2 ). Worksheets ( 1 ) ＞ が ＞ Set sheetobj = Workbooks ( 1 ). Worksheets ( 1 ) ＞ と なっ て 作業 が 進め られ て しまい ます 。 Workbooks ( 1 ) という の は 、 「 現在 開か れ た ブック の なか で 、 1番 最初 に 開か れ た ブック 」 と 言う 意味 な の は 、 ご存じ な の です よ ね ？ もし 、 「 開か れ た 順番 」 で なく 、 「 ブック 名 」 で よけれ ば 、 Set sheetobj = Workbooks (" Book 1 . xlsx "). Worksheets ( 1 ) といった 書き方 を すれ ば 、 良い です 。 「 開か れ た 順番 」 を これから も 続け たい の なら 、 開く 順番 に 注意 する しか ない でしょ う ね 。 
Combobox の DisplayMember と ValueMember プロパティ を 設定 し て 表示 する 値 と 、 使用 する 値 を 別々 に する こと が 出来 ます 。 例えば 、 DisplayMember を 商品名 に 、 ValueMember を 在庫 数 に すれ ば 、 Combobox で 選択 し た 商品 の 在庫 数 を 取得 する こと が 出来 ます 。 http:// dobon .net / vb / dotnet / control / tbdisplaymember . html http:// www . r-na kai . com / archives / 29 
ＯＳ は もしかして Ｗｉｎ １ ０ に 無料 ＵＰ 品 です か ？ 
この SQL を どこ に 設定 する の か 次第 です 。 クエリ の 抽出 条件 に 記述 する なら 、 Between [ Forms ]![ フォーム 名 ]![ コンボ 1 ] And [ Forms ]![ フォーム 名 ]![ コンボ 2 ] という よう に どの フォーム に ある の か 分かる よう に 記述 し ます 。 この 場合 、 データ型 意識 する 必要 は ない です 。 クエリ の 方 で 適切 に 変換 し て くれ ます 。 ただ 、 クエリ の 「 クエリ パラメータ 」 プロパティ で データ型 を 明確 に 指定 し て おい た 方 か ベター です が （ 下記 リンク 先 参照 ） 。 ■ T ' sWare Access Tips # 542 ～ パラメータクエリ の パラメータ の データ型 を 限定 する に は ？～ http:// tsware .jp / tips / tips _ 542 . htm VBA で Filter プロパティ 等 に 設定 する 条件 式 を 生成 する 場合 は 、 対象 フィールド の データ型 によって 記述 が 変わっ て き ます 。 さらに VBA コード 中 で SQL 条件 式 は 文字列 として 扱う こと に なる という こと の 理解 も 必要 です 。 ( VBA の コード と SQL 文 は 別物 な ので ） 自分自身 の フォーム の Filter プロパティ に 設定 する 場合 の コード 例 対象 フィールド が 数値 型 の 場合 Me . Filter = " フィールド 名 Between " & Me . コンボ 1 & " And " & Me . コンボ 2 対象 フィールド が テキスト 型 の 場合 Me . Filter = " フィールド 名 Between '" & Me . コンボ 1 & "' And '" & Me . コンボ 2 & "'" 対象 フィールド が 日付 / 時刻 型 の 場合 Me . Filter = " フィールド 名 Between #" & Me . コンボ 1 & "# And #" & Me . コンボ 2 & "#" ちなみに 型変換 関数 は VBA 内 で データ型 を 変換 する 場合 に 使い ます が 、 VBA コード 中 の SQL 条件 式 の 場合 は 不 必要 な 場合 が ほとんど です 。 
以下 で どう なり ます か まず 、 新規 ファイル を 開い て 、 ・ 以下 全部 転記 し て 、 ・ Sheet 1 / Sheet 2 が ある こと を 確認 後 、 ・ testData で 確認 用 データ を 作り 、 ・ Samp 1 を 実行 し て み ます 良 さ そう なら 、 testData 以外 を 転記 し て 確認 し て み ます 各 文字数 が わかり ませ ん が 、 どう なり ます か Public Sub Samp 1 ()     Dim dic As Object , dicW As Object     Dim vA As Variant , vB As Variant     Dim vK As Variant , v As Variant     Dim vWs As Variant , vW As Variant     Dim i As Long , j As Long     Set dic = CreateObject (" Scripting . Dictionary ")     Set dicW = CreateObject (" Scripting . Dictionary ")     With Worksheets (" Sheet 2 ")        With . Range (" G1 ", . Cells ( Rows . Count , " G "). End ( xlUp ))           vB = . Value           For i = 1 To UBound ( vB )              dicW ( vB ( i , 1 )) = i           Next           vB = . Offset (, Range (" C1 "). Column - . Column ). Value        End With     End With     With Worksheets (" Sheet 1 ")        With . Range (" F1 ", . Cells ( Rows . Count , " F "). End ( xlUp ))           vA = . Value           For i = 1 To UBound ( vA )              If ( Not dic . Exists ( vA ( i , 1 ))) Then                 dic . Add vA ( i , 1 ), CreateObject (" Scripting . Dictionary ")              End If              dic ( vA ( i , 1 ))( i ) = Empty           Next           With . Offset (, Range (" E 1 "). Column - . Column )              vA = . Value              vWs = dic . Keys              For Each vW In mySort ( dicW . Keys )                 j = 0                 For Each vK In Filter ( vWs , vW , , vbTextCompare )                    For Each v In dic ( vK ). Keys                       vA ( v , 1 ) = vB ( dicW ( vW ), 1 )                    Next                    dic . Remove vK                    j = j + 1                 Next                 If ( j > 0 ) Then vWs = dic . Keys              Next              . Value = vA           End With        End With     End With     Set dic = Nothing     Set dicW = Nothing End Sub Private Function mySort ( ByVal vA As Variant ) As Variant     Dim v As Variant     Dim i As Long , k As Long     k = 0     v = " Go "     While ( Not IsEmpty ( v ))        v = Empty        k = k + 1        For i = LBound ( vA ) To UBound ( vA ) - k           If ( Len ( vA ( i )) < Len ( vA ( i + 1 ))) Then              v = vA ( i )              vA ( i ) = vA ( i + 1 )              vA ( i + 1 ) = v           ElseIf ( Len ( vA ( i )) = Len ( vA ( i + 1 ))) Then              If ( vA ( i ) < vA ( i + 1 )) Then                 v = vA ( i )                 vA ( i ) = vA ( i + 1 )                 vA ( i + 1 ) = v              End If           End If        Next     Wend     mySort = vA End Function ' 確認 用 簡易 データ 作成 Public Sub testData ()     Dim dic As Object     Dim vK As Variant     Dim sS As Variant     Dim i As Long , j As Long , k As Long     Const CCNT As Long = 50     Const CRH As Long = 300     Randomize     Set dic = CreateObject (" Scripting . Dictionary ")     While ( dic . Count < CCNT )        sS = ""        For i = 0 To Int ( 10 * Rnd ())           sS = sS & Chr ( Asc (" A ") + Int ( 26 * Rnd ()))        Next        dic ( sS ) = Empty        dic ( sS & sS ) = Empty     Wend     vK = dic . Keys     k = UBound ( vK )     Set dic = Nothing     Application .S creenUpdating = False     With Worksheets (" Sheet 2 ")        . Cells . Delete        For i = 0 To k           . Cells ( i + 1 , " G "). Value = vK ( i )           . Cells ( i + 1 , " C "). Value = " G " & i + 1        Next        . Columns . AutoFit     End With     With Worksheets (" Sheet 1 ")        . Cells . Delete        . Columns (" F "). NumberFormatLocal = "@"        For i = 1 To CRH           sS = ""           For j = 0 To Int ( 5 * Rnd ())              sS = sS & j           Next           If ( Rnd () > 0 . 75 ) Then              sS = sS & vK ( Int (( k + 1 ) * Rnd ()))           End If           For j = 0 To Int ( 5 * Rnd ())              sS = sS & j           Next           If ( Rnd () > 0 . 9 ) Then              sS = sS & vK ( Int (( k + 1 ) * Rnd ()))           End If           . Cells ( i , " F "). Value = sS           . Cells ( i , " E "). Value = i        Next        . Columns . AutoFit     End With     Application .S creenUpdating = True End Sub 
＞ の 部分 を 自分 なり に かきかえ て み た の です が うまく いき ませ ん 。 どの 様 に 書き換え た の か ？ だ が 処理 する 時 の シート 名 を 変える と 出来る と 思う が 一旦 差分 用 の シート を 削除 する 差分 用 の シート を 新規 に 作成 する の 2つ の 部分 を 削除 する その 際 オブジェクト 変数 st ( 0 )～ st ( 2 ) が 作成 さ れ ない ので それぞれ を Worksheets ( DelSheet ） Worksheets ( AddSheet ) Worksheets ( ChgSheet ) に 変更 する ? 
以下 の コード でいか が でしょ う か 。 条件 を 満たし て いる とき は 該当 セル の 背景色 を 消す よう に し て い ます 。 Option Explicit Sub Sample () Dim r As Long , c As Long For r = 1 To Range (" D " & Rows . Count ). End ( xlUp ). Row Select Case Range (" D " & r ). Value Case " 山 " With Range (" O " & r ) . Interior . Color = IIf (. Value Like "* 川 *", xlNone , 255 ) End With Case " ゴンドラ " For c = 5 To 9 Step 2 With Cells ( r , c ) . Interior . Color = IIf ((. Value <> "" And . Offset (, 1 ). Value = "○") Or (. Value = "" And . Offset (, 1 ). Value = " × "), xlNone , 255 ) End With Next c End Select Next r End Sub 
> Dim idx As Integer > Dim frmPage , toPage を 次 の よう に 。 Dim idx As Long Dim frmPage As Long Dim toPage As Long 
1 - A ブック の Sheet １ の ボタン クリック 2 - 同 一 フォルダ に A ブック を コピー 保存 （ ブック の 名前 は Sheet １ の セル A1 ） 3 - コピー し た ブック を 開く の プログラム 例 です 。 Sheet １ の セル A1 は 、 拡張子 を 付け た ブック 名 が 入力 さ れ て いる もの と し ます 。 Sub ボタン 1 _ Click () Dim xAfter As String With T hisWorkbook xAfter = . Path & "\" & . Worksheets (" Sheet 1 "). Range (" A1 ") .S aveCopyAs xAfter End With Workbooks . Open xAfter End Sub 
音 が 鳴る 前 に 、 イベント を 処理 さ せれ ば よい でしょ う 。 [ ユーザー フォーム 上 に 文字列 を 表示 ] する 処理 DoEvents PlaySound ActiveWorkbook . Path & "\ sound \ complete . wav ", 0 , 0 
「 自分 から 6 列 左 の 3 行 目 から 13 行 目 の 間 で 、 A 列 が 自分 の 行 の G 列 に 等しい 行 を 合計 しろ 」 です よ ね 。 だから sumif 関数 一撃 H3 : = sumif ($ A $3 :$ A $13 , $ G3 , B $3 : B $13 ) 
VB.NET 系 （ VB 2015 や VB 2013 他 ） の 場合 、 Timer コントロール は 不要 。 System . Threading . Thread . Sleep ( 500 ) で 、 0 . 5 秒 （ 500 ミリ 秒 ） 止まり ます 。 質問 内容 が 曖昧 で 、 どこ に 、 どんな 画像 を 表示 さ せる の か 分かり ませ ん が 、 画像 を 表示 さ せる System . Threading . Thread . Sleep ( 500 ) 次 の 画像 を 表示 さ せる で 、 目的 の こと が 出来る か と 思い ます 。 
二丁目 と 入力 し た 場合 は どう する の でしょ う か ？ 一 番地 と 入力 し た 場合 は どう する の でしょ う か ？ 十 一 丁目 と 入力 し た 場合 は どう する の でしょ う か ？ 
クラス 名 . イベント 名 += と やっ て い ませ ん か ？ Form クラス 内 に 書く なら 、 this . イベント 名 += もしくは 、 イベント 名 += のみで 記述 できる か と 思い ます 。 
どの よう な コード を 書い た の か 判り ませ ん が 、 下記 の サイト を 参考 に し て み て 下さい 。 どぼん - GZIP や デフレート で ファイル を 圧縮 する http:// dobon .net / vb / dotnet / file / compressfile . html 
これ で いい か な ？ if テキストボックス B . value = "" Then me. テキストボックス B . value = テキストボックス A . Value end if 
どの よう な 症状 で お 困り な の です か ？ 「 記述 し た い場所 に 上手く 記入 でき ませ ん 」 で は 、 説明 として は あまりに 貧弱 。 「 Ｘ Ｘ の 場所 に 転記 し たい の だ が 、 〇 〇 の ところ に なっ て しまう 」 といった よう な 具体 的 な 説明 が 必要 です ね 。 とりあえず 気 が 付い た 事 を 一言 。 > Set myRange = Cells ( Rows . Count , 1 ). End ( xlUp ). Offset ( 0 , 1 ) で 転記 先 を 決定 し て いる の です よ ね ？ そして 、 myRange の 参照 先 が 変わる の は 、 この ↑ ステップ だけ 。 転記 元 の セル は 、 > For i = 1 To 100 Step 1 > ・ ・ ・ = Worksheets (" 生産量 計算 シート "). Cells ( i + 1 , 1 ). Value > ・ ・ ・ = Worksheets (" 生産量 計算 シート "). Cells ( i + 1 , 4 ). Value といった よう な 感じ で 、 100 行 の データ から 転記 さ れる よう に なっ て ます 。 ところが 、 > myRange . Offset ( 0 , 15 ). Value = ・ ・ ・ > myRange . Offset ( 0 , 16 ). Value = ・ ・ ・ > myRange . Offset ( 0 , 17 ). Value = ・ ・ ・ といった よう に 、 転記 元 が 変われ ど 、 転記 先 は 、 変わり ませ ん 。 上書き し 続ける こと に なっ て ます ね 。 まずは この 不具合 を 改善 する 必要 が あり そう 。 
If m < a に 引っかかる と If b > a に 行き ませ ん な ので else に せ ず それぞれ if - endif で 独立 し た 条件 に する inputbox が 返す の は string です な ので 上記 IF 文 を 分け て 、 所持 金 で 100 と 入れ て も If b > a に たぶん 引っかかり ませ ん inputbox で 受け た n とか a は 数値 に 変換 （ cintｔ とか ） に し て あげ ない と だめ だ と 思い ます 
Console . Write () 及び Console . WriteLine () は コンソールアプリケーション ・ IO 向け の プロージャ で 、 そのままで は フォーム アプリケーション で は 使え ませ ん 。 な ので 、 書き出し た もの を テキストファイル に 出力 する 命令 を 書き ましょ う 。 次 の コード を Shared Sub Main () の 次 の 行 に 挿入 し て ください 。 Dim ResultIO As New System . IO . StreamWriter ("% appdata %\ QUIZAPP \ result . txt ", False , System . Text . Encoding . GetEncoding (" utf-8 ")) ResultIO . AutoFlush = True Dim Writer As System . IO . TextWriter = System . IO . TextWriter .S ynchronized ( ResultIO ) Console .S etOut ( Writer ) その後 デバッグ で ちゃんと Main () プロージャ が 呼び出せ て い たら % appdata %\ QUIZAPP ディレクトリ に result . txt が 生成 さ れ て いる はず です 。 ( エクスプローラ の アドレス 欄 に % appdata %\ QUIZAPP と 入力 し て あげる と 参照 でき ます 。 この ディレクトリ は アプリケーション が データ を 保存 し たり する 目的 で 使わ れ ます 。 先 に ディレクトリ を 作成 し て おく と 無難 かも 。 ) エラー が 吐か れ た など あれ ば また ご 質問 ください 。 
> ID 非公開 さん 2016 / 7 / 2200 : 45 : 28 > どなた か 、 修正 箇所 を お 教え 頂け ませ ん でしょ う か ？ それ は 外注 レベル の 話し に なる ので 、 無償 の 場 で 教 われる よう な もの で は ない ので 、 でき なけれ ば 断る か 無理 な 事 を 伝える べき です 。 
下記 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim rng As Range Dim pos As Long Dim ch As String Dim buf As String Application .S creenUpdating = False For Each rng In Range ( Range (" A6 "), Cells ( Rows . Count , " ZZ "). SpecialCells ( xlLastCell , 2 )) buf = "" For pos = 1 To Len ( rng . Value ) ch = Mid ( rng . Value , pos , 1 ) If ch = " ヴ " Then buf = buf & " ｳﾞ " ElseIf ch = " ヮ " Then buf = buf & " ﾜ " ElseIf ch Like "[ ァ - ン ]" Then buf = buf & StrConv ( ch , vbNarrow ) Else buf = buf & Mid ( rng . Value , pos , 1 ) End If Next pos rng . Value = buf DoEvents Next rng Application .S creenUpdating = True End Sub ワーク シート 関数 の ASC を 使う と カナ だけ で なく 英数字 も 半角 に なっ て しまい ます 。 です ので 半角 カタカナ へ の 変換 は hdump さん の 回答 の よう に すべて の セル を １ 文字 ずつ 調べ て カナカナ だけ を StrConv を 使っ て 半角 に 変換 し て いく しか あり ませ ん 。 ただし StrConv を 使っ て も 「 ヴ 」 は 半角 「 ｳﾞ 」 に なっ て くれ ませ ん ので 、 その 対応 も 必要 です 。 また 、 「 ヮ 」 （ 小さい ワ ） は 相当 する 半角 カタカナ が 存在 し ない ので 、 便宜上 半角 の ふつう の 「 ﾜ 」 に し て い ます 。 ちなみに エクセル の 最大 行 は 1 , 048 , 576 行 な ので 、 現実 に は ほとんど あり 得 ませ ん が 、 A6 : ZZ 1048576 まで を すべて 調べる と なる と 下手 を する と 数 時間 かかり ます 。 （ 私 の PC で A6 : ZZ 1048576 の すべて に 「 アイウエオ 」 を 入れ て テスト し たら 1時間 以上 かかり まし た ） 
データベース の 抽出 で 複数 条件 で あれ ば 、 フィルタ を 用いる と コード も 短く 処理 も 速い と 思い ます よ 。 AdvancedFilter メソッド を 使う こと で 、 フィルタ の 結果 を 別 シート に 転記 でき ます 。 細か な セル 情報 が ない ので 概要 だけ 説明 する と ・ ・ 。 まず 、 Sheet 1 に データベース （ 表 ） 、 Sheet 2 は 条件 を 入力 する 表 、 Sheet 3 に 結果 を 表示 する よう な シート 構成 に し ます 。 ユーザー フォーム で 入力 条件 を 作る なら 、 各 テキストボックス の データ が Sheet 2 の 条件 欄 の セル に 代入 する よう に 設定 を し て おき ます 。 コマンド ボタン を 押す と AdvancedFilter メソッド が 実行 さ れ 、 結果 を Sheet 3 に 表示 し て 、 その 結果 を ユーザ フォーム の リスト ボックス に 表示 する よう に 設定 する 流れ の 処理 を 作れ ば 良い の で は 。 
For Each sh In Sheets sh . Name = sh . Range (" E 4 "). MergeArea ( 1 , 1 ). Value Next 全て の シート に対して 繰り返し ( For Each ) E 4 を 先頭 と し た 結合 セル の 値 （ MergeArea ( 1 , 1 ). value ) を 、 シート 名 （ sh . Name ) に 設定 し ます 。 
こんにちは。 フォーム の 再 表示 が 必要 です me. repaint を フォーム の コード ペイン にて 実行 し て ください 
こんにちは。 1 ) a .jpg が 、 エクセル シート に 貼り 付け た 状態 の ブック を 準備 2 ) マクロ の 自動 記録 を 開始 。 3 ) コントロール を 選択 し 、 B .jpg の ファイル の 色 設定 を する 操作 を し ます 。 4 ) b の 図 が 張り付い た とき に 、 「 マクロ の 自動 記録 」 の 停止 5 ) 出来上がっ た コード で 、 ファイル を 指定 する 部分 に 、 「 ファイル を 選択 する コード 」 に おきかえ という 流れ で 、 設定 し ます 。 図 の 設定 で は 、 エクセル バージョン の 影響 が ある 部分 です 。 主 様 の 考え て いる もの が 、 バージョン が 何 でも できる 、 という の は 、 最初 から ダメ という こと も 、 覚悟 し て ください 。 ( まずは 、 バージョン が 2013 で なかっ たら 、 動作 し ませ ん 、 という もの を 作成 する という こと です 
可読性 の 良い 回答 が なかっ たら ･･･ 参考 に なり そう なら 、 やっ て み て も 良い かな 程度 で Dictionary の ２ 段 構成 に し ます １ 段 目 キー ： A 列 の 都道府県 ？ ２ 段 目 キー ： 何 列 目 に 書き出す の か （ 列 番号 ） 値 は 配列 で 持ち >     vC = Array (" とても よい ", " よい ", " ふつう ", " わるい ") で 定義 し た もの が 配列 添え 字 1 ～ に なる よう に 配列 は 添え 字 0 ～ と し 、 0 に は 全体 個数 を ･･･ 変 数 v が そう だ と し たら 、 v ( 0 )： 全体 個 数 v ( 1 )： とても よい の 個 数 v ( 2 )： よい の 個 数 v ( 3 )： ふつう の 個 数 v ( 4 )： わるい の 個 数 v ( 5 )： 上記 の 文字列 と 一致 し なかっ た 個数 雰囲気 以下 で どう なり ます か ？ なお 、 ◎ 、 ● 、 ○ の 判別 が 理解 でき なかっ た ので 、 記述 内 、 ★～ ～★ 間 の 変更 要 Option Explicit Public Sub Samp 1 ()     Dim dic As Object , dicE As Object     Dim vA As Variant , vE As Variant , v As Variant     Dim vS As Variant , vC As Variant , vK As Variant     Dim sS As String     Dim i As Long , j As Long , k As Long     vS = Array (" 春 ", " 夏 ", " 秋 ", " 冬 ")     vC = Array (" とても よい ", " よい ", " ふつう ", " わるい ")     Set dic = CreateObject (" Scripting . Dictionary ")     Set dicE = CreateObject (" Scripting . Dictionary ")     For i = 0 To UBound ( vS )        dicE ( vS ( i )) = i + 2     Next     vA = Range (" A1 "). Current Region . Resize (, 3 ). Value     For i = 1 To UBound ( vA )        If ( dicE . Exists ( vA ( i , 2 ))) Then           j = dicE ( vA ( i , 2 ))           For k = 0 To UBound ( vC )              If ( vA ( i , 3 ) = vC ( k )) Then Exit For           Next           k = k + 1           If ( Not dic . Exists ( vA ( i , 1 ))) Then              dic . Add vA ( i , 1 ), CreateObject (" Scripting . Dictionary ")           End If           v = dic ( vA ( i , 1 ))( j )           If ( Not IsArray ( v )) Then              ReDim v ( UBound ( vC ) + 2 )              v ( 0 ) = 1              v ( k ) = 1           Else              v ( 0 ) = v ( 0 ) + 1              v ( k ) = v ( k ) + 1           End If           dic ( vA ( i , 1 ))( j ) = v        End If     Next     ReDim vA ( 1 To dic . Count + 1 , 1 To dic E.C ount + 1 )     For Each vE In dicE . Keys        vA ( 1 , dicE ( vE )) = vE     Next     i = 1     For Each vK In dic . Keys        i = i + 1        vA ( i , 1 ) = vK        For Each vE In dicE . Keys           j = dicE ( vE )           sS = "-"           v = dic ( vK )( j )           If ( IsArray ( v )) Then              ' ★～              If ( v ( 0 ) = v ( 1 )) Then                 sS = "◎"              ElseIf (( v ( 1 ) > 0 ) Or ( v ( 2 ) > 0 )) Then                 sS = "●"              Else              End If              ' ～★           End If           vA ( i , j ) = sS        Next     Next     Application .S creenUpdating = False     With Worksheets . Add        With . Range (" A1 "). Resize ( i , UBound ( vA , 2 ))           . Value = vA           With . Offset ( 1 ). Resize (. Rows . Count - 1 )              .S ort . Cells ( 1 ), xlAscending , Header := xlNo           End With           . HorizontalAlignment = xlCenter        End With     End With     Application .S creenUpdating = True     Set dic = Nothing     Set dicE = Nothing End Sub ' 確認 用 簡易 データ 作成 Public Sub testData ()     Dim dic As Object     Dim vS As Variant , vC As Variant , vK As Variant     Dim sS As String     Dim i As Long , j As Long     Const CCNT As Long = 50     Const CRH As Long = 10000     vS = Array (" 春 ", " 夏 ", " 秋 ", " 冬 ", " 正月 ")     vC = Array (" とても よい ", " よい ", " ふつう ", " わるい ", " 無 回答 ")     Set dic = CreateObject (" Scripting . Dictionary ")     Randomize     While ( dic . Count < CCNT )        sS = Chr ( Asc (" A ") + Int ( 26 * Rnd ()))        sS = sS & Format ( Int ( 99 * Rnd ()) + 1 , " 00 ")        dic ( sS ) = Empty     Wend     vK = dic . Keys     Application .S creenUpdating = False     Cells . Delete     For i = 1 To CRH        Cells ( i , " A "). Value = vK (( Int ( dic . Count * Rnd ())))        Cells ( i , " B "). Value = vS ( Int (( UBound ( vS ) + 1 ) * Rnd ()))        Cells ( i , " C "). Value = vC ( Int (( UBound ( vC ) + 1 ) * Rnd ()))     Next     Columns . AutoFit     Application .S creenUpdating = True     Set dic = Nothing End Sub 
TimeValue は 時間 の 部分 しか 取り出さ ない ので 、 日付 も 取り出す 必要 が あり ます 。 それから 表示 形式 を "[ h ]: mm " に し なく て は なり ませ ん が 、 Format で は 出来 ませ ん ので 下記 の よう に し ます 。 Private Sub Command Bu t to n2 _ Click () Dim T 1 As Date , T2 As Date TextBox 2 . Text = Now () T 1 = DateValue ( TextBox 1 . Text ) + TimeValue ( TextBox 1 . Text ) T2 = DateValue ( TextBox 2 . Text ) + TimeValue ( TextBox 2 . Text ) TextBox 3 . Value = WorksheetFunction . Text ( T2 - T 1 , "[ h ]: mm ") End Sub 
入力 フォーム 内 に ある 「 開始 」 ボタン に 記載 する コード です 。 Private Sub CommandButton 1 _ Click () Dim sh As Worksheet Dim i As Long , imax As Long Dim cnt As Integer Application .S creenUpdating = False Set sh = Worksheets (" SheetB ") For cnt = 1 To 20 If Me (" TextBox " & cnt ). Value <> "" Then With sh imax = . Cells ( Rows . Count , 1 ). End ( xlUp ). Row For i = imax To 1 Step - 1 If InStr (. Range (" A " & i ). Value , Me (" TextBox " & cnt ). Value ) > 0 Then . Rows ( i ). Delete End If Next i End With End If Next Application .S creenUpdating = True End Sub 
イベント を QueryClose で は なく UserForm _ Terminate に し て み て ください 。 
えーと 、 やり たい 事 として は 、 ・ 結果 シート を 削除 する ・ 結果 シート 以外 は クリア する で いい ん でしょ う か ？ （ プログラム 見 た 限り で は そんな 感じ に 見え ます ） で 、 結果 シート を 削除 する だけ でし たら 、 For Each sh In Sheets If sh . Name = " 結果 " Then Application . DisplayAlerts = False sh . Delete Application . DisplayAlerts = True Exit For End If Next これ だけ で ダイアログ なし で 削除 でき ます 。 結果 シート 以外 の シート を クリア する 処理 を 追加 する ん でし たら 、 Exit for と End If の 間 に 、 Else sh . Cells . Clear を 追加 し ます 。 
Private Sub Workbook _ Open () Sheets (" Sheet 1 "). Activate End Sub Workbook _ Open () イベント に 開き たい Sheet を Activate する コード を 書き ます 。 
クリップボード を 経由 すれ ば 、 そういった 操作 が 可能 です 。 また 、 Open 命令 、 Input 命令 で は 全て の 文字 を まとめ て 読み込め ない ので 、 別 な 方法 を 使い ます 。 Sub test () fpath = " テキストデータフォルダパス \" Set fso = CreateObject (" Scripting . FileSystemObject ") Set txt = fso . OpenTextFile ( fpath & " ファイル 名 ") ' 全 文字列 を まとめ て 読み込み msg = txt . readAll () txt . Close ' ここ が クリップボード と の 通信 Dim clip As New DataObject clip .S etText msg clip . PutInClipboard ' 貼り 付け Range (" A1 "). PasteSpecial End Sub 
デスクトップ の フォルダー は 、 Sub sample () Dim xPath As String xPath = CreateObject (" WScript .S hell "). SpecialFolders (" Desktop ") & "\ 見積り v er2 \ 設備 DB . xlsx " Workbooks . Open xPath End Sub といった 感じ で 取得 でき ます 。 http:// office tanaka .net / excel / vb a/t ips / tips 107 . htm 
http:// excelvba . pc - users .net / fo l4 / 4 _ 2 . html Workbooks . Open メソッド の パラメータ で パスワード 指定 が でき ます 。 
AddPicture に し て 下さい 。 Sub PictFit () Dim PicFile As String Dim Pic As Shape PicFile = Application . GetOpenFilename () If PicFile = " False " Then Exit Sub Set Pic = ActiveSheet .S hapes . AddPicture ( PicFile , False , True , 0 , 0 , - 1 , - 1 ) With Pic . Height = Active Cell . MergeArea . Height . Top = Active Cell . Top . Left = Active Cell . Left + ( Active Cell . MergeArea . Width - . Width ) / 2 End With End Sub 
説明 不足 で 根本 的 に わから ない こと だらけ です が 。 。 。 まず VBScript と は どこ で 使わ れる VBScript の 話 でしょ う か ？ WSH の 「 VBS 」 ファイル で 使わ れる VBScript も あれ ば HTML や HTA で 使わ れる VBScript も あれ ば ASP で 使わ れる VBScript も あり ます 。 同じ VBScript でも 使い 方 が 全然 違い ます 。 「 VBScript - Wikipedia 」 https :// ja . wikipedia . org / wiki / VBScript 私 は 個人的 に ， WSH の 「 VBS 」 ファイル で 使わ れる VBScript と HTML や HTA で 使わ れる VBScript で あれ ば ある程度 わかり ます が ASP で 使わ れる VBScript など 全く わかり ませ ん 。 次に ， 「 TSV ( タブ 区切り ) ファイル の 上下 を 反転 さ せる 」 という 意味 が わかり ませ ん 。 タブ 区切り の データ に は 上下 など なく タブ を はさん で ひたすら 左右 に 並ぶ だけ で は ない でしょ う か ？ もし 「 改行 」 が 入れ ば ， データ は 「 改行 」 を 区切り として 縦 に 並び ます ね 。 この 「 改行 」 区切り の 場合 で あれ ば 「 上下 を 反転 さ せる 」 という 意味 も ( 意味 だけ は ) わかり ます が ， タブ 区切り の データ に は 上下 の 意味 が わかり ませ ん 。 また 仮に 「 改行 」 区切り だ として も VB 系 的 な 書き方 を すれ ば vbCrLf も 「 改行 」 です し ， vbLf も 「 改行 」 です し ， vbCr も 「 改行 」 です 。 データ の 中 に は どの 改行 が 入っ て いる の かも わかり ませ ん 。 さらに ， 仮に 「 上下 を 反転 さ せ た データ 」 が でき た として ， その データ を どう する の かも わかり ませ ん 。 === === === === === === === とにかく 不明 な こと だらけ です が ， 「 タブ 」 か 「 改行 」 か 知り ませ ん が 何 か の 「 区切り 」 を 挟ん だ 文字列 データ の 順 を 逆順 に し たい の でし たら ArrayList クラス の Reverse () メソッド を 使え ば 簡単 かも しれ ませ ん 。 (※ これ を 使う に は .NET Framework が 必要 かも しれ ませ ん ) 「 ArrayList クラス ( System . Collections )」 https :// msdn . microsoft . com / ja - jp / library / system . collections . arrayli ... とにかく 反転 さ せ たい データ の 「 区切り 」 が 何 で ある の か わから ない ので ， 下 の コード で は 「 ↓ 」 という 文字 を 「 区切り 」 として データ の 順 を 反転 さ せる 例 を 挙げ ます 。 一応 ， WSH の 「 VBS 」 ファイル で 使わ れる と 想定 し た 書い た VBScript コード 例 です 。 ' - - - - - ------------------------- '「↓」 入り の 適当 な 文字列 MyStr を 作成 MyStr = " あ いう ↓ か きく ↓ さ しす ↓ たち つ ↓ なに ぬ " ' 文字列 MyStr を 「 ↓ 」 で 区切っ た 配列 に する MyArr = Split ( MyStr ,"↓") ' ArrayList オブジェクト myAL の 作成 Set MyAL = CreateObject (" System . Collections . ArrayList ") ' 配列 MyArr の 要素 数 分 ループ For i = 0 To UBound ( MyArr )      ' myAL の 要素 に 配列 MyArr の 要素 を 順に 追加      MyAL . add MyArr ( i ) Next ' MyAL 全体 の 要素 の 順序 を 反転 MyAL . Reverse () ' MyAL を 再び 配列 MyArr に 戻す MyArr = MyAL . toArray () ' MyArr の 全 要素 間 に 「 ↓ 」 を 入れ て 再 文字列 化 MyStr = Join ( MyArr ,"↓") ' 試し に MyStr を 出力 表示 し て みる MsgBox MyStr '(→ 出力 内容 「 なに ぬ ↓ たち つ ↓ さ しす ↓ か きく ↓ あ いう 」) ' - - - - - ------------------------- 上記 コード を メモ帳 など に コピペ し て 「 任意 の ファイル 名 . vbs 」 で 保存 し その ファイル を ダブル クリップ し て もらえ ば 動作 確認 できる の で は ない か と 思い ます 。 
myFLD の 最後 は "\" に なっ て ます か ？ 
再帰 呼出 ロジック は 、 最後 、 再帰 を 抜け出す 処理 が 必要 だ と おもい ます が ？ この ロジック だ と 処理 が 異常 終了 し ない 限り 再帰 を 続ける と 思い ます 。 「 プログラム が 停止 し て しまう 」 症状 と は 違い ます けど 。 
ワイルドカード を 使用 すれ ば いい の では 。 c :\ hoge \*.* と する と 、 c :\ hoge 配下 に ある すべて の ファイル を 対象 と する こと が でき ます 。 ただ 、 カメラ の 種類 が 複数 ある という こと な ので 、 1回 1回 実行 する 都度 変更 する の で は なく 、 カメラ の 種類 分 bat ファイル を 作成 し て おけ ば いい の で は ない の でしょ う か ？ やり たい こと を 簡潔 に bat ファイル に し て おく ほう が 、 カメラ が 増え たり 、 変更 し たり し た 際 に メンテナンス も し やすく なる と 思い ます 。 
質問 文章 に 、 マクロ 内容 を 書き出し て み て 。 文字 が 小さ すぎ て 読め ませ ん m(__)m 
エラー 処理 ルーチン に 回数 制限 を 追加 し て は 如何 でしょ う か ？ １ 回 の 待ち時間 は ５ ０ ０ ｍ ｓ 程度 に し 、 １ ０ 回 ほど 繰り返し て も ダメ な 場合 は タイムアウト エラー で 停止 さ せる 。 
一 例 です 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim r As Range Set Target = Inter sect ( Target , Range (" B 1 : B2 0000 ")) If Target Is Nothing Then Exit Sub Application . EnableEvents = False For Each r In Target Cells ( r . Row , " AO ") = Now If Cells ( r . Row , " AN ") = 0 Then Cells ( r . Row , " AN ") = Now Next Application . EnableEvents = True End Sub 
システム設計 など 必要 あり ませ ん 。 画像 の 通り 作れ ば それで よい です 。 
その 方法 で 良い と 思い ます よ 。 考え方 は シンプル な 方 が 良い です し 、 それで コード が 複雑 化 する なら ともかく 、 そう なる と も 思え ませ ん ので ・ ・ ・ 。 変に 奇 を てらう 必要 は ない と 思い ます 。 ちなみに 、 最新 ファイル なら ば 、 DateLastModified の 方 で は あり ませ ん か ？ DateCreated だ と 作成 日 に なり ます 。 
CheckBox 1 の 状態 に かかわら ず 状況 列 に 日付 が 入っ て い たら スキップ する の で あれ ば 、 ’ ↓ ここ を 変え たい ！ ' 状況 列 が 「 削除 」 の とき は スキップ する If CheckBox 1 . Value = True And . Offset (, 1 ). Value = " 削除 " Then を ' 状況 列 に 日付 が 入っ て い たら スキップ する If IsDate (. Offset (, 1 ). Value ) Then として み て 下さい 。 
サーバ 側 で 、 ログイン 処理 時 の レスポンス で ワンタイムトークン を 発行 し て 、 DB に 保存 。 それ 以降 、 WEB API に は 必ず パラメータ として 、 token = xxxx みたい な パラメータ を 付加 さ せ て 、 トークン が 一致 し ない 場合 は API を 無効 に する よう な 感じ です か ね ？ クライアント 側 を Win アプリ に する なら 、 サーバ 側 を LAMP で 構築 し て 、 PHP あたり で REST サーバー に し ちゃえ ば 簡単 か と 。 （ クライアント へ の 戻り値 は JSON や XML ） 
よく ない 箇所 が あっ た ので 、 訂正 し まし た 。 確認 お願い し ます 。 Sub 整列 () Dim i As Long , j As Long , k As Long , kk As Long , cc As Long Dim vv As Variant Dim dat () As Double , ddd () As Variant Const 分割 As Long = 5000 Const 制限 As Double = - 1 ' 消去 Columns (" D : NTT "). ClearContents Range (" A1 "). Select ' データ を 得る ([ B 1 ] から 下方 へ の データ ) vv = Range ( Range (" B 1 "), Range (" B 1 "). End ( xlDown )) ' 制限 除外 j = - 1 For i = 1 To UBound ( vv ) If 制限 > vv ( i , 1 ) Then ' 除外 Else j = j + 1 : ReDim Preserve dat ( j ) dat ( j ) = vv ( i , 1 ) ' 該当 データ 保持 End If Next ' データ を 配列 に 埋める cc = Application . WorksheetFunction . RoundUp ( j / 分割 , 0 ) ReDim ddd ( 分割 , cc ) i = 0 : k = 0 : kk = 1 Do ddd ( k , Int ( i / 分割 )) = dat ( i ) i = i + 1 If i Mod 分割 = 0 Then kk = - kk Else k = k + kk End If Loop While ( i <= j ) ' 出力 ([ D1 ] を 左角 に 出力 ) Range ( Range (" D1 "), Range (" D1 "). Offset ( 分割 - 1 , cc - 1 )) = ddd End Sub 
終了 、 開始 に 代入 さ れ て いる の は 時刻 の 文字列 表現 です ので 、 そのまま 引き算 の 計算 は でき ませ ん 。 
fz 4 wi さん 、 こんばんは 。 VBA の 基本 機能 に 、 カレントフォルダ を 変更 する 機能 は ない ので 、 外部 オブジェクト を 利用 し ます 。 次 の 例 は 、 デスクトップ フォルダ 下 の " 123 " フォルダ を カレント フォルダ に 変更 し ます 。 With CreateObject (" WScript .S hell ") . Current Director y = .S pecialFolders (" Desktop ") & "\ 123 " End With 
参考 に って 提示 さ れ た コード は 、 何 が 何 を 表し て いる の か 解読 が 大変 そう 単に 足し算 の 結果 を テキストボックス に 表示 する よう に は 感じ られ ない → 私 の 解読 不足 かも しれ ない です が 
という かも う 2016年度 から ない と 思い ます が … 。 http:// www . dnc . ac.jp / data / kakomondai . html ↑ 大学入試センター が 掲載 し て いる 3年 分 の センター試験 過去問 です 。 平成27年度 は 旧 課程 者 用 に あり ます が 、 平成28年度 から は 新 課程 者 用 の 問題 だけ に なっ た ので 問題 は あり ませ ん 。 https :// akahon .net / shinkatei / math / 新 課程 数学 の 変更 点 です 。 新 課程 で は 「 数値計算 と コンピュータ 」 が なくなっ た ので 、 当然 教科書 を 元 に 問題 を 作る センター試験 から も 問題 は なくなり ます 。 
こんにちは。 if WS cri pt. Arguments . count = 0 then msgbox " ひきすう が ない です " wsc ri pt. quit end if v 1 = WS cri pt. Arguments ( 0 ) msgbox v 1 set xla = create object (" excel . application ") xla . visible = true set w 1 = xla . workbooks . open ( v 1 ) v 1 = w 1 .s heets ( 1 ). Range (" A1 "). value Set fso = CreateObject (" Scripting . FileSystemObject ") Set MyFile = fso . CreateTextFile (" c :\ testfile . txt ", True ) MyFile . write line v 1 MyFile . close これ で 、 テキストファイル まで は でき ます 。 主 様 、 「 メモ帳 に 書き込む 」 という 言い方 は 、 スクリプト コード で は いい ませ ん 。 どんな テキストファイル 、 と 言っ て ください 。 スクリプト は 、 画面 に 書く の は 、 出来 ませ ん 。 メモ帳 は 、 とくに 。 
Resize という 便利 な プロパティ を 使い ましょ う 。 Sub sample () Dim i As Long Application . DisplayAlerts = False For i = 5 To 100 Step 2 Cells ( i , 1 ). Resize ( 2 ). Merge Next i Application . DisplayAlerts = True End Sub 
あまり 高い 教育 を 受け られ なかっ た から で は ない でしょ う か 。 
ヘルプ 。 https :// msdn . microsoft . com / ja - jp / library / office / ff 198302 . aspx 
With や オブジェクト 変数 を 使用 し て 、 プログラム を 全体 的 に 纏め ましょ う 。 Thisworkbook や Worksheets など の コード が プログラム 全体 に 散乱 し て いる 感じ で 、 将来 仕様変更 が 発生 し た とき 変更 作業 が 大変 に なり そう です 。 あと 、 シート の コピー は 、 「 重複 有無 を 確認 する 」 の では なく 、 「 とにかく 削除 を し て みる 」 という 考え の ほう が 簡単 じゃ ない です か ？ ↓ は 一 例 。 Sub テスト () Dim FName As String , wb As Workbook , myPath As String , wsname As String Dim ws 0 As Worksheet , w s1 As Worksheet With T hisWorkbook myPath = . Path & "\" With . Worksheets Set ws 0 = . Item (" sheet 1 ") FName = Dir ( myPath & "*" & ws 0 . Range (" A1 "). Value & "*.*") If FName <> "" Then Set wb = Workbooks . Open ( myPath & FName ) Set w s1 = wb . Worksheets (" 入力 シート ") wsname = w s1 . Range (" B 6 "). Value & " 入力 シート " On Error Resume Next Application . DisplayAlerts = False . Item ( wsname ). Delete Application . DisplayAlerts = True On Error GoTo 0 w s1 . Copy after := ws 0 ActiveSheet . Name = wsname End If End With End With End Sub 
まず 、 ThisWorkBook .S aveAs strSaveName を し た 時点 で 、 新しい ファイル 名 に なっ た Book で 動作 し て いる 状態 と なり ます 。 （ ★ スズキ ... は 閉じ て いる ） です ので 、 OnTime を 使用 せ ず とも 、 SaveAs の 後 に 、 Kill する だけ で 旧 ファイル を 削除 でき ます 。 [ 参考 ] Sub ファイ 名 を 変え て 消す () ' 自分自身 の パス myPath = ThisWorkbook . FullName ' パス から ファイル 名 myFileName = ThisWorkbook . Name ' ファイル 名 から ★ を 抜く newFileName = Replace ( myFileName , "★", "") ' 保存 先 newFilePath = " c :\ テスト \" & newFileName ' 新 ファイル 名 で 保存 ( この 時点 で 、 book は 新しい ファイル 名 ） ThisWorkbook .S aveAs newFilePath ' 旧 ファイル を 削除 Kill myPath End Sub 
そのまま VBA で 表す と = WorksheetFunction .S umIf ( Range (" D6 : K 40 "), ComboBox 1 . Text , Range (" K6 : K 40 ")) です が 、 あなた が やり たい こと は 、 本当に その 数式 で 合っ て いる の でしょ う か ？ 
こんにちは。 System . Environment . GetFolderPath ( Environment .S pecialFolder . UserProfile ) これ が 、 文字列 部分 です 。 ' ユーザー の プロファイル を 開く System . Diagnostics . Process .S tart (" file ://% USER PROFILE %") は ' ユーザー の プロファイル を 開く System . Diagnostics . Process .S tart (" file ://" & System . Environment . GetFolderPath ( Environment .S pecialFolder . UserProfile ) ) で 、 確認 し て み て ください 
vbs で 書い て おき ます 。 お 好き な よう に 編集 し て ください 。 ' Button 1 の クリック イベント dim x 0 , x1 , y 0 , y1 , dn , dx , s x 0 = 0 ' ここ から x1 = 1 ' ここ まで dn = 1000 ' 分割数 dx = ( x1 - x 0 ) / dn ' 微小 台形 高さ s = 0 y 0 = fx ( x 0 ) ' 台形 の ( 上下 ) 底 for i = 1 to dn ' 分割 回数 分 を 処理 y1 = fx ( x 0 + d x * i ) ' 台形 の ( 上下 ) 底 s = s + ( y 0 + y1 ) * dx / 2 ' 台形 面積 累計 y 0 = y1 ' 台形 の 底 を 置き換え next msgbox s WS cri pt. Quit function fx ( x ) fx = x ^ 7 end function 
もっと 簡単 に 書け そう です ね 。 とりあえず B , C 列 用 。 列 が 増える の なら 、 ★ の 数字 を ふやし て ください 。 Sub sample () Dim rng , i As Long Const ie As Long = 2 '★ For Each rng In Range (" A 2 ", Cells ( Rows . Count , 1 ). End ( xlUp )) _ .S pecialCells ( xlCellTypeConstants ) Application . DisplayAlerts = False With rng . MergeArea For i = 1 To ie . Offset (, i ). Resize (. Rows . Count ). Merge Next i End With Application . DisplayAlerts = True Next rng End Sub 
cccalaur さん 、 こんにちは。 ４つ の 列 の コピー ～ 貼り 付け を 、 繰り返し 処理 に し たい 、 という 要望 です ね 。 一番 簡単 な 方法 は 、 ast . Range () の 引数 と 、 wst . Range () の 引数 を 、 それぞれ 配列 変数 に 放り込ん で 、 For ループ で 回す 方法 か と 思い ます 。 
Range (" C4 : C 8 "). Formula = "= B4 * C4 " を Range (" D4 : D 8 "). Formula = "= B4 * C4 " に 変更 すれ ば ＯＫ です 。 ここ が 間違っ て い た ので 、 数量 が すべて ０ で 表示 さ れ て まし た 。 
参照 設定 で microsoft active data object library ・ ・ に チェック し て ください 
画像 で は 何 か 見え ませ ん 。 ソース と エラー 内容 を 詳しく 書い て ください 。 
その と うり 、 まずは Ardino の ポート と 速度 を 求める 、 シリアル モニタ で 使っ てる よ ね 、 わから なけれ ば 、 速度 は SETUP の Serial . begin ( 19200 ); なら 19200 だ よ ね 、 ポート は IDE の ツール ＞ ポート で わかる だろ 、 VB 側 は ２ ３ ２ ｃ の シリアル通信 だ よ 、 これ で 検索 すれ ば わかる と おもい ます 。 
エクセル 2010 で 回答 し ます 。 シート に 「 ユーザー フォーム の チェックボックス 」 を ４つ 配置 し ます 。 そうすると 「 チェック 1 」 ～「 チェック 4 」 という 名前 が 付け られ ます 。 配置 し た チェックボックス を １つ ずつ 右クリック し 、 右クリックメニュー から 「 マクロ の 登録 」 にて 「 Macro 1 」 を 登録 し ます 。 その 状態 で の VBA の ソースコード を 以下 に 記載 し ます 。 Public Sub Macro 1 () Dim vntCheckboxs As Variant Dim lngIndex As Long Dim strText As String With Worksheets (" Sheet 1 ") vntCheckboxs = Array (. Shapes (" チェック 1 "), .S hapes (" チェック 2 "), .S hapes (" チェック 3 "), .S hapes (" チェック 4 ")) End With For lngIndex = LBound ( vntCheckboxs ) To UBound ( vntCheckboxs ) If vntCheckboxs ( lngIndex ). OLEFormat . Object . Value > 0 Then If Len ( strText ) > 0 Then strText = strText & "／" End If strText = strText & vntCheckboxs ( lngIndex ). OLEFormat . Object . Text End If Next Worksheets (" Sheet 1 "). Range (" A1 "). Value = strText End Sub 
「 うまく 動作 し ませ ん 」 は すべて あなた の 勘違い か スペル ミス が 原因 でし た 。 InputBox を 使う 場合 は 「 キャンセル 」 が 押さ れ た 時 の 対処 の コード を 必ず 書く よう に し て ください 。 Sub 関数 の 値 () Set MyWs = Worksheets (" 数学 関数 ") MyWs .S elect Cells . Clear Set MyRange = Range (" A1 : E 1 ") With MyRange . Value = Array (" X ", " X * X ", "√ X ", " sin ( X )", " cos ( X )") . HorizontalAlignment = xlCenter . Interior . Color Index = 35 End With For i = 2 To 33 Cells ( i , 1 ) = ( i - 1 ) / 10 Next i Range (" B2 : B 33 ") = "= A 2 * A 2 " Range (" C 2 : C3 3 ") = "= sqrt ( A 2 )" Range (" D2 : D3 3 ") = "= sin ( A 2 )" Range (" E2 : E3 3 ") = "= cos ( A 2 ) " End Sub Sub グラフ 描画 () Set MyWs = Worksheets (" 数学 関数 ") For Each MyCharts In MyWs . ChartObjects MyCharts . Delete Next px = Columns (" F "). Left + 20 py = Rows (" 1 "). Top + 10 Set MyRange = MyWs . Range (" A1 : E3 3 ") Set MyChart = MyWs . ChartObjects . Add ( px , py , 300 , 200 ) MyChart . Activate MyChart . Name = " MatchGraph " With ActiveChart . ChartType = xlLine .S etSourceData Source := MyRange , PlotBy := xlColumns . HasTitle = True . ChartTitle . Characters . Text = " 関数 の グラフ " . Axes ( xlCategory , xlPrimary ). HasTitle = False . Axes ( xlCategory ). TickLabels . Orientation = xlHorizontal End With MyRange .S elect MsgBox " 描画 完了 " End Sub Sub グラフ 更新 1 () Set MyWs = Worksheets (" 数学 関数 ") MyWs .S elect Set MyRange = Nothing On Error Resume Next Set MyRange = Application . InputBox ( prompt :=" 範囲 を 選択 し て ください ", Type := 8 ) On Error GoTo 0 If MyRange Is Nothing Then Exit Sub MyWs . ChartObjects (" MatchGraph "). Activate ActiveChart .S etSourceData Source := MyRange , PlotBy := xlColumns MyRange .S elect MsgBox " 描画 完了 " End Sub Private Sub CommandButton 1 _ Click () Set MyWs = Worksheets (" 数学 関数 ") Call 関数 の 値 Call グラフ 描画 End Sub Private Sub Command Bu t to n2 _ Click () Call グラフ 更新 1 End Sub Sub グラフ 更新 2 () Set MyWs = Worksheets (" 数学 関数 ") MyWs .S elect Set MyChart = MyWs . ChartObjects (" MatchGraph ") With MyWs n = . ComboBox 1 . ListIndex + 1 Select Case ( n ) Case 1 : Set MyRange = . Range (" A1 : A3 3 ") Case 2 : Set MyRange = . Range (" B 1 : B 33 ") Case 3 : Set MyRange = . Range (" C1 : C3 3 ") Case 4 : Set MyRange = . Range (" D1 : D3 3 ") Case 5 : Set MyRange = . Range (" E 1 : E3 3 ") End Select MyChart . Activate ActiveChart .S etSourceData Source := MyRange If . OptionButton 1 . Value = True Then ActiveChart . ChartType = xlLine Elself . OptionButton 2 . Value = TrueThen ActiveChart . ChartType = xlColumnClustered End If If . CheckBox 1 . Value = True Then ActiveChart . HasTitle = True Else ActiveChart . HasTitle = False End If If . CheckBox 2 . Value = True Then ActiveChart . HasLegend = True Else ActiveChart . HasLegend = False End If End With MyRange .S elect MsgBox " 描画 完了 " End Sub Sub Auto _ Open () Set MyWs = Worksheets (" 数学 関数 ") With MyWs . ComboBox 1 . Clear For Each r In Range (" A1 : E 1 ") . AddItem r . Value Next r . ListIndex = 3 End With MyWs . OptionButton 1 = True MyWs . CheckBox 1 = True MyWs . CheckBox 2 = True End Sub Private Sub Command Bu t to n3 _ Click () Call グラフ 更新 2 End Sub 
こちら で 回答 し た ん です けど ね 。 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1416050570 ... ちょっと 言葉 が 足り なかっ た か な 。 デザインビュー で イメージ コントロール の 「 コントロール ソース 」 に = "\\ 123 . 456 . 78 . 90 \ MainMenu \ QA 検査 結果 記録 システム \ QA 検査 画像 " & "\" & [ Forms ]![ 詳細 検索 フォーム ]![ 詳細 画像 ID 2 ] & ". JPG " と 記述 し て おく だけ です 。 VBA は 必要 あり ませ ん し 、 何 の エラー も 表示 さ れ ませ ん 。 表示 でき ない 画像 は 表示 さ れ ない 、 と いう だけ の こと です 。 
＞ たとえば 、 現状 の 1 行 目 開始 で は なく 7 行 目 から データ の cnt = cnt + 1 この 行 に 始め て き た 時 、 ｃｎｔ の 値 は ０ な ので 、 この 命令 が 実行 さ れる と ｃｎｔ は １ に なり ます 。 続け て Cells ( cnt , 1 ) = f . Name この 行 で は 、 ｃｎｔ が １ に なっ て いる ので 、 初めて この 行 が 実行 さ れる 時 に は Cells ( cnt , 1 ) は Cells ( 1 , 1 ) と なり ます 。 よって 、 cnt = cnt + 1 の 前 に 、 ｃｎｔ を ６ と し て おけ ば 、 最初 に 実行 さ れる 時 に は ｃｎｔ が ７ に なり 続け て Cells ( cnt , 1 ) = f . Name この 行 で は 、 ｃｎｔ が ７ に なっ て いる ので 、 初めて この 行 が 実行 さ れる 時 に は Cells ( cnt , 1 ) は Cells ( 7 , 1 ) と なり ます 。 よって With CreateObject (" Scripting . FileSystemObject ") の 前 に cnt = ６ の 命令 を 追記 すれ ば 、 最初 は ７ 行 目 から と なり ます 。 cnt = ６ ' 開始 行 － １ を 指定 する と 注釈 文 付き で 追加 すれ ば 、 「 ７ 行 目 から 」 と なり ます よ 。 
Form アプリケーション の コンテキストメニュー は 上下 に 表示 さ れる スクロールバー (?) しか 出せ なかっ た と 思い ます 。 WPF なら 横 に スクロールバー を 出す こと が でき ます し 、 様々 な コントロール を 作る こと が できる ので 便利 です 
二 次元 配列 で いい です が 、 可変 に する に は List の 入れ子 に し て おき ます 。 Public Class Form 1 Private Gname As List ( Of List ( Of String )) Private Sub Form 1 _ Load ( sender As Object , e As System . EventArgs ) Handles Me . Load // CSV から 読み込ん だ データ の 作成 Gname = New List ( Of List ( Of String )) Dim gList As List ( Of String ) = New List ( Of String ) gList . Add (" Group 1 ") gList . Add (" Name 1 - 1 ") gList . Add (" Name 1 - 2 ") G name. Add ( gList ) gList = New List ( Of String ) gList . Add (" Group 2 ") gList . Add (" Name 2 - 1 ") gList . Add (" Name 2 - 2 ") gList . Add (" Name 2 - 3 ") G name. Add ( gList ) gList = New List ( Of String ) gList . Add (" Group 3 ") gList . Add (" Name 3 - 1 ") gList . Add (" Name 3 - 2 ") G name. Add ( gList ) ComboBox 1 . Items . Clear () For i As Integer = 0 To G name. Count - 1 ComboBox 1 . Items . Add ( Gname ( i )( 0 )) Next ComboBox 1 .S electedIndex = 0 End Sub Private Sub ComboBox 1 _ SelectedIndexChanged ( sender As System . Object , e As System . EventArgs ) Handles ComboBox 1 .S electedIndexChanged Dim idx As Integer = ComboBox 1 .S electedIndex ComboBox 2 . Items . Clear () For i As Integer = 1 To Gname ( idx ). Count - 1 ComboBox 2 . Items . Add ( Gname ( idx )( i )) Next ComboBox 2 .S electedIndex = 0 End Sub 
はい 、 ヘッダー の 内容 は なん でも いい です 何 でも いい 、 という の は C++ の 文法 に 従っ て いる 必要 も ない という 意味 です ファイル 名 も なん でも いい です . h や . hpp で 無く て も 構い ませ ん # include ファイル パス と 書け ば どんな もの で も そこ に 展開 さ れ ます 展開 する 場所 も どこ でも 構い ませ ん 例えば // header . h std :: printf (" Hello world "); // main . cpp # include < cstdio > int main ( void ) { # include " header . h " } の よう に ヘッダー の 内容 を 関数 内 に 唐突 に 登場 さ せ たり する こと も 可能 です 
purpledreama さん 、 こんばんは 。 例えば 、 Set r = Selection を 、 Set r = Cells ( Rows . Count , " H "). End ( xlUp ). Offset (- 14 ). Resize ( 15 , 7 ) と すれ ば どうでしょう か ？ H 列 で 最下 行 セル を 探し 、 そこ から １ ５ 行 上 に 移動 し て から 、 セル 範囲 を １ ５ 行 ７ 列 に 拡張 する 、 という 処理 を し て い ます 。 
アクティブ シート 以外 の セル 範囲 を 指定 し たい の で あれ ば 、 Range や Cells の 前 に シート を 明記 し ましょ う 。 rowMax = Range ( col & Rows . Count ). End ( xlUp ). Row ↓ rowMax = ws . Range ( col & Rows . Count ). End ( xlUp ). Row With Range ( Cells ( 10 , col ), Cells ( rowMax , col )) ↓ With Range ( ws . ells ( 10 , col ), ws . Cells ( rowMax , col )) 
B 1 は 何 も 入っ て い なく て も 最終 行 に なる から 手間 が 必要 です ね ？ Sub test () If Worksheets (" sheet 2 "). Range (" B 1 ") = "" And Worksheets (" sheet 2 "). Cells ( Rows . Count , 2 ). End ( xlUp ). Row = 1 Then Worksheets (" sheet 1 "). Range (" B2 "). Copy Destination := Worksheets (" sheet 2 "). Range (" B 1 ") Else Worksheets (" sheet 1 "). Range (" B2 "). Copy Destination := Worksheets (" sheet 2 "). Cells ( Rows . Count , 2 ). End ( xlUp ). Offset ( 1 , 0 ) End If End Sub 
VBA 関連 書籍 の タイトル で 「 逆引き ～」 とか あり ます よ ね 。 正引き Find メソッド の 機能 や 使い方 を 調べる 名前 は わかっ て いる けど 、 詳しい 使い方 を 調べ たい なら 、 正引き つまり 「 VBA Find 」 で 検索 し ます 。 逆引き シート 内 で 文字列 検索 を する 方法 を 調べる シート 内 の 文字列 検索 し たい ん だ けど 、 何 か 方法 ある の か ？ と 思っ たら 逆引き 「 VBA シート 検索 」 で 調べ ます 。 逆引き に は もう ひとつ あり ます 。 エクセル の 手動 操作 は 知っ てる ん だ けど 、 名前 が 分から ない 場合 、 記録 マクロ で 調べ たり し ます 。 結局 、 自分 の 今 の 状態 、 どこ まで 知っ てる か で 正引き 逆引き が 決まり ます 。 
Dim x ( 100 ) As Double x ( 0 ) から x ( 100 ) の 101 個 x ( k + 2 ) = 1 . 999 * x ( k + 1 ) - 0 . 99905 * x ( k ) + 0 . 00098 ｋ は 、 0 から 100 まで k = 99 の とき 、 k + 2 = 101 k + 1 = 100 k = 99 k = 100 の とき 、 k + 2 = 102 k + 1 = 101 k = 100 100 まで 回し たい なら x ( 102 ) に すれ ば 回る 。 （ 異常 終了 は し ない ） 意味 的 に 正しい の か は 、 解ら ない 。 
消費税 を 計算 する タイミング が 示さ れ て い ない ので 、 TextBox 1 の 内容 が 変更 さ れる 都度 計算 し て い ます 。 Private Sub TextBox 1 _ Change () ' イベント の 発生 を 抑止 する Application . EnableEvents = False ' TextBox 1 を カンマ 付き に 直す TextBox 1 . Text = Format ( CCur ( TextBox 1 . Text ), "#,## 0 ") ' 消費税 を 計算 する TextBox 2 . Text = Int ( CCur ( TextBox 1 . Text ) * 0 . 08 ) ' TextBox 2 を カンマ 付き に 直す TextBox 2 . Text = Format ( CCur ( TextBox 2 . Text ), "#,## 0 ") ' イベント の 発生 を 再開 する Application . EnableEvents = True End Sub 
VLOOKUP ( C1 3 ,[★★ 一覧 ★★. xlsm ] 現場 一覧 !$ B $5 :$ C $70 , 2 , FALSE ) を IF ( ISBLANK ( C1 3 )= TRUE , "", VLOOKUP ( C1 3 ,[★★ 一覧 ★★. xlsm ] 現場 一覧 !$ B $5 :$ C $70 , 2 , FALSE )) として み てくだ さ 。 ISBLANK ( セル )＝ TRUE / FALSE セル が 空欄 の 場合 は TRUE 、 未 入力 の 場合 は FALSE と なり ます 。 
共通 する 部分 は 、 前 に 出して With 文 と 、 Select Case 文 を 使っ たら どうでしょう か ？ Range (" A1 : I 100 "). Select Selection . Copy With Workbooks (" 一覧 "). Worksheets (" 現金 ") Select Case ComboBox 1 Case " 4月 " . Range (" AA 16 "). PasteSpecial Case " 5月 " . Range (" BA 16 "). PasteSpecial Case " 6月 " . Range (" CL 16 "). PasteSpecial Case " 7月 " . Range (" DD 16 "). PasteSpecial ・ ・ ・ ・ End Select End With end sub 
こんにちは。 ① 1月 ～ 12月 以外 の シート が 存在 し て も 処理 対象外 と し て い ます 。 ② ないと は 思い ます が 、 空白 行 が あっ て も 処理 さ れる よう に し まし た 。 処理 起動 用 の シート を 設け て 、 挿入 タブ → 図形 → 好み の 図形 を 選択し 貼り 付け 。 図形 を 左 クリック → マクロ の 登録 → Sample 1 を 選択 これ が 簡単 でしょ う 。 Option Explicit Sub Sample 1 () Dim Tgs As Variant , Ws As Worksheet , I As Long Tgs = Array (" 1月 ", " 2月 ", " 3月 ", " 4月 ", " 5月 ", " 6月 ", _ " 7月 ", " 8月 ", " 9月 ", " 10月 ", " 11月 ", " 12月 ") For Each Ws In Worksheets For I = 0 To UBound ( Tgs ) If Ws . Name = Tgs ( I ) Then With Sheets ( Ws . Name ) . Range (. Range (" A1 "), . Cells (. Rows . Count , 4 ). End ( xlUp ) _ . Offset ( 0 , 1 )). Sort _ key 1 :=. Range (" D1 "), order 1 := xlAscending , Header := xlYes End With End If Next I Next Ws Set Ws = Nothing End Sub 
こんにちは。 Sub Sample 1 () Dim Dt 1 As Variant , Dt 2 As Variant , Dt 3 () As String Dim i As Long , J As Long , k As Long Range (" C : C "). ClearContents Dt 1 = Range ( Range (" A 2 "), Cells ( Rows . Count , 1 ). End ( xlUp )) Dt 2 = Range ( Range (" B2 "), Cells ( Rows . Count , 2 ). End ( xlUp )) ReDim Dt 3 ( 0 ) For i = 1 To UBound ( Dt 2 ) ReDim Preserve Dt 3 ( k ) For J = 1 To UBound ( Dt 1 ) If Dt 2 ( i , 1 ) Like "*" & Dt 1 ( J , 1 ) & "*" Then Dt 3 ( k ) = Dt 1 ( J , 1 ) End If Next J k = k + 1 Next i Range ( Range (" C 2 "), Cells ( UBound ( Dt 3 ) + 1 , 3 )). Value = _ WorksheetFunction . Transpose ( Dt 3 ) End Sub 
テキストボックス は ActiveX コントロール の テキストボックス です よ ね 。 とりあえず 、 ２ こ 張り付け て 、 上記 コード 書い たら ちゃんと 移動 し まし た 。 If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then TextBox 2 . Activate End If End Sub です けど 、 If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then TextBox 2 . Activate End If End Sub の よう に 、 改行 さ れ て い ます か ？ あと 、 デザイン モード に し て 、 テキストボックス を 右クリック -> プロパティ で コントロール の プロパティ を 表示 し て 、 （ オブジェクト 名 ） が 間違っ て ない か 確認 し て み て ください 。 
条件 を 変数 に する とき は Boolean 型 で 定義 し 、 「""」 では なく 「 () 」 で 値 を 格納 し ます 。 （ 例 ） Dim 条件 １ as Boolean if ～ then 条件 １ =( A = 0 ) else 条件 １ =( B = 0 ) end if また 、 ループ を 抜ける 条件 は 必ずしも Do や Loop の 後ろ に 書く 必要 は なく 、 「 Exit Do 」 を 使え ば いつ でも ループ を 抜け出す こと が でき ます 。 （ 例 ） Do （ 処理 ） If ～ Then Exit Do （ 処理 ） Loop 
Windows API を 使っ て 印刷 を 行う 方法 です 。 変数 strPath に は PDFファイル の パス を 。 変数 strName に は ファイル 名 を （ 拡張子 含み ） 。 ' Windows API の 宣言 Declare Function ShellExecute Lib " SHELL 32 " Alias " ShellExecuteA " _ ( ByVal hwnd As Long , ByVal lpOperation As String , ByVal lpFile As String , _ ByVal lpParameters As String , ByVal lpDirectory As String , ByVal nShowCmd As Long ) As Long ' PDFファイル の 印刷 Sub PDFPrint () Dim strPath As String Dim strName As String strPath = " C :\ Users \ kojin \ Desktop \ 製造工程 \ 図面 \" strName = " 123 . pdf " Call ShellExecute ( Application . hwnd , " print ", strPath & strName , vbNullString , "", 0 ) End Sub こんな 感じ で どうでしょう 。 
変数 ｒ が 他 の マクロ で Range で 定義 さ れ て いる という 事 で は ない でしょ う か 。 
とりあえず 、 こんな 感じ 。 ' B 列 の 最終 行 数 取得 （ B2 から 始まっ て いる として ） max _ row = Range (" B2 "). End ( xlDown ). Row ' 行 数 ループ （ i = 2 の ２ が 開始 の 行番号 ） For i = 2 To max _ row ' 全角 → 半角 変換 （ StrConv ( 対象 の 文字 , 変換 パタン ） ' Cells ( i , 2 ) の i が 行番号 、 2 が 列 番号 （ A 列 から 1 , 2 , 3 ...） Cells ( i , 2 ). Value = StrConv ( Cells ( i , 2 ). Value , vbNarrow ) Next StrConv の 引数 （ 変換 パタン ） は こちら を 参照 。 http:// office tanaka .net / excel / vba / function / StrConv . htm 
ActiveChart .S etSourceData Source := Range ("' 2016 '!$ B $1 :$ N $4 ") ここ で 引っかかる の だ と 思い ます 。 グラフ 範囲 に A 列 が 入っ て も 構わ ない ので （ 凡例 を 後で 削除 する と 同じ ） ActiveChart .S etSourceData Source := Range (" A1 "). Current Region と すれ ば A1 : N4 の 可視 セル だけ が グラフ 範囲 に なり ます 。 B 列 から 可視 セル だけ を 選択 する と 面倒 な こと に なり ます 。 以下 の よう に し て み て は どうでしょう 。 Sub グラフ の 作成 01 () Dim r As Range Set r = Inter sect ( Range (" A1 "). Current Region .S pecialCells ( xlCellTypeVisible ), Columns (" B : N ")) Range (" B 1 : N4 "). Select ActiveSheet .S hapes . AddChart .S elect ActiveChart . ChartType = xlColumnClustered ActiveChart .S etSourceData Source := r ActiveChart . Axes ( xlValue ). Select ActiveChart . Axes ( xlValue ). ScaleType = xlLogarithmic ActiveChart . Axes ( xlCategory ). Select ActiveChart .S eriesCollection ( 3 ). Select ActiveChart .S eriesCollection ( 3 ). ChartType = xlLineMarkers ActiveChart . Axes ( xlCategory ). Select ActiveChart .S eriesCollection ( 3 ). Select ActiveChart . Axes ( xlCategory ). Select ActiveChart . Axes ( xlCategory ). Select ActiveChart . Axes ( xlCategory ). Select ActiveChart .S eriesCollection ( 3 ). Select ActiveChart .S eriesCollection ( 3 ). AxisGroup = 2 ActiveChart . Axes ( xlValue ). Select ActiveChart . Axes ( xlValue ). ScaleType = xl Linear ' グラフ の 移動 Dim GName As String GName = Mid ( ActiveChart . Name , Len ( ActiveSheet . Name ) + 2 ) With ActiveSheet .S hapes ( GName ) . Left = 100 . Top = 150 . Width = 1000 End With End Sub 
以下 で どう なり ます か 項目 行 は １ 行 目 に ある 前提 で ････ 新規 ファイル に 以下 を 転記 し て 、 testData にて 確認 用 データ を 作成 し 、 Samp 1 を 実行 し て み ます 良 さ そう なら ･･･ Public Sub Samp 1 ()     Dim vA As Variant , vB As Variant     Dim i As Long , j As Long     Const CCHK As String = " elem _ value "     Const CREP As String = "/ var / jbos "     Const CNON As String = "< N/A >"     Const CAPP As String = "< apply >"     Application .S creenUpdating = False     With ActiveSheet . UsedRange        . Replace CNON , ""        For j = 1 To . Columns . Count           If (. Cells ( j ). Value = CCHK ) Then Exit For        Next        If ( j > . Columns . Count ) Then Exit Sub        With . Columns ( j )           On Error Resume Next           .S pecialCells ( xlCellTypeBlanks ). EntireRow . Delete           On Error GoTo 0           vA = . Value        End With        For j = j + 3 To . Columns . Count           If (. Cells ( j ). Value = CREP ) Then              With . Columns ( j )                 vB = . Value                 For i = 2 To UBound ( vB )                    If ( vB ( i , 1 ) = CAPP ) Then                       vB ( i , 1 ) = vA ( i , 1 )                    End If                 Next                 . Value = vB              End With           End If        Next     End With     Application .S creenUpdating = True End Sub ' 確認 用 データ 作成 Public Sub testData ()     Dim r As Range     Const CRH As Long = 35     Const CCHK As String = " elem _ value "     Const CREP As String = "/ var / jbos "     Const CNON As String = "< N/A >"     Const CAPP As String = "< apply >"     Randomize     Application .S creenUpdating = False     Cells . Delete     For Each r In Range (" A1 : N 1 "). Resize ( CRH )        Select Case r . Row           Case 1              Select Case r . Column                 Case Range (" C1 "). Column                    r . Value = CCHK                 Case Is >= Range (" C1 "). Offset (, 3 ). Column                    r . Value = CREP                 Case Else                    r . Value = r . Address ( False , False )              End Select           Case 2 , 3           Case Else              Select Case r . Column                 Case Range (" C1 "). Column                    If ( Rnd () > 0 . 75 ) Then                       r . Value = CNON                    Else                       r . Value = r . Address ( False , False )                    End If                 Case Is >= Range (" C1 "). Offset (, 3 ). Column                    If ( Rnd () > 0 . 75 ) Then                       r . Value = CNON                    Else                       r . Value = CAPP                    End If                 Case Else                    r . Value = r . Address ( False , False )              End Select        End Select     Next     Columns . AutoFit     Application .S creenUpdating = True End Sub 
説明 が 足ら ない の と 違い ます か ね ？ やたら と コピー 元 の 説明 は 詳しい のに 、 コピー 先 の 説明 は 皆無 に 等しい 。 コピー 先 は 適当 に 考え て くれ って こと です か ね ？ 乱暴 すぎ ない です か ね ？ > 月 ごと に 変わり いったい ここ で いう 「 月 」 と は 、 どこ に ある 「 月 」 な の でしょ う か ？ セル 内 ？ 実行 時 の 日付 の 月 ？ （ ↓ の プログラム は 、 実行 時 の PC 日付 の 月 に なっ て ます ） > この 指定 範囲 は エクセル の 関数 で 出し て いる ので > マクロ で なく て ok です 。 意味不明 。 > セル に 書か れ た 文字 を 使っ て の ループ 処理 前 の 説明 に 「 セル に 書か れ た 文字 」 に関する 事情 は 説明 さ れ て ます か ？ さ れ て ない よう な ので 、 意味不明 。 適当 に コーディング する と 、 ↓ が 一 例 （ 未 実行 につき 不具合 ご 容赦 ） Sub テスト () Dim xRows As Long , xStep As Long Dim i As Long , ii As Long Set sh = Worksheets (" 集計 ") ii = 4 xRows = Day ( DateSerial ( Year ( Date ), Month ( Date ) + 1 , 0 )) xStep = xRows + 5 With Worksheets (" 元 データ ") For i = 6 To . Cells ( Rows . Count , " R "). End ( xlUp ) Step xStep . Cells ( i , " R "). Resize ( xRows , 4 ). Copy sh . Cells ( ii , " F "). PasteSpecial Paste := xlPasteValues ii = ii + xRows Next i End With End Sub > うまく 調べ られ ませ ん でし た 。 調べる 能力 ・ 手段 を お 持ち なら 、 ↑ の プログラム に 手 を 入れる の は 、 ご 自身 で でき ます よ ね ？ 
「 :=」 という の は 、 名前 付き 引数 に 使う 記号 です 。 例えば Find メソッド で は 、 検索 文字列 に 「 what :=」 という 名前 付き 引数 を 使い ます 。 Set fnd = Columns ( 1 ). Find ( what :=" sample ") 他 で は 使わ ない はず です 。 オプション という の が 何 を 示し て いる の か は 分かり ませ ん が 、 省略 可能 な 引数 の こと でしょ う か 。 
Copy メソッド を 例 に ・ ・ 。 Copy メソッド で は 、 オブジェクト が セル の 場合 と シート の 場合 の 引数 の オプション が 異なり ます 。 セル の コピー で あれ ば 、 Range (" A1 "). Copy Range (" B 1 ") の よう に 、 引数 は 貼り 付け 先 （ Destination ） です 。 この 場合 、 貼り 付け 先 と なる 引数 が なけれ ば いけ ませ ん 。 もちろん 、 形式 を 指定 し て 貼り 付け で も 同じ です 。 シート の コピー で あれ ば 、 Worksheets (" Sheet 1 "). Copy After := Worksheets (" Sheet 3 ") の よう に 、 コピー する シート の 場所 を 指定 し ます 。 この 場合 、 引数 は ２つ あり Before と After です 。 但し 、 どちら か １つ しか 指定 でき ませ ん 。 また 、 引数 を 省略 し た 時 は 、 現在 選択 さ れ て いる シート の 左側 （ Before ） に コピー さ れ ます 。 引数 に は 省略 不可 の もの と 、 省略 可 の もの が ある ので 、 それぞれ の メソッド で どの 引数 が 必須 な の か 、 または 任意 な の か を 知っ て いる 必要 が あり ます 。 使っ て いけ ば 、 何となく 分かっ て くる はず です 。 
こんな 感じ で どうでしょう ？ 一行 目 が 項目 行 、 二 行 目 以降 に データ が ある 場合 の コード です 。 数量 ・ 単価 ・ 金額 の 列 を 自動 で 探し ます 。 一行 目 に これら の 文字 が ない と 自動 で は 探せ ませ ん 。 その 場合 は 、 SURYO , TANKA , KINGAKU の 値 を 変え て ください 。 例えば 数量 が A 列 、 単価 B 列 、 金額 C 列 なら SURYO = 1 TANKA = 2 KINGAKU = 3 といった 感じ です 。 SURYO = WorksheetFunction . Match (" 数量 ", Rows ( 1 ), 0 ) TANKA = WorksheetFunction . Match (" 単価 ", Rows ( 1 ), 0 ) KINGAKU = WorksheetFunction . Match (" 金額 ", Rows ( 1 ), 0 ) この 三 行 は 消し て ください 。 - - - - - - - - - - - ------------------------- Sub 数量 が 抜け て いる 行 の フォント カラー を 白 に () Dim SURYO , TANKA , KINGAKU , LR , T SURYO = WorksheetFunction . Match (" 数量 ", Rows ( 1 ), 0 ) TANKA = WorksheetFunction . Match (" 単価 ", Rows ( 1 ), 0 ) KINGAKU = WorksheetFunction . Match (" 金額 ", Rows ( 1 ), 0 ) LR = Cells ( Rows . Count , KINGAKU ). End ( xlUp ). Row For T = 2 To LR If Cells ( T , SURYO ) = "" Then Union ( Cells ( T , SURYO ), Cells ( T , TANKA ), Cells ( T , KINGAKU )). Font . Color = vbWhite End If Next End Sub 
If ( Cells ( i , 1 ). Value <> " A ") And ( Cells ( i , 1 ). Value Like "* B *") Then Cells ( i , 1 ). Value =" C " この よう に 記述 すれ ば 良い の で は ない でしょ う か 。 
サンプル です 。 データ が ある シート 名 を 「 データ 」 と し て い ます 。 シート 「 データ 」 の 一行 目 に [ 親 id ][ 子 id ][ 支払い ] という 項目 が あり 、 2 行 目 から データ が 始まっ て いる と し ます 。 結果 を 抽出 する シート を 、 ワークブック の 右端 に 追加 し ます 。 [ 親 id ][ 子 id ][ 支払い ] の 列 と 、 データ の 最終 行 を 取得 し て 、 追加 し た シート に ワーク シート 関数 を 入れ ます 。 [ 親 id ] 1 列 目 [ 子 id ] 6 列 目 [ 支払い ] 4 列 目 この 場合 、 下記 の 数式 が 入り ます 。 支払い が ない 行 は 、 空白 が 返り ます 。 空白 が 返り ます が 、 数式 は 入っ て い ます 。 = IF ( データ !$ D2 <>"", データ !$ A 2 ,"") = IF ( データ !$ D2 <>"", データ !$ F2 ,"") = IF ( データ !$ D2 <>"", データ !$ D2 ,"") その後 、 数式 の 結果 を 【 値 】 に 変換 し ます 。 変換 後 に 、 空白 行 を 削除 し ます 。 ----------------------- Sub macro () Dim sh _ data As Worksheet Dim oya , ko , siharai , lr , v Set sh _ data = Sheets (" データ ") Sheets . Add after := Sheets ( Sheets . Count ) oya = sh _ data . Rows (" 1 : 1 "). Find (" 親 id "). Column ko = sh _ data . Rows (" 1 : 1 "). Find (" 子 id "). Column siharai = sh _ data . Rows (" 1 : 1 "). Find (" 支払い "). Column lr = sh _ data . Cells ( Rows . Count , oya ). End ( xlUp ). Row Cells ( 1 ) = " 親 id " Cells ( 1 , 2 ) = " 子 id " Cells ( 1 , 3 ) = " 支払い " Range ( Cells ( 2 , 1 ), Cells ( lr , 1 )). FormulaR 1 C1 = _ "= if ( データ ! rc " & siharai & "<>"""", データ ! rc " & oya & ","""")" Range ( Cells ( 2 , 2 ), Cells ( lr , 2 )). FormulaR 1 C1 = _ "= if ( データ ! rc " & siharai & "<>"""", データ ! rc " & ko & ","""")" Range ( Cells ( 2 , 3 ), Cells ( lr , 3 )). FormulaR 1 C1 = _ "= if ( データ ! rc " & siharai & "<>"""", データ ! rc " & siharai & ","""")" With Range ( Cells ( 1 , 1 ), Cells ( lr , 3 )) v = . Value . Value = v .S pecialCells ( xlCellTypeBlanks ). EntireRow . Delete End With End Sub 
Sub SheetCopy () With T hisWorkbook . Worksheets (" S "). Visible = True . Worksheets (" S "). Copy .S heets (" S "). Visible = False End With ActiveSheet . Name = " 抽出 結果 " MsgBox " 抽出 完了 ", vbInformation End Sub 
If .S how = True Then cFld = .S electedItems ( 1 ) & "\" Else Exit Sub End If Exit Sub → End 
ID 非公開 さん で は 前 の 質問 から 内容 を 推測 する こと も でき ない 。 せめて 前 の 質問 の URL くらい は 添付 し たら ？ 
先週 から 気 に は なっ て い た の です が 、 VBA も 波動方程式 も 門外漢 な ので 尻込み し て い まし た 。 しかし 、 その後 どなた も 回答 さ れ ない よう です ので 、 口火 を 切り ます 。 最初 に 気 に なっ た の は 、 u の 定義 が どう なっ て いる か 、 です 。 あと 、 newu も 配列 な の でしょ う か ？ それとも 、 new u でしょ う か ？ それから 、 以下 の よう な 連続 代入 も 、 コード の 見通し を 悪く し て いる と 感じ ます 。 u ( 1 , j , 0 ) = u ( 1 , j , LX - 1 ) = u ( 1 , 0 , j ) = u ( 1 , LX - 1 , j ) = 0 newu ( i , j - 1 , 0 ) = newu ( i , j - 1 , LX - 1 ) = newu ( i , 0 , j - 1 ) = newu ( i , LX - 1 , j - 1 ) = 0 それぞれ 、 4 行使 って = 0 を 明示 し て いただい た 方 が と 思い ます 。 u ( 1 , j , 0 ) = 0 u ( 1 , j , LX - 1 ) = 0 u ( 1 , 0 , j ) = 0 u ( 1 , LX - 1 , j ) = 0 newu ( i , j - 1 , 0 ) = 0 newu ( i , j - 1 , LX - 1 ) = 0 newu ( i , 0 , j - 1 ) = 0 newu ( i , LX - 1 , j - 1 ) = 0 基本的 に エラーメッセージ は 出 ない わけ です よ ね ？ と すれ ば 、 あと は 、 デバッグ コマンド を 仕込ん で トレース し て 問題点 を あぶり 出す しか ない よう に 思い ます 。 あまり お 役 に 立て ず スミマセン 。 何 か の ヒント に なれ ば と 思う の です が 。 
Private Sub Worksheet _ Change ( ByVal Target As Range ) With Worksheets ( 1 ) Application . Goto . Range (. Cells ( 288 , 11 ), . Cells ( 311 , 11 )) End With End Sub 
こんにちは。 デバッグ の イミディェットウィンド で 、 手 で 直接 、 objIE . Document . getElementById (" MonthSelect "). SelectedIndex = 0 など 、 直接 操作 し て 、 実際 に でる 様子 を 確認 手 で うまく いっ たら 、 cells ( 3 , 10 ) が 怪しい です 。 あと 、 「 変化 が ない 」 のに 、 ダメ に なる と し たら 、 ブラウザー そのもの の セキュリティ 関係 で 出来 て い た こと が 突然 だめ に なる 、 という 可能性 は あり ます 。 あと 、 まさかの OS アップデート 。 最近 は 巷 も にぎやか です 。 とにかく 原因 が どこ か に ある ので 、 主 様 、 地道 に 頑張っ て ください 
そういう こと は 、 ご 教授 と は 言わ ず に 、 「 ご 教示 」 と 言い ます 。 日本語 は きちんと 使い ましょ う 。 
こんにちは。 主 様 、 開き たい ファイル は 、 thisworkbook . path に ある 、 という こと は 、 「 特定 の 日付 」 とか 、 「 特定 の 文字 を 含ん だ ファイル 」 とか 、 特徴 が あり ませ ん か あと 、 開か なく て いい ブック も 一緒 に ある 、 という こと な ん でしょ う か という こと で 、 開か なく て いい ブック の 特徴 が ある か 、 など で 、 ファイル の for each の ファイル 名 に対して 処理 し て ください 。 set fso = create object (" scriptint . filesystemobject ") set f1 = fso . get folder ( thisworkbppk . path ) for each f2 in f1 . files if f2 . name = thsiwrokbook . name then else ここ で 、 日付 でし たら 、 lastdate など 、 プロパティ を 確認 コピー 、 開く 、 など 、 現在 の コード を 設定 end if next という よう に なり ます 。 これ だ と 、 選択 の 処理 は 自動 処理 に なり ます あ 、 ファイル を 扱う マニュアル を よく 見 て 、 コード に し て ください 。 べたべた に 手打ち し て ます 。 ニュアンス だけ 参考 に 
( vba shape ) セレクト オール を し た 後 で は なく 、 その 前 に シェイプ が ある か 確認 し て は どう です か 。 If ActiveSheet .S hapes . Count > 0 Then ActiveSheet .S hapes .S electAll Selection . Placement = xlFreeFloating 
はい 、 これ は 、 原理 的 に 無理 です 。 なぜなら 、 IME の 変換 イベント で 制御 し て いる から です 。 全角 スペース は 、 例外 で 変換 プロセス を 筒抜け で 、 すーすー と 入力 さ れる ので 、 捕まり ませ ん 。 仕方 ない ので 、 逃げ 手 を 捜し ます 。 今 、 やっ て みる と 、 KeyPress イベント で 捕まる こと が 、 分かり まし た 。 しかし 、 何故か 、 そのまま だ と 、 KeyPress イベント が ２ 回 来 ます 。 e . Handled = true ; に し て みる と 、 全角 スペース も 入り ませ ん 。 そこで 、 考え た の が 、 これ ！ 試し て み て ください 。 private void TextBox 1 _ KeyPress ( object sender , KeyPressEventArgs e ) { if ( e . KeyChar == ' ') { TextBox 1 . Text += " "; TextBox 1 .S electionStart = TextBox 1 . Text . Length ; TextBox 2 . Text += " "; e . Handled = true ; } } TextBox 1 .S electionStart を 文字列 の おしり に し ない と 、 何故か 、 カーソル が 先頭 に なっ て しまい ます 。 
マスター に 入力 し て い ない の で は 。 
こんな 感じ に なり ます 。 Sub シート コピー () Dim Sh , i , t t = Sheets (" 特定 シート "). Index + 1 ReDim Sh ( t To Sheets . Count ) For i = t To Sheets . Count Sh ( i ) = Sheets ( i ). Name Next i Sheets ( Sh ). Copy after := Workbooks (" B シート . xls "). Sheets ( 1 ) End Sub 
カウントダウン さ せる に は 最初 に タイマー を 停止 する 時刻 を 計算 し て おく の が 定石 です 。 Public Class Form 1 Private StopTime As DateTime Private CountDownTime As TimeSpan Public Sub New () InitializeComponent () ' タイマー を ストップ さ せる まで の 時間 を 保存 し て おく CountDownTime = New TimeSpan ( 0 , 1 , 30 ) ' タイマー を ストップ さ せる 時刻 を 保存 し て おく StopTime = Da te Time. Now + CountDownTime ' Time r1 を 有効 に する Time r1 . Enabled = True End Sub Private Sub Time r1 _ Tick ( sender As System . Object , e As System . EventArgs ) Handles Time r1 . Tick ' 残り 時間 を 更新 する CountDownTime = StopTime - Da te Time. Now ' 残り 時間 が 0 以下 に なっ たら タイマー を 停止 する If CountDownTime . Ticks < 0 Then CountDownTime = New TimeSpan ( 0 ) Time r1 . Enabled = False End If ' Label 1 に 残り 時間 を 表示 する Label 1 . Text = CountDownTime . ToString (" hh \: mm \: ss ") End Sub End Class 
「 TeraTerm 」 が 便利 です 。 https :// osdn .jp / projects / ttssh2 / TeraTerm は 本来 は サーバー に Telnet 接続 する ため の フリーソフト です が 、 ルーター の 中 に は シリアル 接続 し て 設定 を 行う もの も ある ため 、 シリアル通信 に も 対応 し て い ます 。 TeraTerm で シリアル通信 を 行う 方法 http:// www . j - oosk . com / teraterm / serial / 346 / 
( vba ) Remove の 引数 は 指定 し て ます か ？ UserForm 1 . Controls . Remove " Label " 
確認 です が ， ， ， 「 ｖｂｓ 」 という の は 拡張子 「 . vbs 」 の 「 VBS 」 ファイル の こと です よ ね ？ そして そこ で 使わ れる VBScript の ご 質問 です よ ね ？ そもそも から し て 書か れ て いらっしゃる 「 ｖｂｓ 」 は " 全て 全角 " に なっ て い て 例えば 「 . ｖｂｓ 」 など という 拡張子 を 付け て も 無事 に 動作 し ない と 思い ます が 。 。 。 ( プログラム は 厳格 です 。 キッチリ 書く よう に し ましょ う 。 ) > プログラム で 、 同じ ウィンドウ （ タブ ？ ） を 一 度 に > たくさん 表示 し たい の です が どう すれ ば いい の でしょ う か ？ 「 複数 の ウインドウ ( IE の ウィンドウ ) を 開く 」 の と 「 1つ の ウィンドウ ( IE の ウィンドウ ) に 複数 タブ を 開く 」 の と では スクリプト が 異なり ます 。 ここら 辺 も キッチリ ( ハッキリ ) さ せ ましょ う 。 この 知恵袋 は http から 始まる URL を 書く と 勝手 に リンク が 付い て しまう 上 に ， その 自動リンク の 数 制限 で ３つ の URL まで しか 書け ませ ん 。 ( 自動リンク 機能 など 要ら ない のに ... ブツブツ 。 。 。 ) したがって まずは 回答 欄 に 「 複数 の IE ウィンドウ を 開く 」 スクリプト 例 を 書い て 返信 欄 に 「 1つ の IE ウィンドウ に 複数 タブ を 開く 」 スクリプト 例 を 書く こと に し ます 。 ◎ 「 複数 の IE ウィンドウ を 開く 」 スクリプト 例 ↓ ' IE オブジェクト 達 を 作成 Set ObjIE 0 = CreateObject (" InternetExplorer . Application ") Set ObjIE 1 = CreateObject (" InternetExplorer . Application ") Set ObjIE 2 = CreateObject (" InternetExplorer . Application ") ' IE 画面 達 を 表示 ObjIE 0 . Visible = True ObjIE 1 . Visible = True ObjIE 2 . Visible = True '「 Yahoo! 」 を 表示 ObjIE 0 . Navigate 2 " http:// www . yahoo . co.jp /" '「 Google 」 を 表示 ObjIE 1 . Navigate 2 " https :// www . google . co.jp /" '「 goo 」 を 表示 ObjIE 2 . Navigate 2 " http:// www . goo . ne.jp /" Set ObjIE 0 = Nothing Set ObjIE 1 = Nothing Set ObjIE 2 = Nothing 
引数 名 の ない 引数 という の は あり ませ ん 。 それ を 使う か 使わ ない か だけ の 違い です 。 Worksheets . Add の 引数 の 並び は 、 Before , After , Count , Type と なっ て い ます 。 引数 名 Count を 省略 し た 場合 は 、 ３ 番目 だけ を 指定 する という 意味 で Worksheets . Add ,, 2 （ ← Before と After は 省略 する という 意 ） と 記述 し ます 。 ところが 、 これ で は ２ という 値 が 何 の 引数 な の か 、 パッと 見 て 分かり難い ので Worksheets . Add Count := 2 という 書き方 を する の が 一般的 です 。 また 引数 名 を 指定 する と 、 省略 する とき の よう に , ( カンマ ) で 区切る 必要 も ない ので 見やすく なり ます 。 もっとも MsgBox のようなもの は 、 いちいち 引数 名 を 指定 する と 長く なる ので 、 省略 する こと も あり ます 。 引数 名 を 使う か 使わ ない か は 、 見易 さ と 使い やす さ で 判断 し て も いい と 思い ます 。 
変数 も 可能 な よう です よ 。 c = 3 Worksheets . Add Count := c これ で 、 きちんと 3 シート 追加 さ れ まし た 。 
Worksheets . Add Count は Add メソッド の 第 一 引数 Before に Count という 変数 を 値 として 設定 し て いる から VBE の オプション で 、 「 変数 の 宣言 を 強制 する 」 に チェック を 付ける か モジュール の 宣言 部 （ 先頭 ） に Option Explicit を 追加 し て みる と ・ ・ ・ 
> For i = MaxRow _ Z To 3 Step - 12 これ は For i = MaxRow _ Z To 3 Step - 2 です よ ね MaxRow _ Z が 偶数 なら MaxRow _ Z - 1 から For ･･･ MaxRow _ Z が 奇数 なら MaxRow _ Z - 0 から For ･･･ ここ で の - 1 , - 0 を True / False を 使っ て ･･･ VBA で は 、 True / False → - 1 / 0 な ので 、 偶数 か ･･･？ と 聞い て True な ので - 1 する こと に なり 奇数 に ･･･ True / False の - 1 / 0 を そのまま 演算 に 使う こと は あり ます ね 気持ち が 悪い の で あれ ば 以下 の 様 な 書き方 で も If (( MaxRow _ Z Mod 2 ) = 0 ) Then MaxRow _ Z = MaxRow _ Z - 1 
オプション も 引数 も 同じ 意味 じゃ ない の か なぁ Count := 2 の 場合 Count が 引数 名 で 2 は 値 := は引 数 に 値 を 渡す 記号 だ と 思う が 
ブレークポイント を 配置 し て 診断 ツール で ミリ 秒 単位 の 経過 時間 を 見る こと は でき ます 
ツールボックス ダイアログ ↓ マルチページボタン 右クリック ↓ その他 の コントロール を 左 クリック ↓ コントロール の 追加 ダイアログ 表示 さ れる 
train _ benoist さん で は ありません が 、 Imports System Imports System . Drawing Imports System . Windows . Forms Public Class Form 1 Public Sub New () InitializeComponent () Setting () End Sub Private Sub Setting () Label 1 . Font = New Font ( Label 1 . Font . FontFamily , 22 , Label 1 . Font . Style ) ' ラベル の フォント サイズ を 変更 ' タイマー を スタート Time r1 .S tart () End Sub Private Sub Time r1 _ Tick ( sender As System . Object , e As System . EventArgs ) Handles Time r1 . Tick ' 現在 時 を 取得 Dim datetime _ now As DateTime = Da te Time. Now Dim datetime _ set As DateTime = New DateTime ( datetime _ now . Year , datetime _ now . Month , datetime _ now . Day , 23 , 59 , 0 ) ' 残り 時間 を 表示 Label 1 . Text = " 残り ：" & ((( datetime _ set . Hour - datetime _ now . Hour ) * 3600 ) + (( datetime _ set . Minute - datetime _ now . Minute ) * 60 ) + ( datetime _ set .S econd - datetime _ now .S econd )) & " 秒 " If datetime _ now . ToLongTimeString () = datetime _ set . ToLongTimeString () Then Label 1 . Text = " 時間 です 。 " ' タイマー 停止 Time r1 .S top () End If End Sub End Class 
等価 (=) は もちろん です が 、 全く 同じ 場合 という 意味 です 。 販売 と 販売 日 は 文字列 として 見る と 全く 同じ では あり ませ ん よ ね ？ です から If 文 は False と 評価 さ れる ので 中の 処理 は 実行 さ れ ませ ん 。 な ので 、 If TextBox 1 . Value = Cells ( i , 2 ) Then の 部分 を If InStr ( Cells ( i , 2 ). Value , TextBox 1 . Value ) > 0 Then と し ます 。 InStr 関数 は 対照 文字列 内 に 検索 文字列 が 存在 する 場合 は 検索 文字列 の 先頭 の 文字 が 対照 文字列 内 の 何 番目 か を 返し 、 見つから ない 場合 は 0 を 返し ます 。 なので > 0 と する 事 で 含ま れ て いる 事 を 確認 する 事 が 出来 ます 。 
最初 に どんな 名前 の シート が あっ て 、 最終 的 に どんな 並び に し たい の でしょ う か ？ 
下記 の サイト を 参考 に し て ください 。 http:// www . moug .net / tech / exvba / 0020008 . html 
変数 の 記載 場所 と その 適用範囲 は 覚え て おき ましょ う ね 。 参考 http:// office tanaka .net / excel / vba / variable / 05 . htm 回答 は 前 の 方 が さ れ て いる ので 控え て おき ます 。 
Visual Basic に TruckView なる コントロール は な さ そう だ し 、 ライブラリ で も 無 さ そう だ し 、 何 の 事 な ん です か ねぇ 。 もう少し 詳しく 書い て いただける と 、 回答 が 付く かも しれ ませ ん ね 。 
「 asp net mvc ボタン クリック 」 で 検索 し て み て は いかが でしょ う か ？ 
たぶん 、 ここ でしょ う 。 > Dim fso As New FileSystemObject Microsoft Scripting Runtime へ の 参照 設定 が 必要 です 。 
vba は あまり オブジェクト指向 に とらわれる と やり にくい かも です 。 どの アプリ の VBA を 勉強 し たい の か は わかり ませ ん が 、 エクセル なら モーグ さん 、 オフィス 田中さん あたり が メジャー だ と 思い ます 。 基本的 に は VB 6 . 0 な んで 全体 的 に と いう なら そっち を 勉強 し た ほう が いい の か な ？ 
Visual Studio の バージョンアップ に 合わせ て 多少なりとも ランニングコスト かかる 気 が し ます が 。 Java から 移行 と なる と 、 完全 置き換え （ サーバ の 構成 も 見直し 必要 じゃ ない です か ？ ） に なる でしょ う から 、 開発 費用 が 今後 の Java 運用 時 の コスト を 上回ら ん けれ ば いい と 思う ん です が ... 
XCOPY という こと は 、 ファイル を ディレクトリ 構造 ごと コピー し て いる ん です ね 。 XCOPY の オプション の 後 フォルダ パス 、 ファイル パス が 記述 を ダブル クォーテーション で くくっ て み て ください 。 もしか する と フォルダ 名 に スペース が 含ま れ て いる ので うまく 動い て い ない の かも 。 （ Program Files ( x86 ) 等 ） 【 例 】 xcopy / Y " C :\ hoge \ hoge . dll " " C :\ hoge \ hogehoge \" 
↓ の よう な 例文 は 、 参考 に なり ます か ？ A 列 の 最終 行 を 求め 、 TextBox 1 の 値 を 格納 し ます 。 Dim i As Long i = Cells ( Rows . Count , 1 ). End ( xlUp ). Offset ( 1 ). Row Cells ( i , 1 ). Value = TextBox 1 . Value 
値 の 入っ て い ない 、 という 状態 が 空欄 の セル という こと で 良い の で あれ ば 、 全て の シート の うち 、 C4 に 何らかの 入力 が ある シート のみ を 印刷 する 場合 は 、 以下 の よう に でき ます 。 Set wb = Workbooks (" ブック 名 ") For Each ws In wb . Worksheets If ( ws . Range (" C4 ") <> "") Then ws . PrintOut Next 
> 規格 を 満たし て いれ ば と いう の が 、 「 A1 の 値 が 負 なら ば 」 という こと なら 、 以下 の 式 = IF ( A1 ="","", IF ( A1 < 0 ,"○"," Ｘ ")) 
A3 から A 7 に は 間違い なく 、 正しい ファイル 名 が 入っ て い ます か ？ t _ path = " C :\ pict \" & Selection . Value & ". JPG " な ので 、 フォルダ 抜き で 拡張子 なし の ファイル 名 で ない と なら ない です 。 こちら の テスト で は 正しく 入っ て い ない 場合 （ 例えば .jpg まで つけ て しまっ た ） の よう な 場合 記載 さ れ た エラー に なり まし た 。 正しい ファイル 名 です と 、 図形 の 中 に 表示 さ れ て い ます 。 
ぐぐ れ ば いっぱい sample が で て き ます よ ？ まず は 調べる こと から 始め ましょ う よ ・ ・ ・ 。 聞く こと から 初めて 理解 でき ます か ？ https :// www . google . co.jp / search ? q = excel + vba +% E3 % 83 % 95 % E3 % 82 % A1 % E3 % 8 ... 
以下 の コード を 試し て み て ください 。 Sub Sample () Dim r ( 56 ) Dim i As Long , j As Long For i = 20 To 56 Step 2 If Cells ( i , 1 ) <> "" Then r ( j ) = Cells ( i , 1 ). Value r ( j + 1 ) = "" j = j + 2 End If Next Range (" A 20 : A5 7 ") = WorksheetFunction . Transpose ( r ) End Sub 
ThisWorkBook . Close 自分自身 を 閉じ て いる ので 、 ここ で コード 終わっ ちゃっ てる ん じゃ ない か な 。 Sub a () ThisWorkbook .S ave ThisWorkbook . Close MsgBox " aaa " End Sub で 、 aaa の メッセージ ボックス 出 なかっ た し 。 
Dim x ( k ) As Double こう いっ た 宣言 を する 為 に は 、 k が 定数 で ある こと が 条件 です 。 変数 は 使え ませ ん 。 x ( 0 ) = x ( 1 ) = 0 代入 式 に 、 この よう な 形 は あり ませ ん 。 きちんと 2 行 に 分け て 、 個別 に 代入 し て ください 。 他 は 特に ミス は 見当たり ませ ん 。 Do 文 と 次 の 行 が くっつい て い ます が 、 投稿 時 の ミス か 、 システム の 問題 だ と 思い ます ので 。 
こんな 感じ でしょ う か ？ Sub AHO () Dim T , K For T = 1 To 100 If T Mod 3 = 0 Or InStr ( 1 , T , " 3 ") Then K = " アホ " Else K = T End If Debug . Print K Next End Sub 
確認 する だけ なら 「 form .fr m 」 を メモ帳 で 見れ ば いけ ませ ん か ？ 実は 他 に ファイル が あり まし た って 落ち なら ば どうにも なり ませ ん が 。 exe ファイル を 逆 変換 する ツール とか 探せ ば ある かも しれ ませ ん ね 。 「 8 時 . vbp 」 が VB 6 で 編集 する 時 に 最初 に 起動 する ファイル で 「 8 時 . vbw 、 Project 1 . vbw 、 MSSCCPRJ .S CC 」 が 勝手 に 出来る ファイル だっ た 様 な 気 が し ます 。 exe は 実行ファイル だ から 、 消去法 的 に コード が 見れる の は 「 form .fr m 」 じゃ ない か と 。 あと VB 6 は VB 6 の 製品 が 無い と 変更 出来 なかっ た はず です から フリーソフト で 変更 は 無理 だ と 思い ます 。 見 た 所 １ フォーム しか ない 簡単 な 作り な ので excel 、 vb.net など で 作り なおす の が 無難 か と 。 
日付 が * で 区切ら れ て いる よう に み られる ので 、 explode 関数 を 使用 し て 、 配列 に 分割 する か 、 for ( explode ("*", $ trading _ day ) as $ day _ str ){ echo $ day _ str . "\ n "; // ブラウザ 上 で みる なら 、 ."< br />" } str _ replace 関数 を 使用 し て 、 * を 置き換える か すれ ば いい か と 。 $ trading _ day = str _ replace ("*", "\ n ", $ trading _ day ); // ブラウザ 上 で みる なら 、 ."< br />" echo $ trading _ day ; 
《 ボタン を 押し たら 》 とか 考え ず 、 テキストファイル へ 追加 モード で 書き込む の を 調べ て み たら 良い と 思い ます → これ を 新規 プロジェクト で 一 度 作っ て み て 、 成功 し たら 組み込め ば 良い 
拗音 を 除い た 文字数 と は ？ たとえば 「 あしゅら 」 は 何 文字 と なれ ば 正解 です か ？ ( 1 ) 「 あ 」 「 ら 」 の ２ 文字 ( 2 ) 「 あ 」 「 し 」 「 ら 」 の ３ 文字 拗音 は 「 ゃ 」 「 ゅ 」 「 ょ 」 が 付い た 文字 な ので 、 この 文字数 が 判れ ば 計算 でき ます 。 Private Sub Button 1 _ Click ( sender As Object , e As EventArgs ) Handles Button 1 . Click Dim buf As String , i As Long , cnt As Long Dim t As Integer Dim c As String Dim cn t2 As Long ' 拗音 の 個数 buf = Textbox 1 . text For i = 1 To Len ( buf ) c = Mid ( buf , i , 1 ) If (" ぁ " <= c ) And ( c <= " ん ") Then cnt = cnt + 1 If ( c = " ゃ ") Or ( c = " ゅ ") Or ( c = " ょ ") Then cn t2 = cn t2 + 1 Ebd If Next i t = cnt - cn t2 * 2 '( 1 ) の 個 数 t = cnt - cn t2 '( 2 ) の 個数 End Sub 
こんばんは 。 共有 モード で は 、 オブジェクト の 挿入 ・ 変更 作業 そのもの が でき ない 仕様 の よう です 。 参考 ： http:// www . atmarkit . co.jp / ait / articles / 1110 / 14 / news 152 _ 2 . html 
1 行 ずつ という の は 大変 です し 、 かえって 分かり にくい と 思い ます ので 、 まずは ブロック 毎 の 流れ から 説明 し ます 。 For m = 1 To INT _ EM EmName = Worksheets ( SHEET 2 ). Cells ( 1 , m ). Value endrowEm = Worksheets ( SHEET 2 ). Cells ( Rows . Count , m ). End ( xlUp ). Row ' 略 Editrow = 1 Next m ここ は 、 条件 シート の セル に 記載 さ れ て いる 対象 シート 名 を 取り出し 、 その シート 名 の シート を 対象 に 処理 を 行なう 、 という ループ を 組ん で い ます 。 > EmName = Worksheets ( SHEET 2 ). Cells ( 1 , m ). Value この 行 で 、 シート 名 を 取り出し て い ます 。 ループ 変 数 m は 列 番号 を 表わし て おり 、 条件 項目 列 数 で 定義 さ れ た 数 だけ 繰り返し ます 。 次に 、 上記 ループ 内 の 処理 です が 、 順序 として は 、 1 . ブック 内 に 対象 シート が あっ たら 削除 2 . 新規 シート を 追加 し て 、 対象 シート 名 へ と 変更 3 . ツイート DB シート と 条件 シート の データ を 全角 で 比較 し 、 条件 シート の データ が ツイート DB に 含ま れ て い た 場合 、 ツイート DB の 対象 行 データ を 対象 シート に 順番 に コピー と なっ て い ます 。 1 . シート 削除 For Each ws In Worksheets If ws . Name = EmName Then Application . DisplayAlerts = False Worksheets ( EmName ). Delete Application . DisplayAlerts = True End If Next ws 2 . 新規 シート 作成 、 シート 名 変更 Set ws = Worksheets . Add () ws . Name = EmName 3 . ツイート DB と の 比較 For i = 2 To EndrowTw For k = 2 To endrowEm If InStr ( StrConv ( Worksheets ( SHEET 1 ). Cells ( i , COL _ TW ). Value , vbWide ), StrConv ( Worksheets ( SHEET 2 ). Cells ( k , m ). Value , vbWide )) Then Worksheets ( SHEET 1 ). Select Worksheets ( SHEET 1 ). Rows ( i ). Select Worksheets ( EmName ). Rows ( Editrow ). Value = Selection . Value Editrow = Editrow + 1 Exit For End If Next k Next i その他 、 プロシージャ 外 に ある Const は 、 共通 で 使う 定数 宣言 、 Dim は 使用 する 変数 宣言 です 。 1 行 ずつ で は 、 機能 把握 が 大変 です 。 まずは ブロック の 流れ が こう なっ て いる こと を ご 理解 ください 。 その 上 で 、 細かい 部分 で 分から ない ところ を 返信 し て ください 。 慌て ず 、 順番 に 行き ましょ う 。 
IE 制御 は 、 その ページ の HTML ソース に 合わせる 必要 が あり 、 ページ 毎 に 異なる と 言っ て も 良い でしょ う 。 その 為 、 抽象 的 な 言葉 で 部分的 に ページ 構成 を 説明 さ れ て も 、 具体 的 な コード を 示し づらい です 。 もちろん 、 自身 で 応用 できる の で あれ ば 提案 の しよう も ある の です が 、 そう で は ない こと は 言明 さ れ て い ます ね 。 とりあえず 、 アップロード 先 の URL を 開示 できる の で あれ ば それ を 、 開示 でき ない の で あれ ば HTML ソース を どこ か に アップロード し て ください 。 
文字 が つぶれ て 何 が 何だか 、 
こんにちは。 この コード 、 70 行 を 削除 し て ください 。 数値 70 enter と し たら 、 削除 でき ます それ から 、 list で 、 すべて の 行 を 表示 さ せ て ください 。 画面 の 様子 に いわかん が あり ます 
Android studio について は よく 知り ませ ん が 、 エディタ 画面 の フォント が 「 P ゴシック 」 や 「 MS UI ゴシック 」 など に なっ て い ませ ん か ？ プロポーショナルフォント （ 文字 ごと に 横 幅 が ちがう フォント ） だ と 文字数 が 同じ で も ずれ て 見え ます 。 フォント を 「 MS ゴシック 」 など に 変え られる の なら 変え て み て ください 。 
ActiveWorkbook .S aveAs で は PDFファイル を 保存 でき ませ ん 。 でき て いる よう に 見え て いる の は 、 拡張子 が . pdf に なっ て いる Excel の ファイル です 。 pdf で 保存 する 場合 は 、 ExportAsFixedFormat メソッド を 使用 し ます 。 ActiveWorkbook . ExportAsFixedFormat Type := xlTypePDF , Filename := fname パラメータ の 詳細 について は 、 こちら を 参照 ください 。 http:// tohoprog .s blo .jp / article / 37555963 . html https :// msdn . microsoft . com / ja - jp / library / microsoft . office . tools . exc ... 
早い 話 年 テキスト & "/" & 月 コンボ & "/" & 日 コンボ が 日付 データ か否 か を チェック すれ ば いい の でしょ う か 。 Dim Dt As Date On Error Resume Next Dt = 年 テキスト & "/" & 月 コンボ & "/" & 日 コンボ If Err . Number <> 0 Then MsgBox " 日付 が 間違っ て い ます " Exit Sub End If On Error GoTo 0 With Sheets (" 操作 画面 ") . Range (" B 1 ") = Dt 曜日 = Format ( Dt , " aaa ") End With 日付 データ なら 、 曜日 は Format 関数 で 求め た ほう が 確実 で 早い でしょ う 。 
「 SR 2 種類 1% 」 「 R 6 種類 3 % 」 「 N 16 種類 5 % 」 の 最後 の パーセント は どういう 意味 です か ？ のこり の 92 % は 何 ？ C1 : C1 00 に 書き出し たら 次 は 何 を する の です か ？ 100回 繰り返す と いって も それぞれ の シミュレーション の 結果 は どこ に どういう 形 で 残す の です か ？ 自分 が 何 を どう し たい の か 、 赤の他人 に も 通じる よう な 文章 で 説明 し 直し て ください 。 
そう です か 。 頑張っ て 作っ て ください ネ ！ 
下記 の サイト は 参考 に なり ませ ん か ？ http:// oshiete . goo . ne.jp / qa / 9232653 . html 
※ 元 の エクセル は セル の 結合 等 は し て い ませ ん 。 A1 ～ E 675 の 中 に 結合 セル は あり ませ ん か ? 
CancellationToken を 使っ て み まし た 。 public partial class Form 1 : Form { private CancellationTokenSource token Source = new CancellationTokenSource (); private Task task = null ; public Form 1 () { InitializeComponent (); } private void Form 1 _ Load ( object sender , EventArgs e ) { task = taskNagai ( token Source . Token ); } private async void button 1 _ Click ( object sender , EventArgs e ) { token Source . Cancel (); try { await task ; } catch ( Opera tionCanceledException ) { } } private uint Kansu () { return 10 ; } private async Task taskNagai ( CancellationToken token ) { uint uiLv ; await Task . Run (() => { while ( true ) { token . T hr owIfCancellationRequested (); Thread . Sleep ( 10 ); uiLv = Kansu (); } }, token ); } } 
以下 で どう なり ます か Public Sub Samp 1 ()     Dim v As Variant     v = Split ( Range (" A 2 "). Value , ".")     With Range (" A5 "). Resize ( UBound ( v ) + 1 )        . Value = WorksheetFunction . Transpose ( v )        . TextToColumns . Cells ( 1 ), xlDelimited _           , Other := True , OtherChar :="-"     End With End Sub 
変更 前 Workbooks . Open Filename := mypath & "\ boo k2 . xlsm " 変更 後 Workbooks . Open Filename := mypath & "\ boo k2 . xlsm ", UpdateLinks := True https :// msdn . microsoft . com / ja - jp / library / office / ff 194819 . aspx 
オブジェクト 全て という の が 、 セル の 書式 ・ 値 ・ 罫線 、 図形 ・ マクロ 用 の ボタン や チェックボックス など 、 まさに シート に 存在 する すべて 、 という の で あれ ば 、 ① シート を コピー する ②「 別 シート 」 を 削除 する ③ コピー し た シート を 「 別 シート の 名前 」 に リネーム する という 手順 が もっとも 手っ取り早い と 思う の です が ？ 
Function CrossStr ( SH 3 As Worksheet , StrY As String , StrX As String , OffY As Integer , OffX As Integer ) As String Static Rng As Range Static YY As Integer Static XX As Integer Set Rng = SH 3 . Cells . Find ( what := StrY , lookat := xlPart , LookIn := xlValues ) If Rng Is Nothing Then CrossStr = "" Exit Function Else YY = Rng . Row + OffY End If Set Rng = SH 3 . Cells . Find ( what := StrX , lookat := xlPart , LookIn := xlValues ) If Rng Is Nothing Then CrossStr = "" Exit Function Else XX = Rng . Column + OffX End If Set Rng = Nothing CrossStr = SH 3 . Cells ( YY , XX ). Value End Function Function ハイフン ( SS As String ) As String Static A As String A = StrConv ( SS , vbNarrow ) A = Replace ( A , "―", "-") A = Replace ( A , "‐", "-") A = Replace ( A , "－", "-") A = Replace ( A , " ｰ ", "-") A = Replace ( A , "￣", "-") ハイフン = A End Function Sub フォルダ 名 入力 () Static DN As String With Application . FileDialog ( msoFileDialogFolderPicker ) . InitialFileName = ActiveWorkbook . Path If .S how <> 0 Then DN = .S electedItems ( 1 ) Else DN = "" End If End With Worksheets (" 設定 "). Range (" B 1 "). Value = DN End Sub Sub ファイル 名 入力 () Static Fn As String Fn = Application . GetOpenFilename Worksheets (" 設定 "). Range (" E 19 "). Value = Right ( Fn , Len ( Fn ) - InStrRev ( Fn , "\")) Workbooks . Open Fn End Sub Sub データ転送 () Static Fn 1 As String Static F n2 As String Static X ( 3 ) As Integer Static Y1 As Integer Static Y 2 As Integer Static Str 1 As String Static Str 2 As String Static Str 3 As String Static Str 4 As String Static Rng As Variant ' 設定 の 値 を 取得 Fn 1 = ThisWorkbook . Name X ( 0 ) = Workbooks ( Fn 1 ). Worksheets (" 設定 "). Range (" E2 0 "). Value X ( 1 ) = Workbooks ( Fn 1 ). Worksheets (" 設定 "). Range (" E2 1 "). Value X ( 2 ) = Workbooks ( Fn 1 ). Worksheets (" 設定 "). Range (" E2 2 "). Value X ( 3 ) = Workbooks ( Fn 1 ). Worksheets (" 設定 "). Range (" E2 3 "). Value F n2 = Workbooks ( Fn 1 ). Worksheets (" 設定 "). Range (" E 19 "). Value ' メイン 処理 Y 2 = 2 Do Until Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , 1 ). Value = "" ' 検索 キー を 取得 Str 1 = Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 0 )). Value Str 2 = Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 1 )). Value Str 3 = Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 2 )). Value Str 4 = Str 1 & "_" & Str 3 & "_" & Str 2 ' 検索 キー で 検索 し行 数 Y1 を 取得 する 。 Set Rng = Workbooks ( Fn 1 ). Worksheets (" Sheet 1 "). Columns ( 17 ). Find ( what := Str 4 , lookat := xlPart , LookIn := xlValues ) If Rng Is Nothing Then Else Y1 = Rng . Row ' 対象 の シート に 数値 を 転送 する 。 Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 3 ) + 0 ). Value = Workbooks ( Fn 1 ). Worksheets (" Sheet 1 "). Cells ( Y1 , 8 ). Value Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 3 ) + 1 ). Value = Workbooks ( Fn 1 ). Worksheets (" Sheet 1 "). Cells ( Y1 , 9 ). Value Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 3 ) + 2 ). Value = Workbooks ( Fn 1 ). Worksheets (" Sheet 1 "). Cells ( Y1 , 10 ). Value Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 3 ) + 3 ). Value = Workbooks ( Fn 1 ). Worksheets (" Sheet 1 "). Cells ( Y1 , 11 ). Value Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 3 ) + 4 ). Value = Workbooks ( Fn 1 ). Worksheets (" Sheet 1 "). Cells ( Y1 , 12 ). Value Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 3 ) + 5 ). Value = Workbooks ( Fn 1 ). Worksheets (" Sheet 1 "). Cells ( Y1 , 13 ). Value Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 3 ) + 6 ). Value = Workbooks ( Fn 1 ). Worksheets (" Sheet 1 "). Cells ( Y1 , 14 ). Value Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 3 ) + 7 ). Value = Workbooks ( Fn 1 ). Worksheets (" Sheet 1 "). Cells ( Y1 , 15 ). Value Workbooks ( F n2 ). ActiveSheet . Cells ( Y 2 , X ( 3 ) + 8 ). Value = Workbooks ( Fn 1 ). Worksheets (" Sheet 1 "). Cells ( Y1 , 16 ). Value End If Y 2 = Y 2 + 1 Loop Set Rng = Nothing End Sub 
Public Sh 1 As Worksheet Public F _ Row As Integer Public FolderName ( 99999 ) As String Public F _ No 1 As Integer ' フォルダ 位置 ( 書出 用 ) Public F _ No 2 As Integer ' フォルダ 位置 ( 現在 位置 ) Public Ken ( 13 ) As String ' 検索キーワード 等 Sub FileName 1 () Static Pa As String With Application . Calculation = xlCalculationManual .S creenUpdating = False . DisplayAlerts = False End With ' 検索キーワード 等 設定 Ken ( 0 ) = Worksheets (" 設定 "). Range (" E3 "). Value Ken ( 1 ) = Worksheets (" 設定 "). Range (" F3 "). Value Ken ( 2 ) = Worksheets (" 設定 "). Range (" E 4 "). Value Ken ( 3 ) = Worksheets (" 設定 "). Range (" E 5 "). Value Ken ( 4 ) = Worksheets (" 設定 "). Range (" E 6 "). Value Ken ( 5 ) = Worksheets (" 設定 "). Range (" E 10 "). Value Ken ( 6 ) = Worksheets (" 設定 "). Range (" F1 0 "). Value Ken ( 7 ) = Worksheets (" 設定 "). Range (" D1 1 "). Value Ken ( 8 ) = Worksheets (" 設定 "). Range (" D12 "). Value Ken ( 9 ) = Worksheets (" 設定 "). Range (" D1 3 "). Value Ken ( 10 ) = Worksheets (" 設定 "). Range (" D1 4 "). Value Ken ( 11 ) = Worksheets (" 設定 "). Range (" G10 "). Value Ken ( 12 ) = Worksheets (" 設定 "). Range (" E2 7 "). Value Ken ( 13 ) = Worksheets (" 設定 "). Range (" E2 8 "). Value ' Pa 指定 Set Sh 1 = ActiveSheet Sh 1 . Range (" A 2 : Z 10000 "). ClearContents Sh 1 . Cells . Hyperlinks . Delete Pa = Worksheets (" 設定 "). Range (" B 1 "). Value ' メイン 処理 F _ Row = 2 Erase FolderName F _ No 1 = 1 F _ No 2 = 0 F il eN am e2 ( Pa ) Set Sh 1 = Nothing With Application . Calculation = xlCalculationAutomatic .S creenUpdating = True . DisplayAlerts = True End With End Sub Sub FileName 2 ( Pa As String ) Static C _ Fn As String ' 現在 位置 の ファイル 名 または フォルダ 名 Static Sh 2 As Worksheet Static Str 1 As String Static Str 2 As String Static Str 3 As String ' 現在 の 階層 の ファイル 名 と フォルダ 名 を 取得 する 。 C _ Fn = Dir ( Pa & "\*.*", vbDirectory ) Do Until C _ Fn = "" If C _ Fn <> "." And C _ Fn <> ".." Then If InStr ( 1 , C _ Fn , "?") = 0 Then ' 区分 入力 、 フォルダ 名 を 配列 に 格納 If GetAttr ( Pa & "\" & C _ Fn ) And vbDirectory Then ' フォルダ 名 を 格納 FolderName ( F _ No 1 ) = Pa & "\" & C _ Fn F _ No 1 = F _ No 1 + 1 Else ' F n2 を 開く 。 Workbooks . Open Pa & "\" & C _ Fn For Each Sh 2 In Workbooks ( C _ Fn ). Worksheets ' フォルダ 名 、 ファイル 名 、 シート 名 Sh 1 . Cells ( F _ Row , 1 ). Value = Pa Sh 1 . Hyperlinks . Add Anchor := Sh 1 . Cells ( F _ Row , 1 ), Address := Pa Sh 1 . Cells ( F _ Row , 2 ). Value = C _ Fn Sh 1 . Hyperlinks . Add Anchor := Sh 1 . Cells ( F _ Row , 2 ), Address := Pa & "\" & C _ Fn Sh 1 . Cells ( F _ Row , 3 ). Value = Sh 2 . Name ' 見出し Sh 1 . Cells ( F _ Row , 4 ). Value = Sh 2 . Range ( Ken ( 0 )). Value & "-" & Sh 2 . Range ( Ken ( 1 )). Value Sh 1 . Cells ( F _ Row , 5 ). Value = Sh 2 . Range ( Ken ( 2 )). Value Sh 1 . Cells ( F _ Row , 6 ). Value = Sh 2 . Range ( Ken ( 3 )). Value Sh 1 . Cells ( F _ Row , 7 ). Value = Sh 2 . Range ( Ken ( 4 )). Value ' 数値 Sh 1 . Cells ( F _ Row , 8 ). Value = CrossStr ( Sh 2 , Ken ( 10 ), Ken ( 5 ), 0 , 2 ) Sh 1 . Cells ( F _ Row , 9 ). Value = CrossStr ( Sh 2 , Ken ( 7 ), Ken ( 6 ), 0 , 0 ) Sh 1 . Cells ( F _ Row , 10 ). Value = CrossStr ( Sh 2 , Ken ( 8 ), Ken ( 6 ), 0 , 0 ) Sh 1 . Cells ( F _ Row , 11 ). Value = CrossStr ( Sh 2 , Ken ( 9 ), Ken ( 6 ), 0 , 0 ) Sh 1 . Cells ( F _ Row , 12 ). Value = CrossStr ( Sh 2 , Ken ( 10 ), Ken ( 6 ), 0 , 0 ) Sh 1 . Cells ( F _ Row , 13 ). Value = CrossStr ( Sh 2 , Ken ( 7 ), Ken ( 11 ), 0 , 0 ) Sh 1 . Cells ( F _ Row , 14 ). Value = CrossStr ( Sh 2 , Ken ( 8 ), Ken ( 11 ), 0 , 0 ) Sh 1 . Cells ( F _ Row , 15 ). Value = CrossStr ( Sh 2 , Ken ( 9 ), Ken ( 11 ), 0 , 0 ) Sh 1 . Cells ( F _ Row , 16 ). Value = CrossStr ( Sh 2 , Ken ( 10 ), Ken ( 11 ), 0 , 0 ) Str 1 = CrossStr ( Sh 2 , Ken ( 12 ), Ken ( 12 ), 1 , 0 ) Str 1 = StrConv ( Str 1 , vbNarrow ) Str 2 = CrossStr ( Sh 2 , Ken ( 13 ), Ken ( 13 ), 1 , 0 ) Str 2 = Format ( Str 2 , " yyyy / mm / dd ") Str 3 = Sh 2 . Range ( Ken ( 3 )). Value Str 3 = ハイフン ( Str 3 ) Sh 1 . Cells ( F _ Row , 17 ). Value = Str 2 & "_" & Str 1 & "_" & Str 3 F _ Row = F _ Row + 1 Next ' F n2 を 閉じる 。 Workbooks ( C _ Fn ). Close End If End If End If C _ Fn = Dir Loop ' 次 の 階層 へ 以降 する 。 F _ No 2 = F _ No 2 + 1 If FolderName ( F _ No 2 ) = "" Then Exit Sub FileName 2 ( FolderName ( F _ No 2 )) End Sub 
具体 的 な こと が まーー ー ったく わかり ませ ん が 。 。 。 ご 自身 で ご 質問 を 今 読み返し て み て 「 何 を どう し たい の か 」 が わかり ます か ？ . 推測 混じり です が まず ご 質問 から わかる こと を 書き ます 。 ◎ どこ か 任意 の フォルダ ( サーバ 上 か ローカル か は 不明 ) に     複数 の 行 の タブ 区切り の テキスト データファイル が あり     どの ファイル も 同じ 行 数 で ある 。 【 例 】 任意 の フォルダ 内 の ファイル 例 ・ 「 果物 . tsv 」 ファイル データ 内容 例 ↓ 1     リンゴ        200 2     ブドウ        500 3     バナナ        150 ・ 「 野菜 . tsv 」 ファイル データ 内容 例 ↓ 1     キュウリ     200 2     カボチャ     400 3     タマネギ     100 ・ 「 食肉 . tsv 」 ファイル データ 内容 例 ↓ 1     トリ           200 2     ブタ           250 3     ウシ           600 ※ 補足     なお ココ ( HTML ) では タブ は 表せ ない ので 上 の データ は     「 HTML 初心者 です 。 coteditor という ... - Yahoo!知恵袋 」     http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1312987467 ...     この 方法 にて タブ を 複数 の \ U 00 A 0 で 代用 し て い ます 。 推測 で 想像 できる の は これ くらい な もの です 。 === === === === === > VBScript で の 実装 に関して 質問 です 。 まず VBScript と は どこ で 使わ れる VBScript の 話 です か ？ WSH の 「 VBS 」 ファイル で 使わ れる VBScript も あれ ば HTML や HTA で 使わ れる VBScript も あれ ば ASP で 使わ れる VBScript も あり ます 。 同じ VBScript でも 使い 方 が 全然 違い ます 。 「 VBScript - Wikipedia 」 https :// ja . wikipedia . org / wiki / VBScript . > なお 、 一番 左 の 列 は Ｎ ｏ フィールド と なっ て おり 、 > ここ は 連結 の 起点 と なる > 最初 の リスト ファイル の もの だけ を 残し 、 一番 左 の 列 に は 数字 が 入っ て いる の は わかり ます 。 そこ は わかり ます が 「 最初 の リスト ファイル 」 の 「 最初 」 と は どの ファイル が 「 最初 」 な の です か ？ 上記 ファイル 例 「 果物 . tsv 」 「 野菜 . tsv 」 「 食肉 . tsv 」 の ファイル 順 は 私 が 勝手 に 思いつき で 決め た 順 です 。 もし その 「 果物 . tsv 」 「 野菜 . tsv 」 「 食肉 . tsv 」 の 順 で 良い の でし たら 1      リンゴ      200      キュウリ      200      トリ      200 2      ブドウ      500      カボチャ      400      ブタ      250 3      バナナ      150      タマネギ      100      ウシ      600 こんな データ に なる の です よ 。 もし 「 食肉 . tsv 」 「 果物 . tsv 」 「 野菜 . tsv 」 の 順 が 良い の でし たら 1      トリ      200      リンゴ      200      キュウリ      200 2      ブタ      250      ブドウ      500      カボチャ      400 3      ウシ      600      バナナ      150      タマネギ      100 こんな データ に なり ます 。 データ の 形 が 全然 違い ます よ ね 。 データ の 形 が 違え ば 何 列 が 何 を 表す の か 不明 に なり 後 の 処理 が 超 大変 に なり ます 。 「 何 を 基準 に 最初 など の 順番 を 決め て いる の か 」 が わから なけれ ば 無茶苦茶 な データ が できる だけ です 。 もし 無茶苦茶 な 順 の データ で 良い の でし たら 適当 に 書ける の かも しれ ませ ん が 。 . さらに 複数 行 から でき て いる の でし たら 「 改行 」 で 行 の データ を 区切っ て いる と 思い ます 。 その 「 改行 コード 」 は 何 な の です か ？ VB 系 的 な 改行 の 言い方 を すれ ば vbCrLf も 改行 コード ， vbLf も 改行 コード vbCr も 改行 コード です 。 また 日本語 を など を 扱う 場合 は 文字コード も ハッキリ さ せ て おい た 方 が 良い でしょ う 。 また 拡張子 も 私 が 勝手 に 「 . tvs 」 に し て い ます が 「. txt 」 かも しれ ませ ん 。 この 辺 も 具体 的 に ハッキリ さ せ た 方 が 良い でしょ う 。 ( ファイル 選択 時 や エラー 処理 に 関係 する かも しれ ない ので 。) . さらに さらに 「 希望 通り ！ 」 か どう か は 知り ませ ん が ， 仮に 次 の よう な データ が でき た と し ましょ う か 。 1      キュウリ      200      トリ      200      リンゴ      200 2      カボチャ      400      ブタ      250      ブドウ      500 3      タマネギ      100      ウシ      600      バナナ      150 これ を どう する の です か ？ 例えば WS cri pt. Echo や MsgBox みたい な ので 表示 さ せる だけ で 良い の でしょ う か ？ . ご 質問 文 から で は 具体 的 な こと が 全く わかり ませ ん よ ね ？ 「 とりあえず 最初 に 何 から すれ ば 良い の か ？ 」 も 「 でき た 後 最後 に 何 を すれ ば 良い の か ？ 」 も 判断 でき ませ ん 。 唯一 ， 提示 できる の は 次 の ページ くらい な もの です 。 「 文字列 の 定数 」 https :// msdn . microsoft . com / ja - jp / library / cc 392241 . aspx . なお この 回答 の 【 返信 】 欄 で 補足 説明 を さ れ て も その 【 返信 】 欄 で は 文字数 不足 に なる ため 十分 な 回答 は でき ない と 思い ます 。 そもそも 私 は VBScript が 専門 で は あり ませ ん し ( ASP の VBScript など 私 は 全く わから ない ) 具体 的 な こと が わかれ ば 私 以外 に わかる 方 も いらっしゃる と 思い ます 。 です から 回答 の 【 補足 】 欄 で 補足 し て いただく か 最初 から 質問 文 を 考え直し て 「 VisualBasic 」 または 「 ASP 系 」 カテゴリ で 再 質問 さ れ た 方 が 良い よう に 思い ます 。 
これ は 、 とりあえず 版 です 。 シート が 、 アクティブ シート だけ で いい の かも わかり ませ ん 。 これから 出かける ので 、 明日 まで メンテナンス は でき ませ ん 。 色々 な フォルダ に データ が ある の なら 、 それ を 指定 し て 、 一 度 に 行う こと も 考え られ ます 。 フォルダ が どの よう に なっ て いる の か （ １つ の フォルダ で 、 サブ フォルダ まで 調べ て ぜんぶ な の か 、 それとも 、 処理 し たい フォルダ が あちこち に ある の か ） 、 ご 記入 ください 。 明日 で よけれ ば 、 メンテナンス し ます 。 ' Option   Explicit ' Sub   Macro 1 () '      Dim   FileName   As   String '      ChDrive   Left ( ThisWorkbook . Path ,   2 )      ChDir   ThisWorkbook . Path      FileName   =   Dir ("*. xls *") '      Do   While   FileName   >   "" '          If   FileName   <>   ThisWorkbook . Name   Then              Workbooks . Open   FileName              [ A : A ]. Delete   Shift := xlToLeft              [ B : C ]. Delete   Shift := xlToLeft              ActiveWorkbook .S ave              ActiveWorkbook . Close          End   If          FileName   =   Dir      Loop ' End   Sub ' 
前 の 質問 で は 「 原本 シート が 原本 シート の 後ろ に コピー さ れる 」 と 書い て ある の に 一番 後ろ に コピー さ れる コード が 採用 さ れ て い ます が 、 その 辺 は どう な ん でしょ う ？ 原本 シート の 後ろ に コピー さ れる コード です 。 一番 後ろ に 持っ て いく の も 前 の 質問 の 回答 を 参考 に すれ ば いい ので そこ は 適当 に 。 原本 シート が ない 場合 の エラー 処理 は し て い ませ ん 。 Sub Tesr () Dim sh As Worksheet Dim fr As Boolean For Each sh In Worksheets If sh . Name = Format ( Date , " yyyymmdd ") Then fr = True Next If fr = True Then MsgBox " 今日 の 日付 の シート は 既に 作成 済み です " Exit Sub End If Sheets (" 原本 "). Copy After := Sheets (" 原本 ") With ActiveSheet . Name = Format ( Date , " yyyymmdd ") . Range (" A1 ") = Date End With End Sub 
Sub 一 例 です () Dim sh As Worksheet , i As Long i = 1 With Worksheets (" メイン ") For Each sh In Worksheets If sh . Name <> . Name And sh . Name <> " 原本 " Then i = i + 1 . Cells ( i , 1 ). Value = sh . Name End If Next sh End With End Sub 
最初 の SCRIPT タグ を 取得 すれ ば 何とか なる の で は ない でしょ う か 。 msg = ie . document . getElementsByTagName (" script ")( 0 ). outerHTML これ で SCRIPT タグ の HTML 記述 が 取得 でき ます ので 、 後 は msg に対して 文字列 操作 命令 ( InStr 、 Mid ) で 、 目的 の 文字列 を 切り出せ ば 良い はず です 。 
With Worksheets . Add Set xRng = . Cells ( 1 , 1 ). Resize (, 4 ) End With ↓ With Worksheets . Add . Name = " 結果 " Set xrng = . Cells ( 1 , 1 ). Resize (, 4 ) End With 未 実行 です 。 ひょっとしたら 、 作者 は 私 ？ 
まぁ まず 、 謎 の 単語 が 出 て くる 仕様 じゃどう も なら ん でしょ う が 、 推測 。 ボタン に 画像 を 表示 し て 、 押し た 時 に 別 画像 に 切り替える 。 まぁ 、 これ は 判る 。 じゃ 、 いつ 元 に 戻す の か ？ これ が 決まら ない と 作れ ない です よ 。 トグル ボタン みたい に ON と OFF を 表す の で あれ ば 、 クリック 時 に 状態 を 静的 に 判断 してやれ ば 画像 の ON - OFF が 管理 でき ます ね 。 または ボタン を 押し こん で いる とき に だけ 画像 が 変わり 、 ボタン を 離す と 元 に 戻る タイプ 。 マウス 操作 や タッチパネル 操作 で 処理 が 判り にくい とき など よく やり ます ね 。 これ は MouseDown と MouseUp もしくは MouseLeave で 画像 の 切り替え を してやれ ば 良い 。 こん ぐらい の 事 な んで web じゃ ナカナカ 扱っ て い ない かも ね 。 
kuro _ neko _ g _ san さん が 回答 さ れ た 日本郵便 の Web サイト の ダウンロード データ は パソコン で 扱う に は 全く 役に立た ない データ です 。 （ IT 業界 の 人間 で も 知ら ない 人が 多く て 困り ます ） パソコン で 扱う の に 適し た データ は 下記 の サイト に あり ます 。 http:// zipcloud . ibsnet . co.jp / 「 郵便番号 データ （ 加工 済 バージョン ） の ダウンロード 」 から ダウンロード し て 下さい 。 
コンボボックス の 名前 が 間違っ て い ませ ん か ？ 
こんな 感じ Sub 採 番 () Dim i As Long Const 始め = 1322 Const 終わり = 1543 Dim cnt As Integer cnt = 1 For i = 始め To 終わり If i Mod 100 <> 0 Then Cells ( cnt , 4 ). Value = Left ( i , 2 ) & "-" & Right ( i , 2 ) cnt = cnt + 1 End If Next i End Sub 連 番 で 振っ て 、 下 ２ ケタ が ０ ０ の 時 は 除外 する 
以下 で どう なり ます か 新規 ファイル を 開き 、 以下 を 標準 モジュール に 転記 し 、 Sheet 1 / Sheet 2 が ある 状態 で 、 testData を 実行 する と テスト 用 データ が 出来上がり ます その後 Samp 1 を 実行 し て み ます やっ て いる こと は 、 Sheet 1 の . Cells ( i , " A ") から の 相対 として CRNG を 参照 し ます . Cells ( i , " A "). Range ( CRNG ) すると , 区切り ＝ 領域 と 解釈 でき 、 >     Set rng = Worksheets (" Sheet 2 "). Range (" A1 ") によって 、 A 列 指定 し た rng の Offset と 合わせ て 、 データ を 設定 し ます Sheet 2 は 前回 の 続き ･･･ なら 、 コメント 部分 を 有効 に し て み て ください また 、 必要 なら Sheet 2 を 綺麗 に し て から とか ･･･ Public Sub Samp 1 ()     Dim rng As Range     Dim i As Long , j As Long , k As Long     Const CRNG As String = _        " B 1 , C1 , D1 , E 1 , F1 , F3 , G1 , G3 , H1 , H2 , H3 , I 1 , J 1 , K 1 , L 1 "     Set rng = Worksheets (" Sheet 2 "). Range (" A1 ") '     Set rng = Worksheets (" Sheet 2 ") _ '                 . Cells ( Rows . Count , " B "). End ( xlUp ). Offset ( 1 , - 1 )     Application .S creenUpdating = False     With Worksheets (" Sheet 1 ")        i = 5        For j = 1 To 15           With . Cells ( i , " A "). Range ( CRNG )              For k = 1 To . Areas . Count                 rng . Offset (, k ). Value = . Areas ( k ). Value              Next              Set rng = rng . Offset ( 1 )           End With           i = i + 3        Next     End With     Application .S creenUpdating = True End Sub ' 確認 用 データ 作成 Public Sub testData ()     Dim r As Range     Const CRH As Long = 50     Application .S creenUpdating = False     With Worksheets (" Sheet 1 ")        . Cells . Delete        For Each r In . Range (" A1 : N 1 "). Resize ( CRH )           r . Value = r . Address ( False , False )        Next        . Columns . AutoFit        Worksheets (" Sheet 2 "). Columns . ColumnWidth = _           . Cells ( 1 ). ColumnWidth     End With     Application .S creenUpdating = True End Sub 
( ie ) 下記 で どう です か 。 objIE . document . getElementsByName (" logIn ")( 0 ). Click 
こんばんは 。 楽し そう な ので 、 作っ て み まし た 。 ただし 、 楽しく する 工夫 は ここ の カテゴリー 外 の 内容 な ので 、 VBA プログラム だけ 。 。 。 ^^; 下 の コード を 標準 モジュール に 貼り 付け て 「 問題 を 出す 」 ボタン を Mondai () プロシージャ に 、 判定 ボタン を Kotae () プロシージャ に 紐 付け て 実行 ください 。 シート の 構造 は 添付 図 の よう に し まし た 。 Sheet 2 の 問題 データベース は 、 １ 行 目 を タイトル に し た ので 、 データ は ２ 行 目 から 入っ て い ます 。 お 試し ください 。 以下 コード ========================= Option Explicit Const SH 1 As String = " Sheet 1 " Const SH 2 As String = " Sheet 2 " Const MONDAISU As Long = 100 ’ 出題 ルーチン Sub Mondai () Dim Qnumber As Long Worksheets ( SH 1 ). Range (" A1 , D1 "). ClearContents Qnumber = Int ( Rnd () * MONDAISU ) Worksheets ( SH 1 ). Range (" B 1 "). Value = Worksheets ( SH 2 ). Range (" B2 "). Offset ( Qnumber ). Value Worksheets ( SH 1 ). Range (" C1 "). Value = Worksheets ( SH 2 ). Range (" C 2 "). Offset ( Qnumber ). Value Worksheets ( SH 1 ). Range (" E 1 "). Value = Qnumber End Sub ' 答え 合わ せ ルーチン Sub Kotae () Dim Qnumber As Long Qnumber = Worksheets ( SH 1 ). Range (" E 1 "). Value If Worksheets ( SH 1 ). Range (" A1 "). Value = Worksheets ( SH 2 ). Range (" A 2 "). Offset ( Qnumber ). Value Then Worksheets ( SH 1 ). Range (" D1 "). Value = " 正解 ！" Else Worksheets ( SH 1 ). Range (" D1 "). Value = " 不正解 ！ 残念 " End If End Sub 
う～ む 。 謎 現象 です ね ... 新規 Book で も 同じ と なる と 。 ちなみに 、 複数 選択 の マクロ を Sheets ( Array (" Sheet 1 ", " Sheet 2 ")). Select と 記述 し て み て も 、 複数 選択 に なら ない でしょ う か ？ 
過去 に この よう な 質問 が ある ので 参考 に し て み て ください 。 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1298068887 画像 は 、 上記 の 質問 で 作っ た サンプル です 。 WebBrowser コントロール に フォーカス が あっ て い て も 文字 を 取得 する こと が 出来 て い ます フォーム 外 に カーソル が 出 て い て も 問題 あり ませ ん 。 
こんにちは。 ブラウザー の 「 名前 を つけ て 保存 」 で 、 いくつ か バリエーション あり ます ので 、 それ で 試し て ください 。 大昔 の webページ だっ たら 、 使え て い た 方法 が 、 今 は サーバー の セキュリティ 対策 の ため に 、 処理 が でき ない 、 という こと です 。 スクリプト てんこ盛り だ と 、 確か に 厳しい です けど ね 。 
該当 DB が WINDOWS 認証 に なっ て い ない なんて オチ じゃぁ 、 無い ですよねぇ。 
こんにちは。 http:// d . hatena . ne.jp / val 90 / 20070227 / 1172558857 の つぶやき は 、 役に立ち そう です 。 
Destination := Range ("$ C $3 ")) ここ を Destination := IIf ( Range (" C3 "). Value = "", Range (" C3 "), Range (" C " & Cells . Rows . Count ). End ( xlUp ). Offset ( 1 )) に し て は どうでしょう か 。 （ 次 の 空白 セル 位置 から 書き込む ） 
こんな 感じ でしょ う か ？ Sub sample () With Range (" B 1 ", Cells ( Rows . Count , 1 ). End ( xlUp ). Offset (, 1 )) . Formula = "= COUNTIF ($ A $1 : A1 , A1 )" . Copy . PasteSpecial xlPasteValues End With Application . CutCopyMode = False End Sub 
ところで 、 何 の 話し でしょ う か ？ （ 開発 ソフト 名 は ？ ） VB 6 . 0系 と .NET 系 で 書き方 が 違い ます 。 > 初心者 で 上手く いか ない ので 教え て ください 。 どの 辺 が 上手く いか ない の でしょ う か ？ あなた が コーディング し た ソース を 添付 し て 、 具体 的 に 上手く いか ない 点 を 書い て 下さい 。 丸投げ し て は 、 あなた の スキルアップ に は なり ませ ん 。 
言い たい こと は 判ら ない でも ない けど 、 質問 は 落ち着い て 、 出来る だけ 正しい日本語 で 書き ましょ う 。 Access に 限っ た 事 で は ない の です が 、 文字 を 範囲 で 取る 場合 は 、 文字コード の 比較 に なり ます 。 文字コード が 判ら なかっ たら 、 まず 、 そこ から 調べ て ください 。 文字列 を 比較 する 際 に は 、 その 文字列 を 形成 する 文字 の 文字コード 順 に 並び ます 。 例えば 、 例 に 上がっ て いる 「 金賞 」 と 「 銀賞 」 です が 、 文字コード で 比較 する と 「 銀賞 」 の 方 が 大きく なり ます 。 まず 、 これ が 基本 。 で 、 質問 の 内容 な ん です が 、 「 文字列 を 範囲 検索 する 際 に は SQL （ もしくは DLookup など の 関数 の 条件 部分 ） で は 、 どう 書く べき か 。 Between を 使え ば よい の か ？ 」 という 事 だ と する なら ば 、 まさしく その 通り です 。 しかし 、 その 場合 上記 の 文字コード を 意識 し なけれ ば なり ませ ん 。 例えば 、 「 特賞 」 「 金賞 」 「 銀賞 」 と 言う データ が 有り 、 特賞 と 金賞 の 上位 2つ を 取り たい 場合 、 「 Between ' 特賞 ' and ' 金賞 '」 と 書き たく なり ます 。 しかし 、 文字コード 順 で 言え ば 「 金賞 」 「 銀賞 」 「 特賞 」 と 、 特賞 が 一番 大きく なり ます 。 結果 、 先 ほど の 条件 で は 上位 2 件 で は なく 、 全て が 取ら れ て しまう こと に なり ます 。 これ を 回避 する ため に 、 普通 は 範囲 で 条件 に 指定 し たり 、 大小 比較 する データ は 、 数字 として 保存 し 、 その 対応 データ を 別途 保持 し 、 表示 の 際 に その データ を 扱う よう に し ます 。 こういう 別途 持つ データ を 「 マスター データ 」 等 と 呼び ます 。 結論 として 回答 は 「 文字列 の 範囲 指定 は Between で 指定 できる 。 しかし それ は 思っ た 通り の 抽出 が 出来る と は 限ら ない 。 」 と 、 なり ます 。 
マクロ を 勉強 中 な のに 数式 で 回答 さ れ て も 困り ます よ ね ( 笑 ) 下記 の コード でいか が でしょ う か ？ 出来れ ば ステップ 実行 ( VBE の 画面 で F8 クリック ） で 一行 ずつ プログラム の 流れ と 変数 の 値 の 変化 を 追いかけ て みる と プログラム の 理解 が 深まり ます 。 Option Explicit Sub Sample () Dim r As Long , r2 As Long Dim str As String , startRow As Long , cnt As Long With Columns (" C ") ' 一旦 C 列 を クリア する . ClearContents ' C 列 の 書式 を 「 文字列 」 に する . NumberFormatLocal = "@" End With ' 書き出し 用 の 文字列 ・ 書き出し 開始 行 ・ カウンタ の 初期 値 を 設定 する str = Range (" B 1 "). Value startRow = 1 cnt = 0 ' 2 行 目 から 最終 行 まで 繰り返す For r = 2 To Range (" A " & Rows . Count ). End ( xlUp ). Row ' 前 の 行 の A 列 と 同じ か どう か 判定 する If Range (" A " & r ). Value = Range (" A " & r - 1 ). Value Then ' 同じ なら カウンタ を 1 増やし て 書き出し 用 の 文字列 を 組み立てる cnt = cnt + 1 str = str & "," & Range (" B " & r ). Value Else ' 違っ て い たら startRow から ひとつ 手前 の 行 まで C 列 を 書き出す For r2 = startRow To r - 1 Range (" C " & r2 ). Value = str Next r2 ' 書き出し 用 の 文字列 ・ 書き出し 開始 行 ・ カウンタ を リセット する str = Range (" B " & r ). Value startRow = r cnt = 0 End If Next r ' 最終 行 の C 列 が 空欄 なら C 列 を 書き出す If Range (" C " & r - 1 ). Value = "" Then For r2 = startRow To r - 1 Range (" C " & r2 ). Value = str Next r2 End If ' C 列 の 幅 を 自動 調整 する Columns (" C "). EntireColumn . AutoFit End Sub 
マクロ 初心者 が 作れる レベル の もの で は ない です 。 VB Ａ の 基礎 から 勉強 が 必要 です 。 １ ． フォーム ( ウィンドウ ) を 表示 し 、 入力データ を 取得 する 。 ２ ． 取得 し た データ を もと に 、 シート の データ を 計算 し たり 、 場所 を 移動 さ せる 。 初心者 なら ２ ． の シート 内 の データ を 計算 さ せ たり 、 移動 さ せる こと を 覚え て ください 。 そう する と 、 プログラム の 感覚 が 解り ます 。 
以下 で どう なり ます か Public Sub Samp 1 ()     Dim ws As Worksheet     Dim i As Long , j As Long , k As Long     Application .S creenUpdating = False     Set ws = Worksheets (" Sheet 1 ")     ws . Columns (" A : C "). Clear     With Worksheets (" Sheet 2 "). Range (" A1 "). Current Region        k = 1        For i = 1 To . Rows . Count           For j = 2 To . Columns . Count              If (. Cells ( i , j ) = "") Then Exit For              . Cells ( i , j ). Copy ws . Cells ( k + j - 2 , " B "). Resize (, 2 )           Next           j = j - 2           If ( j > 0 ) Then              . Cells ( i , 1 ). Copy ws . Cells ( k , " A "). Resize ( j )              k = k + j           End If        Next     End With     Application .S creenUpdating = True End Sub 
マクロ が 多く て も 、 ボタン に 名前 を 付け て いる から マクロ の 多い こと は 問題 に は なり ませ ん 。 
*** VB 6 . 0 の ヘルプ から 抜粋 *** PasswordChar プロパティ テキスト ボックス ( TextBox ) コントロール に 入力 さ れ た 文字 を 表示 する か 、 プレースホルダ を 表示 する か を 設定 し ます 。 値 の 取得 も 可能 です 。 また 、 プレースホルダ として 使う 文字 を 設定 し ます 。 値 の 取得 も 可能 です 。 解説 PasswordChar プロパティ は ダイアログ ボックス で パスワード の 入力 を 受け付ける インターフェイス を 作成 する ため に 使い ます 。 任意 の 文字 を 使用 でき ます が 、 ほとんど の Windows 用 アプリケーション で は アスタリスク (*) ( Chr ( 42 )) が 使わ れ て い ます 。 PasswordChar プロパティ は Text プロパティ に は 影響 を 与え ませ ん 。 Text プロパティ に は ユーザー が 入力 し た とおり の 文字列 、 または 、 あらかじめ プログラム で 設定 し た 文字列 が 格納 さ れ ます 。 入力 し た とおり の 文字列 を 表示 する に は PasswordChar プロパティ を 長さ 0 の 文字列 ("") に 設定 し ます 。 既定 値 は 長さ 0 の 文字列 です 。 この プロパティ に は 任意 の 文字列 が 代入 可能 です が 、 1 バイト 目 だけ が 有効 です 。 2 バイト 目 以降 は 無視 さ れ ます 。 メモ MultiLine プロパティ に 真 ( True ) を 設定 する と 、 PasswordChar プロパティ は 無効 に なり ます 。 
VBA なら クラス の メソッド だろ う が Sub だろ う が Function だろ う が 、 複数 の 引数 の 扱い 方 は 同じ です が 、 何 が 知り たい の でしょ う か ？ 
ボタン の 種類 が 図形 な の か ActiveX コントロール の コマンド ボタン に な の か わかり ませ ん が 、 図形 に 登録 する の でし たら ―― Sub Tesr () Dim cnt As Integer cnt = ActiveWorkbook .S heets . Count Sheets (" 原本 "). Copy After := Sheets ( cnt ) ActiveSheet . Name = Format ( Now , " yyyymmdd ") End Sub 
hoijujdhuoshdo さん 、 こんばんは 。 ファイル 名 に 連 番 を 付け たい の なら ば 、 まず 連 番 の 何 番目 まで 使用済み か 、 検索 し て 、 その 次 の 番号 を 取得 する の が 常道 か と 思い ます 。 また 、 連 番 前提 なら ば 、 １ 番目 の ファイル から 連 番 番号 を 付け て おく方 が 、 後々 検索 など が し 易く て よい と 思い ます 。 ( 下 の 例題 コード は 、 連 番 が ( 1 ) から スタート し て いる もの と し て い ます 。 ） ３ 番目 の Macro 1 () コード を ベース に 書い て みる と 、 = = = = = = = = = = = = = = ========================= fileName = "【" & Range (" M3 ") & "】" & Range (" C3 ") & "【" & n & "】" ' ファイル 名 作成 ' If MsgBox ( fileName & " で 保存 し ます か ？", vbYesNo ) <> vbYes Then Exit Sub ' 保存 する か 確認 し て 保存 し ない 場合 は 終了 ActiveWorkbook .S aveAs " c :\ TES T2 \" & fileName If IsError ( fileName ) Then Else ActiveWorkbook .S aveAs " c :\ TES T2 \" & fileName & "(" & CStr ( i ) & ")" ' 指定 フォルダ に 保存 i = i + 1 End If = = = = = = = = = = = = = = ========================= の 部分 を 修正 し ます 。 = = = = = = = = = = = = = = ========================= fileName = "【" & Range (" M3 ") & "】" & Range (" C3 ") & "【" & n & "】" ' ファイル 名 作成 i = 1 ' Dir 関数 で ファイル の 存在 を 検索 する 。 Do While Dir (" c :\ TES T2 \" & fileName & "(" & CStr ( i ) & "). xls *") <> "" i = i + 1 Loop ' ループ を 抜け た 後 の i は 、 存在 する 連 番 の 最大 値 + 1 の 値 に なっ て いる 。 ActiveWorkbook .S aveAs " c :\ TES T2 \" & fileName & "(" & CStr ( i ) & ")" ' 指定 フォルダ に 保存 = = = = = = = = = = = = = = ========================= こんな 感じ で どう です か ？ 
> マクロ の 記録 を し た ところ 、 シート 名 を 全て 記述 し た 上 で PDF 化 する コード に なり まし た この 部分 も マクロ で やり ます 。 Sub Sample () Dim ara As Variant Dim i As Integer Dim sh _ s As Integer Dim sh _ e As Integer sh _ s = Sheets (" 表紙 "). Index sh _ e = Sheets (" 裏表紙 "). Index ReDim ara ( sh _ s To sh _ e ) For i = sh _ s To sh _ e ara ( i ) = Sheets ( i ). Name Next Sheets ( ara ). Select ActiveSheet . ExportAsFixedFormat Type := xlTypePDF , _ Filename :=" C :\ Sample \ Sample . pdf ", _ OpenAfterPublish := True End Sub エラー 処理 は 入れ て い ませ ん ので 。 
質問者 の 別 アカ です 。 自己 解決 し まし た 。 shp . TextFrame . Characters (" あいうえお " が 見つかっ た 位置 、 " ＡＢＣＤＥ " の 長さ ）. Text = " ＡＢＣＤＥ " で うまく いき まし た 。 文字列 が 見つかっ た 位置 は InStr ( Buf , " あいうえお ") で 取得 でき ます 。 
DY 4 に 入っ た 関数 を 見 まし た か ? = AVERAGEIFS ( S3 : MaxRow , S3 : MaxRow ,"> 0 ") 最低 で も Cells ( 4 , 129 ). Formula = "= AVERAGEIFS ( S3 :" & MaxRow & ", S3 :" & MaxRow & ",""> 0 "")" と 変数 は "" の 外 に 書く べき でしょ う 。 それ と Dim MaxRow As long MaxRow = Cells ( Rows . Count , 1 ). End ( xlUp ). Row として 、 Cells ( 4 , 129 ). Formula = "= AVERAGEIFS ( S3 : S " & MaxRow & ", S3 : S " & MaxRow & ",""> 0 "")" と initial 部分 は 省略 、 式 に 組み込ん で しまっ て も よろしい の で は 。 F8 キー で ステップ 実行 し ながら 格納 さ れ て いる 変数 を マウスオン で 確認 し て み て ください 。 
Sub 抽出 3 () Range (" A 2 "). AutoFilterActiveSheet . Range ("$ A $3 :$ A $200 00 "). AutoFilter Field := 1 , _ Criteria 1 :=">=" & CDate ( Worksheets (" Sheet 2 "). Cells ( 1 , " B "). Value ), _ Operator := xlAnd , Criteria 2 :="<" & CDate ( Worksheets (" Sheet 2 "). Cells ( 2 , " B "). Value ) + 1 End Sub Sheet 2 の B 1 と B2 に 開始 日 、 終了 日 を 入力 し ます 。 終了 日 は 実際 に は 終了 日 の 翌日 0 : 00 未満 で 抽出 し ます 。 テスト し て ない から 間違え て たら ごめんなさい 。 フィルタ を 使い たく ない という の は 前後 の 文脈 から 「 フィルタ の Criteria に 直接 日付 入力 は し たく ない 」 に 取り まし た が ？ 
この 様に やる と 、 きれい に 線 が 引け ます 。 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ------------------------- Public Class Form 1 Private g As Graphics Private pen 1 As Pen = New Pen ( Color . Red , 10 ) Private startX As Integer Private startY As Integer Private Sub Form 1 _ Load ( sender As Object , e As EventArgs ) Handles MyBase . Load PictureBox 1 . Image = New Bitmap ( PictureBox 1 . ClientSize . Width , PictureBox 1 . ClientSize . Height ) g = Graphics . FromImage ( PictureBox 1 . Image ) End Sub Private Sub PictureBox 1 _ MouseDown ( sender As Object , e As MouseEventArgs ) Handles PictureBox 1 . MouseDown startX = e . X ' 始点 座標 X startY = e . Y ' 始点 座標 Y If e . Button = MouseButtons . Left Then g . FillEllipse ( Brushes . Red , e . X - 5 , e . Y - 5 , 10 , 10 ) End If PictureBox 1 . Refresh () End Sub Private Sub PictureBox 1 _ MouseMove ( sender As Object , e As MouseEventArgs ) Handles PictureBox 1 . MouseMove If e . Button = MouseButtons . Left Then g . DrawLine ( pen 1 , startX , startY , e . X , e . Y ) pen 1 .S tartCap = System . Drawing . Draw in g2 D.L ineCap . Round pen 1 . EndCap = System . Drawing . Draw in g2 D.L ineCap . Round g .S moothingMode = Drawing 2D .S moothingMode . AntiAlias End If PictureBox 1 . Refresh () startX = e . X startY = e . Y End Sub End Class - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ------------------------- 
Union で 時間 が かかっ て いる よう です 。 直接 削除 し て いっ た方 が 断然 速かっ た 。 Sub sample () Dim i As Long Dim MaxRow As Long Debug . Print Time $ MaxRow = Cells ( Rows . Count , 1 ). End ( xlUp ). Row MaxRow = MaxRow + Application . IsEven ( MaxRow ) For i = MaxRow To 3 Step - 2 Rows ( i ). Delete Next i Debug . Print Time $ End Sub １ 万 行 の データ で テスト 直接 削除 で 約 ２ 秒 Union し て から 削除 なら 約 ２ 分 。 
tutu 6464 さん 、 こんにちは。 お 書き の コード で は 、 Private Sub 名前 で 検索 _ Click () で プロシージャ が 宣言 さ れ て い ます が 、 これ に 対応 する End Sub が 記述 さ れ て い ない こと が 原因 です ね 。 
kyuusyuu 63 さん 、 こんにちは。 MergeCells プロパティ は 、 値 の 参照 も 設定 も できる プロパティ です 。 お 書き の コード で は 、 Range (…). MergeCells = True と 代入 文 形式 に なっ て いる ので 、 参照 で なく 設定 と 認識 さ れ ます 。 もし プロパティ が True か どう か を 判断 し たい なら ば 、 If 文 で If Range (…). MergeCells = True Then と すれ ば 、 等号 は 論理式 として 扱わ れ 、 プロパティ は 参照 と 認識 さ れ て 、 True と 比較 し て くれ ます 。 
1 行 の 中 に 「 Range オブジェクト から の Find メソッド 」 「 Row プロパティ 」 と 、 2つ の 要素 が 含ま れ て いる 為 、 エラー が 分かり にくく なっ て い ます 。 作っ て いる 途中 は 、 こう いっ た 「 まとめ 記述 」 は 避け た 方 が 無難 です 。 この 場合 の エラー は 、 見つから なかっ た のに 「 Row プロパティ 」 を 参照 しよ う と し た こと でしょ う 。 Set fnd = Worksheets (" sheet 1 "). Range (" B : B "). Find ( i ) If ( fnd Is Nothing ) Then Msgbox " 見つかり ませ ん " Else N = fnd . Row End If こんな 感じ で 、 見つから なかっ た 場合 の こと も 考え て おき ます 。 On Error 構文 も 時として 便利 です が 、 他 の エラー が 分から なく なる ので 、 最後 の 最後 に 取っ て おい た 方 が 良い でしょ う 。 
参考 に どうぞ http:// www . access club .jp / samplefile / samplefile _ 249 . htm 
普通に コンパイル 通り まし た よ 。 EXCEL の マクロ です よ ね 。 Sub hoge () Dim x As Long Dim i As Long With ActiveSheet x = . UsedRange . Cells (. UsedRange . Count ). Column For i = x To 1 Step - 1 If Application . CountA (. Columns ( i )) = 0 Then . Columns ( i ). Delete Next End With End Sub 
以下 で どう なり ます か ご 質問 内容 で おかしな ？ ところ が あっ た ので ･･･ > この sheet 1 の 内容 を A ～ E まで が 完全 に 重複 し て いる もの A , B , D , E と H ( 仕入 価格 ) で 文字列 を 作り 一致 する か ･･･ に 変更 同じ 商品 で も 仕入 価格 が 異なる と ･･･？ 仕入 価格 × 売上 数量 など 、 おかしく ･･･？ 処理 として は 、 この 文字列 で 前 詰 し て 、 どこ の 行 に 詰め た か を Dictionary 管理 > 足し 合わせ て 仕入 価格 以外 の F , G , I , J の 所 を 足し 合わせる 修正 ・ 変更 し やすい よう に ベタ で 処理 し て み まし た 結果 は 新規 シート に ･･･ Public Sub Samp 1 ()     Dim dic As Object     Dim vA As Variant     Dim sS As String     Dim i As Long , j As Long , k As Long , n As Long     Const CSEP As String = vbTab     Const CWIDTH As Long = 10     Set dic = CreateObject (" Scripting . Dictionary ")     With Worksheets (" Sheet 1 ")        With . Range (" A1 ", . Cells ( Rows . Count , " A "). End ( xlUp ))           vA = . Resize (, CWIDTH ). Value        End With     End With     k = 1     For i = 2 To UBound ( vA )        sS = ""        For j = 1 To 8           Select Case j              Case 1 , 2 , 4 , 5 , 8 ' 一致 判別 用 文字列 を 作る 列 指定                 sS = sS & vA ( i , j ) & CSEP           End Select        Next        n = dic ( sS )        If ( n > 0 ) Then           For j = 6 To CWIDTH              Select Case j                 Case 6 , 7 , 9 , 10 ' 足し 合わせる 列 指定                    vA ( n , j ) = vA ( n , j ) + vA ( i , j )              End Select           Next        Else           k = k + 1           n = k           dic ( sS ) = n           For j = 1 To CWIDTH              vA ( n , j ) = vA ( i , j )           Next        End If     Next     Application .S creenUpdating = False     With Worksheets . Add        With . Range (" A1 "). Resize ( k , CWIDTH )           . Value = vA           For j = 5 To 1 Step - 1              If ( j <> 3 ) Then                 .S ort . Cells ( j ), xlAscending , Header := xlYes              End If           Next        End With     End With     Application .S creenUpdating = True     Set dic = Nothing End Sub 
> Visual Basic の 問題 です 。 Visual Basic の バージョン （ 種類 ） が 分かり ませ ん 。 Visual Basic の バージョン （ 種類 ） によって 書き方 が 違い ます 。 > わから ない ので 、 どなた か 教え て ください 。 どこ が 分から ない の でしょ う か ？ あなた 自身 で やっ て み て 、 分から ない 部分 を ピンポイント で 質問 し ましょ う 。 問題 を 丸投げ だ と 、 永久 に プログラム でき ませ ん 。 ほとんど 問題 文 が 答え に なっ て い ます 。 IF 分 など を 使っ て 、 問題 文 通り に 判定 すれ ば 良い か と 思い ます 。 
２ 点 とも 修正 点 が 多 すぎ て ここ で やり取り できる 範疇 を 超え て い ます 。 エクセル 自体 を Yahoo!ボックス など に アップロード 出来る の なら 回答 出来る かも しれ ませ ん 。 
実際 に は A 列 と B 列 に は どんな 値 が 入っ て いる の です か 。 たぶん C 列 に シート 関数 の SUMIFS を COUNTIFS で 割る 式 を 入れる と 手動 でも できる と 思い ます が 、 その 式 を VBA で 設定 し て あげる と 求める もの は できる と 思い ます 。 場合 によって は Dictionary オブジェクト を 使っ て ループ で 求める 方法 も 考え られる と 思い ます 。 それ と 、 データ が 0 . 1 秒 刻み の 時 > この とき 0 ~ 30 秒 、 30 . 1 秒 ~ 60 秒 、 60 . 1 秒 ~ 90 秒 ・ ・ ・ ・ と あり ます が 、 > この とき 0 ~ 29 . 9 秒 、 30 秒 ~ 59 . 9 秒 、 60 秒 ~ 89 . 9 秒 ・ ・ ・ ・ が 一般的 だ と 思う の です が 、 質問 の 区切り 方 が いい の でしょ う か 。 
> Visual Basic の 問題 です 。 Visual Basic の バージョン （ 種類 ） が 分かり ませ ん 。 Visual Basic の バージョン （ 種類 ） によって 書き方 が 違い ます 。 > わから ない ので 、 どなた か 教え て ください 。 どこ が 分から ない の でしょ う か ？ あなた 自身 で やっ て み て 、 分から ない 部分 を ピンポイント で 質問 し ましょ う 。 問題 を 丸投げ だ と 、 永久 に プログラム でき ませ ん 。 ほとんど 問題 文 が 答え に なっ て い ます 。 IF 分 など を 使っ て 、 問題 文 通り に 判定 すれ ば 良い か と 思い ます 。 If 条件 Then （ 偶数 ） Else （ 奇数 ） End If 
「 期間 」 と いい ながら 日付 を １ 日 だけ 入力 さ せる の は 仕様です か ？ また 日付 の ある 列 が ４ 列 目 な の は 自明 です が 、 それでも 列 番号 を 入力 さ せる の は ？ しかも それ で 変数 に 列 数 を 入れ ながら その 変数 を 使わ ず Field := 3 と 日付 の ない 列 を 指定 する の は 嫌がらせ です か ？ 
ID 非公開 さん ウインドウ の プログラム で 重要 な こと は CPU を 解放 し て やる こと 。 普通 の 書き方 int times ;// 外部 変数 1 . ボタン Start time の 関数 から 今 の 時刻 を 取り 、 変数 ( 例 times ) に 代入 し 、 終了 。 ( CPU を 解放 ) 2 . ボタン Stop time の 関数 から 今 の 時刻 を 取り 、 時間 = 今 の 時刻 - times 表示 し て 、 終了 。 ( CPU を 解放 ) 
「 oracle 外部 結合 」 で 検索 。 http:// www .s hift - the - oracle . com / sql / left - right - outer - join . html http:// www . oracle . com / tech network / jp / articles / otnj - sql - image 1 - 30862 ... A テーブル に 有っ て 、 B テー 部 に 無い （ 無い 場合 は 空白 ） の 結合 です 。 ① WHERE 句 で 「 部門 マスタ . 担当者 コード = 担当者 マスタ 担当者 コード (+)」 ② FROM 句 で 、 「 LEFT OUTER JOIN 」 など を 使い ます 。 詳しく は サイト の 解説 を 読ん で 下さい 。 
Debug じゃなくて Release を 使っ て み て ください 。 参考 http:// d . hatena . ne.jp / tekk / 20120524 / 1337873495 
Sub 加算 () Dim 答 As Long Dim I As Long For I = 1 to 10 ' 10回 処理 を 繰り返し ます 。 答 = 答 + I Next End Sub これ は 、 １ から 10 まで 順に 加算 し 、 加算 の 結果 は 、 " 答 " に 入り ます 。 最初 、 " 答 " に は 、 初期 状態 として ゼロ が 設定 さ れ て い ます 。 1回 目 答 = 答 + 1 ' この 処理 の 結果 → 答 = 1 2回 目 答 = 答 + 2 ' この 処理 の 結果 結果 → 答 = 3 という こと で 、 １ から 10 まで 加算 し た こと に なり ます 。 答 = 55 Dim ～ の 意味 、 For ～ の 意味 を しっかり 理解 し ましょ う 。 意味 が 解ら ない 場合 、 VBA の 入門書 など を 読み ましょ う 。 
まず 、 自分 で 作成 を 試み て 、 分から ない 部分 を 質問 し て ください 。 これ で は まるで 仕事 の 依頼 です ( しかも 無償 で )。 まるっきり 、 取っ掛 かり が 掴め ない の でし たら 、 欲張ら ず 、 1つ ずつ 分から ない 点 を 明らか に する よう に 、 順番 に 分け て 質問 し て ください 。 
> どういう 順番 で 実行 さ れる の でしょ う か 。 順番 と は ？ 標準 モジュール は 、 共有 な 変数 、 定数 、 イベント で は 無い Sub や Function を 書い て 、 プロジェクト 全体 で 使い ます 。 何度も 使う よう な 処理 を 標準 モジュール に 書い て 、 その 都度 コール し て 使い ます 。 ※ 使い方 は 人 それぞれ です が ・ ・ 
こんにちは。 Sub aaa () Dim Path As String Path = " C :\ Users \ ユーザー \ Desktop \*.*" myFileList = "" myFile = Dir ( Path ) Do While myFile <> "" If Right ( myFile , 3 ) = " lnk " Then Else myFileList = myFileList & Chr ( 13 ) & myFile End If myFile = Dir () Loop MsgBox myFileList End Sub こんな かんじ です チェックボックス が 、 と いう と 、 使う コントロール を 複雑 に する 必要 が あり ます 。 1 ) シート に リストアップ 2 ) 特定 の セル に 入力 さ せ て 、 その 部分 を 使っ て 、 主 様 の し たい こと を し て ください 
記述 の 仕方 が 判ら ない のに その 値 を なぜ 変えれ ば 治る と 判断 が 付い た ん でしょ う か ？ もし web 上 に 有っ た 資料 で あれ ば 、 その ページ に 書い て なかっ た ん でしょ う か ？ さらに 言え ば 、 WindowlessVideo って 何 の プロパティ な ん でしょ う ？ その オブジェクト は Excel の VBA から 操作 でき て いる ん でしょ う か ？ 
※ 補足 し なく て も 分かり まし た よ 。 回答 です 。 いやあ 苦労 し まし た 。 多分 バッチリ です 。 ただ 数式 、 た ー くさん あり ます 。 AE 2 : 国語 AE 3 : 算数 AE 4 : 理科 AE 5 : 社会 AF 2 : 10 AF 3 : 20 AF 4:3 0 AF 5 : 40 AG 2 : Ａ AG 3 : Ｂ AG 4 : Ｃ AH 2 : 1 AH 3 : 2 AH 4:3 K2 := IFERROR ( MATCH ( ROW ( A1 ), A : A , 0 ),"") L 2 := IF ($ K2 ="","", INDEX ( C : C ,$ K2 , 1 )) M2 := IF ($ K2 ="","", INDEX ( D : D ,$ K2 , 1 )) N2 := IF ( L 2 ="","", INDEX ( AF : AF , MATCH ( L 2 , AE : AE , 0 ), 1 )) O2 := IF ( M2 ="","", INDEX ( AH : AH , MATCH ( M2 , AG : AG , 0 ), 1 )) P2 := IFERROR ( N2 + O2 +( 1 - 1 / ROW ()),"") Q2 := IF ( P2 ="","", RANK ( P2 , P : P , 1 )) R2 := IF ( Q2 ="","", MATCH ( ROW ( A1 ), Q : Q , 0 )) S2 := IF ( R2 ="","", INDEX ( K : K , R2 , 1 )) T2 := IF ($ S2 ="","", INDEX ( A : A ,$ S2 , 1 )) U2 := IF ( T2 ="","", COUNTIF ( A : A , T2 )) これら を 下方 へ 、 空白 が 出る まで ドラグコピー し ます 。 V2 : 1 V3 := IF ( U3 ="","", U2 + V2 ) これ を 下方 へ 、 空白 が 出る まで ドラグコピー し ます 。 W 2 := COUNTIF ( V : V , ROW ( A1 )) X 2 := IF ( W 2 = 1 , ROW ( A1 ), X1 ) Y 2 := MATCH ( X 2 , V : V , 0 ) Z 2 := INDEX ( T : T , Y 2 , 1 ) AA 2 := IF ( Z 1 = Z 2 , AA 1 + 0 . 001 , Z 2 ) AB 2 := IF ( A1 = A 2 , AB 1 + 0 . 001 , A 2 ) AC 2 := MATCH ( AA 2 , AB : AB , 0 ) これら を 下方 へ 、 データ の 有る 行 まで ドラグコピー し ます 。 F2 := INDEX ( A : A ,$ AC 2 , 1 ) これ を 、 右 方 は I 2 、 下方 は データ の 有る 行 まで ドラグコピー し ます 。 ↓ 作業 列 の 画像 です 。 
Selection . Paste ↓ Selection . Pastespecial もしくは 、 Activesheet . Paste 
サンプル です 。 AA 列 に 【 文字 】 が 入っ て いる 場合 、 Exit Sub で 処理 抜け を し ます 。 次 の 行 : MsgBox "" は 実行 さ れ ませ ん 。 ※ 数値 が 入っ て いる 場合 は 処理 抜け を し ませ ん 。 Sub sample 1 () Dim flg flg = WorksheetFunction . CountIf ( Range (" aa : aa "), "*") If flg > 0 Then Exit Sub MsgBox "" End Sub - - - - - - - - - - - - - ------------------------- 【 文字 または 数値 】 が 入っ て いる 場合 に 処理 抜け を する に は Sub sa mpl e2 () Dim flg flg = WorksheetFunction . CountIf ( Range (" aa : aa "), "*") flg = flg + WorksheetFunction . CountIf ( Range (" aa : aa "), ">=" & 0 ) flg = flg + WorksheetFunction . CountIf ( Range (" aa : aa "), "<" & 0 ) If flg > 0 Then Exit Sub MsgBox "" End Sub 
Sub Test () Range ( Cells ( 6 ," M "), Cells ( 1000 ," M ")). Formula ="= M6 に 書く べき 関数 式 " End Sub M6 に 数式 を 記入 し 、 掴ん で 下 まで 引っ張る の と 同じ 操作 です 。 もちろん 保護 は 事前 に 解除 する 必要 が あり ます 。 
こんにちは。 Range (" A1 "). Interior . Color として み て 下さい 。 
＞① Ｂ 列 を 基準 に 上 から 下 に 向かっ て 最下 行 を 取得 し 、 データ 範囲 これ で やっ た として も 、 データ が 増え たら 「 データソース の 変更 」 が 必要 に なっ て しまい 面倒 です 。 ピボットテーブル を 作る 前 に データソース を 「 テーブル 」 に し て しまえ ば 、 ActiveWorkbook . PivotCaches . Create ( SourceType := xlDatabase , SourceData := " テーブル 1 ", ・ ・ ・ という 形 で ピボットテーブル が でき ます 。 こう する と 、 デー タ行 が 増減 し て も 「 データソース の 変更 」 を やる 必要 は あり ませ ん 。 一度 、 データ 部分 を テーブル に し て から マクロ 記録 し て み て は どうでしょう か 。 
こんにちは。 outlook の 制御 の 場合 、 1 ) コード の 編集 から 、 コード を 直接 入力 2 ) outlook 用 の アドインファイル を 作成 し 、 それ を インストール 3 ) outlook の 外部 に ある vbscript として 配布 ぐらい の 方法 が あり ます 。 配布 する 範囲 と 管理 が 必要 な の か 、 など 、 あり そう です が 、 「 差し替え の 対応 」 など の 部分 まで 、 考え て 、 一番 いい 方法 を 探し て ください 。 パスワード が 絡む と 、 方法 の 選択 は 狭い です ね 1 ) はき え ます 。 
考え方 として は 、 ・ 数 直線 上 を 移動 する ので 、 初期 値 0 として ランダム で 1 を 足し たり 引い たり し た 結果 が 、 そのまま 動い た 先 の 位置 と 考え られる 。 ・ 1 分 後 という の は 1回 後 と 捉え 、 60 分 後 は 60回 、 ランダム に 1 を 足し 引き し た 結果 と 考える 。 ・ 上記 を 行なっ た 結果 を 1回 、 これ を 100回 試行 し 、 結果 の 平均値 を 計算 する 。 という こと に なる の です が 、 課題 として 出さ れ て いる の が 問題 です 。 どこ まで 自由度 が ある の でしょ う か 。 好き に 組ん で 良い の で あれ ば 、 どう に でも できる と 思い ます 。 しかし 、 どこ まで の 知識 を 用い て 良い の か が 分から ない 状態 で は 、 具体 的 な コード は 示し にくい です 。 何 か 制限 が あれ ば 、 返信 を お願い し ます 。 
システム に 求める もの が 何 か は わかり ませ ん が 、 残業 を 管理 する なら 加算 し て いく の で は なく 、 日毎 に 行っ た 残業 時間 を データ として 蓄積 する もの な の で は ？ 質問 の 《 社員 を 切り替える 》 と は 何 な の かも 回答者 に は わかり ませ ん よ ね ？ 途中 まで に しろ で き た 物 を 目 の 前 に さ れ て いる 質問者 さん と は 違う 訳 です し 保存 も 含め た なら Excel を 使っ た 方 が 楽 な 気 が し て き まし た けど ね 
こんにちは。 どう し たら 、 どう し た もん か の ーー まず 、 visio で 、 自動 記録 を 試し て ください 。 記録 を 開始 し 、 ターゲット の 部品 を 選択 少し 位置 を ずらす 、 すぐ に 、 記録 は 停止 は やっ て み て 、 どんな コード が 出来る か です 。 そしたら 、 部品 の 選択 に 使っ て いる 文字列 を 、 エクセル の 文字列 に する だけ で いい こと に なり ます 。 エクセル の セル を 読込み する の は 、 set xls = create object (" excel . application ") xls . visible = true xls . open " 入っ て いる ファイル の パス " set sh = xls . activeworkbook .s heets (" データ の ある シート ") 名前 = sh . Range (" A1 "). value 数値 = sh . Range (" B 1 "). value これ で 、 名前 と 数値 は 読込み でき ます 。 データ が 複数 なら 、 for next で 行 を 指定 し たら いい です 
コード 例 です 。 検索 し たい 文字列 は Array の 引数 に 列挙 し て ください 。 検索 シート と 結果 出力 シート は 実際 の シート 名 に 書き換え て ください 。 Sub Sample () Dim Sht 1 As Worksheet Dim Sh t2 As Worksheet Dim Row As Long Dim i As Long Dim Keywords As Variant Set Sht 1 = Worksheets (" Sheet 1 ") '← 検索対象 シート Set Sh t2 = Worksheets (" Sheet 2 ") '← 結果 出力 シート Keywords = Array (" 特定 文字列 1 ", " 特定 文字列 2 ", " 特定 文字列 3 ") '← 検索 し たい 文字列 を 列挙 For i = 1 To UBound ( Keywords ) For Row = 1 To Sht 1 . Cells ( Rows . Count , " A "). End ( xlUp ). Row If InStr ( Sht 1 . Cells ( Row , " A "). Value , Keywords ( i )) = 1 Then Sh t2 . Cells ( Rows . Count , i ). End ( xlUp ). Offset ( 1 ). Value = Sht 1 . Cells ( Row , " B "). Value End If Next Next End Sub 
GetSaveAsFilename を 使う http:// vba - geek .jp / blog - entry - 200 . html とか 
本当に 上記 の マクロ を 実行 し て い ます か ？ 上記 の マクロ は 「 現在 アクティブ な ブック を 年月日 時分 . csv という 名前 で 保存 し て 閉じる 」 という マクロ です から 、 マクロ に 構文 が 勝手 に 追加 さ れる こと は 絶対 に 有り得 ない です 。 
前回 は 、 間違え て テスト 中 の もの を 上げ て しまい まし た 。 ipl _ is _ loading さん の 答え でも いい の です が 、 いちいち ファイル を 開い て いる ので 、 実行 速度 に 問題 が ある 可能性 が あり ます 。 私 の 答え を 直し た もの を 載せ ます 。 どっち が 早い か は やっ て み なけれ ば わかり ませ ん 。 私 も 気 に なる ので 、 両方 やっ て み て 、 どっち が 早かっ た が 書い て いただけれ ば と 思い ます 。 ' Sub Macro 1 () ' Dim EndCell As Range Dim FileName As String Dim IX As Integer ' Application .S creenUpdating = False Set EndCell = Cells ( Rows . Count , Columns . Count ) Range ([ C1 ], EndCell ). ClearContents ' ChDrive Left ( ThisWorkbook . Path , 2 ) ChDir ThisWorkbook . Path FileName = Dir ("*. csv ") IX = 2 ' Do While FileName > "" IX = IX + 1 Macro 1 Loop FileName , IX FileName = Dir Loop ' End Sub ' Sub Macro 1 Loop ( FileName As String , IX As Integer ) ' Dim IX 2 As Integer Dim IY As Long Dim FileData As String ' ins = Len ( FileName ) Cells ( 1 , IX ) = Left ( FileName , ins - 4 ) Open FileName For Input As # 1 ' Line Input # 1 , FileData IY = 1 Do While Not EOF ( 1 ) IY = IY + 1 Line Input # 1 , FileData ins = InStrRev ( FileData , ",") ' If ins > 0 And ins < Len ( FileData ) Then Cells ( IY , IX ) = Mid ( FileData , ins + 1 ) End If Loop Close ' End Sub ' 
VBA の イミデイトウィンドウ や 、 適当 な 関数 作っ て CSng ( 8556805823 ) を 実行 し て み ましょ う 。 「 8 . 556806 E + 09 」 と 言う 、 指数 表示 さ れる 筈 です 。 それ を 有効 桁 数 の 一番 大きい Ccur くらい で もどし て み ましょ う 。 Ccur ( CSng ( 8556805823 )) さて 、 どう なり まし た か ね 。 犯人 は データ型 。 Single 型 を 用い て いる 事 だ と 思い ます 。 VBA は Microsoft が 出来 た 当初 から 浮動小数 点 型 （ Single や Double ） は 小数点 以下 を 正しく 表現 でき ない という 問題 が 有り ます 。 （ 2進法 で 表現 し て いる ので 、 小数点 以下 は 表現 でき ない パターン が 有る ん です ） Single 型 の 場合 、 基本的 に 整数 部 の 有効 桁 数 は 7 桁 です 。 それ 以上 の 場合 は 小数点 を ずらし て 記録 し ます 。 内部 的 に 「 8556805 . 823 * 1000 」 って 持っ てる ん です ね 。 です んで 、 再度 整数 に 戻す 前 に 先 ほど 挙げ た 小数点 以下 の 罠 が 発生 し て 整数 部 が 落ち ます 。 VBA で 正しく 数値 を 持と う と する なら 長 整数型 か 通貨 型 を お勧め し ます 。 小数点 以下 の 計算 は 事前 に 有効 桁 数 まで 繰り上げ た 整数 で 処理 する 事 を お勧め し ます 。 
こんにちは。 これ で 文字列 先頭 が 田中 で 始まる もの を 抽出 し ます 。 Sub Sample 1 () Range (" A6 "). AutoFilter Field := 1 , Criteria 1 :="=" & Range (" A 2 ") & "*" End Sub ちなみに 次 の コード は 、 とにかく 文字列 に 田中 が 含ま れる もの を 抽出 し ます 。 Sub Sample 2 () Range (" A6 "). AutoFilter Field := 1 , Criteria 1 :="=*" & Range (" A 2 ") & "*" End Sub 
直接 の 回答 で は 有り ませ ん 。 bat ファイル で できる 事 なら ＶＢＡ で 直接 できる と 思う の です が ？ 
C# から 、 VB に 変換 する の は 、 簡単 です 。 Free の ツール が あり ます 。 http:// www . tangiblesoftwaresolutions . com / Free _ Editions . html それ で 作っ た の が これ http:// nanco . tokyo / Class 1 . vb 
SUMIF 関数 や COUNTIF 関数 を 使え ば できる と 思い ます 。 これ 以上 の 回答 について は 、 ファイル を 添付 し て いただか ない と 画像 で は 細か すぎ て 無理 です 。 
他 ブック の データ を 参照 する 以上 、 そう なる の は 必然 な の か な と は 思い ます 。 オープン 時 に ブック １ を 開き 、 クローズ 時 に 両方 閉じる よう に し て おく の が 一般的 で は ない か な と 思い ます 。 
http:// note . chiebukuro . yahoo . co.jp / detail / n2 94285 ActiveWorkbook . Close で 、 見積 書 ブック を とじ ちゃっ てる から か な 。 
Copy で は なく 、 Move に 変え たら ？ 
If Not IsEmpty ( Ws . Range (" B 3 "). Value ) And IsNumeric ( Ws . Range (" B 3 "). Value ) Then で セル B 3 に 数字 が 入っ て いる か どう か を 判定 出来 ます 。 （ 空欄 は 「 数値 が 入っ て い ない 」 と 判断 さ れ ます ） 
普通 は 、 同じ 機能 を 持つ いくつ も の ボタン を キャプション を かえて 表示 し たり し なかっ たり という よう な 設計 は し ませ ん ね 。 コマンド ボタン は １つ 。 リスト ボックス に 「 〇 」 の 付い た データ を 表示 。 リスト ボックス は 、 複数 データ を 選択 できる ので 、 一括 処理 も 可能 といった 設計 じゃ ない です か ね 。 
ここ に コード 書く だけ だ と 分かり にくい か な と 思っ た んで サンプル 作っ て み まし た 。 よけれ ば ダウンロード し て ください 。 一応 コード 内 に 説明 記述 し て あり ます が 説明 下手 だ と 思う ので ご 了承 を m(_ _)m http:// yahoo .jp / box / f1 c 6 dW 
実は 結構 覚え なけれ ば なら ない 知識 が 沢山 ある ので 下記 の サイト を 参考 に し て 勉強 し て み て ください 。 「 WEB データ の 取得 方法 」 http:// excel - ubara . com / excel v ba5 / EXCELVBA 222 . html 
正確 に は SIer です か ね 。 システム開発 も 幅 が 広い ので 、 人 それぞれ だ と 思い ます が SIer って 言葉 を 聞く と 、 私 の イメージ で は イコール 、 プロジェクトマネージャー に なり ます 。 ユーザー の 要望 に対して コンピュータ を 使っ た ソリューション の 提案 を 行い 、 提案 し た システム を 具現 化 する ため 、 人 を まとめ て システム開発 を 遂行 さ せる よう な 人 な ので 、 王道 です が 、 経済産業省 の 情報処理試験 に ある 「 基本情報処理 」 「 プロジェクトマネージャー 」 など を 勉強 し て は いかが でしょ う か ？ 
結論 から 言え ば 、 作り直し に なり ます 。 Access は Excel と 違っ て 、 データ オリエンテッド の アプリケーション です から 、 テキストボックス を リスト ボックス や コンボボックス に 変更 する こと は 簡単 な の でしょ う 。 その ため に 「 コントロール の 機種変更 」 という 機能 も 用意 さ れ て いる もの だ と 思い ます 。 ところが Excel は いわば 自由 表 形式 です から 、 テキストボックス を 使っ た データ が コンボボックス で 入力 し たり 表示 し たり できる データ と は 限り ませ ん 。 逆 を 言え ば Excel の 方 が データ の 持ち 方 の 自由度 が 高い という こと でしょ う か 。 
下記 回答 に なっ て ない です ね 。 この よう な 回答 専門 な ん でしょ う ね 。 再度 、 質問 し た 方 が いい です ね 。 
先頭 2 文字 だっ たり 、 末尾 2 文字 だっ たり 、 中 に 2 文字 だっ たり 、 着目 する 場所 が 一定 し て ない ので 出来 ませ ん 。 何 か 統一 さ れ た 規則 性 は ない の です か ？ 例文 の 3 種類 だけ しか ない なら 可能 です 。 どこ でも いい から 連続 2 文字 が 一致 とか 。 Like の 使い方 If st r1 like " abc *" then ワイルドカード は 必ず like の 後ろ 
１ 行 目 、 ２ 行 目 の dim は どこ で 宣言 し て ます か ？ 提示 さ れ た コード を 実行 し まし たら 、 「 名前 が 適切 で あり ませ ん 」 エラー に なり ます 。 
Visual Studio Communty 2015 が 正常 に インストール 出来 て いれ ば ツールチップ は 表示 さ れる ハズ です が ？ 私 は これ まで に 色々 な バージョン の Visual Stuidio を 色々 な PC に 何 十 回 と インストール し て い ます が 、 ツールチップ が 表示 さ れ ない という 現象 を 見 た こと は あり ませ ん 。 
SPREAD for Windows Forms 8 . 0 J の ヘルプ を 読ん で 下さい 。 fp Spread _ ButtonClicked の イベント 引数 で ある EditorNotifyEventArgs クラス に は どの セル で イベント が 発生 し た か を 示す プロパティ が あり ます よ 。 Column エディタ が イベント を 発生 さ せ た セル の 列 インデックス を 取得 し ます 。 EditingControl イベント を 発生 さ せ た Control オブジェクト を 取得 し ます 。 Row エディタ が イベント を 発生 さ せ た セル の 行イン デックス を 取得 し ます 。 View エディタ が イベント を 発生 さ せ た セル を 含む ビュー を 取得 し ます 。 EditorNotifyEventArgs クラス メンバ http:// docs . grapecity . com / help / spread - winforms - 8 / FarPoint . Win .S prea ... 
http:// office tanaka .net / excel / vb a/t ips / tips 107 . htm https :// msdn . microsoft . com / ja - jp / library / cc 364490 . aspx 基本 的 な 使い方 は １つ め の 参照 URL 一 番 下 。 あなたが欲しい フォルダ が ある か どう か は 、 ２ こめ の 参照 URL 。 
こんな 感じ 。 Sub Rdel () Dim rc rc = Range (" A " & Rows . Count ). End ( xlUp ). Row Do Until rc = 0 With Range (" A " & rc ) If . Value = 1 Or . Value = 2 Then . EntireRow . Delete rc = rc - 1 End With Loop End Sub 
コード 例 です 。 日付 は Date 型 の 関数 に 入れ た ほう が 、 いろいろ と 処理 が 簡単 です よ 。 Dim myDate As Date Dim ErrorDate As Date myDate = DateSerial ( Left ( b , 4 ), Mid ( b , 5 , 2 ), Right ( b , 2 )) ErrorDate = DateSerial ( Year ( DateAdd (" d ", - 5 , Date )), Month ( DateAdd (" d ", - 5 , Date )), 0 ) If myDate <= ErrorDate Then MsgBox " エラーメッセージ " '← メッセージ 内容 は 適用 に 変え て ください 。 Exit Sub End If 
お 示し の プログラム は 、 尻切れ トンボ 。 な ので 、 示さ れ て いる 範囲 で の 議論 です 。 お 示し の もの を まとめ て 、 アクティブ な シート を 対象 に する と ↓ の よう な の が 一 例 。 Sub 売上 () Dim xRng As Range , xRng 10 As Range With ActiveSheet With . Range (" A5 : AP 75 ") Set xRng = . Cells Set xRng 10 = . Columns ( 10 ) End With xRng 10 . Copy xRng 10 . PasteSpecial Paste := xlPasteValues With .S ort .S ortFields . Clear .S ortFields . Add Key := xRng . Columns ( 10 ), SortOn := xlSortOnValues , _ Order := xlDescending , DataOption := xlSortNormal .S ortFields . Clear .S etRange xRng . Header = xlYes . MatchCase = False . Orientation = xlTopToBottom .S ortMethod = xlPinYin . Apply End With End With End Sub Worksheets (" 1 ")～ Worksheets (" 12 ") まで 、 一気に 面倒 見る なら ↓ 。 Sub main () Dim i As Long For i = 1 To 12 Call 売上 ( Worksheets ( CStr ( i ))) Next i End Sub Sub 売上 ( sh As Worksheet ) Dim xRng As Range , xRng 10 As Range With sh With . Range (" A5 : AP 75 ") Set xRng = . Cells Set xRng 10 = . Columns ( 10 ) End With xRng 10 . Copy xRng 10 . PasteSpecial Paste := xlPasteValues With .S ort .S ortFields . Clear .S ortFields . Add Key := xRng . Columns ( 10 ), SortOn := xlSortOnValues , _ Order := xlDescending , DataOption := xlSortNormal .S ortFields . Clear .S etRange xRng . Header = xlYes . MatchCase = False . Orientation = xlTopToBottom .S ortMethod = xlPinYin . Apply End With End With End Sub いずれ も 未 実行 。 不具合 ご 容赦 。 
下記 の コード でいか が でしょ う か 。 少し 長い コード に なり ます が 、 画像 名 の 異なる 画像 が 既に 張り付け られ て いる 時 は その 画像 を 一旦 削除 し 、 同じ 名前 の 画像 が 既に 張り付け られ て いる 時 は 新た に は 貼り 付け ない よう に 、 し て い ます 。 画像 フォルダ 名 は 適宜 変更 し て ください 。 Option Explicit Sub Sample () Const pic Folder As String = " C :\ Test " ' 適宜 変更 し て 下さい 。 Dim r As Long , filePath As String Dim pic As Shape , pasted As Boolean ' Excel の 再 描画 を 一時停止 する Application .S creenUpdating = False ' A 列 の ２ 行 目 から 最終 行 まで 繰り返す For r = 2 To Range (" A " & Rows . Count ). End ( xlUp ). Row With Range (" A " & r ) ' B 列 に 既に 画像 が 張り付け られ て いる か を チェック する pasted = False For Each pic In ActiveSheet .S hapes ' 既に 画像 が 張り付け られ て いる 場合 If pic . TopLeftCell . Address = . Offset (, 1 ). Address Then ' 代替 テキスト が A 列 の 内容 と 異なる とき は その 画像 を 一旦 削除 する If pic . Title <> . Value Then pic . Delete Else ' 代替 テキスト と A 列 の 内容 が 一致 し て いる とき ' 貼り 付け を スキップ する ため の フラグ を 設定 する pasted = True End If End If Next pic ' 画像 ファイル の フル パス 名 を 組み立てる filePath = pic Folder & "\" & . Value & ". tif " ' 画像 ファイル が 存在 し 、 貼り 付け を スキップ し ない とき If Dir ( filePath ) <> "" And pasted = False Then ' 画像 ファイル を B 列 に 張り付ける Set pic = ActiveSheet .S hapes . AddPicture ( Filename := filePath , _ LinkToFile := False , SaveWithDocument := True , _ Left :=. Offset (, 1 ). Left , Top :=. Offset (, 1 ). Top , _ Width := 60 , Height := 60 ) ' 貼り 付け た 画像 の 代替 テキスト を 設定 する pic . Title = . Value End If End With Next r ' Excel の 再 描画 を 再開 する Application .S creenUpdating = True End Sub 
Ret MsgBox ( strPhonetic & vbCrLf & vbCrLf … に = が ない です ね 。 Ret = MsgBox ( strPhonetic & vbCrLf & vbCrLf … です 。 Ret に は vbYes / vbNo / vbCancel ( 6 / 7 / 2 ) の どれ か が 入り ます 。 Ret = vbNo の とき 、 Application . GetPhonetic () が "" な ので 、 常に " 次 の 候補 は ありません " が 出る の で は ？ また 、 その あと に Exit Do が ある ので 、 Loop While Ret = vbNo の 意味 は ない の で は ？ … とりあえず 、 こんな ところ か と 。 。 。 。 。 。 。 。 。 。 。 。 。 なお 、 ここ は 英語 カテ です 。 コード が 英語 な ので 自動 だ と 英語 カテ に なり ます 。 上記 の 修正 を し て から プログラム 関連 ( VBA ) で 再 質問 し ましょ う 。 . . . ......................... I hope this help you. 
一 例 です 。 Sheet 2 に ボタン を 作成 し て 、 下 の コード を 登録 し て ください 。 Sub DataCount () Dim cnt As Integer With Worksheets (" Sheet 2 ") cnt = WorksheetFunction . CountA (. Range (. Cells ( 2 , " A "), . Cells ( Rows . Count , " A "))) If cnt = 0 Then MsgBox " データ は 0 件 です " Else MsgBox " データ は " & cnt & " 件 です 。 " End If End With End Sub 
こんばんは 。 提出 データ の 文字列 中 に 元 データ の 文字列 が 含ま れる 、 部分 一致 判定 で よい の で あれ ば 、 If 文 を If Instr ( 1 , w s2 . Cells ( j , 1 ). Value , ws . Cells ( 1 , 1 ). Value ) > 0 And ws . Cells ( 7 , 1 ) = w s2 . Cells ( j , 4 ) Then の よう に すれ ば よい と 思い ます 。 Instr () 関数 で 検索 すれ ば 、 セル 内 改行 が あっ て も 問題 なく 判断 し て くれ ます 。 
例えば ファイル は 既に 開い て あっ て 、 望み の 列 を 選択し マクロ 起動 すれ ば 削除 さ れる だけ とか 例えば フォルダ に 大量 の CSV が 保存 さ れ て い て 、 フォルダ 名 / 列 番号 / 保存 ファイル 名 を 選び マクロ 起動 すれ ば 次々 開い て 削除 し 保存 終了 とか 例えば 両者 の 中間 とか 使い勝手 に 応じ て いろいろ あり ます 。 そこ は あなた が 考える 部分 です ので 、 使い そう な 道具 を 書い て おき ます 。 ファイル を １ 個 指定 する fName = Application . GetOpneFileName (" Select File , *") ファイル を 開く Workbooks . open filename := fName ' フルパスファイル 名 セル 選択 さ れ た 列 を 削除 Selection . EntireColumn . Delete （ 例えば ） B 列 を 削除 Columns (" B "). Delete Columns ( 2 ). Delete アクティブ に なっ てる ブック を CSV ファイル として 保存 ActiveWorkbook .S aveAs Filename := fName , FileFormat := xlCSV フル パス CSV ファイル 名 の 末尾 に "_ 1 " を 付ける fName = Left ( fName , Len ( fName )- 4 ) & "_ 1 . CSV " アクティブ に なっ てる ブック を 保存 せ ず 閉じる （ メッセージ を 省略 ） Application . DisplayAlart = False ActiveWorkbook . close savechanges := False Application . DisplayAlart = True 文献 を 参照 する と 変数 の 型 宣言 Dim が あり ます が 、 慣れる まで は 無視 し て いい です 。 調べ 物 を する なら 、 Office 田中 、 moug が 有名 です 。 Google で コマンド 検索 する と 必ず ここ で ヒット し ます 。 
もしかして カカオトーク ？ 知恵袋 に カテ が あり ます よ 。 知恵袋 トップ > インターネット 、 通信 > コミュニケーション サービス > カカオトーク 
２ 元 １ 次 なら 簡単 に 決まっ て しまう ので 、 どう に でも なり そう な もの です が ・ ・ ・ まあ 、 適当 やっ て み まし た 。 ( x 00 でも 一 発 ) 計算 し て いる 値 を プロット で も すれ ば 意味 が わかる と 思い ます ' ' 連立方程式 を 解く ( ※ b 1 = 0 , b2 = 0 に は 未 対応 ) ' a1 * x + b 1 * y + c1 = 0 ' a 2 * x + b2 * y + c 2 = 0 ' Const a1 As Double = 1 Const b 1 As Double = 2 Const c1 As Double = 3 Const a 2 As Double = 2 Const b2 As Double = 3 Const c 2 As Double = 4 Function Y1 ( x As Double ) As Double Y1 = (- a1 * x - c1 ) / b 1 End Function Function Y 2 ( x As Double ) As Double Y 2 = (- a 2 * x - c 2 ) / b2 End Function Sub 解く () Dim x 0 As Double , dx As Double , x 00 As Double Dim y 01 As Double , y 02 As Double , dy 0 As Double Dim y1 1 As Double , y1 2 As Double , dy 1 As Double x 0 = 0 ' X 初期 値 , 何 でも いい dx = 1 ' X 増 分 , ０ 以外 ' 適当 な X で Y を 計算 y 01 = Y1 ( x 0 ) y 02 = Y 2 ( x 0 ) dy 0 = y 02 - y 01 ' さらに 、 適当 な X で Y を 計算 y1 1 = Y1 ( x 0 + d x ) y1 2 = Y 2 ( x 0 + d x ) dy 1 = y1 2 - y1 1 ' 重なる か ？ If dy 0 = 0 And dy 1 = 0 Then MsgBox " 解 は 無数 " Exit Sub End If ' 平行 か ？ If dy 0 = dy 1 Then MsgBox " 解 なし " Exit Sub End If ' X 解 x 0 = x 0 - dy 0 / ( dy 1 - dy 0 ) * dx ' - - - - - - - - - - - - ------------------------- ' ※ もし 、 x 0 = 0 , dx = 1 なら ' x 0 = - dy 0 / ( dy 1 - dy 0 ) ' = - ( Y 2 ( 0 )- Y1 ( 0 ))/(( Y 2 ( 1 )- Y1 ( 1 ))-( Y 2 ( 0 )- Y1 ( 0 ))) ' = (( c 2 / b2 )-( c1 / b 1 ))/((((- a 2 - c 2 )/ b2 )+(( a1 + c1 )/ b 1 ))+(( c 2 / b2 )-( c1 / b 1 ))) ' = ( c 2 * b 1 - c1 * b2 ) / ( a1 * b2 - a 2 * b 1 ) x 00 = ( c 2 * b 1 - c1 * b2 ) / ( a1 * b2 - a 2 * b 1 ) ' - - - - - - - - - - - - ------------------------- ' 出力 Debug . Print "(" & a1 & ")* X + (" & b 1 & ")* Y + (" & c1 & ") = 0 ･･･ ( 1 )" Debug . Print "(" & a 2 & ")* X + (" & b2 & ")* Y + (" & c 2 & ") = 0 ･･･ ( 2 )" Debug . Print " X = " & x 0 & " , " & " Y1 = " & Y1 ( x 0 ) Debug . Print " X = " & x 0 & " , " & " Y 2 = " & Y 2 ( x 0 ) Debug . Print " X = " & x 00 Debug . Print vbCrLf End Sub 
セル の 方 の 型 が 違う の で は あり ませ ん か ？ B 列 に " 2016 / 06 / 12 " と 見える セル が ある 場合 です 。 Sub sample () Dim Z As Worksheet Dim FoundCell 1 As Range Dim target _ date As String Set Z = ActiveSheet target _ date = " 2016 / 06 / 12 " ' 日付 型 で 検索 ( What := DateValue ( target _ date )) Set FoundCell 1 = Z . Columns (" B "). Find ( What := DateValue ( target _ date ), After := Cells ( 2 , 2 ), LookIn := xlValues , LookAt := xlPart , SearchOrder := xlByRows , SearchDirection := xlNext , MatchByte := False ) If FoundCell 1 Is Nothing Then MsgBox " 見つかり ませ ん " Else MsgBox FoundCell 1 . Address ( False , False ) End If ' 文字列 型 で 検索 ( What := target _ date ) Set FoundCell 1 = Z . Columns (" B "). Find ( What := target _ date , After := Cells ( 2 , 2 ), LookIn := xlValues , LookAt := xlPart , SearchOrder := xlByRows , SearchDirection := xlNext , MatchByte := False ) If FoundCell 1 Is Nothing Then MsgBox " 見つかり ませ ん " Else MsgBox FoundCell 1 . Address ( False , False ) End If End Sub 
コレクション から の 削除 は 後ろ から 、 が 定石 です 。 Sub test () Dim i As Integer Dim KeyWord As String KeyWord = " hoge " For i = Workbooks . Count To 1 Step - 1 MsgBox Workbooks ( i ). Name If Workbooks ( i ). Name Like "*" & KeyWord & "*" then Workbooks ( i ). Close End If Next End Sub 直 書き 。 間違っ て い たら 後免 。 
セル の アドレス と みなさ れる よう な シート 名 は NG です 。 回避 策 は ある か どう か ？ TransferSpreadsheet を 使わ ず に オートメーション で やれ ば 可能 です が 。 
実行 時 に 生成 ・ 配置 さ れ た では なく 、 実行 時 に 生成 ・ 配置 し た に なる と 思い ます よ ？ なので コントロール 名 は 生成 する 際 に つけ て あげ なきゃ なら ない し 、 配置 も どこ に する か は 指定 し なけれ ば なら ない と 思い ます 携帯 な ので 具体 的 回答 は 出来 ませ ん けど 、 動的 ・ コントロール 等 で 検索 する と 見つかる かも しれ ない 
下記 の コード は リスト ボックス に 営業所 名 ・ 期限 ・ 顧客 を 設定 し ます 。 Option Explicit Private Sub UserForm _ Initialize () ListBox 1 . ColumnCount = 3 ListBox 1 . ColumnWidths = " 2cm ; 3cm ; 2cm " End Sub Private Sub CommandButton 1 _ Click () Dim st 1 As Worksheet Dim Area As Range , FoundCell As Range , FirstAddress As String Dim Item As Variant Set st 1 = Worksheets (" Sheet 1 ") ' テキストボックス が 未 入力 なら メッセージ を 表示 し て 処理 を 終了 する If TextBox 1 . Text = "" Then MsgBox " データ を 入力 し て ください ！" Exit Sub End If ' セル を 検索 する Set Area = st 1 . Range (" A 2 : H " & st 1 . Range (" A " & Rows . Count ). End ( xlUp ). Row ) Set FoundCell = Area . Find ( What := TextBox 1 . Text , LookIn := xlValues ) ' 該当 セル が 見つから なけれ ば メッセージ を 表示 し て 処理 を 終了 する If FoundCell Is Nothing Then MsgBox " 見つかり ませ ん " Exit Sub End If ' リスト ボックス を クリア する ListBox 1 . Clear FirstAddress = FoundCell . Address Do With FoundCell ' 検索 結果 が 営業所 以外 の とき は スキップ する If . Column = 3 Or . Column = 5 Or . Column = 7 Then ' リスト ボックス に 営業所 名 ・ 期限 ・ 顧客 を 設定 する ListBox 1 . AddItem . Value ListBox 1 . List ( ListBox 1 . ListCount - 1 , 1 ) = . Offset (, 1 ). Value ListBox 1 . List ( ListBox 1 . ListCount - 1 , 2 ) = st 1 . Range (" B " & . Row ). Value End If End With ' 次 の セル を 検索 する Set FoundCell = Area . FindNext ( FoundCell ) Loop While Not FoundCell Is Nothing And FoundCell . Address <> FirstAddress End Sub 
× For l = k To n ○ For l = l To n 
これ で いかが でしょ う か ？ Sub MakeHiperLink () Const wkFolder = " C :\ A \" Const MaxLine = 1000 Dim wkSheet As Worksheet Dim sWk 1 As String Dim sWk 2 As String Dim sWk 3 As String Dim sWk 4 As String Dim sWk 5 As String Dim i As Integer Dim fso As Object Set fso = CreateObject (" Scripting . FileSystemObject ") Set wkSheet = Worksheets (" Sheet 1 ") For i = 1 To MaxLine sWk 1 = wkSheet . Range (" A " & i ). Value If sWk 1 <> "" Then sWk 4 = fso . GetBaseName ( sWk 1 ) & "*." sWk 4 = sWk 4 & fso . GetExtensionName ( sWk 1 ) sWk 5 = Dir ( wkFolder & sWk 4 ) If sWk 5 <> "" Then sWk 3 = "= HYPERLINK (""" & wkFolder sWk 3 = sWk 3 & sWk 5 & """,""" & sWk 5 & """)" wkSheet . Range (" B " & i ). Value = sWk 3 End If End If Next Set fso = Nothing End Sub 
可能 です 、 と は 答え られ ます が 、 あなた が 提示 し た 条件 が 不明瞭 すぎ て 、 実際 に どの よう な コード を 書け ば 実現 できる か は 回答 出来 ませ ん 。 コンボボックス は ユーザー フォーム 上 に ある の です か ？ それとも シート 上 に ある の です か ？ シート 上 に ある の なら 、 どの シート に ある の です か ？ コンボボックス に 設定 する 内容 は 「 倉庫 A-1 、 倉庫 A - 2 、 倉庫 A - 3 、 ・ ・ ・ 倉庫 F - 7 」 で 宜しい の です か ？ コンボボックス で 選択 し た とき の 貼り 付け の ルール が 上記 の ３つ だけ で は 判り ませ ん 。 一定 の ルール が ある の なら それ を 明示 し て ください 。 こちら が 想像 し なけれ ば なら ない 事 が 多く なる ほど 、 あなた が 望む 回答 から は かけ離れ た 回答 しか 得 られ ない こと に なり ます 。 
タイマー イベント を 使っ て データ を 常時監視 する の が 一般的 です 。 Powerpoint に タイマー イベント が 有る か どう か は 不勉強 で 存じ上げ ませ ん が 。 EXCEL に は 有り ます ね 。 例えば 、 PC １ で ボタン 操作 し た 時 、 PC 2 の 指定 フォルダ の （ テキスト で も なん でも いい ） ファイル を 更新 し て やる 。 PC 2 の アプリケーション は ( たとえば 1 秒 毎 に 処理 する ） タイマー 処理 により 、 その ファイル の 内容 を 確認 し て 表示 処理 など を する 。 こんな 感じ です 。 単純 に 言え ば 。 
エラーメッセージ は 何と 出 て い ます か ？ 
出来 ない こと は ありません が 、 Win32 API と C++ 言語 について の 深い 知識 が 必要 に なり ます 。 
なに を し たい の か よく 解っ て いせ ん が 、 一言 。 > 何故か 表 で は なく TRUE の 文字 が 表示 さ れ て しまい ます 。 を 回避 する の なら 、 CB 1 = Range (" A1 "). Current Region .S pecialCells ( xlCellTypeVisible ). Copy ↓ Set CB 1 = Range (" A1 "). Current Region .S pecialCells ( xlCellTypeVisible ) と すれ ば 、 上手く いく の かも しれ ませ ん 。 ただ 、 示さ れ た コード は 、 「 行 を クリア さ れ 、 表 に 飛び地 が でき た とき 、 コード 後半 部分 が 機能 し ない 」 という 致命 的 な 欠陥 が あり ます 。 Tokyo ＆ Shinagawa の 行 を 削除 し たい だけ なら 、 クリップボード 経由 など の 複雑 な こと を し ない で 簡単 な コード （ ↓ ） で 可能 です 。 Sub test 1 () With Worksheets (" Sheet 1 "). Range (" A1 "). Current Region . AutoFilter Field := 1 , Criteria 1 :=" Tokyo " . AutoFilter Field := 2 , Criteria 1 :=" Shinagawa " . Offset ( 1 ). Resize (. Rows . Count - 1 ). SpecialCells ( xlCellTypeVisible ). EntireRow . Delete . AutoFilter End With End Sub 
下記 を 標準 モジュール に 記載 し て 下さい 。 ' 起動 時 自動 実行 マクロ Sub Auto _ Open () Dim i As Long Dim j As Long Dim objITEM As Object Dim objIE As New InternetExplorer objIE . Visible = False objIE . navigate " http:// www . resonabank . co.jp / kojin / market / spotrate . html " ' 完全 に ページ が 表示 さ れる まで 待機 する Do While objIE . Busy = True Or objIE . ready State <> 4 DoEvents Loop Sheets ( 1 ). Select Range (" A1 "). Current Region . Offset ( 1 , 0 ). ClearContents i = 2 j = 1 For Each objITEM In objIE . document . getElementsByTagName (" td ") Cells ( i , j ) = objITEM . innerText j = j + 1 If j > 10 Then j = 1 i = i + 1 End If Next Call untilReady ( objIE ) objIE . Quit Set objITEM = Nothing Set objIE = Nothing MsgBox " 処理 完了 " End Sub Sub untilReady ( objIE As Object , Optional ByVal WaitTime As Integer = 10 ) Dim starttime As Date starttime = Now () Do While objIE . Busy = True Or objIE . ready State <> READYSTATE _ COMPLETE DoEvents If Now () > DateAdd (" S ", WaitTime , starttime ) Then Exit Do End If Loop Dim c As Range Sheets ( 2 ). Select Sheets ( 2 ). Cells ( Rows . Count , 1 ). End ( xlUp ). Select Set c = Selection c . Offset ( 1 , 0 ). Select Set c = Selection Sheets ( 1 ). Range (" C 2 "). Copy Sheets ( 2 ). Range ( c . Address ) End Sub 
こちら が 参考 に なる の で は ? [ SSIS ] Excel から 型 情報 を 意識 せ ず に 確実 に 読み込む 方法 http:// blog .s orceryforce .net /? p = 373 [ PRB ] DAO の OpenRecordset を 使用 する と Excel の 値 として NULL が 返さ れる https :// support . microsoft . com / ja - jp / kb / 194124 
>? DateDiff (" yyyy "," 2000 / 1 / 1 "," 2000 / 12 / 31 ") DateDiff は 指定 し た 2 つ の 日付 / 時刻 の 間隔 数 な ので 、 1 / 1 ～ 12 / 31 では 1年 に は なり ませ ん 。 時分 まで 意識 し て 。 2001 / 1 / 1 00 : 00 ～ 2001 / 12 / 31 00 : 00 と する と わかり やすい と 思い ます 。 | 1 / 1 .....| 1 / 2 ....|..................| 12 / 31 | | < - - - - - - ----------------------->| >? DateDiff (" yyyy "," 2000 / 1 / 1 "," 2001 / 1 / 1 ") で あれ ば 、 | 1 / 1 .....| 1 / 2 ....|..................| 12 / 31 ...| 1 / 1 ...| | < - - - - - - - - - - - - - - - - ----------------------->| 終わり 側 の 日付 に 意識的 に １ を 足し て やっ て は どうでしょう か ？ ? DateDiff (" yyyy ", CDate (" 2001 / 1 / 1 "), DateAdd (" d ", 1 , CDate (" 2001 / 12 / 31 "))) 
私 も エクセル に 慣れ て い て 苦労 する が デフォルト で Sheet 1 では なく シート 1 , という ところ で 躓き ます 。 （ それ 以外 に 考え られ ない ので ） = query (' シート 1 '! A 2 : AG , " select * where B like '% みかん %'") テスト し た の は みかん を 含む です 。 
iText Sharp を 使っ た 場合 は Exe だけ で なく itext sharp . xmlworker . dll も 必要 に なり ます 。 ライセンス について Exe について は 「 Debug 」 モード で コンパイル し た 実行 形式 の 配布 は Microsoft の ライセンス 違反 に なり ます 。 かならず 「 Release 」 モード で コンパイル し て 下さい 。 iText Sharp や iTextNet は Ver . 5 から は AGPL ライセンス が 適用 さ れ て い ます 。 AGPL ライセンス という の は 簡単 に 言え ば 「 ソースコード も 一緒に 配布 し なさい 」 という ライセンス です 。 です から Exe と Dll だけ を 配布 する こと は ライセンス 違反 に なり ます 。 
直接 の オート フィル で は 無理 な の が わかっ て いる と 思い ます し 数式 で 簡単 に できる はず です 。 何 でも VB 派 、 なら 数式 を コピー すれ ば ？ 数式 は A3 に =" aaa . bbbb . eee . abc "& TEXT ( ROW ( A5 29 )," 0000 ")&". eee "& ROW ( A3 9 ) 下 に コピー な ので ３ 行 目 が スタート 地点 として Sub test () Range (" A3 : A " & Cells ( Rows . Count , 2 ). End ( xlUp ). Row ) = _ "="" aaa . bbbb . eee . abc ""& TEXT ( ROW ( A5 29 ),"" 0000 "")&"". eee ""& ROW ( A3 9 )" End Sub 
A 列 で 並び 替え さ れ て いる 前提 で 。 Sub sample () Dim xAPP , i As Long , ii As Long , j As Long Set xAPP = Application For i = 1 To Cells ( Rows . Count , 1 ). End ( xlUp ). Row With Cells ( i , 1 ) ii = xAPP . CountIf ( Columns ( 1 ), . Value ) With . Resize ( ii ) j = xAPP . CountIf (. Offset (, 2 ), Cells ( 1 , 4 ). Value ) If j > 0 Then . Interior . Color = vb Yellow End If End With End With i = i + ii - 1 Next i End Sub 
原則 、 そういった 処理 は でき ませ ん 。 VBA の 制御 下 に ある の は 起動 を 指示 する ところ まで で 、 そこ から 先 は Chrome の 領分 に なり ます 。 VBA から 、 起動 中 の Chrome を 制御 する 方法 は 、 基本的 に は あり ませ ん ので 、 ビジー 状態 か 知る こと は でき ませ ん 。 特殊 な 方法 は あり ます が 、 ツール の 導入 が 必要 で あり 、 マクロ 終了 と 同時に Chrome も 閉じ て しまう ので 、 今回 の 件 に は 向か ない と 思い ます 。 
objIE . Navigate = strURL で なく objIE . Navigate strURL です 。 
Range (" A1 "). Select を ActiveSheet . Range (" A1 "). Select として み て 下さい 。 
10 秒 ごと に マクロ を 動かす の は Application . OnTime を 使え ば 可能 です 。 MSDN サイト https :// msdn . microsoft . com / ja - jp / library / office / ff 196165 . aspx 参考 http:// yumem . cocolog - nifty . com / excelvba / 2010 / 08 / pos t-4 4d 9. html http:// www . excel . studio - kazu .jp / kw / 20151005165157 . html 
一 例 です 。 Range (" A 2 ") = Chr ( Asc ( Range (" A1 ")) + 1 ) 
そんな ぼんやり と し た 質問 で は 的確 な 回答 は 得 られ にくい でしょ う 。 何 の ツール で 、 何 の 設定 な の か さっぱり わかり ませ ん 。 < add key =" AuthType " value =" 省略 "> <!-- 説明 ？--> 普通 に 考えれ ば 、 この 「 省略 」 という の を 消し て 、 代わり に そこ に 書き込む の でしょ う けど 。 > 反応 が あり ませ ん 。 エラー か 何 か が 出 て い ませ ん か ? 
一 例 です 。 Sub sample () Dim r As Range , i As Long , st 1 As Worksheet , st 2 As Worksheet Set st 1 = Sheets (" sheet 1 ") Set st 2 = Sheets (" sheet 2 ") For i = 1 To st 2 . Cells ( Rows . Count , " A "). End ( xlUp ). Row Set r = st 1 . Columns (" A "). Find _ ( what := st 2 . Cells ( i , " A "), lookat := xlPart ) If Not r Is Nothing Then st 1 . Cells ( r . Row , Columns . Count ). End ( xlToLeft ). Offset (, 1 ) = _ st 2 . Cells ( i , " A ") End If Next End Sub 
新規 シート に 一覧 する 、 一 例 です 。 Dim xRng As Range Sub Sanple _ Main () Dim cFld As String , xFld As Object With Application . FileDialog ( msoFileDialogFolderPicker ) . Title = " 対象 フォルダー 選択 " If .S how = True Then cFld = .S electedItems ( 1 ) & "\" Else Exit Sub End If End With Application .S creenUpdating = False With Worksheets . Add Set xRng = . Cells ( 2 , 2 ). Resize (, 4 ) End With xRng . Value = Array (" ファイル 名 ", " パス ", " ファイル 種別 ", " 最終 更新日 ") Set xFld = CreateObject (" Scripting . FileSystemObject "). GetFolder ( cFld ) Call Sample _ Folder _ Proc ( xFld ) With xRng . Current Region . Columns . AutoFit . Borders . LineStyle = True End With Application .S creenUpdating = True End Sub Sub Sample _ Folder _ Proc ( xFld As Object ) Dim xFile As Object , sh As Worksheet , xSubFld As Object For Each xFile In xFld . Files Set xRng = xRng . Offset ( 1 ) With xFile xRng . Value = Array (. Name , xFld . Path , . Type , . DateLastModified ) End With Next xFile For Each xSubFld In xFld .s ubfolders Call Sample _ Folder _ Proc ( xSubFld ) Next xSubFld End Sub 
ある アクティブ な Excel シート の A1 セル ～ A ? セル に 連続 し て 例えば 0 ～ 10 の 任意 の 半角 数字 が 入力 さ れ て いる もの と し ます 。 ( 半角 数字 以外 は ダメ ＆ 途中 に 空白 セル が あっ て も ダメ ) 【 例 】 [ A 列 ]     1     1     1     2     2     2     2     3     4     4     :     : その A1 セル ～ A ? セル の 値 のみ を ソート する VBA コード の 一 例 です ↓ 。 Sub MySort ()      ' ソート 開始 行 の 設定      StartRow = 1      ' 11 個 の 要素 全て 値 が 0 の 配列 Arr を 作成      '※ Arr ( 0 )= 0 ， Arr ( 1 )= 0 ， … ， Arr ( 10 )= 0 という 意味      Arr = Array ( 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 )      ' アクティブ な シート の A 列 最終 行 を 取得      MaxRow = Cells ( Rows . Count , 1 ). End ( xlUp ). Row      ' アクティブ な シート を 縦 向き に ループ 走査      For i = StartRow To MaxRow          ' 配列 Arr の セル の 値 要素 に 1 を 加算          Arr ( Cells ( i , 1 ). Value ) = Arr ( Cells ( i , 1 ). Value ) + 1      Next i      ' 行 カウンタ 用 の 変数 を 用意      RowCnt = StartRow      ' 配列 Arr の 各 要素 を ループ 走査      Do While RowCnt <= MaxRow          For j = 0 To UBound ( Arr )              ' もし 走査 対象 の 配列 要素 の 値 が 0 で なけれ ば              If Arr ( j ) > 0 Then                  ' 配列 要素 の 値 から 1 を 引く                  Arr ( j ) = Arr ( j ) - 1                  ' シート に j の 値 を 入力                  Cells ( RowCnt , 1 ). Value = j                  ' 行 カウンタ に 1 を 加算                  RowCnt = RowCnt + 1              End If          Next j      Loop End Sub 
実際 に どの よう な クエリ を 組ん で いる の でしょ う か 。 （ クエリ を デザインビュー で 開い て 、 表示 を SQL ビュー と すれ ば 、 SQL 文 が 表示 さ れ ます ） 結局 の ところ 日付 型 に 変換 出来 て い ない の が 原因 か と 思わ れ ます ので 、 検索 し たい テーブル の 該当 項目 が 日付 型 な の か 。 DateTimePicker から わたっ て くる データ の 中身 が きちんと 日付 型 な の か 。 双方 が 同じ 形 で ない と エラー に なり ます よ ？ それ と 日付 型 と いっ て も 複数 の 日付 型 が あり ます 。 例 ） 日付 （ 標準 ） や 日付 （ S )、 日付 ( L ) 等々 。 この あたり も 含め て もう一度 見直し て ください 。 必ず どこ か が 間違っ て い ます 。 もう １つ 。 クエリ と は 視覚 的 に わかり やすく SQL 文 を 作成 する ため の もの です 。 どう 作成 する と どんな SQL 文 に なる か 。 逆 に こんな SQL 文 を 作る に は どう すれ ば いい か 。 結局 の ところ SQL 文 を 理解 し て い ない と クエリ は 作成 でき ませ ん 。 
わかる ところ だけ です が … １ 、 Photoshop と Illustrator の 資格 、 民間 の 資格 は あり ます が 、 ほとんど 意味 あり ませ ん 。 資格 取る の が 好き 、 もしくは 取る 過程 で ソフト の 使い方 を 覚える … など の 目的 が 無い なら 、 取る 必要 は ない でしょ う 。 大切 な の は rio _ koringo さん が 書か れ て いる 通り 「 感性 」 です 。 これ は 資格 が ある 、 ない 、 の 外 の 話 です 。 ２ 、 3 、 4 、 もちろん 全て の 会社 という こと で は ない です が 、 デザイン 、 web 関係 の 仕事 は 普通に 就職 し た と する と 残業 あり き だ と 思っ た 方 が いい です 。 １ 時間 とか じゃなくて 「 終電 まで に 帰れ たら ラッキー 」 っていう 会社 も 多く なり ます 。 納品 期日 ギリギリ は 徹夜 なんて いう こと も ある かも しれ ませ ん 。 少なくとも ４ 時間 半 以上 は 座り っぱなし だ と 思い ます 。 休憩 を 取る 余力 も 無い 日 も 。 な ので 、 質問者 さん は バイト として 入る 場合 、 条件 など 充分 に 相談 し て 下さい 。 遠回り し て いる よう に 感じる かも 知れ ませ ん が 、 質問者 さん は まずは 体力 作り 、 腰痛 の 治療 を 先 に する べき だ と 思い ます 。 普通に 元気 だっ た 人で も 激務 で 休職 を 余儀なく さ れる 方 も い ます 。 ビビら せ て いる よう で 申し訳ない です が 、 体調 を これ 以上 悪化 さ せ ない 為 に も 、 まずは 体力 を つけ て 下さい 。 
Sub sample () Range (" A1 : J 1 "). Value = Split (" 商品 番号 , 商品名 , 値段 , 備考 , 日付 , 種別 , 数量 , 在庫 , 区分 , 時刻 ", ",") End Sub 
> 1 " と " みかん " が 入力 さ れ と いる 行 の 削除 を し たい お 示し の データ で は 、 「 大阪 」 の 行 だけ が 残る という こと です よ ね ？ Sub 一 例 です () Dim xCnd , i As Long , ii As Long xCnd = Array ("", " みかん ", "", " 1 ") With Cells ( 1 ). Current Region For i = 1 To 3 Step 2 . Range (" B : D "). AutoFilter Field := i , Criteria 1 := xCnd ( i ) If Application .S ubtotal ( 103 , . Columns ( 1 )) > 1 Then . Offset ( 1 ). Resize (. Rows . Count - 1 ). SpecialCells ( xlCellTypeVisible ). Delete Shift := xlUp End If . AutoFilter Next i End With End Sub 
返信 を 書こ う と 思っ た の です が 、 文字数 オーバー で でき ませ ん でし た 。 仕方 なく 、 回答 を 取り消し て 、 書き直し ます 。 どの よう に テータ を 展開 する か は 、 最初 に 書い て おい て ほしい です 。 こう する と 、 １つ の CSV に データ は ２ 列 に なり ます 。 なお 、 Ｂ 列 １ 行 目 から データ 展開 を する 。 CSV に は Ｃ 以降 データ が ない この ２ 点 は そのままで いい の です ね 。 ' Sub Macro 1 () ' Dim EndCell As Range Dim FileName As String Dim IX As Integer ' Set EndCell = Cells ( Rows . Count , Columns . Count ) Range ([ B 1 ], EndCell ). ClearContents ' ChDrive Left ( ThisWorkbook . Path , 2 ) ChDir ThisWorkbook . Path FileName = Dir ("*. csv ") ' Do While FileName > "" IX = IX + 2 Macro 1 Loop FileName , IX FileName = Dir Loop ' End Sub ' Sub Macro 1 Loop ( FileName As String , IX As Integer ) ' Dim IX 2 As Integer Dim IY As Long Dim FileData As String ' Open FileName For Input As # 1 ' While Not EOF ( 1 ) IY = IY - ( IX 2 = 0 ) Input # 1 , FileData Cells ( IY , IX + IX 2 ) = FileData Stop IX 2 = ( IX 2 + 1 ) Mod 2 Wend Close ' End Sub ' 
A 列 に 日付 が 日付 順 に 入力 さ れ て いる 状態 で 、 今日 の 日付 の セル 範囲 を 割り出す 例文 です 。 Sub sample () Dim i , ii As Long , APP Set APP = Application With Columns ( 1 ) ii = APP . CountIf (. Cells , Date ) If ii > 0 Then i = APP . Match ( CLng ( Date ), . Cells , 0 ) MsgBox " 今日 の 日付 が 入力 さ れ て いる 範囲 は 、 " & . Cells ( i ). Resize ( ii ). Address ( False , False ) End If End With End Sub 常套手段 の COUNTIF と MATCH の 関数 合わせ 技 。 
他 回答 の Match を 使う の が いい でしょ う ね 。 既出 な ので ここ で は Find を 説明 し ます 。 Match は 検索 範囲 の 何 番目 か 整数 が 戻り ます 。 Match の 方 が 速い です が 、 1 列 しか 検索 出来 ませ ん 。 Find は シート 全域 で 可能 です 。 Find は ヒット し た セル が 戻り ます 。 どちら も 「 見つから なかっ た 場合 の 処理 」 を し ない と エラー に なり ます 。 どちら も うまく 設定 すれ ば 検索対象 が 複数個 あっ て も 対応 可能 です 。 Sub TestFind () Dim ret As Range Dim Key Key = 100 Set ret = Columns (" A "). Find ( what := Key ) If ret Is Nothing Then Exit Sub MsgBox ret . Row End Sub よく ある 失敗 Dim ret As Variant ret = Columns (" A "). Find ( what := Key ). Row セル が 戻る の だ から . Row を 付けれ ば 行番号 でしょ ？ １ 行 で 済む じゃん ！ 見つかれ ば 確か に セル が 戻り ます が 、 見つから ない 場合 は Nothing が 戻り ます 。 これ は セル で は あり ませ ん 。 セル で ない もの に . Row など 付け たら エラー 終了 し ます 。 Find を 使う 際 は 必ず 注意 する お約束 です 。 その他 の 注意 Find を 検索 する と 分かり ます が 、 オプション が 多数 あり ます 。 どこ から 調べる か 、 どっち 方向 に 調べる か 、 etc 。 その 代わり 、 一旦 設定 し た オプション は 保持 さ れ ます 。 次回 の 検索 で 変え たい 時 は 注意 が 必要 です 。 さらに 、 手動 で 「 検索 」 し た 際 の オプション 設定 も 保持 さ れ ます （笑） 結論 いう と 「 １ 列 検索 の 時 は Match 使え 」 です 。 
どの よう な 症状 が 起きる の か を 書い て いただか ない と 、 回答者 は 戸惑い ます 。 文法 的 な 間違い なら 、 以下 の ２つ の どちら か に 変更 すれ ば 解消 する はず 。 １ ） Z . Range ( Cells ( FoundCell 1 . Row , 1 ), Cells ( FoundCell 2 . Row , 116 )). Copy _ H. Range ( Cells ( 3 , 1 ), Cells ( 3 + ( FoundCell 2 - FoundCell 1 ), 116 )) ２ ） Z . Range ( Cells ( FoundCell 1 . Row , 1 ), Cells ( FoundCell 2 . Row , 116 )). Copy H. Range ( Cells ( 3 , 1 ), Cells ( 3 + ( FoundCell 2 - FoundCell 1 ), 116 )). PasteSpecial あと は 、 １ ） コピー 元 と コピー 先 の セル 範囲 が 、 コピー の 規則 に 合う 正しい 形 を し て いる の か を 確認 する 必要 が あり ます 。 ２ ） 「 FoundCell 2 - FoundCell 1 」 は 、 2つ の セル （ なん です よ ね ？ ） の 「 値 の 差 」 を 求め て ます 。 意図 し た もの なら 良い の です が ・ ・ ・ 。 
テキストボックス の 名前 が AdvMaskEd なら ば Private Sub AdvMaskEd _ Change () End Sub で 、 数字 キー を 打鍵 し た 時 に イベント が 発生 する はず です 。 もちろん Click イベント は Private Sub AdvMaskEd _ Click () End Sub です 。 例えば Private Sub AdvMaskEd _ Change () MsgBox " Change " End Sub Private Sub AdvMaskEd _ Click () MsgBox " Click " End Sub で 、 AdvMaskEd を クリック し た 時 と 、 数字 または 文字 で 内容 が 変更 さ れ た 時 に イベント が 発生 し ませ ん か ? ただ Click で は 打鍵 し た 結果 の テキストボックス の 内容 は わかり ます が 、 どんな キー を 打鍵 し た か は わかり ませ ん 。 Click イベント は 発生 し て Change イベント が 発生 し ない プログラム を 教え て ください 。 また Private Sub AdvMaskEd _ Change () MsgBox " Change " End Sub Private Sub AdvMaskEd _ Click () MsgBox " Click " End Sub で は どうでしょう か 。 
http:// wtakemo . hatena blog . com / entry / 2014 / 03 / 10 / 025526 
Sub Sample () Range (" A 2 , A5 : A " & Range (" A " & Rows . Count ). End ( xlUp ). Row ). ClearContents End Sub です 。 いちいち セル 範囲 を Select や Activate する 必要 は ありません し 、 Range オブジェクト へ の セル 範囲 の 指定 の 仕方 を 工夫 すれ ば 「. Address 」 は 不 必要 に なり ます 。 
こんな 感じ です か ね ？ 3 万 行 × 200 種類 だ と 200回 抽出 じゃなくて 600 万 回 です よ 。 ループ する と 時間 かかり そう な ので オート フィルタ に し まし た 。 試し て ない ので 動か なかっ たら ごめんなさい ｗ Dim Endrow as long Dim tmp as string Endrow = worhsheet (" sheet 1 "). cells ( row . count , 4 ). end ( xlup ). row Open テキスト の フル パス for input as # 1 Do until eof ( 1 ) Line input # 1 , tmp worksheets (" sheet 1 "). Range (" A1 : D " & Endrow ). AutoFilter _ field := 4 , Criteria 1 :="*" & tmp & "*" worksheets . add . after := worksheets ( worksheets . count ) activesheet . name = tmp worksheets (" sheet 1 "). Range (" A1 : D " & Endrow ). Copy worksheets ( tmp ). Range (" A1 "). pastespecial Loop Close # 1 
Range (" C3 3 , D3 3 , E3 3 "). value = " 同じ 文字 が 入る 筈 " 
ActiveX の コマンド ボタン を 使う の でし たら 、 Private Sub CommandButton 1 _ Click () Dim MTo As String MTo = " Mailto :" & Range (" B2 "). Value CreateObject (" WScript .S hell "). Run MTo End Sub 
ブック の アドレス （ ファイル 名 ？ ） が 書か れ て いる セル A1 ～ A10 を 繰り返す For ～ Next を 追加 し ます 。 以下 は 一 例 です が 、 シート 名 が わかり ませ ん でし た ので 、 アクティブ シート の A1 ～ A10 を 使用 する よう に し て い ます 。 ただし 、 テスト は し て おり ませ ん 。 Sub シート () Dim bk As Workbook ' ファイル 名 の セル 用 変数 Dim rng As Range ' アクティブ シート の セル A1 ～ A10 を 繰り返し 処理 For Each rng In ActiveSheet . Range (" A1 : A10 ") ' セル の 値 の ファイル を 開く Set bk = Workbooks . Open ( Filename := rng . Value , ReadOnly := False , IgnoreReadOnlyRecommended := True ) Application . DisplayAlerts = False bk . Worksheets (" リスト "). Delete ThisWorkbook . Worksheets (" リスト "). Copy _ After := bk .S heets ( bk .S heets . Count ) bk .S ave bk . Close Application . DisplayAlerts = True ' 繰り返し ここ まで Next End Sub 
https :// msdn . microsoft . com / ja - jp / library / dd 314356 . aspx ココ を 熟読 
> と 変換 する マクロ は あり ます でしょ う か ？ と いう より 作る しか あり ませ ん 。 ひとつ の セル に 改行 で 区切っ た 住所 、 氏名 が 入っ て い て 順番 を 入れ替える （ １ ） セル の 内容 を 改行 で 区切る → Split 関数 （ ２ ） 内容 が ５ 行 あっ て 、 ２ 行 目 は 「 住所 」 なら 該当 の 形式 だ と 判断 （ ３ ） 元 のせる に 、 ４ 行 目 ＋ 改行 ＋ ５ 行 目 ＋ 改行 ＋ １ 行 目 ＋" さま " を 入れる 
こんな 感じ で どうでしょう か 。 Sub Sample () Dim Sh As Worksheet Dim Nm As String For Each Sh In Worksheets Nm = Sh . Name Select Case Nm Case " A - A " Sh . Range (" AY 1 ") = 1 Case " A - B " Sh . Range (" AY 1 ") = 2 Case " A-C " Sh . Range (" AY 1 ") = 3 End Select Next End Sub 
エラー が 出る の は 「 For Each sht ・ ・ 」 の 部分 を １ 回 目 に 通過 する 時 です か 。 それとも 何 度目 か です か 。 cp wb ( i ), sht . Name , TextBox 1 . Text , i で どんな 処理 を 行っ て いる の か わかり ませ ん が 、 wb ( 0 ) の シート を 途中 で 消し たり 他 の book に 移動 し たり し て い ませ ん か 。 （ 参考 ） 変数 が 削除 または 移動 し た シート を 参照 する とき に [ xl 97 ]: エラー https :// support . microsoft . com / ja - jp / kb / 158997 
いくつ か 方法 は ある と 思い ます が 、 単純 な 方法 が 分かり易い と 思い ます 。 Sub test () endrow = Cells ( Rows . Count , 1 ). End ( xlUp ). Row msg = "" For r = 5 To endrow msg = msg & Cells ( r , 1 ). Value & "," Next msg = Left ( msg , Len ( msg ) - 1 ) Range (" A 2 "). Value = msg End Sub 「 End ( xlUp )」 という の は 、 「 Ctrl +↑」 を 押し た 結果 の 移動 先 を 示し て い ます 。 それ を 「 Cells ( Rows . Count , 1 )」 つまり A 列 の 最終 行番号 の セル に 適用 し て い ます ので 、 その セル から 「 Ctrl +↑」 を 押し た 結果 が 得 られ ます 。 後 は Row プロパティ が 付い て い ます ので 、 得 られ た 移動 先 の 行番号 を 取得 し て い ます 。 特殊 な の は 上記 の 点 ぐらい です 。 後 は 、 範囲 内 の セル を 順番 に 取り出し 、 変数 「 msg 」 に カンマ 付き で 付け足し て いき ます 。 ただし 、 これ だ と 末尾 に 余計 な カンマ が 残り ます ので 、 Left を 使っ て 、 切り取っ て い ます 。 これ を ボタン に 登録 し て み て ください 。 
え 、 商品名 の トコ に if 文 かま してやれ ば いいんじゃない ？ 
まず 何 の 質問 な の か ？ つまり 動作 環境 や 言語 が 不明 です が 。 。 。 > VBScript は 現在 勉強 中 で ほぼ 初心者 です 。 という こと は 「 Windows の ローカル 環境 で 動作 する VBS ファイル 内 で 使わ れる VBScript の 質問 」 と 解釈 し て 良い の でしょ う か ？ ( ASP の VBScript や HTML や HTA 内 の VBScript は 無視 。 ) そういう こと として 以下 を 続け ます 。 まず ， C ドライブ の 直下 に 「 A 」 という フォルダ C :\ A と 「 B 」 という フォルダ C :\ B が ある と し ます 。 さらに ， C :\ A の " 直下 " に は 20160629 - 0001 .jpg 20160629 - 0002 .jpg 20160629 - 0003 .jpg という ファイル が あり C :\ B の " 直下 " に は 20160629 - 0001 .jpg 20160629 - 0012 .jpg 20160629 - 0013 .jpg という ファイル が あっ た と する 場合 その 差分 ( 不一致 ファイル 名 ) である 20160629 - 0002 .jpg 20160629 - 0003 .jpg 20160629 - 0012 .jpg 20160629 - 0013 .jpg を 出力 する もの と し ます 。 その 場合 の VBS ファイル の VBScript コード 例 です ↓ 。 ' - - - - - - - - - - - - - ------------------------- ' 比べる ２つ の フォルダ の パス を 設定 FolderA = " C :\ A " FolderB = " C :\ B " ' ファイルシステム オブジェクト を 作成 Set FSObj = CreateObject (" Scripting . FileSystemObject ") ' FolderA の フォルダ オブジェクト を 取得 Set FldObj = FSObj . GetFolder ( FolderA ) ' 連想配列 DicA を 作成 Set DicA = WS cri pt. CreateObject (" Scripting . Dictionary ") ' フォルダ オブジェクト の Files から File 名 を 取得 For Each FilObj In FldObj . Files      ' 取得 し た ファイル 名 を DicA の キー に 登録      DicA . Add FilObj . Name , True Next ' FolderB の フォルダ オブジェクト を 取得 Set FldObj = FSObj . GetFolder ( FolderB ) ' 連想配列 DicB を 作成 Set DicB = WS cri pt. CreateObject (" Scripting . Dictionary ") ' フォルダ オブジェクト の Files から File 名 を 取得 For Each FilObj In FldObj . Files      ' 取得 し た ファイル 名 を DicB の キー に 登録      DicB . Add FilObj . Name , True Next ' DicA 内 の キー を 走査 For Each KeyA In DicA . Keys      ' もし DicB キー に DicA の キー が あれ ば      If DicB . Exists ( KeyA ) Then          ' DicA と DicB から その キー を 削除          DicA . Remove KeyA          DicB . Remove KeyA      End If Next ' 改行 を セパレータ と し た 文字列 として 不一致 キー を 取得 Sep = vbCrLf DisStr = Join ( DicA . Keys , Sep ) & Sep & Join ( DicB . Keys , Sep ) ' 不一致 キー ( 不一致 ファイル 名 ) を 表示 し て みる WS cri pt. Echo DisStr ' オブジェクト の 解放 Set DicA = Nothing Set DicB = Nothing Set FldObj = Nothing Set FSObj = Nothing ' - - - - - - - - - - - - - ------------------------- 
Sub Sample () Const xPath As String = " C :\ AAA \" FileCopy xPath & " 元 の ファイル . xls ", xPath & Format ( Date , " Ammdd ") & ". xls " End Sub 
手前 の シート が 、 Book 1 . xls の Sheet 1 奥 の シート が 、 Boo k2 . xls の Sheet 2 として プログラミング さ れ て い ます 。 Sub 一 例 です ｡() Dim sh As Worksheet , APP , rngx As Range Dim ii As Long , i , j , rng As Range Set sh = Workbooks (" Book 1 . xls "). Worksheets (" Sheet 1 ") Set APP = Application With Workbooks (" Boo k2 . xls "). Worksheets (" Sheet 2 ") Set rngx = . Cells ( 3 , 1 ). Resize ( 9 ) ii = APP . CountIf ( sh . Columns ( 1 ), CLng (. Cells ( 1 , 1 ). Value )) If ii > 1 Then i = APP . Match ( CLng (. Cells ( 1 , 1 ). Value ), sh . Columns ( 1 ), 0 ) For Each rng In sh . Cells ( i , 2 ). Resize ( ii ) j = Application . Match ( rng . Value , rngx , 0 ) If Not IsError ( j ) Then rng . Offset (, 1 ). Resize (, 2 ). Copy rngx . Cells ( j ). Offset (, 1 ) End If Next rng End If End With End Sub 
ComboBox 1 と Command Button 1 が ある 場合 です 。 Private Sub CommandButton 1 _ Click () Select Case ComboBox 1 . Value Case " セット " Sheets (" Sheet 2 "). Range (" A 2 : A8 "). Copy Sheets (" Sheet 1 "). Range (" A 2 : A8 ") Case " 単品 " Sheets (" Sheet 3 "). Range (" A 2 : A8 "). Copy Sheets (" Sheet 1 "). Range (" A 2 : A8 ") End Select End Sub 選択 し ない 場合 の 警告 を 出す 場合 です 。 Private Sub CommandButton 1 _ Click () Select Case ComboBox 1 . Value Case " セット " Sheets (" Sheet 2 "). Range (" A 2 : A8 "). Copy Sheets (" Sheet 1 "). Range (" A 2 : A8 ") Case " 単品 " Sheets (" Sheet 3 "). Range (" A 2 : A8 "). Copy Sheets (" Sheet 1 "). Range (" A 2 : A8 ") Case Else MsgBox " 選ん で ください " End Select End Sub 前もって ComboBox 1 に 値 が 設定 し て いる 場合 です 。 例えば 下記 です 。 Sub sample () ComboBox 1 . Clear ComboBox 1 . AddItem " セット " ComboBox 1 . AddItem " 単品 " End Sub 
> ActiveSheet . Range ( cells ( i , j )). Copy ’ ここ で 実行 時 エラー は 、 ActiveSheet . Range ( Cells ( i , j ). Value ). Copy と 書く の と 同じ 。 な ので 、 Cells ( i , j ) の 値 は 、 セル アドレス を 示す 値 （ A1 , B 1 ,$ A $1 など ） で ない と ダメ です ね 。 あと 、 いくつ か 指摘 。 １ ） Dim i , j As Integer は 、 Dim i As Variant , j As Integer と 書い た と 見 做 さ れ ます 。 あなた の 意図 と 違い ます よ ね ？ Dim i As Integer , j As Integer と 正しく 書き ましょ う 。 あと 、 行番号 は 、 Long 。 Integer で は 、 格納 でき ない 行番号 が で て き ます よ ね ？ ２ ） Select や Activate は 使わ ない よう に し ましょ う 。 実行 速度 が 落ち 、 プログラム が 読み にくく なり ます 。 全体 を 見直す なら ↓ の よう な 感じ 。 Sub テスト () Dim ShB As Worksheet Dim i As Long , j As Long Set ShB = ThisWorkbook . Worksheets (" B ") With T hisWorkbook . Worksheets (" A ") For j = 5 To . Cells ( 4 , Columns . Count ). End ( xlToLeft ). Column For i = 5 To . Cells ( Rows . Count , 3 ). End ( xlUp ). Row If . Cells ( i , j ). Value > 0 Then . Cells ( i , j ). Copy ' ここ で 実行 時 エラー ShB . Cells ( Rows . Count , 2 ). End ( xlUp ). Offset ( 1 ). PasteSpecial xlPasteValues End If Next Next End With Set ShB = Nothing Application . CutCopyMode = False End Sub 未 実行 につき 不具合 ご 容赦 。 
こんな でしょ う か Sub sample () Dim w s1 As Worksheet Dim w s2 As Worksheet Dim rng As Range Dim c As Integer Dim rngR As Range ' Set w s1 = Sheets (" Sheet 1 ") ' 奥 の シート Set w s2 = Sheets (" Sheet 2 ") ' 手前 の シート If w s1 . Range (" A1 "). Value = "" Then Exit Sub ' 奥 の シート の A1 が 無けれ ば 終わり Set rng = w s2 . Range (" 2 : 2 "). Find ( w s1 . Range (" A1 "). Text , LookIn := xlValues , LookAt := xlWhole ) ' 手前 の シート の 2 行 目 で 、 奥 の シート の A1 の 値 を 探す If rng Is Nothing Then Exit Sub ' 無けれ ば 終わり c = rng . Column ' 日付 を 見つけ た 列 For Each rng In w s1 . Range (" A3 : A 7 , I 3 : I 7 ") ' 奥 の シート の A3 : A 7 , I 3 : I 7 を 順に 調べる Set rngR = w s2 . Range (" A : A "). Find ( rng . Value , LookIn := xlValues , LookAt := xlWhole ) ' 手前 の シート の A 列 で 、 注目 セル の 値 を 探す If Not rngR Is Nothing Then ' あっ たら rng . Offset ( 0 , 5 ). Value = w s2 . Cells ( rngR . Row , c ). Value ' 注目 セル の 5 セル 右 に 、 見つけ た セル の 行 と 日付 を 見つけ た 列 の 交点 の 値 を 入れる End If Next End Sub 
Excel VBA の Worksheet _ Change イベント を 使え ば 自動化 でき ます 。 具体 的 な シートレイアウト が 何 も 判ら ない ので これ 以上 は 回答 出来 ませ ん 。 
http:// m . webry . inf o/a t / 89395735 / 201104 / article _ 1 . htm ? i =& p =& c = s & guid ... 
これ で 、 どんな SQL が 発行 さ れる か イメージ し て ください 。 ダブル クォート は 、 VB の 文字列 部分 を 括っ て い ます 。 シングルクォート は SQL 内 で 文字列 部分 を 括っ て い ます 。 Textbox 1 に 「 123 」 と 入力 さ れ た として SELECT * FROM orders WHERE MemberID = ' 123 ' この よう な SQL が 発行 さ れ ます 。 「 '」 は 123 を 括っ てる やつ です 。 
「 主キー が なく 、 かつ A の セル が 2 の データ 」 に対して 「 だけ 」 削除 フラグ を 立てる の です か ？ それとも 前回 の 条件 に 加え て 新た に 「 主キー が なく 、 かつ A の セル が 2 の データ 」 に も 削除 フラグ を 立てる の です か ？ 「 除外 し たい の は Ａ の セル が 1 と 9 の 時 です 」 の 意味 が 判り ませ ん 。 
誤 ） " C :\ Users \ TOYOJI \ 前 の PC ﾃﾞｰﾀ \& l " 正 ） " C :\ Users \ TOYOJI \ 前 の PC ﾃﾞｰﾀ \" & l です 。 提示 さ れ た コード は それ 以外 に も 非常 に 危険 な コード です 。 コード 例 を 示し ます 。 Option Explicit Sub sample () Dim l As String Dim newFolder As String l = InputBox (" 氏名 ", " 新人 追加 ", "") If l <> "" Then ' 新しい フォルダ 名 を 組み立てる newFolder = " C :\ Users \ TOYOJI \ 前 の PC ﾃﾞｰﾀ \" & l ' エラー を 無視 し て 次 の 行 を 実行 する On Error Resume Next ' フォルダ を 作成 する MkDir newFolder ' フォルダ 作成 に 成功 し て い た とき If Err = 0 Then ' カレントディレクトリ を 作成 し た フォルダ に 変更 する ChDir newFolder End If ' エラート ラップ を 再開 する On Error GoTo 0 End If End Sub ポイント は ① VBA で は ダブル クォーテーション で くくら れ た 範囲 を 文字列 と 見なし ます 。 ② InputBox を 使う とき は 「 キャンセル 」 が 押さ れ た 時 の こと を 考慮 し ましょ う 。 ③ フォルダ 作成 に 失敗 し て しまう と エラー が 発生 し て プログラム が そこ で 止まっ て しまう ので 、 きちんと エラー 対策 を し ましょ う 。 ④ 同じ 文字列 を 扱う とき は 文字列 変数 に 格納 し て 使い ましょ う 。 ⑤ プログラム の 先頭 に は 必ず 「 Option Explicit 」 という 一行 を 記述 し ましょ う 。 （ 変数 の スペル ミス による プログラム 動作 不良 を 防ぐ こと が 出来 ます ） です 。 
既に 別 の 回答者 さん から も 指摘 さ れ て い ます が 「 IF 構文 を 使う と 、 連続 し た 命令 が 出せ なく 」 という 文章 が 理解 出来 ませ ん 。 あなた が し たい と 思っ て いる こと を 具体 的 な 例 を 示し て 補足 し て いただけ ます か ？ 
自動 で という の は 、 どの タイミング で でしょ う か ？ ページ を 表示 し た とき ？ 一定 の 時間 が たっ た 時 ？ なにか 別 の ところ を クリック し た とき ？ 自動 で 実行 する タイミング が いつか によって 、 処理 が 変わっ て き ます ので 、 教え て いただけ ます か ？ 
Sub sample () Range (" A1 "). Select Do While Selection . Value <> "" Selection . Hyperlinks ( 1 ). Follow NewWindow := False , AddHistory := True Call 処理 Selection . Offset ( 1 ). Select Loop End Sub という こと です か ね ？ 
こんにちは。 Sub Test () If DateValue ( Date ) + TimeValue ( Now + TimeValue (" 00 : 03 : 00 ")) < Now Then ResTime = DateValue ( Date + 1 ) + TimeValue ( Now + TimeValue (" 00 : 03 : 00 ")) Else ResTime = DateValue ( Date ) + TimeValue ( Now + TimeValue (" 00 : 03 : 00 ")) End If Cells ( 2 , 1 ) = Now Cells ( 1 , 1 ) = ResTime Application . OnTime ResTime , " Test ", TimeValue (" 00 : 01 : 00 ") Cells ( 3 , 1 ) = "" End Sub は Sub Test () ResTime = Now + TimeValue (" 00 : 03 : 00 ") Cells ( 2 , 1 ) = Now Cells ( 1 , 1 ) = ResTime Application . OnTime ResTime , " Test ", TimeValue (" 00 : 01 : 00 ") Cells ( 3 , 1 ) = "" End Sub です ね 。 ontime に 、 「 日 と 時 を 指定 し て 、 命令 を 出し て ください 。 timevalue は 、 「 日 」 の 部分 は 、 データ として カット し ます 。 パソコン の 電源 は 、 カット でき ませ ん し 、 これ で 、 深夜 23 時 50 ぐらい から 、 挙動 を 確認 し て ください 。 
プロテクト する 時 に UserInterfaceOnly を True に する と 、 手作業 は プロテクト さ れる けれど 、 VBA は プロテクト さ れ ませ ん 。 Sub sample () Range (" A1 "). Locked = False Range (" A 2 "). Locked = True ActiveSheet . Protect UserInterfaceOnly := True Range (" A 2 "). Value = " abc " ' Protect 後 も Locked さ れ てる A 2 に 書き込める End Sub 
そこ の 動作 は 変更 でき ない です ね 。 リボン の 「 検索 」 クリック または Ctrl + F で 出る 検索 ダイアログ なら 特定 フィールド のみ 対象 に し たり 、 完全 一致 か 部分 一致 など を 指定 し て 検索 でき ます 。 
こんにちは。 > すで に ある もの に 主 様 は 、 これ を 、 よく 理解 し て い ない 、 という こと です よ ね 。 そんなに 急い で いる の でし たら 、 ここ に 乗せ たら 、 答え も つく でしょ う に 。 マクロ の コード で 、 直接 相談 なんて 、 あまり 聞き ませ ん 。 
時間 と 名前 が 複数 列 ある よう です が 、 リスト ボックス に は どの よう に 表示 する の でしょ う か ？ 具体 例 を あげ て 説明 し て ください 。 
Visual Basic 6 . 0 ( sp 6 ) ランタイム は 一番 新しい です が 既に 古い もの です 。 ウィンドウズ １ ０ では インストール 中 に 「 VB ６ ランタイム が セキュリティ の めん で 危険 です 。 」 よう な 表示 出 ませ ん でし た か ？ その ため 、 VB 6 ランタイム の 必要 な ソフト は 使用 を やめ まし た 。 
> 最終 的 な ゴール は 、 VBA により 、 > 選択 さ れ て いる 画像 を 抽出 し たい この 意味 ( 関連性 ) が 全く わかり ませ ん が とりあえず 無視 という こと で 以下 を 続け ます 。 > 現在 拡大 表示 さ れ た 画像 が 何 で ある か > ～ 略 ～ > 選択 さ れ た 画像 を 把握 する 方法 「 選択 ( クリック ) さ れ た 画像 」 と 「 拡大 表示 さ れ た 画像 」 と は 別物 です よ 。 また ， 「 拡大 表示 さ れ た 画像 」 は 選択 さ れ た 画像 で 実行 さ れる 関数 の 引数 から わかる でしょ う ？ < img src =" 小さな 画像 ファイル 名 1 " onClick =" Imgche (' 大きな 画像 ファイル 名 1 ')"> 「 小さな 画像 ファイル 名 1 」 が クリック さ れ た とき に 関数 Imgche が 実行 さ れ その 引数 で 指定 さ れ た 「 大きな 画像 ファイル 名 1 」 の 画像 が name =" space " の 部分 に 表示 さ れる の です 。 「 小さな 画像 ファイル 名 1 」 が クリック さ れ た とき に 「 小さな 画像 ファイル 」 が 何 で ある か は 現状 で は わかり ませ ん ね 。 です から 「 小さな 画像 ファイル 」 が 何 で ある か を 知り たい とき は それ も 引数 で 渡し て やれ ば 良い か と 思い ます 。 または クリック さ れ た エレメント 自体 を this として 引数 で 渡し ， その エレメント の src 属性 を 見る と か 。 とにもかくにも 別 関数 を 使う か ， 今 の 関数 の 引数 を 変える か の どちら か に なる でしょ う 。 書か れ て いらっしゃる サイト の スクリプト を 拝借 ＆ 変更 さ せ て いただく こと に し ます ↓ 。 . ◎ 「 小さな 画像 ファイル 名 」 を 引数 として 渡す 方法 例 ↓ < html > < head > < title ></ title > < script type =" text / javascript "> <!-- function Imgche ( ado , sml ) { document . space .s rc = ado ; alert (" 選択 さ れ た 画像 の ファイル 名 … " + sml ); alert (" 拡大 さ れ た 画像 の ファイル 名 … " + ado ); } // --> </ script > </ head > < body > < center > < p > < img src =" 小さな 画像 ファイル 名 1 " onClick =" Imgche (' 大きな 画像 ファイル 名 1 ',' 小さな 画像 ファイル 名 1 ')"> < img src =" 小さな 画像 ファイル 名 2 " onClick =" Imgche (' 大きな 画像 ファイル 名 2 ',' 小さな 画像 ファイル 名 2 ')"> < img src =" 小さな 画像 ファイル 名 3 " onClick =" Imgche (' 大きな 画像 ファイル 名 3 ',' 小さな 画像 ファイル 名 3 ')"> < img src =" 小さな 画像 ファイル 名 4 " onClick =" Imgche (' 大きな 画像 ファイル 名 4 ',' 小さな 画像 ファイル 名 4 ')"> < img src =" 小さな 画像 ファイル 名 5 " onClick =" Imgche (' 大きな 画像 ファイル 名 5 ',' 小さな 画像 ファイル 名 5 ')"> </ p > 小さな 画像 を クリック する と 額 に 大きな 画像 が 表示 さ れ ます 。 < p style =" border : ridge 10 # ccc c66 ; width : 300 ; height : 300 ; background-color : # ccc c66 ; "> < img src =" 最初 に 表示 さ れ て いる 画像 " width =" 300 " height =" 300 " name =" space "> </ p > </ center > </ body > </ html > . ◎ 選択 さ れ た エレメント を 引数 として 渡す 方法 例 ↓ < html > < head > < title ></ title > < script type =" text / javascript "> <!-- function Imgche ( ado , elm ) { document . space .s rc = ado ; alert (" 選択 さ れ た 画像 の URL … " + d ecodeURI ( elm .s rc )); alert (" 拡大 さ れ た 画像 の URL … " + d ecodeURI ( document . space .s rc )); } // --> </ script > </ head > < body > < center > < p > < img src =" 小さな 画像 ファイル 名 1 " onClick =" Imgche (' 大きな 画像 ファイル 名 1 ', this )"> < img src =" 小さな 画像 ファイル 名 2 " onClick =" Imgche (' 大きな 画像 ファイル 名 2 ', this )"> < img src =" 小さな 画像 ファイル 名 3 " onClick =" Imgche (' 大きな 画像 ファイル 名 3 ', this )"> < img src =" 小さな 画像 ファイル 名 4 " onClick =" Imgche (' 大きな 画像 ファイル 名 4 ', this )"> < img src =" 小さな 画像 ファイル 名 5 " onClick =" Imgche (' 大きな 画像 ファイル 名 5 ', this )"> </ p > 小さな 画像 を クリック する と 額 に 大きな 画像 が 表示 さ れ ます 。 < p style =" border : ridge 10 # ccc c66 ; width : 300 ; height : 300 ; background-color : # ccc c66 ; "> < img src =" 最初 に 表示 さ れ て いる 画像 " width =" 300 " height =" 300 " name =" space "> </ p > </ center > </ body > </ html > ↑ 実際 の 画像 は 用意 し なく て も 上 の HTML のみ で ， 取得 動作 だけ は する と 思い ます よ 。 ( 画像 を 用意 し なけれ ば 画像 が 表示 さ れ ない だけ の こと です 。 ) . または 「 現在 拡大 表示 さ れ た 画像 の URL 」 でし たら クリック する とき とか に 関わら ず 知り たい とき に document . space .s rc を 取得 すれ ば 良い だけ です 。 ◎ 知り たい とき に 「 現在 拡大 表示 さ れ た 画像 の URL 」 を 知る 方法 例 ↓ < button id =" btn " onclick =" alert ( decodeURI ( document . space .s rc ))"> 拡大 表示 さ れ て いる 画像 の URL を 表示 </ button > < br > < button id =" btn " onclick =" alert ( decodeURI ( document . space .s rc . match ('.+/(.+?)([\?#;].*)?$')[ 1 ]))"> 拡大 表示 さ れ て いる 画像 の ファイル 名 を 表示 </ button > ↑ コレ を HTML の body 内 の 好き な ところ に 貼り 付けれ ば 良い だけ です 。 
こちら で 確認 し まし た が 、 正常 に 読み取れ て い ます 。 コード は 下記 です 。 static void Main ( string [] args ) { var doc = new XmlDocument (); doc . LoadXml (@"* * X M L 文 字 列 * *"); foreach ( XmlAttribute a in doc . DocumentElement . Attributes ) { Console . Write Line ( a . Name + "=" + a . Value ); } } 
行 の ロック も チェックボックス の ロック も 可能 です 。 ロック は シート を 保護 し ない と 有効 に なり ませ ん が 、 それ は 理解 し て い ます か ？ 行 の ロック は 、 たとえば ４ 行 目 を ロック する なら Rows ( 4 ). Locked = True です 。 シート 上 に 挿入 する チェックボックス に は フォーム コントロール と Active X コントロール の ２ 種類 が あり ます 。 どちら も Locked = True と 同時に Enabled = False を 設定 し ない と ロック を 掛ける こと は 出来 ませ ん 。 WorkSheet _ Change イベント で 値 が 変更 さ れ た セル の 行 全体 と チェックボックス に ロック を 掛ける 例 です 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim rng As Range Dim obj As Variant ' 変更 さ れ た すべて の セル を 対象 と する For Each rng In Target . Cells If rng . Value <> "" Then ' シート の 保護 を 解除 する ActiveSheet . Unprotect ' 変更 さ れ た セル の 行 すべて を ロック する Rows ( rng . Row ). Locked = True ' 変更 さ れ た セル の 行 に 存在 する 全て の チェックボックス ( フォーム コントロール ) を ロック する For Each obj In CheckBoxes If rng . Row >= obj . TopLeftCell . Row And _ rng . Row <= obj . BottomRightCell . Row Then obj . Locked = True obj . Enabled = False End If Next ' 変更 さ れ た セル の 行 に 存在 する 全て の チェックボックス ( ActiveX コントロール ) を ロック する For Each obj In OLEObjects If TypeOf obj . Object Is MSForms . CheckBox Then If rng . Row >= obj . TopLeftCell . Row And _ rng . Row <= obj . BottomRightCell . Row Then obj . Locked = True obj . Enabled = False End If End If Next obj End If ' シート の 保護 を 設定 する ActiveSheet . Protect Next rng End Sub しか し 「 値 を 入力 し た セル の 行 全体 に ロック を 掛け 」 て しまう と 、 シート の 保護 を 解除 し ない かぎり 、 修正 も 出来 なく なり ます が 宜しい の でしょ う か ？ 
Sub a () With ActiveSheet ' ハイパーリンク クリア . Hyperlinks . Delete ' A 列 の 最終 行 を 取得 max _ row = . Cells ( Range (" A : A "). Rows . Count , 1 ). End ( xlUp ). Row For i = 1 To max _ row ' A 列 および D 列 が 存在 する 場合 のみ If . Cells ( i , 1 ). Value <> "" And . Cells ( i , 4 ). Value <> "" Then ' ハイパーリンク 追加 （ Anchor が リンク を つける 対象 セル 、 Address が リンク の アドレス ） . Hyperlinks . Add Anchor :=. Cells ( i , 4 ), Address :=. Cells ( i , 1 ). Value End If Next End With End Sub 
Access で は 、 フォーム と レポート は 連動 はしません 。 フォーム は 、 テーブル から フォーム 、 または テーブル 、 クエリ 、 フォーム という 流れ で データ が 関連付け られ ます 。 レポート も 同様 で 、 テーブル から レポート 、 または テーブル 、 クエリ 、 レポート いう 流れ で データ が 関連付け られ ます 。 レポート は 出力 さ れる オブジェクト な ので 、 レポート の データ から クエリ や テーブル へ データ は 流れ ませ ん 。 レポート で 表示 し たい フィールド （ 項目 ） を まず 決め て おき ます 。 その 項目 を 抽出 さ せる ため に 、 テーブル を 元 に クエリ を 作成 し 、 その クエリ を 元 に フォーム を 作成 し ます 。 フォーム 上 に 必要 な 条件 を 指定 し て 、 クエリ を 実行 する と レポート が 表示 さ れる よう に する の が 一般的 です ね 。 
以下 の コード でいか が でしょ う か 。 セル の Tag プロパティ を 利用 し て 読み込み 済み か そう で ない か を 判定 し て い ます 。 Public Class Form 1 ' ﾎﾞﾀﾝ が 押さ れ たら Private Sub Button 1 _ Click ( sender As Object , e As EventArgs ) Handles Button 1 . Click ' ｾﾙ の 内容 を 取得 Dim list As New List ( Of String ) With DataGridView 1 For r As Integer = 0 To . RowCount - 1 For c As Integer = 0 To . ColumnCount - 1 Dim Cell As DataGridViewCell = . Item ( c , r ) If Not Cell Is Nothing Then ' セル の 内容 が Null 以外 、 かつ Tag プロパティ が True 以外 の とき If Not String . IsNullOrEmpty ( Cell . Value ) And CBool ( Cell . Tag ) <> True Then ' コンボボックス 追加 用 の リスト に セル の 値 を 追加 する list . Add ( Cell . Value ) ' セル の Tag プロパティ に True を セット する . Item ( c , r ). Tag = True End If End If Next Next End With ' コンボボックス 追加 用 の リスト が 空 の とき は 処理 を 抜ける If list . Count = 0 Then Exit Sub ' ｺﾝﾎﾞﾎﾞｯｸｽ に 追加 DataGridView 2 . Columns . Add ( New Da taGridViewComboBoxColumn () With { . DataSource = list , . DataPropertyName = " CodeAfter ", . HeaderText = " コード 変更 " }) End Sub End Class 
求め てる 対策 か どう か わからん が 、 、 Sub test () With Worksheets (" Sheet 1 "). Range (" DN 20 ") . Formula = _ "= MAX ( IF ($ N $20 :$ N $200 0 = N2 0 ,$ L $20 :$ L $200 0 ))" . FormulaArray = . Formula . AutoFill Destination := Range (" DN 20 : DN 2000 ") End With 、 、 と か 
当方 Ｗｉｎ １ ０ と アクセス ２ ０ ０ ７ です が 、 その よう な 現象 は 出 て い ませ ん 。 使用 不可 で は 無く ・ オフ ・ 半角 英 数 等 で は 如何 でしょ う か ？ 
以下 で どう なり ます か ベタ で やっ て み まし た が ････ やっ て いる こと は 、 １ セル ずつ 書き出し する の は 遅い ので ････ １ 度 Const CBUFSZ As Long = 50000 の 行 数 で 蓄え ます カンマ で 区切る の は 後回し に し て 、 １ 行 の 文字列 を つなげ て いき ます データ を 読み 終わっ たら ･･･ 読書 き行 数 で 、 区切り 位置 にて セル 分割 し ます （ 全 行 を 指定 し て １ 回 で やっ た 方 が 速い の かも ？ ？ ） ※ Const CLMAX As Long = 1000000 行 数 書き出し たら 、 A 列 を 読み込ま ず 、 列 を 進め て 書き出し し た方 が 速い かも ？ Public Sub Samp 1 ()     Dim ffn As Integer     Dim vA As Variant     Dim sFile As String , sBuf As String , sH As String     Dim i As Long , j As Long     Const CBUFSZ As Long = 50000 ' １ 回 の 読書 き行 数     Const CLMAX As Long = 1000000 ' 折り返 し行 数     With Application . FileDialog ( msoFileDialogFilePicker )        . AllowMultiSelect = False        . Filters . Clear        . Filters . Add " 処理 対象 CSV ファイル ", "*. csv "        If ( Not .S how ) Then Exit Sub        sFile = .S electedItems ( 1 )     End With     Application .S creenUpdating = False     ffn = FreeFile ()     Open sFile For Input As # ffn     sH = ""     i = 1 : j = 1     ReDim vA ( 1 To CBUFSZ , 1 To 1 )     While ( Not EOF ( ffn ))        If ( i > CBUFSZ ) Then           Cells ( j , " A "). Resize ( CBUFSZ ). Value = vA           j = j + CBUFSZ           If ( j > CLMAX ) Then              j = 1              sH = ","           End If           If ( Len ( sH ) > 0 ) Then              vA = Cells ( j , " A "). Resize ( CBUFSZ ). Value           Else              ReDim vA ( 1 To CBUFSZ , 1 To 1 )           End If           i = 1        End If        Line Input # ffn , sBuf        vA ( i , 1 ) = vA ( i , 1 ) & sH & sBuf        i = i + 1     Wend     Cells ( j , " A "). Resize ( CBUFSZ ). Value = vA     Close # ffn     j = 1     While ( j <= CLMAX )        With Cells ( j , " A "). Resize ( CBUFSZ )           . TextToColumns . Cells ( 1 ), xlDelimited , Comma := True        End With        j = j + CBUFSZ     Wend     Application .S creenUpdating = True End Sub ' 確認 用 簡易 データ 作成 Public Sub testData ()     Dim ffn As Integer     Dim vA ( 2 ) As Variant     Dim i As Long     Const CLMAX As Long = 3210987     Const CFILE As String = " D :\ Moge \ Moge . csv " ' ★     Randomize     ffn = FreeFile ()     Open CFILE For Output As # ffn     i = 1     While ( i <= CLMAX )        vA ( 0 ) = i        vA ( 1 ) = Format ( 100 * Rnd (), " 0 . 0 ")        vA ( 2 ) = Format ( 100 * Rnd (), " 0 . 0 ")        Print # ffn , Join ( vA , ",")        If (( i Mod 10000 ) = 0 ) Then           Debug . Print i           DoEvents        End If        i = i + 1     Wend     Close # ffn End Sub 
ビルド する と 、 その プロジェクト の フォルダ に bin フォルダ が 有る んで その 中 の Debug もしくは Release フォルダ に コンパイル さ れ た exe ファイル が 出来 て ます 。 Release で コンパイル し た 物 が 配布 用 だっ た ん だ けど 、 どう 切り替え た か は 失念 。 
「 お 助け 下さい 」 と 言わ れ て も 、 具体 的 な サンプル 表 が ない ので 、 助け よう が あり ませ ん 。 どういう 「 品番 と 仕入 先 コード 」 「 商品名 と 値段 」 「 注 番や 希望 納期 など 必要 な 項目 」 が 何処 に ある の か ？ 「 関数 も 初心者 」 「 適切 な 参照 データ 」 と 言わ れ て も なぁ～ 
こんち に は 。 vba で 、 画面 の ハンドル の 一覧 を 取得 し て リスト に する コード とか 、 いろいろ ツール を 集め て ください 。 昔 やっ た こと は あり ます が 、 不安定 で 、 そんなに 良く ない です 。 最近 は 、 IE の セキュリティ メッセージ が 、 その 方法 で 、 出来 なく なっ たり 、 と 、 半ば 嫌気 が さし て ます 。 その ターゲット に 合わせ た ニーズ で 探し た ほう が 、 いい です ね 。 
一 例 です 。 Sub PDFファイル 保存 () Dim fname As String ' 名前 を 付け て 保存 ダイアログ fname = Application . GetSaveAsFilename ( _ Title :=" 保存 先 を 選べ ！" _ , InitialFileName :="" & Range (" B 10 "). Text & " 様 _ 御 見積もり (" & Range (" T 18 "). Text & "_" & Range (" C1 8 "). Text & " KW )" _ , filefilter :=" PDF 形式 だ よ ,*. pdf , すべて の ファイル ,*.*") ' キャンセル の 場合 If fname = " False " Then Exit Sub ' PDF 変換 対象 の シート Worksheets ( Array (" 見積 ", " 明細 ", " 追加 見積 ", " 追加 見積もり 明細 ")). Select ' 変換 ActiveSheet . ExportAsFixedFormat Type := xlTypePDF , _ Filename := fname , Quality := xlQualityStandard , IncludeDocProperties := True , _ IgnorePrintAreas := False , OpenAfterPublish := False Application . Goto Worksheets (" 入力 フォーム "). Range (" A 2 ") End Sub 未 実行 につき 不具合 ご 容赦 。 
あなた の 書い た プログラム を 載せ て ください 
Windows ( Range (" A1 "). Value & " yyyymm 販売 . xls "). Activate 
VBA から UWSC を 起動 する 方法 は 、 以下 の 方法 で 可能 です 。 Set sh = CreateObject (" WScript .S hell ") ' UWSC の スクリプト を 実行 Set objExec = sh . Exec (" UWSC パス \ uwsc . exe スクリプトフルパス ") ' 実行 終了 まで 待機 Do While ( objExec = 0 ) DoEvents Loop ただ 、 手順 5 の 「 Ctrl + V 」 です が 、 VBA で 実行 する より は 、 UWSC で 実行 し た 方 が 遥か に 容易 で は ない か と 思い ます 。 後 、 手順 6 で ブラウザ を 閉じ て しまっ て い ます が 、 ループ の たび に 起動 し 直す の は 効率 が 悪い と 思い ます 。 また 、 せっかく 値 を 貼り 付け た のに 、 閉じ て しまっ て 良い の でしょ う か 。 何 か ブラウザ 側 で 操作 する の で は あり ませ ん か ？ そして 、 VBA で の ブラウザ 操作 と 言う と 、 IE 操作 が 連想 さ れる の です が 、 これ で 良い の でしょ う か 。 上記 の よう な 疑問 点 が ある の と 、 手順 の うち 、 どこ を 理解 し て いる の か が 不明 だっ た ので 、 今回 は VBA から UWSC を 起動 する 部分 のみ の 回答 と なり まし た 。 不明 な 点 が はっきり すれ ば 、 コード は 示せる と 思い ます 。 
基本的 に は " 請求書 " & Range (" A1 "). Value で いい です 。 です が 、 もし A1 に 入っ て いる の が 数字 の 7 で 、 そこ から 「 請求書 ０ ７ 」 に し たい 、 という こと だ と 、 ひと 工夫 必要 に なり ます 。 
こんな でしょ う か 。 Sub sample () Dim lastRow As Long Dim r As Long lastRow = Range (" K " & Rows . Count ). End ( xlUp ). Row ' K 列 最終 行 For r = 1 To lastRow ' 注目 行 を 1 行 目 から K 列 最終 行 まで If Range (" K " & r ). Value < 0 Then ' もし K 列 注目 行 の 値 が マイナス の 場合 If Range (" M " & r ). Value = "" Then ' もし M 列 注目 行 の 値 が 無い 場合 Range (" M " & r ). Value = - Range (" K " & r ). Value ' M 列 注目 行 の 値 を K 列 注目 行 の 値 の マイナス の 値 ( マイナス の マイナス で プラス ) に する End If End If Next End Sub また 、 K 列 の 値 が 数値 と は 限ら ない 場合 は 、 その チェック も 必要 と なり ます 。 Sub sample () Dim lastRow As Long Dim r As Long lastRow = Range (" K " & Rows . Count ). End ( xlUp ). Row ' K 列 最終 行 For r = 1 To lastRow ' 注目 行 を 1 行 目 から K 列 最終 行 まで If IsNumeric ( Range (" K " & r ). Value ) Then ' もし K 列 注目 行 の 値 が 数値 の 場合 If Range (" K " & r ). Value < 0 Then ' もし K 列 注目 行 の 値 が マイナス の 場合 If Range (" M " & r ). Value = "" Then ' もし M 列 注目 行 の 値 が 無い 場合 Range (" M " & r ). Value = - Range (" K " & r ). Value ' M 列 注目 行 の 値 を K 列 注目 行 の 値 の マイナス の 値 ( マイナス の マイナス で プラス ) に する End If End If End If Next End Sub 
> コード の 問題 で は ない と 思い ます 。 質問 する の なら 、 自身 で 判断 し ない で すべて を さらけ出す くらい の 考え を もた ない と 問題解決 は 無理 。 どの よう な コーディング が さ れ た か が 解ら ない の で は 、 再現 テスト さえ でき ませ ん よ ね ？ その よう な 状態 で は 、 アドバイス しよ う が ない という の は お 解り です よ ね ？ アドバイス する の なら 、 こんな 事 ↓ しか 思いつき ませ ん 。 相当 前 から 、 RefEdit コントロール は 、 トラブル が 多い ので 有名 でし た 。 http:// www . h3 . dion . ne.jp /~ sakatsu / Excel _ Tips 08 . htm あなた が 使っ て いる バージョン で どう な の か は 、 ご 自身 で 調べる 必要 が ある の かも 。 
Sub sample () Columns ( 1 ). SpecialCells ( xlCellTypeBlanks ). Delete Shift := xlUp End Sub 
hoijujdhuoshdo さん 、 こんばんは 。 まず アルゴリズム です が 、 C :\ TEST フォルダ に ある ファイル を 開く 処理 は M acr o2 で 行っ て いる ので 、 削除 作業 も M acr o2 で 行う 方 が 良い と 思い ます 。 （ Macro 1 で 削除 し て しまう と 、 M acr o2 に 戻っ た 時 に 、 WB . Close ステートメント で エラー に なり ます 。 ） それ から 、 ファイル を 削除 する Kill ステートメント の 引き 数 は 文字列 で 指定 し ます 。 お 書き の コード で は 、 文字列 に Workbook オブジェクト を ひっ つけ て い ます ので 、 エラー に なり ます 。 従って 、 お 書き の の コード を 、 例えば 下 の よう に 変更 し て み て は いかが でしょ う か ？ Macro 1 中 Kill " c :\ TEST \" & WB ActiveWindow . Close の ２ 行 を 削除 M acr o2 中 If Range (" M3 "). Value = 201606 Then ' M3 値 で 条件 分岐 Call macro 1 WB . Close Kill fol & "\" & f ' この 行 を 追加 End If あと 、 余談 です が 、 M acr o2 で M3 の 条件 分岐 に ひっかから なかっ た 場合 は 元 ファイル を 閉じ ない 仕様 に なっ て い ます が 、 そこ は 問題 ない の です か ね ？ ちょっと 気 に なっ た ので 。 
BouncyCastle という ライブラリ を 使う と 、 PKCS 12 の 読み書き が 簡単 に でき ます 。 NuGet から 「 BouncyCastle 」 を インストール する と 使え ます 。 MIT ライセンス な ので 安心 です 。 下記 は C# です が 、 鍵 生成 から PKCS 12 の 生成 と 入出力 を 実験 し て み た コード です 。 ご 参考 に なり まし たら 。 using System ; using System . Collections . Generic ; using System . IO ; using System . Text ; using Org . BouncyCastle . Asn 1 ; using Org . BouncyCastle . Asn 1 . X5 09 ; using Org . BouncyCastle . Crypto ; using Org . BouncyCastle . Crypto . Generators ; using Org . BouncyCastle . Crypto . Operators ; using Org . BouncyCastle . Crypto . Parameters ; using Org . BouncyCastle . Crypto . Prng ; using Org . BouncyCastle . Math ; using Org . BouncyCastle . OpenSsl ; using Org . BouncyCastle . Pkcs ; using Org . BouncyCastle .S ecurity ; using Org . BouncyCastle . X5 09 ; name space ConsoleExample { class Program { static void Main ( string [] args ) { // 鍵 の ジェネレータ var randGen = new CryptoApiRandomGenerator (); var rand = new SecureRandom ( randGen ); var param = new KeyGenerationParameters ( rand , 4096 ); // 鍵 生成 var keyGen = new RsaKeyPairGenerator (); keyGen . Init ( param ); var keyPair = keyGen . GenerateKeyPair (); // 証明書 の 属性 var attr = new Dictionary < DerObjectIdentifier , string >(); attr . Add ( X5 09 Name. CN , " link . studio - ephyra "); attr . Add ( X5 09 Name. C , " Japan "); attr . Add ( X5 09 Name. ST , " Nagano - Ken "); attr . Add ( X5 09 Name. L , " Nagano - Shi "); attr . Add ( X5 09 Name. O , " Studio - Ephyra "); attr . Add ( X5 09 Name. OU , " None "); var ord = new List < DerObjectIdentifier >(); ord . Add ( X5 09 Name. CN ); ord . Add ( X5 09 Name. C ); ord . Add ( X5 09 Name. ST ); ord . Add ( X5 09 Name. L ); ord . Add ( X5 09 Name. O ); ord . Add ( X5 09 Name. OU ); // 証明書 の 生成 var name = new X5 09 Name ( ord , attr ); var certGen = new X5 09 V3 CertificateGenerator (); certGen .S etSerialNumber ( BigInteger . One ); certGen .S etIssuerDN ( name ); certGen .S etSubjectDN ( name ); certGen .S etNotBefore ( Da te Time. Now ); certGen .S etNotAfter ( Da te Time. Now . AddYears ( 10 )); certGen .S etPublicKey ( keyPair . Public ); var cert = certGen . Generate ( new Asn 1 SignatureFactory (" SHA 512 WITHRSA ", keyPair . Private , rand )); // 秘密鍵 の 出力 using ( var writer = new StreamWriter (@" D :\ Download s \ privatekey . pem ", false , Encoding . ASCII )) { var pemWriter = new PemWriter ( writer ); pemWriter . WriteObject ( keyPair . Private ); pemWriter . Writer . Flush (); } // 公開鍵 の 出力 using ( var writer = new StreamWriter (@" D :\ Download s \ publickey . pem ", false , Encoding . ASCII )) { var pemWriter = new PemWriter ( writer ); pemWriter . WriteObject ( keyPair . Public ); pemWriter . Writer . Flush (); } // 証明書 の 出力 using ( var writer = new StreamWriter (@" D :\ Download s \ certificate . crt ", false , Encoding . ASCII )) { var pemWriter = new PemWriter ( writer ); pemWriter . WriteObject ( cert ); pemWriter . Writer . Flush (); } AsymmetricCipherKeyPair privateKey ; RsaKeyParameters publicKey ; Org . BouncyCastle . X5 09 . X5 09 Certificate readedCert ; // 秘密鍵 の 読み込み using ( var reader = new StreamReader (@" D :\ Download s \ privatekey . pem ", Encoding . ASCII )) { var pemReader = new PemReader ( reader ); privateKey = ( AsymmetricCipherKeyPair ) pemReader . ReadObject (); } // 公開鍵 の 読み込み using ( var reader = new StreamReader (@" D :\ Download s \ publickey . pem ", Encoding . ASCII )) { var pemReader = new PemReader ( reader ); publicKey = ( RsaKeyParameters ) pemReader . ReadObject (); } // 証明書 の 読み込み using ( var reader = new StreamReader (@" D :\ Download s \ certificate . crt ", Encoding . ASCII )) { var pemReader = new PemReader ( reader ); readedCert = ( Org . BouncyCastle . X5 09 . X5 09 Certificate ) pemReader . ReadObject (); } // PKCS 12 の 生成 var certEntry = new X5 09 CertificateEntry ( cert ); var keyEntry = new AsymmetricKeyEntry ( privateKey . Private ); var p 12 = new Pkcs 12 Store (); p 12 .S etCertificateEntry ( attr [ X5 09 Name. CN ], new X5 09 CertificateEntry ( cert )); p 12 .S etKeyEntry (" tana ", keyEntry , new X5 09 CertificateEntry [] { certEntry }); // PKCS 12 の 出力 using ( var stream = new FileStream (@" D :\ Download s \ pkcs 12 . p 12 ", FileMode . Create )) { p 12 .S ave ( stream , " password ". ToCharArray (), rand ); stream . Flush (); } Pkcs 12 Store readedP 12 ; // PKCS 12 の 読み込み using ( var stream = new FileStream (@" D :\ Download s \ pkcs 12 . p 12 ", FileMode . Open )) { readedP 12 = new Pkcs 12 Store ( stream , " password ". ToCharArray ()); } // 秘密鍵 の 取得 と 書き込み using ( var writer = new StreamWriter (@" D :\ Download s \ pkcs 12 privatekey . pem ", false , Encoding . ASCII )) { var pemWriter = new PemWriter ( writer ); pemWriter . WriteObject ( readedP 12 . GetKey (" tana "). Key ); pemWriter . Writer . Flush (); } Console . Write Line (" OK "); Console . ReadLine (); } } } 
> 日付 より 大きけれ ば 処理 を し ない ★ の 行 の 「 Date 」 を 比較 し たい 日付 の セル に 、 変更 し て ください 。 If . Value = " リンゴ " Or . Value = " ミカン " Then i = 1 - . Column ii = 1 - . Row j = j + 1 . Offset ( ii ). Copy sh . Cells ( j , 1 ) . Offset (, i ). Copy sh . Cells ( j , 3 ) . Copy sh . Cells ( j , 5 ) End If ↓ If . Value = " リンゴ " Or . Value = " ミカン " Then ii = 1 - . Row If . Offset ( ii ). Value >= Date Then '★ i = 1 - . Column j = j + 1 . Offset ( ii ). Copy sh . Cells ( j , 1 ) . Offset (, i ). Copy sh . Cells ( j , 3 ) . Copy sh . Cells ( j , 5 ) End If End If > 罫線 を 引く こと を 省き たい With sh . Cells ( 1 ). Current Region . Borders . LineStyle = True With . Offset ( 1 ). Resize (. Rows . Count - 1 ) ↓ With sh . Cells ( 1 ). Current Region With . Offset ( 1 ). Resize (. Rows . Count - 1 ) 
あなた の コード を 整理 する と ↓ の よう な 感じ です か ね ？ Sub DATA () Dim sh As Worksheets , h As Long , i As Long Application .S tatusBar = " 処理 実行 中 ． ． ． ． " Set sh = Worksheets (" Sheet 1 ") With Worksheets (" Sheet 2 ") . Range (. Cells ( 1 , 1 ), . Cells ( 20000 , 5 )). Clear i = 5 h = . Cells ( Rows . Count , 2 ). End ( xlUp ). Row + 1 Do Until sh . Cells ( i , 3 ). Value = "" sh . Cells ( i , 14 ). Copy . Cells ( h , 2 ) . Cells ( h , 3 ) = " AAAA " sh . Cells ( i , 13 ). Copy . Cells ( h , 4 ) sh . Cells ( i , 12 ). Copy . Cells ( h , 5 ) i = i + 1 h = h + 1 Loop End With Application .S tatusBar = "" End Sub ただ 、 コピー 対象外 の 行 が ない の だ から 、 縦長 の セル 範囲 を 割り出し て 、 一気に コピー し た ほう が 効率的 。 Sub sample () Dim sh As Worksheets , i As Long Application .S tatusBar = " 処理 実行 中 ． ． ． ． " Set sh = Worksheets (" Sheet 2 ") With sh . Range (. Cells ( 1 , 1 ), . Cells ( 20000 , 5 )). Clear End With With Worksheets (" Sheet 1 ") i = . Cells ( Rows . Count , 3 ). End ( xlUp ). Row . Range (. Cells ( 5 , 14 ), . Cells ( i , 14 )). Copy sh . Cells ( 2 , 2 ) . Range (. Cells ( 5 , 13 ), . Cells ( i , 13 )). Copy sh . Cells ( 2 , 4 ) . Range (. Cells ( 5 , 12 ), . Cells ( i , 12 )). Copy sh . Cells ( 2 , 5 ) sh . Cells ( h , 3 ). Resize ( i - 4 ). Value = " AAAA " End With Application .S tatusBar = "" End Sub 
A 、 B 、 C の 各 フォルダー 内 に ある 集計 表 が 、 Master フォルダ の 名簿 を 参照 し に 行く よう に し たい という こと です か ？ > この 部分 で , Master フォルダ を 指定 し たい ブック は 既に オープン 済 。 フォルダ を この 時点 で 指定 する こと は 出来 ませ ん 。 やる なら 、 ↓ の 変更 でしょ う 。 。 mypath = ThisWorkbook . Path Workbooks . Open Filename := mypath & "￥ 名簿 . xlsm " ↓ With CreateObject (" Scripting . FileSystemObject ") mypath = . GetFolder ( ThisWorkbook . Path ). ParentFolder & "\ Master " End With Workbooks . Open Filename := mypath & "￥ 名簿 . xlsm " 未 実行 につき 不具合 ご 容赦 。 
ワイルドカード の よう に 扱う 場合 は 、 1 行 で は 無理 です 。 全て の 開い て いる ブック の 名前 を 調べ て 、 該当 する もの を アクティブ に する 、 という 方法 ぐらい しか とれ ない と 思い ます 。 Sub test () For Each wb In Workbooks If ( wb . Name Like " chiebukuro *. csv ") Then wb . Activate Exit For End If Next End Sub 
最近 、 workSheet . select ( False ) で 動か ない 質問 が 出 て ます ね 。 同じ 質問者 です か ？ ひょっ として 古い 方法 で バージョンアップ で 使え なく なっ た ？ 普通 は 名前 を 全部 配列 に 代入 し て 、 WorkSheets ( Arr ). select とか し ます 。 でも 、 面倒 だ から 私 なら まとめ ない で 1 個 ずつ 消し ます けど ね 。 大量 に ある の です か ？ 
その 差分 40 分 を セル A 4 : B4 に 着色 さ せ たい この 文章 じゃ 意味 が 取れ ない と 思う の です が 、 コード を 見る と どうも E 1 が ２ ０ 分 より 小さい 値 なら A 4 セル だけ を 赤 に 塗りつぶす 。 ４ ０ 分 より 小さい 値 なら A 4 : B4 を 赤 で ぬりつぶす 、 という 意味 か な ？ と 思い ます 。 ただ ２ ０ 分 より 小さい 、 は 、 ４ ０ 分 より 小さい に 含ま れ て しまう ので ２ ０ 分 より 小さい 値 なら A 4 セル だけ を 赤 に 塗りつぶす 。 ２ ０ 分 以上 、 ４ ０ 分 より 小さい なら A 4 : B4 を 赤 に 塗りつぶす 。 という こと か な ？ と も 考え られ ます 。 VBA で は TimeValue (" 0 : 20 : 00 ") > eTime >= TimeValue (" 0 : 00 : 00 ") の よう な 書き方 は でき ませ ん 。 これ は 数式 で も 同じ です 。 VBA で は TimeValue (" 0 : 20 : 00 ") > eTime And TimeValue (" 0 : 00 : 00 ")<= eTime 数式 だ と AND ( TimeValue (" 0 : 20 : 00 ") > eTime , TimeValue (" 0 : 00 : 00 ")<= eTime ) です 。 また 時刻 は マイナス の 値 に する こと は でき ない ので TimeValue (" 0 : 00 : 00 ")<= eTime は 考慮 する 必要 が ない です 。 マイナス の 値 の 時 は E 1 が ＃ で 埋め 尽くさ れ 意味 が ない ので 上 の 解釈 で あっ て いれ ば Sub test () Dim eTime As Single eTime = Range (" E 1 "). Value If eTime >= 0 Then If TimeValue (" 0 : 20 : 00 ") > eTime Then Range (" A 4 "). Select With Selection . Interior . Pattern = xlSolid . PatternColorIndex = xl Automatic . Color = 255 . TintAndShade = 0 . PatternTintAndShade = 0 End With ElseIf TimeValue (" 0 : 40 : 00 ") > eTime Then Range (" A 4 : B4 "). Select With Selection . Interior . Pattern = xlSolid . PatternColorIndex = xl Automatic . Color = 255 . TintAndShade = 0 . PatternTintAndShade = 0 End With End If End If End Sub という 感じ です 。 ひとつ の IF 構文 の 中 に 条件 を 入れる と 先 に 書い た ほう から 判定 さ れ 実行 さ れる の は 一つ です 。 ２つ に 分ける と ２つ とも 実行 さ れ て しまい ます 。 ただ コード が 冗長 な の と 、 繰り返し この コード を 実行 する こと が ある なら １ 回 塗りつぶし を 解除 し て から 実行 し た ほう が いい ので Sub test () Dim eTime As Single Range (" A 4 : B4 "). ClearFormats ' A ４ : B4 の 塗りつぶし を 「 なし 」 に する eTime = Range (" E 1 "). Value If eTime >= 0 Then If TimeValue (" 0 : 20 ") > eTime Then Range (" A 4 "). Interior . Color = 255 ElseIf TimeValue (" 0 : 40 ") > eTime Then Range (" A 4 : B4 "). Interior . Color = 255 End If End If End Sub として も 内容 は 同じ です 。 
chielien _ d 7123 e2 4 c 7 f 735 ca 60 c 2b cfd さん 、 こんばんは 。 お 書き の コード は 、 B 3 セル の 値 で 処理 を 分岐 する 構造 か と 思い ます ので 、 select 文 を 使っ て 書け ば 、 すっきり する と 思い ます が 、 いかが でしょ う か ？ コード として は 、 こんな 感じ です 。 Select Case Range (" B 3 "). Value Case " X 207 "," X 980 "," X 981 "," X 982 "," X 983 " myRange . Offset ( 2 , 15 ) = Worksheets (" 生産量 計算 シート "). Cells (" A 2 "). Value myRange . Offset ( 2 , 16 ) = Worksheets (" 生産量 計算 シート "). Cells (" D2 "). Value Case " 222 " myRange . Offset ( 2 , 17 ). Value = Worksheets (" 生産量 計算 シート "). Cells (" A 2 "). Value myRange . Offset ( 2 , 18 ). Value = Worksheets (" 生産量 計算 シート "). Cells (" D2 "). Value Case " 210 "," 211 "," 212 "," 213 "," 216 " ' ・ ・ ・ 以下 同様 myRange . Offset ( 2 , 19 ). Value = Worksheets (" 生産量 計算 シート "). Cells (" A 2 "). Value myRange . Offset ( 2 , 20 ). Value = Worksheets (" 生産量 計算 シート "). Cells (" D2 "). Value Case ・ ・ ・ ・ ・ ・ ・ ・ End Select セル B 3 の 値 が 整数 なら ば 、 連続 数 は 範囲 指定 でき ます 。 Case 210 , 211 , 212 , 213 -> Case 210 To 213 オンラインヘルプ で Select Case 構文 を 調べ て もらえ ば わかる と 思い ます 。 
With Selection . Value = . Value . NumberFormatLocal = " yyyy / mm / dd " End With だけ で いいんじゃない の と 思い ます けど … … 
マクロ を 使用 する 場合 の コード を 示し ます 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st 2 As Worksheet Dim r1 As Long , data As String , r2 As Long Set st 1 = Worksheets (" 削除 データ ") Set st 2 = Worksheets (" 除外 リスト ") For r1 = 1 To st 1 . Range (" B " & Rows . Count ). End ( xlUp ). Row data = st 1 . Range (" B " & r1 ). Value If Len ( data ) = 11 Then r2 = st 2 . Range (" A " & Rows . Count ). End ( xlUp ). Offset ( 1 ). Row st 2 . Range (" A " & r2 ). Value = Mid ( data , 1 , 3 ) st 2 . Range (" B " & r2 ). Value = Mid ( data , 4 , 8 ) End If Next End Sub 
他 の パソコン も 当然 同じ 環境 に なっ て い ます か 。 > フォルダ A に 、 エクセル B と フォルダ C を いれ て ます 。 > フォルダ C は 画像 を 保管 し て いる 場所 です 。 この 二 点 です 。 貴方 の パソコン に しか 画像 が 入っ て い なけれ ば 、 当然 表示 さ れ ませ ん ね 。 画像 を 色々 な パソコン に 入れ たく （ ばらまき たく ） ない の で あれ ば 貴方 の パソコン を 共有 で 他 の パソコン から 見える よう に する とか 、 皆 が 見える サーバー が ある なら 、 サーバー に 画像 を 入れる か し て 下さい 。 それから 、 補足 です が Pictures . Insert で は 画像 の 保存 場所 が 替わっ たり し た 時 、 次に ファイル が 表示 さ れ なく なっ て い ます 。 一時的 に 表示 する だけ なら いい の です が 、 エクセル ブック に 取り込ん で おき たい の で あれ ば AddPicture に し た 方 が いい です 。 
コード 例 です 。 Sub Sample () Dim Rng As Range For Each Rng In ActiveSheet . UsedRange If IsDate ( Format ( Rng . Value , " h : nn ")) Then Select Case Format ( Rng . Value , " hnn ") Case 0 To 700 Rng . Value = "●" Case 701 To 1030 Rng . Value = "○" Case 1031 To 1530 Rng . Value = "△" Case 1531 To 2359 Rng . Value = "●" End Select Else Select Case Rng . Value Case " 有給 " Rng . Value = "□" Case " 公休 " Rng . Value = "■" End Select End If Next End Sub 
LOOKUP 関数 次 式 で 検証 し て いただけ ます か 。 = LOOKUP ( 10 ^ 10 , T : T ) ＞= IFERROR ( IF ( L 15 + K 16 = L 15 ,"", L 15 + K 16 ),"") 提示 さ れ た 数式 は 次 式 で 同意 です ね 。 = IFERROR ( IF ( K 16 , L 15 + K 16 ,""),"") 
なぜ 解決済み に し た 質問 を 全く 同じ 文面 で 何度も 何 度 も 繰り返す の です か ？ 2014年 から こんな こと を 繰り返し て いる のに 「 プログラミング は 初心者 です 」 と は どういう こと でしょ う ？ あなた は とことん 悪質 です ね 。 ブラックリスト に 入れ て おき ます 。 http:// chiebukuro . yahoo . co.jp / my / myspace _ quedetail . php ? writer = nnryh ... 同じ 質問 の 繰り返し 2016 / 7 / 20 13 : 12 : 14 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1416188539 ... 2016 / 7 / 19 11 : 59 : 20 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1416184330 ... これ も 同じ 質問 の 繰り返し 2015 / 7 / 10 16 : 21 : 38 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1314768516 ... 2015 / 7 / 10 16 : 20 : 10 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1314768512 ... これ も 同じ 質問 の 繰り返し 2015 / 6 / 23 22 : 00 : 02 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1114679336 ... 2015 / 6 / 23 16 : 00 : 01 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1214678143 ... 2015 / 6 / 16 21 : 08 : 19 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1414679343 ... 2015 / 6 / 16 12 : 34 : 57 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q10 14677717 ... これ も 同じ 質問 の 繰り返し 2014 / 9 / 14 08 : 57 : 42 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q10 13552604 ... 2014 / 9 / 12 08 : 38 : 45 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1213543773 ... 2014 / 9 / 11 16 : 41 : 06 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q10 13540683 ... 2014 / 9 / 10 18 : 38 : 46 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1213536713 ... 
５ 行 目 の 記述 が 抜け てる 。   50     sum = su m+ ary ( cnt ) 11 行 目 の   else   print ""   は 不要 で は ？ 110     if   ary ( cnt )>= avg   then   print   ary ( cnt ) 
A3 = IF ( A 2 ="","", IF ( A1 , IF ( A 2 >= 32400 , 648 , IF ( A 2 >= 10800 , 432 , 324 )),"")) ＞③ A 2 の セル が 「 10800 」 以下 の とき 、 A3 の セル に 「 324 」 以上 以下 は その 数値 含み ます ③ A 2 の セル が 「 10800 」 未満 の とき 、 A3 の セル に 「 324 」 の 式 です 
こんにちは。 コード に 大きな 問題 は 見当たり ませ ん が 、 もし 、 ターゲット フォルダ が 、 「 ネットワーク で みんな が 使う 」 という 空間 だっ た 場合 、 話 は 変わり ます 。 もし そう なら 、 1 ) ターゲットフォルダ を 指定 し たら 、 dir の ファイル 一覧 表 を 、 自分 の シート に 全部 書き出し する 。 2 ) 上記 に ある ブック を 開い て 転記 し て 閉じる の ループ を 実行 として ください あと 、 workbook . close は 、 close savechanges := false を 追加 し て 、 なに も し ない で 保存 、 を 明示 し て ください 。 もし 、 ネットワーク タイプ の コード で 、 ローカル パソコン で も 変化 し たら 、 原因 は OS の エクスプローラ です 。 
BASIC 言語 について は 分かり ませ ん が 、 合計 値 を なに で 割れ ば いい か に関して は 「 数 を 入力 し た 回数 」 です 
パソコン だ と 、 画像 の 拡大 でき ない ん です よ ねー 。 スマホ で は できる ん です が 、 文章 くらい は 、 質問者 に 書い て 欲しい ところ と 、 前々 から 思っ て いる の です が 、 プログラミング の 宿題 です よ ね ？ プログラミング って 、 同じ もの で も 、 いろいろ な 書き方 が ある ので 、 宿題 だ と する と 、 提出 し た 後 で 、 「 お前 そこ 、 まだ 教え て ない 部分 だ けど 、 誰 か に やっ て もらっ た だろ ？ 」 的 な こと に なら ん か なー ？ と 。 仕事 なら それでも いい ん です が 、 宿題 だ と 、 正確 な 回答 に は なら ない か なー ？ と 。 Q 1 . 耳 が 2つ あり ます 。 ウサギ が 3 羽 いる とき に 、 耳 は ぜんぶ で いくつ え 、 2 ｘ 3 は 正解 で 、 3 ｘ 2 は バツ に する 先生 も いる よう です 。 アホ な 話 な ん です が 、 教え られ た 範疇 の 物事 を 使っ て 回答 する という 宿題 なら 、 どこ まで を 勉強 し た の か ？ を 教え て くれ ない と 、 正解 が 出せ ない こと に 。 ＾ ＾ ； どう な ん です か ね ？ と 、 逆 に 質問 を 。 ｗ 
Sub 一 例 です () Dim xFSO , buf As String , moji As String , xPath As String Set xFSO = CreateObject (" Scripting . FileSystemObject ") buf = Application . GetOpenFilename ( FileFilter :=" ライブラリ ファイル ,*. lib ", Title :=" ファイル の 指定 ") If buf = " False " Then Exit Sub With xFSO . GetFile ( buf ) xPath = . ParentFolder & "\" With . OpenAsTextStream ( 1 ) moji = . ReadAll . Close End With '（ ここ で 文字列 moji の 内容 の 修正 ） With xFSO . OpenTextFile ( xPath & " 別名 の ファイル 名 . lib ", 2 , True ) . Write moji . Close End With . Delete End With End Sub 
たしかに 、 Excel 2010 と 2013 では VBA の バージョン も 違い ます （ 2010 は 7 . 0 , 2013 は 7 . 1 ） が 、 VBA の バージョン の 違い で は なく て 、 Excel の バージョン の 違い による 速度 の 差 で は ない でしょ う か 。 たとえば シート の 保護 の 設定 ・ 解除 という よう な 処理 とか 、 シート を 選択 する よう な 処理 、 あるいは クリップボード を 介し た コピー ＆ ペースト （ 特に シート 間 ） といった 処理 は 、 Excel 2010 より 2013 の 方 が 時間 が かかる よう です 。 （ セキュリティ の 強化 の 影響 という こと らしい です 。 ） 手動 操作 で は それほど 気 に なら なく て も 、 マクロ の ループ 内 で 多数 回 処理 する よう な 場合 に は 、 大きく 影響 し て いる 可能性 が あり ます ね 。 特に あり そう な の は コピー ＆ ペースト の 処理 です 。 該当 する よう な 場合 に は 、 別 の 処理 に 置き換える （ Copy や Cut , Paste は 使わ ず 、 セル の 値 を 変数 に 入れ て 処理 する など ） 、 など すれ ば 、 改善 する か も しれ ませ ん 。 該当 し そう に も ない なら 、 画面 更新 、 自動 再 計算 、 イベント 割り込み を 停止 する ため Application .S creenUpdating = False Application . Calculation = xlCalculationManual Application . EnableEvents = False として から 処理 を 行い 、 処理 後 に Application . EnableEvents = true Application . Calculation = xlCalculationAutomatic Application .S creenUpdating = true と 戻す よう な 事 で も 、 マシ に なる かも しれ ませ ん 。 
方法 として は 、 検索 結果 の 画面 から A タグ を 全て 取得 、 その 中 から 「 ラブライブ！ Official Web Site 」 という テキスト を 含む もの を 選ん で Click メソッド を 発行 する 、 という もの です 。 Set atags = objIE . document . getElementsByTagName (" a ") For Each a In atags If ( a . InnerText =" ラブライブ！ Official Web Site ") Then a . Click Exit For End If Next クリック 後 の 部分 に は 、 きちんと 表示 終了 待ち 処理 を 追加 し て おい て ください 。 ただ 、 他 へ の 応用 を 考える なら ば 、 タグ を 見つけ出す 過程 で の 考え方 を きちんと 理解 し て おい て ください 。 この コード を 雛形 に し て 、 という の は 無理 が ある と 思い ます 。 HTML ソースコード は ページ 毎 に 違う もの です から 。 
こんにちは。 コード が 出来 ない 原因 は 、 ユーザー フォーム に 正しい コントロール が ある の か 、 確認 し て ください 。 14 ある 、 という 部分 です が 、 If CheckBox 1 . Value = True Then が 変化 する という こと でしょ う か 。 印刷 し たい シート 名 は 変化 し ます か 、 それとも 、 印刷 の 範囲 でしょ う か 。 1 ) 印刷 の 範囲 は 、 変化 し ない 、 という 場合 シート の 印刷 範囲 は 、 一度 設定 し て 保持 でき ます 。 コード に する 必要 は あり ませ ん 。 チェック と 「 印刷 し たい シート 名 」 が 関連 し て いる 、 という の でし たら 、 シート 名 を 縦 に 並べ た 場所 を 作業 の シート として 用意 し て 、 vlookup の よう に 使う こと でし て ください 。 例えば 、 「 印刷 作業 」 という シート の A1 は 、 チェック コントロール の controlsource に 設定 コントロール 2 は A 2 セル 、 と 順番 に 設定 し 、 14 は A1 4 セル と し ます 。 B 列 は 、 「 印刷 し たい シート 名 」 を 設定 。 ( もし 、 セル 範囲 が 可変 でし たら 、 B 列 は 、 セル 範囲 の 文字列 と し ます 。 C1 セル に は = if ( A1 , 1 , 0 ) の 関数 を 設定 し 、 C1 4 まで コピー です 。 C1 5 は = sum ( C1 : C1 4 ) と し て ください 。 チェックコン と ロール の group プロパティ に グループ 名 を 設定 し たら 、 選択 は いずれ か ひとつだけ と なり ます コード の 最初 の ながい 部分 は 、 C1 5 セル の 数値 が 0 の 場合 、 選択 し て い ない こと に なり ます 。 普通 は 、 ディフォルト を 設定 し ます 。 全部 指定 し たら 、 全部 印刷 し たい 、 という こと なら 、 group は 空欄 で いい です 状況 が わから ない ので 、 まずは 、 整理 し て ください 
まず 、 「 ” ” 」 内部 に 表記 し て しまっ たら 、 「 Cells 」 という 命令 と は 認識 さ れ ませ ん 。 単なる 文字列 に なっ て しまい ます 。 「 ” ” 」 から くくり 出し て 、 外側 で Cells の 値 を 表記 し 、 文字列結合 で 表現 し ます 。 後 、 SUM 関数 は アドレス で 指定 する の です が 、 単に Cells を 表記 する と 、 暗黙 の 約束 で 「 Value 」 を 付記 し た もの と 見なさ れ ます 。 つまり 、 Cells ( 3 , 2 ) は 「 32500 」 と なっ て しまい ます 。 従って 、 以下 の よう に 記述 し て み て ください 。 Cells ( i , 3 ). Formula = "= SUM ( B 3 :" & Cells ( i , 2 ). Address ( 0 , 0 ) & ")" 
お 示し の マクロ を 格納 し た ブック の Sheet 22 の A1 セル に 、 「 完了 」 が 入力 さ れ て いる の で あれ ば 、 If . Cells ( i , 1 ). Value = " 誤記 " Then ↓ If . Cells ( i , 1 ). Value = MySh . Cells ( 1 , 1 ). Value Then あと 、 本論 に は 関係 ない です が 、 ↓ の 変更 も し た ほう が 良い です ね 。 For Each Wb In Workbooks If Wb . Name <> ThisWorkbook . Name Then Set MySh = ThisWorkbook . Worksheets (" Sheet 22 ") ↓ Set MySh = ThisWorkbook . Worksheets (" Sheet 22 ") For Each Wb In Workbooks If Wb . Name <> ThisWorkbook . Name Then 
>③ 取得 し た ファイル 名 から 必要 な 機器 の ファイル を 選び 、 その ファイル に 入っ て > いる シート を > 機器 仕様書 として まとめる Excel ファイル に 挿入 する 。 どんな （ 形式 、 内容 ） ファイル を どの よう に 挿入 する の か 、 大事 な 部分 が 抜け てる ので みなさん 返事 し にくい と 思い ます よ 。 
http:// www . nsdn . co.jp / AutoCAD / index .s html 結構 い じれる みたい です 。 
こんにちは。 word の vba の こと で いい ん でしょ う か 。 ms ワード は 、 ドキュメント を 開く 構文 が 、 あり ます 。 主 様 の コード は 、 インテリセンス で 表示 し た もの です か ？ set wdapp = create object (” word . apprecateon ”) set doc = wdapp . に 、 ワード で vbe 画面 で 作成 し た コード を 貼り 付ける など し て 、 ください 。 参照 設置 を 有効 に つかう なら 、 変数 の 定義 が 、 不足 し て ます 
未 テスト な ので 確信 ありません が 、 ×c = MyDat . Column ○ c = MyDat ( 1 ). Column MyDat は セル 範囲 つまり 複数 セル な ので 、 そのまま column を 得よ う と する と エラー だ と 思い ます 。 MyDat の 先頭 セル を 指定 する なら 大丈夫 です 。 
こんにちは。 おしかっ た です ね 、 最後 の 部分 Range (" D4 : D 8 "). Formula = "= B4 * C4 " が 正解 Range (" C4 : C 8 "). Formula = "= SUM ( Sheet 1 : Sheet 3 ! C4 )" Range (" C4 : C 8 "). Formula = "= B4 * C4 " これ 、 うわがき し て ます よ ね 。 
状況 が よく 分かり ませ ん 。 一旦 読み込ん だ レコードセット は 途中 で 更新 し て も 再 読込 し ない かぎり 並び 順 が かわる こと は ない です 。 もう少し 具体 的 に やっ て いる こと 、 どの よう な 検索 条件 で どの よう な 更新 を し て いる か を 説明 し て ください 。 あるいは 、 実際 の コード を 提示 し た ほう が 間違い を 指摘 し やすい です ね 。 以下 は アドバイス です が 通常 は 、 検索 条件 に あう レコード を 更新 する 場合 、 FindFirst , FindNext で 更新 する より 、 開く とき に 抽出 条件 を 設定 し て 開い て 、 全 件 更新 する ほう が 効率的 で 高速 です 。 可能 なら 更新 クエリ で 更新 する の が 一番 高速 です 。 
こんな 感じ です 。 With Range (" AV " & Rows . Count ). End ( xlUp ) . AutoFill Destination :=. Resize ( 2 ), Type := xlFillDefault End With 
結合 セル 内 の 横線 は 以下 部分 で 消し て いる ので >     For i = 1 To r . Offset (, - 1 ). MergeArea . Cells . Count - 1 >        With r . Offset ( i - 1 ). Resize (, 2 ) >           . Borders ( xlEdgeBottom ). LineStyle = xlLineStyleNone >        End With >     Next ↓ 上記 を 削除 し 、 代わり に 、 その 場所 に 以下 を 記述 し て み て ください     i = r . Offset (, - 1 ). MergeArea . Cells . Count ※ なお 、 赤色 に し ない の なら . Color Index = 3 の 部分 は 削除 し て み て ください 
考え方 を お 教え し ます 。 FileSystemObject ( FSO ) を 使っ て 、 さらに 「 再帰 処理 」 で 配下 の サブ フォルダ 全て を 探索 し て ファイル 名 を 取得 し 、 それ を 利用 し て Excel を 加工 すれ ば でき ます 。 参考 として は http:// www . asahi-net . or .jp /~ ef 2 o - inue / vba _ o / sub 05 _ 110 _ 080 . html の FileSystemObject 欄 を 見 て いただけれ ば いける はず です 。 注意 し なく て は いけ ない の が 、 ファイル 名 だけ で は EXCEL は 開け ませ ん 。 ファイル パス ＋ ファイル 名 が 必要 に なる ので 、 その あたり は 調べ て もらえれ ば 色々 で て き ます よ 。 例 ） c :\ hoge \ hoge . xlsx c :\ hoge が ファイル パス hoge . xlsx が ファイル 名 ファイル パス ＋ ファイル 名 を フル パス と いい ます 。 
用語 の 使い方 が 間違っ て い ます 。 「 メモ帳 の 名前 は ( shibuya _ soku . txt ) です 」 という 使い方 はしません 。 「 メモ帳 で 開こ う と し て いる ファイル の 名前 は ( shibuya _ soku . txt ) です 」 と 言い ます 。 「 tank _ kanon が 飼っ て いる 犬 の 名前 は ポチ です 」 と 言わ なけれ ば いけ ない ところ を 「 tank _ kanon の 名前 は ポチ です 」 と 言っ て いる の と 同じ です 。 「 NOTEPAD 」 で は なく 「 NOTEPAD . EXE 」 と し て み て 下さい 。 それから 「 C :\. shibuya _ soku . txt 」 これ も 正しく あり ませ ん 。 shibuya _ soku . txt は どこ に 保存 さ れ て いる の でしょ う か ？ 「 絶対パス 」 と 「 相対パス 」 を もう一度 きちんと 理解 し 直し て ください 。 
下記 の よう に なり ます 。 もしも シート 1 の M 列 ・ N 列 ・ O 列 の 中 で 最終 行 まで 必ず 何らかの 値 が 入っ て いる 列 が ある の なら 、 コード は もう少し シンプル に する こと が 出来 ます 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st 2 As Worksheet Dim r1 As Long , r2 As Long Dim rD As Long , rE As Long , rF As Long Set st 1 = Worksheets (" Sheet 1 ") Set st 2 = Worksheets (" Sheet 2 ") ' シート 2 へ 転記 する 際 の 最初 の 行番号 を 設定 する ' D6 が 空白 なら 6 行 目 、 空白 で ない なら D 列 の 最終 行 + 1 を 設定 する rD = IIf ( st 2 . Range (" D6 "). Value = "", 6 , st 2 . Range (" D " & Rows . Count ). End ( xlUp ). Row + 1 ) ' E 6 が 空白 なら 6 行 目 、 空白 で ない なら E 列 の 最終 行 + 1 を 設定 する rE = IIf ( st 2 . Range (" E 6 "). Value = "", 6 , st 2 . Range (" E " & Rows . Count ). End ( xlUp ). Row + 1 ) ' F6 が 空白 なら 6 行 目 、 空白 で ない なら F 列 の 最終 行 + 1 を 設定 する rF = IIf ( st 2 . Range (" F6 "). Value = "", 6 , st 2 . Range (" F " & Rows . Count ). End ( xlUp ). Row + 1 ) ' rD , rE , rF の ３つ の うち で もっとも 大きい 値 を シート 2 へ の コピー 先 の 行番号 と する r2 = rD If rE > r2 Then r2 = rE If rF > r2 Then r2 = rF ' シート 1 の コピー 元 の 行番号 を 設定 する r1 = 2 ' シート 1 の M 列 ・ N 列 ・ O 列 の いずれ か が 空白 で ない あいだ 繰り返す Do While st 1 . Range (" M " & r1 ). Value <> "" Or st 1 . Range (" N " & r1 ). Value <> "" Or st 1 . Range (" O " & r1 ). Value <> "" ' シート 1 の M 列 ・ N 列 ・ O 列 を それぞれ シート 2 の D 列 , E 列 , F 列 へ コピー する st 2 . Range (" D " & r2 ). Value = st 1 . Range (" M " & r1 ). Value st 2 . Range (" E " & r2 ). Value = st 1 . Range (" N " & r1 ). Value st 2 . Range (" F " & r2 ). Value = st 1 . Range (" O " & r1 ). Value ' シート 2 の コピー 先 の 行番号 を 1 行 下 に する r2 = r2 + 1 ' シート 1 の コピー 元 の 行番号 を 1 行 下 に する r1 = r1 + 1 Loop End Sub 
> HIJ の 列 も 同様 に 、 > 内容 が 同じ で あれ ば K 列 に 回避 せ す 緑 に も 塗ら ない 処理 この 点 は 、 気 に なっ て まし た ･･･ 例えば 、 以下 部分 の ★ の 2 か所 削除 する と 、 ・ E 列 ～ 一致 なら 、 色 は 付き ませ ん ・ H 列 ～、 K 列 ～ の 一致 の 時 に は色 は 付き ます が 、 データ の コピー は 行わ れ ませ ん 今回 の データ は 、 E 列 ～ では あり ませ ん よ ･･･ という 意味 なら ★ ２ 行 を 削除 する だけ も あり か な ？ と 思い ます > If ( rf . Column = Range (" E 1 "). Column ) Then ' ★ >     For i = 1 To . Areas . Count >        If ( rf . Offset (, i - 1 ). Value <> . Areas ( i ). Value ) Then >           Exit For >        End If >     Next >     If ( i > . Areas . Count ) Then Exit Do > End If ' ★ でも 、 E 列 ～ で ない 所 に コピー し た ･･･ これ を 色 で 示す の なら 上記 の ★ 行 を 削除 し 、 ３つ とも 一致 し たら 色 なし を 設定 し て Do を 抜ける ただ 、 今回 の データ は E 列 ～、 H 列 ～、 K 列 ～ ･･･ の 何処 に あっ た ？ か 、 わから ない ･･･ ↓ For i = 1 To . Areas . Count     If ( rf . Offset (, i - 1 ). Value <> . Areas ( i ). Value ) Then        Exit For     End If Next If ( i > . Areas . Count ) Then     iC = xlNone     Exit Do End If どの よう な 色付け が 良い ん でしょ う ね ？ ※ データ が どの よう に 変わっ て いく か わから ない ので 、 私 が 考える こと で も ない と 思い ます が ･･･ 全体 を 記述 し て みる と Public Sub Samp 8 ()     Dim rng As Range , rf As Range , r As Range     Dim iC As Long , i As Long     Const CCR As Long = 36     Const CC R2 As Long = 35     Const CRNGS As String = " B 1 , E 1 , F1 "     Set rng = Worksheets (" Sheet 2 "). Columns (" D ") ' m シート ★     Set r = Worksheets (" Sheet 1 "). Range (" E3 ") ' B シート ★     Application .S creenUpdating = False     While ( r . Value <> "")        Set rf = rng . Find ( r . Value , LookAt := xlWhole )        With r           iC = xlNone           If ( rf Is Nothing ) Then              iC = CCR           Else              Set rf = rf . Offset (, Range (" E 1 "). Column - rf . Column )              With . Offset (, 1 - . Column ). Range ( CRNGS )                 Do While ( rf . Value <> "")                    For i = 1 To . Areas . Count                       If ( rf . Offset (, i - 1 ). Value <> . Areas ( i ). Value ) Then                          Exit For                       End If                    Next                    If ( i > . Areas . Count ) Then                       iC = xlNone                       Exit Do                    End If                    Set rf = rf . Offset (, 3 )                    iC = CC R2                 Loop                 If ( rf . Value = "") Then                    For i = 1 To . Areas . Count                       rf . Offset (, i - 1 ). Value = . Areas ( i ). Value                    Next                 End If              End With           End If           . Interior . Color Index = iC        End With        Set r = r . Offset ( 1 )     Wend     Application .S creenUpdating = True End Sub ※ もし 、 コピー し た / 一致 する もの が あっ た その 場所 に 色 を 付ける の なら >                 If ( rf . Value = "") Then >                    For i = 1 To . Areas . Count >                       rf . Offset (, i - 1 ). Value = . Areas ( i ). Value >                    Next >                 End If                 rf . Resize (,. Areas . Count ) _                    . Interior . Color Index = 34 とか し て みる ？ これ を する 時 に は 、 E 列 ～ 色 なし を 事前 に ･･･ 処理 を 追加 し ない と ･･･ 
Dim i As Integer , n As Integer n = 10 do until i = n Debug . print Format ( i ," 00 ")& String ( i ,"*") i = i + 1 loop 
以下 で どう なり ます か 処理 の 行 範囲 は B 列 で やっ て み まし た また 、 罫線 の 太 さ が 必要 なら 追加 し て み て ください Public Sub Samp 1 ()     Dim r As Range     Dim i As Long     Application .S creenUpdating = False     Set r = Range (" B 1 ")     While ( r . Value <> "")        If ( r . Row = 1 ) Then           With r . Resize (, 2 ). Borders ( xlEdgeTop )              . LineStyle = _                 r . Offset (, - 1 ). MergeArea . Borders ( xlEdgeTop ). LineStyle              . Color Index = 3           End With        End If        For i = 1 To r . Offset (, - 1 ). MergeArea . Cells . Count - 1           With r . Offset ( i - 1 ). Resize (, 2 )              . Borders ( xlEdgeBottom ). LineStyle = xlLineStyleNone           End With        Next        With r . Offset ( i - 1 ). Resize (, 2 ). Borders ( xlEdgeBottom )           . LineStyle = _              r . Offset (, - 1 ). MergeArea . Borders ( xlEdgeBottom ). LineStyle           . Color Index = 3        End With        Set r = r . Offset ( i )     Wend     Application .S creenUpdating = True End Sub 
>③ まで は 、 うまく いっ た なぜ その コード を 載せ ない の です か ？ その コード に 追加 すれ ば 、 あなた の 苦労 が １つ 減る と 思い ます が ね ・ ・ ・ 。 以下 は 、 アクティブセル 行 の 一つ 上 の 行 の E 列 および 、 J 列 の データ を 一つ 下 に オート フィル さ せる 例 です 。 Sub 一 例 です () i = Active Cell . Row - 1 If i > 0 Then With Cells ( i , " E ") . AutoFill Destination :=. Cells . Resize ( 2 ), Type := xlFillDefault End With With Cells ( i , " J ") . AutoFill Destination :=. Cells . Resize ( 2 ), Type := xlFillDefault End With Application . CutCopyMode = False End If End Sub 
左 の 表 が シート 1 に 右 上 の 表 が シート 2 に 右 下 の シート が シート 3 に ある と し ます 。 シート 1 の 表 は お 示し の 通り で ある と し ます 。 シート 2 や シート 3 は B 1 セル から 右 横方向 に 月 が 、 A 2 セル から 下方 に は お 示し の よう な データ が 入力 さ れ て いる と し ます 。 そこで シート 2 は 収入 です から シート 2 の B2 セル に は 次 の 式 を 入力 し て 右 横方向 に ドラッグ コピー し た のち に 下方 に も ドラッグ コピー すれ ば よい でしょ う 。 = IF ( OR ( B $1 ="",$ A 2 =""),"", SUMIFS ( Sheet 1 !$ C :$ C , Sheet 1 !$ A :$ A , B $1 , Sheet 1 !$ B :$ B ,$ A 2 )) シート 3 は 支出 です から シート 3 の B2 セル に は 次 の 式 を 入力 し て 右 横方向 に ドラッグ コピー し た のち に 下方 に も ドラッグ コピー すれ ば よい でしょ う 。 = IF ( OR ( B $1 ="",$ A 2 =""),"", SUMIFS ( Sheet 1 !$ D :$ D , Sheet 1 !$ A :$ A , B $1 , Sheet 1 !$ B :$ B ,$ A 2 )) 
Sub test () With T hisWorkbook . ActiveSheet ' book 1 です Workbooks (" boo k2 . xlsx "). Activate Range (" B2 "). Select End With End Sub 上 の コード を 実行 し た ところ 、 Boo k2 . xlsx の セル B ２ が 選択 さ れ て い ます よ 。 book 1 . xlsm 、 boo k2 . xlsx とも 同じ ディレクトリ 内 に 保存 さ れ て い ます か ？ 
If Target . hani = " 完了 " Then Call MAKE _ MAIL _ ITEM _ TEST _ NG Exit Sub End If を 、 If Not Application . Inter sect ( Target , Range (" H : H ")) Is Nothing Then If Target . value = " 完了 " Then Call MAKE _ MAIL _ ITEM _ TEST _ NG Exit Sub End If End If と する こと で 、 列 H の 時 のみ に なり ます 。 同行 の 別 列 の データ を 取得 する 場合 は 、 If Not Application . Inter sect ( Target , Range (" H : H ")) Is Nothing Then If Target . value = " 完了 " Then Call MAKE _ MAIL _ ITEM _ TEST _ NG ' A 列 から H 列 に コピー Cells ( Target . Row , 8 ). value = Cells ( Target . Row , 1 ). value Exit Sub End If End If の よう に 、 Target から 行 （ Row ) を 取得 し 、 Cells () を 使用 し ます 
気 に なる の は 、 現状 の リーダー で 制御文字 が 含む データ を 読み込む こと が でき ます か ？ メーカー 、 機種 に も より ます が 、 出来る の で あれ ば 読み込ん だ 文字列 を 1 文字 ずつ 調べ 、 制御文字 で あれ ば それ まで の 文字列 を 区切っ て 配列 や テキストボックス 等 に 入れる 。 制御文字 じゃ なけれ ば そのまま ループ さ せる 。 という やり方 を すれ ば 処理 できる と 思い ます 。 例 として です が 以下 の ページ に 文字列 から 制御 コード を 除去 する 方法 が 記載 さ れ て い ます 。 http:// tsware .jp / tips / tips _ 406 . htm これ を 改変 すれ ば お 望み の 処理 が 可能 か と 。 
B 3 = HYPERLINK (" X :\ 納品書 "& TEXT ( ROW ( A1 )," 00000 ")&". pdf ", ROW ( A1 )) として 、 下 へ コピー です 。 
vba による IE 制御 で は 、 HTML を 解釈 する こと しか でき ませ ん 。 です ので 、 ご 質問 の サイト が flash や Java など の 動的 コンテンツ で 株価 を 表示 し て いる 場合 は 、 抜き出す こと は でき ませ ん 。 
開発 し た マシン に 登録 する 場合 は 、 VisualStudio 上 で 作 榮 し た プログラム を ビルド または 実行 （ どちら の タイミング か 忘れ まし た ） すれ ば 自 マシン に ＣＯＭ が 登録 さ れ た と 思い ます 。 他 の マシン へ の 配布 は かなり 調べ まし た が 、 ClickOnce や インストーラー で の 配布 しか なかっ た 気 が し ます 。 私 は 下記 の サイト を 参考 に 作成 し た Excel の VSTO アド イン を インストーラ ー で 配布 し まし た 。 ・ Visual Studio 2010 で VSTO アド イン の インストーラ ー ( msi ) を 作成 する https :// goo.gl / rfgKNq ・ VisualStudio 2013 で VSTO の インストーラ ー を 作成 http:// goo.gl / l 8 bprz ※ レジストリ の 登録 は サイト の 記述 どおり で は 動き ませ ん でし た 。 誤 ） HKEY _ CURRENT _ USER \ Software \ Microsoft \ Office \ Excel \ Addins \ ↓ 正 ） HKEY _ CURRENT _ USER \ Software \ Microsoft \ Office \ Excel \ Addins \ プロジェクト 名 ・ VSTO アド イン の パフォーマンス の 向上 https :// goo.gl / l 6 zwq 4 ※ ここ も ポイント で Excel の 起動 が 遅く なっ た ため 、 登録 する レジストリ の 値 を LoadBehavior : x 03 → x10 ( DWORD ) に 変更 し まし た 。 また 、 配布 先 に は VSTO の ランタイム の インストール が 必要 です 。 ・ 「 Visual Studio Tools for Office の 再 頒布 可能 な ランタイム を インストール する 」 で 検索 し て ください 。 
Cells ( 30 + i , 2 + j + i ). Value = Cells ( 2 + i , 2 + j ). Value でいか が でしょ う か ？ 
kou 08110 さん は プログラミング の 経験 は お 有り な の でしょ う か ？ 初心者 の 方 が いきなり シリアル通信 で モーター の 制御 を 行う こと は 100% モーター を 壊し て しまう 結果 に なり ます 。 まずは 「 Windows フォーム アプリケーション 」 の 作り方 から 勉強 さ れる こと を お勧め し ます 。 勉強 さ れる とき に は 書店 へ 行っ て 「 Visual Basic 入門 」 の よう な 本 を 購入 さ れる こと を お勧め し ます 。 ネット の 入門 サイト より 書籍 を 使う 方 が 確実 です 。 
３つ の 課題 点 について 個人 的 な 考え を お答え し ます 。 ① ほか の 条件 も 同時に 満たす 検索 を する の で は なく 、 １つ １つ 検索 し て いき 、 それぞれ の 結果 を １つ に まとめれ ば いい です 。 例えば 1つ 目 の 条件 で 検索 を し 、 結果 が あれ ば シート １ に 書く 。 その後 続け て 2つ 目 の 条件 で 検索 を 行い 、 結果 が あれ ば シート １ に 追加 する 。 さらに 3つ 目 の 条件 で 検索 を 行い 、 結果 が あれ ば シート １ に 追加 。 ② 結果 が １ ０ ０ 件 ある なら １ ０ ０ シート に ・ ・ ・ 。 これ は １ ０ ０ シート も 必要 な の でしょ う か ？ 元々 の 仕様 を 理解 し て い ない ため です が 、 そもそも その あたり も 整理 し た ほう が いい の で は 。 ③ 可能 です 。 それぞれ の 画面 を 作る という 手間 が 増え ます が 、 それ ほう が 見 やすい か と 。 
シート 名 が 全角 ／ 半角 文字 による 相違 、 又は 空白 が 混入 でしょ う ね 。 
文字 を どの タイミング で 、 どの 様 に 数え て いる か 判り ませ ん が 、 拗音 を 数え なけれ ば いいんじゃない です か ？ 
DAO を 使っ た 例 です 。 Sub sample () Dim ma x1 As Long Dim max 2 As Long Dim db As DAO . Database Dim rs As DAO . Recordset ma x1 = DMax (" 項目 01 ", " テーブル 01 ") max 2 = DMax (" 項目 02 ", " テーブル 01 ") Set db = CurrentDb Set rs = db . OpenRecordset (" テーブル 02 ", dbOpenDynaset ) ' Set rs = db . OpenRecordset (" SELECT * FROM テーブル 02 ORDER BY 項目 03 ", dbOpenDynaset ) ' 順序 が 保証 さ れ た クエリ で 開く Do Until rs . EOF rs . Edit rs (" 項目 01 "). Value = ma x1 rs (" 項目 02 "). Value = max 2 ma x1 = ma x1 + 1 max 2 = max 2 + 1 rs . Update rs . MoveNext Loop End Sub Access で は Excel と 違い 、 " テーブル 02 " の 項目 03 の ＡＡＡ Ｂ ＢＢ ＣＣＣ ＤＤＤ の 順序 は 保証 さ れ て い ませ ん 。 その ため 、 プログラム 中 の Set rs = db . OpenRecordset (" テーブル 02 ", dbOpenDynaset ) で は 、 レコード の 順序 は 保証 さ れ て い ない ので 、 順序 を 保証 する クエリ を 使う 必要 が ある 場合 も あり ます 。 例えば 、 プログラム 中 の Set rs = db . OpenRecordset (" SELECT * FROM テーブル 02 ORDER BY 項目 など です 。 
SQL を テキスト で 開い て 、 全部 読み込ん で 、 SQL 実行 してやれ ば 良い ん じゃ ない ？ どんな DB な の か どんな スクリプト か 説明 が 無い から こう しか 言え ない なぁ 。 
最初 の For 文 の 意図 は わかり ませ ん が 、 For i = 2 To 10 For j = 0 To 19 Worksheets ("○●"). Cells ( i , j + 7 ). Value = _ objIE . document . getElementsByClassName ("○○")( j ). outerText Next j Next i で どうでしょう か 。 
Sub 一 例 です () Dim i As Long , sh As Worksheet Set sh = ActiveWorkbook . Worksheets (" Sheet 1 ") With Workbooks (" DAT A1 . xlsx "). Worksheets For i = 1 To . Count sh . Cells ( 1 , 1 ). Offset ( i ). Value = . Item ( i ). Name Next i End With End Sub 未 実行 に 付き 、 不具合 ご 容赦 。 
Sub 一 例 です () Dim rngs As Range , rng As Range On Error Resume Next Set rngs = Range (" C1 ", Cells ( Rows . Count , 3 ). End ( xlUp )) _ . Offset (, 2 ). SpecialCells ( xlCellTypeBlanks ) On Error GoTo 0 If Not rngs Is Nothing Then For Each rng In rngs With rng . Value = Abs (. Offset (, - 2 ). Value ) End With Next rng End If End Sub 
( vba ) isnull ( ListBox 1 . list ( 0 , 1 )) で ない です か ？ 
① ho という txt ファイル は D ドライブ の どこ の フォルダ に ある の です か ？ ②「 カンマ 、 タブ で 区切り 」 は 「 個々 の データ は カンマ または タブ で 区切ら れ て いる 」 という 意味 です か ？ それとも 「 カンマ で 区切ら れ た データ の タブ を 取り除き 」 という 意味 です か ？ ③「 複数回 取込 ため 、 シート 名 は 2 .. 3 .. 4 と 」 という の は ２ 回 目 は 「 ho 2 」 、 3回 目 は 「 ho 3 」 という シート 名 、 という 意味 です か ？ 類似 する 質問 の 場合 に 「 ID 非公開 」 回答 する 側 にとって は とても 不便 です 。 前回 あなた が 質問 し た 内容 に 関連 する の で あれ ば 、 その 質問 へ の リンク を 貼り 付ける よう に し て ください 。 
1 ) st 1 . Range (" E2 ", Cells ( Rows . Count , 1 ). End ( xlUp )). Copy ↓ st 1 . Range (" E2 ", Cells ( Rows . Count , " E "). End ( xlUp )). Copy 2 ) st 1 . Range (" AD 2 ", Cells ( Rows . Count , 1 ). End ( xlUp )). Copy ↓ st 1 . Range (" AD 2 ", Cells ( Rows . Count , " AD "). End ( xlUp )). Copy 3 ) st 1 . Range (" AC 2 ", Cells ( Rows . Count , 1 ). End ( xlUp )). Copy ↓ st 1 . Range (" AC 2 ", Cells ( Rows . Count , " AC "). End ( xlUp )). Copy A 列 の 最終 行 を いつも 探し て い た 、 という こと です 。 
イメージ として は この よう な 感じ か な ・ ・ 。 Sub Sample () Dim i As Long , j As Long , EndRow As Long , cnt As Integer Dim FC As Range , Hani As Range , MaxRow As Long EndRow = Range (" A " & Rows . Count ). Offset (- 1 ). End ( xlUp ). Row MaxRow = Range (" G " & Rows . Count ). End ( xlUp ). Row Set Hani = Range (" G3 : G " & MaxRow ) For i = 3 To EndRow Set FC = Hani . Find ( Range (" A " & i ). Value , LookAt := xlWhole ) If Not FC Is Nothing Then cnt = Range (" B " & i ) Mod Range (" H " & FC . Row ) Range (" C " & i ) = Range (" B " & i ) \ Range (" H " & FC . Row ) If cnt > 0 Then Range (" C " & i ) = Range (" C " & i ) + 1 End If Next i End Sub ※ A 列 の 合計 が 一番 最後 の 行 に ある と し て い ます 。 
時間 を 出力 し て いる シート に 入力 し て いる ため 、 入力 の 間 、 出力 が 待っ て いる 状態 だ と 思い ます 。 ユーザ フォーム を 作成 し て 時間 を 表示 する か 、 画面 左下 の ステータスバー に 時間 を 表示 すれ ば よい と 思い ます 。 ステータスバー へ の 出力 は 、 下記 に なり ます 。 ＜ 変更 前 ＞ Cells ( 1 , 1 ) = Int (( Timer - dblTimer ) * 100 ) / 100 ↓ ＜ 変更 後 ＞ Application .S tatusBar = Int (( Timer - dblTimer ) * 100 ) / 100 
If Not Inter sect ( Target , Range (" C5 : C1 4 ")) Is Nothing Then If Target . Value = " No " Then MsgBox " アプリケーション は 入力 必須 です " End If Exit Sub End If を If Target . Count > 1 Then Exit Sub If Inter sect ( Target , Range (" E 5 : E 14 ")) Is Nothing Then Exit Sub の 間 に 入れ て み て は どうでしょう か 。 
下記 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st 2 As Worksheet Dim r As Long , c As Long Set st 1 = Worksheets (" Sheet 1 ") Set st 2 = Worksheets (" Sheet 2 ") ' 一旦 Sheet 2 の A 列 を クリア する st 2 . Columns (" A "). Clear ' Sheet 1 の B 列 の 最終 行 まで 繰り返す For r = 1 To st 1 . Range (" B " & Rows . Count ). End ( xlUp ). Row With st 2 . Range (" A " & r ) c = st 1 . Cells ( r , Columns . Count ). End ( xlToLeft ). Column ' Sheet 1 の C 列 以降 に データ が 存在 する とき If c > 2 Then ' Sheet 2 の A 列 に 入力 規則 を 設定 する With . Validation . Delete . Add Type := xlValidateList , _ Formula 1 :="= Sheet 1 ! B " & r & ":" & Cells ( r , c ). Address End With ' Sheet 2 の A 列 を 黄色 に する . Interior . Color = RGB ( 255 , 255 , 0 ) End If ' Sheet 1 の B 列 の 値 を Sheet 2 の A 列 に コピー する . Value = st 1 . Range (" B " & r ). Value End With Next r End Sub 
amsmath .s ty を 使う の が 一般的 です 。 ( 1 ) 単純 に 改行 する なら multline ( 2 ) 改行 し て かつ 揃える なら split / align ( 3 ) 複数 の 数式 を （ 揃え ず に ） 列挙 する なら gather 等 具体 的 な 使い方 は 公式 ガイド （ 下記 ） の 通り です 。 ftp :// ftp . ams . org / pub / tex / doc / amsmath / amsldoc . pd f# page = 8 なお 、 amsmath が 提供 し て いる 環境 で 不足 する 場合 （ multline で 改行 し つつ 、 align で 揃える 等 ） は 、 mathtools で 補う こと に なり ます 。 
コード 例 です 。 あまり 難しい こと は し て い なく て 、 For ～ Next と 配列 が 理解 でき て いれ ば 、 この コード は 理解 できる と 思い ます 。 Sub Sample () Dim Sums ( 999999 ) As Long Dim Cnts ( 999999 ) As Long Dim Row As Long Dim Code As Long For Row = 2 To Cells ( Rows . Count , " A "). End ( xlUp ). Row Code = Left ( Cells ( Row , " A "). Value , 6 ) Sums ( Code ) = Sums ( Code ) + Cells ( Row , " B "). Value Cnts ( Code ) = Cnts ( Code ) + 1 Next For Row = 2 To Cells ( Rows . Count , " A "). End ( xlUp ). Row Code = Left ( Cells ( Row , " A "). Value , 6 ) Cells ( Row , " C "). Value = Sums ( Code ) / Cnts ( Code ) Next End Sub 
組み合わせ の 最適化 です ので 、 簡単 な もの でし たら ソル バー で 可能 です 。 図 が 全然 読め ませ ん ので 、 条件 など を 書い て もらえれ ば 、 考え て み ます 。 ソル バー を この よう な 目的 に 使う に は ちょっとした コツ が あり ます 。 
＞ A 2 へ 貼り 付け し シート １ の ３ 行 目 の 値 は 常に シート ２ の A 2 に 張り付ける もの と 解釈 し まし た 。 ' シート オブジェクト 取得 Set sh 1 = Sheets (" Sheet 1 ") Set sh 2 = Sheets (" Sheet 2 ") For i = 0 To 20 ' シート ２ A 2 に コピー sh 2 . Range (" A 2 "). Value = sh 1 . Cells ( 3 , 2 + i ). Value ' シート ２ の 結果 を シート １ に コピー For j = 0 To 20 sh 1 . Cells ( 15 + i , 2 + j ). Value = sh 2 . Cells ( 3 + j , 21 ). Value Next Next 
とりあえず 、 差分 データ を 「 削除 データ 」 「 追加 データ 」 「 変更 データ 」 という シート に 書き出す コード です 。 書き出す シート は マクロ の 中 で 新規 に 追加 し て い ます 。 （ 既に 同名 の シート が 存在 する 場合 は その シート を 削除 し て から 新規 に 追加 し て い ます ） 数 万 件 を 突き合わせる こと に なる ので 数 分 から 十 数 分 かかる と 思い ます 。 Option Explicit Sub Sample () ' 以下 の シート 名 は 適宜 変更 し て ください 。 Const DelSheet As String = " 削除 データ " Const AddSheet As String = " 追加 データ " Const ChgSheet As String = " 変更 データ " Dim stName As Variant , i As Integer Dim st 1 As Worksheet , st 2 As Worksheet Dim st ( 2 ) As Worksheet Dim rSrc As Long , rDst As Variant ' Excel の 再 描画 を 一時停止 する Application .S creenUpdating = False Set st 1 = Worksheets (" Sheet 1 ") Set st 2 = Worksheets (" Sheet 2 ") ' 一旦 差分 用 の シート を 削除 する Application . DisplayAlerts = False On Error Resume Next Worksheets ( DelSheet ). Delete Worksheets ( AddSheet ). Delete Worksheets ( ChgSheet ). Delete On Error GoTo 0 Application . DisplayAlerts = True ' 差分 用 の シート を 新規 に 作成 する For Each stName In Array ( DelSheet , AddSheet , ChgSheet ) Set st ( i ) = Worksheets . Add ( After := Worksheets ( Worksheets . Count )) st ( i ). Name = stName st 1 . Rows ( 1 ). Copy st ( i ). Range (" A1 ") i = i + 1 Next stName ' 削除 データ 抽出 （ 注文 番号 が Sheet 1 に あっ て Sheet 2 に ない もの を 抽出 する ） ' Sheet 1 を 全 件 調べる For rSrc = 2 To st 1 . Range (" A " & Rows . Count ). End ( xlUp ). Row ' 注文 番号 が Sheet 2 に ある か どう か を 判定 する rDst = Application . Match ( st 1 . Range (" A " & rSrc ), st 2 . Columns (" A "), 0 ) ' 注文 番号 が 存在 し ない 場合 は 削除 データ シート に 書き出す If VarType ( rDst ) = vbError Then st 1 . Rows ( rSrc ). Copy st ( 0 ). Rows ( st ( 0 ). Range (" A " & Rows . Count ). End ( xlUp ). Offset ( 1 ). Row ) End If DoEvents Next rSrc ' 追加 データ ・ 変更 データ 抽出 ' 注文 番号 が Sheet 2 に あっ て Sheet 1 に ない もの は 追加 データ ' 注文 番号 が Sheet 2 に も Sheet 1 に も あっ て 、 注文 品 ・ 顧客 名 が 異なっ て いる もの は 変更 データ ' Sheet 2 を 全 件 調べる For rSrc = 2 To st 2 . Range (" A " & Rows . Count ). End ( xlUp ). Row ' 注文 番号 が Sheet 1 に ある か どう か を 判定 する rDst = Application . Match ( st 2 . Range (" A " & rSrc ), st 1 . Columns (" A "), 0 ) ' 注文 番号 が 存在 し ない 場合 は 追加 データ シート に 書き出す If VarType ( rDst ) = vbError Then st 2 . Rows ( rSrc ). Copy st ( 1 ). Rows ( st ( 1 ). Range (" A " & Rows . Count ). End ( xlUp ). Offset ( 1 ). Row ) Else ' 注文 番号 が 存在 する 場合 、 注文 品 ・ 顧客 名 が 異なっ て いる か どう か を 判定 する If st 2 . Range (" B " & rSrc ). Value <> st 1 . Range (" B " & rDst ). Value Or _ st 2 . Range (" C " & rSrc ). Value <> st 1 . Range (" C " & rDst ). Value Then ' 注文 品 ・ 顧客 名 が 異なっ て いる 場合 は 追加 データ シート に 書き出す st 2 . Rows ( rSrc ). Copy st ( 2 ). Rows ( st ( 2 ). Range (" A " & Rows . Count ). End ( xlUp ). Offset ( 1 ). Row ) End If End If DoEvents Next rSrc ' Excel の 再 描画 を 再開 する Application .S creenUpdating = False End Sub 
> ・・・テム \ QA 検査 画像 」 フォルダ なら ・ ・・テム \ QA 検査 画像 " & "\" & [ 詳細 検索 フォーム ]![ 詳細 画像 ID ] と "\" を 間 に 入れる とか ？ ※ 環境 テーブル とか 持っ て フィールド ID , 項目 1 ・ ・ ・ で 、 ID = 1 の 項目 1 に \ 123 . 456 . 78 . 90 \ ・・・テム \ QA 検査 画像 \ を 入れ て おい て Me ! 詳細 画像 検索 イメージ . Picture = _     DLookup (" 項目 1 "," 環境 テーブル "," ID = 1 ") _     & [ 詳細 検索 フォーム ]![ 詳細 画像 ID ] & ". JPG " とかし て みる とか ･･･ 画像 の 置き場 が 変わっ て も 、 テーブル 内 の 変更 だけ で VBA に は 影響 なし ･･･ って の は 、 どうでしょう か ･･･??? 
チョット 無駄 が あっ た ので 回答 し 直し まし た Y 、 AI 列 に は " 小 計 " の 文字列 が ある と し ます なお 、 最後 の " 小 計 " の 後 に 合計 を 作り ます Public Sub Samp 2 ()     Dim r As Range     Dim v As Variant     Dim sS As String     Dim i As Long , j As Long , k As Long     Const CROWS As Long = 33     Const CCHK As String = " 小 計 "     Const CF As String = _        "= IF ( RC [{% 1 }]=""" & CCHK & """, 1 ,"""")"     Const CSUM As String = "= SUM ( R [{% 2 }] C : R [- 1 ] C )"     Const CSUMIF As String = _        "= SUMIF ({% 1 },""" & CCHK & """, R [{% 2 }] C : R [- 1 ] C )"     Application .S creenUpdating = False     With ActiveSheet . UsedRange        With . Resize (, . Columns . Count + 1 )           With . Columns (. Columns . Count )              For Each v In Array (" Y ", " AI ")                 i = Cells ( 1 , v ). Column - . Column                 sS = Replace ( CF , "{% 1 }", i )                 . FormulaR 1 C1 = sS                 . Value = . Value                 j = CROWS                 For Each r In .S pecialCells ( xlCellTypeConstants ). Areas                    If ( r . Row > j ) Then                       k = r . Row                       sS = Replace ( CSUM , "{% 2 }", j - k )                       Cells ( k , v ). Offset (, 2 ). Resize (, 7 ) _                          . FormulaR 1 C1 = sS                       j = k + 1                    End If                 Next                 sS = Range ( Cells ( CROWS , v ), Cells ( k , v )) _                       . Address (, , xl R1 C1 )                 sS = Replace ( CSUMIF , "{% 1 }", sS )                 sS = Replace ( sS , "{% 2 }", CROWS - k - 1 )                 With Cells ( k + 1 , v )                    . Value = " 合 計 "                    . Offset (, 2 ). Resize (, 7 ). FormulaR 1 C1 = sS                 End With                 . ClearContents              Next           End With        End With     End With     Application .S creenUpdating = True End Sub 
> 日付 の 月日 が １ 桁 だっ たり ２ 桁 だっ たり ばらばら な の を 2 桁 に 統一 する と 言う より 「 １ 桁 の 数値 と " 月 "」 と 「 １ 桁 の 数値 と " 日 "」 の 前 に " 0 " を 付け てる という 正規表現 の プログラム で 、 "\ b (\ d ( 月 | 日 ))" も "\ b (\ d 月 |\ d 日 )" も マッチ する パターン は 同じ な ので 、 どちら でも いい と 思い ます 。 
i = Listbox 1 . Listcount = 1 を i = Listbox 1 . Listcount - 1 と し て み て ください 。 
適当 な データ で かまわ ない ので 写真 や アップローダ に サンプル を 提示 いただけ ませ ん か ？ 
マクロ 記録 で 解り ませ ん か ？ A1 を 選択 し て 削除 し た マクロ の 記録 （ XL20 10 ) です 。 Range (" A1 "). Select Selection . Delete Shift := xlToLeft 整形 する と Range (" A1 "). Delete Shift := xlToLeft 
i は 宣言 さ れ て ない ので 、 > Cells ( i , 5 ). NumberFormatLocal = "# 0 . 0 " は 間違い だ と 思い ます が 、 Range (" E 10 : E 1000 ") の セル で は 65 は 青く なる と 思い ます 。 ちなみに 、 質問 の プログラム は Sub sample () Dim j As Single For j = 10 To 1000 Cells ( j , 5 ). NumberFormatLocal = "# 0 . 0 " Select Case Cells ( j , 5 ). Value Case Is > 0 , Is < 180 Cells ( j , 5 ). Interior . Color = RGB ( 0 , 0 , 255 ) Cells ( j , 5 ). Font . Color = RGB ( 255 , 255 , 255 ) Case Is >= 180 , Is < 350 Cells ( j , 5 ). Interior . Color = RGB ( 255 , 0 , 0 ) Cells ( j , 5 ). Font . Color = RGB ( 255 , 255 , 255 ) Case Is >= 350 , Is <= 1000 Cells ( j , 5 ). Interior . Color = RGB ( 255 , 0 , 255 ) Cells ( j , 5 ). Font . Color = RGB ( 255 , 255 , 255 ) End Select Next End Sub または 、 Sub sample () Dim j As Single For j = 10 To 1000 Cells ( j , 5 ). NumberFormatLocal = "# 0 . 0 " Select Case Cells ( j , 5 ). Value Case Is > 0 , Is < 180 Cells ( j , 5 ). Interior . Color = RGB ( 0 , 0 , 255 ) Cells ( j , 5 ). Font . Color = RGB ( 255 , 255 , 255 ) Case Is < 350 Cells ( j , 5 ). Interior . Color = RGB ( 255 , 0 , 0 ) Cells ( j , 5 ). Font . Color = RGB ( 255 , 255 , 255 ) Case Is <= 1000 Cells ( j , 5 ). Interior . Color = RGB ( 255 , 0 , 255 ) Cells ( j , 5 ). Font . Color = RGB ( 255 , 255 , 255 ) End Select Next End Sub で いい の で は ない でしょ う か 。 
左 の 表 から 、 右 の 表 を 作成 し たい という こと です か ？ 左 の 表 が Sheet 1 、 A1 セル から 始まっ て おり 、 右 の 表 は 新規 シート に 作成 さ れる 例 です 。 Sub 一 例 () Dim sh As Worksheet , rng As Range Dim i As Long , ii As Long , j As Long j = 1 With Worksheets Set sh = . Add ( after :=. Item (. Count )) sh . Cells ( 1 ). Resize (, 4 ). Value = Split (" 日付 , 内容 , 担当 , 金額 ", ",") With . Item (" Sheet 1 "). Cells ( 1 ). Current Region For Each rng In . Offset ( 1 , 1 ). Resize (. Rows . Count - 1 , . Columns . Count - 1 ) With rng If . Value = " リンゴ " Or . Value = " ミカン " Then i = 1 - . Column ii = 1 - . Row j = j + 1 . Offset ( ii ). Copy sh . Cells ( j , 1 ) . Offset (, i ). Copy sh . Cells ( j , 3 ) . Copy sh . Cells ( j , 5 ) End If End With Next rng End With End With With sh . Cells ( 1 ). Current Region . Borders . LineStyle = True With . Offset ( 1 ). Resize (. Rows . Count - 1 ) . Columns ( 2 ). Value = " 果物 " . Columns ( 4 ). Value = 1000 End With End With End Sub 
Dim b As Bitmap = PictureBox . Image Dim color As Color = b . GetPixel ( e . X , e . Y ) Label 8 . Text = color . ToString () に 続け て Dim bytA As Byte = color . A Dim bytR As Byte = color . R Dim bytG As Byte = color . G Dim bytB As Byte = color . B LabelA . Text = by t A.T oString () LabelR . Text = bytR . ToString () LabelG . Text = bytG . ToString () LabelB . Text = bytB . ToString () 
どこ に 書き出す の でしょ う か ？ 
[ Forms ]![ 詳細 検索 フォーム ]![ 詳細 開封 不良 内容 ]=[ 開封 不良 内容 ] Or [ Forms ]![ 詳細 検索 フォーム ]![ 詳細 開封 不良 内容 ]=[ 開封 不良 内容 2 ] でしょ う か ？ 
On Error Goto について は 、 使う 方 が 難しい と 思い ます 。 Sub test () Do num = InputBox (" 番号 を 入力 し て ください ") If ( IsNumeric ( num ) = False ) Then MsgBox " 数字 を 入力 し て ください " Loop Until ( IsNumeric ( num ) = True ) Set fnd = Columns ( 1 ). Find ( num ) If ( fnd Is Nothing ) Then MsgBox " 番号 が 見つかり ませ ん " Else MsgBox fnd . Offset ( 0 , 2 ). Value End If End Sub 
こんにちは。 その 画面 で 、 「 デバッグ 」 を クリック 表示 し た コード の 黄色 の 行 と 、 その 上 10 行 程度 を 、 知らせ て ください 。 今 の 状況 だ と 、 まったく 話 が 進み ませ ん よ 。 
シート モジュール に 書か れ た プログラム な ので 、 セル 参照 する コード で シート を 指定 し ない 場合 、 その シート モジュール が 書か れ た シート が 省略 さ れ て いる と みなさ れ ます 。 な ので 、 Worksheets ( 1 ). Range ( Cells ( 288 , 11 ), Cells ( 311 , 11 )). Select の Cells ( 288 , 11 ), Cells ( 311 , 11 ) は 、 Worksheets ( 1 ) では なく 、 シート モジュール が 書か れ た シート を 参照 し て い ます 。 Worksheets ( 1 ). Range で 範囲 指定 しよ う と し て いる Worksheets ( 1 ) の セル 範囲 に 他 の シート の セル を 含めよ う と し て いる こと に なり 、 エラー が 発生 し ます 。 Worksheets ( 1 ). Range ( Worksheets ( 1 ). Cells ( 288 , 11 ), Worksheets ( 1 ). Cells ( 311 , 11 )). Select と 書け ば 上手く いく はず 。 全体 を 書き かえる なら 、 Private Sub Worksheet _ Change ( ByVal Target As Range ) With Worksheets ( 1 ) . Activate . Range (. Cells ( 288 , 11 ), . Cells ( 311 , 11 )). Select End With End Sub 
私 は 以前 CAD / CAM を 作っ て 加工 を し て い まし た けど 、 操作 は 慣れ だ と 思い ます 。 今 は 何処 の メーカー を 使っ て いる の です か ？ 値段 から 言い ます と 、 そんなに 高額 で は ない と 思い ます 。 未だに 高い メーカー だ と 1000 万 ぐらい し ます し 、 安い メーカー だ と 百 万 円 ぐらい で 買え ます 。 三菱 製 だっ たら 中流 クラス だ と 思い ます ので 、 悪く は ない と 思い ます 。 とにかく 慣れる 事 が 一番 。 後 は 自分 に あっ た パス が 出来れ ば 良い と 思い ます 。 
以下 の よう に なり ます 。 Dim DataRange ( 1 , 1 , 1 ) As Variant Dim i As Long , j As Long For i = 0 To 1 For j = 0 To 1 DataRange ( i , j , 0 ) = Cells ( 1 , 1 ). Offset ( i , j ) DataRange ( i , j , 1 ) = Cells ( 5 , 5 ). Offset ( i , j ) Next j Next i です が 、 VBA で は 「 DataRange ( , , 0 ) , DataRange ( , , 1 )」 と 数える より も 「 DataRange ( 0 , , ) 、 DataRange ( 1 , , , )」 と 数える 方 が 通例 に なっ て い ます 。 なぜ か と いう と 以下 の よう な 格納 の 仕方 も ある から です 。 Dim d ( 1 ) As Variant d ( 0 ) = Cells ( 1 , 1 ). Resize ( 2 , 2 ) d ( 1 ) = Cells ( 5 , 5 ). Resize ( 2 , 2 ) この 書き方 の 場合 、 添付 し た 画像 の 例 で いう と d ( 0 )( 1 , 1 ) = " A1 " d ( 0 )( 1 , 2 ) = " B 1 " d ( 0 )( 2 , 1 ) = " A 2 " d ( 0 )( 2 , 2 ) = " B2 " d ( 1 )( 1 , 1 ) = " E 1 " d ( 1 )( 1 , 2 ) = " F1 " d ( 1 )( 2 , 1 ) = " E2 " d ( 1 )( 2 , 2 ) = " F2 " という よう に 格納 さ れ ます 。 これ と 同じ イメージ で 考え た ほう が プログラム 的 に は すっきり する と 思い ませ ん か ？ 格納 する ため の コード は For i = 0 To 1 For j = 0 To 1 DataRange ( 0 , i , j ) = Cells ( 1 , 1 ). Offset ( i , j ) DataRange ( 1 , i , j ) = Cells ( 5 , 5 ). Offset ( i , j ) Next j Next i です 。 これ で あれ ば DataRange ( 0 , 0 , 0 ) = " A1 " DataRange ( 0 , 0 , 1 ) = " B 1 " DataRange ( 0 , 1 , 0 ) = " A 2 " DataRange ( 0 , 1 , 1 ) = " B2 " DataRange ( 1 , 0 , 0 ) = " E 1 " DataRange ( 1 , 0 , 1 ) = " F2 " DataRange ( 1 , 1 , 0 ) = " E2 " DataRange ( 1 , 1 , 1 ) = " F2 " と 格納 さ れ ます 。 
B 1 セル に 「 １ 4 」 の よう に 1 桁 目 の 数字 が 10 の 位 で 必ず 含ま れる 数字 が 1 の 位 に 記載 さ れ て いる なら 、 例えば C1 セル に 以下 の 式 を 入力 し て 右 方向 に 8つ オート フィル し ます 。 = SMALL ((( LEFT ({ 1 , 2 , 3 , 4 , 5 , 6 }* 10 +{ 1 ; 2 ; 3 ; 4 ; 5 ; 6 })= RIGHT ($ B $1 ))+( RIGHT ({ 1 , 2 , 3 , 4 , 5 , 6 }* 10 +{ 1 ; 2 ; 3 ; 4 ; 5 ; 6 })= RIGHT ($ B $1 ))+(( LEFT ({ 1 , 2 , 3 , 4 , 5 , 6 }* 10 +{ 1 ; 2 ; 3 ; 4 ; 5 ; 6 })= LEFT ($ B $1 ))+( RIGHT ({ 1 , 2 , 3 , 4 , 5 , 6 }* 10 +{ 1 ; 2 ; 3 ; 4 ; 5 ; 6 })= LEFT ($ B $1 )))* 2 <> 1 )* 1000 + LEFT ($ B $1 )* 100 +{ 1 , 2 , 3 , 4 , 5 , 6 }* 10 +{ 1 ; 2 ; 3 ; 4 ; 5 ; 6 }, COLUMN ( A : A )) 
そういう 時 です 。 下記 は main から greeting を 呼び出し 、 引数 によって 挨拶 が 変わる もの です 。 Sub main () Call greeting (" h ") End Sub Sub greeting ( byval g as String ) If g =" m " then msgbox " good morning " If g =" h " then msgbox " hello " If g =" e " then msgbox " good evening " End Sub 
( vba ) 該当 の エラー は 手作業 で 行っ た 場合 、 A 列 から C 列 など 複数 列 を 範囲 選択 し て 、 " 区切り 位置 " を 実行 しよ う と し て いる とき に 発生 する の エラー です 。 対処 法 は そのまま です が 、 1 列 だけ を 区切り 対象 と すれ ば OK です 。 1 例 として 、 コード 2 行 目 を 以下 に 変更 など が あり ます 。 select ion . texttocolumns ↓ select ion . columns ( 1 ). texttocolumns または 選択 範囲 の 全 列 に対し 1 列 ずつ 繰返し など 。 
FileSearch は 2003 まで しか 使え ない です 。 下記 を 参考 に 書き直す 必要 が あり ます ね 。 http:// kuroeveryday . blogspot .jp / 2013 / 10 / F rom FileSearchToFileSystemO ... 本題 で は ありません が 、 必要 の Select が 多い ので 、 この 機会 に 修正 し て は 如何 でしょ う か 。 （ Select は 処理 を 遅く し ます ） 例えば Range (" K 11 : L 11 "). Select Kill pathname & "\" & Active Cell . Value は Kill pathname & "\" & Range (" K 11 "). Value で すみ ます 。 K 11 と L 11 は 結合 さ れ て いる ので 、 この よう な コード に なっ た の か と 思い ます が 、 結合 セル の 場合 値 は 先頭 の セル に 入り ます 。 また 固定 セル で 11 ～ 23 まで ずっと 書い て あり ます が 、 変数 で 繰り返し に すれ ば 、 ぐっと 短い コード に なり ます 。 
例示 の よう な 文字列 が A1 セル に 入力 さ れ て いる なら 、 以下 の 式 を 入力 すれ ば 「 商品 の 寸法 : 」 以降 の 3つ の 数字 を 足す こと が でき ます ( センチメートル の 前 に 半角 スペース が ある 場合 ） 。 = SUMPRODUCT ( TRIM ( MID ( SUBSTITUTE ( SUBSTITUTE ( SUBSTITUTE ( A1 ," X "," ")," ", REPT (" ", 100 ))," 商品 の 寸法 : ",""),{ 100 , 200 , 300 }, 100 ))* 1 ) 
それ が できる の は 多次元 配列 ( 2次元 配列 ) では なく 、 ジャグ 配列 という 、 配列 の 要素 が 配列 の 場合 だ と 思い ます 。 それ と 、 配列 の 要素 は 無 指定 の 場合 は 0 から 始まり ます 。 Sub sample () Dim MemberA () As String ReDim MemberA ( 1 To 3 ) MemberA ( 1 ) = " morita " MemberA ( 2 ) = " yamada " MemberA ( 3 ) = " kato " Dim MemberB () As String ReDim MemberB ( 1 To 3 ) MemberB ( 1 ) = " hamada " MemberB ( 2 ) = " matsumoto " MemberB ( 3 ) = " kato " Dim MemberC () As Variant ReDim MemberC ( 1 To 2 ) MemberC ( 1 ) = MemberA MemberC ( 2 ) = MemberB MsgBox MemberC ( 1 )( 1 ) '<- morita End Sub 
何 を どこ に 書き 足せ ば 、 と 言わ れ て も 、 あなた が 書い た コード が 判ら なけれ ば 回答 でき ませ ん （;￣O￣） 
以下 で どう なり ます か 手始め に 、 新規 ファイル に 以下 を 記述 し 、 testData で 確認 用 環境 を 作っ て Samp 1 を 実行 し て み ます Public Sub Samp 1 ()     Dim ws As Worksheet     Dim rng As Range     Dim i As Long     Const CF As String = "= IF ( RC 6 <>"""", 1 ,"""")"     Application .S creenUpdating = False     For Each ws In Worksheets        With ws . UsedRange           i = 3 - . Cells ( 1 ). Row           With . Resize (. Rows . Count - i ). Offset ( i )              With . Columns (. Columns . Count + 1 )                 . FormulaR 1 C1 = CF                 . Value = . Value                 On Error Resume Next                 Set rng = .S pecialCells ( xlCellTypeConstants )                 On Error GoTo 0              End With              If ( Not rng Is Nothing ) Then                 Inter sect ( rng . EntireRow , . Cells ) _                    . Interior . Color Index = 34                 rng . ClearContents                 Set rng = Nothing              End If           End With        End With     Next     Application .S creenUpdating = True End Sub ' 確認 用 簡易 データ 作成 Public Sub testData ()     Dim ws As Worksheet     Dim r As Range     Dim i As Long     Const CRH As Long = 30     Const CSHTCNT As Long = 30     Randomize     Application .S creenUpdating = False     i = CSHTCNT - Worksheets . Count     If ( i > 0 ) Then Worksheets . Add Count := i     For Each ws In Worksheets        With ws           . Cells . Delete           For Each r In . Range (" A 2 : Z 2 "). Resize ( CRH )              Select Case r . Row                 Case 2                    r . Value = r . Address ( False , False )                 Case Else                    Select Case r . Column                       Case Range (" F1 "). Column                          Select Case Rnd ()                               Case Is > 0 . 75                                     r . Formula = "="""""                               Case Is > 0 . 5                               Case Else                                     r . Value = r . Address ( False , False )                          End Select                       Case Else                          r . Value = r . Address ( False , False )                    End Select              End Select           Next           . Columns . AutoFit        End With     Next     Application .S creenUpdating = True End Sub 
この ２つ の オプション は 再起動 し ない と 有効 に なら ない よう です 。 
日付 な ので String で は だめ です 。 Dim a As Variant Dim i As Long For i = 2 To 700 a = Cells ( i , Cells ( i , Columns . Count ). End ( xlToLeft ). Column ). Value Cells ( i , 14 ) = a Next 
要は 、 C 列 の 容器 の 数量 を 入力 し た の です か ？ 右端 の 表 を 参照 し て 、 B 列 の 数量 と の 商 を C 列 に 入力 し て み たら どうでしょう か 。 もし 、 端数 が 出 た 場合 は それ は 容器 数 を １つ 加える の か ・ ・ 左 の 表 の セル 位置 は 分かり ます が 、 右 の 表 の セル の 位置 が 分かり づらい ので 参考 なる コード は 書き づらい です ね 。 マクロ で 回答 を 望む 場合 は 、 シート 名 や セル の 位置 が 明記 さ れ た ほう が 良い でしょ う ね 。 
この マクロ で 挿入 し た 画像 を 他 の パソコン で 見る こと が 出来れ ば いい の です か 。 それとも 、 他 の パソコン で も この マクロ を 実行 し たい の です か 。 前者 で あれ ば ActiveSheet . Pictures . Insert が まずい です 。 ActiveSheet .S hapes . AddPicture という 形 に すれ ば 図形 として 画像 が 貼り 付き ます ので 、 他 の パソコン から でも 見え ます 。 
これ で どうでしょう か ? Dim re Set re = New RegExp re . Pattern = "\ b (\ d 月 |\ d 日 )" ' 修正 箇所 re . Global = True MsgBox re . Replace (" 2016年 7月 01 日 、 2016年 07 月 1日 、 2016年 10月25日 ", " 0 $1 ") Set re = Nothing 
まず 、 Range (" H8 : BH 17 , H2 3 : BH 32 "........). ClearContents を し たい 場合 の プログラム は Sub sample () Dim i As Long Dim o As Integer o = 17 For i = 8 To 548 Step 15 Range ( Cells ( i , " H "), Cells ( o , " BH ")). ClearContents o = o + 15 Next End Sub または Sub sample () Dim i As Long For i = 8 To 548 Step 15 Range ( Cells ( i , " H "), Cells ( i + 9 , " BH ")). ClearContents Next End Sub だ と 思い ます 。 質問 の まとめる 場合 は Union を 使い ます 。 例えば Sub sample () Dim i As Long Dim rng As Range For i = 8 To 548 Step 15 If rng Is Nothing Then Set rng = Range ( Cells ( i , " H "), Cells ( i + 9 , " BH ")) Else Set rng = Union ( rng , Range ( Cells ( i , " H "), Cells ( i + 9 , " BH "))) End If rng . ClearContents Next End Sub 
Option Explicit Sub Sample () Dim total As Integer , a As String , n As Integer total = 0 a = InputBox (" 数字 を 入力 し て 下さい ") For n = 1 To Val (a) total = total + n Next n MsgBox " 答え は " & total & " です " End Sub 初心者 で あれ ば こそ 、 変数 の 宣言 は 必ず 行う よう に し ましょ う 。 VBE の 「 ツール (& T )」－「 オプション ( O )」 で 「 変数 の 宣言 を 強制 する 」 に チェック を 入れ て おい て ください 。 そう し ない と スペル ミス に 気付か ず に 「 うまく 動か ない ・ ・ ・ 」 と 悩み まくる こと に なり ます 。 
http:// www . osaka - kyo ik u. ac.jp /~ tomodak / soft /# jun とか …。 
VBA で は Application .S creenUpdating を 用いる と 「 開い て い ない よう に 見せる 」 こと が 出来 ます 。 下記 の コード でいか が でしょ う か 。 C :\ Test \ の 下 に 全く 関係 の ない ファイル が あっ て も 大丈夫 な よう に し て ある ので 少し だけ 冗長 な コード に なっ て い ます 。 Option Explicit Sub Sample () Const SavedPath As String = " C :\ Test \" Const CheckCells As String = " N 1 " Dim objFSO As Object Dim SavedF As Object Dim bk As Workbook , st As Worksheet Dim nm 1 As String , nm 2 As String nm 1 = ThisWorkbook . Worksheets (" Sheet 2 "). Range ( CheckCells ). Value Set objFSO = CreateObject (" Scripting . FileSystemObject ") ' SavedPath 下 の すべて の ファイル を 対象 と する For Each SavedF In objFSO . GetFolder ( SavedPath ). Files ' エクセル ファイル だけ を 対象 と する If objFSO . GetExtensionName ( SavedF . Name ) Like "* xls *" Then ' Excel の 再 描画 を 停止 する Application .S creenUpdating = False ' エクセル ファイル を 開く Set bk = Workbooks . Open ( SavedF . Path ) ' Sheet 2 の N 1 セル の 値 を 取得 する nm 2 = "" On Error Resume Next nm 2 = bk . Worksheets (" Sheet 2 "). Range ( CheckCells ). Value On Error GoTo 0 ' エクセル ファイル を 閉じる bk . Close False ' Excel の 再 描画 を 再開 する Application .S creenUpdating = True If nm 1 = nm 2 Then MsgBox " 同じ 記録 の ファイル が 既に あり ます 。 ", vbOKOnly Exit Sub End If End If Next ' この ブック を 保存 する ThisWorkbook .S aveAs SavedPath & nm 1 End Sub 
テキストファイル が 書き換え 対象 なら WorkBooks . Open を 使う の は 適当 で は あり ませ ん 。 全面的 に 書き換え て み まし た 。 Option Explicit Sub Sample () Dim myPath As String ' フォルダ 名 用 の 変数 Dim myFile As String ' ファイル 名 用 の 変数 Dim FSO As Object , TextFile As Object , buf As String Set FSO = CreateObject (" Scripting . FileSystemObject ") myPath = ThisWorkbook . Path & "\ 1310 \" myFile = Dir ( myPath & "*. txt ") Do While myFile <> "" ' 対象 の ファイル を オープン し て 内容 を すべて 読み込む Set TextFile = FSO . OpenTextFile ( my Pat h & m yFile ) buf = TextFile . ReadAll TextFile . Close ' 書き換え を 行う buf = Replace ( buf , " http:// www 43 . to k2 . com / abcde /", "../../") ' 対象 の ファイル を 上書き する Set TextFile = FSO . GetFile ( my Pat h & m yFile ). OpenAsTextStream ( 2 ) TextFile . Write buf TextFile . Close myFile = Dir () Loop End Sub 
Sub sample () Range (" A1 "). PasteSpecial Selection . TextToColumns Destination := Range (" A1 "), _ DataType := xlDelimited , _ TextQualifier := xlDoubleQuote , ConsecutiveDelimiter := False , _ Tab := True , Semicolon := False , Comma := True , Space := False , _ Other := False , TrailingMinusNumbers := True End Sub ↑ みたい な こと です か ね ？ 
( vba ) 処理 の 都度 、 共有 フォルダ 配下 の 約 3 万 ファイル の 検索 を 行う の で は なく 、 共有 フォルダ 配下 の 約 3 万 ファイル パス 情報 を 、 1日 1回 か 2回 適当 な シート へ 書き出し ↓ ↓ 特定 セル の ファイル を 開く 場合 、 3 万 ファイル の 検索 を する の で は なく 、 上記 の よう に あらかじめ シート に 書き出し た ファイ ルパス に find 検索 を 行っ て ファイル 実行 を 行う 処理 へ 変更 ↓ ↓ 1日 に 1回 か 2回 の 3 万 ファイル パス 情報 を 書き出す 時 のみ 時間 が かかり ます が 、 特定 セル 値 を 含む ファイル を 実行 する の は 一瞬 に なる と 思い ます 。 約 3 万 ファイル の パス 情報 の シート 書き出し は 既存 コード を 少し 修正 し た 以下 の よう な コード で ①【 ファイルリスト 】 シート を あらかじめ 作成 ② コード 1 行 目 へ 最 親 フォルダ パス を 定数 指定 ③ 下記 【 あらかじめ ↑ の パス 配下 の ファイル 名 を 取得 】 実行 Const str Folder As String = "\\ hoge \ hoge \" Sub あらかじめ ↑ の パス 配下 の ファイル 名 を 取得 () Dim fso As Object Dim vntSpt As Variant Dim strAry () As String Dim strOut () As String Dim lngAry As Long Dim i As Long Set fso = CreateObject (" Scripting . FileSystemObject ") Call FileSearch ( str Folder , strAry (), lngAry , fso ) Set fso = Nothing ReDim strOut ( lngAry - 1 , 1 ) For i = LBound ( strAry ) To UBound ( strAry ) vntSpt = Split ( strAry ( i ), "$") strOut ( i , 0 ) = vntSpt ( 0 ) strOut ( i , 1 ) = vntSpt ( 1 ) Next i With Sheets (" ファイルリスト ") . Cells . ClearContents . Range (" B 3 "). Resize ( lngAry , 2 ). Value = strOut Erase strOut : Erase strAry . Range (" B2 : C 2 "). Value = Split (" フル パス , ファイル 名 ", ",") End With Application .S tatusBar = "" MsgBox " finish ", vbInformation End Sub Sub FileSearch ( Path As String , strAry () As String _ , lngAry As Long , fso As Object ) Dim Folder As Variant , File As Variant For Each Folder In fso . GetFolder ( Path ). SubFolders Call FileSearch ( Folder . Path , strAry (), lngAry , fso ) Next Folder For Each File In fso . GetFolder ( Path ). Files ReDim Preserve strAry ( lngAry ) strAry ( lngAry ) = Path & "\" & File . Name & "$" & File . Name lngAry = lngAry + 1 If lngAry Mod 100 = 0 Then Application .S tatusBar _ = Format ( lngAry , "#,## 0 ") & " ファイル 格納 済 " Next File End Sub 
下記 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Const bk1 Name = " test 1 . xlsx " ' 適宜 変更 し て 下さい 。 Const bk 2 Path = " tes t2 . xlsx " ' 適宜 変更 し て 下さい 。 Dim st 1 As Worksheet Dim bk 2 As Workbook , st 2 As Worksheet Dim r As Long Application .S creenUpdating = False Set st 1 = Workbooks ( bk1 Name ). Worksheets (" Sheet 1 ") ' tes t2 . xlsx を 開く Set bk 2 = Workbooks . Open ( bk 2 Path ) Set st 2 = bk 2 . Worksheets (" Sheet 1 ") For r = 1 To st 1 . Range (" A " & Rows . Count ). End ( xlUp ). Row With st 1 . Range (" A " & r ) ' 一致 し て い たら A 列 に ○ を 挿入 する If . Value = st 2 . Range (" A " & r ). Value Then . Insert xlShiftToRight . Offset (, - 1 ). Value = "○" End If End With Next r ' tes t2 . xlsx を 閉じる bk 2 . Close False Application .S creenUpdating = True End Sub 
① フォーム に Panel を 貼り ます 。 ② 張り付け た Panel の 上 に チェックボックス を 貼り ます 。 ③ Panel を 動かせ ば チェックボックス の レイアウト は そのままで 移動 さ せる こと が 出来 ます 。 
Replace 関数 を 使い ます 。 Cells ( j , k ). Value = Replace ( Cells ( j , k ). value , " http:// www 43 . to k2 . com / abcde /", "../../") セル Cells ( j , k ) に 書い て ある 文字列 を 探し 、 http ～ が あれ ば ../../ に 置換 し 、 それ を 再度 Cells ( j , k ) に 代入 し ます 。 × If Cells ( j , k ). Value = "*" & " http:// www 43 . to k2 . com / abcde /" & "*" Then ○ If Cells ( j , k ). Value Like "*" & " http:// www 43 . to k2 . com / abcde /" & "*" Then Replace 関数 は 置換文字 列 が 見つから なけれ ば 、 置換 し ない まま 戻る ので 、 If 文 は 特に 必要 あり ませ ん 。 あろ う が なかろ う が 全部 関数 に かけれ ば いい の です 。 Replace 関数 と Replace メソッド と ２つ ある ので 間違え ない よう に 注意 し て ください 。 
出来 ます 。 MouseDown イベント と MouseUp イベント を 使用 し ます 。 Down は 押さ れ た 時 、 Up は 離れ た 時 発生 し ます 。 
これ を 試し て み て ください 。 var ss = SpreadsheetApp . getActiveSpreadsheet (); var sh = ss . getActiveSheet (); function onEdit (e) { var row = e . range . getRow (); var col = e . range . getColumn (); var val = e . range . getValue (); if (( row == 1 ) && ( col == 1 )) { sh . getRange ( 2 , 1 , sh . getLastRow (), 1 ). copyTo ( sh . getRange ( 3 , 1 )); sh . getRange ( 2 , 1 ). setValue ( val ); sh . getRange ( 1 , 1 ). setValue (""); } } 
複数 の セル 範囲 の 値 を 一遍 に は 、 比較 でき ませ ん 。 1 セル ずつ 比較 し ましょ う 。 Sub 一 例 です () Dim y As Long , rng As Range , xNG As Boolean y = 4 With T hisWorkbook . ActiveSheet Workbooks (" boo k2 . xlsx "). Activate For Each rng In Range ( Cells ( y , 1 ), Cells ( y , 22 )) If rng . Value <> . Range ( rng . Address ). Value Then xNG = True Exit For End If Next rng End With If Not xNG Then MsgBox " ok " End Sub 未 実行 につき 不具合 ご 容赦 。 
下記 の コード を Sheet 1 の シート モジュール に 記述 し て 下さい 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim v As Variant If Target . Column = 1 And Target . Row > 1 Then On Error Resume Next v = WorksheetFunction . VLookup ( Target . Value , Worksheets (" Sheet 2 "). Range (" A : B "), 2 , False ) Target . Offset (, 1 ). Value = IIf ( Err . Number = 0 , v , "") On Error GoTo 0 End If End Sub 
色々 調べ まし た けど 、 引用 さ れ た サイト の やり方 くらい しか あり ませ ん ね 、 空 の 配列 作る 方法 。 基本的 に 配列 なんて 事前 に サイズ を 決める の が 普通 だ と 思っ て い た んで 、 こう 言う 問題 に あたっ た 事 が 無い ん です よ ね 。 件数 が 判ら ない 場合 は Collection や Dictionary を 使え ば どうにか なっ ちゃう んで 。 因みに 、 エラー が 起き た > arrLNG ( UBound ( arrLNG )) = 1 この 記述 です が 、 引用 さ れ た サイト に も 説明 有り ます よう に 、 初期 化 さ れ UBound の 戻り値 が - 1 に なる と あり ます 。 存在 し ない インデックス を 指定 し てる ので エラー が 出る の は 当たり前 じゃ ない でしょ う か 。 （ VBA は 基本的 に 指定 し ない と 添え 字 は 1 から 始まる ） Redim じゃ 、 いかん の かしら ん 。 
具体 的 な プログラム を 示さ なく て は 正しい 回答 を 得る こと は 難しい です 。 
以下 で どう なり ます か Option Explicit Type recInfo     strTitle As String     intRow As Integer     strLine As String End Type Dim myMusic () As recInfo Public Sub testData ()     ReDim myMusic ( 9 ) As recInfo ' データ は strTitle で まとまっ て い て 、 intRow 昇順     myMusic ( 0 ). strTitle = " A "     myMusic ( 1 ). strTitle = " A "     myMusic ( 2 ). strTitle = " A "     myMusic ( 0 ). intRow = 6     myMusic ( 1 ). intRow = 7     myMusic ( 2 ). intRow = 8     myMusic ( 3 ). strTitle = " B "     myMusic ( 4 ). strTitle = " B "     myMusic ( 3 ). intRow = 11     myMusic ( 4 ). intRow = 12     myMusic ( 5 ). strTitle = " C "     myMusic ( 6 ). strTitle = " C "     myMusic ( 7 ). strTitle = " C "     myMusic ( 8 ). strTitle = " C "     myMusic ( 9 ). strTitle = " C "     myMusic ( 5 ). intRow = 16     myMusic ( 6 ). intRow = 19     myMusic ( 7 ). intRow = 23     myMusic ( 8 ). intRow = 24     myMusic ( 9 ). intRow = 25 End Sub Public Sub Samp 1 ()     Dim sS As String , sR As String     Dim sH As String , sM As String     Dim iNum ( 1 ) As Long     Dim i As Long , j As Long , k As Long     Call testData     i = LBound ( myMusic )     While ( i <= UBound ( myMusic ))        iNum ( 0 ) = myMusic ( i ). intRow        iNum ( 1 ) = iNum ( 0 )        sR = "": sH = "": sS = iNum ( 0 )        j = 1        Do While ( i + j <= UBound ( myMusic ))           If ( myMusic ( i ). strTitle _                 <> myMusic ( i + j ). strTitle ) Then Exit Do           k = myMusic ( i + j ). intRow           If ( k = iNum ( 1 ) + 1 ) Then              iNum ( 1 ) = k              sM = ","              If ( iNum ( 1 ) - iNum ( 0 ) > 1 ) Then sM = "～"              sS = iNum ( 0 ) & sM & iNum ( 1 )           Else              sR = sR & sH & sS              sH = ","              iNum ( 0 ) = k : iNum ( 1 ) = k              sS = iNum ( 0 )           End If           j = j + 1        Loop        myMusic ( i ). strLine = sR & sH & sS        i = i + j     Wend     ' 確認 用     For i = 0 To UBound ( myMusic )        With myMusic ( i )           Debug . Print .s trTitle , . intRow , .s trLine        End With     Next End Sub 
list . Add ( Me . DataGridView 1 ( 0 , 0 ). Value ) を Dim list As New List ( Of String ) With DataGridView 1 For r As Integer = 0 To . RowCount - 1 For c As Integer = 0 To . ColumnCount - 1 Dim Cell As DataGridViewCell = . Item ( c , r ) If Not Cell Is Nothing Then If Not String . IsNullOrEmpty ( Cell . Value ) Then list . Add ( Cell . Value ) End If End If Next Next End With として み て 下さい 。 
atumu 0925 さん クリップボード の 処理 という の で は なく 、 ブック 間 で コピー すれ ば いい の です よ ね 。 コピー 側 の ブック は 何 も する 必要 は あり ませ ん 。 貼り 付け 側 （ コピー さ れ て 内容 が 変わる 方 ） の ブック の オープン に マクロ を 書く だけ で いい と 思い ます 。 2つ の ブック の フォルダ は 仮に 同じ として 、 シート は 両方 Sheet 1 と し ます 。 元 の ブック の ファイル 名 を 「 a . xlsx 」 と し て い ます 。 実際 の フォルダ や 名前 で 変更 し て 下さい 。 Private Sub Workbook _ Open () Dim wb As Workbook Set wb = Workbooks . Open ( ThisWorkbook . Path & "\ a . xlsx ") ThisWorkbook . Worksheets (" Sheet 1 "). Range (" A1 "). Value = wb . Worksheets (" Sheet 1 "). Range (" A1 "). Value wb . Close End Sub 
こんにちは。 一応 、 B 1 から B5 0 まで の セル が 変化 し た とき 、 それぞれ の F G 列 に 相当 する セル に対して 日 付け を 打ち込む コード です 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) If Inter sect ( Target , Range (" B 1 : B5 0 ")) Is Nothing Then Else For Each t 1 In Target If t 1 . Column = 2 Then Application . EnableEvents = False t 1 . Offset ( 0 , 4 ). Value = Now t 1 . Offset ( 0 , 5 ). Value = Time Application . EnableEvents = True End If Next End If End Sub change イベント は 、 イベント 抑制 を 使わ ない と 、 永久 ループ し て しまう ので 組み合わせ ます 。 select ion の 場合 は 、 イベント 抑制 の 意味 が あまり あり ませ ん 。 
こんにちわ 前回 の 質問 時 に 書い た ので 、 投稿 し ます 。 ' myDic ( iRow & " 行 " & 数値 ) 行 に その 数値 が いくつ 使わ れ て いる か を セット ' myDic ( iCol & " 列 " & 数値 ) 列 に 、 その 数値 が 、 いくつ 使わ れ て いる か を セット ' myDic (" 数値 " & 数値 ) その 数値 が 、 いくつ 使わ れ て いる か を セット Sub kumiawase () Dim myDic As Object , myKey Dim i As Long , j As Long , 数値 As Long Dim 数値 1 As Long , 数値 2 As Long Dim iCol As Long , iRow As Long Dim myArray ( 0 To 14 , 0 To 5 ) As Long Dim jobCount As Long reStart : Cells ( 1 , " A "). Resize ( 15 , 6 ). ClearContents Set myDic = CreateObject (" Scripting . Dictionary ") For i = 0 To 14 For j = 0 To 5 myArray ( i , j ) = - 1 Next j Next i ' 一列 目 に 1 から 9 の 値 を せっ と ' 二 列 目 から 六 列 目 まで に ､ 0 から 9 を セット For iCol = 0 To 5 For 数値 = 0 To 9 Do iRow = Int ( Rnd * 15 ) If iCol = 0 And 数値 = 0 Then Exit Do ElseIf myDic ( iRow & " 行 " & 数値 ) > 0 Then Else If myArray ( iRow , iCol ) = - 1 Then myArray ( iRow , iCol ) = 数値 myDic ( iRow & " 行 " & 数値 ) = myDic ( iRow & " 行 " & 数値 ) + 1 myDic ( iCol & " 列 " & 数値 ) = myDic ( iCol & " 列 " & 数値 ) + 1 myDic (" 数値 " & 数値 ) = myDic (" 数値 " & 数値 ) + 1 Exit Do End If End If Loop Next 数値 Next iCol ' 上 で 、 セット し て い ない 項目 を セット For iCol = 0 To 5 For iRow = 0 To 14 jobCount = 0 Do If myArray ( iRow , iCol ) <> - 1 Then Exit Do 数値 = Int ( Rnd * 10 ) If iRow = 0 Then 数値 1 = myArray ( iRow + 1 , iCol ) 数値 2 = 数値 1 ElseIf iRow = 14 Then 数値 2 = myArray ( iRow - 1 , iCol ) 数値 1 = 数値 2 Else 数値 1 = myArray ( iRow + 1 , iCol ) 数値 2 = myArray ( iRow - 1 , iCol ) End If If iCol = 0 And 数値 = 0 Then ElseIf myDic ( iRow & " 行 " & 数値 ) > 0 Then ElseIf myDic ( iCol & " 列 " & 数値 ) > 2 Then ElseIf 数値 = 数値 1 Then ElseIf 数値 = 数値 2 Then ElseIf myDic (" 数値 " & 数値 ) >= 9 Then Else myArray ( iRow , iCol ) = 数値 myDic ( iRow & " 行 " & 数値 ) = myDic ( iRow & " 行 " & 数値 ) + 1 myDic ( iCol & " 列 " & 数値 ) = myDic ( iCol & " 列 " & 数値 ) + 1 myDic (" 数値 " & 数値 ) = myDic (" 数値 " & 数値 ) + 1 Exit Do End If jobCount = jobCount + 1 If jobCount > 1000 Then Set myDic = Nothing GoTo reStart ' MsgBox " 組み合わせ が でき ませ ん でし た ので 、 やり直し て ください 。 " ' Exit Sub End If Loop Next iRow Next iCol Cells ( 1 , " A "). Resize ( 15 , 6 ). Value = myArray Set myDic = Nothing End Sub 
こんにちは。 for each w 1 in application . workbooks debug . print w 1 . name next と し た み た とき に 、 主 様 の 開き たい ブック は 、 どんな 名前 でしょ う か 。 不一致 だ から 、 エラー という こと に なる 、 という こと と 、 たまに 、 「 開き 方 」 によって は 、 ブック と ブック が 接続 し ない 場合 も あり ます 。 管理 さ れ た フォルダ 空間 の 場合 、 セキュリティ が ブロック する 、 という 可能性 です 確認 し て み て ください 
DLookup (" ID ", " T 社員 コード ", " ID ='" & Me . txtID & "'") で 取得 し て いる の は 、 ID じゃ ない です か ？ それ と パスワード を 比較 し て いる ので 、 一致 し ない に なっ てる か と 。 
一 例 です 。 Sub sample () Dim i As Long For i = 1 To Cells ( Rows . Count , 2 ). End ( xlUp ). Row - 1 With Cells ( i , 2 ) If . Offset (, - 1 ). Value = . Offset ( 1 , - 1 ). Value Then If . Value + 1 <> . Offset ( 1 ). Value Then With . Resize (, 4 ). Borders ( xlEdgeBottom ) . Color = vbRed End With End If If . Value = . Offset ( 1 ). Value Then With . Resize ( 2 , 4 ). Borders . Color = vbRed . Item ( xlInsideVertical ). LineStyle = xlNone . Item ( xlInsideHorizontal ). LineStyle = xlNone End With End If End If End With Next i End Sub 
( vba , ctrl ) 1つ の サンプル です 。 ◆ 仮定 ① フォーム は ユーザー フォーム を 使用 ② コンボボックス は 上記 ユーザー フォーム 内 に 存在 、 かつ オブジェ 名 は " ComboBox " ③ ImageC の アクティブ X オブジェ の ある シート が アクティブ ◆ 上記 前提 で ユーザー フォーム 内 に 下記 コード ① コンボ から C を 選択 し た 場合 ImageC は 非表示 に 、 D を 選択 し た 場合 は 再 表示 Private Sub ComboBox _ Change () Select Case Me . ComboBox . Value Case " C ": ActiveSheet . OLEObjects (" ImageC "). Visible = False Case " D ": ActiveSheet . OLEObjects (" ImageC "). Visible = True End Select End Sub ◆ 状況 により OLE オブジェ の 表示 系 は 下記 に も 短縮 できる かも しれ ませ ん ActiveSheet . OLEObjects (" ImageC "). Visible = False ↓ ActiveSheet . ImageC . Visible = False 
＞ 何 が 問題 な の でしょ う か ⇒ 以下 の コード で 終了 し て いる から です 。 If c . Address = FirstAdd Then Exit Sub If c . Address = FirstAdd Then Exit Sub Loop Until d Is Nothing End If ↓ Loop Until c . Address = Firstadd 以下 の 処理 ブロック も 同様 で 如何 でしょ う か 。 
Sub 一 例 です () Dim rng As Range , ii Set rng = Range (" D2 : H2 ") With Range (" B2 ") ii = Application . Match (. Value , rng , 0 ) If Not IsError ( ii ) Then . Offset ( 1 ). Resize ( 11 ). Copy rng ( ii ). Offset ( 1 ) End If End With End Sub 
対象 サイト の ソース を 見 まし た が getElementByClassName で アクセス しよ う と し て いる class = table という もの が 存在 し ない よう な ので document . getElementsByTagName (" table ") に おきかえる と 良い か と 思い ます 。 Sub ボタン 1 _ Click () Dim ie As Object Dim lastRow As Long Dim r As Long lastRow = Range (" B " & Rows . Count ). End ( xlUp ). Row Set ie = CreateObject (" InternetExplorer . Application ") ' ie ie . Visible = True For r = 1 To lastRow url = " http:// sys . web - burger . com / zip /? zipcode =" & Range (" B " & r ) & "& zip address =" & Range (" C " & r ). Value ie . navigate url Do While ie . Busy Or ( ie . ready State <> 4 ): DoEvents : Loop If ie . document . getElementsByTagName (" table "). Length >= 7 Then Range (" D " & r ). Value = ie . document . getElementsByTagName (" table "). Item ( 7 ). innerText End If Next r ie . Quit End Sub 
頂点 に対して 頂点 の 関連性 を 保持 し て 座標 を 持ち たい の です よ ね ？ テーブル の 形 で 持つ なら 、 座標 テーブル と 座標 関連性 テーブル に 分けて 持つ しか ない ん じゃ ない かしら ん 。 描画 の 際 に は 各 頂点 の 座標 を 舐め て 、 線 を 引く とき に 関連性 を 見る 。 もしくは 、 座標 で は なく 、 座標 の 組み合わせ で データ を 保持 する か です ね 。 
↓ の よう な 書き方 の ほう が 、 スッキリ し て いる と 思い ます が 。 。 。 。 。 Dim 行 As Long 行 = 2 With Worksheets (" Sheet 2 ") Do Until . Cells ( 行 , 1 ). Value = "" . Cells ( 行 , 1 ). Resize (, 5 ). Copy End With Worksheets (" Sheet 1 "). Cells ( Rows . Count , 1 ). End ( xlUp ). Offset ( 1 ). PasteSpecial _ Paste := xlPasteValues 行 = 行 + 1 Loop End With 未 実行 につき 不具合 ご 容赦 。 
VBA は Office アプリケーション の 操作 が メイン です ので 、 他社 ツール の 操作 は 不得手 です 。 大抵 は API 関数 を 導入 し て 、 ややこしい 手順 を 踏ん で 操作 する こと に なる の です が 、 ご 質問 の よう な こと が できる か どう かも 怪しい です 。 こう いっ た こと でし たら 、 UWSC という 自動 操作 ツール の 方 が 適し て い ます 。 ウインドウ 操作 も 大抵 は 可能 です し 、 いざ と なっ たら 力 技 で 対応 する こと も でき ます 。 
> ユーザー 定義 型 を 配列 に し た もの は 、 引数 として 渡せ ない の でしょ う か 。 メソッド の 引数 として は 渡せ ます が 、 WorksheetFunction . Transpose の 引数 として は 渡せ ない です 。 
DISPLAY ' 私 の 学籍 番号 は これ です 。 よろしく ね ' MOVE 9 TO W - NUM DISPLAY ' 合計 は ' W - NUM ' です 。 ' この ３ 行 の 一番 後ろ に 「 .」 を つけ ましょ う 
( xl ) リンク アップデート を し ない で ファイル オープン で どう です か ？ Workbooks . Open objBook . Path ↓ ↓ Workbooks . Open objBook . Path , False ↓ ↓ 又は Workbooks . Open objBook . Path , UpdateLinks := False 
こう し て 下さい 。 まず 、 実行ファイル 名 を 取得 し ます 。 http:// dobon .net / vb / dotnet / vb6 / appp at h. html そして 、 その ファイル 名 を キー に し て 、 ミューテックス オブジェクト を 作っ て 、 ２ 重 起動 禁止 に し ます 。 http:// dobon .net / vb / dotnet / process / checkprevinstance . html mutexName = Pat h. GetFileName ( System . Reflection . Assembly . GetExecutingAssembly (). Location ) と やっ たら どうでしょう か ？ 
「 If buf = " False " Then Exit Sub 」 の 次 の 行 の End If が 余計 です 。 または If buf = " False " Then Exit Sub End If と し ます 。 
こんにちは。 ListObjects ( 1 ). Range .s pecialcells ( xlCellTypeVisible ). Rows . Count これ 、 見出し こみ の 行 数 です 。 
( vba , ie ) 仮に P 列 に 表示 さ せる として 下記 で は ない です か ？ Cells ( wRow , " P "). Value = GetValue (. response Text , "> 配当利回り <") この タイプ は html を 見る 必要 が あり ます 。 < dt class =" title "> 配当利回り < span class =" yjS ">（ 会社 予想 ）</ span > html は oHttp . response Text の 中身 です 。 一度 スプリット 関数 など で 配列 取得 する と セル に 表示 し 易い です 。 蛇足 です が 、 大学生 でしょ う か ？ 今 の 中高生 は C言語 を 学校 で 学習 する の でしょ う か ？ 
. DataSource = Data , ここ か と 思い ます 。 エラーメッセージ を 見 て ください 。 > IList または IListSource の どちら か を > データソース として 受け入れ ます 。 DataSource に は 、 IList か IListSource しか 指定 でき ない の です 。 コンボボックス です から 、 複数 の 要素 が 想定 さ れ て いる という わけ です ね 。 
一 例 として は こんな 感じ です か ね １ ． フォルダー を 選ば せる 。 ２ ． 選ん だ フォルダー 以下 に 存在 する ファイル 名 を すべて 取得 ３ ． 既出 ファイル を 格納 し て おく 変数 と 出力 用 の String 変数 を 用意 ４ ． 取得 し た 一覧 から For Each で 1つ ずつ 取り出し て 既出 ファイル の 一覧 に 存在 する か を 確認 し 、 存在 し ない なら 出力 用 の String 変数 に 追記 し て 既出 ファイル 一覧 に ファイル 名 を 追加 。 ５ ． StreamWriter を 使用 し て 出力 。 この コード を ボタン なり 実行 さ せ たい 部分 の プロシージャ 内 に コピペ すれ ば 使え ます 。 Dim fbd As New FolderBrowserDialog ' フォルダー が 選択 さ れ 、 OK が 押さ れ たら If fbd .S howDialog = Windows . Forms . DialogResult . OK Then ' フォルダ 内 の ファイル 一覧 を 一旦 すべて 取得 Dim files As String () = System . IO . Director y . GetFiles ( fbd .S electedPath , "*", System . IO .S earchOption . AllDirectories ) ' 既出 ファイル 格納 用 Dim existsfiles As New System . Collections . Specialize d .S tringCollection ' 出力 する ファイル 一覧 の 文字列 格納 用 Dim filelist As String = String . Empty ' 取得 し た ファイル 一覧 から For Each で 1つ ずつ 取り出す For Each file In files file = Pat h. GetFileName ( file ) ' 既出 ファイル の 一覧 の 中 に 存在 し ない 場合 If existsfiles . Contains ( file ) = False Then ' 出力 用 ファイル 一覧 に ファイル 名 を 追記 する filelist &= file & Environment . NewLine ' 既出 ファイル に 追加 existsfiles . Add ( file ) End If Next file ' ファイル を 出力 Using sw As New StreamWriter (" FileList . txt ", False , System . Text . Encoding . GetEncoding (" shift_jis ")) sw . Write ( filelist ) sw . Close () MsgBox (" ファイル 一覧 を 保存 し まし た ") End Using End If 
B 3 が A で も B で も ない とき は どう し たい の でしょ う か ？ 
for Windows なら だめ です が 、 for Windows Desktop なら できる はず です 。 Professional の 機能 を 使っ て い たり する と だめ かも しれ ませ ん が 。 また 、 インストーラ ー で 修復 する と 直る こと も あり ます 。 なお 、 Express は 商業 利用 可能 です 。 https :// www . visualstudio . com / ja - jp / products / visual - studio - express - v ... > Express 製品 の 商業 目的 の 使用 > Visual Studio Express 製品 は 、 各 製品 の ライセンス 条項 に 従う こと を 条件 として 、 無料 で 商用 、 製造 用 に 使用 でき ます 。 たとえば 、 Express for Windows を 使用 し て アプリ を 作成 し 、 Windows ストア で 販売 する こと が でき ます 。 一方 Community は 、 従業員 数 や 年間 収益 に 制限 が あり ます ので 、 注意 が 必要 です 。 
Debug フォルダ は デフォルト で は 2つ あっ て 、 \ bin \ Debug \ obj \ Debug です が 、 実行 用 の Exe ファイル は \ bin \ Debug の 中 の ファイル でしょ う か ？ また 、 ビルド 時 に フォルダ 内 へ aaa . exe . config aaa . exe . manifest と 言っ た ファイル が 出力 さ れる 場合 は 、 これ も 必要 です 。 
Range (" H1 0 : Lastrng "). Select ↓ Range (" H1 0 : H " & Lastrng . Row ). Select あるいは Range (" H1 0 ", Lastrng ). Select 結合 セル と は 関係 ない です が ・ ・ ・ 。 
まずは ファイル の 拡張子 を 調べ 、 該当 の 拡張子 で あれ ば ファイル 属性 を 取得 し て その 中身 を 判断 する という 流れ に なる か な 。 かなり 前 の もの です が 、 参考 に なる と 思う ので どうぞ 。 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1133580201 ※ 基本 は Windows の 機能 を 使う だけ で 判断 できる ので 頑張っ て ください 。 
こんな でしょ う か 。 「 一つ 上 の 値 を いれ たい 」 という 事 は A 列 の 値 を 入れる の でしょ う か 。 その 場合 入れ た 値 が わかる よう に 「 追加 」 の 文字 を 付け て い ます 。 Sub sample () Dim lastRow As Long Dim r As Long lastRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' A 列 最終 行 For r = lastRow To 1 Step - 1 ' 注目 行 を A 列 最終 行 から 1 行 目 まで 逆順 で If Range (" A " & r ). Value <> Range (" A " & r + 1 ). Value Then ' A 列 注目 行 の 値 が 1つ 下 の 値 と 違っ たら ( 注目 行 が 重複 の 最終 行 なら ) Range (" A " & r + 1 ). EntireRow . Insert ' 1 行 下 に 1 行 追加 Range (" A " & r + 1 ). Value = Range (" A " & r ). Value & " 追加 " ' 追加 し た行 の A 列 に 追加 し た行 の A 列 の 値 ( 注目 行 の A 列 の 値 ) を 代入 ( 追加 し た データ が わかる よう に 「 追加 」 を 付け て いる ) End If Next End Sub 
英文 の サイト です が 、 サンプル コード が 載っ て い ます 。 http:// stackoverflow . com / questions / 10405193 / vb - net - hid - setupdigetde ... 私 自身 、 10年 ほど 前 に C# で USB 機器 の 接続 判定 を 行う ため に USB 関係 の API を 調べ た の です が 、 あまりに 面倒 だっ た ので C言語 で 判定 用 の DLL を 作っ て 逃げ た こと が あり ます 。 
回答 し 直し て ます Samp 1 は 前回 の 記述 方法 を 継承 し 、 結果 書き出し 部分 を ５ 列 一気に 変更 >     v3 c = Array (" D ", " L ") として 一致 判別 する Sheet 3 の 商品 code の 列 を 指定 >     ReDim v3 ( UBound ( v3 c )) で 、 v3 c の 添え 字 に 対応 する 結果 書き出し 表 管理 v3 ( 0 ) で 、 D 列 用 の 表 、 v3 ( 1 ) で 、 L 列 用 の 表 ※ もし 、 同じ パターン の 表 数 を ３つ に する の なら     v3 c = Array (" D ", " L ", " T ") と する だけ で 対応 し ます 各 v3 c の 列 の 処理 行 範囲 が わかっ た 時点 で 、 >              ReDim v ( 1 To UBound ( vA ), 1 To 5 ) >              v3 ( k ) = v と 、 領域 確保 Dictionary で は 、 商品 code を キー として 、 どの 表 の 何 行 目 ･･･ を 覚える >        For k = 0 To UBound ( v3 c ) >              For i = 1 To UBound ( vA ) で ループ 処理 し て いる ので                 dic ( vA ( i , 1 )) = Array ( k , i ) 覚え 終わっ たら 、 Sheet 1 / Sheet 2 の 解釈 処理 に 読み書き 回数 を 減らす ため に 、 シート 単位 で 、 商品 code の 行 範囲 を 求め て ･･･ その 行 範囲 を 継承 し つつ 、 商品 code 列 から の 相対 で 、 発送 日 、 合計 を 入手 入手 し た もの を 解釈 し て いく 商品 code を Dictionary に 覚え て い たら 、 どの 表 の 何 行 目 か を 展開 >                 v = dic ( vA ( j , 1 )) >                 k = v ( 0 ): i = v ( 1 ) 発送 日 が なけれ ば 、 シート 関係 なく ５ 列 目 に 加算 発送 日 が あっ て 、 それ が Sheet 3 の D 5 と 比較 し て ･･･ これ が >                    Select Case CDate ( vD ( j , 1 )) > ・ ・ ・ >                    End Select 間 で 、 切り分け 加算 し て いく Sheet 3 の D 5 の 日付 dt と の 比較 で 分け て いる ので 、 内容 は わかる と 思い ます 不都合 あれ ば 修正 でき ます よ ね ？ 処理 し きっ たら 、 >     v3 c = Array (" D ", " L ") を 基準 に ２ 列 右 隣 から 書き出す ※ 各 表 、 各 シート の 商品 code は ２つ 以上 ある 記述 に なっ て ます 例えば 、 １つ の 場合 、 変数 の 値 は 配列 で は なくなり ます ･･･ なので ポン 以下 で どう なり ます か Public Sub Samp 1 ()     Dim dic As Object     Dim dt As Date     Dim vSs As Variant , vS As Variant     Dim v3 c As Variant , v3 As Variant     Dim vA As Variant , vD As Variant , vN As Variant     Dim v As Variant     Dim i As Long , j As Long , k As Long     Const CSHT 2 As String = " Sheet 2 "     v3 c = Array (" D ", " L ")     ReDim v3 ( UBound ( v3 c ))     vSs = Array ( _           Array (" Sheet 1 ", " F ", " C ", " AJ "), _           Array ( CSHT 2 , " B ", " A ", " R ") _        )     With Worksheets (" Sheet 3 ")        v = Split (. Range (" D 5 "). Text & "(", "(", , vbTextCompare )( 0 )        If ( Not IsDate ( v )) Then Exit Sub        dt = CDate ( v )        Set dic = CreateObject (" Scripting . Dictionary ")        For k = 0 To UBound ( v3 c )           With Range (. Cells ( 11 , v3 c ( k )) _                    , . Cells ( Rows . Count , v3 c ( k )). End ( xlUp ))              vA = . Value              For i = 1 To UBound ( vA )                 dic ( vA ( i , 1 )) = Array ( k , i )              Next              ReDim v ( 1 To UBound ( vA ), 1 To 5 )              v3 ( k ) = v           End With        Next        For Each vS In vSs           With Worksheets ( vS ( 0 ))              With Range (. Cells ( 2 , vS ( 1 )) _                       , . Cells ( Rows . Count , vS ( 1 )). End ( xlUp ))                 vA = . Value                 i = Cells ( 1 , vS ( 2 )). Column - . Column                 vD = . Offset (, i ). Value                 i = Cells ( 1 , vS ( 3 )). Column - . Column                 vN = . Offset (, i ). Value              End With           End With           For j = 1 To UBound ( vA )              If ( dic . Exists ( vA ( j , 1 ))) Then                 v = dic ( vA ( j , 1 ))                 k = v ( 0 ): i = v ( 1 )                 If ( IsDate ( vD ( j , 1 ))) Then                    Select Case CDate ( vD ( j , 1 ))                       Case dt                          If ( vS ( 0 ) = CSHT 2 ) Then                               v3 ( k )( i , 1 ) = v3 ( k )( i , 1 ) + vN ( j , 1 )                               v3 ( k )( i , 2 ) = v3 ( k )( i , 2 ) + vN ( j , 1 )                          End If                          v3 ( k )( i , 3 ) = v3 ( k )( i , 3 ) + vN ( j , 1 )                          v3 ( k )( i , 4 ) = v3 ( k )( i , 4 ) + vN ( j , 1 )                       Case Is < dt                          If ( vS ( 0 ) = CSHT 2 ) Then                               v3 ( k )( i , 2 ) = v3 ( k )( i , 2 ) + vN ( j , 1 )                          End If                          v3 ( k )( i , 4 ) = v3 ( k )( i , 4 ) + vN ( j , 1 )                       Case Else                          v3 ( k )( i , 5 ) = v3 ( k )( i , 5 ) + vN ( j , 1 )                    End Select                 Else                    v3 ( k )( i , 5 ) = v3 ( k )( i , 5 ) + vN ( j , 1 )                 End If              End If           Next        Next        Application .S creenUpdating = False        For k = 0 To UBound ( v3 c )           . Cells ( 11 , v3 c ( k )). Offset (, 2 ) _              . Resize ( UBound ( v3 ( k )), 5 ). Value = v3 ( k )        Next        Application .S creenUpdating = True        Set dic = Nothing     End With End Sub Sheet 1 / Sheet 2 の データ を 入手 する 際 に 、 読み込み 回数 を 減らす ため に > 商品 code の 行 範囲 を 求め て ･･･ > その 行 範囲 を 継承 し つつ 、 商品 code 列 から の 相対 で 、 発送 日 、 合計 を 入手 し て い まし た が 、 読み込み で 回数 が 増え て も そんなに 遅く なら ない ？？？ 各 変数 を ２ 次元 配列 で 扱う より 、 その 値 で 扱い たい ･･･ その 例 が Samp 2 各 シート の 列 定義 を >     vSs = Array ( _ >           Array (" Sheet 1 ", " F1 , C1 , AJ 1 "), _ >           Array ( CSHT 2 , " B 1 , A1 , R1 ") _ >        ) に 変更 し て >              j = 2 >              Do While ( 1 ) >                 With . Rows ( j ). Range ( vS ( 1 )) >                    vA = . Areas ( 1 ). Value >                    vD = . Areas ( 2 ). Value >                    vN = . Areas ( 3 ). Value >                 End With これ で 、 各 変数 は 配列 で は なくなり ます " F1 , C1 , AJ 1 " を . Rows ( j ). Range ( vS ( 1 )) すると . Rows ( j ). Range (" F1 , C1 , AJ 1 ") に なり ある 行 ･･･ そこ を 基準 と し た 相対 の 場所 F1 , C1 , AJ 1 を ･･･ カンマ 区切り が 領域 扱い に なり 、 その 領域 に は １つ の セル しか ない ので ･･･ Samp 1 と 違い 、 以降 、 vA , vD , vN は 値 そのもの 扱い に ･･･ Public Sub Samp 2 ()     Dim dic As Object     Dim dt As Date     Dim vSs As Variant , vS As Variant     Dim v3 c As Variant , v3 As Variant     Dim vA As Variant , vD As Variant , vN As Variant     Dim v As Variant     Dim i As Long , j As Long , k As Long     Const CSHT 2 As String = " Sheet 2 "     v3 c = Array (" D ", " L ")     ReDim v3 ( UBound ( v3 c ))     vSs = Array ( _           Array (" Sheet 1 ", " F1 , C1 , AJ 1 "), _           Array ( CSHT 2 , " B 1 , A1 , R1 ") _        )     With Worksheets (" Sheet 3 ")        v = Split (. Range (" D 5 "). Text & "(", "(", , vbTextCompare )( 0 )        If ( Not IsDate ( v )) Then Exit Sub        dt = CDate ( v )        Set dic = CreateObject (" Scripting . Dictionary ")        For k = 0 To UBound ( v3 c )           With Range (. Cells ( 11 , v3 c ( k )) _                    , . Cells ( Rows . Count , v3 c ( k )). End ( xlUp ))              vA = . Value              For i = 1 To UBound ( vA )                 dic ( vA ( i , 1 )) = Array ( k , i )              Next              ReDim v ( 1 To UBound ( vA ), 1 To 5 )              v3 ( k ) = v           End With        Next        For Each vS In vSs           With Worksheets ( vS ( 0 ))              j = 2              Do While ( 1 )                 With . Rows ( j ). Range ( vS ( 1 ))                    vA = . Areas ( 1 ). Value                    vD = . Areas ( 2 ). Value                    vN = . Areas ( 3 ). Value                 End With                 j = j + 1                 If ( vA = "") Then Exit Do                 If ( dic . Exists ( vA )) Then                    v = dic ( vA )                    k = v ( 0 ): i = v ( 1 )                    If ( IsDate ( vD )) Then                       Select Case CDate ( vD )                          Case dt                               If ( vS ( 0 ) = CSHT 2 ) Then                                     v3 ( k )( i , 1 ) = v3 ( k )( i , 1 ) + vN                                     v3 ( k )( i , 2 ) = v3 ( k )( i , 2 ) + vN                               End If                               v3 ( k )( i , 3 ) = v3 ( k )( i , 3 ) + vN                               v3 ( k )( i , 4 ) = v3 ( k )( i , 4 ) + vN                          Case Is < dt                               If ( vS ( 0 ) = CSHT 2 ) Then                                     v3 ( k )( i , 2 ) = v3 ( k )( i , 2 ) + vN                               End If                               v3 ( k )( i , 4 ) = v3 ( k )( i , 4 ) + vN                          Case Else                               v3 ( k )( i , 5 ) = v3 ( k )( i , 5 ) + vN                       End Select                    Else                       v3 ( k )( i , 5 ) = v3 ( k )( i , 5 ) + vN                    End If                 End If              Loop           End With        Next        Application .S creenUpdating = False        For k = 0 To UBound ( v3 c )           . Cells ( 11 , v3 c ( k )). Offset (, 2 ) _              . Resize ( UBound ( v3 ( k )), 5 ). Value = v3 ( k )        Next        Application .S creenUpdating = True        Set dic = Nothing     End With End Sub 
値 を 入れ たい なら Sub Macro 1 () Worksheets (" Sheet 1 "). Range (" A1 "). Value = _ Worksheets (" Sheet 2 "). Range (" A1 "). Value _ + Worksheets (" Sheet 2 "). Range (" B 1 "). Value End Sub 「 _」 は １ 行 が 長く なっ た 場合 に 途中 で 切る ため の 記号 です 。 関数 式 を 入れ たい なら Sub M acr o2 () Worksheets (" Sheet 1 "). Range (" A1 "). Formula ="= Sheet 2 ! A1 + Sheet 2 ! B 1 " End Sub Range (" A1 ") は Cells ( 1 ," A ") と 書く こと も 出来 ます 。 
Userform から シート に 転記 する と ふりがな 情報 は 空白 に なり ます 。 です ので シート 転記 し た 時 に ふりがな の 設定 を し て から 並べ替え を する 必要 が ある でしょ う 。 http:// office tanaka .net / excel / vb a/t ips / t ip s4 9. htm 並べ替え が でき ない 文字列 で Shift + Alt +↑ キー の 同時 押し を する 、 = PHONETIC 関数 で 表示 、 リボン メニュー の フォント 内 で ふりがな の 表示 、 など で 存在 を 調べ て み て ください 。 
条件 2 の 時 は 普通 という 事 は 、 条件 1 の 時 だけ そのまま TextBox 6 に フォーカス すれ ば いい という 事 でしょ う か 。 その 場合 です 。 TextBox 6 の BeforeUpdate イベント か Exit イベント で Cancel を 使っ て 制御 し ます 。 条件 1 が 成立 する 場合 と 、 TextBox 6 が 変更 さ れ て 条件 1 が 成立 する 場合 と で 、 BeforeUpdate イベント と Exit イベント を 使い分け ます 。 [ 条件 1 が 成立 する 場合 ] Private Sub TextBox 6 _ Exit ( ByVal Cancel As MSForms . ReturnBoolean ) If TextBox 6 . Value = 1 Then Cancel = True End Sub [ TextBox 6 が 変更 さ れ て 条件 1 が 成立 する 場合 ] Private Sub TextBox 6 _ BeforeUpdate ( ByVal Cancel As MSForms . ReturnBoolean ) If TextBox 6 . Value = 1 Then Cancel = True End Sub 
以下 で どう なり ます か マクロ ボタン を クリック さ れ たら Samp 1 を 実行 し て み ます Option Explicit Public Sub Samp 1 ()     Const CRH As Long = 56 - 3     Const CRNGS As String = " C1 , B 1 , M1 "     Dim dic As Object     Dim rng As Range     Dim vA ( 1 To CRH , 1 To 4 ) As Variant     Dim vK As Variant , v As Variant     Dim i As Long , j As Long     Set dic = CreateObject (" Scripting . Dictionary ")     Set rng = Worksheets (" Sheet 1 "). Range (" B 3 ")     While ( rng . Value <> "")        With rng . Offset (, 1 - rng . Column ). Range ( CRNGS )           dic ( Trim (. Areas ( 1 ). Value )) = _              Array (. Areas ( 2 ). Value , . Areas ( 3 ). Value )        End With        Set rng = rng . Offset ( 1 )     Wend     Application .S creenUpdating = False     Set rng = Worksheets (" Sheet 2 "). Range (" B4 ")     i = 1     For Each vK In mySort ( dic . Keys )        If ( i > CRH ) Then           With rng . Resize ( CRH , 4 )              . Value = vA              With . Columns ( 1 )                 . TextToColumns . Cells ( 1 ), xlDelimited _                    , Space := True , ConsecutiveDelimiter := True              End With           End With           Set rng = rng . Offset (, 10 )           Erase vA           i = 1        End If        v = dic ( vK )        vA ( i , 1 ) = vK        vA ( i , 3 ) = v ( 0 )        vA ( i , 4 ) = v ( 1 )        i = i + 1     Next     With rng . Resize ( CRH , 4 )        . Value = vA        With . Columns ( 1 )           . TextToColumns . Cells ( 1 ), xlDelimited _              , Space := True , ConsecutiveDelimiter := True        End With     End With     Application .S creenUpdating = True     Set dic = Nothing End Sub Private Function mySort ( ByVal vA As Variant ) As Variant     Dim v As Variant     Dim i As Long , k As Long     k = 0     v = " Go "     While ( Not IsEmpty ( v ))        k = k + 1        v = Empty        For i = LBound ( vA ) To UBound ( vA ) - k           If ( vA ( i ) > vA ( i + 1 )) Then              v = vA ( i )              vA ( i ) = vA ( i + 1 )              vA ( i + 1 ) = v           End If        Next     Wend     mySort = vA End Function ' 確認 用 簡易 データ 作成 Public Sub testData ()     Dim r As Range     Const CRH As Long = 80     With Worksheets (" Sheet 1 ")        . Cells . Delete        For Each r In . Range (" A1 : N 1 "). Resize ( CRH )           Select Case r . Column              Case Range (" B 1 "). Column                 r . Value = r . Address ( False , False ) & " " _                    & LCase ( r . Address ( False , False ))              Case Range (" C1 "). Column                 r . Value = r . Address ( False , False ) & " " _                    & r . Offset (, 1 ). Address ( False , False )              Case Else                 r . Value = r . Address ( False , False )           End Select        Next        . Columns . AutoFit     End With End Sub ※ 解説 が 必要 で あれ ば 、 返信 いただけれ ば と ････ 
画像 の 文字 が 小さ すぎ て 、 PC の ブラウザ で は 確認 でき ませ ん 。 （ あなた は この 画像 で 、 文字 が 認識 でき ます か ？ ） ソース を コピペ し て 、 質問 文 に 貼り 付け て 下さい 。 >① １ 科目 で も 50 点 未満 が あれ ば 失格 >② ３ 科目 とも 50 点 以上 で 平均 点 が 70 点 以上 で あれ ば 合格 > そう で なけれ ば 不 合格 と 判定 する （ ヒント ） If ① の 条件 Then （ 失格 ） ElseIf ② の 条件 Then （ 合格 ） Else （ 不 合格 ） End If ① の 条件 は 、 それぞれ 「 Or 」 で 結合 ② の 条件 は 、 それぞれ 「 And 」 で 結合 
とりあえず 私 なら こう する か なぁ 。 set ymdtmp =% DATE :/=% set yyyymmdd =% DATE :/=% set n = 1 : LOOP 01 IF not EXIST % ymdtmp % goto NEXT 01 set / a n += 1 set ymdtmp =% yyyymmdd %_% n % goto LOOP 01 : NEXT 01 md % ymdtmp % 
Sub sample () Active Cell . Offset ( 1 ). Resize ( 3 ). EntireRow . Delete End Sub 
下記 の よう に する の は 、 どうでしょう か 。 ie . document . getElementsByClassName (" yt - uix - button yt - uix - button - size - default yt - uix - button - primary ")( 0 ). Click あるいは 、 Set tmp = ie . document . getElementsByTagName (" button ") For Each t In tmp If ( t . InnerText =" ログイン ") Then t . Click Exit For End If Next この よう に し て みる 等 。 
長い ので コード を 先 に 載せ ます 。 C# で は なく C++/CLI です ので ご 注意 を 。 # define _ CRT _ SECURE _ NO _ WARNINGS # define APPLINK _ STDIN 1 # define APPLINK _ STDOUT 2 # define APPLINK _ STDERR 3 # define APPLINK _ FPRINTF 4 # define APPLINK _ FGETS 5 # define APPLINK _ FREAD 6 # define APPLINK _ FWRITE 7 # define APPLINK _ FSETMOD 8 # define APPLINK _ FEOF 9 # define APPLINK _ FCLOSE 10 /* should not be used */ # define APPLINK _ FOPEN 11 /* solely for completeness */ # define APPLINK _ FSEEK 12 # define APPLINK _ FTELL 13 # define APPLINK _ FFLUSH 14 # define APPLINK _ FERROR 15 # define APPLINK _ CLEARERR 16 # define APPLINK _ FILENO 17 /* to be used with below */ # define APPLINK _ OPEN 18 /* formally can ' t be used , as flags can vary */ # define APPLINK _ READ 19 # define APPLINK _ WRITE 20 # define APPLINK _ LSEEK 21 # define APPLINK _ CLOSE 22 # define APPLINK _ MAX 22 /* always same as last macro */ # ifndef APPMACROS _ ONLY # include < stdio . h > # include < io . h > # include < fcntl . h > static void * app _ stdin ( void ) { return stdin ; } static void * app _ stdout ( void ) { return stdout ; } static void * app _ stderr ( void ) { return stderr ; } static int app _ feof ( FILE * fp ) { return feof ( fp ); } static int app _ ferror ( FILE * fp ) { return ferror ( fp ); } static void app _ clearerr ( FILE * fp ) { clearerr ( fp ); } static int app _ fileno ( FILE * fp ) { return _ fileno ( fp ); } static int app _ fsetmod ( FILE * fp , char mod ) { return _ setmode (_ fileno ( fp ), mod == ' b ' ? _ O _ BINARY : _ O _ TEXT ); } # ifdef __ cplusplus extern " C " { # endif __ declspec ( dllexport ) void ** # if defined (__ BORLANDC __) /* * __ stdcall appears to be the only way to get the name * decoration right with Borland C . Otherwise it works * purely incidentally , as we pass no parameters . */ __ stdcall # else __ cdecl # endif OPENSSL _ Applink ( void ) { static int once = 1 ; static void * OPENSSL _ ApplinkTable [ APPLINK _ MAX + 1 ] = { ( void *) APPLINK _ MAX }; if ( once ) { OPENSSL _ ApplinkTable [ APPLINK _ STDIN ] = app _ stdin ; OPENSSL _ ApplinkTable [ APPLINK _ STDOUT ] = app _ stdout ; OPENSSL _ ApplinkTable [ APPLINK _ STDERR ] = app _ stderr ; OPENSSL _ ApplinkTable [ APPLINK _ FPRINTF ] = fprintf ; OPENSSL _ ApplinkTable [ APPLINK _ FGETS ] = fgets ; OPENSSL _ ApplinkTable [ APPLINK _ FREAD ] = fread ; OPENSSL _ ApplinkTable [ APPLINK _ FWRITE ] = fwrite ; OPENSSL _ ApplinkTable [ APPLINK _ FSETMOD ] = app _ fsetmod ; OPENSSL _ ApplinkTable [ APPLINK _ FEOF ] = app _ feof ; OPENSSL _ ApplinkTable [ APPLINK _ FCLOSE ] = fclose ; OPENSSL _ ApplinkTable [ APPLINK _ FOPEN ] = fopen ; OPENSSL _ ApplinkTable [ APPLINK _ FSEEK ] = fseek ; OPENSSL _ ApplinkTable [ APPLINK _ FTELL ] = ftell ; OPENSSL _ ApplinkTable [ APPLINK _ FFLUSH ] = fflush ; OPENSSL _ ApplinkTable [ APPLINK _ FERROR ] = app _ ferror ; OPENSSL _ ApplinkTable [ APPLINK _ CLEARERR ] = app _ clearerr ; OPENSSL _ ApplinkTable [ APPLINK _ FILENO ] = app _ fileno ; OPENSSL _ ApplinkTable [ APPLINK _ OPEN ] = _ open ; OPENSSL _ ApplinkTable [ APPLINK _ READ ] = _ read ; OPENSSL _ ApplinkTable [ APPLINK _ WRITE ] = _ write ; OPENSSL _ ApplinkTable [ APPLINK _ LSEEK ] = _ lseek ; OPENSSL _ ApplinkTable [ APPLINK _ CLOSE ] = _ close ; once = 0 ; } return OPENSSL _ ApplinkTable ; } # ifdef __ cplusplus } # endif # endif # include < cstdio > using name space std ; using name space System ; using name space System :: IO ; using name space System :: Runtime :: InteropServices ; using name space OpenSSL :: Core ; using name space OpenSSL :: Crypto ; using name space OpenSSL :: X5 09 ; value class ExternFunc { public : [ DllImport (" x86 \\ libeay 32 . dll ", CallingConvention = CallingConvention :: Cdecl )] static bool PKCS 12 _ parse ( IntPtr p 12 , String ^ password , IntPtr * pkey , IntPtr * crt , IntPtr * ca ); [ DllImport (" x86 \\ libeay 32 . dll ", CallingConvention = CallingConvention :: Cdecl )] static IntPtr EVP _ PKEY _ get 1 _ RSA ( IntPtr pkey ); [ DllImport (" x86 \\ libeay 32 . dll ", CallingConvention = CallingConvention :: Cdecl )] static bool PEM _ write _ RSAPrivateKey ( IntPtr fp , IntPtr rsa , IntPtr enc , String ^ kstr , int klen , IntPtr cb , IntPtr u ); [ DllImport (" x86 \\ libeay 32 . dll ", CallingConvention = CallingConvention :: Cdecl )] static void EVP _ PKEY _ free ( IntPtr rsa ); [ DllImport (" x86 \\ libeay 32 . dll ", CallingConvention = CallingConvention :: Cdecl )] static void X5 09 _ free ( IntPtr crt ); [ DllImport (" x86 \\ libeay 32 . dll ", CallingConvention = CallingConvention :: Cdecl )] static void sk _ free ( IntPtr stack ); [ DllImport (" x86 \\ libeay 32 . dll ", CallingConvention = CallingConvention :: Cdecl )] static void RSA _ free ( IntPtr rsa ); }; int main ( array < System :: String ^>^ args ) { String ^ privateKey = nullptr ; // 秘密鍵 String ^ publicKey = nullptr ; // 公開鍵 String ^ crtPem = nullptr ; // 証明書 RSA ^ rsa = nullptr ; // RSA 鍵 CryptoKey ^ key = nullptr ; // 鍵 情報 X5 09 Name ^ sbj = nullptr ; // Subject X5 09 Request ^ csr = nullptr ; // CSR X5 09 Certificate ^ crt = nullptr ; // 証明書 Stack < X5 09 Certificate ^>^ ca = nullptr ; // CA PKCS 12 ^ p 12 = nullptr ; // PKCS 12 BIO ^ bio = nullptr ; // 入出力 try { rsa = gcnew RSA (); rsa -> GenerateKeys ( 1024 , 65537 , nullptr , nullptr ); // RSA 鍵 の 生成 privateKey = rsa -> PrivateKeyAsPEM ; publicKey = rsa -> PublicKeyAsPEM ; key = gcnew CryptoKey ( rsa ); sbj = gcnew X5 09 Name (); // Subject の 生成 sbj -> Country = " JP "; sbj -> StateOrProvince = " Nagano - Ken "; sbj -> Locality = " Nagano - Shi "; sbj -> Organization = " Studio - Ephyra "; sbj -> Organization Unit = " None "; sbj -> Common = " studio - ephyra . link "; csr = gcnew X5 09 Request (); // CSR の 生成 csr -> Version = 1 ; csr -> Subject = sbj ; csr -> PublicKey = key ; crt = csr -> CreateCertificate ( 3650 , key ); // 証明書 の 生成 crt -> SerialNumber = 100 ; crtPem = crt -> PEM ; ca = gcnew Stack < X5 09 Certificate ^>(); bio = BIO :: File (" test _ pkcs 12 . p 12 ", " wb "); p 12 = gcnew PKCS 12 (" password ", key , crt , ca ); // PKCS 12 の 生成 p 12 -> Write ( bio ); } finally { delete bio ; delete p 12 ; delete ca ; delete crt ; delete csr ; delete sbj ; delete key ; delete rsa ; } File :: WriteAllText (" test _ privatekey . pem ", privateKey ); File :: WriteAllText (" test _ publickey . pem ", publicKey ); File :: WriteAllText (" test _ certificate . crt ", crtPem ); String ^ crtPemDecoded = nullptr ; // PKCS 12 から デコード し た 証明書 IntPtr p _ pkey ; // PKCS 12 から デコード し た 秘密鍵 IntPtr p _ crt ; IntPtr p _ ca ; IntPtr p _ rsa ; FILE * p _ fp ; try { bio = BIO :: File (" test _ pkcs 12 . p 12 ", " rb "); p 12 = gcnew PKCS 12 ( bio , " password "); crtPemDecoded = p 12 -> Certificate -> PEM ; ExternFunc :: PKCS 12 _ parse ( p 12 -> Handle , " password ", & p _ pkey , & p _ crt , & p _ ca ); p _ rsa = ExternFunc :: EVP _ PKEY _ get 1 _ RSA ( p _ pkey ); fopen _ s (& p _ fp , " test _ decodedprivatekey . pem ", " w "); ExternFunc :: PEM _ write _ RSAPrivateKey ( IntPtr ( p _ fp ), p _ rsa , IntPtr (), nullptr , 0 , IntPtr (), IntPtr ()); } finally { fclose ( p _ fp ); ExternFunc :: RSA _ free ( p _ rsa ); ExternFunc :: sk _ free ( p _ ca ); ExternFunc :: X5 09 _ free ( p _ crt ); ExternFunc :: EVP _ PKEY _ free ( p _ pkey ); delete p 12 ; delete bio ; } File :: WriteAllText (" test _ decodedcertificate . crt ", crtPem ); Console :: ReadLine (); return 0 ; } 
こんな でしょ う か 。 Private Sub Workbook _ BeforePrint ( Cancel As Boolean ) Dim ws As Worksheet For Each ws In Worksheets ' 全 シート を 順に 調べる If ws . Range (" B5 "). Value = " NG " Then ' 注目 シート の B5 が NG なら ws .S elect ' 対象 シート 表示 ( 必要 なら ) MsgBox ws . Name & " に NG判定 が ある ので 印刷 でき ませ ん 。 再度 確認 し て ください ！", vbCritical ' 警告 Cancel = True ' 印刷 キャンセル Exit Sub ' 終了 End If Next End Sub 
下記 の コード でいか が でしょ う か ？ Option Explicit Sub Sample () Dim nm As String , zp As String , adr As String With Active Cell ' アクティブ セル が A 列 以外 なら 何 も し ない If . Column <> 1 Then Exit Sub ' 姓名 を 取得 する nm = . Value ' 郵便番号 を 取得 する zp = . Offset ( 1 , 1 ). Value ' 住所 を 取得 する adr = . Offset ( 2 , 1 ). Value ' 名前 ・ 郵便番号 ・ 住所 の いずれ か が 空欄 なら 何 も し ない If nm = "" Or zp = "" Or adr = "" Then Exit Sub ' 転記 する . Offset ( 4 , 0 ). Value = zp & vbLf & adr & vbLf & nm & " さま " End With End Sub 
下記 の コード でいか が でしょ う か ？ Private Sub OptionButton 1 _ Click () If OptionButton 1 . Value Then Worksheets (" Sheet 1 "). Range (" B " & Day ( Now )). Value = " V " End If End Sub 
Int ( Rnd () * ２ ) で 、 0 か 1 が 得 られ ます 。 Sub test () Dim i As Integer Randomize For i = 1 To 10 Debug . Print Int ( Rnd () * ２ ) Next End Sub 
あなた が 書い た コード を 提示 し て 下さい 。 
微妙 な 個所 が 間違っ て ます 。 細心 の 注意 を 払っ て ください 。 Sub 表 の スタイル () With Range (" A 2 "). Current Region . Borders ( xlInsideHorizontal ). LineStyle = xlDot . BorderAround Line Style := xlContinuous , Weight := xlThick . EntireRow . RowHeight = 25 . ColumnWidth = 10 End With With Range (" A 2 ", Range (" A 2 "). End ( xlToRight )) . Font . Bold = True . Interior . Color Index = 16 . HorizontalAlignment = xlCenter . Borders ( xlEdgeBottom ). LineStyle = xl Double End With End Sub 
こんな 感じ で 、 VBA の 中 で 直接 HTML を 受け取る 方 が 、 なにか と 便利 かも しれ ませ ん 。 http:// oshiete . goo . ne.jp / qa / 1044759 . html あと 、 知恵袋 トップ > 教養 と 学問 、 サイエンス > 言葉 、 語学 > 英語 は 、 カテゴリ 違い で は ? 
シーケンス 図 の よう な 図 に 書き出す と 読み やすい と いう か 、 動作 を 理解 し やすい です 。 
試し て み たい ん です が 、 どの イベント です か ？ 
こんにちは。 二つ目 の プロシージャ の 全て の Workbook を Workbooks と し て ください 。 
私 の PC で 試し まし た が キャンセル し て も エラー は 出 ませ ん でし た 。 参考 まで に 多少 作り直し た コード を 提示 し て おき ます 。 Option Explicit Private Sub Worksheet _ BeforeDoubleClick ( ByVal Target As Range , Cancel As Boolean ) Dim myAreas As Variant , myArea As Variant Dim myRange As Range Dim myPic As Variant Dim myShp As Shape , Shp As Shape myAreas = Array ( _ " B 11 : B2 0 ", " B2 2 : B 31 ", " B 33 : B4 2 ", " B4 4 : B5 3 ", _ " B5 6 : B 65 ", " B 67 : B7 6 ", " B7 8 : B 87 ", " B 89 : B 98 ", _ " B 100 : B 109 ", " M11 : M2 0 ", " M22 : M3 1 ", " M3 3 : M42 ", _ " M4 4 : M 53 ", " M 56 : M65 ", " M67 : M 76 ", " M 78 : M 87 " _ ) For Each myArea In myAreas Set myRange = Range ( myArea ) If Not Inter sect ( Target , myRange ) Is Nothing Then myRange .S elect myPic = Application . GetOpenFilename (" 画像 ファイル ,*. jpg ;*. jpeg ;*. mpeg ;*. mpg ;*. png ") If VarType ( myPic ) <> vbBoolean Then Application .S creenUpdating = False For Each myShp In Me .S hapes If myShp . Name = " 画像 " & Selection . Address Then myShp . Delete End If Next Set Shp = Me .S hapes . AddPicture ( Filename := myPic , _ LinkToFile := False , _ SaveWithDocument := True , _ Left := Selection . Left , _ Top := Selection . Top , _ Width := 0 , _ Height := 0 ) With Shp .S caleHeight 1 !, msoTrue .S caleWidth 1 !, msoTrue . LockAspectRatio = msoFalse . Top = Selection . Top . Left = Selection . Left . Height = Selection . Height . Width = Selection . Width . Rotation = 0 . Name = " 画像 " & Selection . Address End With Application .S creenUpdating = True End If Cancel = True Exit Sub End If Next End Sub 
置換 を すれ ば いい と 思い ます 。 こちら が すごく 参考 に なる はず です 。 https :// technet . microsoft . com / ja - jp / library / ee 692875 . aspx 
６ ４ ビット の ＣＰＵ で 動作 し て いる なら 、 byte も long も 速度 は 変わり ませ ん 。 ３ ２ ビット なら 、 少し は 違い が 出る かも しれ ませ ん 。 ただ 、 メモリー は 余計 に 使う ので 、 大量 の データ を 扱う 時 だけ 考え て 使い ましょ う 。 
ちょっと 長い です が 、 、 、 Range や Cells など セル を 指定 する 際 は 、 前 に ワーク シート の 指定 が 必要 です 。 Worksheets (" Sheet 1 "). Cells ( 1 , 1 ) の よう に 。 省略 は 可能 です が 、 その 際 は アクティブ シート と みなさ れ ます 。 Range も Cells も 両方 です 。 この こと を 頭 に 入れ て 質問 文 の コード を 見る と 、 Worksheets (" Sheet 2 "). Range ( Cells ( 行 , 1 ), Cells ( 行 , 5 )). Copy Range について は 確か に シート 指定 が なさ れ て ます が 、 続く Cells で は 省略 さ れ てる ので アクティブ シート と 見なさ れ ます 。 もし 、 アクティブ シート が Sheet 1 だっ たら どう なる でしょ う ？ Sheet 2 の セル 範囲 を 指定 する のに Sheet 1 の セル を 使っ てる こと に なり 、 エラー と なり ます 。 つづく destination で も 同じ 書き方 に なっ て ます 。 対策 ： 素直 に 書く と シート 指定 すれ ば いい の だ から Worksheets (" Sheet 2 "). Range ( Worksheets (" Sheet 2 "). Cells ( 行 , 1 ), Worksheets (" Sheet 2 "). Cells ( 行 , 5 )). Copy これ でも OK です 。 が 、 パッと 見 、 読み にくい です よ ね 。 With という 便利 な もの が あり ます 。 With Worksheets (" Sheet 2 ") . Range (. Cells ( 行 , 1 ), . Cells ( 行 , 5 )). Copy Destination := Worksheets (" Sheet 1 "). Cells ( 行 + 2 , 1 ) End With 見た目 で 大体 わかり ます よ ね ？ Worksheets (" Sheet 2 ") を くくり 出し て おく と 、 中 で は ピリオド 「.」 を 付ける だけ に 省略 出来る の です 。 もう ひとつ 、 コピー 先 は 先頭 セル だけ でも いい ので 、 その よう に 書い て ます 。 Dim 行 As Integer 行 = 2 with Worksheets (" Sheet 2 ") Do Until . Cells ( 行 , 1 ). Value = "" . Range (. Cells ( 行 , 1 ), . Cells ( 行 , 5 )). Copy Destination := Worksheets (" Sheet 1 "). Cells ( 行 + 2 , 1 ) 行 = 行 + 1 Loop End With 
それ が どんな データベース に つながっ て いる か 判り ませ ん が 。 Math . Floor って 関数 が ある データベース な ん です か ？ なんか VB の Math クラス に 見える ん です けど 。 SQL Server も Oracle も 普通 に Floor だ し 、 、 、 その 辺り です か ね 。 後 、 SQL 文中 に From と 思わ れる ん です が FLOM と 記述 さ れ て いる 所 が 有り ます 。 
理屈 として は 合っ て いる はず です が 、 下記 の よう な こと が ある よう です 。 https :// social . msdn . microsoft . com / Forums / ja - JP / 5 effeccb - 93 a f-4 83 e - 8 ... つまり 、 既に 閉じ られ て いる IE タブ が 何故か 居残っ て い て 、 それ を 拾っ て しまう と 、 ドキュメント が 操作 でき ず に エラー に なる という 理屈 の よう です 。 とりあえず 、 CreateObject で IE 起動 直後 の 、 どこ に も つながっ て い ない 状態 で 実験 し た ところ 、 LocationURL プロパティ は 読み取れ た ので 、 これ を 利用 し て みる の は どうでしょう か 。 ' まずは 、 有効 な URL を 持っ て いる か どう か を 確認 If ( w . LocationURL <> "") Then ' 有効 な URL を 持っ て いれ ば 、 生き て いる ウインドウ と 判断 If ( TypeName ( w . document ) = " HTMLDocument ") Then 最初 の For 文 内 の If 文 を 、 上記 の よう に 2 重 に し て み て ください 。 後 、 その 中 の If 文 の 処理 です が 、 Set ie = w Exit For の よう に 変更 し て ください 。 こう し ない と 、 見つけ て も 、 次 の ウインドウ を 探し に いっ て しまい ます 。 先 の 質問 の 回答 が こう なっ て い た の でし たら 、 こちら の ミス です 。 申し訳 あり ませ ん 。 
下記 の コード でいか が でしょ う か 。 そんなに 難しい コード で は ありません が 、 一行 一行 が 何 を し て いる の か 、 コメント を 参考 に しっかり 理解 し て 下さい 。 Option Explicit Sub Sample () Dim dt As Variant Dim yyyy As String , mm As String Dim fPath As String ' アクティブ シート の A6 の 値 を 取得 する dt = ActiveSheet . Range (" A6 "). Value If Not IsDate ( dt ) Then MsgBox " A6 セル に 日付 が 入力 さ れ て い ませ ん 。 " ActiveSheet . Range (" A6 "). Select Exit Sub End If dt = Format ( dt , " yyyymmdd ") yyyy = Mid ( dt , 1 , 4 ) mm = Mid ( dt , 5 , 2 ) fPath = " D :\" & yyyy ' D :\ yyyy が 存在 し なけれ ば 作成 する If Dir ( fPath , vbDirectory ) = "" Then MkDir fPath ' D :\ yyyy \ mm が 存在 し なけれ ば 作成 する fPath = fPath & "\" & mm If Dir ( fPath , vbDirectory ) = "" Then MkDir fPath ' アクティブ シート を 新しい ブック に コピー する ActiveSheet . Copy With ActiveWorkbook ' 新しい ブック を D :\ yyyy \ mm に 保存 する .S aveAs fPath & "\" & dt & ". xlsx " ' 新しい ブック を 閉じる . Close False End With End Sub 
1 行 ごと に 行 を 挿入 する わけ で は ない ので 、 繰り返し 処理 は 必要 ない と 思い ます 。 With Worksheets (" リスト ") . Range (" B2 : J2 0 "). Copy Destination :=. Range (" B 3 ") . Range (" B2 : J2 "). ClearContents End With 
ソリューション の 種類 を 「 WPF アプリケーション 」 に し て い ませ ん か ？ タイマー コントロール は 「 Windows フォーム アプリケーション 」 で ない と 表示 さ れ ませ ん 。 
こんな でしょ う か 。 Sub sample () Dim file As String file = Sheets (" Sheet 1 "). Range (" A1 "). Value & " 北海道 " ' 保存 ファイル の タイトル ( 最終 的 に 、 Sheet 1 の A1 の 値 +" 北海道 201606 . xlsm " など に なる ) file = file & Format ( DateAdd (" m ", - 1 , Date ), " yyyymm ") & ". xlsm " ' ファイル 名 に 前月 の 日付 ( yyyymm ) を 付加 If MsgBox ( file & vbCrLf & " で デスクトップ に 保存 し ます ", vbOKCancel ) <> vbOK Then Exit Sub ' 確認 file = CreateObject (" Wscript .S hell "). SpecialFolders (" Desktop ") & "\" & file ' デスクトップ の フル パス ThisWorkbook .S aveCopyAs file ' ファイル の コピー を 保存 End Sub 
細かい ところ は ともかく 、 なぜ Set sh = worksheets (" sheet 1 ") では ない の です か ？？？ 
VBA は 要ら ない です 。 マッピング 設定 する だけ で 複数 の ファイル から データ を 抽出 し 一つ に 纏め られ ます 。 下記 の 1 を ご 参考 ください 。 http:// superdbtool . com / blog / archives / 698 
最近 、 フォーム 作成 に関する 質問 に 回答 し まし て 、 すこし 似 て い ます ので 一 度 御覧 ください 。 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1416083667 ... さて こちら で 提示 し まし た コード で 最初 に Dim r As Long ' 変数 宣言 と し て い ます 。 この 、 モジュール の トップ で 宣言 さ れ た 変数 は モジュール 内 の コード で 維持 さ れ ます 。 です ので 、 起動 ボタン を 押し た とき の アクティブ セル の 行 を 格納 し 、 上書き ボタン を 押し た 時 まで その 行番号 を 維持 し て 上書き さ せる こと が でき ます 。 データ 最終 行 を 取得 する の は 一般的 に は Range (" A " & cells . rows . count ). end ( xlUP ). row + 1 と 、 なり ます 。 これ は A 列 最終 行 から Ctrl +↑ を 押し て 移動 する セル に 1 を 足し て そこ が 最終 行 直下 空白 行 、 という 意味 です 。 この 最終 行書 き込み 動作 は先 ほど の データ の 上書き と は 違う ボタン で 実装 さ れる の です よ ね ？ もしくは フォーム で 賞品 番号 の よう な 部分 で 判定 し て 上書き する か 新規 書き込み する か 判断 する とか って 方法 も 取れる ん です が 、 フォーム や その コード の 詳細 が わから ない ので 回答 し かね ます 。 
Sub test () Dim i As Long For i = 1 To Cells ( Rows . Count , 3 ). End ( xlUp ). Row If Cells ( i , 3 ). Offset ( 2 ) = 1 Then Cells ( i , 2 ) = Cells ( i , 2 ). Offset ( 2 ) Cells ( i + 1 , 2 ) = Cells ( i , 2 ). Offset ( 2 ) End If Next End Sub ※ ０ ０ １ が 数値 の 場合 （ 文字列 で も 大して 変わり ませ ん ） 
Private Sub CommandButton 1 _ Click () Dim Sh As Worksheet Dim R As Long Dim i As Long Set Sh = Workbooks (" ブック 1 . xlsx "). Sheets (" シート 1 ") i = 0 With ListBox 1 . Clear . ColumnCount = 2 Do While True R = i * 4 + 13 If Sh . Cells ( R , 2 ) <> "" Then . AddItem . List ( i , 0 ) = Sh . Cells ( R , 2 ) . List ( i , 1 ) = Sh . Cells ( R , 3 ) Else Exit Do End If i = i + 1 Loop End With End Sub の よう な 感じ で 。 
VBA で C 列 の セル 値 が 空白 （ ” ” ） なら ば これ は Ｃ 列 全部 が 空白 という こと でしょ う か ？ 空白 で なけれ ば これ は 一つ で も 空白 が なけれ ば と いう こと でしょ う か ? マクロ ブック と は 現在 ＡＣＴＩＶＥ な マクロ が 組み込ん で ある この ブック という こと です ね 。 シート ２ を コピー し て 保存 し ， どこ へ 保存 する の でしょ う か ? この 例 も 意味 が わかり ませ ん 。 KEN の 新規 ブック で あれ ば 営業 1 部 という 名前 の フォルダ に 。 KEN 云々 より A 列 に 部署 名 が 書い て あり 部署 の フォルダー が ある なら 直接 Ａ 列 を フォルダー 名 に し て 保存 すれ ば いい 訳 です が 何 を 保存 する の でしょ う か この ブック です か 同じ ブック を 担当者 別 に 分け て も 意味 が 無い の で は ? また 質問 の Ｃ 列 と の 関連 も 無い です が ? 
SUMPRODUCT (($ A $3 :$ A $8 = A1 2 )*($ C $1 :$ G $1 = 1 ),$ C $3 :$ G $8 ) か 、 {= SUM ( IF (($ A $3 :$ A $8 = A1 2 )*($ C $1 :$ G $1 = 1 ),$ C $3 :$ G $8 ))} どちら でも で ます 。 数式 の 解説 は こちら を どうぞ 。 Excel 2010 ： 行 ・ 列 で 条件 に 合致 し た もの を 合計 する （ SUMPRODUCT 関数 ） http:// www . office - qa . com / Excel / ex 297 . htm 
へぇ 、 AutoCAD の マクロ って Visual Basic だっ た ん です ね 。 勉強 に なり まし た 。 知恵袋 トップ > スマートデバイス 、 PC 、 家電 > ソフトウェア > CAD 位 の カテゴリ で 聞い た 方 が 回答 貰える と 思い ます よ 。 
変更 のみ で は 対処 でき ませ ん 。 きちんと 、 サブ フォルダー を 走査 する 仕組み を 作る 必要 が あり ます 。 とりあえず 現状 の 処理 を 生かす の で あれ ば 、 現在 の マクロ を 引数 付き に し 、 引数 を フォルダー として 指定 する 形 に し ます 。 そして 、 指定 し た フォルダー 内 の エクセル ファイル に 「 エクセル の 作業 」 を さ せる よう に し て ください 。 その 上 で なら ば 、 サブ フォルダー を 走査 する 仕組み を 追加 し 易く なり ます 。 Sub M acr o2 ( fpath As String ) 略 Path = ～ → これ を 削る buf = Dir ( fpath & "\*. xls ") 以下 、 同じ この 変更 で 、 文字列 で フォルダー を 指定 すれ ば 、 その フォルダー の エクセル ファイル を 処理 し ます 。 そして 、 サブ フォルダー の 走査 です が 、 以下 の よう に でき ます 。 Sub test () fpath = ThisWorkbook . Worksheets (" sheet 1 "). Range (" A1 "). Value Set fso = CreateObject (" Scripting . FileSystemObject ") seek _ folder fso . GetFolder ( fpath ) M acr o2 fpath End Sub Private Sub seek _ folder ( fol As Object ) Dim f As Object For Each f In fol .S ubFolders If ( f .S ubFolders . Count > 1 ) Then seek _ folder f M acr o2 f . Path Next End Sub 「 test 」 を 実行 すれ ば 、 サブ フォルダー に対する 処理 に なり ます 。 実際 に サブ フォルダー を 走査 し て いる か どう か を 確認 する に は 、 M acr o2 fpath ↓ コメントアウト M acr o2 f . Path ↓ Cells ( Rows . Count , 1 ). End ( xlUp ). Offset ( 1 , 0 ). Value = f . Path この よう に 変更 し て み て ください 。 アクティブ シート の A 列 に サブ フォルダー が 列挙 さ れ ます 。 
Windows10 に し て から でしょ う か ？ ネット上では Windows10 の 不 具合 として 、 EXCEL , Word が 開か ない 又は フリーズ する 。 等 の 事柄 が 一杯 報告 さ れ て いる よう です 。 もし 、 以前 の OS で は その様 な 事象 が 出 て い ない の で あれ ば Windows10 が 関係 し て いる かも 。 それ と 、 ちょっと 気 に なっ た の が ＞ ファイル を 開い た とき に 表示 さ れ て い た 「 マクロ を 有効 に し ます か ？ 」 といった 内容 の 警告 文 ・ ・ ・ ・ ・ ・ Excel ２ ００７ から セキュリティ が 強化 さ れ 、 「 マクロ 」 が 含ま れ た ファイル を 開く 際 に マクロ 無効 、 有効 等々 の 警告 文 が 出さ れ ます 。 これ を 解消 し マクロ を 有効 状態 で 警告 文無し で 開く に は 「 セキュリティ センター 」 で 設定 し なけれ ば いけ ない の です が その 手順 の 乗っ て いる 参考 サイト を 掲載 し ます 。 参考 に し て 下さい 。 https :// 121 war e.c om / qasearch / 1007 / app / servlet / relatedqa ? QID = 017208 
VBA の コード を 選択 状態 （ 青 反転 ） に し て 「 TAB 」 キー を 押下 する と １ インデント 分 右側に 移動 （ 左側に 空白 が 出来る ） し ます が 。 ＞ 整える と 言う の が 下 例 の よう に 解り やすく 、 見やすく する の で あれ ば 「 TAB 」 キー を 使う こと は 正解 です 。 ＜ 例 ＞ Dim i As Long Dim e As Long If Target . Column <= 3 Or Target . Column >= 9 Then Exit Sub If Target <> "○" Then Exit Sub Application .S creenUpdating = False i = Target . Column Select Case i Case 5 ' 月 Sheets (" 月 "). Activate With Sheets (" 月 ") e = . Cells ( Rows . Count , " A "). End ( xlUp ). Row + 1 . Cells ( e , 1 ). Value = Target . Offset (, - 3 ). Value . Cells ( e , 2 ). Value = "○" End With Case 6 ' 火 Sheets (" 火 "). Activate With Sheets (" 火 ") e = . Cells ( Rows . Count , " A "). End ( xlUp ). Row + 1 . Cells ( e , 1 ). Value = Target . Offset (, - 4 ). Value . Cells ( e , 2 ). Value = "○" End With ※ ショートカットキー について コード の インデント の ショートカットキー は 「 TAB 」 キー VBA 画面 で の メニュー から の 場合 は 初期 状態 で は 非表示 に なっ て い ます ので 、 メニュー バー の 「 表示 」 ー 「 ツールバー 」 ー 「 編集 」 に チェック を 付け て ください 。 左 インデント と 右 インデント の アイコン が 表示 さ れ ます 。 ※ 上 例 です と 「 Dim i As Long 」 「 Dim e As Long 」 の 2 行 は インデント 無し 。 次 の IF 文行 は １ インデント 。 次 の 「 Application ・ ・ ・ ・ ・ 」 と その 次 行 は ２ インデント （ TAB キー を 2回 押下 ） その 次 の 「 Select Case i 」 は ３ インデント と 、 行 単位 で 選択し 設定 し ます 。 
以下 で どう なり ます か 標準 モジュール に 記述 し 実行 し て み ます ※ ★ 部分 の シート 名 を 変更 し て から Public Sub Samp 1 ()     Dim dic As Object     Dim vA As Variant , vB As Variant , vF As Variant , v As Variant     Dim i As Long , j As Long     Const CSEP As String = ","     Set dic = CreateObject (" Scripting . Dictionary ")     With Worksheets (" Sheet 1 ") ' 作業 シート ★        With . Range (" A1 ", . Cells ( Rows . Count , " A "). End ( xlUp ))           vA = . Value           For i = 1 To UBound ( vA )              dic ( vA ( i , 1 )) = dic ( vA ( i , 1 )) & CSEP & i              vA ( i , 1 ) = " なし "           Next           vB = dic . Keys           With Worksheets (" Sheet 2 ") ' 別表 シート ★              With . Range (" A1 ", . Cells ( Rows . Count , " A "). End ( xlUp ))                 For i = 1 To . Rows . Count                    For Each vF In Filter ( vB , . Cells ( i ). Value )                       For Each v In Split ( dic ( vF ), CSEP )                          j = Val ( v )                          If ( j > 0 ) Then vA ( j , 1 ) = " あり "                       Next                    Next                 Next              End With           End With           . Offset (, 1 ). Value = vA        End With     End With     Set dic = Nothing End Sub 
Excel 2010 では VBA を 使う よう な 方法 以外 に 適当 な 方法 が 見当たり ませ ん 。 Googleスプレッドシート を 使っ て み ませ ん か 。 Googleスプレッドシート なら D 列 は D2 セル に = IMPORTXML (" http:// mn rat e.c om / item / aid /"& C 2 ,"// li [@ class =' quantity used _ price _ color ']") の よう な 数式 を 入れ て 必要 行 まで コピー すれ ば いけ そう です 。 
Private Sub CommandButton 1 _ Click () Dim i As Integer For i = 3 To 34 If IsEmpty ( Cells ( i , " A ")) Then Cells ( i , " A ") = TextBox 1 . Value Exit For End If Next End Sub Private Sub Command Bu t to n2 _ Click () Dim i As Integer For i = 3 To 34 If IsEmpty ( Cells ( i , " F ")) Then Cells ( i , " F ") = ComboBox 1 . Value Exit For End If Next End Sub '【 注意 １ 】 「 登録 ボタン 」 が １つ で 両方 入力 な の か ２つ あっ て 別々 に 入力 な の か 不明 でし た ので 、 ボタン ２つ に 分け て A と F の 作業 を 別に 切り分け て ます 。 '【 注意 ２ 】 空白 行 を 想定 し て ませ ん 。 また 34 行 目 まで 入力 さ れ て い た 場合 の メッセージ など 注意 を 行い ませ ん 。 '【 注意 3 】 その他 必要 と 思わ れる 作業 は 別途 コーディング し て ください 。 あくまで 質問者 様 の ニーズ に だけ 応える コード です 。 
コード 例 です 。 フォーム に Button , Timer , Label を 貼り 付け て 下記 の コード を Form 1 . vb に コピペ し て ください 。 Public Class Form 1 Private Count As Integer Private Sub Form 1 _ Load ( sender As System . Object , e As System . EventArgs ) Handles MyBase . Load Label 1 . Text = "" End Sub Private Sub Button 1 _ Click ( sender As System . Object , e As System . EventArgs ) Handles Button 1 . Click Count = 3 Label 1 . Text = Count . ToString () Time r1 . Interval = 1000 Time r1 . Enabled = True End Sub Private Sub Time r1 _ Tick ( sender As System . Object , e As System . EventArgs ) Handles Time r1 . Tick Count = Count - 1 Label 1 . Text = Count . ToString () If Count = 0 Then Time r1 . Enabled = False 処理 () End If End Sub Private Sub 処理 () MsgBox (" 時間 です ") End Sub End Class 
セル の 値 を 書き換える 、 という こと です ので 、 前回 の ソース から 色々 変更 し まし た 。 Option Explicit Dim c As Long , r As Long Private Sub CommandButton 1 _ Click () Dim newData As String , oldData As String Dim rng As Range , i As Integer ' 修正 さ れ た 内容 を 取得 する newData = TextBox 2 . Text ' ListBox 1 で 選択 さ れ て いる 行 から シート 上 の セル 位置 と 内容 を 取得 する With ListBox 1 Set rng = Range (. List (. ListIndex , 1 )) oldData = rng . Value ' リスト ボックス の データ を 更新 する . List (. ListIndex , 0 ) = newData End With With rng ' シート 上 の セル の データ を 更新 する . Value = newData .S elect End With ' ComboBox 2 の データ を 更新 する With ComboBox 2 For i = 0 To . ListCount - 1 If . List ( i , 0 ) = oldData Then . List ( i , 0 ) = newData Exit For End If Next End With End Sub Private Sub ListBox 1 _ Change () If ListBox 1 . ListIndex = - 1 Then Exit Sub ' ListBox 1 で 選択 さ れ た データ を TextBox 2 に 設定 する TextBox 2 . Text = ListBox 1 . List ( ListBox 1 . ListIndex ) End Sub Private Sub ComboBox 2 _ Change () If ComboBox 2 . ListIndex = - 1 Then Exit Sub With ListBox 1 . Clear ' ComboBox 2 で 選択 さ れ た データ から シート 上 の 列 番号 を 取得 する c = Range ( ComboBox 2 . List ( ComboBox 2 . ListIndex , 1 )). Column ' ListBox 1 に ComboBox 2 で 選択 さ れ た 列 の データ と セル 位置 を 設定 する For r = 2 To Cells ( Rows . Count , c ). End ( xlUp ). Row . AddItem Cells ( r , c ). Value . List (. ListCount - 1 , 1 ) = Cells ( r , c ). Address Next End With End Sub Private Sub ComboBox 1 _ Change () If ComboBox 1 . ListIndex = - 1 Then Exit Sub With ComboBox 2 . Clear ' ComboBox 1 で 選択 さ れ た データ から シート 上 の 列 番号 を 取得 する c = Range ( ComboBox 1 . List ( ComboBox 1 . ListIndex , 1 )). Column ' ComboBox 2 に ComboBox 1 で 選択 さ れ た 列 の データ と セル 位置 を 設定 する For r = 2 To Cells ( Rows . Count , c ). End ( xlUp ). Row . AddItem Cells ( r , c ). Value . List (. ListCount - 1 , 1 ) = Cells ( r , c ). Address Next End With End Sub Private Sub UserForm _ Initialize () Dim rng As Range ' ComboBox 1 の 初期 設定 を 行う With ComboBox 1 . ColumnCount = 2 . ColumnWidths = "; 0 " ' ComboBox 1 に D1 : S1 の 値 と セル 位置 を 設定 する For Each rng In Range (" D1 : S1 "). Cells . AddItem rng . Value . List (. ListCount - 1 , 1 ) = rng . Address Next End With ' ComboBox 2 の 初期 設定 を 行う With ComboBox 2 . ColumnCount = 2 . ColumnWidths = "; 0 " End With ' ListBox 1 の 初期 設定 を 行う With ListBox 1 . ColumnCount = 2 . ColumnWidths = "; 0 " End With End Sub 
さぁ 、 VB が どの VB か 判り ませ ん が 、 レイヤー と 同等 の 機能 は 無い です が 、 実装 し た こと が 有り ます よ 。 Visual Basic ２ ０ １ ０ です けど 。 透過 さ せ た ところ に 描画 すれ ば 良い ん じゃ ない か な 。 透過 イメージ を 重ねる の は そんなに 難しく ない です 。 それ を ちゃんと 内部 で イメージ として やる だけ です し 。 
以下 で どう なり ます か シート A , B 名 は 、 Sheet 1 / Sheet 2 として 確認 し て まし た > vS = Array (" Sheet 1 ", " Sheet 2 ") > vF = Array (" R _ Sheet 1 . txt ", " R _ Sheet 2 . txt ", " R _ Sheet 1 _ 2 . txt ") vF の 記述 順 は 、 vS 左側 だけ に ある もの 、 右側 だけ に ある もの 、 キー が 一致 し 内容 が 違う もの これ を 出力 する テキストファイル 名 > キー が 一致 すれ ば 特定 列 を 比較 し 同じ なら 何 も し ない 。 > 違う なら その キー を 抽出 。 より 、 ３つ 目 の ファイル は 内容 が 違う もの を ･･･ ★ 部分 を 変更 の 上 、 実行 し て み て どう なり ます か なお 、 各 シート 、 B , C 列 で 処理 し まし た Public Sub Samp 1 ()     Dim dicA As Object , dicB As Object , dicC As Object     Dim vA As Variant , v As Variant     Dim vS As Variant , vF As Variant , vDic As Variant     Dim ffn As Integer     Dim i As Long     Const CSEP As String = ","     Set dicA = CreateObject (" Scripting . Dictionary ")     Set dicB = CreateObject (" Scripting . Dictionary ")     Set dicC = CreateObject (" Scripting . Dictionary ")     vS = Array (" Sheet 1 ", " Sheet 2 ") ' シート A , B の 順 ★     vF = Array (" R _ Sheet 1 . txt ", " R _ Sheet 2 . txt ", " R _ Sheet 1 _ 2 . txt ") ' ★     For Each v In vS        With Worksheets ( v )           With . Range (" B 1 ", . Cells ( Rows . Count , " B "). End ( xlUp ))              vA = . Resize (, 2 ). Value           End With        End With        If ( dicA . Count = 0 ) Then           For i = 1 To UBound ( vA )              dicA ( vA ( i , 1 )) = vA ( i , 2 )           Next        Else           For i = 1 To UBound ( vA )              If ( dicA . Exists ( vA ( i , 1 ))) Then                 If ( dicA ( vA ( i , 1 )) <> vA ( i , 2 )) Then                    dicC ( vA ( i , 1 )) = dicA ( vA ( i , 1 )) & CSEP & vA ( i , 2 )                 End If                 dicA . Remove vA ( i , 1 )              Else                 dicB ( vA ( i , 1 )) = vA ( i , 2 )              End If           Next        End If     Next     vDic = Array ( dicA , dicB , dicC )     ffn = FreeFile ()     For i = 0 To 2        If ( vDic ( i ). Count > 0 ) Then           Open ThisWorkbook . Path & "\" & vF ( i ) For Output As # ffn           For Each v In vDic ( i ). Keys              Print # ffn , v & CSEP & vDic ( i )( v )           Next           Close # ffn        End If     Next     Set dicA = Nothing     Set dicB = Nothing     Set dicC = Nothing End Sub ※ 提示 あっ た データ で 出来上がっ た 内容 は 以下 R _ Sheet 1 . txt A1 02 , かき くけ こ R _ Sheet 2 . txt A1 07 , は ひ ふ へ ほ R _ Sheet 1 _ 2 . txt A1 06 , なに ぬ ね の , な な な な な なお 、 ファイル 内 は キー だけ で 良い の なら              Print # ffn , v & CSEP & vDic ( i )( v ) ↓              Print # ffn , v 
IndexOf の ヘルプ を 良く 読ん で ください 。 「 その 文字列 が 見つかっ た 場合 は 、 value の 0 から 始まる インデックス で の 位置 。 見つから なかっ た 場合 は - 1 。 」 と 書い て あり ます 。 です から 「 i = str . IndexOf (" a ")」 は 3 では なく 2 が 返り ます 。 そういう 意味 で は バイト 位置 は 4 に なり ます 。 下記 の コード を ステップ 実行 し て 確かめ て ください 。 Dim str As String Dim iStr As Long , iByte As Long Dim subStr As String str = " あい a1 2 う 3 " iStr = str . IndexOf (" a ") subStr = str .S ubstring ( 0 , iStr ) iByte = System . Text . Encoding . GetEncoding (" SHIFT - JIS "). GetByteCount ( subStr ) 
承認 前 という シート の シート モジュール に 下記 を 書い て おけ ば 、 自動 で 実行 し ます 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) ' mayu vogue If Target . Count > 1 Then Exit Sub If Inter sect ( Target , Range (" C 8 : C5 7 ")) Is Nothing Then Exit Sub If Target . Value = " AC " Then Worksheets (" 承認 後 "). Range (" D " & Target . Row ). Value = " 確認 要 " ElseIf Target . Value = " PC " Then Worksheets (" 承認 後 "). Range (" D " & Target . Row ). Value = " 確認 不要 " ElseIf Target . Value = "" Then Worksheets (" 承認 後 "). Range (" D " & Target . Row ). Value = "" End If End Sub 
下記 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim cnt As Integer , r As Long , rd As Long rd = 2 For r = 2 To Range (" A " & Rows . Count ). End ( xlUp ). Row For cnt = 0 To DateDiff (" d ", DateValue ( Range (" B " & r ). Value ), DateValue ( Range (" C " & r ). Value )) Range (" D " & rd ). Value = DateAdd (" d ", cnt , Range (" B " & r ). Value ) rd = rd + 1 Next cnt Next r End Sub 
下記 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim r As Long , c As Integer For r = 1 To Range (" A " & Rows . Count ). End ( xlUp ). Row With Range (" A " & r ) ' 先頭 の 文字 が アルファベット か どう か を 判定 する c = Asc ( Left (. Value , 1 )) If ( c >= 65 And c <= 90 ) Or ( c >= 97 And c <= 122 ) Then ' アルファベット なら 一行 上 の B 列 に 移動 さ せる . Offset (- 1 , 1 ). Value = . Value . Value = "" End If End With Next r End Sub 
> なぜ でしょ う か 。 プログラム を 見 ない うち は 、 原因 など 解り よう が 無い の は 、 ご 承知 な ん です よ ね ？ > 同時に マクロ を 行える コード 意味不明 。 > sheetsB の E 12 に 文字 を 記入 する マクロ Sheets (" A "). Activate ActiveSheet .S hapes . Range ( Array (" ボタン A ")). Visible = True Worksheets (" B "). Range (" E 12 "). Value = " 記入 する 文字 " 
範囲 が 違わ ない かしら ん 。 因みに 別途 ロジック の 資料 です が 。 こっち の 方 が 早い かも 。 http:// www . atmarkit . co.jp / fdotnet / dotnet tips / 054 iskana / iskana . html 
「 データ 統合 」 http:// www 4 .s ynapse . ne.jp / yone / excel 2013 / excel 2013 _ tougou . html の 操作 を マクロ 記録 に 録 って 、 手 を 加える の が 安直 ・ 最速 でしょ う 。 Sheet 1 の B 1 から 始まる 表 を 、 新規 シート に 統合 し て い ます 。 Private Sub CommandButton 1 _ Click () Const xDta As String = " Sheet 1 " With Worksheets ( xDta ). Range (" B 1 ") xAdr = "'" & xDta & "'!" & . Current Region . Address (, , xl R1 C1 ) . Copy End With With Worksheets . Add . Range (" A1 ") . PasteSpecial . Consolidate Sources := xAdr , Function := xlSum , _ TopRow := True , LeftColumn := True , CreateLinks := False End With End Sub 
フォーム の Activate イベント に 下記 で 出来る と 思い ます 。 Private Sub UserForm _ Activate () Dim 先 頭文字 As String 先頭 文字 = Left ( ActiveSheet . Name , 1 ) With ListBox 1 . ColumnCount = 1 Select Case 先 頭文字 Case " あ " . RowSource = " リスト ! A 2 : A 20 " Case " い " . RowSource = " リスト ! B2 : B2 0 " Case " う " . RowSource = " リスト ! C 2 : C 20 " Case " え " . RowSource = " リスト ! D2 : D2 0 " Case " お " . RowSource = " リスト ! E2 : E2 0 " End Select . ColumnHeads = False End With End Sub 
間違い が あっ たら ごめんなさい 。 クラス の フィールド として 以下 を 定義 Private timer As System . Timers . Timer = Nothing Private done _ 1715 As Boolean = False Private done _ 1400 As Boolean = False Private done _ 1215 As Boolean = False Private done _ 0915 As Boolean = False Load イベント で 以下 の 処理 を 記述 Dim time = Da te Time. Now . TimeOfDay If time > New TimeSpan ( 17 , 15 , 0 ) Then done _ 1715 = True done _ 1400 = True done _ 1215 = True done _ 0915 = True ElseIf time > New TimeSpan ( 14 , 0 , 0 ) Then done _ 1715 = False done _ 1400 = True done _ 1215 = True done _ 0915 = True ElseIf time > New TimeSpan ( 12 , 15 , 0 ) Then done _ 1715 = False done _ 1400 = False done _ 1215 = True done _ 0915 = True ElseIf time > New TimeSpan ( 9 , 15 , 0 ) Then done _ 1715 = False done _ 1400 = False done _ 1215 = False done _ 0915 = True Else done _ 1715 = False done _ 1400 = False done _ 1215 = False done _ 0915 = False End If timer = New System . Timers . Timer ( 30000 . 0 ) AddHandler timer . Elapsed , Sub ( s , e ) Dim t = e . Signal Time. TimeOfDay If Not done _ 1715 And t > New TimeSpan ( 17 , 15 , 0 ) Then done _ 1715 = True ' 17 : 15 の 処理 ElseIf Not done _ 1400 And t > New TimeSpan ( 14 , 0 , 0 ) Then done _ 1400 = True ' 14 : 00 の 処理 ElseIf Not done _ 1215 And t > New TimeSpan ( 12 , 15 , 0 ) Then done _ 1215 = True ' 12 : 15 の 処理 ElseIf Not done _ 0915 And t > New TimeSpan ( 9 , 15 , 0 ) Then done _ 0915 = True ' 09 : 15 の 処理 ElseIf t < New TimeSpan ( 0 , 1 , 0 ) Then done _ 1715 = False done _ 1400 = False done _ 1215 = False done _ 0915 = False End If End Sub timer .S tart () 
Sub Sample () Dim i As Long For i = 2 To Cells ( Rows . Count , 3 ). End ( xlUp ). Row Step 2 Range (" C " & i & ": P " & i ). Copy Destination := Range (" Q " & Int ( i / 2 )) Next i End Sub 
質問 です 。 ① 質問 で は 「 現場 」 という ブック を 対象 と する よう に 書か れ て い ます が 、 添付 さ れ た 画像 で は 「 ☆ 現場 ごと 台帳 ☆ 」 という 名前 に なっ て い ます 。 どちら が 正しい の でしょ う か ？ ② もし D 列 の 名前 が 「 現場 」 ブック の シート 名 に 存在 し なかっ た 場合 は どの よう に すれ ば よい の でしょ う か ？ ③ マクロ を ２ 回 続け て 実行 し て しまっ た 場合 など 、 既に 同一 の データ が 現場 ブック に 存在 し て い た 場合 は どの よう に すれ ば よい の でしょ う か ？ 
. document . GetElementsById (" Email "). Value = " アドレス @ gmail . com " と し た 場合 は どう なり ます か ？ 
＞. ChartObjects ( 1 ). Chart .S etSourceData Source := ThisWorkbook . Worksheets ( 1 ). Range (" AO 4 "). Resize ( suji , 3 ) グラフ の データ が 、 マクロ を 書い た ブック の AO 4 ～ suji 3 に なっ て ます 。 望み は おそらく 開い た ブック の シート に ある データ を 使い たい の でしょ う から 、 以下 の よう に 変更 し ます 。 ThisWorkbook → Workbooks ( wbName ) 
マクロ は 私 は よく 判り ませ ん が フォルダ を 検索 です が その後 何 を さ れる の です か ？ また 複数 一致 なら ？？？ Windows の 検索 機能 で は だめ な の です か ？ http:// windows . microsoft . com / ja - jp / windows - 10 / get started - search - for ... http:// windows . microsoft . com / ja - jp / windows - vista / tips - for - finding - f ... 
LINQ to SQL を 利用 する と 簡単 です 。 .NET の 標準 機能 な ので 、 安心 し て 使え ます 。 まず 、 ＞ 一旦 、 クラス へ 入れ て から 更新 かけよ う と 思う の です が と おっしゃっ て い た クラス を 自動 生成 し ます 。 プロジェクト を 右クリック し 、 [ 追加 ]->[ 新しい 項目 ] を クリック 。 左 の [ データ ] を 選択 し 、 [ LINQ to SQL クラス ] を 選択 し て 、 名前 を つけ （ 仮に [ xxxx ] と し ます ） 、 追加 を クリック 。 空白 の GUI が 開き ます 。 そうしたら 、 ツールボックス から クラス を Drag & Drop し ます 。 これ で クラス が 生成 さ れ まし た 。 [ Class 1 ] の 部分 を クリック し て 、 [ TableA ] と クラス 名 を つけ ましょ う 。 次に 、 プロパティ を 追加 し て いき ます 。 クラス を 右クリック し 、 [ 追加 ]->[ プロパティ ] です 。 プロパティ は DB の 列 名 に し ましょ う 。 Code 、 Name 、 ・ ・ ・ と 追加 し て いき ましょ う 。 プロパティ を 選択 する と 、 右 下 （ もしくは 左下 ？ ） の プロパティ ウィンドウ に 、 その プロパティ の 情報 が 表示 さ れ ます 。 [ 主キー ]、[ 型 ]、[ Null 許容 ]、 あたり を 編集 し て おき ましょ う 。 これ で TableA クラス の 完成 です 。 複数 の テーブル クラス を 作る 場合 、 [ 関連付け ] の 設定 も 必要 です が 、 それ は 参考 サイト を 見 て ください 。 あと は コーディング です が 、 先 ほど 作っ た TableA クラス の 他 に 、 xxxxDataContext という クラス が 生成 さ れ て い ます 。 （ この [ xxxx ] は先 ほど つけ た 名前 です 。 ） この xxxxDataContext を 使い 、 以下 の よう に DB に 接続 し ます 。 var db = new xxxxDataContext ("[ 接続 文字列 ]"); [ 接続 文字列 ] は 環境 によって 変わり ます 。 そして 、 Insert の 仕方 は 以下 の とおり です 。 TableA table = new TableA (); table . Code = " 0001 "; table . Name = " 日本 太郎 "; ・ ・ ・ db . TableA . InsertOnSubmit ( table ); // Insert db .S ubmitChanges (); // Commit この よう に 、 SQL を 使用 する 必要 が なくなり ます 。 これ を 読ん で 、 いい な 、 と 思っ たら 使っ て み て ください 。 ここ を 読め ば 、 LINQ to SQL が 一 通り わかり ます 。 http:// ufcpp .net / study / csharp / sp 3 _ linqtosql . html 
input し た ファイル ァイル を output input 、 output 、 ファイル の それぞれ の 使い かた 間違っ て い ませ ん か どういう 意味 か わかり ませ ん 。 セル に 入力 し た 文字列 を その セル に 縦書き に 表示 し たい なら わかり ます が ??? 
Sheet 4 から 最終 シート まで を 複数 選択 し て 検索 ダイアログ を 表示 する 例 です 。 シート の 数 に 自動 対応 する の で あれ ば Array を 使う メリット は 全く あり ませ ん 。 Option Explicit Sub Sample () Dim intF As Integer Dim i As Integer intF = 0 For i = 4 To Worksheets . Count If intF = 0 Then Sheets ( i ). Select intF = 1 Else Sheets ( i ). Select False End If Next i Worksheets ( 4 ). Range (" A1 "). Select SendKeys "^ c " SendKeys "^ f " SendKeys "^ v " SendKeys "{ Enter }" End Sub 
以下 で どうでしょう Dictionary を 使い ます Dictionary オブジェクト https :// msdn . microsoft . com / ja - jp / library / cc 428065 簡単 に いえ ば 、 キー に 関連 する もの を 一緒 に 覚え て おく チーム 名 を キー として 、 評価 を 覚え て いき ます >           dic ( vA ( i , 1 )) = vA ( i , 2 ) これ によって 、 ・ キー が なかっ たら 新しく 覚え て ・ キー が あっ たら 更新 し て 覚え ます これ により 、 １つ １つ あるかな いか 判別 し て ･･･ ･･･ 自分 で やる 必要 は なくなり ます ※ 旧 データ 、 新 データ 順 に 単純 に １ 巡 する だけ そして Dictionary に 出来上がっ た もの を 書き出す だけ チーム 名 、 評価 が 隣り 合っ た 列 と 仮定 し て 、 以下 で どう なり ます か Public Sub Samp 1 ()     Dim dic As Object     Dim rngOld As Range , rngNew As Range     Dim vA As Variant , v As Variant     Dim i As Long     Set dic = CreateObject (" Scripting . Dictionary ")     Set rngOld = Worksheets (" Sheet 1 "). Range (" A1 ") ' 旧 データ の 左上     Set rngNew = Worksheets (" Sheet 2 "). Range (" A1 ") ' 新 データ の 左上     For Each v In Array ( rngOld , rngNew )        With v . Current Region           vA = . Resize (, 2 ). Value        End With        For i = 2 To UBound ( vA )           dic ( vA ( i , 1 )) = vA ( i , 2 )        Next     Next     Application .S creenUpdating = False     With rngOld . Offset ( 1 ). Resize ( dic . Count )        . Value = WorksheetFunction . Transpose ( dic . Keys )        . Offset (, 1 ). Value = WorksheetFunction . Transpose ( dic . Items )     End With     Application .S creenUpdating = True     Set dic = Nothing End Sub 
こんにちは。 主 様 、 様子 を 確認 し て ほしい の は 、 ファイル 名 の 計算 の 部分 です 。 半角 スペース も 、 コロン も 、 やめ て ください 。 log の フォルダ 名 が 存在 する の かも 、 確認 です 。 エラー が 発生 し やすい の です から 、 on error の 処理 も 、 ひとまず 、 やめ て ください なに が 起こっ た の か 、 わから なく なり ます 
VBA で USB を 扱う こと 自体 が 簡単 で は あり ませ ん 。 VBA に は USB に関する 機能 が 一切 あり ませ ん ので 、 Windows API を 使っ て 情報 を 取得 する こと に なり ます 。 その ため に は Windows API の 知識 、 英文 の ドキュメント を 読める 根性 、 プロ 並み の VBA の スキル が 必要 に なり ます 。 数 年 がかり で でも 実現 し たい の で あれ ば 、 まず Microsoft から Visual Studio と WDK を ダウンロード し て ください 。 すべて は そこ から です 。 
失敗 時 に は 例外 エラー に なる よう です ね 。 例外 エラー 情報 を 表す Err オブジェクト を 参照 し て いる よう です が 、 もしか し たら 例外 発生 時 の 挙動 を 指定 し て い ない です か ？ 例えば 以下 の よう に し たら 対処 出来る か と 思い ます 。 (「 Resume Next 」 で 例外 発生 時 に も 続行 する よう に 指定 し 、 対象 範囲 が 終わっ たら 「 GoTo 0 」 で 例外処理 を 解除 する 。 ) On Error Resume Next objFSO . DeleteFile strDelFile , True If Err . Number = 0 Then msgbox " 成功 時 " Else msgbox " 失敗 時 " End If On Error GoTo 0 
下記 の コード でいか が でしょ う か ？ アクティブ な シート で 使わ れ て いる セル 範囲 すべて を 対象 に し て い ます 。 Sub Sample () Dim Rng As Range For Each Rng In ActiveSheet . UsedRange If Rng . Errors . Item ( xlNumberAsText ). Value = True Then Rng . Errors ( xlNumberAsText ). Ignore = True End If Next End Sub 
あり ます よ 。 「 データ バインド 」 と 言う 技術 です 。 「 Windows フォーム における 「 データ ・ バインディング 」 」 http:// www . atmarkit . co.jp / fdotnet / chushin / introwinform _ 06 / introwinf ... 「 P ar t 1 . 双方向 データ バインド の 基本 的 な 使い方 」 https :// blogs . msdn . microsoft . com / nakama / 2009 / 02 / 26 / par t-1 - 2 / 
Excel です よ ね 。 テーブル 1 とか 言う と Access か と 思っ て しまい ます 。 デー ブル 1 を メイン で 調べる か 、 デー ブル 2 を メイン で 調べる か によって 2 種類 に なり ます 。 Sub sample () Dim w s1 As Worksheet Dim w s2 As Worksheet Dim w s3 As Worksheet Dim lastRow As Long Dim r1 As Long Dim r3 As Long Dim rng As Range Dim y () As String Dim i As Integer ' Set w s1 = Sheets (" テーブル 1 ") Set w s2 = Sheets (" テーブル 2 ") Set w s3 = Sheets (" テーブル 3 ") w s3 . Cells . Clear w s3 . Range (" A1 : D1 "). Value = Array (" ID ", " 氏名 ", " Pass ", " 役職 ") r3 = 2 lastRow = w s1 . Range (" A " & Rows . Count ). End ( xlUp ). Row For r1 = 2 To lastRow Set rng = w s2 . Range (" A : A "). Find ( w s1 . Range (" A " & r1 ). Value , LookAt := xlWhole ) If Not rng Is Nothing Then y = Split ( w s2 . Range (" B " & rng . Row ). Value , ",") For i = 0 To UBound ( y ) If y ( i ) <> "" Then w s3 . Range (" A " & r3 ). Resize ( 1 , 3 ). Value = w s1 . Range (" A " & r1 ). Resize ( 1 , 3 ). Value w s3 . Range (" D " & r3 ). Value = y ( i ) r3 = r3 + 1 End If Next End If Next End Sub または Sub sample () Dim w s1 As Worksheet Dim w s2 As Worksheet Dim w s3 As Worksheet Dim lastRow As Long Dim r2 As Long Dim r3 As Long Dim rng As Range Dim y () As String Dim i As Integer ' Set w s1 = Sheets (" テーブル 1 ") Set w s2 = Sheets (" テーブル 2 ") Set w s3 = Sheets (" テーブル 3 ") w s3 . Cells . Clear w s3 . Range (" A1 : D1 "). Value = Array (" ID ", " 氏名 ", " Pass ", " 役職 ") r3 = 2 lastRow = w s2 . Range (" A " & Rows . Count ). End ( xlUp ). Row For r2 = 2 To lastRow y = Split ( w s2 . Range (" B " & r2 ). Value , ",") For i = 0 To UBound ( y ) If y ( i ) <> "" Then Set rng = w s1 . Range (" A : A "). Find ( w s1 . Range (" A " & r2 ). Value , LookAt := xlWhole ) If Not rng Is Nothing Then w s3 . Range (" A " & r3 ). Resize ( 1 , 3 ). Value = w s1 . Range (" A " & rng . Row ). Resize ( 1 , 3 ). Value w s3 . Range (" D " & r3 ). Value = y ( i ) r3 = r3 + 1 End If End If Next Next End Sub 
拡張子 aux という 補助 ファイル を 削除 し て 、 再度 処理 を し て み て ください 。 
スポン ボタン の TabStop を False に すれ ば フォーカス 移動 の 対象 から 外れ ます 。 マウス で の 操作 は 出来 ます 。 
がぞう あり 。 。 。 。 。 
> “ 山田太郎 ” を ” 山 ○ 太 ○ ” に 変換 し たい だけ で 良けれ ば 、 雰囲気 標準 モジュール に 以下 を 記述 すれ ば ･･･ Public Function Samp 1 ( vSrc As Variant ) As String     Static sS As String     Dim i As Long     Const CL As Long = 4     If ( Not IsNull ( vSrc )) Then sS = vSrc     If ( Len ( sS ) < CL ) Then        sS = sS & String ( CL - Len ( sS ), " み ")     End If     For i = 2 To Len ( sS ) Step 2        Mid ( sS , i , 1 ) = "○"     Next     Samp 1 = sS End Function Public Sub test ()     Debug . Print Samp 1 (" 山田太郎 ")     Debug . Print Samp 1 ( Null )     Debug . Print Samp 1 (" 田 太郎 ")     Debug . Print Samp 1 ( Null )     Debug . Print Samp 1 (" 太郎 ") End Sub クエリ から は SELECT 氏名 , Samp 1 ( 氏名 ) AS 変換 後 FROM テーブル ; で 表示 できる と 思い ます > 顧客情報 管理 の 関係 で なら 、 部分的 に 変更 する だけ で 良い の か わかり ませ ん が ･･･ 上記 で は 、 余計 な 処理 として Null なら 直前 で 処理 し た もの を 使っ て 、 ４ 文字 未満 なら " み " を 追加 し て 最低 ４ 文字 に し て から ･･･ > 文字列 で なく 数値 データ で ある 場合 何 が 望む 形 か わかり ませ ん が 、 数値 を 文字列 に し て 、 必要 桁 数 に なる よう に 、 左側に " 0 " とか 付加 し て For i = Len ( sS ) To 1 Step - 2 とか で 処理 すれ ば ･･･??? 
疑問 ０ に なる まで 集計 する ので が 目的 です か なぜ わざわざ シート で 計算 する の です か ？ コード で ０ に なる まで マクロ 上 で 計算 し て その 時 の 行 を Ｎｏ を 出す とか では ダメ な の です か ？ 
範囲 の 中 で カウント し た もの から 、 空白 セル の 個数 と 特定 の 文字 が 含ま れ て いる セル の 個数 を 引け ば いい 。 
名前 で 指定 する 時 は ActiveSheet .S hapes (” 図 １ ” ). Select と なり ます が 、 インデックス 番号 で 選択 する なら 、 ActiveSheet .S hapes ( 1 ). Select という やりかた でしょ う か 。 ただし 、 この 方法 は 、 図形 を 削除 し たり 追加 し たり する と 番号 が ずれ ます から 名前 で 指定 する 方法 を お勧め し ます 。 
シート を 対象 と する 場合 は Worksheet . ExportAsFixedFormat メソッド を 使い ます 。 https :// msdn . microsoft . com / ja - jp / library / microsoft . office . tools . exc ... ブック を 対象 と する 場合 は Workbook . ExportAsFixedFormat メソッド を 使い ます 。 https :// msdn . microsoft . com / ja - jp / library / office / ff 198122 . aspx 
下記 の コード でいか が でしょ う か 。 レイアウト の 微 調整 は 適宜 修正 を お願い し ます 。 Option Explicit Dim cMax As Long Private Sub UserForm _ Initialize () Dim c As Long cMax = Cells ( 1 , Columns . Count ). End ( xlToLeft ). Column ' 開始 コンボボックス の 初期 設定 ComboBox 1 . Clear For c = 1 To cMax ComboBox 1 . AddItem Cells ( 1 , c ). Value Next c End Sub Private Sub ComboBox 1 _ Change () Dim c As Long ' 終了 コンボボックス の 初期 設定 ComboBox 2 . Clear If ComboBox 1 . ListIndex = - 1 Then Exit Sub For c = ComboBox 1 . ListIndex + 1 To cMax ComboBox 2 . AddItem Cells ( 1 , c ). Value Next c End Sub Private Sub ComboBox 2 _ Change () If ComboBox 2 . ListIndex = - 1 Then Exit Sub ' 既存 の グラフ を 一旦 削除 する Dim ct As Object For Each ct In Worksheets ( 1 ). ChartObjects ct . Delete Next ' グラフ を 挿入 する Dim c1 As Long , c 2 As Long c1 = ComboBox 1 . ListIndex + 1 c 2 = ComboBox 1 . ListIndex + ComboBox 2 . ListIndex + 1 ActiveSheet .S hapes . AddChart 2 ( 297 , xlColumnStacked ). Select With ActiveChart .S etSourceData Source := Range ( Cells ( 1 , c1 ), Cells ( 5 , c 2 )) ' 横 軸 の 調整 を 行う . FullSeriesCollection ( 1 ). Delete . FullSeriesCollection ( 1 ). XValues = "= Sheet 1 !" & Range ( Cells ( 1 , c1 ), Cells ( 1 , c 2 )). Address ' 行 の 上下関係 と 積み上げ 順 が 一致 する よう に データ 系列 を 調整 する Dim i As Integer For i = 1 To 4 . FullSeriesCollection ( i ). Name = "="" データ " & 5 - i & """" . FullSeriesCollection ( i ). Values = " Sheet 1 !" & Range ( Cells ( 6 - i , c1 ), Cells ( 6 - i , c 2 )). Address Next i ' 凡例 の 位置 を 調整 する . HasLegend = True . Legend . Position = xl Corner . Legend . IncludeInLayout = False ' グラフ タイトル を 設定 する . ChartTitle . Text = Me . Caption ' グラフ の 位置 を 調整 する ActiveSheet .S hapes ( 1 ). Left = Cells ( 7 , c1 ). Left ActiveSheet .S hapes ( 1 ). Top = Cells ( 7 , c1 ). Top End With Range ( Cells ( 1 , c1 ), Cells ( 5 , c 2 )). Select End Sub 
C3 セル に 半角 小文字 の a が 含ま れ て いる とき に 3 行 目 の 背景色 を 赤 に する 例 です 。 If Range (" C3 "). Value Like "* a *" Then Rows ( 3 ). Interior . Color = RGB ( 255 , 0 , 0 ) End If 文字 色 を 変更 する 場合 は 「 Interior . Color 」 を 「 Font . Color 」 に し ます 。 
B 列 の ユニーク な データ を Z 列 に 出 そう と し て いる . AdvancedFilter Action := xlFilterCopy , _ CopyToRange := Sh . Range (" Z 1 "), Unique := True は With Sh . Range (" B 1 ", Sh . Cells ( Rows . Count , 4 ). End ( xlUp )) の 範囲 な ので 、 B 列 の ユニーク データ で は なく 、 B 1 から D 列 最終 行 まで の ユニーク な 組み合わせ に なっ て い ます 。 なので . AdvancedFilter Action := xlFilterCopy , _ CopyToRange := Sh . Range (" Z 1 "), Unique := True を Sh . Range (" B 1 ", Sh . Cells ( Rows . Count , 2 ). End ( xlUp )). AdvancedFilter Action := xlFilterCopy , _ CopyToRange := Sh . Range (" Z 1 "), Unique := True で 試し て み て ください 。 また 、 Sh . Cells ( Rows . Count , 4 ). End ( xlUp ) で は 、 D 列 の 最終 行 に なる ので 、 D 列 に データ が 無い 場合 に は 、 B 列 に データ が あっ て も 対象外 に なり ます 。 な ので 、 必ず D 列 も データ が ある 場合 は 別 です が 、 With Sh . Range (" B 1 ", Sh . Cells ( Rows . Count , 4 ). End ( xlUp )) では なく 、 With Sh . Range (" B 1 ", " D " & Sh . Cells ( Rows . Count , 2 ). End ( xlUp ). Row ) など の 方 が いい かも しれ ませ ん 。 こう し て いる と 、 lastRow = sh . Range (" B " & Rows . Count ). End ( xlUp ). Row ' B 列 最終 行 として B 列 最終 行 を 変数 に 持つ 方 が プログラム が 見え やすく なる かも しれ ませ ん 。 それと 別 解 です が 、 Dictionary オブジェクト を 使っ て B 列 で ユニーク に 印刷 する 例 です 。 Sub フィルタ 印刷 () Dim dic As Object Dim sh As Worksheet Dim lastRow As Long Dim r As Long Dim kwd As String ' Set dic = CreateObject (" Scripting . Dictionary ") Set sh = Worksheets (" Sheet 1 ") If sh . FilterMode Then sh . Range (" A1 "). AutoFilter lastRow = sh . Range (" B " & Rows . Count ). End ( xlUp ). Row ' B 列 最終 行 For r = 2 To lastRow kwd = sh . Range (" B " & r ). Value ' B 列 の データ If Not di c.e xists ( kwd ) Then ' B 列 の データ が 辞書 に 無けれ ば dic . Add kwd , "" ' 辞書 に 登録 sh . Range (" B 1 : B " & lastRow ). AutoFilter Field := 1 , Criteria 1 := kwd sh . PrintOut Preview := True End If Next If sh . FilterMode Then sh . Range (" A1 "). AutoFilter MsgBox " 印刷 完了 ", vbInformation Set sh = Nothing End Sub 
Sub 一 例 です () Dim i As Long , rng As Range With Worksheets (" Sheet 2 ") i = - 2 For Each rng In . Range (" A1 ", . Cells ( Rows . Count , 1 ). End ( xlUp )) i = i + 4 rng . Copy Worksheets (" Sheet 1 "). Cells ( i , 1 ). Resize ( 4 ) Next rng End With End Sub 
VB.NET の 正規表現 で 判断 し たら どうでしょう か ？ 参考 サイト http:// dobon .net / vb / dotnet / string / regex . html # sect io n3 If System . Text . RegularExpressions . Regex . IsMatch ( _ TextBox 1 . Text , "\ d \ d \ d \ d /\ d \ d /\ d \ d ") Then Console . Write Line (" 日 付け が 含ま れ て い ます ") End If 
同じ 入れ物 に 最大 で ２ ５ 個 入れ られる って 事 です か ね 。 また 、 ２ ５ 個 に なら ない もの は 、 ２ ５ まで に し て グループ を 作る んで か ？ 
プルダウン という の は 入力 規則 の 事 です ね 。 この 前 と 同じ 方法 で でき ます 。 シート の 名前 が 「 山田 」 や 「 渡辺 」 に なっ て いる の です ね 。 選択 する セル を A1 と し ます 。 違う セル なら 、 下記 コード の If Target . Address <> "$ A $1 " ここ を 変更 する だけ です 。 前回 で お わかり と 思い ます が $ の 位置 に 気 を つけ て 下さい 。 $ A1 $ に し ない よう に 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) On Error GoTo Err If Target . Count > 1 Then Exit Sub If Target . Address <> "$ A $1 " Or Target . Value = "" Then Exit Sub Worksheets ( Target . Value ). Select Exit Sub Err : MsgBox " シート が ありません " End Sub 
そこ に は ＞ 彼 を 呼び出す に は Office 2003 が 必要 です ( カイル 君 が 搭載 さ れ て いる 過去 の バージョン で あれ ば 2003 以外 でも 大丈夫 だ と 思い ます が 、 私 の 方 で は 試し て い ませ ん )。 もっと 言う なら ば 、 彼 の 実体 で ある 「 DOLPHIN . ACS 」 ファイル が 必要 と なり ます 。 と 書か れ て い ます ・ ・ ・ 
下記 の コード でいか が でしょ う か ？ ワーク シート 関数 の Match を 使え ば シンプル に なり ます 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st 2 As Worksheet Dim r1 As Long , r2 As Variant Set st 1 = Workbooks (" ファイル ①. xlsm "). Worksheets (" シート A ") Set st 2 = Workbooks (" ファイル ②. xlsx "). Worksheets (" シート B ") r1 = 10 ' シート A の A10 から 3 行 おき に 空欄 に なる まで 繰り返す While st 1 . Range (" A " & r1 ). Value <> "" ' シート B の A 列 に 一致 する 値 が ある か 検索 する r2 = Application . Match ( st 1 . Range (" A " & r1 ). Value , st 2 . Columns (" A "), 0 ) If VarType ( r2 ) <> vbError Then ' 一致 した値 が あっ たら その ２ 行 下 に AK 列 の 値 を 転記 する st 2 . Range (" E " & r2 + 2 ). Value = st 1 . Range (" AK " & r1 + 2 ). Value End If r1 = r1 + 3 Wend End Sub 
「 href ="/ logout "」 と なっ て いる の です から 、 myIE . Navigate " ドメイン名 / logout " と すれ ば 良い の で は ない でしょ う か 。 
過去 に 一 度 ハマっ た こと が あり ます が 、 確か Excel 経由 だ と 回避 でき なかっ た よ 記憶 が ・ ・ ・ パスワード を 事前 に 解除 し た うえ で 作業 を 実行 する という 方向 で 諦める ほう が 良い か と 思い ます 。 という か そういう 手順 書 で 他 の 方 に も 利用 し て 頂い て い まし た 。 
Workbooks . Open ThisWorkbook . Path & "￥ D " & f . Cells ( i , 5 ) 上記 だ と 、 フォルダ Ｄ に ある 「 知恵袋 . xls 」 を 開こ う として も Workbooks . Open ThisWorkbook . Path & "￥ D \ 知恵袋 . xls " と は なら ず Workbooks . Open ThisWorkbook . Path & "￥ D 知恵袋 . xls " と なり ませ ん か ？ 「 Ｄ フォルダ 」 内 に ある 「 知恵袋 . xls 」 で は なく 「 Ｄ 知恵袋 . xls 」 という ファイル を 開こ う と する と 思い ます 。 f . Cells ( i , 5 ) の セル に は ファイル 名称 は どの よう に なっ て 書き込ま れ て ます か ？ 
下記 の コード でいか が でしょ う か 。 Option Explicit Private Sub ComboBox 1 _ Change () Dim c As Variant , r As Long If ComboBox 1 . ListIndex = - 1 Then Exit Sub With ComboBox 2 . Clear c = Application . Match ( ComboBox 1 . Text , Rows ( 1 ), 0 ) If IsNumeric ( c ) Then For r = 2 To Cells ( Rows . Count , c ). End ( xlUp ). Row . AddItem Cells ( r , c ). Value Next End If End With End Sub Private Sub UserForm _ Initialize () Dim rng As Range For Each rng In Range (" D1 : S1 "). Cells ComboBox 1 . AddItem rng . Value Next End Sub 
アクティブ な ブック の シート を 新規 ブック に 振り分ける プログラム 例 です 。 Sub sample () Dim xDic , sh As Worksheet , xName As String Set xDic = CreateObject (" Scripting . Dictionary ") For Each sh In ActiveWorkbook . Worksheets xName = Split ( sh . Name , "-")( 0 ) If Not xDic . Exists ( xName ) Then sh . Copy xDic . Add xName , ActiveWorkbook . Name Else With Workbooks ( xDic . Item ( xName )). Worksheets sh . Copy after :=. Item (. Count ) End With End If Next sh End Sub 
こんな 感じ で OK か と 。 ・ ・・・・・・・・・・・・・・・・ Private Sub CommandButton 1 _ Click () Worksheets (" 管理 表 "). Select Range (" A3 "). Value = TextBox 1 . Text End Sub 
データー の 表 の 作り方 が まずい の で は 普通 は シート １ ： 元 データ A 列 B 列 C 列 D 列 日付 ---- 会社 名 ― 顧客 №― 数量 2016 / 5 - ー A 社 2016 / 5 --- B 社 2016 / 6 -- A 社 こう し て おけ ば 顧客 Ｎo で フィルター を 掛けれ ば 各月 の データー が 出 ます が ? あるいは 詳細 設定 で 検索 条件 範囲 を 設定 すれ ば 期間 設定 も でき ます が ? 只 元 データー と 支払 額 請求 金額 と の 関連 が わかり ませ ん が 
> アプリ っぽく 見せる 為 どういう 狙い な の か 今一つ 解り ませ ん が 、 アドインプログラム として マクロ 開発 する と 、 良い の かも しれ ませ ん 。 
漢字 の 文字コード に は シフトJIS 、 Unicode 、 UTF-8 と いろいろ な 種類 が あり 、 どの 文字コード を 使う か は プログラム で 指定 でき ます 。 プログラム を どんな 開発 環境 で 作っ て いる の か わかり ませ ん が 、 開発 環境 で サポート し て いる 文字コード が 異なる ので ご 注意 ください 。 Excel なら シフトJIS は 問題 なく 使え ます し 、 Visual Basci で あれ ば 文字コード 変換 の クラス ・ メソッド が 用意 さ れ て いる ので 、 これ も 問題 あり ませ ん 。 
=( 数式 = FALSE ) って 普通 は = not ( 数式 ) って 書き ます 。 私 も 似 た よう な ユーザー 定義 関数 を 使っ て ます が 、 ちゃんと 動作 し ます よ 。 違い は 、 Application . Volatile を 宣言 し て 確実 に 再 計算 し て いる ところ と 、 返り 値 を 文字列 に し て ない ところ か な 。 空文字列 が 返っ て き たら isblank は FALSE に 決まっ て ます から ね 。 
マクロ で なく 、 関数 で 実現 でき ませ ん か ？ B 列 ： 顧客 ID を 入力 する C 列 ： 顧客情報 が 出力 さ れる D 列 ： 顧客 ID 群 E 列 ： 顧客情報 群 として 、 C 列 に = IF ( B 1 ="", "", VLOOKUP ( B 1 , D : E , 2 , FALSE )) と 入力 すれ ば でき そう に 思え ます 。 
下記 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st 2 As Worksheet Dim r1 As Long , r2 As Long Dim rng As Range Set st 1 = Worksheets (" Sheet 1 ") Set st 2 = Worksheets (" Finish ") ' Sheet 1 の 3 行 目 から 最終 行 まで を 処理 する For r1 = 3 To st 1 . Range (" B " & Rows . Count ). End ( xlUp ). Row ' A 列 に 1 が 入っ て いる か 判定 する If st 1 . Range (" A " & r1 ). Value = " 1 " Then ' Finish シート へ の 貼り 付け 位置 を 取得 する r2 = st 2 . Range (" A " & Rows . Count ). End ( xlUp ). Offset ( 1 ). Row ' Finish シート へ 貼り 付ける st 1 . Range (" A " & r1 ). Resize (, 4 ). Copy st 2 . Range (" A " & r2 ) ' Union を 使っ て 削除 する 行 を 記録 し て おく If rng Is Nothing Then Set rng = st 1 . Rows ( r1 ) Else Set rng = Union ( rng , st 1 . Rows ( r1 )) End If End If Next r1 ' 削除対象 行 が あれ ば 削除 する If Not rng Is Nothing Then rng . Delete End If End Sub 
DataTable を シリアライズ し て 送る とか http:// dobon .net / vb / dotnet / file / xmlserializer . html 
Range (" B2 "). Value = Range (" A1 "). Value & vbLf & Range (" A 2 "). Value これ で どう です か 。 
業務用 とか PA とか の パワー アンプ に 直結 する よう な かたち で も 出 ます よ 。 楽器 を PA 機材 なり に 直接 つない で 演奏 って の は よく ある こと だ と 思い ます 。 って も 、 特定 の 機材 （ 特に ギターアンプ ） の 音色 を 大事 に し ない 場合 か と は 思い ます が ； 「 ギター 用 」 と 考え られる 物 は やはり ギター 用 機材 メーカー が 出し てる 製品 でしょ う が 、 やはり 「 ギター 用 」 な んで 業務用 や PA 用 に 比べれ ば W 数 も 小さい 物 で （ ５ ０ ～ １ ０ ０ W くらい ） 、 キャビネット 部 の 耐圧 より 小さい 物 で 選ん で いく こと に なり ます 。 業務用 とか でも その 選び方 なら 安全 と は いえ ます が 、 問題 は 業務用 機器 で は 「 オーディオ 」 です ので 、 一般 的 な 楽器 に 使わ れる フォーンプラグ で の 接続 に 対応 し て い ない 物 が 多い です 。 自作 ケーブル など で 対応 し たり という こと に なる でしょ う 。 あと ギター 用 なら 真空管 使用 の 製品 が 多く なり ます （ トランジスタ も 多い です けど ） 。 また 「 EQ 」 と いう ほど で も ない です が 、 超 低 域 と 超 高 域 を 調整 できる よう に なっ て たり 、 という もの が 付い て たり する 物 も あり ます 。 要するに 「 ギター 用 」 は 、 ギター サウンド の ため の どこ か こだわり の 部分 が 調整 でき たり 、 その ため の 部品 を 使っ て たり 、 「 楽器 」 として の 仕様 に 作ら れ て いる わけ です 。 ギター 用 で なく て も 極度 に G T-10 の 音色 を 阻害 する 、 という こと は 無い と 思い ます 。 もし 業務用 など を つかわ れる の で あれ ば 、 以上 の 点 を 充分 吟味 し た うえ で 使用 さ れる こと を 勧め ます 。 
> 他 の 方 の 質問 を 見 て い て 、 > 的確 な 説明 を し て い らし た ので … それ って 私 ( glowfiltan ) の こと です か ？ そもそも 私 は JavaScript や ActionScript 系 が 専門 で VBS など VB 系 の 質問 に は 答え られ ない こと が 多い ですよ。 ( 他 の 方 の 回答 が 素早く 的確 な こと が 多い ため 私 の 出る 幕 など ナシ 。) ( そもそも が 遅筆 で ある ため ， 人口 が 多い VB 系 で は 回答 でき ない 。 ) 今回 の ご 質問 に 近い ご 質問 と 言う と ， この ご 質問 ↓ など でしょ う か ？ ？ 「 二つ の フォルダ 内 ファイル を 比較 し て 、 不一致 の ファイル 名 ...」 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q10 16105250 ... 良く わかり ませ ん が ， 「 C :\ Data 」 という フォルダ の 直下 ( 直下 のみ ) に 色々 な 拡張 子 の ファイル が あっ た として その 中 の 「 ～～. jpg 」 または 「～～. JPG 」 を 「 ～～. tif 」 という ファイル 名 に 変更 する コード 例 です ↓ 。 ' - - - - - - - - - - - ------------------------- ' ファイルシステム オブジェクト を 作成 Set FSObj = CreateObject (" Scripting . FileSystemObject ") ' C :\ Data フォルダ オブジェクト を 取得 Set FldObj = FSObj . GetFolder (" C :\ Data ") ' フォルダ オブジェクト の Files から File 名 を 取得 For Each FilObj In FldObj . Files      ' File 名 を 一時 保存      FN = FilObj . Name      ' File 名 の 後 4 文字 を 小文字 に し た 文字列 が 「 .jpg 」 で あれ ば      If LCase ( Right ( FN , 4 )) = ". jpg " Then          ' File 名 の 拡張子 を 「 . tif 」 に 変更          FilObj . Name = Left ( FN , Len ( FN )- 4 ) & ". tif "      End If Next ' 各 オブジェクト の 解放 Set FldObj = Nothing Set FSObj = Nothing ' - - - - - - - - - - - ------------------------- なお ， わかっ て いらっしゃる と 思い ます が ， ， ， 上 の コード は あくまでも 「 拡張子 を 変更 する だけ ！ 」 の コード です よ 。 つまり ， 「 .jpg 」 形式 の データファイル を 「 . tif 」 形式 の データファイル に 変更 する わけ で は あり ませ ん 。 たま に ， 「 拡張子 を 変更 すれ ば ， ファイル 形式 も 変更 さ れる 。 」 と 思っ て いらっしゃる 方 も 見かける ( 私 の 職場 の 課内 に ２ 人 も い た ！) ので ， 念 の ため の 確認 です 。 ※ なお     私 の 職場 の 同 課 に は     Excel 2007 で 作成 し た 「 . xlsx 」 ファイル の 拡張子 を     エクスプローラ で 「 . xls 」 に 変える だけ で     Excel 2003 完全 対応 の ファイル に なる     と 思っ て い た 人が ２ 人 も い まし た ( 愕然 ...)。 データ形式 を TIFF に 変換 する の でし たら 例えば Photoshop など の 画像処理 ソフト を 使っ て 「 バッチ処理 」 など で ファイル 形式 変換 を し た 方 が 良い と 思い ます 。 
空 の 文字列 を Split で 処理 しよ う と し た ため に エラー と なっ て い ます 。 つまり 、 TITLE タグ を 持っ て い ない か 、 表示 完了 に なら ない うち に TITLE タグ を 取り に いっ た という こと に なり ます 。 全て の ページ に 確実 に TITLE タグ が ある の なら ば 、 表示 終了 処理 が 不十分 だっ た という こと でしょ う 。 適当 な 時間 、 ウエイト 処理 を 追加 し て ください 。 
まず おっしゃる 通り 、 起動 スピード が 落ちる 可能性 が 有り ます 。 最も 困る の は 、 他 の 端末 に 持っ て 行っ た とき に 選ん だ ライブラリ が 無い 、 ヴァージョン が 違う など が 有っ た 時 、 エラー が 出る まで 時間 が かかる し 、 出て も 利用者 は 対処 でき ない 。 と 言う 本末転倒 な 問題 が 有る から です 。 ちなみに 「 初期 設定 で すべて 参照 可能 に し て 」 あり ます よ ？ EXCEL が 入っ て いれ ば 必ず 利用 できる 環境 に は チェック 入っ てる でしょ 、 
シート の 様式 が わかり ませ ん ので 、 とりあえず 、 A1 に ハイパーリンク 設定 さ れ て いる 先 ( URL ) を B 1 に 書き出す 記述 です 。 Sub Test () Range (" B 1 "). Value = Range (" A1 "). Hyperlinks ( 1 ). Address End Sub 
こんにちは。 set v 1 = nothing set v 1 = . Document . all . tags (" input "). Item ( 5 ) if v 1 is nothing then else ここ で クリック end if という こと です 
過去 QA で は 解決 し ませ ん でし た か 教え て 下さい 。 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1116102810 ... 以下 の 記述 で は 、 K シート ： Sheet 2 m シート ： Sheet 1 と し て い ます 新規 ファイル の 標準 モジュール に 以下 全部 記述 し 、 Sheet 1 / Sheet 2 が ある こと を 確認 の 後 testData で データ を 作り Samp 5 を 実行 し て み ます ※ 変更 部分 は 、 さほど ありません Public Sub Samp 5 ()     Dim rng As Range , rf As Range , r As Range     Dim iC As Long , i As Long     Const CCR As Long = 36     Const CKRNGS As String = " H1 , Y1 , J 1 , R1 , S1 , T 1 , U 1 "     Const CMRNGS As String = " E 1 , F1 , G1 , H1 , I 1 , K 1 , L 1 "     Set rng = Worksheets (" Sheet 2 "). Columns (" B ") ' K シート ★     Set r = Worksheets (" Sheet 1 "). Range (" A3 ") ' m シート ★     Application .S creenUpdating = False     While ( r . Value <> "")        With rng           Set rf = . Find ( r . Value , . Cells ( 5 ), LookAt := xlWhole )           If ( rf Is Nothing ) Then Set rf = . Cells ( 5 )        End With        With r . Offset (, 1 - r . Column )           iC = xlNone           If ( rf . Row < 6 ) Then              If (. Range (" E 1 "). Value <> "") Then iC = CCR           Else              Set rf = rf . Offset (, 1 - rf . Column ). Range ( CKRNGS )              With . Range ( CMRNGS )                 For i = 1 To rf . Areas . Count                    rf . Areas ( i ). Value = . Areas ( i ). Value                 Next              End With           End If           . Interior . Color Index = iC        End With        Set r = r . Offset ( 1 )     Wend     Application .S creenUpdating = True End Sub ' 確認 用 簡易 データ 作成 Public Sub testData ()     Dim r As Range     Const CRH As Long = 35     Randomize     Application .S creenUpdating = False     Worksheets (" Sheet 1 "). Cells . Delete     With Worksheets (" Sheet 2 ")        . Cells . Delete        For Each r In . Range (" B 1 "). Resize ( CRH )           If ( Rnd () < 0 . 75 ) Then              r . Value = r . Row           End If        Next        . Columns (" B "). Copy Worksheets (" Sheet 1 "). Columns (" B ")     End With     With Worksheets (" Sheet 1 ")        For Each r In . Range (" A1 : Z 1 "). Resize ( CRH )           Select Case r . Column              Case . Range (" A1 "). Column                 r . Value = r . Row              Case . Range (" B 1 "). Column              Case Else                 r . Value = r . Address ( False , False )           End Select        Next        . Columns . AutoFit        Worksheets (" Sheet 2 "). Cells . ColumnWidth = _           . Cells ( 3 ). ColumnWidth     End With     Application .S creenUpdating = True End Sub 
Rows ("〇：" & Range (" A1 "). Value ). Hidden = True これ で いかが です か 。 
こんにちは。 ' 検索 語 入力 SearchKey = Me . TextNumber . value という こと です 。 
一 例 です 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st 2 As Worksheet Dim r1 As Long Set st 1 = Worksheets (" Sheet 1 ") Set st 2 = Worksheets (" Sheet 2 ") For r1 = 1 To st 1 . Range (" A " & Rows . Count ). End ( xlUp ). Row With st 1 . Range (" A " & r1 ) If VarType ( Application . Match (. Value , st 2 . Columns (" A "), 0 )) = vbError Then st 2 . Range (" A " & st 2 . Range (" A " & st 2 . Rows . Count ). End ( xlUp ). Offset ( 1 ). Row ). Value = _ . Value End If End With Next End Sub 
クライアント ・ サーバー 通信 で は 、 サーバー は クライアント の 接続 が ある まで 待機 し ます 。 その ため に 、 TcpListener という クラス が 用意 さ れ て い ます 。 Dim server = New TcpListener ( new IPEndPoint ( IPAddress . Parse (" 0 . 0 . 0 . 0 "), 1001 )) server .S tart () Dim client = server . AcceptTcpClient () server .S top () ' ストリーム を 取得 AcceptTcpClient () は 、 受信 する まで 待機 し 続ける こと に 注意 し て ください 。 
リソース は どの よう な 手順 で プロジェクト に 追加 し た の でしょ う か ？ VB . Net の プロジェクト に リソース を 追加 する 方法 は 幾 通り か あっ て 、 その 方法 によって リソース の 取り出し 方 に 差異 が あり ます 。 
A 列 を 最終 行 まで 検索 し て 、 該当 する シート 名 の シート の B 1 に ○ を 入れる コード です 。 Option Explicit Sub Sample () Dim r1 As Long Dim st As Worksheet For r1 = 1 To Worksheets (" Sheet 1 "). Range (" A " & Worksheets (" Sheet 1 "). Rows . Count ). End ( xlUp ). Row For Each st In Worksheets If st . Name = Worksheets (" Sheet 1 "). Range (" A " & r1 ). Value Then st . Range (" B 1 "). Value = "○" End If Next st Next r1 End Sub 
Sub 一 例 です () Dim xFld 0 As String , rng As Range , xAdr As String Const cFld 1 As String = "\ 書類 格納 フォルダ \@ 1 \@ 2 \@ 3 . pdf " xFld 0 = CreateObject (" WScript .S hell "). SpecialFolders (" Desktop ") & cFld 1 For Each rng In Range (" B2 : F6 ") With rng If . Value <> "" Then xAdr = Replace ( Replace ( xFld 0 , "@ 1 ", Cells (. Row , 1 ). Value ), "@ 2 ", Cells ( 1 , . Column ). Value ) xAdr = Replace ( xAdr , "@ 3 ", . Value ) . Parent . Hyperlinks . Add Anchor :=. Cells , Address := xAdr , TextToDisplay :=. Value End If End With Next rng End Sub 
Sheet 2 に フォーム を 作る の は 理由 が ある の でしょ う か 。 不 必要 です 。 下記 紹介 し ます が 、 フォーム は ブック どこ から でも 呼び出せる もの で 単 シート 上 限定 で は あり ませ ん 。 画像 参照 で 、 フォーム を 作成 し ます 。 Alt + F1 1 など で 開く VB エディター の 左 に ある と 思わ れる ブック や シート リスト 上 で 右クリック し 、 挿入 、 ユーザー フォーム と し ます 。 ラベル で 文字 を 追加 、 ほか 、 アルファベット で 書い てる 通り textbox ２つ と combobox と Command Button 2つ を 追加 し 、 Command Button 1 の caption を 「 個体 」 、 同じく 2 を 「 OK 」 と し まし た 。 「 プロジェクト ～」 の 下 に ある 小さな ボタン で フォーム の 「 コード を 表示 」 し て 下記 コード を コピペ 。 Dim r As Long ' 変数 宣言 。 ここ に 書く こと で フォーム が 開い て いれ ば 値 を 渡せる Private Sub CommandButton 1 _ Click ()' 個体 番号 検索 ボタン If Not IsError ( Application . WorksheetFunction . Match ( TextBox 1 . Value , Range (" A : A "), 0 )) Then ' マッチ 関数 で ヒット し ない と エラー を 起こす ので 点検 r = Application . WorksheetFunction . Match ( TextBox 1 . Value , Range (" A : A "), 0 )' マッチ し た 時行 番号 r を 格納 TextBox 1 . Value = Cells ( r , 1 ). Value ComboBox 1 . Value = Cells ( r , 2 ). Value TextBox 2 . Value = Cells ( r , 3 ). Value End If End Sub Private Sub Command Bu t to n2 _ Click ()' シート に 写す ボタン Cells ( r , 1 ). Value = TextBox 1 . Value Cells ( r , 2 ). Value = ComboBox 1 . Value Cells ( r , 3 ). Value = TextBox 2 . Value ' やろう と 思え ば 日付 として 有効 な 値 か チェック も できる が し て い ない End Sub Private Sub UserForm _ Initialize () ' 初期 設定 ComboBox 1 . AddItem " 飼育 中 " ComboBox 1 . AddItem " 出荷 済 " End Sub あと は フォーム 表示 の コード です が 、 簡単 な ところ だ と ダブルクリック イベント と か 。 Sheet 1 の モジュール に Private Sub Worksheet _ BeforeDoubleClick ( ByVal target As Range , Cancel As Boolean ) Cancel = True ' セル の 編集 に 入ら ない UserForm 1 .S how End Sub とか です 。 あと フォーム 作成 画面 の フォーム 上 で 右クリック する と タブ オーダー を 開け ます ので 、 順番 を 並べ 替える と 、 tab や 状態 によって は Enter で フォーカス ( 入力 の カーソル など ) が 移る 順番 を 替え られ ます ので 試し て み て ください 。 ざーっと 作り ながら 書い て み まし た が いかが でしょ う か ？ 
レポート の レコード 出力 順序 は 何で 決定 し て い ます か ？ レポート の 機能 「 並べ替え / グループ 化 」 を 利用 し ない と 想定外 の 順序 で 出 て くる 場合 が あり ます 。 
以下 の コード でいか が でしょ う か 。 シート 名 は 適宜 変更 し て 下さい 。 Option Explicit Sub Sample () Dim stA As Worksheet , stB As Worksheet Dim rA As Long , rB As Long Set stA = Worksheets (" A シート ") Set stB = Worksheets (" B シート ") For rA = 1 To stA . Range (" A " & stA . Rows . Count ). End ( xlUp ). Row rB = 0 On Error Resume Next rB = WorksheetFunction . Match ( stA . Range (" A " & rA ), stB . Columns (" A "), False ) On Error GoTo 0 If rB <> 0 Then stB . Cells ( rB , stB . Columns . Count ). End ( xlToLeft ). Offset (, 1 ). Value = stA . Range (" B " & rA ). Value End If Next End Sub 
１ ～ ９ ９ ９ に する のに 何 か の 変数 に １ を 足し 続け て いる はず です 。 その 時 ９ ９ ９ を チェック すれ ば いい ん だ から 、 もし その 変数 が intNO と 言う 変数 で あれ ば If intNO = 999 Then intNO = 1 Else intNO = intNO + 1 End If みたい な 感じ の 処理 に 書き換えれ ば 良い わけ です 。 
外し て いる かも しれ ませ ん が 、 エクセル の オプション 「 詳細 設定 」 の 「 桁 区切り 記号 」 が ドット に なっ て い ませ ん か ？ 
期待 さ れ た 動作 に なっ て いる か 分かり ませ ん が 。 。 。 Private Sub Worksheet _ Change ( ByVal target As Range ) Dim N As Long N = target . Row If Inter sect ( target , Sheets (" 伝票 "). Range (" D " & N )) Is Nothing Then Exit Sub Else Range (" F " & N ) = Range (" P " & N ) Range (" F " & N + 1 ) = Range (" Q " & N ) Range (" F " & N + 2 ) = Range (" R " & N ) End If End Sub > Range (" F " & N ) = Range (" P " & N ) > Range (" F " & N + 1 ) = Range (" Q " & N ) > Range (" F " & N + 2 ) = Range (" R " & N ) 質問者 さん の 場合 は 上記 の コード で セル の 値 を 変更 し て いる ため 、 イベントハンドラ 内 で イベント を 発生 さ せる コード に なっ て い ます 。 その よう な コード は 動作 が 複雑 に なる うえ に 、 指定 セル の 値 を 誤っ て 変更 し た だけ でも 動作 し て しまい 、 作業 に 混乱 を 招き やすい です 。 です ので 、 ボタン クリック など で コード を 実行 する よう な デザイン に し た 方 が 良い と 思い ます 。 
シート が 10 ある として 11 目 の シート を 用意 し て その シート に 検索 し たい データ が 含ま れる 行 を 表示 する よう に すれ ば よい でしょ う 。 それで よけれ ば 回答 し ます が ？ 
元 ファイル を 開き 、 C3 セル の 日付 を 追加 し た 名前 で 保存 終了 し 、 保存 先 に ファイル が ある こと を 確認 し 、 元 ファイル を 削除 し ます 。 削除 は 少々 危険 な ので コメントアウト し て ます 。 やる なら 自己責任 で どうぞ 。 コーディング ミス も 含め 当方 は 一切 責任 を 取り ませ ん 。 Sub Sample () File 1 = " C :\ Work \ Sample . xls " Folder 2 = " C :\ Work \ 保存 分 \" Workbooks . open filename := File 1 F il e2 = left ( activeworkbook . name , len ( activeworkbook . name )- 4 ) & Range (" C3 "). Value & ". xls " Activeworkbook .s aveas filename := Folder 2 & F il e2 Application . displayalart = False workbooks ( F il e2 ). close savechanges := False Application . displayalart = true ' Buf = Dir ( Folder 2 & F il e2 ) ' If Buf <>"" then ' Kill File 1 ' End if End Sub 
こんにちは。 for で 取得 する 順番 が 必ず 、 規則 性 の ある 順番 に なっ て いる 、 という 前提 が ない と 、 この コード は 、 正しく 動作 し ませ ん 。 If Left ( Obj . Name , Len ( myTarget )) = myTarget Then は if instr ( 1 , Obj . name , " Control " ) <> 0 then i = Val ( mid ( Obj . Name , 9 , 3 )) Cells ( i , 1 ) = Obj . Object . Value End If に し て 、 どんな コントロール で も 、 Control で 始まる もの だっ たら 、 転記 する 、 という 構造 に し て 、 処理 し て み て ください 
号 室 という 文字 の あと に スペース が 1 個 という 規則 が 前提 です 。 エラー 処理 は 入れ て い ませ ん 。 必要 で あれ ば 返信 し て 下さい 。 A 列 の 文字列 を 置き換え ます 。 Sub Sample () Dim i As Long Dim tmp As String For i = 1 To Cells ( Rows . Count , " A "). End ( xlUp ). Row tmp = Range (" A " & i ). Value Range (" A " & i ). Value = Left ( tmp , InStr ( tmp , " 号 室 ") - 1 ) & Mid ( tmp , InStr ( tmp , " 号 室 ") + 3 , 1 ) Next i End Sub 
こんにちは。 すみません 、 HTA な ん です から 、 https :// gallery . technet . microsoft . com / scriptcenter / 311 db 492 - eadd - 4 e ... の 記事 に ある よう な 、 プログレスバー の オブジェクト を つかっ たら どう なる の か 、 試し て み て ください 。 html ドキュメント の 部分 で 、 プログレス 、 という こと だ と 、 イベント 処理 を 正しく し ない と 、 全然 描画 し て くれ ませ ん し 。 
Private Sub Worksheet _ BeforeDoubleClick ( ByVal Target As Excel . Range , Cancel As Boolean ) ↓ Private Sub Worksheet _ BeforeDoubleClick ( ByVal Target As Excel . Range , Cancel As Boolean ) Dim xRng As Range On Error Resume Next Set xRng = Inter sect ( Target , Range (" F : S , AA : AN ")) On Error GoTo 0 If xRng Is Nothing Then Exit Sub 
設定 → ディスプレイ → ディスプレイ の カスタマイズ で サイズ を 100% に 下げ て から 実行 し て み て は ？ 
「 入力 」 シート に 入力 さ れ て いる 最下 行 の F 列 の データ は Worksheets (" 入力 "). Range (" F " & Rows . Count ). End ( xlUp ). Value で 取得 でき ます 。 「 データ 」 シート の 、 アクティブ セル の ある 行 の 、 B 列 は Worksheets (" データ "). Activate Range (" B " & Active Cell . Row ) に なり ます 。 その セル に データ を 設定 する わけ です から 、 Worksheets (" データ "). Activate Range (" B " & Active Cell . Row ). Value = Worksheets (" 入力 "). Range (" F " & Rows . Count ). End ( xlUp ). Value と なり ます 。 
右 に 移動 し たら という 事 な ので 行 の 説明 は 省き ます 。 C = Cells ( 1 , Columns . Count ). End ( xlToLeft ). Column で 最終 の 列 数 を 求め て い ます 。 For J = 1 To C Step 2 列 が １ 列 （ つまり A 列 から 最終 列 まで ２ 列 おき に という 意味 です ・ If Cells ( I , J + 1 ) = " ok " Then で CELLS ( I , J + 1 ) で CELLS ( I , 2 )=" OK " なら ば Cells ( I , J ). Select CELLS ( I , 1 ) を 選択し Selection . Font . Color Index = 3 赤 で 塗りつぶし なさい と いう 事 です 。 全体 を 右 に ずらし た なら For J = 1 To C Step 2 Ｊ が １ 列 目 から では なく ずらし た 位置 の 列 数 を いれれ ば 良い と 思い ます 。 
マクロ の 記録 で 作っ て みる 。 Range (" A1 "). Select Selection . Cut Range (" A 2 "). Select ActiveSheet . Paste Active Cell . FormulaR 1 C1 = Active Cell . Value & " 様 " 
型 の 違う 値 を 配列 に 入れる 方法 は 一度 やっ た こと が あり ます 。 http:// office tanaka .net / excel / vba / variable / 12 . htm あと は やり たい こと が 理解 し かね まし た ので 、 失礼 し ます 。 
記述 が 変わっ て しまい ます が 良い です か ？ 以下 を 標準 モジュール に 記述 し て Samp 1 を 実行 し て み ます 項目 シート 内 の 記述 順 は 、 条件 一致 さ せる もの を 左側 に 偏ら せ て 、 条件 一致 の 項目 数 は >     Const CFCNT As Long = 3 で 変更 でき ます 項目 シート に 記述 し た もの は 、 他 の シート 両方 に ある ･･･ なお 、 処理 する 行 範囲 は A 列 で 求め て まし た Option Explicit Private Const CSEP As String = " " Public Sub Samp 1 ()     Dim dic As Object     Dim ws As Worksheet , rng As Range     Dim sKou As String , sRngM As String , sRngS As String     Dim sS As String     Dim i As Long , j As Long , k As Long , n As String     Const CFCNT As Long = 3     sKou = GetKou (" 項目 ")     sRngM = GetPos (" 期限 管理 ", sKou )     sRngS = GetPos (" システム 更新 データ ", sKou )     If (( Len ( sRngM ) = 0 ) Or ( Len ( sRngS ) = 0 )) Then Exit Sub     Set dic = CreateObject (" Scripting . Dictionary ")     Set ws = Worksheets (" 期限 管理 ")     With ws        With . Range (" A1 ", . Cells ( Rows . Count , " A "). End ( xlUp ))           For i = 2 To . Rows . Count              With . Cells ( i ). Range ( sRngM )                 sS = ""                 For j = 1 To CFCNT                    sS = sS & . Areas ( j ). Value & CSEP                 Next                 dic ( sS ) = i              End With           Next        End With     End With     Application .S creenUpdating = False     With Worksheets (" システム 更新 データ ")        With . Range (" A1 ", . Cells ( Rows . Count , " A "). End ( xlUp ))           For i = 2 To . Rows . Count              With . Cells ( i ). Range ( sRngS )                 sS = ""                 For j = 1 To CFCNT                    sS = sS & . Areas ( j ). Value & CSEP                 Next                 If ( dic . Exists ( sS )) Then                    n = dic ( sS )                    k = CFCNT + 1                 Else                    n = dic . Count + 2                    dic ( sS ) = n                    k = 1                 End If                 Set rng = ws . Cells ( n , " A "). Range ( sRngM )                 For j = k To rng . Areas . Count                    rng . Areas ( j ). Value = . Areas ( j ). Value                 Next              End With           Next        End With     End With     Application .S creenUpdating = True     Set dic = Nothing End Sub Private Function GetKou ( sName As String ) As String     Dim sR As String , sS As String     Dim i As Long , j As Long     sR = ""     With Worksheets ( sName )        j = . Cells ( 1 , Columns . Count ). End ( xlToLeft ). Column        For i = 1 To j           sS = Trim (. Cells ( 1 , i ). Value )           If ( Len ( sS ) > 0 ) Then sR = sR & CSEP & sS        Next        sR = sR & CSEP     End With     GetKou = sR End Function Private Function GetPos ( sName As String , ByVal sKou As String ) As String     Dim sS As String     Dim i As Long , j As Long     With Worksheets ( sName )        j = . Cells ( 1 , Columns . Count ). End ( xlToLeft ). Column        For i = 1 To j           sS = Trim (. Cells ( 1 , i ). Value )           If ( Len ( sS ) > 0 ) Then              sS = CSEP & sS & CSEP              sKou = Replace ( sKou , sS _                 , CSEP & . Cells ( 1 , i ). Address ( False , False ) & CSEP )           End If        Next     End With     If ( Not sKou Like "*[! 0 - 9 A - Z ]*") Then        GetPos = Replace ( Trim ( sKou ), CSEP , ",")     End If End Function 
[ TCP/IP の IPアドレス と ポート について ] ソケット 通信 と 呼ば れる 通信 は 、 主 に TCP/IP と 言う プロトコル （ 通信 の 規約 ） を 使っ た 通信 です 。 これ は 、 クライアント から サーバー に 接続 し て 通信 し ます 。 すなわち 、 クライアント 用 プログラム で 、 サーバー の IPアドレス と ポート を 指定 し て 接続 し て 通信 し ます 。 すなわち 、 クライアント の の IPアドレス と ポート は 、 不要 です 。 IPアドレス は 、 接続 相手 の マシン （ サーバー 機 ） を 指定 する アドレス （ 住所 ） です 。 しかし 、 サーバー 機 用 の マシン （ パソコン 、 又は 、 ワークステーション ） を 特定 し て も 、 サーバー 機 用 マシン 内 に は 、 複数 の プログラム が 存在 する ので 、 どの プログラム に 接続 する の か 指定 する 必要 が あり ます 。 それ が 、 ポート です 。 飛行機 が 、 飛行場 内 の エアポート で 離着陸 し ます が 、 その ポート と 同じ 意味 です 。 船 が 、 港 の ポート に つけ ます が 、 その ポート と 同じ 意味 です 。 サーバー 機 用 マシン 内 の どの 通信 用 プログラム と 接続 する の か 、 それ を 指定 する の が ポート です 。 [ 回答 本編 ] サーバ 側 ( IP : 192 . 168 . 1 . 10 、 ポート ： 1001 ) だけ 必要 です 。 よって 、 client . Connect (" localhost ", 80 ) を サーバー の IPアドレス と ポート 番号 を 指定 し て 、 client . Connect (" 192 . 168 . 1 . 10 ", 1001 ) と し ます 。 サーバー 用 プログラム で も 、 クライアント 用 プログラム で も 、 上記 の 指定 を し ます 。 クライアント 用 プログラム で の 指定 は 、 接続 する サーバー の 指定 です 。 サーバー 用 プログラム で の 指定 は 、 クライアント が 自身 （ サーバー ） を 特定 する ため の 指定 です 。 よって 、 サーバー 用 プログラム で も 、 クライアント 用 プログラム で も 、 上記 の サーバー 側 の 指定 を し ます 。 
こんにちは。 表示 し て いる word オブジェクト を get object で アプリ を 捕捉 、 p :// www . relief .jp / itnote / archives / word - vb a-c ursor - position . php に ある よう な 、 wordvba コード を 使っ て 、 現在 の カーソル の 位置 を 確認 。 必要 だっ たら 、 ドキュメント に アンカー を 設定 し て おい て 、 そこ に ハイパー ジャンプ が 、 一番 簡単 に 処理 でき そう です 。 office の アプリ を sendmessage で 扱う 、 という の が 、 全然 うまく 出来る 気 が し ませ ん 。 
VisualStudio と 間違え て ませ ん か ？ visual basic は プログラミング言語 です よ 
補足 要求 です 。 ・ 参照元 の A1 4 に 入力 さ れ て いる 内容 を 、 参照 先 の B5 へ 【 常に 】 反映 さ せ たい 。 ・ 参照 先 の B5 の 情報 を 編集 する 場合 が あり B5 へ 常に 反映 さ せる の で あれ ば 、 B5 を 編集 し て も 、 即 A1 4 の 内容 に 反映 さ せる の でしょ う か ？ それとも 何かしら の アクション ( ボタン を プッシュ ) を し た とき だけ 、 反映 さ せる の でしょ う か ？ 
文字列 で あれ ば 、 cdate ( range (" A 2 "). value ) で 日付 に型 変更 できる と 思い ます 。 どうでしょう ？ 
通常 は 各 端末 の ファイル を 取り出し て いじる 、 という 事 は 行わ ない 。 配布 サーバ など を 使っ て 一方的 に 配布 する だけ 。 
> ある サイト から ファイル を ダウンロード する と 、 下記 が 表示 さ れ ます 。 どの サイト から 、 どんな ファイル を ダウンロード し て 、 どの よう に 実行 し た の か 詳細 を 書か ない と 、 第三者 で は 分かり ませ ん 。 VBA の 話し で あれ ば 、 ソース を 開い て 自分 で デバッグ すれ ば 良い か と 思い ます 。 第三者 で は 状況 が 全く 分から ない ので ・ ・ ・ 
表 は A1 から 始まっ て いる もの と し ます 。 Sub 一 例 です () Dim i As Long With Worksheets . Item ( 1 ). Copy after :=. Item (. Count ) For i = 2 To . Count - 1 With . Item ( i ) . Range (" A 2 ", . Cells ( Rows . Count , 1 ). End ( xlUp )). EntireRow . Copy End With . Item (. Count ). Cells ( Rows . Count , 1 ). End ( xlUp ). Offset ( 1 ). EntireRow . PasteSpecial Next i End With End Sub 
こんにちは。 「 出来 ます か 」 と 質問 さ れ たら 、 可能 かも しれ ない でしょ う けど 、 IE の html ブラウザー エンジン の 仕事 を 、 全部 、 主 様 が 、 設計 する 、 という こと でしょ う か 。 ブラウザー が 表示 を し た 、 という こと は 、 ドキュメント の 持っ て いる javascript の スクリプト 処理 を 全部 し た 、 という こと です 。 スクリプト は 、 ドキュメント に ある もの と 、 src によって 、 外部 に ある もの と 、 あり ます 。 それら が 、 全部 、 読み取っ た として 、 膨大 な スクリプト コード を 処理 さ せ ない と 、 ドキュメント の タグ 構造 を 全部 配置 でき ませ ん 。 それから 、 イベント も です 。 あと は 、 サーバー が クライアント の 問い合わせ し ます 。 「 あなた は どの ブラウザー な の か 」 という 質問 を し ます 。 その とき に 、 「 xmlhttp です 」 という 意味 の 返事 を する ので 、 「 何者 ？ 」 という 挙動 を する こと だって 、 可能性 十 分 に あり ます 。 すべて の サイト が そう だ 、 という こと で は ない の です が 、 http の 挙動 と https の 挙動 、 さらに 、 セキュリティ キー の 関係 、 セッション の 概念 の 問題 、 など 、 決まり ごと が ある ので 、 うまく 出来る きが し ませ ん 。 極端 に 言う と 、 「 スクリプト の 存在 し ない ページ 」 だっ たら 、 XMLreq で 処理 でき ます 。 
System . Timers . Timer を 使え ば 、 一定 間隔 で イベント を 発生 さ せる こと が でき ます 。 var t = new Timer ( 1000 ); t . Elapsed += ( s , e ) => Console . Write Line (" Done "); t .S tart (); Task . Delay ( 10000 ). Wait (); t .S top (); t . Dispose (); C# らし さ を 求める なら 、 Rx ライブラリ を 使え ば 以下 の よう に も でき ます 。 var o = Observable . Interval ( new TimeSpan ( 0 , 0 , 1 )). Subscribe ( x => Console . Write Line (" Done : " + x )); Task . Delay ( 10000 ). Wait (); o . Dispose (); 
コード 例 です 。 対象 シート の シート モジュール に 記述 し て ください 。 例 で は A1 に 入力 する と B 1 に 反映 さ れ ます 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) If Target . Cells . Count = 1 Then If Not Inter sect ( Target , Range (" A1 ")) Is Nothing Then If IsNumeric ( Target . Value ) Then With Range (" B 1 ") If Target . Value = "" Then . ClearContents Else If Not IsNumeric (. Value ) Then . ClearContents . Value = . Value + Target . Value End If End With End If End If End If End Sub 
こんにちは。 再 計算 の 動作 は 、 外部 ブック が ある 対応 、 計算 式 が 複雑 な 場合 は 、 計算 さ れる 順番 を 考え て 、 「 計算 式 を 設定 し て 値 に 定着 さ せる 」 マクロ 処理 を する こと で 、 全体 の 機能 を 実現 、 と 、 ブック の 計算 を 基本 機能 で する の か 、 プログラム で する の か 、 という こと に なり ます 。 現在 の 状況 でし たら 、 再 計算 が 半永久 ループ に なっ て いる という 状況 だ と 、 計算 式 を 操作 さ せる 方式 を 検討 し ます 。 さて 、 質問 の 回答 です が 、 application . calculate は 、 再 計算 の 操作 で あっ て ます 。 最初 の 質問 は 、 雰囲気 は わかる の です が 、 エクセル の 再 計算 と マクロ の 処理 は 「 同時 」 で は あり ませ ん 。 マクロ の 再開 、 とか の こと だ と 、 イベント の 処理 など 、 広範囲 に 確認 が 必要 です 
aporioooon さん 書い て み た だけ 、 テスト は し て い ない 。 kaisu = 1 sum = 0 while kaisu > 0 input kaisu sum = su m+ kaisu wend print sum end 
NuGet にて 「 LibJpeg .NET - ts 」 を プロジェクト に インストール し て ください 。 Jpeg に は 疎い の です が 、 以下 の コード で 目的 の 形式 に なる か と 思い ます 。 static void Main ( string [] args ) { var cp = new BitMiracle . LibJpeg . CompressionParameters () { Subsampling = BitMiracle . LibJpeg .S ubsampling . HighDetail _ 4 _ 4 _ 4 , YHSamp = 1 , YVSamp = 1 , CbHSamp = 1 , CbVSamp = 1 , CrHSamp = 1 , CrVSamp = 1 , Quality = 100 , SmoothingFactor = 0 , SimpleProgressive = false , }; new BitMiracle . LibJpeg . JpegHelper () .S ave ( new Bitmap (@" in .jpg "), @" out .jpg ", cp ); } 
テーブル 内 の 文字列 “ 山田太郎 ” を ” 山 ○ 太 ○ ” に 変 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1416090232 ... ここ で 記述 し た 内容 で は わから なかっ た です か ？ 標準 モジュール に Public Function Samp 1 ( vSrc As Variant ) As String     ・ ・ ・     Samp 1 = sS End Function と 記述 し て い たら 、 クエリ の 方 で は Samp 1 ( 氏名 ) Samp 1 部分 を XXXX に 変更 し たら Public Function XXXX ( vSrc As Variant ) As String     ・ ・ ・     XXXX = sS End Function クエリ の 方 で は XXXX ( 氏名 ) この 変更 の 仕方 は 理解 し た という こと で 、 Samp 2 を Public Function Samp 2 ( vSrc As Variant _              , Optional sChg As String = "○") As Variant     Dim sS As String     Dim i As Long     Const CL As Long = 4 ' ★     Samp 2 = Null     If ( Len ( Nz ( vSrc )) = 0 ) Then Exit Function     sS = vSrc     If ( Len ( sS ) < CL ) Then ' ★        sS = sS & String ( CL - Len ( sS ), " み ") ' ★     End If ' ★     For i = 2 To Len ( sS ) Step 2        Mid ( sS , i , 1 ) = sChg     Next     Samp 2 = sS End Function これ を 標準 モジュール に 記述 し て 、 クエリ の 方 で Samp 2 ( 氏名 ) と 記述 する と 、 偶数 文字 目 を ○ に 置き換え ます Samp 2 ( フリガナ ,"#") と 記述 する と 、 偶数 文字 目 を "#" で 置き換え ます ２ 番目 の 引数 を 省略 する と ○ に 置き換え 指定 する と 、 その 文字 で 置き換え ます ★ 部分 は 、 ４ 文字 に 満た ない 時 に " み " を 追加 する 処理 に なっ て ます 不要 で あれ ば 、 行 ごと 削除 し て ください これ で どう なり ます か ？ 
① コンボボックス に 登録 し て おく 品名 を すべて 提示 し て いただけ ます か ？ ② 登録 し た データ に 簡単 な 追 番 を つけ たい 、 と の こと です が どの よう な 追 番 を どこ に つけ たい の でしょ う か ？ 新しく 列 を 追加 し て 1 から 順に 番号 を 入れる 、 など 具体 的 に 示し て いただけ ます か ？ 
for each tmpChk in XXXX if チェックボックス か ？ then buf = buf & チェックボックス の 名前 end if next A1 = buf みたい な 感じ で 回せ ば いい ただ 、 どこ に 配置 し た チェックボックス か で 書き方 も 変わる ので 補足 す べし 補足 する と 誰か が 応え て くれる 、 、 かも しれ ない ＃ ユーザー フォーム ＃ シート に activeX の チェックボックス ＃ シート に フォーム の チェックボックス 一応 参考 まで http:// office tanaka .net / excel / vb a/t ips / tips 44 . htm これ の buf "," で 連結 する よう に 変更 し て その buf （ 最後 の "," を 削っ て ） A1 に 入れる と いい 感じ かも 
回答 が つい て い ない の と 、 ＶＢＡ を 組む として も 、 複雑 と いう か やる こと が 多い ので 、 動作 として できる か どう か だけ 回答 いたし ます 。 実現 可能 か どう か と いう と 、 可能 だ と 思い ます 。 データ は すでに 入力 さ れ て いる もの を 移動 さ せる だけ です ので 。 ただ 、 工程 が 多い の と 、 判断 材料 が わかり にくい 為 、 組め ない です 。 やり たい こと を 一挙に 進めよ う と する より は 、 何 回 か に わけ て 、 質問 を あげる の が よい か と 思い ます 。 
こんにちは。 scriptcontrol 64 bit で 、 検索 する と 、 64 ビット で は リリース し ない 、 という よう な アナウンス の よう で 、 代替 コード あり まし た 。 http:// www . ka - net . org / office / of 32 . html に ある よう に 、 html の コントロール で 、 urlエンコード 処理 し ましょ う 。 主 様 の コード 、 どの 部分 だ か 、 わかり ます よ ね 。 
B 1 = IF ( A1 ="","", IF ( A1 >= 80 ," A ", IF ( A1 >= 70 ," B ", IF ( A1 >= 60 ," C "," D ")))) 下 方向 に コピー http:// kokoro . kir .jp / excel / if - if . html 
こんにちは。 Case elese は Case else です 。 コンパイル エラー だけ でしょ う か ね 。 
suryou As String , kingaku As String は 前 の 指摘 の 通り exitdo を 使う という 縛り が ある ので 基本 は そのままで Active Cell . Offset ( 1 , 0 ). Activate で いい ん で は ない でしょ う か 変数 やら loop の 書き方 は （ 癖 や 流儀 、 縛り 等 ） 色々 あり ます 
１ ． VBScript の FormatDateTime で は 環境 によって 表示 さ れる 形式 が 変わる 可能性 が ある ので 、 私 は 以下 の よう に し て い ます 。 DT = Right (" 0000 " & Year ( Now ), 4 ) & Right (" 00 " & Month ( Now ), 2 ) & Right (" 00 " & Day ( Now ), 2 ) ２ ． VBScript に は Dir 関数 は 無い ので FileSystemObject を 使用 し ます 。 FileSystemObject で は 、 ファイル 名 の マスク は でき ない ので 、 ファイル 名 の 一覧 を 取得 し 、 自分 で 判断 し ます 。 （ 例 ） Set FS = CreateObject (" Scripting . FileSystemObject ") For Each F in FS . GetFolder (" C :\ TEST "). Files If LCase ( Right ( F . Name , 14 )) = "_" & DT & ". xlsx " Then （ ここ に 処理 を 書き ます 例 ： MsgBox F . Name ） End If Next Set FS = Nothing 
※ Userform を 開い た とき Private Sub UserForm _ Initialize () ' 背景色 を 白 に Me . TextBox 1 . BackColor = RGB ( 255 , 255 , 255 ) End Sub ※ Userform に 変更 が 加え られ た とき Private Sub TextBox 1 _ Change () With T extBox 1 ’ ああ あの 文字 の 時 背景 赤色 If . Text = " あああ " Then . BackColor = RGB ( 255 , 0 , 0 ) ' 文字数 500 バイト 以上 の 時 背景 青色 ElseIf LenB (. Text ) >= 500 Then . BackColor = RGB ( 0 , 0 , 255 ) Else ' あああ でも なく 、 500 バイト 以上 で も ない とき は 背景色 白 . BackColor = RGB ( 255 , 255 , 255 ) End If End With End Sub 
色々 問題 ある ん だ けれど 、 各行 の * の 印字 回数 を A と の 比較 に し て 、 A は 初期 値 から 1 ループ 毎 に 1 減らす し て 0 に なっ たら 終わり という の が 分かり やすい 気 が する 。 10 INPUT " 段数 は "; DAN 20 A = DAN 30 WHILE A > 0 40 B = 1 50 WHILE B <= A 60 PRINT "*"; 70 B = B + 1 80 WEND 90 PRINT 100 A = A - 1 110 WEND 質問者 さん の やり方 だ と もう 1つ 変数 C を 立て ない と うまく いか ない 。 10 INPUT " 段数 は "; DAN 20 A = 1 25 B = DAN 40 WHILE A <= DAN 50 C = 1 60 WHILE C <= B 70 PRINT "*"; 80 C = C + 1 90 WEND 100 PRINT 110 A = A + 1 120 B = B - 1 130 WEND 
４ 行 目 を マルチ ステートメント に す べき で は 。 40 if ans = 1917 then print " 正解 ": kazu = kazu + 1 else print " 残念 。 正解 は 1917年 " 
マクロ を 使用 する すべて の ワーク シート が １ 番目 の で あれ ば ActiveWorkbook . Worksheets (" 07052016 ") を ActiveWorkbook . Worksheets ( 1 ) と する だけ で 他 の 日 でも 使用 可能 と なり ます 。 
下記 の コード でいか が でしょ う か 。 Imports System . IO Public Class Form 1 Private Sub Button 1 _ Click ( sender As System . Object , e As System . EventArgs ) Handles Button 1 . Click Dim fPath As String = _ Environment . GetFolderPath ( Environment .S pecialFolder . MyPictures ) Dim fName As String = Dir ( Pat h. Combine ( fPath , " test .*")) Do Until fName = "" Select Case Pat h. GetExtension ( fName ). ToLower () ' ファイル の 拡張子 が 下記 に 該当 する 場合 に 画像 ファイル を 読み込む Case ". bmp ", ". jpeg ", ". jpg ", ". png ", ". gif ", ". tif ", ". tiff " ' FromFile メソッド を 使う と 表示 中 の 画像 ファイル が 削除 でき なく なる ので 別 の 方法 を 取る Dim fs As New FileStream ( _ Pat h. Combine ( fPath , fName ), _ FileMode . Open , _ FileAccess . Read ) PictureBox 1 . Image = System . Drawing . Image . FromStream ( fs ) fs . Close () Exit Do End Select fName = Dir () Loop End Sub End Class 
ループ し て 監視 する しか ない かも 。 Sub chk () Dim CA As String Do CA = Active Cell . Address DoEvents If Active Cell . Address <> CA Then CA = Active Cell . Address Debug . Print CA End If Loop End Sub 
どの よう な コード を 書い て いる の か 判り ませ ん が 、 If 文 の And 条件 で 実現 できる と 思う の です が ？ 
少し 違う かも しれ ませ ん が 、 以下 の サイト に 似 た よう な こと が 書か れ て い ます 。 参考 に なり ませ ん か 。 Office TANAKA ： 自動的 に 画像 を 切り替える http:// office tanaka .net / excel / function / tips / t ip s14 . htm 
こんにちは。 最初 の マクロ の 4 行 の 次 で いい です 。 end sub の 手前 に 追加 し て ください Range (" C3 : J3 "). copy Destination := Range (" C4 : J3 0 ") たとえば 、 4 から 30 行 に コピー し た 場合 です 。 できあがっ たら 、 それぞれ の 関数 を 確認 し て ください 。 この 関数 は 、 1 行 作成 する の は 、 大変 です が 、 その 行 の し た は 、 セル の 行 だけ が 変化 し て い ます 。 そう でし たら 、 示し た コード で いい ん で は ない か と 。 
http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q10 14858978 ... を 参考 に し て み て 下さい 。 
Address :=" ここ に URL の 一部 を 入れ て い ます " & Cells ( i , 1 ), _ を Address := Range (" D1 ") & Cells ( i , 1 ), _ で いける と 思い ます 。 
特定 の 文字列 から 始まる と は たとえば ABC で 始まる 、 ABC あいうえお ABC １ ２ ３ ４ ５ みたい な こと でしょ う か ？ Sub test () Dim i As Long , j As Long , k As Long : k = 3 Dim sh 2 As Worksheet Set sh 2 = Sheets (" Sheet 2 ") With Sheets (" Sheet 1 ") For i = 1 To 2 For j = 2 To . Cells ( Rows . Count , 1 ). End ( xlUp ). Row If . Cells ( j , 1 ) Like sh 2 . Cells ( 1 , i ) & "*" Then sh 2 . Cells ( k , i ) = . Cells ( j , 2 ) k = k + 1 End If Next k = 3 Next End With End Sub オート フィルタ を 使っ て も いい です ね 。 
( xl vba ) リスト ボックス が シート の OLE オブジェ で あり 該当 データ を リスト 選択 し て いる 前提 で 下記 が 1 列 です 。 var = Split ( ActiveSheet . OLEObjects (" ListBox 1 "). Object . Value , " ")( 1 ) MsgBox var ◆ ユーザー フォーム の 場合 var = Split ( UserForm 1 . ListBox 1 . Value , " ")( 1 ) MsgBox var スペース 区切り の 2 番目 を 変数 var へ ( 配列 は ゼロ スタート ) 
Word の 画像 取り込み は Shapes . AddPicture を 使い ます 。 wdDoc .S hapes . AddPicture " D :\ image 1 .jp eg " （ せっかく 開い た wdDoc に対して 取り込み ましょ う ね ） 
フォント サイズ を 0 . 5 ずつ 変化 さ せる コード です 。 Private Sub CommandButton 1 _ Click () Selection . Font .S ize = Selection . Font .S ize + 0 . 5 End Sub Private Sub Command Bu t to n2 _ Click () Selection . Font .S ize = Selection . Font .S ize - 0 . 5 End Sub 
> i の 部分 を （ 10 . 10 ） に 入れ た 値 が 偶数 か 奇数 か 判断 する > に は どう し たら いい です か ？ Private Sub CommandButton 1 _ Click () Dim i As Long i = Cells ( 10 , 10 ). Value ' J 10 の 値 が 奇数 か 偶数 か を 判定 し ます If ( i Mod 2 ) = 0 Then MsgBox " 偶数 です " Else MsgBox " 奇数 です " End If End Sub 
dat e2 は Date 型 な のに 、 ” ” という 文字 型 と 比較 し て い ます 。 isNull ( dat e2 ) とか で 、 試し て み て は どうでしょう か ？ VBA は 得意 で は ない ので 間違っ て たら すみません 。 
VB は 全く やっ て なかっ た ので 合っ てる か わかり ませ ん し 、 ケータイ から な ので スペル ミス が ある 可能性 が ある ので 、 もし あっ た 場合 、 もし 間違え て い た 場合 は すいません Private Sub cmdCalc _ Click ( ByVal sender As Object , _ ByVal e As System . EventArgs ) Handles cmdCalc . Click Dim English As Integer = StringToInt 32 ( txt _ English . Text ) Dim Japanese As Integer = StringToInt 32 ( txt _ Japanese . Text ) Dim mathemetics As Integer = StringToInt 32 ( txt _ Mathematics . Text ) Dim average As Integer = Japanese + English + mathemetics / 3 If Japanese >= 50 || English >= 50 || mathemetics >= 50 Then lbl _ Average . Text = average If average >= 70 Then lbl _ Result . Text =" 合格 " End If Else lbl _ Result . Text =" 不 合格 " End If End Sub Private Function StringToInt 32 ( String value ) Return Integer . Parse ( value ) End Function 
こんにちは。 バナー の 場合 です 。 何 も 無い 空間 に Set v 1 = ie . document . create element (" table ") ' ここ に 、 行 の ループ Set v2 = v 1 . insertRow (- 1 ) ' ここ に 、 列 の ループ Set v3 = v2 . Insertcell (- 1 ) Set v6 = ie . document . create element (" A ") v6 . href = " ハイパー ジャンプ " v6 . Target = "_ blank " Set v 5 = ie . document . create element (" IMG ") v 5 .s rc = " イメージ ソース " v6 . appendchild ( v 5 ) v3 . appendchild ( v6 ) ' これ で 、 ひとつ の バナー の 設定 が 、 セル に対して 行い まし た 。 これ を 、 列 の 分 、 行 の 分 を ループ する と 、 テーブル が でき ます 、 削除 は 、 テーブル の rows を 捕まえ て 、 remove と し たら 、 その tr タグ を 削除 でき ます 。 2000年 頃 に 、 microsoft が ダイナミック html の 記事 を 載せ て い て 、 javascript による テーブル の 生成 に 、 table タグ 、 正式 に は 、 table body など が 無い と 、 プラウザー によって は 表示 でき ませ ん 。 insertrow に マイナス の 引数 だ と 、 最終 行 に 追加 する 動作 の よう です 。 
やっ て み たら 、 これ で 出来 まし た 。 Dim comboc 1 As New DataGridViewComboBoxCell comboc 1 . Items . Add (" AAA ") comboc 1 . Items . Add (" BBB ") comboc 1 . Items . Add (" CCC ") comboc 1 . Value = " AAA " DataGridView 1 . Rows ( 0 ). Cells ( 0 ) = comboc 1 
Dim bb As Workbook Set bb = ActiveWorkbook bb . Close こちら は 他 に 使い まわさ ない の で あれ ば ActiveWorkbook . Close だけ で 大丈夫 です 。 エラー は 再現 し ませ ん 。 エクセル の バージョン や OS を 示し て は いかが でしょ う か 。 
VB 6 の テキストボックス は コントロール 配列 使っ て ます か ？ 何 100 個 も 画面 に 配置 し てる なら おそらく コント オール 配列 です よ ね ？ それなら 一層 の 事 、 VB.NET 側 で 、 もう デザイナ 使わ ず に コード で テキストボックス の 配列 を New し て 、 座標 指定 で 配置 してやれ ば どうでしょう ？ 例えば VB 6 で txtbox ( 0 )～ txtbox ( 11 ) まで の 12 個 が 縦 ３ ｘ 横 ４ で 画面 に 配置 さ れ てる なら 、 こんな 感じ で 。 座標 とか TextBox の サイズ は 調整 する として 。 Private txtbox As TextBox () = New TextBox ( 11 ) {} Private Sub Form 1 _ Load ( sender As Object , e As EventArgs ) Handles MyBase . Load For col As Integer = 0 To 3 For row As Integer = 0 To 2 txtbox ( row * 4 + col ) = New TextBox () Me . Controls . Add ( txtbox ( row * 4 + col )) txtbox ( row * 4 + col ). Location = New Point ( txtbox ( 0 ). Left + ( txtbox ( 0 ). Width + 10 ) * col , txtbox ( 0 ). Top + ( txtbox ( 0 ). Height + 5 ) * row ) Next Next End Sub これ で 画面 から dim str as string = txtbox ( 5 ). text みたい に 使える よ 。 
名簿 の 数 だけ 繰り返す 、 という こと で は ない でしょ う か 。 kazei = Range (" B2 "). Value ↓ kazei = Range (" B " & n ). Value Range (" C 2 "). Value = zei ↓ Range (" C " & n ). Value = zei この よう に 変更 し て 変数 で 参照 セル が 動い て いく よう に し て おき 、 処理 全体 を For ～ Next で 囲み ます 。 For n = 1 To 4 ' 処理 Next 
ActiveSheet . Paste ↓ ActiveSheet . Range (" A1 "). PasteSpecial Paste := xlPasteValues 
ファンクションキー の 割当 が 変わっ て いる の で は ない でしょ う か ？ 。 vs 2010 以前 と は F キー 割当 が 変わっ て おり 、 私 は 設定 し 直し た 記憶 が あり ます 。 下記 を 参考 に 設定 を 確認 し て み て ください 。 https :// msdn . microsoft . com / ja - jp / library / 5 zwses 53 . aspx 
まず 、 CSV ファイル は エクセル で 開け ます が 、 エクセル 形式 と は 別物 です 。 値 が カンマ （ 列 ） と 改行 （ 行 ） で 区切ら れ た データ構造 です 。 読み取り は 以下 の よう に し ましょ う 。 Dim Lines () As String = File . ReadAllLines (" C :\ kanri \ aaa . csv ") Dim Cells ()() As String = New String ( Lines . Length - 1 )() {} For i As Integer = 0 To Lines . Length - 1 Cells ( i ) = Lines ( i ). Split (','); Next VB に 疎い ため 、 間違っ て い たら すみません 。 パス について は わかり ませ ん 。 パス 文字列 が 間違っ て い ない か もう一度 ご 確認 ください 。 
Sheet 1 A 列 で 列 挿入 A 2 = IF ( COUNTIF ( Sheet 2 ! A : A , B2 ), ROW (),"") 下 方向 に コピー Sheet 3 A 2 = IFERROR ( VLOOKUP ( SMALL ( Sheet 1 !$ A :$ A , ROW ( A1 )), Sheet 1 !$ A :$ D , COLUMN ( B 1 ), 0 ),"") 右 方向 ・ 下 方向 に コピー 
ユーザー 名 と パスワード を そのまま 文字列 で コード に 書い て い た の で は 難読 化 ツール を 使っ て も 効果 は あり ませ ん 。 別 ファイル に 保存 し て おく の も 手段 の ひとつ です が 、 その ファイル が 外部 から 簡単 に 見 られ て しまう の で は 意味 が なくなっ て しまい ます 。 ごく 簡単 で いい ので あなた 独自 の 暗号 を 作る の が もっとも 簡単 です 。 例 ： アルファベット の 文字 の 置き換え nagato → 文字 を 二つ ずつ ずらす → pcicvq 
こんにちは。 ms の 提供 する https :// support . office . com / ja - jp / article /- accdb -% E3 % 83 % 95 % E3 % 82 % A1 %... の 記事 の 種類 に なる か と 思い ます が 、 ファイル 変換 は 、 単純 に ファイル を 操作 によって 保存 し なおし し て 、 対応 できる よう な 作業 に は なり ませ ん 。 パスワード の かかっ て いる mdb という の だ と 、 なおさら 、 「 どの ファイル ば 、 どの パスワード 」 と ファイル によって 管理 し て い て 、 それ を 自動 で 問い合わせ て 開く 、 という の でし たら 、 意味 の ある もの に なり ます 。 主 様 は 、 「 パスワード の 対策 を し て いる 」 という こと な ん です から 、 機能 として 実装 さ せ ない と いけ ない 、 という こと な ん です よ ね 。 MS の 記事 の 場合 、 資産 が たくさん あっ て ファイル 変換 を する か 、 最初 から 作る か 、 まったく 変換 を し ない で 使い 続ける か 、 という 選択 は 、 ユーザー に 決め て もらう 、 という こと な ので 、 「 変換 」 という 選択 が どう か 、 という の は 、 検討 の 余地 が あり ます 。 主 様 が 、 変換 の 方針 、 という こと でし たら 、 ファイル の パス の 管理 まで 含め て 、 変換 処理 を 設計 し て ください 。 「 ファイル を 開く 」 の ヘルプ に は パスワード の 引数 の 説明 も ある の です が 、 その 確認 という こと です 
If . Cells ( i , 5 ) <> "" Then If . Cells ( i , 5 ) > TimeSerial ( 9 , 0 , 0 ) Then ↓ If . Cells ( i , 5 ) <> "" Then If . Cells ( i , 5 ) > TimeSerial ( 9 , 0 , 0 ) Then If Not (. Cells ( i , 2 ). Value = " 土 " Or . Cells ( i , 2 ). Value = " 日 ") Then > 列 を 挿入 し 曜日 を 入力 する マクロ を 追加 し まし た 。 新規 列 の 挿入 で 列 番号 が ずれる 、 の は 考慮 し て い ませ ん 。 
当方 が Sub asd () Dim ad , ac ad = " 10 / 11 / 12 " ad = Replace ( ad , "/", "") If IsNumeric ( ad ) = False Then ac = Split ( ad , vbLf ) MsgBox ac ( 0 ) Else MsgBox ad End If End Sub で 検証 する 限り で は 正常 に 動作 し て い ます 、 貴方 の 異常 を 簡単 に 再現 できる コード を 示し て ください 。 
「 方法 : ホスト プロセス を 無効 に する 」 https :// msdn . microsoft . com / ja - jp / library / ms 185330 ( v = vs . 80 ). aspx > 記事 で 紹介 さ れ て いる よう な プロパティ の [ タブ ] は 表示 さ れ ず プロパティ タブ で は なく 、 プロパティ 画面 の 「 デバッグ 」 タブ に あり ます よ 。 いちばん 下 の 方 。 
条件 という か書 式 という か 関数 と いう か で いけ ない ？ A 列 、 B 列 が それぞれ 1 行 目 が 始まっ てる として = if ( or ( sheet 1 ! A1 ="", A1 =""),"", if ( sheet 1 ! A1 = A1 , sheet 1 ! b 1 ,"")) を B 1 に 入れ て 下 の ほう へ ドラッグ 。 
一般 的 な 高速化 の 手段 として は 、 画面 更新 の 停止 と 、 シート 上 の 関数 の 再 計算 の 停止 と 、 VBA で の イベント プロシージャ の 動作 停止 です ね 。 http:// thom . hateblo .jp / entry / 2015 / 08 / 31 / 063500 ちなみに 、 マクロ の 最後 に は 有効 に 戻し て 下さい ね 。 あと 、 デバッグ 中 の 時 は 途中 で プロシージャ を 停止 する と 画面 更新 が 停止 し た まま excel を 操作 する 事 に なり ます 。 と 、 画面 が おかしく なり ます の 。 な ので 、 上記 の 高速化 処理 は 動作 確認 が 取れ た あと 、 実 運用 の 段階 に なっ て から 組み込む の が いい でしょ う 。 （ まぁ 実際 に 自分 で やれ ば 、 どういう 状態 に なる か 分かり ます 。 ） あと 、 今回 の 例 で は 、 繰り返し 処理 の ため に 、 わざわざ 最終 行 の 1 行 下 の セル に 繰り返し が 終わり と なる 目印 の 文字 を 入れ て 、 対象 と なる セル を select し て 処理 し て い ます 。 そう では なく 、 たとえば 、 最終 行 の 行 数 を k とか の 変数 に 代入 し 、 RowInsert の 値 を 初期 値 9 として 最初 に 代入 し て おき 、 Do while ～ loop で 、 RowInsert が k 以下 の間だけ ループ する よう に し ます 。 それで 、 分岐 処理 にて 判定 し 、 その 結果 により RowInsert = RowInsert + 1 か 3 に してやる わけ です 。 これ が offset の 代わり に なり ます 。 条件 分岐 で 調べる 対象 の セル は Cells ( RowInsert , 17 ) で 指定 でき ます 。 こう すれ ば 繰り返し 終了 目印 の 文字 入力 と 削除 が 省略 でき ます 。 また 、 select を 使っ て Active cell の 選択 を 動かす より も 内部 変数 の 数値 を 計算 により 変える 方 が 処理 的 に 速い 、 はず です 。 > Q 列 の 値 は ” 行 挿入 ” もしくは 空白 です 。 挿入 処理 を する か し ない か 、 という 2 択 でし たら 、 Select Case より も If の 方 が 記述 として 素直 な 気 が し ます 。 まぁ そこ は それぞれ の 人 の センス な の です が 。 あ 、 あと 、 カテゴリ が 英語 に なっ て ます ね 。 通常 こう いっ た 類 の 質問 は 即日 回答 が つく もの です が 、 別 カテゴリ の 為 に 人目 に 付か なかっ た の でしょ う 。 カテゴリ 違い により 違反 報告 を さ れる と 、 質問 が 削除 さ れ て ライフ が 減り ます 。 早急 に 自分 で カテゴリ 変更 を する 事 を お勧め し ます 。 ( 直接的 な コード 回答 は 避け て おり ます 。 疑問 点 が あり 、 そういった 回答 で も 良けれ ば 返信 ください 。 コード 作成 依頼 でし たら 、 これ 以上 の 回答 は 致し ませ ん ので 返信 不要 です 。 ) それでは 。 
リスト アイテム の 数 が ListView コントロール の 枠 内 に 収まら ない 場合 、 自動的 に スクロールバー が 表示 さ れ ます し 、 どれ か の アイテム が 選択 さ れ て いれ ば 上下 カーソル で 選択 位置 を 移動 でき ます 。 上下 移動 用 の ボタン は 必要 ない の で は ない でしょ う か 。 ご 質問 に対する 私 の 解釈 が 的外れ な の でしょ う か 。 
こんにちは。 variant で いい です けど 、 問題 でも ？ 
下記 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st 2 As Worksheet Dim c As Long Dim r1 As Long , r2 As Long , nm As String Set st 1 = Worksheets (" Sheet 1 ") Set st 2 = Worksheets (" Sheet 2 ") ' Sheet 2 を 一旦 クリア する st 2 . Cells . Clear st 2 . Range (" A1 "). Value = " 品番 " st 2 . Range (" B 1 "). Value = " 数量 " r2 = 2 ' 列方向 は A 列 から 始まっ て 4 列 ごと に 最終 列 + 1 列 目 まで For c = 1 To st 1 . Range (" A 2 "). SpecialCells ( xlCellTypeLastCell ). Column + 1 Step 4 ' 行 方向 は 空 セル が ２ 行 続く まで r1 = 2 Do With st 1 . Cells ( r1 , c ) ' 1 列 目 が 「 品名 」 の とき は 2 列 目 の 内容 を 保持 し て おく If . Value = " 品名 " Then nm = . Offset (, 1 ). Value End If ' 3 列 目 が 空白 で なく 、 数値 の とき If . Offset (, 2 ). Value <> "" And IsNumeric (. Offset (, 2 ). Value ) Then ' Sheet 2 に 品番 と 数量 を 転記 する st 2 . Range (" A " & r2 ). Value = nm & . Value & . Offset (, 1 ). Value st 2 . Range (" B " & r2 ). Value = . Offset (, 2 ). Value r2 = r2 + 1 End If End With r1 = r1 + 1 Loop Until st 1 . Cells ( r1 , c ). Value = "" And st 1 . Cells ( r1 + 1 , c ). Value = "" Next c ' Sheet 2 の 列 幅 を 調整 する st 2 . Columns (" A : B "). EntireColumn . AutoFit st 2 .S elect st 2 . Range (" A 2 "). Select st 1 .S elect End Sub 
こんにちは。 この コード 、 謎 が 多 すぎ 。 Dim pic As jpgPicture Set pic = New jpgPicture ここ な ん です が 、 この VBA 環境 に 、 class が あっ て 、 jpgPicture という オブジェクト が 必要 です 。 tm = " 2001 / 10 / 31 18 : 00 : 00 " tugi : b () = Inet 1 . OpenURL "①") ここ 。 Inet 1 の 変数 が 、 new なり 、 インターネット 系 の オブジェクト が ある こと に なり ます 。 つぎ に ある open は 、 VBA の バイナリー は バイナリ ファイル を 作成 する 標準 関数 です 主 様 、 大量 に 、 という 場合 、 まずは 、 「 ひとつ を 正確 に 」 できる コード を 作成 し 、 それ を ループ する こと を 考え ます 。 if で 、 ループ を 戻す 、 という よう な コード は 、 スパゲッティ みたい な コード に なる ので 、 使わ ない で 考える こと です 。 format で 、 日付 から 文字列 に し ます が 、 文字列 の 特定 部分 で 、 取得 という 場合 、 instr 関数 で 、 区切り を 探し ます 。 url の 1280 x 960 / 200110 / 2001103118 .jpg の 場合 、 v 1 = right ( url , 21 ) ' 200110 / 2001103118 .jpg yy = datevalue ( left ( v 1 , 4 ) & " 年 " & mid ( v 1 , 5 , 2 ) & " 月 01 日 ") mm = datevalue ( mid ( v 1 , 9 , 4 ) & " 年 " & mid ( v 1 , 13 , 2 ) & " 月 " & mid ( v 1 , 15 , 2 ) & " 日 ") + timevalue ( mid ( v 1 , 17 , 2 ) & " 時 01 分 ") という よう な 、 日付 変換 を し ます 。 仕上げ は 、 ヘルプ も 見 て ください 。 どんな 絵 な の か 、 一般 的 な url だっ たら 、 見 て み た いき も し ます 。 
下記 の コード でいか が でしょ う か ？ 最初 は テスト も 兼ね て １ ０ 件 程度 の データ で 確かめ て 下さい 。 Option Explicit Sub Sample () Dim s1 As Worksheet , s2 As Worksheet Dim r As Long , r1 As Variant , i As Integer Set s1 = Worksheets (" 名簿 ") Set s2 = Worksheets (" 明細 ") For r = 2 To s1 . Range (" A " & s1 . Rows . Count ). End ( xlUp ). Row Step 3 i = 0 For Each r1 In Array ( 1 , 18 , 36 ) ' 明細 へ コピー With s2 . Cells ( r1 , " B ") . Offset ( 0 , 0 ). Value = s1 . Range (" A " & r + i ). Value ' 所属 ＮＯ . Offset ( 0 , 1 ). Value = s1 . Range (" B " & r + i ). Value ' 所属 . Offset ( 2 , 0 ). Value = s1 . Range (" C " & r + i ). Value ' 社員 ＮＯ . Offset ( 1 , 0 ). Value = s1 . Range (" D " & r + i ). Value ' 氏名 . Offset ( 6 , 2 ). Value = s1 . Range (" E " & r + i ). Value ' 過去 手当 . Offset ( 7 , 2 ). Value = s1 . Range (" F " & r + i ). Value ' 6月 手当 . Offset ( 9 , 2 ). Value = s1 . Range (" G " & r + i ). Value ' 7月 手当 . Offset ( 12 , 2 ). Value = s1 . Range (" H " & r + i ). Value ' 合計 End With i = i + 1 Next ' 明細 シート を 印刷 s2 . PrintOut Next r End Sub 
マクロ 記録 の まま 実行 する と 、 効率 は 最悪 。 効率 の 良く なる よう に 手 を 入れ ましょ う 。 > 全 シート に 罫線 （ 下 に 太線 ） を 引き たい 外 枠 を 細線 に し て 、 下 の 枠 だけ 太く する 、 という 事 です か ね ？ Sub sample () Dim ws As Worksheet For Each ws In Workbooks (" 貼付 先 "). Worksheets With ws If . Name <> " 特定 シート ①" And . Name <> " 特定 シート ②" Then With . Range (" A 25 ", . Cells ( Rows . Count , 1 ). End ( xlUp )). Resize (, 213 ). Borders . LineStyle = xlNone . Weight = xlThin . Item ( xlInsideVertical ). LineStyle = xlNone . Item ( xlInsideHorizontal ). LineStyle = xlNone . Item ( xlEdgeBottom ). Weight = xl Medium End With End If End With Next ws End Sub 
Workbook . Open を Workbooks . Open として み て ください 。 次 の 行 の 「 CRange 」 は コピペミス です か ？ PS の 方 です が 、 「 2016 の 6月 分 だけ 」 と 言わ れ て も 何 を どう 判断 し て 何 を スルー すれ ば よい の か 、 フォルダ 構成 や シート 名 など 具体 的 な レイアウト が 判ら ない ので 答え よう が ない です 。 
わざわざ 作ら なく て も 練習 用 なら スマホアプリ が あり ます 。 iPhone 、 iPad 用 深視力 イメージ ＋ ３ D https :// itunes . apple . com / jp / app / shen - shi - liimeji + 3d / id 469417281 ? mt =... Android アプリ 深視力 測定 https :// play . google . com / store / apps / details ? id = com.a noptometer & hl = ja 
こんにちは。 まず 、 tr タグ が 存在 し て い ない 。 これ は 、 不安定 に なり ます 。 本来 は 、 tbody など も 無い と 、 表示 が 出来 ない ブラウザー も あり ます 。 
残念 ながら ご 希望 に 添える メソッド は あり ませ ん 。 素直 に ループ で AddItem し て 下さい 。 
デスクトップ \ 管理 フォルダ に 「 本日 日付 . xlsx 」 という 名前 で 保存 する 例 です 。 Dim FilePath As String FilePath = System . IO . Pat h. Combine ( _ Environment . GetFolderPath ( Environment .S pecialFolder . Desktop ), _ " 管理 フォルダ ", _ Format ( Now , " yyyyMMdd ") & ". xlsx ") Boo k. SaveAs ( FilePath ) 
C5 セル の 罫線 下 は 「 無い 状態 」 で は なく 、 「 白 」 の 罫線 が 引か れ て いる の で は ない です か ？ もし そう なら 、 If . Borders ( xlEdgeBottom ). LineStyle = xlNone Or . Borders ( xlEdgeBottom ). ThemeColor = 1 Then で 判定 出来る と 思い ます 。 
あくまで 参考 に 。 自分 は オヤジ な ので (^_^;) VB 6 から 色々 やっ て い ます が 、 この サイト は 、 人気 ある みたい です 。 http:// homepage 1 . nifty . com / rucio / main / main . htm まずは 、 細かい こと は 置い とい て 目 を 通し て み て 下さい 。 
↓ の 2 ヶ所 を 変更 し て 、 どうでしょう か ね ？ （ 未 実行 につき 不具合 ご 容赦 ） １ ） For Each h In wbS . Worksheets If wbS . Worksheets ( h ). Name Like " 新規 " & "*(*" Then wbS . Worksheets ( h ). Delete ↓ For Each h In wbS . Worksheets If h. Name Like " 新規 *(*" Then h. Delete ２ ） For Each wss In wbS . Worksheets If wss . Name <> " 特定 シート " And wss . Name <> " 新規 " Then Range (" A 25 : A " & Range (" A1 000 "). End ( xlUp ). Row ). SpecialCells ( xlCellTypeBlanks ). EntireRow . Delete End If ↓ For Each wss In wbS . Worksheets With wss If . Name <> " 特定 シート " And . Name <> " 新規 " Then On Error Resume Next . Range (" A 25 : A1 000 "). SpecialCells ( xlCellTypeBlanks ). EntireRow . Delete On Error GoTo 0 End If End With 上手く 実行 でき て いる の かも 知れ ませ ん が 、 全体 的 に たどたどし さ が 残っ て いる コーディング です ね 。 もっと 整理 す べき でしょ う 。 
閉じ て いる 他 の ブック を 参照 する なら Application . ExecuteExcel 4 Macro を 使用 し ます 。 まず 、 Application . Match の 部分 は 、 Application . ExecuteExcel 4 Macro の 中 で MATCH 関数 を 書い て 値 を 求め ます 。 i = Application . ExecuteExcel 4 Macro (" MATCH (" & Range (" A1 "). Value & ",' C :¥ users ¥ desktop ¥[ book 1 . xlsx ] シート ２ '! C1 , 0 )") 次に TextBox 2 に Ｂ 列 の 値 を 返し ます が 、 これ も Application . ExecuteExcel 4 Macro を 使用 し ます TextBox 2 . Value = Application . ExecuteExcel 4 Macro ("' C :¥ users ¥ desktop ¥[ book 1 . xlsx ] シート ２ '! R " & i & " C 2 ") なお 、 ExecuteExcel 4 Macro は 必ず R1 C1 形式 で アドレス を 記述 し ます 。 MATCH の ほう は 「 ! C1 」 ・ ・ １ 列 目 値 を 返す の は 「 ! R " & i & " C 2 "」 ・ ・ i 行 、 ２ 列 目 
で 、 何 が 知り たい の ？ 
こういう こと か と Function Fx ( x As Double ) Fx = x * x * x - 3 * x * x + 9 * x - 8 End Function Function dFx ( x As Double ) dFx = 3 * x * x - 6 * x + 9 End Function Sub main () Const Xini As Double = 10 Const Eps As Double = 0 . 000001 Dim x 0 As Double , x1 As Double x1 = Xini Do x 0 = x1 x1 = x 0 - Fx ( x 0 ) / dFx ( x 0 ) Debug . Print x 0 , Abs ( x1 - x 0 ) Loop While Abs ( x1 - x 0 ) > Eps Debug . Print x1 End Sub 
で 、 何 が 知り たい の ？ 
こんにちは。 code = 4589 URL = " http:// stocks . finance . yahoo . co.jp / stocks / detail /? code =" & code & ". T " Set HTML = CreateObject (" MSXML 2 . XMLHTTP ") HTML . Open " GET ", URL , False HTML .S end Debug . Print HTML . response text こんな データ で いい ん でしょ う か 。 まず 、 URL が 違い ます 。 主 様 の 場合 、 エラー に なり ます 。 対策 です が 、 主 様 が 表示 さ せ たい URL が 、 本当に 正しい の か 、 確認 し て ください 。 手作業 で 操作 し た として も 、 url を 自動 で 処理 し て いる よう な 雰囲気 です 。 つまり 、 yahoo が リカバリー を 自動 でし た よう な 様子 、 昔 は 、 それで よかっ た かも しれ ませ ん が 、 今 は 、 コード で 投げ たら 、 エラー に なる という こと です 。 だ と し たら 、 手作業 でし た とき の url に コード を 合わせ て ください 。 
ぷろ ぱて ぃではできないんじゃないかな こんな めにゅー なら ' メニュー '├ メニュー １ ' _└ メニュー １ １ ' ___└ メニュー １ １ １ '└ メニュー ２ l oad 時 に ' メニュー 直下 の ShowImageMargin 処理 （ メニュー ） ContextMenuStrip 1 .S howImageMargin = False ← プロパティ で も おなじ ' メニュー 内 各 メニュー ごと の ShowImageMargin 処理 （ メニュー １ 、 メニュー ２ ） For Each Item 1 As ToolStripMenuItem In ContextMenuStrip 1 . Items DirectCast ( Item 1 . DropDown , ToolStripDropDownMenu ). ShowImageMargin = False '' ３ 段 目 の メニュー （ メニュー １ １ ） が あれ ば こんな 感じ で 以降 同じ （ 深 さ が 不明 なら 再帰 で 回す べし ） ' For Each Item 11 As ToolStripMenuItem In Item 1 . DropDown . Items ' DirectCast ( Item 11 . DropDown , ToolStripDropDownMenu ). ShowImageMargin = False ' Next next 
マイクロソフト の サイト https :// msdn . microsoft . com / ja - jp / library / system . windows . forms . mouse ... を 見 て も 理解 でき ませ ん か ？ 
xxxmegashock さん memory size of elements = 2 byte と 表示 さ れる と 思い ます 。 Integer １ 個 分 です から 当然 ２ バイト です 。 2 バイト = 16 ( ビット ) ??? 4 バイト = 32 ( ビット ) ( C言語 の int ) 32 ( ビット ) CPU で 
こんにちは。 For i = 2 To 最終 行 市場 = Worksheets (" Sheet 2 "). Cells ( i , 2 ) 商品 = Worksheets (" Sheet 2 "). Cells ( i , 3 ) 最終 行 3 = Worksheets (" 市場 "). Range (" A " & Rows . Count ). End ( xlUp ). Row Set 検索 = Worksheets (" 市場 "). Range (" A1 : B " & 最終 行 3 ) On Error Resume Next 地域 = Application . WorksheetFunction . VLookup ( 市場 , 検索 , 2 , False ) On Error GoTo 0 は For i = 2 To 最終 行 市場 = Worksheets (" Sheet 2 "). Cells ( i , 2 ). value 商品 = Worksheets (" Sheet 2 "). Cells ( i , 3 ). value 最終 行 3 = Worksheets (" 市場 "). Range (" A " & Rows . Count ). End ( xlUp ). Row Set 検索 = Worksheets (" 市場 "). Range (" A1 : B " & 最終 行 3 ) On Error Resume Next 地域 = vbempty 地域 = Application . WorksheetFunction . VLookup ( 市場 , 検索 , 2 , False ) On Error GoTo 0 あと 、 answer = . Index ( 全体 範囲 , 商品 検索 結果 , 地域 検索 結果 ) です が 、 シート の 座標 が わかっ て いる の です から 、 cells ( 行 , 列 ) で 十 分 か と 。 計算 さ せる 前 に 、 変数 の 初期化 を し て から です 。 エラー を 回避 する 処理 を し て いる の は 、 意味 が ある から です よ ね 。 という こと は 、 エラー が 発生 し た とき 、 変数 は 、 そのまま 放置 さ れ て いる こと に なり ます 
コピー 元 の セル が 結合 し て いる 場合 でも コピー & 値 貼付 で OK です 。 結合 情報 は 影響 し ませ ん (^_^) * * * * * * * * * * * * * * * * * * ************************* Sheets ( 2 ). Range (" T 1 "). Copy Sheets ( 6 ). Range (" B2 "). PasteSpecial xlPasteValues 
入門 サイト なら 下記 サイト です か ね 。 Excel VBA 入門 講座 http:// excelvba . pc - users .net / ある程度 覚え たら 下記 ２ サイト が 便利 です 。 モーグ の サイト http:// www . moug .net / Office TANAKA http:// office tanaka .net / excel / vb a/t ips / 
テーブル 1 ・ ・ ・ シート 1 の A1 から 始まる 表 テーブル 2 ・ ・ ・ シート 2 の A1 から 始まる 表 目標 の テーブル 3 ・ ・ ・ シート 3 の A1 から 始まる 表 と する と 、 ↓ が 1 例 。 シート 3 は 、 上書き 。 Sub sample () Const cFormula As String = "= IFERROR ( VLOOKUP ( A 2 , Sheet 2 ! A : B , 2 , FALSE ),"""")" With Worksheets (" Sheet 3 ") Worksheets (" Sheet 1 "). Range (" A : C "). Copy . Columns ( 1 ) Worksheets (" Sheet 2 "). Range (" B 1 "). Copy . Range (" D1 ") With . Range (" D2 ", . Cells ( Rows . Count , 1 ). End ( xlUp ). Offset (, 3 )) . Formula = cFormula . Copy . PasteSpecial xlPasteValues End With End With Application . CutCopyMode = False End Sub 
Excel の 開か ず に 中 の セル を 検索 し たり する こと は 出来 ませ ん 。 Application .S creenUpdating を 用い て 「 開い て い ない よう に 見せる 」 こと は 可能 です 。 例 ） Application .S creenUpdating = False ' ブック を 開く ' シート を 検索 する ’ セル の 場所 を 取得 する ' ブック を 閉じる Application .S creenUpdating = True 
ファイル 名 を 変更 する たび データ タブ の 接続 の リンク の 編集 を 押し て 「 リンク元 の 変更 」 から 変更 を エクセル に 報告 する よう な 形 に なり ます 。 元 の フォルダ が 開く ので 再確認 の よう な 感じ です 。 変更 さ れ た ファイル を 指定 し て ください 。 
実際 に 試し て は い ませ ん が 、 With rs For r = 2 To Range (" A " & Rows . Count ). End ( xlUp ). Row . AddNew . Fields (" 商品 コード "). Value = Range (" A " & r ). Value . Fields (" 商品名 "). Value = Range (" B " & r ). Value . Fields (" 商品 区分 "). Value = Range (" C " & r ). Value . Fields (" 単価 "). Value = Range (" D " & r ). Value . Update Next r End With として み て 下さい 。 
フィールド の データ型 は テキスト 型 に なっ て い ます か ？ 
セル の 書式 が 「 標準 や 数値 」 で は 一部 色付け は でき ませ ん 。 どうしても という 事 なら 書式 を 「 文字列 」 に する ぐらい でしょ う か 。 
Active Cell の 扱い が 悪い の だ と 思い ます 。 実行 する 時 Active セル は どこ でしょ う か 。 Active Cell と は Ａ 1 セル でしょ う か ？ ここ に 検索 し たい 名前 を 入れ て い て 、 Ｂ 1 に 件数 だっ たら Dim i As Long , cnt As Long For i = 7 To Cells ( Rows . Count , 1 ). End ( xlUp ). Row If Cells ( i , 1 ) = Active Cell . Value Then cnt = cnt + 1 End If Next i Cells ( 1 , 2 ) = cnt 
IIS 上 で 実行 さ れる アプリケーション が どの ユーザー として 実行 さ れる か は 認証 の 設定 によって 異なり ます 。 この ユーザー が SQL へ の アクセス 権 を 持っ て い なけれ ば 当然 アプリケーション は SQL へ 接続 する こと は でき ませ ん 。 デバッグ 環境 で は アプリケーション は デバッガ を 実行 し て いる ユーザー （ つまり あなた ） として 実行 さ れ ます 。 あなた は きっと SQL へ の アクセス 権 を 持っ て いる ので 、 デバッグ 環境 で は SQL に 接続 できる の でしょ う 。 IIS 上 で アプリケーション を 実行 する ユーザー の 設定 方法 は 以下 で 説明 さ れ て い ます 。 IIS 7 で 認証 を 構成 する https :// technet . microsoft . com / ja - jp / library / cc 733010 ( v = ws . 10 ). aspx 匿名 ユーザー や 認証 済み ユーザー 用 の アカウント を 設定 し て 、 その ユーザー に対して SQL の アクセス 権 を 与えれ ば 接続 できる よう に なる と 思い ます 。 IIS と SQL が 別 の サーバー で ある 場合 は 、 アプリケーション 実行 用 の ユーザー は ローカル アカウント で は なく ド メインアカウント で なけれ ば いけ ませ ん 。 ドメイン が 構成 さ れ て い ない 場合 は 、 SQL へ の 接続 を Windows 統合 認証 で は なく 、 SQL 認証 に する の も ひとつ の 手 です 。 
# 試験 用 ファイル 生成 ： テキ トー な 連 番 ファイル 生成 # for ($ z = 1 ;   $ z   - le   22 ;   ++$ z ){    new - item   - type   " file "   - name   (""+$ z +"_ A . txt ") } # ファイル 名   先頭 の 数値 で 比較 する 整列 # ls   *_ A . txt   |   sort   {   if ($_. Name   - match   "^\ d +"){    [ int ]$ Matches [ 0 ]   } else {$_. Name }   }   |   `    select   - last   1   |   %{$_. FullName } 
マクロ で あれ ば 出来 ます 。 社員 名簿 と 選択 入力 する の が 同じ シート で 、 入力 を 仮に Ｅ 1 セル と し ます 。 シート モジュール に この イベント マクロ を 書い て おけ ば 、 Ｅ 1 で 選択 し た 時 、 自動 で 該当 行 の Ａ 列 が 選択 さ れ ます 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim wrow As Variant If Target . Count <> 1 Then Exit Sub If Target . Address <> "$ E $1 " Or Target . Value = "" Then Exit Sub wrow = Application . Match ( Target . Value , Range (" A1 : A5 00 "), 0 ) If IsError ( wrow ) Then MsgBox " 該当 データ が ありません " Exit Sub End If Range (" A " & wrow ). Select End Sub 
エクセル で は ＶＢＡ の 事 を マクロ と 呼ん で い ます 。 
こういう ケース は 、 コード を 記載 する と 解決 が 速い です よ 。 まずは 、 ダメ だっ た コード を 記載 し て み て ください (^_^) 
MonthView コントロール の こと は 判ら ない の です が 日付 . Value = DateClicked として み て も ダメ です か ？ 
A 2 の セル が 任意 の 伝票 番号 の 入力 セル として A3 の セル に = IF ( B 3 ="","", IF ( B2 <> B 3 , A 2+1 , IF ( MOD ( COUNTIF ( B $2 : B 3 , B 3 ), 4 )= 1 , A 2+1 , A 2 ))) A3 の セル を 下 に コピー 
For i = 1 To dat e2 - date 1 - 1 Active Cell . EntireColumn . Insert Active Cell . Value = Active Cell . Offset (, - 1 ) + 1 Active Cell . Offset (, 1 ). Activate Next End If Loop ↓ For i = 1 To dat e2 - date 1 - 1 Active Cell . EntireColumn . Insert Active Cell . Value = Active Cell . Offset (, - 1 ) + 1 Active Cell . Offset (, 1 ). Activate Next Else Active Cell . Offset (, 1 ). Activate End If Loop 
KeyPress イベント を 使用 すれ ば 押し た キー に 対応 し た 文字コード の 判定 が でき ます 。 http:// dobon .net / vb / dotnet / control / tbsuppressbeep . html http:// dobon .net / vb / dotnet / control / numerictextbox . html 
以下 で どうでしょう Dim list ( 2 , 2 ) As String Dim i As Long list ( 0 , 0 ) = " あ " list ( 0 , 1 ) = " い " list ( 0 , 2 ) = " う " list ( 1 , 0 ) = " か " list ( 1 , 1 ) = " き " list ( 1 , 2 ) = " く " list ( 2 , 0 ) = " さ " list ( 2 , 1 ) = " し " list ( 2 , 2 ) = " す " For i = 0 To 2     Cells ( i + 1 , " A "). Value = _        Join ( WorksheetFunction . Index ( list , i + 1 , 0 ), ",") Next 
Sub 昇順 の 場合 () Dim rng As Range For Each rng In Range (" A 2 ", Cells ( Rows . Count , 1 ). End ( xlUp )). SpecialCells ( xlCellTypeConstants ). Areas With rng . Current Region .S ort Key 1 :=. Columns (" E "), Order 1 := xlAscending , Header := xlNo End With Next rng End Sub Sub 降順 の 場合 () Dim rng As Range For Each rng In Range (" A 2 ", Cells ( Rows . Count , 1 ). End ( xlUp )). SpecialCells ( xlCellTypeConstants ). Areas With rng . Current Region .S ort Key 1 :=. Columns (" E "), Order 1 := xlDescending , Header := xlNo End With Next rng End Sub 
こんばんは (^_^) アクティブ ブック へ の コピー で 良かっ た ん です ね 。 つまり 、 「 産廃 用 見積 書 呼出 」 プロシージャ は この コピー 先 の ブック に ある と 。 で あれ ば 、 Workbooks (" 新規 ファイル . xlsm ") を ThisWorkbook に 変更 すれ ば 解決 です 。 
その よう な 指定 は でき ませ ん 。 一 例 です 。 Sub sample 1 () Dim sh As Worksheet For Each sh In Worksheets If sh . Name Like "* 日 " Then sh . Range (" A 2 "). ClearContents Next End Sub 
例えば form １ に テキストボックス が 有っ て 、 その 値 を 取っ て くる 方法 と まったく 同じ です 。 
掲載 さ れ た コード は ちゃんと 動作 する よう です よ 。 少なくとも エラー に は なり ませ ん 。 リンク 先 ページ の 内容 について は 未確認 です 。 
Excel の 話 です か ？ Access の 話 です か ？ もし Excel の 話 だ と する と 、 Excel VBA で は DoCmd は 使え ませ ん 。 下記 の サイト を 参考 に し て ください 。 複数 の UserForm で データ を 受け 渡す http:// office tanaka .net / excel / vb a/t ips / tips 113 . htm 
端的 に 言う と ExcelCreator は 「 Excel ファイル を 新しく 作る 」 ため の ツール で 、 VBReport は 、 帳 表 レイアウト の 印刷 を 行う プログラム を 簡単 に 作る ため の の ツール です 。 
何 か 手順 が 間違っ て い ませ ん か ？ 数式 バー で 数字 部分 だけ ドラッグ し て おい て 、 下付き で 出来 ます が 。 ＶＢＡ は もう 一方 の 質問 で 回答 し ます 。 
質問 内容 が よく 分かり ませ ん 。 ① SQL . Append の 「 SQL 」 変数 は 、 Dim SQL As System . Text . String Builder と 宣言 し て いる か と 思い ます が 、 SQL . Append (" WHERE " & vbNewLine ) と 「 &」 で 結合 せ ず 、 SQL . Append (" WHERE "). Append ( vbNewLine ) と し た 方 が 良い です 。 ② SQL . Append (" BI . ADDRESS IN ( DBDATA _ 1000 . AA _ CODE ) ") は 、 単なる 文字列 の 結合 な ので 、 If strNo = " 1 " Then SQL . Append (" BI . ADDRESS IN ( DBDATA _ 1000 . AA _ CODE ) ") End If という よう に 、 IF で 条件 によって 内容 を 変える こと も 出来 ます 。 ③ 「 データ を 入れる 」 と は どの よう な 意味 か 分かり ませ ん が 、 他 の テーブル に インサート する こと で あれ ば 、 DB の 種類 や 接続 方法 によって 記述 は 変わり ます 。 ＤＢ や テーブル の 仕様 が 全く 分から ない ので 、 サイト で 検索 し て 、 自分 の 使っ て いる 環境 に 応じ た 記述 方法 を 調べ て 下さい 。 
言葉 の 意味 を いくら 深め て も 、 プログラム は 組め ませ ん 。 具 的 な ソース だけ を 見 て 意味 を 考え て ください 。 主 に 、 フレームワーク で 使用 し ます 。 逆 に 、 フレームワーク に 用が ない なら 使わ なく て も いい の で は ない でしょ う か 。 
Select Case target . Column ' 1 列 目 の 場合 Case 1 ↓ Select Case target . Column ' 1 , 3 , 5 列 目 の 場合 Case 1 , 3 , 5 
① InStr ( hrml . response Text , """"" data - ylk ="" slk : history ; pos : 0 ""> 時系列 </ a ></ li >""") = 0 ② と ③ Dim bk As Workbook , b As Worksheet Set bk = Workbooks . Add If Not b Is Nothing Then Set b = bk . Worksheets ( 1 ) End If 
Drop Down 16 という の は 、 ActiveX コントロール で 作成 し た コンボボックス の 名前 という 理解 で 合っ て い ます か 。 この コード で 、 I 8 と P2 6 セル に関して は 出来 て いる の でしょ う か 。 エクセル の バージョン が 違う から かも しれ ませ ん が 、 やっ て み た ところ 実行 さ れ ませ ん でし た 。 回答 で ない のに すみません 。 回答 が 出 て い ない ので 、 やっ て み た の です が 。 
具体 例 を もっと 詳しく 教え て ください 。 抽象 的 な ので 、 やり たい 事 が 、 よく 分かり ませ ん 。 
具体 的 に 、 例 を あげ て 説明 し て ください 。 抽象 的 で 、 やり たい 事 が 、 良く 分から ない です 。 
si _ kun 117 さん の 回答 に 補足 し ます 。 C# と VB . Net で 書か れ た プログラム で 使っ て いる フレームワーク は 完全 に .NET Framework しか あり ませ ん 。 C# も Visual Basic も Microsoft が Windows 上 で 動作 する アプリ を 念頭 において 開発 し た 言語 だ から です 。 世の中 に は Microsoft 以外 から 出 て いる C# コンパイラ や Basic コンパイラ も 存在 し ます が 、 シェア 的 に は ほぼ Microsoft が 独占 し て い ます 。 一方 、 JavaScript で 使っ て いる フレームワーク は ？ と 聞か れ た 場合 、 厳密 に は フレームワーク で は ない の です が 「 JQuery 」 が そう だ 、 と 言っ て いい と 思い ます 。 
テーブル DBADD CODE , KUBUN , DATA 100 , 120 , 11 100 , 120 , 12 と ２ 件 の レコード なら 取得 できる か と 思い ます が 、 その 点 は どう なっ てる の でしょ う か ？ ↓ IN 句 を 用い た 副 問合せ http:// www .s ql - reference . com / select / subquery _ in . html 
下記 は ColorDialog を 表示 し て 、 選択 し た 色 の RGB 値 を 個別 に 取得 する 例 です 。 Dim r As Byte , g As Byte , b As Byte With ColorDialog 1 If .S howDialog ( Me ) = Windows . Forms . DialogResult . OK Then r = . Color . R g = . Color . G b = . Color . B End If End With ColorDialog の Color プロパティ の 型 は Color クラス です 。 Color クラス に は それぞれ Byte 型 の R , G , B プロパティ が あり 、 色 の RGB 値 を 取得 または 設定 出来 ます 。 なお 、 Color クラス に は RGB の 他 に Byte 型 の A プロパティ が あり 、 これ は 色 の 透明度 を 表し ます 。 
正式 版 は まだ リリース さ れ て い ない よう です 。 これ まで の 例 から いく と 、 正式 版 を インストール する 際 は 事前 に プレビュー 版 を アンインストール し て おく こと が 推奨 さ れ て い ます 。 
こんにちは。 示し て いる コード は 、 全体 の 一部 だけ です よ ね 。 確認 が 必要 な の は 、 bat ファイル の 実行 によって 、 処理 さ れ て いる こと が 、 正しく ない 、 という 可能性 です 。 変換 さ れ た ファイル の 確認 は 、 メモ帳 で し て ください 。 innerhtml に 、 何 回 も 上書き し て いる 動作 の コード で は 、 確認 でき ませ ん 。 変換 後 の データ が 1 件 でも 数 件 あっ て も 、 最後 の データ しか 、 書き込み し ませ ん 。 この 方式 で やり たい の でし たら 、 readall の よう な 、 全部 読み込み さ せ て ください 。 
２ ０ ０ 行 で テスト し て み まし た が そのよう な こと は 起こり ませ ん でし た 。 色 を 付ける 前 に 色 を リセット し て み て は どうでしょう か ？ テスト の 繰り返し で 色 の 残骸 が 残っ た の かも しれ ませ ん 。 また FIND は 遅い 、 という の は 確か です が http:// excel - ubara . com / excelvba 4 / EXCEL 225 . html ２ ０ ０ 行 で 差 が でる と は 考え られ ませ ん 。 他 の シート で 再 計算 が 起き て いる の で は ？ 重複 数 は 同じ セル に 同じ 色 を 複数回 つける 可能性 が ある ので 改めて いろ の つい た セル を カウント すれ ば いい と 思い ます 。 Sub 重複チェック () Dim RetRange As Range , r As Range Dim i As Long , n As Long Range (" A 2 "). Select Range ( Selection , Selection . End ( xlDown )). Select Selection . Interior . Color Index = xlNone For i = 2 To Cells ( 1 , 1 ). End ( xlDown ). Row Set RetRange = Selection . Find ( What := Cells ( i , 1 ). Value , _ after := Active Cell , LookIn := xlFormulas , _ LookAt := xlPart , SearchOrder := xlByRows , _ SearchDirection := xlNext ) If Not RetRange Is Nothing Then If RetRange . Address <> Cells ( i , 1 ). Address Then RetRange . Interior . Color Index = 6 Cells ( i , 1 ). Interior . Color Index = 6 End If End If Next For Each r In Selection If Not r . Interior . Color Index = xlNone Then n = n + 1 Next MsgBox " 重複 数 は " & n & " 個 でし た " End Sub 
Columns (" A : C "). Cut Destination := Columns (" B : D ") たぶん これ 1 行 で 済む と 思い ます 。 
Selection . PasteSpecial Paste := xl P as teValuesAndNumberFormats , Operation := _ xlNone , SkipBlanks := False , Transpose := False マクロ の 記録 で は こう なり まし た 。 
これ を どこ に 記載 し まし た か ？ ThisWorkbook に 書い て あれ ば 、 正しく 動作 し ます が 。 
この マクロ を 見る 限り Book （ β ） に ある Sheet 1 の 表 に対する コマンド は まったく ありません が ？ 別 の ところ に ある の かも しれ ませ ん が For i = 2 To ThisWorkbook . Worksheets . Count で は この マクロ が 入っ て いる Book （ α ） の シート 数 です よ ね 。 
Win 10 の 場合 ピクチャ に 「 カメラ ロール 」 と 「 保存 済み の 写真 」 と 言う フォルダ は 削除 し て も 自動 で また 作ら れ て しまう よう です が その他 で 作ら れる 現象 は 私 の ＰＣ で は 有り ませ ん 。 もしかして 「 共有 」 の 設定 が さ れ て い て 他人 が 作っ て いる の かも 知れ ませ ん 。 下記 で 「 共有 」 の 解説 が さ れ て い ます 、 調べ て 見 て 下さい 。 Windows 10 で ファイル共有 を 行う 方法 http:// www . as k-m swin . com / win 10 - fileshare / 
＞ 金額 が あっ て いる が 確認 する か 、 意味不明 です 、 文字 を 間違え て い ませ ん か ？ 
トリッキー な 方法 （ この 技 に 意味 が 有る か どう か 不明 ） です が フォーム 内 に フォーム を 表示 する http:// dobon .net / vb / dotnet / form / formwithinform . html 
・ ・ 懐かしい 響き だ 。 
解決 さ れ て まし たら スルー し て ください 以下 の 様 な 処理 は どうでしょう 元々 の データ の 並び を 見る と ・ B 列 の 空白 の 塊 に 注目 し て 、 ・ りんご / みかん は 、 空白 塊 先頭 の １つ 上 ・ 合計 の 値 は 、 空白 塊 最後 の 右 隣 これ を Dictionary で 集計 し て 、 最後 に 集計 内容 を 書き出し > '     dic . CompareMode = vbTextCompare ' ★ この コメント 部分 を 有効 に する と 、 りんご / リンゴ は 同じ もの として 集計 ' ★～ から ' ★～ 間 の ４ 行 で は 、 横 に 書き出し その ４ 行 を コメント に し て 、 ' ★～ から ' ～★ 間 の ４ 行 を 有効 に する と 、 縦 に 書き出し Public Sub Samp 1 ()     Dim dic As Object     Dim rng As Range     Dim sS As String     Set dic = CreateObject (" Scripting . Dictionary ") '     dic . CompareMode = vbTextCompare ' ★     With ActiveSheet        With . Range (" A1 "). Current Region           For Each rng In . Columns ( 2 ). SpecialCells ( xlCellTypeBlanks ). Areas              sS = rng ( 1 ). Offset (- 1 ). Value              dic ( sS ) = dic ( sS ) + rng ( rng . Count ). Offset (, 1 ). Value           Next        End With     End With     If ( dic . Count > 0 ) Then        With Worksheets (" 商品 別売 上 合計 ") ' ★～           With . Range (" A1 "). Resize (, dic . Count )              . Value = dic . Keys              . Offset ( 1 ). Value = dic . Items           End With ' ★～ '           With . Range (" A1 "). Resize ( dic . Count ) '              . Value = WorksheetFunction . Transpose ( dic . Keys ) '              . Offset (, 1 ). Value = WorksheetFunction . Transpose ( dic . Items ) '           End With ' ～★        End With     End If     Set dic = Nothing End Sub 
この アカウント で 過去 に は うまく いっ て い た の でしょ う か ? 他 の アカウント は 同じ サーバ に PASV 接続 で 問題 ない の でしょ う か ? > ダウンロード の ため に ホスト 202 . 181 . 97 . 23 ( 61163 ) に 接続 し て い ます . > ダウンロード の ため に ホスト 202 . 181 . 97 . 23 ( 56413 ) に 接続 し て い ます . > ダウンロード の ため に ホスト 202 . 181 . 97 . 23 ( 60251 ) に 接続 し て い ます . このへん の ポート を サーバ の ファイアウォール で 開け て ない から じゃ ない です か ? FTP を PASV で 使う なら 、 ftpd が データ ストリーム を 待ち受ける 範囲 の ポート は 全開 に する 必要 が あり ます 。 通常 は 49152 ～ 65534 です 。 
任意 . password = "" の 前 に 任意 .S aved = False を 入れ て み て ください 。 
URL しか 情報 が ない の でし たら 、 確実 に 作業 する 方法 は 手作業 しか ない と 思い ます 。 結果 は 保証 でき ない です が 、 VBA で 自動 化 できる 方法 を 以下 に 記載 し て おき ます 。 方法 1 も 2 も 、 スクレイピング という 技術 を 使い ます 。 < 方法 1 > 企業 の ホームページ の 場合 、 ほとんど の 場合 は タイトル が 会社 名 に なっ て いる と 思い ます 。 これ を 利用 し て 、 企業 ホームページ から タイトル を 抽出 する 。 ただし 、 タイトル が 会社 名 で ない 場合 や 宣伝文句 など の 余計 な 文言 が 入っ て いる 可能性 が あり ます 。 < 方法 2 > 企業 の URL を 使っ て 、 以下 の サービス など を 利用 し て ドメイン検索 し て 登録者 名 を 抽出 する 。 http:// tech - unlimited . com / whois . html 方法 1 より は 確実 です が 、 法人格 や 社名変更 が 反映 さ れ て い ない 可能性 が あり ます 。 また 、 中小企業 など の 場合 は 、 ホームページ を もっ て い て も ドメイン を もっ て い ない 場合 も ある かも しれ ませ ん 。 
3 の 作業 が はっきり 定義 できる なら ば 、 パソコン の 操作 を 記録 する ソフト を 使っ て みる と 良い かも しれ ませ ん 。 UWSC なんか の 自動化 スクリプト だ と 、 より 柔軟 な 対応 が 可能 かも しれ ない です ね 。 スクリプト を 作っ て おい て 、 CAD ソフト の 外部 メニュー や Office の メニュー を カスタム し て ユーザ コマンド として 呼び出せる よう に し て おけ ば 、 労力 も ぐっと 減り ます 。 
内容 的 に Excel の オート フィルタ 機能 や データベースクエリ で 対応 でき そう です が 、 いかが でしょ う か ？ マクロ で 一 から 作ら なく て も 、 それら で スピードアップ が 見込める の で は ない でしょ う か ？ 
プロジェクト の 種類 が 「 クラス ライブラリ 」 に なっ て い ませ ん か ？ 
Visual Studio に は フォーム デザイナ が あり ます 。 フォーム に ボタン を 貼っ て 、 その ボタン を ダブルクリック すれ ば 、 自動的 に クリック イベントハンドラ が 作成 さ れる ので 、 その 中 に メソッド 呼び出し 処理 を 書け ば いい です 。 クリック イベント 以外 の 場合 は 、 コントロール を 選択 すれ ば プロパティ ウィンドウ に その コントロール の プロパティ 一覧 が 表示 さ れ ます が 、 イベント 一覧 も 表示 でき ます 。 処理 し たい イベント を ダブルクリック すれ ば 、 その イベントハンドラ が 自動的 に 作成 さ れ ます 。 イベント と デリゲート について の 詳細 は 、 MSDN を ご覧 に なっ て 下さい 。 https :// msdn . microsoft . com / ja - jp / library / edzehd 2t ( v = vs . 100 ). aspx 
> snnh 79 さん > お手数 です が 、 ヒント でも 結構 な ので 教え て いただける と 助かり ます 。 基礎 を やら ず に ヒント を もらっ て も 仕方 が 無い ので 、 自作 する の なら 基礎 から 学習 し て いく と 良い と 思い ます 。 
例えば " C :\ sample \ Boo k2 . xlsx " に Sheet 2 を 追加 する なら 、 最後 の 「 End Sub 」 の 前 に 以下 を 追加 し て み て ください 。 Workbooks . Open " C :\ sample \ Boo k2 . xlsx " ThisWorkbook .S heets (" Sheet 2 "). Copy After := Workbooks (" Boo k2 . xlsx "). Sheets ( Workbooks (" Boo k2 . xlsx "). Sheets . Count ) ActiveWorkbook . Close True 
以下 の コード で 出来 ます 。 Option Explicit Sub 翌月 処理 () Dim rng As Range For Each rng In Range (" C4 ： C3 5 "). SpecialCells ( xlCellTypeConstants , xl Numbers ) rng . Value = rng . Value + 1 Next rng Range (" A1 "). Select End Sub Range オブジェクト の SpecialCells ( xlCellTypeConstants , xl Numbers ) を 用いる と 数字 が 入っ た セル だけ を 抽出 する こと が 出来 ます 。 
workbook モジュール で セル 変更 を 検知 する イベント プロシージャ が ある ので 、 それ を 使え ば 、 どの 文字 が 入力 さ れ た か を 取得 でき ます 。 あと は select か if を 使っ て 、 それぞれ の 文字 に 対応 する オートシェープ を 指定 の セル に コピペ する 処理 を 行え ば いい と 思い ます 。 コピペ 処理 の コード は 、 マクロ の 記録 を 使え ば すぐ に わかる でしょ う 。 参考 ＵＲＬ http:// vba - geek .jp / blog - entry - 224 . html 
以下 で どう なり ます か > 一つ 下 の セル と 数値 又は 文字 が > ・ 一緒 で あれ ば 選択 セル の 文字 を 青 に > ・ 違え ば 選択 セル の 文字 を 赤 に > する という 条件 付き 書式 これ は 、 どちら か 一方 で 良い ん です よ ね 範囲 が わから ない ので 、 選択 し た 範囲 という こと で 式 を 作る 時 に は 、 範囲 の 左上 セル の 位置 を 基本 に 設定 すれ ば ･･･ 以下 処理 で は 、 範囲 指定 さ れ た １つ 目 の セル 位置 の アドレス と 、 その １つ 下 の アドレス で ････ 例えば 、 A1 : D2 0 を 範囲 指定 し て い た と する と 、 "= A1 = A 2 " という 文字列 を 作っ て 条件 付き 書式 を 設定 し ます 条件 付き 書式 は ・ １ 度 きれい に し て ・ 追加 し て ・ その 内容 を （ 以下 で は 、 = なら 、 文字 色 を 赤 に ） = では なく 、 違っ たら ･･･ なら >     Const CF As String = "={% 1 }={% 2 }" ↓     Const CF As String = "={% 1 }<>{% 2 }" Public Sub Samp 1 ()     Dim sS As String     Const CF As String = "={% 1 }={% 2 }"     With Selection        sS = Replace ( CF , "{% 1 }", . Cells ( 1 ). Address ( False , False ))        sS = Replace ( sS , "{% 2 }", . Cells ( 1 ). Offset ( 1 ). Address ( False , False ))        With . FormatConditions           . Delete           With . Add ( xl Expression , , sS )              . Font . Color Index = 3           End With        End With     End With End Sub 
D1 は = IF ( B 1 > C1 ,"●","") これ だけ で いい と 思い ます が 。 
> 上手く 行き ませ ん 。 上手く 行か なく て どう なる の でしょ う ？ 
> ブック を 開か ず に なぜ か は わかり ませ ん が 、 やり たい こと を やる に は それなり の スキル が 必要 です 以下 参考 に でも なれ ば 複数 の エクセル ブック の 特定 シート ・ 特定 行 を 、 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1315909913 ... ※ P2 00 ～ P2 50 の 行 / 列方向 変換 する 際 に は 、 WorksheetFunction . Transpose 使え ば ･･･ 
>> VB 6 で 実現 可能 か 教え て 欲しい です 。 この 質問 に 回答 する よう な 人間 にとって は 可能 でも 、 こんな 質問 を 何 の 進歩 も なく 繰り返し 聞く よう な お前 にとって は 無理 だろ う ね 。 諦めよ う や 。 
こちら など は スピードアップ に 成功 し た よう です 。 http:// q . hatena . ne.jp / 1377926475 無駄 に 配列 に 入れる ため に レコード 数 を 取得 、 この ため より 速い と 思わ れる 「 前方 スクロール カーソル 」 が 使え ませ ん ね 。 データ 数 が 多く て 、 レコード 数 を 取得 する 必要 が ある 場合 に あらかじめ Select Count ("*") ・ ・ ・ で 取得 し て から 、 改めて 「 前方 スクロール カーソル 」 で レコードセット を 取得 し た 方 が 速かっ たり し ます 。 まあ 今回 は ダイレクト に リスト ボックス に 設定 すれ ば レコード 数 を 得る 必要 が ない わけ です から 。 複数 列 の リスト の 追加法 は ヘルプ に も あり ます が AddItem し た のち に List を 編集 する 、 という 表現 で いい の か な ？ 例 は こちら 。 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1116097975 ... adOpenForwardOnly , adLockReadOnly で レコードセット を 開い て 確認 し て み て ください 。 あと 、 こんな の も あり ます ね 。 ループ 内 で は フィールド を 参照 し ない 方 が よい ？ http:// tsware .jp / labo / labo _ 12 . htm 
主 様 、 さき の 質問 に ある よう な 、 6時間 の 計算 の url を 計算 し たい の で は ？ ？ mm に 、 時間 を 計算 し たら 、 v2 = dateadd (" H ", 6 , mm ) ' 6時間 後 を 計算 v3 = format ( v2 ," yyyymm ") & "/" & format ( v2 , " mm ") & ". jpg " ' 200110 / 2001103118 .jpg b () = Inet 1 . OpenURL (" http:// ***/" + " yy " + "/" + " mm " + ". jpg ", icByteArray b () = Inet 1 . OpenURL (" http:// ***/" & v3 , icByteArray この コード で 、 主 様 の やり たい こと 、 でき ませ ん か 。 あ 、 yy と いっ たら 、 普通 、 2016年 の 16 の こと を 指し ます 。 しかし 、 ダブル クォーツ に なっ て いる ので 、 yy の まま です 。 Open する まえ に 、 画面 に 表示 さ せ て ください 。 文字列 の 計算 を 確認 する 、 と 、 ずっと いっ て ます よ 。 
仕様 が いまいち 解っ て い ませ ん が 、 文章 から する と 、 木構造 っぽい 感じ が する ので 、 再帰 プロシージャ とか が 使える よう に 思い ます 。 ループ が 何 重 に も なっ て しまう 感じ が し たら 、 再帰呼び出し に 書き換え られ ない か 、 検討 し て み て ください 。 
そういう の は 普通 SQL 発行 する 前 に VB 側 で チェック し て やる もん だ と 思い ます が 、 どうして もっ て ん なら Try ~ Catch で エラー 番号 ( OracleException の Number プロパティ ) 分岐 してやれ ば 良い ん じゃ ない でしょ う か 。 参考 http:// otndnld . oracle . co.jp / document / products / oracle 10g / 102 / windows ... 
プルダウン という の は データ の 入力 規則 の リスト の こと を 指し て いる の でしょ う か ？ それとも コンボボックス （ ユーザー フォーム ） の こと でしょ う か ？ あるいは コンボボックス （ ActiveX コントロール ） の こと でしょ う か ？ 上記 ３ パターン で それぞれ VBA の 書き方 が 違い ます 。 
こんな かんじ Dim 元 データ as DataTable ' 取得 ロジック は ご 自身 で Dim 先 データ as DataTable ' 作っ て ください 。 For Each MotoRow as DataRow in 元 データ . DataRows Dim Tuika As DataRow = 先 データ . NewRow () Tuika ("◎ COL _ AAA ") = MotoRow ("◎ COL _ AAA ") 先 データ . Rows . Add ( Tuika ) Next MotoRow っていう か 、 ググっ たら 一 発 です 。 http:// hiros - dot .net / VBNET 2005 / Control / DataSet / DataSet 12 . htm 
マクロ で 可能 です 。 こんな 感じ です 。 Sub Sample () Dim wr As Range For Each wr In Selection Range ( wr , wr . Offset ( 0 , 5 )). Interior . Color Index = 6 wr . Offset (- 1 , 0 ). Interior . Color Index = 6 Next wr End Sub 
ご 希望 の 事 は VBA で 可能 です が 、 回答 する にあたって 疑問 点 が あり ます 。 >「①」 に は 外部 から すでに データ が 読み込ま れ て いる 状態 で > E ～ G 列 の リスト も 「 ①」 の 結果 によって > 候補 の 県 を VBA にて 出力 さ せ て おり ます 。 ここ は 既に 完成 し て いる の です ね 。 選択 し た もの は 、 「 1 ： 愛知 」 の よう な 形式 に なっ て い て そこ から 「 ： 」 の 前 の 数字 だけ 取り出せ ば いい の でしょ う か 。 その 部分 だけ の 質問 という 事 で いい です か ？ 
Chart オブジェクト に Refresh メソッド が あり ます 。 ※ ヘルプ で は Refresh メソッド の 説明 に 「 指定 さ れ た グラフ を 直ちに 再 描画 し ます 。 」 と あり ます 。 これ でも 早く なら なけれ ば 、 データ と グラフ を 分ける など 、 作り方 を 変え ない と ダメ かも 。 
Acrobat Reader で は でき ない と 思い ます 。 Acrobat Reader に は 、 基本的 に PDF を 閲覧 以外 の 機能 は あり ませ ん 。 それ 以上 の こと を し たい 場合 に は 、 ちゃんと お金 払っ て Acrobat を 購入 し て ください と いう こと です 。 
下 の 画像 は （ Excel 2016 ) A1 ： 日付 入力 B 1 ：= A1 + 7 C1 ：= B 1 + 1 １ ． A1 : C1 を 選択 ２ ． [ ホーム ] タブ → [ スタイル ] グループ → 条件 付き 書式 → 新しい ルール ３ ． 【 数式 を 使用 し て 、 書式 設定 する セル を 決定 】 ＿＿【= A1 <= TODAY () 】 ＿ ＿ 【 そこ の [ 書式 ] ボタン から 「 塗りつぶし 」 タブ で 赤色 を 指定 】 ４ ． A1 : C1 を 下 に オートフィルコピー と し た もの です 。 
単に 引数 不足 の ため 異常 終了 し て いる だけ ・ ・ ・ という こと は ない です か ？ 「 Unload 」 の 後ろ に 画面 名 が 記載 さ れ て い ない 場合 、 「 Unload UserForm 2 」 と し て み て ください 。 画面 名 の 省略 は でき なかっ た と 思う ので 。 
自分 が 考え た こと ・ 文字列 を １ 字 ずつ 区切り 、 文字列 内 の アルファベット を カウント する p : 1 i : 1 z : 2 a : 1 p : 1 i : 1 z : 1 a : 2 ・ ｎ 、 ｍ から 判断 し て 長い 方 から 短い ほう を 引く p : 1 i : 1 z : 1 a : 2 引く p : 1 i : 1 z : 2 a : 1 ＝ a : 1 自分 は python で やっ た ので ソース # coding : utf-8 import collections #""" s1 = raw _ input (). split (" ") n , m = s1 [ 0 ], s1 [ 1 ] s = raw _ input () t = raw _ input () #""" # test case 1 """ n , m = 5 , 5 s = " paiza " t = " pizza " """ # test case 2 """ n , m = 3 , 5 s = " ant " t = " maven " """ d _ s = collections . Counter ( s ) d _ t = collections . Counter ( t ) if n >= m : d = d _ s - d _ t else : d = d _ t - d _ s lack = 0 for key , value in d.i tems (): lack += value print lack 
例えば 入力 画面 シート の シート モジュール で Private Sub Worksheet _ Deactivate () If Range (" C3 5 "). Value = " 利用 する " And Range (" D3 6 "). Value = "" Then Worksheets (" 入力 画面 "). Activate End If End Sub と する の は いかが でしょ う か ？ 
A 列 に 列 を 追加 し て 、 追加 さ れ た A 列 に 数式 を 設定 する 部分 だけ を 実現 する マクロ です 。 Sub 数式 設定 () Dim ws As Worksheet , r As Long Set ws = Worksheets (" 集計 結果 ") ws . Columns (" A "). Insert For r = 2 To ws . Range (" B " & ws . Rows . Count ). End ( xlUp ). Row ws . Range (" A " & r ). Formula = "= CONCATENATE ( TEXT ( 顧客 一覧 !$ I $12 ,""@""), C " & r & ")" Next r End Sub そもそも 最初 の マクロ で の 数式 設定 は 正常 に 動作 し て い ます か ？ 
Excel ファイル は あなた が 参考 に し て いる ページ の 方法 で は 読み込め ませ ん 。 授業 で 指示 さ れ た の は Excel ファイル です か ？ CSV ファイル です か ？ 
① 開始 No の 入力 位置 は 表 の すぐ 隣 で は なく 、 ひと 列 開け て 列 幅 を 調整 する ② 開始 No 、 終了 No の 上 の 行 に 「 開始 No と 終了 No 」 を 入力 後 、 印刷 ボタン を 押し て ください 」 など の 文言 を 入れる ③ 背景色 を 変える など し て どの セル に 入力 すれ ば よい か が 直感 的 に 判る よう に する など で どうでしょう か 。 
> d1 12k さん 2016 / 6 / 1516 : 29 : 34 > 指定 し た 1つ の CSV ﾌｧｲﾙ から 指定 の 文字 が 含ま れ た の 列 の ﾃﾞｰﾀ のみ 取り込み たい です 。 TODO ? 
Dir 関数 を 使う と ファイル の 存在 を チェック でき ます 。 画像 を どの よう に 表示 し てる の か 不明 です が 、 If Dir (" C :\ sample \ A . xlsx ")<>"" Then ’ あっ た 時 の 処理 End If で 処理 できる と 思い ます 。 
カテ 間違っ て ます よ 。 そい から 質問 が 途中 で ぶったぎれ て ます よ 。 メガーヌ の ブレーキ の 事 なら 自動車 系 の カテ で どうぞ 。 
まず 、 普通に 商品 な んで 無償 は 難しい でしょ う ね 。 現在 は バージョン が 上がっ て １ １ に なっ て いる よう です 。 OS の 対応 や デバッグ で 上がっ て いる ん でしょ う 。 どの 様 な 環境 で 利用 さ れる か 判り ませ ん が 、 最新 環境 を 準備 する 方 が 良い と 思い ます 。 http:// www .s oftec - inc .net / visualshot / 
申し訳ない です が 、 できるだけ やる べき こと を 明確 に し ない と 、 質問 に 答え られる 人 は い ない と 思わ れ ます 。 ＞ 1 . ファイル B は 発注 書 で あり 、 およそ 5 行程 の 入力 欄 が あり ます が 、 全 行 に 記入 さ れ て いる と は 限ら ない ので 空欄 の 分 は 無視 し たい （ ファイル A に 転記 さ れる 時 、 途中 の 空白 を 無くし たい ） 。 上記 で あれ ば 、 下記 の 情報 が ない と 私 で は 答え られ ませ ん 。 ① ファイル B の 「 どの シート 」 の 「 どの 範囲 」 が 必要 な の か 例 ： ファイル B の 「 Sheet 1 」 の 「 A 2 から A6 」 ② ファイル A の 「 どの シート 」 の 「 どこ 」 へ 転記 し たい の か 例 ： ファイル A の 「 Sheet 1 」 の 「 A 列 」 
一番 上 の チェックボックス の クリック イベント に 下記 を 書い て おけ ば いい と 思い ます 。 Private Sub CheckBox 1 _ Click () Dim i As Integer Dim cnt As Integer Dim start As Integer '--------↓ ここ を 変更 --------- cnt = 20 ' チェックボックス の 数 start = 2 ' 一番 上 の リンク セル の 行 '--------↑ ここ を 変更 --------- For i = start + 1 To start + cnt - 1 Range (" C " & i ). Value = Range (" C " & start ). Value Next i End Sub 
DropButtonClick が 多重 に かかる の が 問題 な ので 、 一番 簡単 な の は 、 > Private Sub ComboBox 1 _ DropButtonClick () を Private Sub UserForm _ Initialize () に し て 、 ユーザー フォーム の 初期化 で コンボ の リスト を 更新 する 方法 だ と 思い ます 。 
MID 関数 を 使い ます 。 先頭 の vbTab を 削除 する とき は If Mid ( str , 1 , 1 ) = vbTab Then str = Mid ( str , 2 ) です 。 一応 先頭 の 文字 が vbTab か どう か を 判定 し て から 削除 し た ほう が 安全 です 。 末尾 の vbTab を 削除 する とき は Len 関数 も 併用 し て 以下 の よう に し ます 。 If Mid ( str , Len ( str ), 1 ) = vbTab Then str = Mid ( str , 1 , Len ( str ) - 1 ) 
もしかして 、 yonnkaku . png という 画像 を 別 アプリ で 開い て ませ ん か ？ 排他 が かかっ た 場合 に 出る エラー です 。 画像 に 限ら ず 、 何 か の ファイル を 何 か 別 の アプリ で 使用 中 なんか で 出 ます 。 
その 表示 さ せる ルール さえ 明文化 できれ ば 。 その ルール を VB の 書き方 に 沿っ て 再現 できれ ば 。 簡単 じゃ ない です か ね 。 まず 、 その ルール を 言葉 に し て み ましょ う 。 
２ ） で 実行 を 一時 中断 する の で は なく 、 スペース が でき たら ２ ） の 処理 を 終了 あらためて 、 全 セル が 入力 さ れ たら ３ ） の 処理 を 行う 、 として は どうでしょう か 。 以下 の サンプル です が 、 セル Ａ １ に i （ 行 数 ） 、 セル Ｂ １ に j （ 列 数 ） を 入力 する と 、 セル Ａ ２ 以下 に 入力 欄 を 作成 し ます 。 （ 罫線 を 引き ます ） つぎ に 、 入力 欄 に すべて 入力 さ れ たら 「 計算 処理 」 を 実行 し ます が 、 そこ まで 書か れ て い ませ ん ので MsgBox を 表示 する だけ に し て い ます 。 Option Explicit Dim gyou As Long Dim retu As Long Private Sub Worksheet _ Change ( ByVal Target As Range ) ' セル A1 、 B 1 に 入力 が あっ た 場合 If Not Inter sect ( Target , Range (" A1 : B 1 ")) Is Nothing Then ' 行 数 、 列 数 が 数値 の 場合 If IsNumeric ( Range (" A1 "). Value ) And IsNumeric ( Range (" B 1 "). Value ) Then ' かつ 、 行 数 が 1 ～ 最大 行 数 - 1 、 列 数 1 ～ 最大 列 数 の 範囲 の 場合 If Range (" A1 "). Value > 0 And Range (" A1 "). Value < ( Rows . Count - 1 ) _ And Range (" B 1 "). Value > 0 And Range (" B 1 "). Value < Columns . Count Then ' 入力 欄 の 作成 Application . EnableEvents = False ' 行 数 、 列 数 を 控える gyou = Range (" A1 "). Value retu = Range (" B 1 "). Value ' 一旦 すべて を 削除 Cells . Delete ' セル A 2 から 行 数 、 列 数 分の セル に 枠 線 を 付ける Range (" A 2 "). Resize ( gyou , retu ). Borders . LineStyle = xlContinuous Application . EnableEvents = True Exit Sub End If End If End If ' 入力 欄 が 未 定義 の 場合 は 終了 If gyou = 0 Or retu = 0 Then Exit Sub ' 入力 欄 に 入力 が あっ た 場合 If Not Inter sect ( Target , Range (" A 2 "). Resize ( gyou , retu )) Is Nothing Then ' 入力 欄 が すべて 入力 さ れ た 場合 If Application . WorksheetFunction . CountA ( Range (" A 2 "). Resize ( gyou , retu )) = ( gyou * retu ) Then ' 計算 を 実行 MsgBox " 計算 を 実行 " End If End If End Sub 
Borland で は なく VC だ が c :\ C \ Windows API > type test . rc // test . rc # include < windows . h > test BITMAP " test . bmp " c :\ C \ Windows API > rc test . rc Microsoft ( R ) Windows ( R ) Resource Compiler Version 6 . 3 . 9600 . 17336 Copyright ( C ) Microsoft Corporation . All rights reserved . c :\ C \ Windows API > type test . c // test . c // rc test . rc // cl test . c test . res # pragma comment ( lib ," user 32 . lib ") # pragma comment ( lib ," gdi 32 . lib ") # include < windows . h > # include < windowsx . h > # define CLASSNAME " SKELETON " # define MENUNAME NULL // " MAINMENU " # define MAIN TITLE " LoadBitmap sample " # define CW _ WIDTH 800 // GetSystemMetrics ( SM _ CX SCREEN ) # define CW _ HEIGHT 600 // GetSystemMetrics ( SM _ CYSCREEN ) # define CW _ LEFT CW _ USEDEFAULT //(( GetSystemMetrics ( SM _ CX SCREEN ) - CW _ WIDTH ) / 2 ) # define CW _ TOP CW _ USEDEFAULT //(( GetSystemMetrics ( SM _ CYSCREEN ) - CW _ HEIGHT ) / 2 ) # define BG COLOR RGB ( 0 xff , 0 xff , 0 xff ) LRESULT CALLBACK WndProc ( HWND wh , UINT ms , WPARAM wp , LPARAM lp ) { static BITMAP b ; HBITMAP bh ; static HDC v ; PAINTSTRUCT ps ; HDC d ; switch ( ms ) { case WM _ CREATE : bh = LoadBitmap ((( LPCREATESTRUCT ) lp )-> hInstance ," test "); GetObject ( bh , sizeof ( b ),( LPSTR )& b ); d = GetDC ( wh ); v = CreateCompatibleDC ( d ); SelectObject ( v , bh ); ReleaseDC ( wh , d ); break ; case WM _ PAINT : d = BeginPaint ( wh ,& ps ); BitBlt ( d , 100 , 100 , b . bmWidth , b . bmHeight , v , 0 , 0 , SRCCOPY ); EndPaint ( wh ,& ps ); break ; case WM _ DESTROY : DeleteDC ( v ); PostQuitMessage ( 0 ); break ; default : return DefWindowProc ( wh , ms , wp , lp ); } return 0 ; } int WINAPI WinMain ( HINSTANCE lih , HINSTANCE rih , LPSTR argv , int ws ) { HWND w ; MSG m ; WNDCLASS c ; c . style = ws ; c . lpfnWndProc = WndProc ; c . cbClsExtra = 0 ; c . cbWndExtra = 0 ; c . hInstance = lih ; c . hIcon = LoadIcon ( NULL , IDI _ APPLICATION ); c . hCursor = LoadCursor ( NULL , IDC _ ARROW ); c . hbrBackground = CreateSolidBrush ( BGCOLOR ); c . lpszMenuName = MENUNAME ; c . lpszClassName = CLASSNAME ; RegisterClass (& c ); w = CreateWindow ( CLASSNAME , MAINTITLE , WS _ VISIBLE | WS _ SYSMENU , CW _ LEFT , CW _ TOP , CW _ WIDTH , CW _ HEIGHT , NULL , NULL , lih , NULL ); LOOP : switch ( GetMessage (& m , NULL , 0 , 0 )) { case - 1 : case 0 : return m . wParam ; default : DispatchMessage (& m ); break ; } goto LOOP ; } c :\ C \ Windows API > cl test . c test . res Microsoft ( R ) C/C++ Optimizing Compiler Version 19 . 00 . 23506 for x64 Copyright ( C ) Microsoft Corporation . All rights reserved . test . c Microsoft ( R ) Incremental Linker Version 14 . 00 . 23506 . 0 Copyright ( C ) Microsoft Corporation . All rights reserved . / out : test . exe test . obj test . res Borland の 無料 版 だ と test . bmp は 適当 に 用意 し て ソース と 同じ フォルダ に 入れ て おい て bcc 32 - W test . c brc 32 test . rc で 行ける と 思う が 、 もう Borland は 入れ て い ない ので 確かめ て ない 
シート の 値 と は ？ キチンと 用語 を 使え ない 人 の 質問 に 答える の は 難しい です 。 質問 自体 、 何 が し たい の か よく わから ない 。 自動的 って 何 を する こと を 指し てる の ？ やり直し です なあ 。 こう 書い て も 、 勝手 に 想定 し て 回答 し て しまう 人 が いる の も 問題 な ん だ けど ね 。 
こんな 感じ で OK ですよ。 ・ ・・・・・・・・・・・・ Dim a As Long Sub test () Dim i As Long a = Range (" A1 "). End ( xlDown ) i = InputBox (" 挿入 する 行番号 を 入れ て 下さい 。 ") Range (" A " & i ). Insert Range (" A " & i ). Value = a + 1 End Sub 
大丈夫 です 。 そのまま バグ を 直し て 、 どう 直し た か を 、 ソース に コメント し て ください 。 仕様変更 です が 、 し て は いけ ない という 決まり は あり ませ ん 。 
上記 の 仕様 だ と 売上 台帳 シート に は 上手く 転記 さ れ ませ ん 。 なぜなら 、 入力 し た 「 日付 」 の 値 を A 列 の 最終 行 の ひとつ 下 （ たとえば 3 行 目 ） に 転記 し た あと 、 商品 ID が 未 選択 だっ た と し ます 。 その 時 は メッセージ を 表示 し て マクロ を 中断 する ん です よ ね ？ じゃぁ 、 商品 ID を 選択 し て ボタン を 押し たら 、 入力 し た 日付 は A 列 の 最終 行 の ひとつ 下 です から 4 行 目 に 転記 さ れ ます よ ね ？ 次 の 商品 ID は B 列 の 最終 行 の ひとつ 下 です から 3 行 目 が に 転記 さ れる こと に なり ます 。 本来 は 行 を 揃え て 転記 し たい はず な のに 、 4 行 目だっ たり 3 行 目だっ たり 、 入力 エラー が 発生 する たび に 入力 さ れる 行 が ずれ て いっ て しまい ます 。 この 仕様 を 考え た 人 に その 旨 を 伝え て 、 もう一度 仕様 を まとめ 直し て もらっ て 下さい 。 
色 の 合成 の 基本 は RGB 各 要素 （ 赤 、 緑 、 青 ） の 足し算 です 。 ただし 実際 に は 質感 を 表現 する ため に カラー バランス を 調整 し たり 、 輝度 （ A ） を 加減 し たり とか の 処理 を 追加 する 必要 が ある かも しれ ませ ん 。 
その フォーム の コード は これ だけ でしょ う か ？ コード を すべて 入れ なおす しか ない です 。 その フォーム の 全 イベント コード を メモ帳 に 退避 し 、 その フォーム の 全 イベント コード を 一旦 すべて 削除 し て フォーム を 上書き し ます 。 （ この 時点 で イベント コード は 何 も ない ） その後 、 １つ ずつ イベント コード を 各 コントロール の イベント から 作成 し 、 中身 は メモ帳 から 貼り 付け て 再現 し ます 。 これ でも エラー が 再現 する なら 、 フォーム 自体 を 一旦 削除 し 、 再 作成 する しか あり ませ ん 。 
Sub 登録 _ 終了 () Dim rngx As Range , rng As Range , i As Long , xFilename Const xCpy 1 As String = " D3 , D 5 , E 5 , F5 , D 7 , E 7 , F 7 , I 7 , D 9 , I 9 , D1 1 , I 11 , D1 3 , I 13 , D1 5 , I 3 " xFilename = Application . GetOpenFilename (" Microsoft Excel ブック ,*. xls ?") If Not IsArray ( xFilename ) Then Exit Sub With T hisWorkbook With . Worksheets (" 入力 ") Set rngx = . Range ( cCpy 1 ) With Workbooks . Open ( Filename := xFilename ) With . Worksheets (" 受付 情報 "). Range (" B " & Rows . Count ). End ( xlUp ). Offset ( 1 ) For Each rng In rngx . Offset (, i ). Value = rng . Value i = i + 1 Next rng End With . Close SaveChanges := True End With . Range (" D3 , I 3 , D 5 , F5 , D 7 , F 7 , D 9 , I 9 , D1 1 , I 11 , D1 3 , I 13 , D1 5 "). ClearContents End With . Close SaveChanges := True End With End Sub 未 実行 につき 不具合 ご 容赦 。 
Set w b2 = Workbooks . Open ( ThisWorkbook . Path & "\ 受付 記録 情報 . xlsx " & Filename ) 最後 の 「 & Filename 」 が 余計 です 。 一応 、 宣言 なし の 変数 を 付け て いる だけ な ので 、 動作 する か も しれ ませ ん が 、 混乱 する だけ な ので 削除 し た 方 が 良い でしょ う 。 さて 、 原因 です が 、 Cells の 括弧 内 が 「 ""」 で 囲ま れ て しまっ て い ます 。 これ で は 、 囲ま れ た 部分 を 文字列 として 指定 し て いる こと に なる ので 、 文法 エラー と なり ます 。 「 ""」 は 取り除い て ください 。 
Node . Checked = False と すれ ば Node オブジェクト の チェック を 外す こと は 出来 ます 。 Node の 子 Node の チェックボックス を 外す の で あれ ば For Each node In Node . Nodes node . Checked = False Next node で 出来 ます 。 他 に は どんな こと が 効き たい の でしょ う か ？ 
下記 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st 2 As Worksheet Dim r1 As Long , r2 As Long Dim msk As Integer , dgw As String Dim a d1 As Integer , a d2 As Integer , a d3 As Integer , a d4 As Integer Set st 1 = Worksheets (" IP 一覧 ") Set st 2 = Worksheets (" ルーティング 設定 ") st 2 . Cells . Clear r2 = 1 For r1 = 2 To st 1 . Range (" O " & st 1 . Rows . Count ). End ( xlUp ). Row ' サブネットマスク を 取得 し て おく msk = st 1 . Range (" W " & r1 ). Value ' デフォルトゲートウェイ を 取得 し て おく dgw = st 1 . Range (" X " & r1 ). Value ' 第 1 オクテット を ループ する For a d1 = st 1 . Range (" O " & r1 ). Value To st 1 . Range (" P " & r1 ). Value ' 第 2 オクテット を ループ する For a d2 = st 1 . Range (" Q " & r1 ). Value To st 1 . Range (" R " & r1 ). Value ' 第 3 オクテット を ループ する For a d3 = st 1 . Range (" S " & r1 ). Value To st 1 . Range (" T " & r1 ). Value ' 第 4 オクテット を ループ する For a d4 = st 1 . Range (" U " & r1 ). Value To st 1 . Range (" V " & r1 ). Value ' ルーティング 設定 シート へ 書き出す st 2 . Range (" A " & r2 ). Value = a d1 st 2 . Range (" B " & r2 ). Value = a d2 st 2 . Range (" C " & r2 ). Value = a d3 st 2 . Range (" D " & r2 ). Value = a d4 st 2 . Range (" E " & r2 ). Value = msk st 2 . Range (" F " & r2 ). Value = dgw r2 = r2 + 1 Next a d4 Next a d3 Next a d2 Next a d1 Next r1 End Sub 
一旦 2 列 に 分割 し て 、 再度 文字 を 連結 し なおし て いる 例 です 。 一時的 に 、 A , B 列 が 挿入 さ れ ます 。 オート フィル は 、 10 行 と し まし た 。 Sub sample () With Range (" A1 ") . Resize (, 2 ). EntireColumn . Insert . Offset (, - 2 ). Resize (, 2 ). Value = Split (. Value , ".") End With With Range (" A1 : B 1 ") . AutoFill Destination :=. Resize ( 10 ), Type := xlFillDefault For Each rng In . Resize ( 10 , 3 ). Rows rng . Cells ( 3 ). Value = rng . Cells ( 1 ) & "." & rng . Cells ( 2 ) Next rng . EntireColumn . Delete End With End Sub 
普通 の 話 を し ます けど 、 普通 、 トランザクション って 1 件 の 追加 ごと じゃなくて 、 複数 処理 の 結果 に対して 掛け ませ ん か ？ だから For id as Interger = 0 Try Catch ex as OracleExcption Catch ex as Exception End Try Next id oTran . Commit () みたい な 感じ です 。 個人的 に は 、 例外 出 たら 全体 を キャンセル する （ ＝ Rollback ） の が 正しい と 思う ん です けど ね 。 まぁ 、 処理 による っ ちゃ 、 よる ん でしょ う が 。 で 、 本題 。 ループ の 途中 で 例外 を 拾っ て Commit の 実行 を 判断 し たい 。 の で あれ ば For id as Interger = 0 Try ( insert ) oTran . Commit () Catch ex as OracleExcption oTran . Rollback () Catch ex as Exception oTran . Rollback () End Try Next id こんな 感じ でしょ う 。 近年 の プログラミング で あれ ば 処理 の 途中 で 別 の ところ に 飛ばす の で あれ ば 処理 ごと 別 に 切り分け 関数 化 し ます よ ね 。 同じ プロシージャ の 中 で 分岐 さ せる の で あれ ば 、 エラー から 飛ぶ の で は なく 、 エラー 処理 が 終わっ た 時 に 次 の 処理 に そのまま 進む 。 の が 正しい 。 今回 は 1 ループ ごと に SQL を 発行 さ せ エラー が 出 たら そのまま 次 の 行 に 行き たい の で あれ ば 、 ループ の 中 で エラー を 処理 する しか ない 。 
フォーム に TextBox 1 と Button 1 と Time r1 が ある 場合 です 。 Public Class Form 1 Private counter As Decimal Private Sub Form 1 _ Load ( sender As Object , e As EventArgs ) Handles MyBase . Load Button 1 . Text = " start " Time r1 . Interval = 100 End Sub Private Sub Time r1 _ Tick ( ByVal sender As Object , ByVal e As System . EventArgs ) Handles Time r1 . Tick counter += 0 . 1 TextBox 1 . Text = counter End Sub Private Sub Button 1 _ Click ( sender As Object , e As EventArgs ) Handles Button 1 . Click If Button 1 . Text = " start " Then Button 1 . Text = " stop " counter = 0 Time r1 . Enabled = True Else Button 1 . Text = " start " Time r1 . Enabled = False If counter = 8 Then TextBox 1 . Text = " クリア " Else TextBox 1 . Text = " 失敗 " End If End If End Sub End Class 
シート の 内容 が よく わから ない ので 、 とりあえず 、 省略 抜き の 書き方 で 。 Private Sub 入力 _ Click () Dim fm As Object Dim monthcolum As Long Set fm = ActiveSheet . Range (" A3 : R3 "). Find ( What := me. text bo x1 . Value , LookAt := xlWhole ) If fm Is Nothing Then MsgBox " 月 が 正しく ありません " Exit Sub Else monthcolum = fm . Column ～ 
あなた が 意図 し て いる 「 該当 セル 」 という の は シート １ と 休日 シート の どちら を 指し て いる の でしょ う か ？ 
Me ! btn 1 . Enabled = (( Me ! txt 1 . Value = Null And Me ! tx t2 . Value = Null And Me ! tx t3 . Value = Null ) = false ) これ で 行ける はず 。 条件 式 の 結果 は True / False で 帰っ て くる こと が 理解 できれ ば 行ける はず 。 今回 、 ボタン が 押せ ない の は 全て が Null の 時 だ から 、 条件 式 は 「 全て が Null で は 無い 時 」 のみ 利用 可能 ＝ True に なる よう な 式 を 書け ば いい 。 
マクロ の 記録 を 改変 し た だけ です 。 Sub test () Dim rngY As Range Dim rngX As Range Set rngY = Sheets (" sheet 2 "). Range (" A 2 : D2 ") Set rngX = Sheets (" sheet 2 "). Range (" A1 : D1 ") With ActiveSheet . ChartObjects . Add ( 50 , 50 , 300 , 200 ). Chart . HasTitle = True . ChartType = xlLineMarkers .S etSourceData Source := rngY . Location Where := xlLocationAsObject , Name :=" sheet 2 " . Axes ( xlCategory ). AxisBetweenCategories = False .S eriesCollection ( 1 ). XValues = rngX End With End Sub あまり 綺麗 で は ありません が 、 実行 に は 支障 ない と 思い ます が どうでしょう か ？ 
Book 1 の Sheet 1 、 セル ： A1 が 変換 対象 。 Boo k2 の Sheet 1 の A1 セル に 変換 前 の 文字 B 1 セル に 置換え 後 の 文字 が 入力 さ れ て いる もの と し ます 。 Sub sample () Dim rng As Range Set rng = Workbooks (" Boo k2 . xlsx "). Worksheets (" Sheet 1 "). Range (" A1 ") With Workbooks (" Book 1 . xlsx "). Worksheets (" Sheet 1 "). Range (" A1 ") . Value = Replace (. Value , rng . Value , rng . Offset (, 1 ). Value ) End With End Sub 
With . Range (. Cells ( 2 , 2 ), . Cells ( Rows . Count , 2 ). End ( xlUp )). SpecialCells ( xlCellTypeConstants ) 上記 の コード で 可能 かも しれ ませ ん 。 基本的 に は 、 データ の 有り 無し で 判定 する の が 確実 です から 、 シート の 設計 を 見直し た 方 が 良い と 思い ます 。 
先 ほど 貴方 の 別 の 質問 も 拝見 、 回答 し た もの です 。 まず 、 先ほど リンク つけ て おい た Msgbox の 使い方 ページ に も あり ます が 、 msgbox 関数 として 返り 値 を 求める なら result = MsgBox (" You do not have a mind to do it ?", vbYesNo + vbExclamation , " caution ") で なく て は なり ませ ん 。 （ 質問 文 の コード で は エラー に なる ） なお 質問 の 件 long に関して は 、 msgbox 関数 の 返り 値 が 整数 値 で ある ので 、 integer で も ぶっちゃけ 大丈夫 です 。 そして result = VbYes で 比較 する 際 の VbYes は 定数 として 整数 値 が 与え られ て いる ので 、 比較 が 成立 する わけ です 。 
MsgBox で は あらかじめ 決め られ た 種類 の ボタン しか 表示 さ せる こと は 出来 ませ ん 。 任意 の ボタン を 表示 さ せる の で あれ ば ユーザー フォーム で ご 自分 で 作る 必要 が あり ます 。 
残念 ながら UndoLimit プロパティ が 存在 する の は WPF 用 の RichTextBox だけ です 。 Windows フォーム アプリケーション 用 の RichTextBox に は 存在 し ませ ん 。 UndoClear メソッド を 使っ て も ダメ な の でしょ う か ？ 
一 例 です 。 Private Sub CommandButton 1 _ Click () Dim i i = Application . Match ( TextBox 1 . Value , Columns ( 1 ), 0 ) If IsError ( i ) Then MsgBox " 検索 でき ませ ん " TextBox 2 . Value = "" Else TextBox 2 . Value = Cells ( i , 2 ). Text End If End Sub 
基本的 に は 「 6 行 目 の Sheet １ を 変える の です か ？ 」 という 考え で いい と 思い ます 。 マクロ 実行 元 の セル を 指定 する に は 以下 の 記述 ThisWorkbook . Worksheets (" Sheet 1 "). Range (" A1 ") 他 の ブック の セル を 指定 する に は 以下 の 記述 Workbooks (" Book 1 . xlsx "). Worksheets (" Sheet 1 "). Range (" A1 ") こんな 感じ です 。 ただし 、 この 指定 方法 で は 参照 する ブック を 予め 開い て おく 必要 が あり ます 。 つまり 、 「 コマンド ボタン を 押し たら 参照 する ブック を オープン し 、 検索 終了 後 閉じる 」 という コード を 追加 する 必要 が あり ます 。 実行 に 時間 は かかり ます が 、 これ が 一番 確実 かつ 簡単 な 方法 だ と 思い ます 。 ブック を 開く に は Workbooks . Open " C :\ Book 1 . xlsx " ブック を 閉じる に は Workbooks (" Book 1 . xlsx "). Close で は 頑張っ て ください 。 
下記 の コード でいか が でしょ う か 。 マクロ を 記述 し た ブック と 同じ フォルダ の 中 の CSV ファイル を すべて 対象 に し ます 。 結合 後 の ブック の 名称 は 適宜 修正 し て ください 。 Option Explicit Sub Sample () Const CatFileName As String = " 結合 後 . xlsx " ' 結合 後 の ブック の 名称 Dim bkPath As String , bkName As String Dim bk As Workbook , st As Worksheet Dim r As Long , c As Long Dim fn As Integer Dim textLine As String Dim item As Variant Application .S creenUpdating = False ' 結合 後 の ブック を 新規 に 作成 する Set bk = Workbooks . Add Set st = bk . Worksheets ( 1 ) r = 1 ' マクロ を 記述 し た ブック と 同じ フォルダ の 中 の CSV ファイル を すべて 対象 に する bkPath = ThisWorkbook . Path & "\" bkName = Dir ( bkPath & "*. csv ") Do While bkName <> "" ' CSV ファイル を 開く fn = FreeFile Open bkPath & bkName For Input As # fn ' 一行 目 は 読み 飛ばす Line Input # fn , textLine Do While Not EOF ( fn ) ' ２ 行 目 以降 を 一行 ずつ 読み込む Line Input # fn , textLine ' 結合 後 の ブック に 書き出す c = 1 For Each item In Split ( textLine , ",") st . Cells ( r , c ). Value = item c = c + 1 Next r = r + 1 Loop ' CSV ファイル を 閉じる Close # fn ' 次 の CSV ファイル を 対象 と する bkName = Dir () Loop ' 結合 後 の ブック を 保存 する Application . DisplayAlerts = False bk .S aveAs bkPath & CatFileName bk . Close False Application .S creenUpdating = True End Sub 
> 各 CSV ファイル の 2 行 目 ～ 最終 行 まで を 取り込む よう に したい 取り込ん だ 直後 の 1 行 目 を 削除 する の が 簡単 。 あと 少し 整理 し て い ます 。 Sub putCsv () Dim csvFile As Variant , rng As Range Dim fIdx As Integer csvFile = Application . GetOpenFilename ( FileFilter :=" ＣＳＶ ファイル ,*. csv ", MultiSelect := True ) If IsArray ( csvFile ) Then For fIdx = LBound ( csvFile ) To UBound ( csvFile ) Set rng = Cells ( Rows . Count , 1 ). End ( xlUp ) If rng . Value <> "" Then Set rng = rng . Offset ( 1 ) With ActiveSheet . QueryTables . Add ( Connect ion :=" TEXT ;" & csvFile ( fIdx ), Destination := rng ) . TextFileCommaDelimiter = True . Refresh BackgroundQuery := False rng . EntireRow . Delete End With Next fIdx End If End Sub 
① について は それほど 難しく は あり ませ ん 。 ② について は やはり 内訳 表 フォーマット の シート を 用意 し た ほう が いい です ね 。 少なくとも 外部 に 出す 資料 で あれ ば レイアウト や 文字 の フォント ・ 色 など も それら し くし た方 が いい でしょ う から 。 もちろん 、 印刷 し た あと は 内訳 表 フォーマット の シート は 別 ブック として 保存 し て 、 「 印刷 し た 証拠 」 を 残す こと も 必要 だ と 思い ます 。 
・ 項目 １ から 項目 9 を 具体 的 に どの セル に 転記 する の か が 判ら ない ので 暫定的 に A1 から I 1 に 転記 する と 仮定 し て い ます 。 ・ ユーザー フォーム の 項目 １ から 項目 ９ の 入力 用 の テキストボックス は TextBox 1 から TextBox 9 という 名前 だ と 仮定 し て い ます 。 ・ ユーザー フォーム の 年月日 の テキストボックス は それぞれ TextBoxYear 、 TextBoxMonth 、 TextBoxDay という 名前 だ と 仮定 し て い ます 。 ・ Command Button 1 で 「 平成 aa 年 n 月 . xls 」 を 開き ます 。 ・ Command Bu t to n2 で ユーザー フォーム から シート へ 転記 し ます 。 ・ Command Bu t to n3 で シート を 上書き保存 し て 閉じ ます 。 Option Explicit Dim bkPath As String Dim bk As Workbook Dim st As Worksheet Dim location s () As String ' ユーザー フォーム の 初期 処理 Private Sub UserForm _ Initialize () ' 現在 の フォルダ 名 を 保持 し て おく bkPath = ThisWorkbook . Path & "\" ' 項目 １ から 項目 ９ の 転記 位置 を 設定 する SetLocations ' 各 テキストボックス の 初期 値 を 設定 する InitControls End Sub ' 各 テキストボックス の 初期 値 を 設定 する Private Sub InitControls () Dim i As Integer ' 年月日 の 初期 値 を 設定 する TextBoxYear . Text = Year ( Now ) - 1988 TextBoxMonth . Text = Month ( Now ) TextBoxDay . Text = Day ( Now ) ' 項目 １ から 項目 ９ を クリア する For i = 1 To 9 Me . Controls (" TextBox " & i ) = "" Next i TextBoxYear .S etFocus End Sub ' シート を 開く ボタン が クリック さ れ た 時 の 処理 Private Sub CommandButton 1 _ Click () Dim bkName As String ' 既に ブック が 開か れ て い たら 何 も し ない If Not bk Is Nothing Then Exit Sub ' ブック が 存在 し なけれ ば メッセージ を 表示 する bkName = " 平成 " & TextBoxYear . Text & " 年 " & TextBoxMonth . Text & " 月 " & ". xls " If Dir ( bkPath & bkName ) = "" Then MsgBox bkName & " が 見つかり ませ ん 。 " TextBoxYear .S etFocus Exit Sub End If ' ブック を 開く Set bk = Workbooks . Add ( bkPath & bkName ) ' 日 シート を アクティブ に する Set st = Nothing On Error Resume Next Set st = bk . Worksheets ( Val ( TextBoxDay . Text ) & " 日 ") On Error GoTo 0 If st Is Nothing Then Set st = bk . Worksheets (" メイン ") st .S elect ' 入力 ブック を アクティブ に する ThisWorkbook . Activate ' ユーザー フォーム の 項目 １ に フォーカス を 設定 する TextBox 1 .S etFocus End Sub ' シート を 閉じる ボタン が クリック さ れ た 時 の 処理 Private Sub Command Bu t to n3 _ Click () Dim result ' 入力 ブック を アクティブ に する ThisWorkbook . Activate ' ブック が 開か れ て い なけれ ば 何 も し ない If bk Is Nothing Then Exit Sub ' 確認 メッセージ を 表示 する result = MsgBox (" 保存 し て よろしい です か ？", vbYesNoCancel Or vbDefaultButton 2 ) If result = vbCancel Then ' キャンセル なら ブック を 閉じ ず に 戻る TextBox 1 .S etFocus Exit Sub Else Application . DisplayAlerts = False ' Yes なら ブック を 上書き保存 する （ No なら 保存 せ ず に 閉じる ） bk . Close ( result = vbYes ) Application . DisplayAlerts = True End If Set st = Nothing Set bk = Nothing ' 各 テキストボックス の 初期 値 を 設定 する InitControls End Sub ' 項目 入力 ボタン が クリック さ れ た 時 の 処理 Private Sub Command Bu t to n2 _ Click () Dim i As Integer ' ブック が 開か れ て い なけれ ば 何 も し ない If bk Is Nothing Then Exit Sub ' アクティブ な シート が 日 シート で なけれ ば 転記 し ない Set st = bk . ActiveSheet If st . Name = " メイン " Then Exit Sub ' 項目 １ から 項目 ９ を 転記 する For i = 1 To 9 SetValue location s ( i - 1 ), Me . Controls (" TextBox " & i ) Next i ' メッセージ を 表示 する DoEvents MsgBox " 転記 し まし た 。 " Command Bu t to n3 .S etFocus End Sub ' テキストボックス の 内容 を シート に 転記 する Private Sub SetValue ( cell As String , data As String ) On Error Resume Next st . Range ( cell ). Value = data On Error GoTo 0 End Sub ' 項目 １ から 項目 ９ の 転記 位置 を 設定 する Private Sub SetLocations () ' ここ で の 設定 は 暫定的 です 。 実際 の 転記 位置 に 修正 し て 下さい 。 location s = Split (" A1 , B 1 , C1 , D1 , E 1 , F1 , G1 , H1 , I 1 ", ",") End Sub 
以下 の コード で コード を 生成 でき ます 。 With T hisWorkbook . VBProject . VBComponents (" Sheet 1 "). CodeModule . AddFromString " Private Sub Test ()" . AddFromString " MsgBox "" sample TEST """ . AddFromString " End Sub " End With ただし 、 実行 する パソコン の Excel の セキュリティ の 設定 を 変更 し て おく 必要 が あり ます 。 ①「 ファイル 」 → 「 オプション 」 を 選択 ②「 セキュリティ センター 」 を 選択 ③「 セキュリティ センター の 設定 」 ボタン を 押下 ④「 マクロ の 設定 」 を 選択 ⑤「 VBA プロジェクト オブジェクト モデル へ の アクセス を 信頼 する 」 チェックボックス を ON に し て 「 OK 」 ボタン を 押下 
お 示し の コード は 上手く 実行 さ れる の です よ ね ？ ↓ の よう な 変更 を 行っ て も 、 上手く いか ない の でしょ う か ？ Worksheets (" P 紙 発行 指示 "). Range ( P 数 位置 ). Value _ = Application . RoundUp ( 画面 _ 生産 数 / P 当り ケース 数 , 0 ) ↓ With Worksheets (" P 紙 発行 指示 "). Range ( P 数 位置 ) . Value = Application . RoundUp ( 画面 _ 生産 数 / P 当り ケース 数 , 0 ) . Value = . Value ＋ ２ End With 上手く いか ない の なら 、 提示 さ れ て ない 他 の 部分 の 処理 を 疑う べき でしょ う 。 
> 指定 し た 2つ の 場所 これ だけ で コード を 記述 でき たら 凄い です ね A . xlsm B . xlsm a | a a | a | 1 | 123 a | a a | a | 2 a | a a | a | 3 b | b b | b | 4 | 45 b | b b | b | 5 a | a a | a | 6 なら a | a a | a | 1 | 1236 に する という こと で ・ シート は 各 ファイル の １つ 目 ・ 比較 データ は A1 ～ Bxxx ・ 比較 は 、 同じ 行 で どう な の か ･･･ ・ ファイル は 開い て い て も い なく て も ・ B ファイル は 処理 後 保存 し て ･･･ ・ 各 ファイル は 、 開い て い なかっ たら 閉じる 以下 を 新規 ファイル の 標準 モジュール に 記述 し 、 ★ 部分 の ファイル パス を 変更 後 実行 し て み ます どう なり ます か ？ Public Sub Samp 1 ()     Dim dic As Object     Dim vA As Variant , vB As Variant     Dim sS As String     Dim bV As Boolean     Dim i As Long , j As Long , k As Long     Const CSEP As String = vbTab     Const CFILE _ A As String = " D :\ Hoge \ Moge _ A . xlsm " ' ★     Const CFILE _ B As String = " D :\ Hoge \ Moge _ B . xlsm " ' ★     Set dic = CreateObject (" Scripting . Dictionary ")     Application .S creenUpdating = False     With GetObject ( CFILE _ A )        With . Worksheets ( 1 )           With . Range (" A1 ", . Cells (. Rows . Count , " A "). End ( xlUp ))              vA = . Resize (, 2 ). Value           End With        End With        If ( Not . Windows ( 1 ). Visible ) Then . Close False     End With     With GetObject ( CFILE _ B )        With . Worksheets ( 1 )           With . Range (" A1 ", . Cells (. Rows . Count , " A "). End ( xlUp ))              k = . Rows . Count              If ( k > UBound ( vA )) Then k = UBound ( vA )              With . Resize ( k )                 vB = . Resize (, 3 ). Value                 For i = 1 To UBound ( vB )                    If (( vA ( i , 1 ) = vB ( i , 1 )) _                       And ( vA ( i , 2 ) = vB ( i , 2 ))) Then                       vB ( i , 1 ) = ""                       sS = vA ( i , 1 ) & CSEP & vA ( i , 2 )                       j = dic ( sS )                       If ( j = 0 ) Then                          dic ( sS ) = i                          j = i                       End If                       vB ( j , 1 ) = vB ( j , 1 ) & vB ( i , 3 )                    Else                       vB ( i , 1 ) = ""                    End If                 Next                 . Offset (, 3 ). Value = vB              End With           End With        End With        bV = . Windows ( 1 ). Visible        . Windows ( 1 ). Visible = True        .S ave        If ( Not bV ) Then . Close False     End With     Application .S creenUpdating = True     Set dic = Nothing End Sub 
使い道 が ある か 分かり ませ ん が ・ ・ - - - - - - - - - ------------------------- Dim A As New Label A.T ext = Label 1 . Text Message Box .S how ( A.T ext ) - - - - - - - - - ------------------------- の よう な 事 です か ？ 
転記 先 の セル を 行 を ずらす の で なく 、 列 を ずらし て いけ ば いい だけ です が ？ なにか 別 に 判ら ない こと が ある の でしょ う か ？ 
下記 で Ｑ＆Ａ さ れ て い ます 。 vba から 他 の アプリ を 終了 http:// oshiete . goo . ne.jp / qa / 7220474 . html 
下記 の コード でいか が でしょ う か ？ 出来る だけ 処理 内容 が 判る よう な コメント を 入れ て あり ます ので 、 不明 点 が あれ ば 返信 し て ください 。 Option Explicit Sub Sample () Dim bkPath As String , bkName As String Dim bk1 As Workbook , st 1 As Worksheet Dim bk 2 As Workbook , st 2 As Worksheet Dim r1 As Long ' 画面 の 再 描画 を 一時停止 する Application .S creenUpdating = False ' 抽出 先 の ブック を 新規 に 作成 する Set bk1 = Workbooks . Add Set st 1 = Worksheets (" Sheet 1 ") r1 = 1 ' この ブック と 同じ フォルダ 内 の すべて の ブック を 検索対象 と する bkPath = ThisWorkbook . Path & "\" bkName = Dir ( bkPath & "*. xls ?") Do While bkName <> "" ' この ブック 自身 は 検索対象 から 除外 する If bkName <> ThisWorkbook . Name Then ' 検索対象 の ブック を 開く Set bk 2 = Workbooks . Open ( bkPath & bkName ) ' 調査 票 シート 以外 は 検索対象 から 除外 する For Each st 2 In bk 2 . Worksheets If st 2 . Name Like "* 調査 票 *" Then ' 調査 票 シート の A1 を 抽出 先 の A 列 に 抽出 する st 1 . Range (" A " & r1 ). Value = st 2 . Range (" A1 "). Value ' 調査 票 シート の ファイル 名 を 抽出 先 の B 列 に 抽出 する st 1 . Range (" B " & r1 ). Value = bk 2 . Name ' 調査 票 シート の シート 名 を 抽出 先 の C 列 に 抽出 する st 1 . Range (" C " & r1 ). Value = st 2 . Name r1 = r1 + 1 End If Next st 2 ' 検索対象 の ブック を 閉じる bk 2 . Close False End If bkName = Dir () Loop ' 画面 の 再 描画 を 再開 する Application .S creenUpdating = True ' 抽出 先 の ブック を 保存 する bk1 . Close True End Sub 
こんにちは。 確認 し たい の は 、 「 エラー 」 に なっ た 行 の 手前 で 、 1 秒 くらい の application . wait を 実行 し たら 、 どんな 変化 が ある か 、 です 。 もし 変化 し て 、 エラー に なら ない よう なら 、 OS の 動作 に 差 が ある こと が 原因 です 。 
これ で どう か な ? Sub AlignDataTo 1 Col () Dim lngRow As Long Dim lngCol As Long Dim strData As String Dim varData As Variant Dim lngLop As Long Dim rngOutPut As Range Dim ArrayOut , i As Long , xRow As Long i = ( Selection ( Selection . Count ). Column - Selection ( 1 ). Column + 1 ) Mod 3 If i <> 0 Then Exit Sub If Selection . Resize ( 1 , 3 ). Address <> Selection ( 1 ). MergeArea . Address Then Exit Sub ReDim ArrayOut ( 1 To Selection . Count / 3 , 1 To 4 ) xRow = 1 For lngCol = Selection ( 1 ). Column To Selection ( Selection . Count ). Column Step 3 For lngRow = Selection ( 1 ). Row To Selection ( Selection . Count ). Row If Cells ( lngRow , lngCol ). MergeCells Then ArrayOut ( xRow , 1 ) = Cells ( lngRow , lngCol ). Value ElseIf WorksheetFunction . CountA ( Cells ( lngRow , lngCol ). Resize (, 3 )) > 0 Then ArrayOut ( xRow , 2 ) = Cells ( lngRow , lngCol ). Value ArrayOut ( xRow , 3 ) = Cells ( lngRow , lngCol + 1 ). Value ArrayOut ( xRow , 4 ) = Cells ( lngRow , lngCol + 2 ). Value xRow = xRow + 1 ArrayOut ( xRow , 1 ) = ArrayOut ( xRow - 1 , 1 ) End If Next lngRow Next lngCol Set rngOutPut = Application . InputBox ( Prompt :=" 出力 先 セル を 指定 し て ください 。 ", Type := 8 ) rngOutPut . Resize ( xRow - 1 , 4 ). Value = ArrayOut End Sub 写真 の データ で 、 最初 の A が 6 セル マージ さ れ て い ます が 、 3 セル の マージ に 修正 し て 実行 し て ください 。 
ＰＣ が 高速 化 し た 事 で ウエイト が 必要 に なっ た の かも ？ エクセル の VBA で 、 Wait とか Sleep の 使い方 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1467582304 
エクセル の マクロ 機能 毎回 毎回 お決まり の エクセル 作業 が あっ て 、 簡単 な ん だ けど 超 面倒 、 超 大量 、 あー カッタルイ なんて 時に 威力 を 発揮 する の が マクロ です 。 やり たい 作業 を マクロ に 登録 し て おけ ば 、 後 は マクロ を 起動 する だけ で 高速 かつ 正確 に 処理 さ れ ます 。 おおよそ 手動 で 出来る 作業 は 全部 マクロ に 出来 ます 。 エクセル マクロ を 記述 する ため に 採用 さ れ た 言語 が 、 Visual Basic です 。 エクセル 向け に カスタマイズ さ れ てる ので 、 Visual Basic for Application s 略し て VBA あるいは エクセル VBA と 呼ば れ て ます 。 現在 の ところ 、 エクセル マクロ に 用い られる 言語 は VBA です 。 近い 将来 、 Java に 変更 さ れる 可能性 は ない ん じゃ ない の ？ 推測 です けど 。 マイクロソフト は 、 かつて マクロ を 止めよ う と し た 事 が あり ます 。 猛 反発 に あい 撤回 さ れ た そう です 。 また 、 パワーポイント の 記録 マクロ （ 操作 内容 を マクロ に 記録 する 機能 ） が 数 年 前 に 無くなり まし た 。 次 バージョン で 復活 し まし た が 。 本音 で は 止め た がっ て ます 。 要は マイクロソフト が や ーメタ ！ と 言っ たら ハイ 終わり な の です 。 エクセル にとって マクロ は 冒頭 で 述べ た 様に 有用 です が 、 逆 に マクロ と いう か visual basic にとって も エクセル は 便利 です 。 ちょっと かじっ た 人 なら 誰 でも 知っ て ます が 、 コンピュータ の 計算 は 大きく 3つ に 分かれ て ます 。 入力 、 主 処理 、 出力 。 エクセル マクロ で は 、 入力 と 出力 を 全部 エクセル で 引き受け て くれる ので 、 主 処理 に 集中 出来 ます 。 
Find の オプション で LookIn := xlValues を 追加 し て み て ください 
はい 、 そう です 。 以前 の ＶＢ は 、 オブジェクト指向 と は 言い 難かっ た です が 、 今 の 、 .NET 系 の もの は 、 完全 な オブジェクト指向言語 に なっ て い ます 。 
Find の 指定 範囲 で 、 Range の 中 の Range に シート の 指定 が あり ませ ん 。 そこ だけ アクティブ シート の セル に なる ので 、 正しく Find さ れ ませ ん 。 Worksheets (" DB "). Range ( Worksheets (" DB "). Range (" A 2 "), mylastrange ). _ Find ( what := myno , lookat := xlWhole ) として み て ください 。 
表示 だけ やっ たら 、 もっと 簡単 な 方法 も ある けど 、 何 か 加工 し たい なら DIBSection で 、 メモリ コンテキスト を 作る の が 一般的 や http:// www .s m . rim . or .jp /~ shishido / dibsec . html 
マクロ を 教え て ほしい の で あれ ば 、 ブック ・ シート ・ フォルダ を 正確 に 提示 し て ください 。 重複 だ と 判断 する ため の ルール も 正確 に 提示 し て ください 。 そう で ない と 貴方 が 望む 回答 は 絶対 得 られ ませ ん 。 
＞ どんな パソコン で も 実行 できる と 聞く と JAVA が すぐ 思いつき ます が 、 ＞ HTA 以外 に なにか あり ます でしょ う か 。 と の こと で ＞ Windows OS 問わ ず と は Windows の Ver を 問わ ず という 意味 でしょ う か ？ HTA 参考 ： http:// www . weblio .jp / content /. hta 
以下 の コード でいか が でしょ う か 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) If Target . Column = 3 Then L = Range (" C " & Rows . Count ). End ( xlUp ). Row If L > 29 Then MsgBox " 20 行 を 過ぎ 、 " & L & " 行 です " End If End If End Sub 
こんな 感じ で どうでしょう か 。 サンプル と 同じ データ が 4つ だけ なら Sub Sample () Dim i As Long For i = 1 To 4 If Range (" A " & i ) = " 人 " Then Range (" C " & i ) = Range (" B " & i ) Next End Sub 最終 行 を 自動 で 見つけ て 一括 処理 する なら Sub Sample 2 () Dim i As Long For i = 1 To Range (" A " & Rows . Count ). End ( xlUp ). Row If Range (" A " & i ) = " 人 " Then Range (" C " & i ) = Range (" B " & i ) Next End Sub 
A 列 の 最終 行 の セル から HA 列 まで を 選択 すれ ば よい の でしょ う か 。 Range (" A " & Rows . Count ). End ( xlUp ). Resize (, 209 ). Select で どうでしょう か 
R1 , R2 の 指定 を 以下 の よう に 書き換え たら どうでしょう か ？ With ActiveSheet With . Range (. Cells ( 2 , 2 ), . Cells ( Rows . Count , 2 ). End ( xlUp )) R1 = . Address R2 = . Offset ( 0 , 1 ). Resize (, 10 ). Address End With End With B 列 の 2 行 目 から 最終 行 まで の 範囲 を 求め て 、 その アドレス を R1 へ 設定 。 さらに 、 その 範囲 を 1 列 横 に 移動 し 、 10 列 に 拡張 し た アドレス を R2 へ 設定 。 こんな 感じ の コード です 。 参考 まで 。 
黄色 の セル なら ば xCnt を カウントアップ し て いる ところ に 、 別に 用意 し た 合計 用 の 変数 に 値 を 加算 し ます 。 それから 、 xCnt の 値 を セット し て いる ところ で 、 その 右 隣 に 合計 用 の 変数 の 値 を セット し ます 。 （ サンプル ） Dim xRow As Range , xCnt As Long , i As Long ' 合計 用 の 変数 Dim xTotal As Long With Range (" A1 : F5 ") For Each xRow In . Rows xCnt = 0 With xRow For i = 1 To . Columns . Count - 1 If . Cells ( i ). Interior . Color = vb Yellow Then xCnt = xCnt + 1 ' 値 を 加算 し ます xTotal = xTotal + . Cells ( i ). Value End If Next i . Cells ( i ). Value = Format ( xCnt , "###") ' 右 隣 に 合計 を セット し ます . Cells ( i ). Offset (, 1 ). Value = Format ( xTotal , "###") End With Next xRow End With End Sub なお 、 テスト は し て い ませ ん 。 セル の 値 が 数値 以外 の 場合 の 考慮 も し て い ませ ん 。 
たとえば ３つ コピー の ある 先頭 の Worksheets (" Sheet 1 "). Range (" Cells ( 1 , 4 + num ): Cells ( MaxRow , 4 + num )"). Copy Worksheets (" Sheet 2 "). Range (" Cells ( 1 , MaxCol + 2 + num ): Cells ( MaxRow , MaxCol + 2 + num )") です が 、 Range () の 中 が ""（ ダブル クォーテーション ） で 括ら れ て い ます ので 、 文字列 として 「 Cells ・ ・ 」 が 認識 さ れ ます 。 それでは セル を 表す 文字列 として は 正しく あり ませ ん 。 Worksheets (" Sheet 1 "). Range (" Cells ( 1 , 4 + num ): Cells ( MaxRow , 4 + num )") は Worksheets (" Sheet 1 "). Range ( Cells ( 1 , 4 + num ), Cells ( MaxRow , 4 + num )) と なり ます が 、 これ で は 中 の Cells は アクティブ シート の セル を 表し て いる ため エラー に なる 可能性 が あり ます Worksheets (" Sheet 1 "). Range ( Worksheets (" Sheet 1 "). Cells ( 1 , 4 + num ), Worksheets (" Sheet 1 "). Cells ( MaxRow , 4 + num )) が 正しい 書き方 に なり ます が 、 これ で は 長 すぎ ます Worksheets (" Sheet 1 "). Cells ( 1 , 4 + num ). ReSize ( MaxRow ) と ReSize を 使う こと で 、 かなり シンプル に なり ます 。 また コピー 先 も 同様 です が 、 コピー 先 は 先頭 の セル だけ 指定 すれ ば 良い の で Worksheets (" Sheet 2 "). Range (" Cells ( 1 , MaxCol + 2 + num ): Cells ( MaxRow , MaxCol + 2 + num )") では なく Worksheets (" Sheet 2 "). Cells ( 1 , MaxCol + 2 + num ) で 良い はず です 。 したがって 、 ３つ の コピー を 書き直す なら Worksheets (" Sheet 1 "). Cells ( 1 , 4 + num ). Resize ( MaxRow ). Copy Worksheets (" Sheet 2 "). Cells ( 1 , MaxCol + 2 + num ) Worksheets (" Sheet 1 "). Cells ( 1 , 7 + num ). Resize ( MaxRow ). Copy Worksheets (" Sheet 2 "). Cells ( 1 , MaxCol + 3 + num ) Worksheets (" Sheet 1 "). Cells ( 1 , 12 + num ). Resize ( MaxRow , 4 ). Copy Worksheets (" Sheet 2 "). Cells ( 1 , MaxCol + 4 + num ) と なり ます 。 （ ３つ 目 は 、 ４ 列 コピー な ので ReSize ( MaxRow , 4 ) あと 、 気 に なっ た の です が 、 MaxRow 、 MaxCol を 求める ところ と 、 If で 空白 か どう か を 確認 し て いる ところ は シート を 指定 し て い ない ので 、 シート 指定 し て おい た ほう が 良い と 思い ます 。 そして 、 MaxRow 、 MaxCol を 求める とき に 最大 行 、 最大 列 を 固定 で 指定 し て い ます が MaxRow = Worksheets (" Sheet 1 "). Range (" A " & Rows . Count ). End ( xlUp ). Row MaxCol = Worksheets (" Sheet 1 "). Cells ( 1 , Columns . Count ). End ( xlToLeft ). Column と し た ほう が 汎用 的 です （ 新しい 形式 で は 1 , 048 , 576 行 、 16 , 384 列 （ XFD 列 ） まで 使用 できる ので ） 
FolderFullPath = " C :\" + TreeView 1 . Text . Length を FolderFullPath = " C :\" + TreeView 1 . Text と すれ ば エラー は 出 なく なり ます 。 です が 、 FolderFullPath を 正しく 設定 する ため に は 選択 さ れ て いる ノード から ルート まで 辿っ て フル パス を 組み立てる 必要 が ある と 思い ます 。 更に コピー 元 が 「 C :\ Test 」 と 「 C :\ Test \ Test 」 で は コピー 先 は どちら も TextBox 1 . Text \ Test に なっ て しまい ます よ ね ？ その 場合 は どう する つもり でしょ う か ？ 
単純 に 書く なら With ActiveSheet . Pictures . Insert ( File ) . Left = Selection . Left . Top = Selection . Top ' 幅 の 指定 . Width = 13 . 34 ' 高さ の 指定 . Height = 10 ' 最 背面 に 移動 .S hapeRange . ZOrder msoSendToBack End With と なり ます 。 幅 、 高さ の 単位 は ポイント な ので 、 13 . 34 ポイント 、 10 ポイント なら 上記 で 良い の です が 、 他 の 単位 なら ば 変換 が 必要 に なり ます 。 たとえば 13 . 34cm 、 10 ｃｍ なら ' 幅 の 指定 . Width = Application . CentimetersToPoints ( 13 . 34 ) ' 高さ の 指定 . Height = Application . CentimetersToPoints ( 10 ) 
ちょっと やっ て み まし た 。 多分 、 売上 データ 読込 という 名前 の ワーク シート が 見つから ない という エラー です 。 それから 、 Set ws = Sheets (" 売上 データ 読込 "). Select で は なく 、 Set ws = Sheets (" 売上 データ 読込 ") ws .S elect と 書か ない と 、 オブジェクト が 必要 です という エラー に なり ます 。 
まず 最初 の msgbox は メッセージ を 出し た だけ の ステートメント で 終了 し て おり 、 If の vbYes は 一定 です 。 http:// office tanaka .net / excel / vba / function / MsgBox . htm 変数 に Msgbox 関数 として の 応答 を 格納 し て If で 分岐 さ せ なけれ ば なり ませ ん よ 。 私 の 環境 で は 質問 文 の エラー は 再現 し ませ ん でし た 。 使用 の Excel と OS の バージョン を 提示 し て は いかが でしょ う か 。 
チェックボックス に は 3 値 ( True / False / Null ) が あっ て 、 既定 値 の 設定 が ない 場合 Null で 、 灰色 の 四角 だっ た と 思い ます まず 、 既定 値 を 設定 し て み ます それでも ダメ なら 、 Form _ Load とか で True / False を 設定 する とか ･･･ チェック を 入れる と ･･･ な ので 、 更新 後 処理 を 使い ます 以下 雰囲気 で Private Sub Ctl 1号 機 _ AfterUpdate ()     If ( Me ! Ctl 1号 機 ) Then        Me ! btn 設定 1 . Caption = " 設定 "     Else        Me ! btn 設定 1 . Caption = " 未 設定 "     End If End Sub 
部分的 です が 、 解釈 する 文字列 は 入手 済み という こと で 、 雰囲気 以下 で どう なり ます か Public Sub Samp 1 ()     Dim sS As String     Dim v As Variant     Dim i As Long     sS = "< div id =' address - box '>" _        & "< div class =' formBox ResultBox '>" _        & "< ul class =' clearfix '>" _        & "< li class =' ResArea '>" _        & "< div class =' fs 16 '>" _        & "< p >〒 XXX - YYYY </ p >" _        & "< p > 東京都 ● ● ３ 丁目 </ p >" _        & "< p class =' Icontel '> 03 -****- 1111 </ p >" _        & "</ div >" _        & "</ li >" _        & "< li class =' IconArea '>" _        & "< img src ='../ images / ic on_ ho me. png ' width =' 100% '>" _        & "</ li ></ ul >"     v = Split ( sS , "</ p >")     For i = LBound ( v ) To UBound ( v ) - 1        Debug . Print Mid ( v ( i ), InStrRev ( v ( i ), ">") + 1 )        Debug . Print Mid ( v ( i ), InStrRev ( v ( i ), "< p ")) & "</ p >"     Next End Sub 
Ｗ クリック キャンセル を 追加 し て は 如何 でしょ う か 。 Private Sub ～ Cancel = True 
R や C は 、 A1 と は 異なる セル 指定 形式 です 。 R が 行 、 C が 列 を 表わし て おり 、 F5 なら ば 、 R5 C 6 と 同じ と なり ます 。 そして 、 R [- 1 ] C [ 3 ] の よう な 括弧付き で 行列 数 を 指定 し た 場合 、 相対 参照 と なり ます 。 前述 の 例 で 言え ば 、 記述 し た セル から 上 に 1 行 、 右 に 3 列 進ん だ 位置 に なり ます 。 
条件 が あいまい な ので マクロ を 提示 出来 ませ ん 。 ・ 対象 と なる シート は ブック に 存在 する すべて の シート です か ？ ・ 対象 と なる セル の 範囲 は ？ ・ 「 20 項目 くらい 」 と 書か れ て も 条件 が 特定 でき ませ ん 。 対象 と なる 項目 を 確実 に 抽出 できる 具体 的 かつ 正確 な 条件 を 提示 し て 下さい 。 ・ 変換 の ルール は 対象 と なる 項目 の 末尾 の 数字 を 抜き出し て 「 円 」 を 追加 する 、 で 本当に よろしい の です か ？ 
抽出 し たい 項目 が セル で 指定 できる なら 、 単純 に 以下 の よう な 関数 で 対応 する の が 簡単 です 。 指定 し たい 項目 名 を A1 セル から 右 に 入力 し 、 B 1 セル に 以下 の 式 を 入力 し 下 方向 および 右 方向 に オート フィル し ます 。 = INDEX ( Sheet 1 !$ A :$ CZ , ROW ( 2 : 2 ), MATCH ( A $1 , Sheet 1 !$ 1 :$ 1 , 0 )) Alt 、 T 、 O の ショートカット 操作 で Excel の オプション を 表示 し 「 詳細 設定 」 から 次に シート で 作業 する とき の 表示 設定 で 「 ゼロ 値 の セル に ゼロ を 表示 する 」 の チェック を 外し ます 。 １ 行 目 の 項目 を 変更 すれ ば 自動的 に ２ 行 目 以下 に データ が 表示 さ れ ます 。 
① 開発 担当者 すべて が 閲覧 ・ 編集 できる 共有 フォルダ に アプリケーション A の ソリューション フォルダ を 作成 し ます 。 ② ソリューション の 下 に 各自 の 開発 担当 の フォーム の プロジェクト を 作成 し ます 。 ③ ソリューション の 下 に アプリケーション A の プロジェクト を 作成 し ます 。 ④ アプリケーション A の プロジェクト に 各自 の for m1 、 form 2 、 form 3 を 「 リンク として 追加 」 し ます 。 
Excel の VBA で は UTF-8 で 書か れ た テキストファイル を 扱う こと は 出来 ませ ん 。 Excel で 処理 する 前 に フリー の テキスト ツール で UTF-8 から Shift-JIS か Unicode に 変換 すれ ば Excel の VBA で 扱う こと が 出来る よう に なり ます 。 ツール は Google なり Yahoo! なり で 「 utf-8 変換 ツール 」 で 検索 する と たくさん ヒット し ます 。 
サンプル プログラム は せめて コンパイル 通る 状態 に し ましょ う よ 。 いろいろ 抜け が ある ため 、 コレ が 実際 に 動く か どう か は わかり ませ ん が MSTTable の データ を 全 件 読み込む という 動き を 期待 し てる と 思い ます 。 
こんにちは。 本来 は 、 メール の 最初 の 部分 を 解析 し て 、 必要 なら ば 文字列 の 変換 が 必要 です 。 basp 21 では Kconv メソッド 文字列 を 指定 し た 漢字 コード に 変換 し ます 。 変換 前 の 漢字 コード の タイプ が 不明 の 場合 、 自動認識 し ます 。 out = bobj . Kconv ( instr , outtype [, intype ]) 引数 instr [ in ] : 変換 し たい 文字列 （ UNICODE の 場合 ） 、 または バイト 配列 。 outtype [ in ] : 変換 後 の 漢字 コード の タイプ を 数字 で 指定 し ます 。 0 - 変換 せ ず に 漢字 タイプ を 数字 で 返し ます 1 - SHIFT JIS 2 - EUC 3 - JIS 4 - UNICODE UCS2 5 - UNICODE UT F8 intype [ in ] : 変換 前 の 漢字 コード の タイプ が 確定 し て いる とき 数字 で 指定 し ます 。 0 - 不明 （ 省略 値 ） 。 自動認識 し ます 。 1 - SHIFT JIS 2 - EUC 3 - JIS 4 - UNICODE UCS2 5 - UNICODE UT F8 out [ out ] : 変換 後 の 漢字 コード を 文字列 （ UNICODE の 場合 ） あるいは バイト 配列 で 返し ます 。 outtype = 0 なら 漢字 の タイプ を 数字 で 返し ます 。 解説 次 の よう な 場合 、 漢字 コード の 自動認識 が 失敗 する こと が あり ます 。 o SHIFT JIS で 半角カナ のみ o 漢字 文字数 が 少ない o UNICODE UT F8 使用 例 jisarray = bobj . Kconv (" 馬場 ", 3 ) ' UNICODE UCS2 から JIS に 変換 outcode = bobj . Kconv ( jisarray , 4 ) ' JIS から UNICODE UCS2 に 変換 関連 項目 KconvFile メソッド による 、 変換 の 関数 が ある ので 、 これ を 使っ て 、 エクセル の セル に 設定 し て ください 。 メーラー によって 、 メール の 文字化け が 発生 する の は 、 メール の 仕様 の 範囲 です 。 BASP で も 、 その 対応 は 、 プログラム による 対応 で する よう に なっ て い ます 。 
一 例 です 。 挿入 や 削除 は 行 降順 に し た 方 が よい 。 Sub テスト () Dim i As Long With Worksheets (" 作業 シート ") Sheets (" 見出し "). Range (" A6 : AM 7 "). Copy For i = . Cells ( Rows . Count , " B "). End ( xlUp ). Row To 1 Step - 1 If . Cells ( i , " j ") = " 001 " Then Sheets (" 見出し "). Range (" A6 : AM 7 "). Copy . Cells ( i , " j "). Insert End If Next End With End Sub 
> エラー が 出 ない よう に する に は どこ を 直し た 方 が いい です か ? > >/* ランダム 文字列 を 生成 する */ コンパイル 、 実行 し て 現象 が 再現 する ソース を 載せる こと 。 どの よう な 結果 を 期待 し て 、 何処 で 、 どの 様 な エラー が 出る の か 、 を 書く こと 。 エラーメッセージ は 省略 せ ず に かく こと 。 
こんにちは。 現在 の マクロ を 知らせ て ください 。 うまく 出来 ない 原因 を み て み た ほう が いい です 
Me ! bot to m1 . Caption ="" 
Y 列 だけ 自動 調整 する 、 という こと は でき ない ので 、 最初 に 対象 行 を すべて 自動 調整 し て から 、 34 . 75 未満 の 行 だけ 34 . 75 に する という 考え方 。 Sub RHAdj () Dim St As Worksheet , Lr As Long , C As Long For Each St In Worksheets Lr = Range (" A " & Rows . Count ). End ( xlUp ). Row Rows (" 3 :" & Lr ). AutoFit For C = 3 To Lr If Rows ( C & ":" & C ). RowHeight < 34 . 75 Then Rows ( C & ":" & C ). RowHeight = 34 . 75 Next C Next St End Sub 
命名規則 として Form _ f ○ ○ と し て いる の なら 、 「 棚 札 」 フォーム に は f が あり ませ ん 。 Form _ f 出庫 . GetSyouhin Form _ 棚 札 . GetSyouhin 
MSDN の Like 演算子 の ヘルプ https :// msdn . microsoft . com / ja - jp / library / office / gg 251796 ( v = office . 1 ... 「 特殊文字 の 左角 かっこ ([)、 疑問符 (?) 、 シャープ 記号 (#)、 および アスタリスク (*) と 一致 さ せる に は 、 それら を 角 かっこ で 囲み ます 。 」 と あり ます 。 If Cells ( 1 , 1 ). Value Like "*[[]*" Then として み て 下さい 。 
型 指定 さ れ て い ない データセット へ の 新しい レコード の 挿入 https :// msdn . microsoft . com / ja - jp / library / 5 ycd 1034 . aspx が 参考 に なら ない か な ？ 通常 は TableAdapter とか 使っ て 、 型付き データセット へ 入れる けど ね https :// msdn . microsoft . com / ja - jp / library / ms 233822 . aspx .NET は 、 DB へ の アプローチ の しかた が 沢山 あっ て 、 初心者 に は わけ が わからん かも 。 たくさん ある よう に 見え て 、 高 レベル の アプローチ は 、 内部 的 に 低 レベル の アプローチ で コード が 自動 生成 さ れ て いる だけ な ん だ けど ね 。 
こんにちは。 ボタン の クリック イベント に v 1 = me. text bo x1 . value ' ファイル 名 vpath = thisworkbook . path Me . Image 1 . Picture = LoadPicture ( vpath & "\" & v 1 ) だいたい 、 こんな かんじ です 
以下 の コード でいか が でしょ う か ？ 条件 に あいまい な 点 が ある ので 多少 冗長 な 処理 に なっ て い ます 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st 2 As Worksheet Dim r1 As Long , r2 As Long Set st 1 = Worksheets (" Sheet 1 ") Set st 2 = Worksheets (" Sheet 2 ") r2 = IIf ( st 2 . Range (" D6 "). Value = "", 6 , st 2 . Range (" D " & Rows . Count ). End ( xlUp ). Row + 1 ) r1 = 2 Do While st 1 . Range (" M " & r1 ). Value <> "" Or st 1 . Range (" N " & r1 ). Value <> "" Or st 1 . Range (" O " & r1 ). Value <> "" st 2 . Range (" D " & r2 ). Value = st 1 . Range (" M " & r1 ). Value & st 1 . Range (" N " & r1 ). Value & st 1 . Range (" O " & r1 ). Value r2 = r2 + 1 r1 = r1 + 1 Loop End Sub 
アクティブ シート なら ば Range (" G5 : AI 5 "). Interior . Color = Range (" A5 "). Interior . Color 
Sub 一 例 です () Dim i As Long , xBk As Workbook Const cPath As String = " C :\ AAA \ BBB \" With ActiveSheet Set xBk = Workbooks . Add For i = 2 To . Cells ( Rows . Count , 1 ). End ( xlUp ). Row With . Cells ( i , 1 ) xfld = Dir ( cPath & . Value , vbDirectory ) If xfld = "" Then MkDir cPath & . Value End If Application . DisplayAlerts = False xBk .S aveAs cPath & . Value & "\" & . Offset (, 1 ). Value Application . DisplayAlerts = True End With Next i xBk . Close End With End Sub 
※ 文字数 オーバー の 為 、 再 投稿 し ます 。 修正 し まし た 。 試し て み て ください 。 Sub Sample () Dim i As Long Dim j As Long Dim Cnt As Long Dim LastRow As Long Dim Sh As Worksheet Dim NewSh As Worksheet Set Sh = ActiveSheet With Sh LastRow = . Cells (. Rows . Count , " A "). End ( xlUp ). Row If LastRow < 6 Then MsgBox " データ が あり ませ ん 。 ", vbOKOnly + vbCritical Set Sh = Nothing Exit Sub End If End With Application .S creenUpdating = False With T hisWorkbook Set NewSh = . Worksheets . Add ( After :=. Worksheets (. Worksheets . Count )) End With With Sh . Range (. Cells ( 6 , " C "), . Cells ( LastRow , " C ")). ClearContents NewSh . Range (" A1 ") = " 品種 " NewSh . Range (" B 1 ") = " 件数 " NewSh . Range (" C1 ") = " 番号 " For i = 6 To LastRow If . Cells ( i , " B ") = " 生 " Then On Error Resume Next j = Application . WorksheetFunction . Match (. Cells ( i , " A "), NewSh . Columns (" A "), 0 ) If Err . Number <> 0 Then Err . Clear j = NewSh . Cells ( NewSh . Rows . Count , " A "). End ( xlUp ). Row + 1 NewSh . Cells ( j , " A ") = . Cells ( i , " A ") End If NewSh . Cells ( j , " B ") = NewSh . Cells ( j , " B ") + 1 On Error GoTo 0 End If Next End With With NewSh LastRow = . Cells (. Rows . Count , " A "). End ( xlUp ). Row If LastRow < 2 Then Application . DisplayAlerts = False NewSh . Delete Application . DisplayAlerts = True Sh . Activate Set NewSh = Nothing Set Sh = Nothing Application .S creenUpdating = True MsgBox "[ 番号 ] を 付与 する 品種 が あり ませ ん 。 ", vbOKOnly + vbCritical Exit Sub End If Cnt = 90001 For i = 2 To LastRow If . Cells ( i , " B ") > 1 Then . Cells ( i , " C ") = Cnt Cnt = Cnt + 1 End If Next End With With Sh LastRow = . Cells (. Rows . Count , " A "). End ( xlUp ). Row For i = 6 To LastRow If . Cells ( i , " B ") = " 生 " Then On Error Resume Next j = Application . WorksheetFunction . Match (. Cells ( i , " A "), NewSh . Columns (" A "), 0 ) If Err . Number <> 0 Then Err . Clear Else If NewSh . Cells ( j , " C ") <> "" Then . Cells ( i , " C ") = NewSh . Cells ( j , " C ") End If End If On Error GoTo 0 End If Next End With Application . DisplayAlerts = False NewSh . Delete Application . DisplayAlerts = True Sh . Activate Set Sh = Nothing Set NewSh = Nothing Application .S creenUpdating = True MsgBox " 処理 し まし た 。 ", vbOKOnly + vbInformation End Sub 
> App . DoCmd . OpenQuery " クエリ 名 " この 後 、 表示 し た もの を どう する の でしょ う か ？ 操作 等 わかり ませ ん が 、 その VBA を 記述 し て いる 側 の クエリ で 、 以下 記述 し て み て どう です か ？ （ クエリ の SQL ビュー で ） SELECT * FROM クエリ 名 IN ' 外部 ファイル の パス 名 '; ※ FROM の 後ろ の クエリ 名 は 、 外部 ファイル に ある クエリ これ で 良 さ そう なら 、 この クエリ で サブ フォーム 組み込み する とか ･･･ 
まず 、 普通に フォーム を 作成 し た 場合 、 フォーム の 中 の コントロール は Private な ので Form 2 . PictureBox 1 ～ といった 聞き 方 は 出来 ませ ん 。 PuctureBox の Modifiers プロパティ を Public に 設定 すれ ば 可能 に なり ます が 、 オブジェクト指向プログラミング の 観点 から は あまり お 勧め でき ませ ん 。 オブジェクト指向プログラミング で は フォーム の 中 の コントロール の 判断 ・ 操作 は フォーム クラス の 中 で だけ 行う こと が 基本 です 。 画像 の 有無 の 判定 について は If PictureBox 1 . Image Is Nothing Then で どうでしょう か ？ TextBox の 内容 判定 について は 「 あ 」 と だけ 書か れ て いる とき 、 という 判定 は If TextBox 1 . Text = " あ " Then 「 あ 」 という 文字 が 含ま れ て いる とき If TextBox 1 . Text . Contains (" あ ") Then 入力 内容 が 「 あ 」 で 始まる とき If TextBox 1 . Text .S tartsWith (" あ ") Then 他 にも 判断 の パターン は あり ます が 、 詳しく は String クラス の メソッド の ヘルプ を 参照 し て ください 。 
簡単 な ところ で は 、 変数 を 使わ ず name プロパティ を 変更 ’ 例 ) Sheets ( 7 ). Name = Cells ( 3 , 1 ) & "(" & Cells ( 3 , 2 ) & ")" ただし この Cells オブジェクト が 親 を 省略 し て いる ので 、 Activesheet 依存 で ある こと を 念頭 に し て おい て ください 。 別 の シート で 実行 する 場合 予期 せ ぬ 結果 を 招き かね ませ ん 。 その ２ ループ 構文 の 利用 ループ 回数 が 完全 に 固定 なら 固定 で 、 変動 する なら それなり に なり ます が 、 まずは 前者 で 。 dim i as integer for i = 3 to 33 Sheets ( i + 4 ). Name = Cells ( i , 1 ) & "(" & Cells ( i , 2 ) & ")" next i i に は 最初 3 が 代入 さ れ 結果 ７ 番 シート 、 セル の 行 数 も 3 が 代入 さ れ 、 ループ は 指定 なし なので 1 ずつ プラス さ れ て いき ます 。 いかが でしょ う ？ 
下記 の コード でいか が でしょ う か 。 Option Explicit Private Sub UserForm _ Initialize () ListBox 1 . ColumnCount = 5 ListBox 1 . ColumnWidths = " 1cm ; 1cm ; 1cm ; 1cm ; 1cm " End Sub Private Sub TextBox 1 _ Change () SetList End Sub Private Sub TextBox 2 _ Change () SetList End Sub Private Sub TextBox 3 _ Change () SetList End Sub Private Sub TextBox 4 _ Change () SetList End Sub Private Sub TextBox 5 _ Change () SetList End Sub Private Sub SetList () ListBox 1 . Clear ListBox 1 . AddItem TextBox 1 . Text ListBox 1 . List ( 0 , 1 ) = TextBox 2 . Text ListBox 1 . List ( 0 , 2 ) = TextBox 3 . Text ListBox 1 . List ( 0 , 3 ) = TextBox 4 . Text ListBox 1 . List ( 0 , 4 ) = TextBox 5 . Text End Sub 
> エクセル VBA で マクロ 有効 シート を コピー し て 新しい ブック を 作る マクロ マクロ を 使っ て いる シート を コピー し た の か 、 それとも マクロ 有効 ブック そのもの を コピー し て いる の か 不明 です ね 。 仮に 、 マクロ を 使っ て いる シート だけ を 新しい ブック に コピー し た 場合 、 標準 モジュール の プロシージャ は コピー さ れ ませ ん が 、 シート モジュール の プロシージャ は コピー さ れ ます 。 > VBA で マクロ 有効 シート を コピー する 事 は 出来る の でしょ う か ？ 丸ごと ブック を コピー し て 、 不要 な シート を 削除 すれ ば 済む こと です 。 わざわざ マクロ を 組む 必要 は ない か な 。 
取得 できる 場合 と そう で ない 場合 が ある という こと で あれ ば 、 imgURL = objIE . document . images ( 25 ). src が 正しく 取得 でき て いる か どう か の 結果 を 事前 に Msgbox ( imgURL = " http:// sample .jpg ") など で 確認 し た ほう が よい か と おもい ます 。 また objIE . document . image s.l ength で 画像 の 個数 を 調べる こと が できる ので for i = 0 to objIE . document . image s.l ength ･･･ 画像 の 判別 処理 （ objIE . document . images ( i ). src を 使う ） next i など で 25 番目 が 存在 する か どう か も 確認 し た ほう が よい かも しれ ませ ん ね 。 objIE の 読み込み 処理 が 完了 し て い ない 状態 で あっ たり 、 document . images ( 25 ). src が 空白 や DOM の 構築 が 正常 に さ れ て い ない 状態 で あっ たり する と result = URLDownloadToFile ( 0 , imgURL , savePath , 0 , 0 ) を 行っ て も ダウンロード が でき ない こと が ある か と 思い ます が 、 不具合 が 起きる 際 の result および imgURL の 結果 は 正常 でしょ う か ？ 
数式 の 例 です 。 A1 に 「 = IF ( ISBLANK ( A1 ),"", ROW ())」 と し 、 下 方向 へ フィル マクロ を 使っ た 例 です 。 Sub Sample () Dim i As Long , n As Integer n = 1 For i = 1 To Range (" A " & Rows . Count ). End ( xlUp ). Row Range (" B " & i ). Value = n n = n + 1 Next End Sub 
こんにちは。 出来上がっ た コード 、 よく 確認 し て ください 。 「 参照 設定 」 が 必要 という の です と 、 どこ か の オブジェクト で 、 エクセル が 接続 し て ある 、 という こと です 。 ユーザー が 自分 で 作成 し た コード の 場合 、 参照 設定 を 使わ ない で コード は 、 作成 でき ます 。 一度 参照 設定 で 、 コード を 作成 し 、 オブジェクト ブラウザー で 数値 を さがし たり 、 new の 命令 を 置き換える など で 、 対応 し ます 。 VBS コード を 作成 する 手順 で 、 参照 設定 の 切り離し を する ので そこら の 資料 も 参考 に なり ます 。 あと は 、 「 システム の お 便利 、 変換 機能 」 を 使っ て いる の が 原因 でし たら 、 代替 コード の 作成 、 など です 。 アクセス は 単体 起動 で エクセル の 参照 設定 は あり ませ ん 。 つまり 、 利用 し て いる オブジェクト が 存在 し て いる という こと です よ ね 。 参照 設定 は 、 環境 が 単一 でし たら 、 トラブル は 少ない の です が 、 バージョン の 違い が ある と 、 足かせ に なっ て しまう ので 、 設計 で は よく 注意 する もの な ん です 。 
C1 の セル を アクティブ に し て 条件 付き 書式 の 数式 を 使用 し て 、 書式 設定 する セル を 決定 を 選ぶ 式 は = C1 > D1 と し 書式 で 青 を 選択 そして 条件 付き 書式 の ルール の 管理 から 適用 先 を =$ C :$ C と し ます 。 後 は 同様 です 。 
画像 に [ pi c1 ] という 名前 を 付け て 、 [ pi c1 ] を 削除 し て いる ので 画像 は 残り ませ ん 。 画像 を 選択 し て い ない 時 の 処理 は 不要 な 気 が し ます 。 やる の で あれ ば 、 シート に 画像 を 張り付け て おき 、 表示 ・ 非表示 を 切り替える ほう が よい 気 が し ます 。 また 、 画像 を 読み込ん で 、 セル 範囲 で コピー 後 元 画像 を 削除 する の も 不要 だ と 思い ます 。 尚 、 保存 時 の 容量 の 問題 で あれ ば 、 保存 時 の オプション で 画像 の 解像度 を 指定 する こと で 回避 できる と 思い ます 。 サンプル コード を 示し て おき ます 。 私 は Option Explicit を 有効 に し て いる ので 、 変数 の 宣言 が 必要 と なっ て い ます 。 環境 によって は 、 Dim の 部分 は なく て も 動き ます が 、 なるべく 宣言 は し た ほう が よい と 思い ます 。 以上 、 参考 まで 。 Private Sub CommandButton 1 _ Click () Dim x As Single , y As Single ' 挿入 位置 座標 Dim x 2 As Single , y 2 As Single ' 画像 の 幅 ・ 高さ Dim fName As String ' 選択 画像 の パス Dim pName As String ' キャンセル 時 の 画像 名 Dim pPath As String ' キャンセル 時 の 画像 の パス Dim 画像 As Variant ' 画像 オブジェクト Dim flg As Boolean ' 画像 選択 フラグ ' キャンセル 時 の 画像 設定 pName = " pi c1 " pPath = ActiveWorkbook . Path & "\ no _ photo .jpg " x = Active Cell . Left y = Active Cell . Top ' セル 範囲 With Range ( Cells ( 4 , Active Cell . Column ), Cells ( 22 , Active Cell . Column )) .S elect x 2 = . Width y 2 = . Height End With fName = Application . GetOpenFilename (" 画像 ファイル ,*. gif ;*. jpg ;*. bmp ", 1 , " 画像 ファイル を 指定 し て 下さい ") flg = True ' 画像 選択 あり If fName = " False " Then flg = False ' 画像 選択 なし fName = pPath End If On Error Resume Next ' エラー 無視 ActiveSheet .S hapes ( pName ). Delete On Error GoTo 0 Set 画像 = ActiveSheet . Pictures . Insert ( Filename := fName ) With 画像 If flg = False Then ' 画像 選択 なし . Name = pName End If .S hapeRange . LockAspectRatio = True ' 比率 変換 . Placement = xlFreeFloating .S hapeRange .S caleHeight 1 , True ' なく て も 良い と 思う .S hapeRange .S caleWidth 1 , True ' なく て も 良い と 思う . Left = x . Top = y . Width = x 2 . Height = y 2 End With End Sub 
質問 の 中 で ピポット の 部分 が 不明 な ので 図 の シート が アクティブ な 場合 です 。 また 質問 の 説明 で は ComboBox 2 は 変更 さ れ て も 他 に は 影響 し ませ ん 。 ' ある コンボボックス 内 に 指定 文字列 の データ が ある か どう か を 判定 する 関数 Function isExists ( combo As ComboBox , str As String ) As Boolean Dim i As Integer isExists = True ' 答え を あり に する ( あっ たら すぐ 抜ける ので ) For i = 0 To combo . ListCount - 1 ' コンボ の データ を 順に If combo . List ( i ) = str Then Exit Function ' リスト が 指定 文字列 なら 終わり ( 答え は True ) Next isExists = False ' 最後 まで なかっ た ので 答え を 無し に する End Function ' 初期 設定 ( ComboBox 1 設定 ) Private Sub UserForm _ Initialize () Dim lastRow As Long Dim r As Long lastRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' A 列 最終 行 For r = 4 To lastRow ' 注目 行 を 4 行 目 から A 列 最終 行 まで If Not isExists ( ComboBox 1 , Range (" A " & r ). Value ) Then ' ComboBox 1 に A 列 注目 行 の 値 が 無かっ たら ComboBox 1 . AddItem Range (" A " & r ). Value ' ComboBox 1 に A 列 注目 行 の 値 を 追加 End If Next End Sub ' ComboBox 1 が 変更 さ れ た 時 Private Sub ComboBox 1 _ Change () Dim lastRow As Long Dim r As Long lastRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' A 列 最終 行 ComboBox 2 . Clear ' ComboBox 2 クリア ComboBox 3 . Clear ' ComboBox 3 クリア ( この 時 ComboBox 3 _ Change イベント が 起こっ て ComboBox 4 は 初期 化 さ れる ) For r = 4 To lastRow ' 注目 行 を 4 行 目 から A 列 最終 行 まで If Range (" A " & r ). Text = ComboBox 1 . Value Then ' A 列 注目 行 の 値 が ComboBox 1 の 値 なら If Not isExists ( ComboBox 2 , Range (" B " & r ). Value ) Then ' ComboBox 2 に B 列 注目 行 の 値 が 無かっ たら ComboBox 2 . AddItem Range (" B " & r ). Value ' ComboBox 2 に B 列 注目 行 の 値 を 追加 End If If Not isExists ( ComboBox 3 , Range (" C " & r ). Value ) Then ' ComboBox 3 に C 列 注目 行 の 値 が 無かっ たら ComboBox 3 . AddItem Range (" C " & r ). Value ' ComboBox 3 に C 列 注目 行 の 値 を 追加 End If End If Next End Sub ' ComboBox 3 が 変更 さ れ た 時 Private Sub ComboBox 3 _ Change () Dim lastRow As Long Dim r As Long lastRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' A 列 最終 行 ComboBox 4 . Clear ' ComboBox 4 クリア For r = 4 To lastRow ' 注目 行 を 4 行 目 から A 列 最終 行 まで If Range (" A " & r ). Text = ComboBox 1 . Value Then ' A 列 注目 行 の 値 が ComboBox 1 の 値 なら If Range (" C " & r ). Text = ComboBox 3 . Value Then ' C 列 注目 行 の 値 が ComboBox 3 の 値 なら ComboBox 4 . AddItem Range (" D " & r ). Value ' ComboBox 4 に D 列 注目 行 の 値 を 追加 End If End If Next End Sub 
こんにちは。 BASP 21 は 、 最新 の OS の 対応 、 64 bit の 使い方 、 など 、 有料 バージョン で サポート あり ます よ ね 。 「 アップデート 」 が 必要 という の は 、 「 プログラム の 完成 度 が 低い 」 対策 、 と 、 機能 を 追加 する 、 という の と 、 理由 は あり ます 。 BASP の 場合 、 メーラー の 機能 として 、 「 ここ まで の 機能 」 という 部分 で は 、 すでに 完成 し て い て 、 脆弱性 の 問題 も 、 ずっと 前 に 対策 し た きり です 。 それ こそ 、 「 機能 を 追加 し 続け て 、 脆弱 の 危険 と 向き合っ て いる 」 という 立場 の アプリ と 、 「 メモ帳 」 の よう に 、 機能 は そこそこ 、 で 、 脆弱 の 心配 の 無い もの と 、 混ぜ て 考え て は いけ ない という こと です 。 メーラー の データ処理 で とりわけ 、 文字コード が 複雑 な メール の 取り扱い は 、 データ を 処理 する 中 で は 大変 な ん です が 、 BASP 21 は 、 関数 は 確か に 存在 する の です けど 、 ユーザー が 期待 する 、 100% 間違い の 無い 変換 、 という の は 、 しません 。 メール を 扱う プログラム 側 で 、 「 ここ から ここ まで を 処理 」 と 、 小刻み に 処理 する 必要 が あり ます 。 一応 、 仕様 という こと に し て ます けど ね 。 普通 に 使っ て いる メーラー で さえ 、 「 エンコード の 切り替え 」 が ある くらい です から 、 提供 さ れる アプリ が 全部 正しく 処理 し て くれる 、 なんて こと は 、 当分 考え られ ませ ん 。 メール プロトコル の 仕様 で は 、 限界 でしょ う 。 BASP で 、 もし 改善 さ れる と し たら 、 の 話 です 。 話 を 戻し ます が 、 BASP の 有料 版 を 検討 し て み て ください 。 メーカー の 会社 に 、 有料 サポート し て もらっ たら いい か と 。 
. Value を . Text に 変更 。 Do While Workbooks (" xxxxx . xlsm "). Sheets (" xxxx "). Range (" xx "). Text = "# VALUE !" And Workbooks (" aaaaa . xlsm "). Sheets (" aaaa "). Range (" aa "). Value <> Workbooks (" xxxxx . xlsm "). Sheets (" xxxx "). Range (" yy "). Value 
こんにちは。 この コード は 、 シート の コード です から 、 コード を 確認 し て 、 「 別 の シート 」 に 使っ て いる 部分 を 、 修正 し 、 シート 名 は 指定 し ない よう に し て ください 。 change の イベント は 、 value が 変化 し た とき な ので 、 イベント 抑制 は し ない で やっ て み て ください 。 エラー 処理 です が 、 一旦 設定 し ない で 作っ て み て ください 
まずは 構想 を 練る ？ カード と は 何 を 指す の か ？ 仮に ３ 枚 の カード から 始め 正否 による 処理 の 違い を 決める 等 プログラム 以前 の 不 明確 ( あなた が やり たい こと ) な 部分 が 多 過ぎる と 感じ ませ ん か ？ 
質問 文 を 何 度 読ん で も 状況 が 全く 分かり ませ ん 。 何 を 回答 すれ ば 良い の でしょ う か ？ > visual studio 2015 で ちゃんと 合っ て いる はず な のに 沢山 の エラー が で て き ます ・ 「 Visual Basic 」 の カテ な ので 「 Visual Basic 」 の 言語 で 良い の でしょ う か ？ ・ 何 が ちゃんと 合っ て いる の でしょ う か ？ ・ 合っ て いる 「 はず 」 と は 、 どういう 事 でしょ う か ？ ・ たくさん の エラー と は どんな エラー な の でしょ う か ？ （ コード や 内容 は ？ ） ・ あなた は 何 を やっ て いる の でしょ う か ？ （ 作業内容 不明 ） > そういう 場合 どう すれ ば いい です か ？ ・ そういう 場合 と は 、 どういう 場合 でしょ う か ？ 状況 が 全く 分かり ませ ん 。 > 拡張 とか って 関係 ある の です か ？ ・ 「 拡張 」 って 何 です か ？ ※ 情報 が ゼロ な ので 回答 は 不可能 か と 思い ます 。 
こんにちは。 ・ a ～ c or d 列 まで の 1 行 目 に 記載 さ れ て いる 文字 と 同じ 文字 を 各 sample * の 1 行 目 で 検索 し 同じ もの を 別 excel の 2 行 目 以降 に 貼り 付け ここ が 、 全く イメージ が 伝わり ませ ん 。 1 行 目 を 「 見出し 」 と いい ます 。 1 行 目 に 記載 し て いる 文字 は 、 まさに 、 見出し そのもの な ん です から 、 データ 部分 に 、 ある はず が 無い です 。 検索 する 、 という こと な ん です から 、 「 何 の 文字 」 を 、 どの 列 から 、 探す 、 という よう な 言い方 に なら ない と いけ ませ ん 。 テーブル から 探す 、 という 場合 、 「 どの 列 」 「 どの 文字列 」 を さがし 、 見つけ た とき の コピー の 範囲 を 、 「 どこ に 」 まで 、 説明 が 分から ない と いけ ませ ん 。 もし 、 そんな ふわーーー っと し た 質問 が 文章 に なっ て いる 書籍 だっ たら 、 徹底的 に 作者 に 文句 を いわ ない と いけ ませ ん 。 もし 、 それ を 教材 に し て いる 先生 が い たら 、 生徒 の 読解 力 を テスト し たい ん です か 、 と 質問 し て ください シート 名 を 使っ て 、 読込み さ せる ブック を 開く まで は 、 コード に する の は 難しく あり ませ ん 。 問題 は 、 開い た ブック の シート の データ を 扱う 部分 です 。 検索 という 場合 、 「 検索 の キーワード 」 は 、 どの 列 か 、 見つけ た 処理 、 見つけ られ ない 処理 、 そして 、 「 見つけ た 場合 の 転記 元 」 と 「 転記 先 」 を しっかり 把握 です 。 転記 先 の 説明 も 、 ふわーーっと し て いる ん です よ 。 どの ブック 、 どの シート 、 どの 行 、 まで 、 把握 し て ください 。 データ の 説明 で 、 見出し が ある の か 、 ない の か 、 も 、 よく 確認 し て ください 。 
どれ が いい と の 具体 的 な 書名 は ありません が 、 いわゆる 教科書 的 な 本 と 、 辞書 の よう に 何 でも 載っ てる 本 が あり ます 。 どちら を 求める の か ハッキリ し て から 探す と 、 探し やすい です 。 
I 列 まで です ね （ 確認 ） 。 Sub test () Dim i As Long , j As Long , n As Long Dim Emp ( 3 ) As Long For i = 1 To Cells ( Rows . Count , 11 ). End ( xlUp ). Row For j = 6 To 9 If Cells ( i , j ) = "" Then Emp ( j - 6 ) = j Else : Emp ( j - 6 ) = 99 End If Next n = WorksheetFunction . Min ( Emp ) If n <> 99 Then Cells ( i , n ) = Cells ( i , 11 ) Erase Emp Next End Sub で どう です か ？ 
下記 の コード でいか が でしょ う か 。 Sub Sample () Dim r As Long , n As Integer Dim st As Worksheet n = 1 With Worksheets ( 1 ) For r = 1 To . Range (" A " & . Rows . Count ). End ( xlUp ). Row Step 35 Set st = Worksheets (" 案内 表 " & IIf ( n = 1 , "", n )) . Range (" A " & r ). Resize ( 35 , 10 ). Copy st . Range (" A1 ") n = n + 1 Next End With End Sub 
下記 の コード は あなた の マクロ を Sheet 1 , Sheet 2 , Sheet 3 で 連続 的 に 実行 する もの です 。 Option Explicit Sub Sample () Dim stNames As Variant , stName As Variant , st As Worksheet stNames = Array (" Sheet 1 ", " Sheet 2 ", " Sheet 3 ") For Each stName In stNames Set st = ActiveWorkbook . Worksheets ( stName ) st . Columns (" H : H "). Select st .S ort .S ortFields . Clear st .S ort .S ortFields . Add Key := st . Range (" H1 "), _ SortOn := xlSortOnValues , Order := xlDescending , DataOption := xlSortNormal With st .S ort .S etRange st . Range (" A1 : AN 997 ") . Header = xlNo . MatchCase = False . Orientation = xlTopToBottom .S ortMethod = xlPinYin . Apply End With Next End Sub 実行 し たい シート を 変更 する とき は 「 stName = Array (" Sheet 1 ", " Sheet 2 ", " Sheet 3 ")」 を 変更 し て 下さい 。 
> B 1 < C1 だ と 時間 は くらべ られ ない の でしょ う か ？ 日付 型 （ シリアル 値 ） の データ 同志 なら 、 問題 ない です 。 他 の 型 も 考慮 に 入れる なら 、 If CDate ( Range (" B 1 "). Value ) < CDate ( Range (" C1 "). Value ) Then といった 操作 に なり ます ね 。 あと 余談 です が 、 値 を 日付 変換 可能 か どう か は 、 If IsDate ( Range (" B 1 "). Value ) Then MsgBox " 日付 に 変換 できる データ です " End If といった 書き方 で 検査 可能 です 。 
テーブル を 扱う とき は クラス を 作り ます 。 Insert だけ で なく Select の 時 に は 返っ て くる レコードセット が 複数 行 の 時 が あり ます よ ね ？ そういう とき は クラス の リスト で 扱う 方 が プログラム も すっきり し ます し 、 グリッド へ セット する とき も シンプル に なり ます 。 なにより クラス （ 構造体 ） を 使っ て データ構造 を カプセル化 する こと が オブジェクト指向プログラミング の 基本 です から 。 蛇足 です が 私 個人 は 殆ど の 場合 「 配列 」 で は なく 「 List ( Of T )」 を 使っ て い ます 。 List を 使え ば ReDim する 必要 は ありません し 、 Contains や Clear など 便利 な メソッド も ある から です 。 
下記 の コード でいか が でしょ う か 。 ただし ① 日付 に関して は 何 が し たい の か 理解 し きれ て い ない ので 「 システム 日付 （ ただし 土日 の 場合 は 翌 月曜日 ） 」 を 設定 し て い ます 。 ② A 列 が クリア さ れ た とき に は B 列 から D 列 も クリア し て い ます 。 ③ C 列 および D 列 は 数式 を 設定 し て い ます 。 ④「 理想 は ～」 について は 仕様 が 理解 でき なかっ た ので 実装 し て い ませ ん 。 Option Explicit Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim rng As Range Dim r As Long Dim dt As Date , wd As Integer For Each rng In Target . Cells ' 変更 さ れ た セル が A 列 の 2 行 目 以降 の とき だけ 実行 する If rng . Column = 1 And rng . Row >= 2 Then Application . EnableEvents = False If rng . Value = "" Then ' A 列 が クリア さ れ たら B : D も クリア する rng . Offset (, 1 ). Resize (, 3 ). ClearContents Else r = rng . Row ' B 列 に システム 日付 を 設定 する （ ただし 土日 の 場合 は 翌 月曜日 を 設定 する ） dt = Date wd = Weekday ( dt , vbMonday ) If wd >= 6 Then dt = DateAdd (" d ", 8 - wd , dt ) End If Range (" B " & r ). Value = dt ' C 列 に 曜日 を 表示 する ため の 数式 を 設定 する Range (" C " & r ). FormulaR 1 C1 = "= TEXT ( RC [- 1 ],"" aaa "")" ' D 列 に 産地 を 表示 する ため の 数式 を 設定 する Range (" D " & r ). FormulaR 1 C1 = "= IFERROR ( VLOOKUP ( RC [- 3 ], C [ 2 ]: C [ 3 ], 2 , FALSE ),"""")" End If Application . EnableEvents = True End If Next rng End Sub 
「 2016 . 6 . 25 」 の よう に ピリオド で 区切る 例 です 。 ActiveSheet . Name = Format ( Range (" A1 "). Value , " yyyy . M . d ") もし 「 2016 . 07 . 05 」 の よう に 一 桁 の 月 ・ 日 を 二 けた に する 場合 に は ActiveSheet . Name = Format ( Range (" A1 "). Value , " yyyy . MM . dd ") と し ます 。 
Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim rng As Range For Each rng In Target . Cells If rng . Value <> "" Then ーー 通常 処理 ーー End If Next rng End Sub と し ます 。 こう すれ ば 単一 セル と 複数 セル の 両方 に 対応 でき ます 。 
＞ 同じ 行 に ある 列 同士 の 足し算 ( D 8 = F8 + G8 、 D 9 = F 9 + G 9. ..) ⇒ 二 重 引用符 で 括る と ただ の 文字列 に なり ます ので エラー 。 又 、 この 仕様 と コード と が 相違 し て い ます ので 、 D 列 に 結果 表示 なら こんな 感じ です 。 セル 範囲 が 決まっ て いる なら 「 For Each ～ Next 」 の 方 が 分かり易い と 思い ます 。 Sub sample () Dim r As Range For Each r In Range (" D 8 : D1 8 ") r = Application .S um ( Cells ( r . Row , " F "). Resize (, 2 )) Next End Sub 
一 例 です 。 Private Sub Worksheet _ SelectionChange ( ByVal Target As Range ) If Inter sect ( Target , Range (" B2 : I 10 ")) Is Nothing Then Exit Sub If Target . Value = "" Then Target . Value = "○" Else Target . Value = "" End If Dim rng As Range , Hani As Range , buf As String For Each rng In Range ( Cells ( Target . Row , " B "), Cells ( Target . Row , " I ")) If rng . Value = "○" Then buf = buf & Cells ( 1 , rng . Column ) & "、" End If Next rng Range (" J " & Target . Row ) = Left ( buf , Len ( buf ) - 1 ) End Sub 
>> Option Explicit Sub main () Dim DirName , FileName , Buf As String Dim TergetBook As Workbook Dim Sale As Long Dim RowCount As Long Application . DisplayAlerts = False ' ファイル 登録 時 の 警告 を 無視 DirName = " C :\ Tmp \" ' 処理 する ファイル が 保存 さ れ て いる フォルダ FileName = Dir ( DirName & "*. xlsx ", vb Normal ) ' 最初 の ファイル 名 を セット RowCount = 1 Cells . Clear Do While FileName <> "" Set TergetBook = Workbooks . Open ( DirName & FileName ) TergetBook . Activate ' 読み込む エクセル ファイル を アクティブ に する Sale = Sheets (" 売上 "). Range (" E 1 "). Value TergetBook . Close Cells ( RowCount , 1 ) = FileName Cells ( RowCount , 2 ) = Sale RowCount = RowCount + 1 FileName = Dir () ' 次に 読み込む ファイル 名 を セット Loop Application . DisplayAlerts = True End Sub << ・ シート モジュール に 貼り 付け て ください 。 
カテゴリー 名 だけ の 抽出 なら VBA を 使っ た クローラー など を 開発 する より も 、 そもそも Amazon の 公開 し て いる ブラウズツリーガイド を 利用 する の が 良い の で は ない でしょ う か ？ https :// www . amazon.co.jp / gp / help / customer / display . html / ref = hp _ rel _ t ... Excel データ で ダウンロード でき ます 。 
> テキストファイル に 保存 し て コンパイル しろ おそらく あなた は 「 テキストファイル と は 何 か 」 から 説明 せ ね ば なら ぬ よう な 段階 だ と 察し ます ので 、 以下 の よう な 本 を 数 冊 読ん で ください 。 『 ワード を 捨て て エディタ を 使お う 第 ２ 版 』 by 鐸木 能 光 http:// takuki . com / edit . html ＊ ＊ ＊ また 、 コマンドライン で の 操作 に も 慣れる 必要 が あり ます ので 、 下 の よう な サイト や 本 で CUI で の 操作 に 慣れ て ください 。 Tech TIPS ： これ だけ は 覚え て おき たい Windows の コマンドプロンプト の 使い方 ( 1 / 2 ) - ＠IT http:// www . atmarkit . co.jp / ait / articles / 1502 / 13 / news 147 . html 
> NetworkDays ( Range (" L " & 行 ). Today ) ↓ NetworkDays ( Range (" L " & 行 ), Today ) だ と 思い ます また 、 この 記述 は Do ～ Loop 内 に ない と まずい の で は ？ Now を 使う と 、 時分 秒 も 有効 に なる ので 、 日付 だけ の もの と 比較 する の は 都合 悪い ？？？ If について は 、 日付 が 埋まっ て いる か ･･･ これ だけ の 判別 で やっ て から 、 さらに If し て みる とか ？ 雰囲気 以下 で どう なり ます か Public Sub Samp 1 ()     Dim iRow As Long     Dim v As Variant     iRow = 4     While ( Cells ( iRow , " P "). Value <> " Exit ")        v = ""        If ( Cells ( iRow , " L "). Value <> "") Then           If ( Cells ( iRow , " L "). Value < Date ) _              And ( Cells ( iRow , " R "). Value = " 未 着手 ") Then              v = WorksheetFunction _                    . NetworkDays ( Cells ( iRow , " L "). Value , Date )           End If        End If        Cells ( iRow , " P "). Value = v        iRow = iRow + 1     Wend End Sub ※ 何 行 も ある の なら 、 描画 を 止め て やる と 速く なる か と Application .S creenUpdating = False ～～～ Application .S creenUpdating = True ※ While ～ Wend は 途中 抜け出さ ない 時 の 私 の 記述 な ので ･･･ Do While ～ Loop とか Do ～ Loop While とか Do ～ Loop Until とか 適宜 変更 し て み て ください ※ チョット でも 速く し たい の なら Cells ( iRow , " P ") → Cells ( iRow , 16 ) 等 、 列 を 文字 から 数値 に し て みる と か 
＞ ＶＢＡ を 使用 し て 、 勤務 表 を 作成 し たい と 思い ます 。 ＞ 対応 できる 方 が いらっしゃる の なら ・ ・ ・ ・ VBA を 扱う 方 で あれ ば 、 ご存知 か と 思い ます が 、 この よう な 抽象 的 な 質問 で は 、 だれ も 、 まとも な 対応 は 出来 ない と 思い ます 。 どの よう な 表 に なっ て いる の かも 提示 せ ず 、 どこ に 何 を 入力 し たら 良い の か も わから ず ・ ・ ・ 丸投げ で あれ ば 、 その よう に 記載 すれ ば まだ まし か と 思い ます が ・ ・ ・ 
こんにちは。 > ＷＥＢ ページ の 好き な 部分 を 比較 し て 表示 さ せ たい 示し て いる コード は 、 エクセル シート に コントロール を 設置 し て 、 url を 投げ た 、 という ところ まで です 。 比較 も そう です が 、 最初 から 、 専用 の シート を 作成 し て 、 表示 さ せる コード の ほう が 、 楽 です 。 コード は 、 ある の か 、 ない の か 、 の チェック から 始まり 、 「 問題 なく 表示 でき そう だ 」 という 状況 なら 、 投げる 、 様子 が 変 なら 、 シート に コントロール を 新規 追加 し て 、 url を 投げる 、 という 動作 。 ページ の スクロール も あり ませ ん 。 ただ 表示 し た だけ です 
替え た の は WIndows の Ver だけ っす か ？ 32 bit から 64 bit に 変え たり し て ませ ん か ？ もし 、 替え て たら http:// answers . microsoft . com / ja - jp / windows / forum / windows _ 7 - windows _... 参考 に なる かも 。 
たぶん 、 4 を 完全 に 使わ ない 事 は 可能 です 。 ただ 、 4 を 使わ ない こと で 項 数 が 増える と し たら 、 どっち が 優先 です か ？ 100 だろ う が 10010 だろ う が デカイ だけ なら 10 で 全部 受け持っ て くれ ます 。 問題 は 残っ た 11 ～ 14 を どう する か ？ に 帰着 さ れる でしょ う 。 どれ も 4 を 使わ ず に 出来 そう です ね 。 11 = 5 + 6 12 = 5 + 7 13 = 5 + 8 14 = 5 + 9 
Vlookup という 関数 を 使え ば でき ます 。 ただ 、 別 シート の ランク 表 は この 関数 を 使う ため に 少し 書き換える 必要 が あり ます 。 今 の A - E 列 を B - F 列 に 移動 し て 、 空い た A 列 に は E 列 と 同じ 値 を 入れ て ある という 前提 で 、 D4 に は = vlookup ( c4 , 別 シート ! a 4 : f6 , 2 , true ) E 4 に は = vlookup ( c4 , 別 シート ! a 4 : f6 , 3 , true ) と し て ください 。 vlookup の 説明 は ネット で 解説 を 探し て いただい て 、 上記 と 比較 し て 見 て 頂けれ ば ご 理解 いただける と 思い ます 。 
> yastak 21 さん 2016 / 6 / 1022 : 49 : 18 > データベース 追加 処理 が 出来 ませ ん でし た と は 何 でしょ う か ？ データベース に 追加 出来 なかっ た 。 と 言う 事 です 。 
選択 し たい だけ なら 、 なぜ CommandButton 1 _ Click で もう一度 シート を 検索 し て AddItem し て いる の でしょ う か ？ マスター シート の 項目 数 が ４つ な のに 、 なぜ リスト ボックス の 項目 数 を ３つ に し て いる の でしょ う か ？ リスト ボックス の 表示 内容 の 「 １ ９ ９ ２ 」 や 「 ２ ０ ０ ２ 」 は どこ から 得 て いる の でしょ う か ？ 正確 な 回答 が 得 たけれ ば 正確 な 情報 を 提示 し て 下さい 。 
この よう な 感じ か な ・ ・ ・ 。 一 例 です 。 B 列 の 値 が 複数 ある 場合 は 、 A 列 の データ は 何 か を 聞い て き ます 。 後 は 、 ご 自分 で 応用 し て ください 。 Sub Sample () Dim sh 1 As Worksheet , sh 2 As Worksheet , Key As String Dim cnt As Integer , i As Long , Hani As Range Set sh 1 = Worksheets (" Sheet 1 ") Set sh 2 = Worksheets (" Sheet 2 ") With sh 2 Set Hani = . Range (" B 1 : B " & . Range (" B " & Rows . Count ). End ( xlUp ). Row ) cnt = WorksheetFunction . CountIf ( Hani , sh 1 . Range (" A1 ")) If cnt > 1 Then Key = InputBox (" 複数 ある ので A 列 の データ入力 ") For i = 1 To Hani . Rows . Count If sh 1 . Range (" A1 ") = . Cells ( i , " B ") And . Cells ( i , " A ") = Key Then sh 1 . Range (" B 1 ") = . Cells ( i , " C ") Exit Sub End If Next i End If For i = 1 To Hani . Rows . Count If sh 1 . Range (" A1 ") = . Cells ( i , " B ") Then sh 1 . Range (" B 1 ") = . Cells ( i , " C ") Exit Sub End If Next i End With End Sub 
ソース を 眺め た だけ で 実行 し て い ませ ん が 、 SrcWs . Range ( tbl ( i ) & " 2 ", SrcWs . Range ( tbl ( i ) & Rows . Count ). End ( xlUp )). Copy を SrcWs . Range ( SrcWs . Range ( tbl ( i ) & " 2 "), SrcWs . Range ( tbl ( i ) & Rows . Count ). End ( xlUp )). Copy として み て 下さい 。 
flag = False for r = 2 To Range (" A " & Rows . Count ). End ( xlUp ). Row If Range (" A " & r ). Value <> 0 Then flag = True Exit For End If Next r If flag Then ' 処理 を 行う End If この 程度 の ループ で あれ ば 20000 行 あっ て も 一瞬 です 。 100 万 行 でも 5 秒 くらい でし た よ 。 
下記 の コード を ThisWorkbook の シート モジュール に 設定 する と 、 通常 の 「 上書き保存 」 を 行っ た 際 に 「 保存 および バックアップファイル を 別 フォルダ に 移動 」 を 行い ます 。 また 、 編集 後 に 保存 せ ず に 終了 しよ う と する と 自動的 に 「 上書き保存 」 を 行う よう に なり ます 。 なお 、 「 dest = " バックアップ 先 の フォルダ " & "\" & xlkName 」 は 適宜 変更 し て 下さい 。 Option Explicit Private Sub Workbook _ AfterSave ( ByVal Success As Boolean ) Dim xlkNameWithoutExt As String , xlkName As String Dim sour As String , dest As String ' バックアップファイル の 名前 を 取得 する xlkNameWithoutExt = Left ( ActiveWorkbook . Name , Len ( ActiveWorkbook . Name ) - 5 ) ' バックアップファイル が 存在 する か どう か を 判定 する xlkName = Dir ( ActiveWorkbook . Path & "\" & xlkNameWithoutExt & "*. xlk ") ' バックアップファイル が 存在 し たら バックアップファイル を 別 フォルダ に 移動 する If xlkName <> "" Then sour = ActiveWorkbook . Path & "\" & xlkName dest = " バックアップ 先 の フォルダ " & "\" & xlkName On Error Resume Next ' バックアップ 先 の フォルダ に コピー する FileCopy sour , dest ' コピー が 成功 し て い たら バックアップファイル を 削除 する If Err . Number = 0 Then Kill sour End If On Error GoTo 0 End If End Sub Private Sub Workbook _ BeforeClose ( Cancel As Boolean ) If Not ThisWorkbook .S aved Then Application . DisplayAlerts = False ThisWorkbook .S ave Application . DisplayAlerts = True End If End Sub 
やり たい こと が ピン とき ませ ん が 、 具体 的 な コード で 示し て いただけ ます か ？ もし 、 Command Button 1 _ Click () を Command Button 1 _ Click ( ByRef HogeHoge As Integer ) など の よう に したい 、 という こと で あれ ば 「 出来 ませ ん 」 。 
この よう な 数式 で 可能 だ と 思い ます 。 = LEFT ( A1 , FIND ("/", A1 )) 
それ です と 、 「 TEXTBOX 2 . Hoge 」 という 名前 の ディレクトリ を カレントディレクトリ 内 に 作成 せよ 。 という コード に なっ て い ます 。 カレントディレクトリ は おそらく プロジェクト の フォルダ な ので 、 そこ に 「 TEXTBOX 2 . Hoge 」 という ディレクトリ が 作成 さ れ て いる の で は ない です か ？ TEXTBOX 2 の 内容 は 、 TEXTBOX 2 . Text で 取得 し ます 。 また 、 TEXTBOX 2 . Text の 内容 を 親 ディレクトリ と し た パス を 作成 する に は 、 以下 の よう に し ます 。 System . IO . Pat h. Combine ( TEXTBOX 2 . Text , " Hoge ") よって 、 指定 の ディレクトリ を 作成 する に は 、 以下 の よう に し ます 。 System . IO . Director y . CreateDirectory ( System . IO . Pat h. Combine ( TEXTBOX 2 . Text , " Hoge ")) 
ぐるぐる 回す 必要 は ある の でしょ う か ね ？ Sub 一 例 です () Dim xFormula As String , rng As Range Const cFormula 1 As String = "= SUM (@@)" Const cFormula 2 As String = "=@ 1 /@ 2 " With Columns ( 1 ). SpecialCells ( xlCellTypeConstants ) Set rng = . Cells (. Count ). Offset ( 2 , 1 ) rng . Formula = Replace ( cFormula 1 , "@@", . Offset (, 1 ). Address ( False , False )) xFormula = Replace ( cFormula 2 , "@ 2 ", rng . Address ) xFormula = Replace ( xFormula , "@ 1 ", . Cells ( 1 ). Offset (, 1 ). Address ( False , False )) . Offset (, 2 ). Formula = xFormula End With End Sub 
下記 が 参考 に なる と 思い ます 。 複数 の コントロール を 操作 する http:// www . moug .net / tech / exvba / 0090067 . html 
この 質問 書い てる 時間 で 手作業 で 終わり ます よ 。 マクロ に する 理由 って 何 です か ？ 
gyou ＝･･･ の 前 に 変数 の 型 宣言 が まず 必要 です （´∀｀） Dim gyou as long ' long 型 の gyou を 宣言 gyou = Sheets (" 受付 情報 "). Range (" B 65536 "). End ( xlUp ). Offset ( 1 , 0 ). Row また 値 を 転記 する 部分 です が 左辺 の Sheets (" 受付 情報 "). Cells ( gyou , xxx ). Value は 文法 として 問題 ない の です が = で 指定 し て いる 右辺 の Range ( xxx , yyy ) の 部分 で エラー が で て い ます 。 Range は 範囲 を 指定 する クラス です が 、 今回 の 場合 の よう に 特定 の セル を 指定 する 場合 は Cells を 使う と エラー が で ませ ん 。 Sheets (" 受付 情報 "). Cells ( gyou , xxx ). Value ＝ Cells ( yyy , zzz ). value 
> columns ( 1 ), 0 は 、 どの よう な 意味 を 持ち ます か ？ 「 Application . Match 」 で ワーク シート で 使用 する MATCH 関数 が 起動 さ れ ます 。 な ので 、 （） 内 の ３つ の パラメータ は 、 Excel の MATCH 関数 の 3つ の パラメータ と 同じ 意味 です 。 
クラス で 処理 する 方法 は 知り ませ ん 。 もし ラベル に 連続 し た 番号 が 振ら れ て いる の なら 下記 方法 で 処理 出来 ます 。 Excel VBA フォーム で コントロール 配列 （ もどき ） ( 4 ) http:// plaza . rakuten . co.jp / puppypc / diary / 200905250000 / 
2 行 目 以降 に 「 □ □ 1 □□□ 赤坂 署 □□㈱ ホンダ □ □ 千代田区霞が関 □ □ 」 が たくさん ある なら VBA で なく て 、 データ の 区切り 位置 で 、 □ が 全角 空白 なら 区切り 文字 に 全角 空白 を し て み たら どうでしょう 。 その 際 に 、 「 連続 し た 区切り 文字 は ..」 に チェック を 入れ て ください 。 もし 、 固定 長 なら 、 区切り 文字 で 無く 最初 に 「 スペース によって ..」 の 方 で 、 区切り の 箇所 ( 何 文字 目 か ) を 指定 し て も 良い と 思い ます 。 
コピー で は なく B . xlsm の Ｆ１ に = Vlookup ( A1 ,[ A ] Sheet 1 ! A : D , 3 , 0 ) 同じく Ｇ１ に = Vlookup ( A1 ,[ A ] Sheet 1 ! A : D , 4 , 0 ) と し 2 行 目 以降 ドラッグ すれ ば A . xlsm の C , D の 値 が 表示 さ れ ます 。 A . xlsm と の リンク を 恥じ し たけれ ば B . xlsm で 全 セル を 選択 後 値 貼り 付け を すれ ば 上 の 式 は 消え 値 のみ 残り ます 。 
こういう こと でしょ う か Sub 星 の 表示 () Dim i As Integer , n As Integer n = 10 i = 1 Do While i <= n Debug . Print Format ( i , " 00 ") & String ( i , "*") i = i + 1 Loop End Sub 
こういう こと ？ For i = 1 To N tokuten = X ( i - 1 ) Select Case tokuten Case 60 To 70 MsgBox tokuten & " 点 は " & hantei ( 1 ) Case 71 To 80 MsgBox tokuten & " 点 は " & hantei ( 2 ) Case 81 To 90 MsgBox tokuten & " 点 は " & hantei ( 3 ) Case 91 To 100 MsgBox tokuten & " 点 は " & hantei ( 4 ) Case Else MsgBox tokuten & " 点 は " & hantei ( 0 ) End Select Next i 
ループ な ので 、 Do While cells ( i , 1 ). value ="" cells ( i , 1 ). copy cells ( i , 2 ). pastespecial Loop くらい で いい の では ？ 
とりあえず 、 下 の 図 の よう な パターン で 表示 し たい という こと でしょ う か ？ ・ 画像 を 見易く する ため に 、 上下 2 段 に 分け て い ます 。 ・ D2 セル に 一つ の 数式 を 入れ て 、 後 は 他 の H2 , L 2 , P2 , ・ ・ へ と コピペ し て い ます 。 下 の 図 の よう な パターン の 表示 で よけれ ば 、 ① D2 セル に 、 ・ = IFERROR ( IFERROR ( LOOKUP ( 1 , 0 /(( B5 : B 8 = B2 )*( C5 : C 8 <>"")* COUNTIF ( C 2 , C5 : C 8 &"*")), D 5 : D 8 ), INDEX ( D 5 : D 8 , MIN ( INDEX ((( B5 : B 8 <> B2 )+( C5 : C 8 <>""))* 100 + ROW ( B5 : B 8 )- ROW ( B5 )+ 1 ,)),)),"")&"" の 式 を 入れ ます 。 とりあえず この 画像 の 表示 で よけれ ば 、 他 の ご 質問 の 部分 は 返信 で 補足 し ます 。 
再帰 処理 で いい なら これ で どーん （ 「 x :\ y \ 1 \ 1 \ 何かしら の フォルダー \」 も 対象 に し て よい なら ） 見にくい と 思っ た ので 間 に アンダーバー が 入れ まし た 。 不要 な 気遣い なら 、 set folName =%%~ nd _ （ この コード は こう なる ： x :\ y \ 1 \ 1 _ aaa . mp4 ） を set folName =%%~ nd と し て ください 。 ―― ―― ―― ―― ―― ―― ―― ここ から ――――――――――――――― @ echo off setlocal enable delay ed expansion set renTargetExt =. txt : MainRoutine for / f " usebackq delims =" % % f in (` dir / s / b / a - d / on *% renTargetExt %`) do ( set fileName =%% f rem フォルダ 名 を 取得 し て 右端 の \ を 消し rem GetFolderName に ファイル 名 と 誤認 さ せ て 取得 する set folName =%%~ dpf set folName =! folName :~ 0 ,- 1 ! echo --- call : GetFolderName set newFileName =! folName !%%~ nxf echo ren "! fileName !" "! newFileName !" ren "! fileName !" "! newFileName !" ) echo -- fin -- pause exit : GetFolderName for / f " usebackq delims =" % % d in ('! folName !') do ( rem フォルダー 名 に デリミタ を 入れる 処理 は ここ で やっ て ます set folName =%%~ nd _ ) exit / b ―― ―― ―― ―― ―― ―― ―― ここ まで ――――――――――――――― あと なんか 注意 事項 あっ た っけ ？ たぶん ない けど 試す とき に ダミー 作り たい とき に は 私 の 知恵 ノート 参照 し て ください 以上 
train _ benoist さん が 危惧し た 通り 、 複数 の セル 範囲 を 一 度 に コピー する こと は 出来 ませ ん ので 、 train _ benoist さん の ソース に 少々 手 を 加え まし た 。 「 ブック A 、 B 、 ともに 同じ フォルダ 内 」 と の こと な ので それ も 加味 し て い ます 。 Option Explicit Sub 転記 後 消去 () Dim rng As Range , area As Range Set rng = ThisWorkbook . Worksheets (" 入力 ") _ . Range (" D3 : F3 , D 5 , E 5 , F5 , D 7 , E 7 , F 7 , D 9 : E 9 , I 9 , D1 1 : E 11 , I 11 , D1 3 : F1 3 , I 13 , D1 5 : I 19 , I 3 ") Application .S creenUpdating = False Application . DisplayAlerts = False With Workbooks . Open ( ThisWorkbook . Path & "\ データ . xlsx ") With . Worksheets (" 受付 情報 "). Range (" B " & Rows . Count ). End ( xlUp ). Offset ( 1 ) For Each area In rng . Areas area . Copy . Offset ( area . Row - rng . Row , area . Column - rng . Column ) Next area End With . Close True End With rng . ClearContents ThisWorkbook . Close True Application . DisplayAlerts = True Application .S creenUpdating = True End Sub 
osaka _ metabo さん も 回答 さ れ て い ます が 、 貴方 が やろう と し て いる こと は Excel の 範疇 を 超え て 、 「 CAD ソフト 」 の レベル に 近く なっ て い ます 。 最初 から 全部 自動的 に やる の で は なく 、 まず エクセル の レベル 出来る こと を 見極め ましょ う 。 パネル ・ バー ・ アングル といった 部材 を すべて マクロ で 描画 さ せる の で なく 、 あらかじめ エクセル の 図形 を 組み合わせ て 「 パネル 」 「 バー 」 「 アングル 」 の 図形 を 作る ところ から 始め て 下さい 。 それ だけ でも 手作業 の 範囲 が 随分 少なく なる と 思い ます よ 。 
いくつ か 間違っ て いる 箇所 が あり ます 。 テストラン し た バッチ を 以下 に 掲載 し ます 。 自分 の 環境 で テスト する ため に 、 DSET フォルダ の 場所 を 変え て い ます 。 適時 変更 し て ください 。 また 、 フォルダ や ファイル に 半角 スペース が あっ て も 移動 出来る よう に し まし た 。 -- ここ から ------ @ echo off TITLE ファイル 移動 rem TEMP \ TEST フォルダ に 作成 さ れ た ファイル 全部 を 、 rem タイムスタンプ 付 フォルダ を 作成 し て 移動 する バッチ color 3 F set dateStr =% date :/=% set timeStr =% time ::=% set timeStr =% timeStr :.=% set timeStr =% timeStr : =% set DEST = C :\ A B C \ rem set DEST = C :\ Users \ USER 01 \ Desktop \ set SOURCE = C :\ temp \ test \ set nowdir =% DEST %% dateStr %% timeStr % echo dateStr =% dateStr % echo timeStr =% timeStr % echo DEST =% DEST % echo SOURCE =% SOURCE % echo nowdir =% nowdir % pause mkdir "% nowdir %" move "% SOURCE %*.*" "% nowdir %\" rem 以下 、 検証 する ため に 作っ た 不要 な バッチ dir "% nowdir %\" echo 元 に 戻す pause move "% nowdir %\*.*" "% SOURCE %" dir "% SOURCE %" pause -- ここ まで ------ 3つ 目 の set timeStr = 行 は 不要 な よう な 気 が し ます 。 後半 に 検証 の ため の 戻し バッチ を 作っ て あり ます が 、 動作 する よう に なっ たら 削除 し て ください ませ 。 では 
一 例 です Application . DisplayAlerts = False ' シート 数 が 4 以下 に なる まで 繰り返し Do Until Worksheets . Count <= 4 ' 最後 の シート を 削除 Worksheets ( Worksheets . Count ). Delete Loop Application . DisplayAlerts = True 
Set a = Workbooks (" H2 8 受注 業務 . xlsx "). Worksheets (" 業務 マスター "). Range ( Cells ( 1 , 1 ), . Cells ( 10 , 3 )) を Set a = Range ( Workbooks (" H2 8 受注 業務 . xlsx "). Worksheets (" 業務 マスター "). Cells ( 1 , 1 ), Workbooks (" H2 8 受注 業務 . xlsx "). Worksheets (" 業務 マスター "). Cells ( 10 , 3 )) として み て ください 。 複数 の ブック ・ 複数 の シート を 扱う マクロ で Range および Cells を 使う とき は 常に 「 どの ブック の どの シート 」 を 意識 し た コード を 書く よう に 心がけ て 下さい 。 単純 に Cells ( 1 , 1 ) と 書く と 「 Active な シート 上 の 」 という 意味 に なっ て しまい ます 。 
area ID が 1 でも 2 で も ない とき は nameRng は 前 の シート の 名前 の まま に なり ます 。 つまり シート の 名前 を 既に 存在 し て いる 名前 に 変更 しよ う と し て いる ので エラー に なっ て しまい ます 。 もしかして マクロ の 中 の 削除 し て しまっ た 部分 で areaID を 設定 し て い たり し ませ ん か ？ 
仕様です 。 ListBox の 行 と列 は ゼロ から 始まる ので 、 Variant に 格納 し た とき も ゼロ から 始まる よう に なっ て い ます 。 つまり ListBox の List と それ を 格納 し た Variant 配列 と は 同じ インデックス 番号 で アクセス できる 、 という こと です 。 
Single を 使っ て いる から 。 浮動小数 点 型 で は 小数点 以下 の 数値 を 正しく １ ０ 進数 で 持つ こと が 出来 ませ ん 。 どうしても 小数点 以下 を 正しく 保持 し たい の で あれ ば 、 小数点 以下 4 桁 まで なら Currency 、 それ 以外 なら Long や Integer に 入れる しか ない です 。 その 際 も 、 小数点 以下 何 桁 まで 保持 する か 決め 、 その 分 １ ０ の 累乗 を 掛ける 処理 を する しか ない です 。 
下記 の コード で test . csv という ファイル が 作ら れ ます 。 Option Explicit Sub Sample () Dim text () As String , lineData As String , lines () As String Dim r As Long , c As Long , cnt As Integer , lineCount As Long ReDim lines ( 0 ) lineCount = 0 For r = 1 To Range (" A " & Rows . Count ). End ( xlUp ). Row text = Split ( Range (" A " & r ). Value , vbLf ) For cnt = 0 To UBound ( text ) lineData = text ( cnt ) For c = 2 To Range (" A " & r ). SpecialCells ( xlCellTypeLastCell ). Column lineData = lineData & ", " & Cells ( r , c ). Value Next c ReDim Preserve lines ( lineCount ) lines ( lineCount ) = lineData lineCount = lineCount + 1 Next Next Open " text . csv " For Output As # 1 For cnt = 0 To UBound ( lines ) Print # 1 , lines ( cnt ) Next Close # 1 End Sub 
SELECT 日付 , 商品 番号 , DMax (" 販売 数 "," テーブル 1 "," 商品 番号 =" & [ 商品 番号 ] & " AND 日付 <=" & [ 日付 ]) AS 販売 数 新 記録 FROM テーブル 1 ORDER BY 日付 , 商品 番号 「 販売 数 新 記録 」 が DMax の せい で 文字列 扱い に なっ て しまい ます が 、 数値 に する 必要 が あれ ば 、 おまじない で 。 DMax (" 販売 数 "," テーブル 1 "," 商品 番号 =" & [ 商品 番号 ] & " AND 日付 <=" & [ 日付 ]) - 0 AS 販売 数 新 記録 
バージョン の 不 整合 です ね 。 基本的 に は 、 表示 さ れ て いる メッセージ の 通り です 。 参照 し て いる モジュール の バージョン を 確認 し て 適切 な バージョン に 置き換える か 、 参照 方法 を バージョン が 依存 し ない 形 に 変更 し て 下さい 。 別 な 言い方 を する と 、 参照 設定 が 適切 で は あり ませ ん 。 どこ か で 論理 破綻 し て いる （ 不 整合 が 発生 し て いる ） 可能性 が あり ます 。 環境 や モジュール 設計 等 を 見直し て み て 下さい 。 > 恥ずかしながら 私 は Visual Studio を 使用 し た こと が 殆ど なく 、 どういう 手順 で 操作 を 行え ば 解消 できる か 記載 し て 頂ける と 非常 に 助かり ます … 手順 の 前 に 、 構成 や 構造 、 あるいは 環境 を 見直す 必要 が ある でしょ う 。 設計 レベル あるいは 環境 レベル の 問題 だ と 思い ます ので 、 まずは それら を 見直し て 下さい 。 （ それ によって 、 操作 の 内容 が 変わっ て くる 可能性 が あり ます ） 
下記 の サイト が 参考 に なる と 思い ます http:// uni lab. gbb 60166 .jp / vbe / v be. htm 
End Select が 無い 。 ちゃんと IF や SelectCase を Tab で 段落 と し し て い たら 、 すぐ わかる 筈 です 。 
テキストボックス の Value は String な ので 、 文字列 の 比較 に なり ます 。 文字列 の 比較 です と 左 の 桁 から 順に 比較 さ れる ため 、 例えば 2 と 10 を 比較 する と 、 2 の ほう が 大きい と 判定 さ れ ます 。 数値 の 比較 が し たい の で あれ ば 、 Val 関数 など を 使用 し て 文字列 を 数値 に 変換 し て から 比較 する 必要 が あり ます 。 修正 前 ） If Me ! txt 1 . Value > Me ! txtL 2 . Value Then 修正 後 ） If Val ( Me ! txt 1 . Value ) > Val ( Me ! txtL 2 . Value ) Then 
i = Range (" G 6 ") + 4 s = Range (" H6 ") + 4 です が 、 管理 表 シート の G 6 セル の 内容 に 4 を 加え た 値 が 開始 行 管理 表 シート の H6 セル の 内容 に 4 を 加え た 値 が 終了 行 という コード に なっ て い ます が 間違い は あり ませ ん か ？ Do While i = s で は ループ に 入ら ず に 抜け て しまい ます 。 Do While i <= s と し て ください 。 Worksheets (" 管理 表 "). PrintOut です が 、 これ で は 管理 表 シート を 印刷 する こと に なり ます 。 本社 シート を 印刷 する の なら wa . PrintOut と し て ください 。 
Excel VBA の 話 でしょ う か ？ マルチ ページ という 言い方 は 聞い た こと が ない の です が ？ Excel で は ブック 、 シート 、 行 、 列 、 という 言い方 が 一般的 です 。 
以下 の コード でいか が でしょ う か 。 Private Sub Command Bu t to n2 _ Click () Dim r As Variant , i As Long On Error Resume Next r = 0 r = WorksheetFunction . Match ( TextBox 1 . Text , Range (" A : A "), 0 ) On Error GoTo 0 If r = 0 Then MsgBox " 未 登録 の 購入者 です 。 " TextBox 1 .S etFocus Else For i = 2 To 5 Controls (" TextBox " & i ). Text = Cells ( r , i ). Value Next TextBox 2 .S etFocus End If End Sub 
Sheet 1 に 図形 を 挿入 さ せ たい の で あれ ば With ActiveSheet . Range (" G10 : H1 0 ") を Worksheets (" Sheet 1 "). Activate With Selection として み て ください 。 
Application . displayalart = False Workbooks . open Application . displayalart = true たぶん これ で 行ける と 思い ます 。 
Sub StarDisplay () Dim n As Integer n = 1 Do While n <= 10 Debug . Print Format ( n , " 00 ") & String ( n , "*") n = n + 1 Loop End Sub 
不可 , 可 , 良 , 優 の 判定基準 を 書い て 下さい 。 
ググっ た だけ だ けど 、 これ で でき そう な 。 。 。 https :// msdn . microsoft . com / ja - jp / library / ms 749020 . aspx https :// msdn . microsoft . com / ja - jp / library / system . drawing . bitmap . aspx https :// msdn . microsoft . com / ja - jp / library / system . windows . media . pixel ... 
取り急ぎ 、 オブジェクト の 親 クラス を 省略 せ ず 、 すべて 明示 的 に 参照 する よう 修正 し て み て は 如何 でしょ う か 。 Sub Macro 1 () With Application . ThisWorkbook . ActiveSheet . Range (" F 7 : G10 "). Copy . Range (" I 8 "). Select . Paste End With End Sub 
grid view 内 に 配置 さ れ た コントロール に アクセス する ため に は ID だけ で は 不十分 です 。 gridview の row に対して FindControl し て 、 コントロール を 取得 し て ください 。 以下 こんな 感じ で できる はず 。 判定 等 は 書い て い ない ので 、 そこ は 補っ て ください 。 For Each dR As GridViewRow In grdKyujinList . Rows Dim wkDt As Label = dR . FindControl (" Label 1 ") Dim wkImg As Image = dR . FindControl (" im g1 ") If Not wkDt Is Nothing AndAlso Not wkImg Is Nothing Then wkImg . Visible = False End If Next 
Debug . Print i , Error ( i ) を If Error ( i ) <> " アプリケーション 定義 または オブジェクト 定義 の エラー です 。 " Then Debug . Print i , Error ( i ) End If として み て 下さい 。 
↓ My . Computer . FileSystem . WriteAllText メソッド https :// msdn . microsoft . com / ja - jp / library / 27 t 17 sxs % 28 v = vs . 90 % 29 . aspx 「 My . Computer . FileSystem . WriteAllText 」 メソッド に 引数 を 指定 すれ ば 良い の で は ？ 
ini ファイル は テキストファイル な ので 、 テキストファイル として 読み込め ば 良い か と 思い ます 。 どの よう な 処理 を 考え て いる の か 分かり ませ ん が 、 １ 行 ずつ 取り込ん で 、 "[" や "=" 等 が 有っ たら 、 セクション や キー として 認識 すれ ば 良い か と 思い ます 。 ↓ テキストファイル の 読み込み http:// office tanaka .net / excel / vba / file / file 08 b . htm http:// www . asahi-net . or .jp /~ ef 2 o - inue / vba _ o / sub 05 _ 110 . html > サンプル プログラム が 欲しい です " VBA テキストファイル 読み込み " など で 検索 すれ ば サンプル は たくさん 出 て き ます 。 
条件 付き の ◯◯ まで コピー 、 など は Do loop 構文 を 使い ましょ う 。 条件 に は While や Until を 使っ て Loop を 止める こと が 出来 ます が 、 変数 i を 宣言 し て おい て スタート を １ と ( i = 1 ) を Do 前 に 記述 、 ループ 内 に i = i + 1 など と カウントアップ を する 、 と 使い ます 。 コピー と 一口 で 言っ て も セル ごと コピー ペースト な の か 、 値 だけ な の か とか 書き方 が ある ので 答え にくい です が 、 Range (" B " & i ). Value = Range (" A " & i ). Value で も 値 の 転記 くらい は Copy で は なく て も できる と 思っ て ください 。 以上 コード を 書く の は 簡単 です が 後学 の ため 自分 で 調べ て み て ください 。 ブック を またぐ 処理 の ヒント は 、 自 ブック 指定 ( Thisworkbook ) を 使う 、 オブジェクト 変数 に 格納 する 、 With ステートメント を 利用 する 、 これら です 。 Dim B as object Set B = Workbooks (" B "). worksheets ( 1 ) と 書い て おけ ば 、 後 は B . Range (" A1 ") が B ブック シート １ 枚 目 指定 に なり ます 。 With Workbooks (" B "). worksheets ( 1 ) . Range (" A1 ") End with これ は .～ と 書く だけ で B ブック シート １ 枚 目 指定 に なり ます 。 ブック . シート . セル の それぞれ を 明示 的 に 書き ましょ う 。 シート 指定 は インデックス 番号 以外 に シート 名 " Sheet 1 " の よう な 文字列 も 入れ られ ます 。 上記 を 踏まえ 、 比較 は If で 行え ば いい でしょ う 。 その後 ループ を 利用 さ れれ ば コピー も でき ます 。 
割り当て られる 数字 と は 1 ～ 3 と は べつ もの です か 。 20 個 が 1 ～ 3 しか 種類 が 無い の を 均等 と は 不可解 です 。 Sub test () Dim temp As Range Dim i As Long For Each temp In Range (" A1 : D 5 ") Randomize i = Int ( Rnd () * 3 + 1 ) temp . Value = i Next End Sub 
フリー の 表計算 ・ 統計 解析 ソフト PAST http:// fo l k. uio . no / ohammer / past / これ を 使え ば ， EXCEL の セル データ を コピペ し て ， 一挙に 全て の 組み合わせ の 相関 が 行列 の 形式 で 出力 さ れ ます 。 項目 が 数 十 あっ て も ， たぶん ， コピペ から 出力 まで 10 秒 かから ない かも 。 。 平均 や 標準偏差 ， 中央値 や 四 分 位 ， 歪み や 尖り も ， その セル データ で ， 一瞬 に 出力 さ れ ます 。 英語 です が ， 海外 の 大学生 に は ， よく 使わ れる 無料 の 表計算ソフト です 。 私 の 研究室 で の ， 中学生 の 理科研究 の 成果 アリ の 歩く 速さ と 走る 速さ http:// www . ab . a uo ne-net .jp /~ biology / Ant - speed . htm そこ でも PAST が 使わ れ て い ます 。 あくまで EXCEL だけ で 計算 する なら ， グラフ を 描く の です から ， 決定係数 を 表示 さ せれ ば ， Excel の 場合 ， それ は 相関係数 の 二 乗 な ので ， 符号 に 注意 すれ ば 間接 的 に 相関係数 も 計算 でき ます 。 
元 データ が A1 から 下 に あっ て 、 結果 を B 1 から 右 に 表示 する 場合 です 。 Sub sample () Dim lastRow As Long Dim ary As Variant Dim str As String ' Range ( Range (" B 1 "), Cells ( 1 , Columns . Count )). Clear ' 結果 クリア lastRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' A 列 最終 行 ary = Range (" A1 : A " & lastRow ) ' 元 データ 範囲 ( A1 : A3 ) を 配列 に 取得 ary = WorksheetFunction . Transpose ( ary ) ' 2次元 配列 を 縦横 を 変換 し て 1次元 配列 に 取得 str = Join ( ary , " ") ' 配列 を " " 区切り で 文字列 に str = Replace ( str , ",", " ") '","( カンマ ) を " " に 変換 str = WorksheetFunction . Trim ( str ) ' 左右 の 空白 を 削除 と 複数 の 空白 を 1 個 に 変換 ( 元 データ で カンマ が 連続 し た 場合 は 1 個 に 変換 ) ary = Split ( str , " ") ' 空白 で 区切っ て 配列 に 取得 Range (" B 1 "). Resize ( 1 , UBound ( ary ) + 1 ). Value = ary ' B 1 から 横 に 結果 を 表示 End Sub 2 番目 の 元 データ ( D , EE ,) の 最後 が カンマ です が 、 その 場合 の 結果 は 空白 セル を 入れる の か どう か が 不明 です 。 カンマ の 繰り返し は 1 個 に し て い ます が 、 空白 を 入れる 場合 は str = WorksheetFunction . Trim ( str ) ' 左右 の 空白 を 削除 と 複数 の 空白 を 1 個 に 変換 ( 元 データ で カンマ が 連続 し た 場合 は 1 個 に 変換 ) を 削除 し て ください 。 
コード 例 です 。 下 から 4 行 目 の シート 名 は 実際 の シート 名 に 書き換え て 使用 し て ください 。 軽く しか 検証 し て い ない ので 、 不具合 が あれ ば ご 返信 ください 。 Sub Sample () Dim Row As Long Dim LastRow As Long Dim i As Long Dim j As Long Dim Items () As String Dim Customers () As String LastRow = Cells ( Rows . Count , " A "). End ( xlUp ). Row ReDim Items ( LastRow - 1 ) ReDim Customers ( LastRow - 1 , 2 * LastRow - 1 ) For Row = 1 To Cells ( Rows . Count , " A "). End ( xlUp ). Row If Cells ( Row , " D "). Value = 1 Then For i = 0 To UBound ( Items ) If Items ( i ) = Cells ( Row , " A "). Value Then Exit For If Items ( i ) = "" Then Items ( i ) = Cells ( Row , " A "). Value Exit For End If Next For j = 0 To UBound ( Customers , 2 ) If Customers ( i , j ) = "" Then Customers ( i , j ) = Cells ( Row , " B "). Value Customers ( i , j + 1 ) = Cells ( Row , " C "). Value Exit For End If Next End If Next With Worksheets (" 違う シート ") '← 実際 の シート 名 に 書き換え て ください 。 . Range (" A1 "). Resize ( UBound ( Items ) + 1 ). Value = WorksheetFunction . Transpose ( Items ) . Range (" B 1 "). Resize ( UBound ( Customers , 1 ) + 1 , UBound ( Customers , 2 ) + 1 ). Value = Customers End With End Sub 
変数 が 「 i 」 な の か 「 k 」 な の か よく 分かり ませ ん が Chr ( Int (( i - 1 ) / 99 ) Mod 26 + 97 ) & Format (( i - 1 ) Mod 99 + 1 , " 00 ") 
描画 し た もの だけ を 消す 方法 は あり ませ ん 。 描画 前 の 情報 を 取っ て おい て 再 描画 する 方法 も あり ます が 、 どちら か と いう と デスクトップ に対して 再 描画 の シグナル を 送る 、 という 方法 が ウインドウズ の ルール に 則っ た やり方 に なり ます 。 デバイス コンテキスト について 学ぶ の で あれ ば VBA で は なく て 、 C++ で MFC アプリケーション を 作っ て みる 方 が 学び やすい ですよ。 
http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1416076758 ... ID が 違い ます が 全く 同じ 内容 の 質問 です よ ね ？ お 知り合い です か ？ 
各 シート 最終 行 の B 列 、 F 列 、 I 列 、 J 列 、 K 列 を Sheet 1 へ 転記 する コード です 。 Option Explicit Sub Sample () Dim st 1 As Worksheet , st As Worksheet Dim i As Integer , r1 As Long , r As Long Set st 1 = Worksheets (" Sheet 1 ") For i = 2 To ThisWorkbook . Worksheets . Count r1 = st 1 . Range (" B " & st 1 . Rows . Count ). End ( xlUp ). Row + 1 Set st = Worksheets ( i ) r = st . Range (" B " & st . Rows . Count ). End ( xlUp ). Row st 1 . Range (" B " & r1 ). Value = st . Range (" B " & r ). Value st 1 . Range (" F " & r1 ). Value = st . Range (" F " & r ). Value st 1 . Range (" I " & r1 ). Value = st . Range (" I " & r ). Value st 1 . Range (" J " & r1 ). Value = st . Range (" J " & r ). Value st 1 . Range (" K " & r1 ). Value = st . Range (" K " & r ). Value Next i End Sub 
以下 の コード でいか が でしょ う か 。 Sub 翌月 処理 () Dim rng As Range For Each rng In Range (" C4 ： C3 5 ") If rng . Value <> "" Then rng . Value = rng . Value + 1 Next Range (" A1 "). Select End Sub 
こんにちは。 プログラム を 開発 し て いる とき 、 「 トラブル 」 が 発生 し た とき の 情報 は 、 すごく ほしい です 。 その 挙動 、 主 様 は 、 「 邪魔 だ 」 なんて いっ て い ます が 、 ゲーム が 動作 し て い て 、 理由 が あっ て 画面 が 出 て いる と 思っ て いい です 。 つまり 、 仕様 の 範囲 です 。 「 自動 終了 」 を さ せ たい よう です が 、 やめ て おい た ほう が いい です 。 いつまでも 、 プログラム 不良 の 対策 が 出来 ない こと に なる の です から 、 結果 、 主 様 が 不利益 に なる か と 。 
End With が ある のに 、 それ に 対応 する With ステートメント が あり ませ ん 。 どこ か で 忘れ て ませ ん か ？ 
こんにちは。 この コード で 、 動作 が 不定期 、 という の でし たら 、 「 自動的 に 送受信 し て いる タイミング 」 が ないか を 考え て ください 。 自分 が 操作 する まで 、 「 送受信 し ない 」 という 状況 の チェック です 。 あと 、 doevents の コード を 追加 し た とき の 挙動 です 。 コード の 不良 と いう より も 、 OS と アプリ の 挙動 に あわせ て 、 処理 を ゆっくり さ せる という こと です 。 
上記 の 書き方 で 間違い は ない はず です が 、 ないっ て い ない の で あれ ば 何 が 入っ て い ます か ？ 確認 です が 、 上記 の コード は フォーム の モジュール に 書か れ て い ます か ？ コンボ ４ は 、 何らかの 値 が 選択 さ れ て い ます か ？ 
確か に 、 質問者 さん が 指摘 さ れる とおり に 思い ます 。 ただ 、 何 か 思い も よら ない 意図 が 隠さ れ て いる と も 限ら ない ので 一応 、 前 担当者 に 確認 さ れ た 方 が よい と 思い ます 。 
こんにちは。 検索 し たい キーワード が 、 複数 ある 、 という の が 、 分かっ て いる の でし たら 、 準備 、 データ シート は 、 キーワード で 並び 替え を する 。 複数 一致 の 処理 として は 、 1 ) キーワード の 数 を 、 countif ( 検索 する キー 列 , 検索 する キーワード ) で 計算 2 ) match 関数 で 、 行 を 計算 3 ) match 行 と 、 vlookup し たい ターゲット 列 を 、 1 ) の countif の 数 だけ 、 コピー する という コード に なり ます 。 通常 で は 、 vlookup の 関数 は 、 結果 が 1つ です が 、 主 様 が し たい こと は 、 結果 が 複数 に なり ます 。 取得 し て から 、 どう し たい の か で 、 コード に 合わせる の が いい か と 。 
A の エクセル の 「 Thisworkbook 」 モジュール に 記載 し て ください 。 Private Sub Workbook _ SheetChange ( ByVal Sh As Object , ByVal Target As Range ) Target . Copy Workbooks (" B . xlsx "). Worksheets ( Sh . Name ). Range ( Target . Address ) End Sub 
if ( reader . NodeType == XmlNodeType . Element ) { // もし < 主菜 > タグ の 子 要素 に < 名 > が あれ ば それ を 取得 ， なけれ ば < 主菜 > タグ 内 テキスト を 取得 if ( reader . Name == " 主菜 "){/// ここ で ReadToDecendant (" 名 ") を 実行 する と "</ 主菜 >" へ reader が 進む if ( reader . ReadToDecendant (" 名 ")) lunchList . Add ( reader . ReadString ()); } /// ここ で は "</ 主菜 >" なので ReadString は "" を 返す lunchList . Add ( reader . ReadString ()); reader . Close (); なので if ( reader . NodeType == XmlNodeType . Element ) { // もし < 主菜 > タグ の 子 要素 に < 名 > が あれ ば それ を 取得 ， なけれ ば < 主菜 > タグ 内 テキスト を 取得 if ( reader . Name == " 主菜 ") { /// ここ で ReadOuterXml を 実行 し て < 主菜 > ... </ 主菜 > を 取得 string ss = reader . ReadOuterXml (); /// Xml の ヘッダ 、 フッタ を 追加 ss = "< xmlfile >\ n < lunch >\ n " ss "</ lunch ></ xmlfile >"; /// String Reader の 構築 Sysytem . IO . String Reader srd = new System . IO .S tringReader ( ss ); /// XmlReader の 構築 XmlReader rd = XmlReader . Create ( srd , settings ); rd . ReadToDecendant (" 主菜 "); // ” 肉 ” 、 ” たまご ” 、 " 魚 " など を 取得 string s1 = rd . ReadString (). Trim (); rd . close (); srd . cose (); // XmlReader の 再 構築 srd = new System . IO .S tringReader ( ss ); rd = XmlReader . Create ( srd , settings ); if ( rd . ReadToDecendant (" 名 ")) ｛ lunchList . Add ( rd . ReadString ()); } else { lunchList . Add ( s1 ); } reader . Close (); 
If 文 で 分岐 さ せる の が 基本 です 。 If ( InStr ( Cells ( i , 1 ). Value , "_") > 0 ) Then ' Split 云々 の 処理 を 行なう End If 
一番 単純 な 解決 法 は チェックボックス と テキスト を div て 囲っ て di splay : inline - block ; と する 事 です 。 スタイル だけ で 解決 する なら 、 チェックボックス に padding - right : 10 em ; margin - right :- 10 em ; と すれ ば 良い でしょ う 。 少し トリッキー な ので 推奨 はしません が 。 
PasteSpecial で エラー が 起き て いる と の 事 です が 、 copy し て から 別 の ブック を 開い て いる ので 、 クリップボード が 消え て いる の だ と 思い ます 。 都度 オープン さ せ たり Active に さ せ たり という の は 効率 が 悪い です 。 ファイル を 扱う 時 は ワークブック を 変数 に 持つ よう に し た 方 が いい です 。 全部 を 直し て 示し たい の です が 、 長く なる ので 、 その 部分 だけ 。 参考 に し て 修正 し て み て 下さい 。 Dim wb 1 As Workbook , w b2 As Workbook Application .S creenUpdating = False Set wb 1 = Workbooks . Open (" 1番 ブック ") Set w b2 = Workbooks . Open (" Target 8 ") wb 1 . Worksheets (" 仮 集計 済み シート "). Range (" A1 : XXXX "). Copy w b2 . Worksheets ( sheetname ). Range (" A1 "). PasteSpecial Paste := xlPasteValues w b2 . Worksheets ( sheetname ). Range (" A1 "). PasteSpecial Paste := xlPasteFormats Application .S creenUpdating = True wb 1 .S ave だけ で 該当 の ファイル を 保存 でき ます 。 閉じる 時 は wb 1 . Close です 。 簡単 に なり ます ね 。 下記 は 画面 の 動き を 止める もの です 。 最初 に 入れ ます 。 Application .S creenUpdating = False それ から 、 定義 （ Dim ） は 都度 書く の で は なく 、 コード の 先頭 に まとめ た 方 が いい です 。 わかり やすく なり ます 。 
数字 の 範囲 と セル の 位置 が 決まっ て いれ ば 条件 付き 書式 設定 で 可能 です 。 図 は 簡単 な 例 です が 10 を MAX と し た もの です 。 この 場合 は A1 ～ C1 0 を 範囲 指定 し て おい て 、 条件 付き 書式 新しい ルール 、 数式 = 10 - ROW ( A1 )< A $11 色 を 設定 で 作成 し て い ます 。 
バリ アント 型 の 配列 を 介し て いる から では なく 、 Range の 使い方 が 間違っ て いる から だ と 思い ます 。 Worksheets (" src "). Select ・ ・ ・ ・ Worksheets (" dest "). Range ( Cells ( 1 , 1 ), Cells ( 100 , 5 )) = buf は 、 標準 モジュール で は Worksheets (" dest "). Range ( Worksheets (" src "). Cells ( 1 , 1 ), Worksheets (" src "). Cells ( 100 , 5 )) = buf と 同じ 意味 に なる ので 、 エラー に なる はず です 。 と 言う わけ で 、 Worksheets (" src "). Select ・ ・ ・ ・ Worksheets (" dest "). Select Worksheets (" dest "). Range ( Cells ( 1 , 1 ), Cells ( 100 , 5 )) = buf に する か 、 Worksheets (" dest "). Range ( Worksheets (" dest "). Cells ( 1 , 1 ), Worksheets (" dest "). Cells ( 100 , 5 )) = buf に する か 、 Dim ws As Worksheet Set ws = Worksheets (" dest ") ws . Range ( ws . Cells ( 1 , 1 ), ws . Cells ( 100 , 5 )) = buf など に する 必要 がる と 思い ます 。 
QObject :: connect ( selectDirButton , SIGNAL ( clicked ()), SelectWindow , SLOT ( SelectWindow :: selectDirectory ())); では なく QObject :: connect ( selectDirButton , SIGNAL ( clicked ()), SelectWindow , SLOT ( selectDirectory ())); // SelectWindow :: を 消す だけ これ で うまく いき ませ ん か ？ 
管理 する 情報 は １ ． 月 や 年 など 定期 的 に 区切る の か ？ ２ ． 仕入れ 情報 は 管理 し ない の か ？ これ によって 提案 できる こと が 変わっ て くる と 思い ます 。 
End sub が 必要 です 。 と 怒ら れる と 思う の だ が ？ （ Sub が 二つ で End Sub が ひとつ ） シート に コマンド ボタン を 挿入 し て いる なら Private Sub CommandButton 1 _ Click () Dim c As Range For Each c In Range (" A1 : C5 ") If c . Value = 0 Then c . Value = "" Next c End Sub で 正常 に 動き ます 。 
これ で いかが でしょ う か 。 お 望み の 動作 と 違う よう でし たら すみません 。 一応 コメント も 書い て おり ます ので 、 変更 が 必要 な 場合 は 変更 し て み て ください 。 取り急ぎ 、 質問 内容 の ファイル 名 と シート 名 に し て おり ます 。 （ ファイル 形式 も . xls として あり ます 。 ） Sub CopyRows () Dim rowcnt As Long ' コピー 元 の A 列 の 行 数 Dim wbA As Workbook ' コピー 元 の ブック Dim wsA As Worksheet ' コピー 元 の シート Dim wsB As Worksheet ' コピー 先 の シート ' コピー 元 ワークブック セット Set wbA = Application . Workbooks (" A . xls ") ' コピー 元 ワーク シート セット Set wsA = wbA .S heets (" Sheet 1 ") ' コピー 先 ワーク シート セット Set wsB = ThisWorkbook .S heets (" Sheet 2 ") ' コピー 元 の 最下 行 を 取得 し て セット rowcnt = wsA . Range (" A " & wsA . Rows . Count ). End ( xlUp ). Row ' コピー 元 の A 列 4 行 目 から 最終 行 まで を コピー し て 、 コピー 先 の A3 に ペースト wsA . Range (" A 4 : A " & rowcnt ). Copy wsB . Range (" A3 ") End Sub 
> wfopen - s を ある ファイル を 読み込み 専用 で 開い て いる ... が 、 失敗 し て いる ( エラー 検査 せ ず fgets し て いる ) の では ？ 
http:// teapipin . blog 10 . fc2 . com / blog - entry - 520 . html 
とりあえず 、 以下 の 変更 を 試し て み て ください 。 Criteria 1 :="<= 数値 " ↓ Criteria 1 :="<=" & 数値 あと > myForm = " 00000000 " > Range (" B2 "). NumberFormatLocal = myForm は 不要 に 思え ます 。 セル 書式 自体 を 変更 する の で は なく 、 必要 な とき に 、 Format 関数 で 変換 すれ ば 良い と 思い ます 。 
C# を 学習 し 始め て間 が 無い という こと で あれ ば 、 で 、 残念 です が ・ ・ ・ ① Form の サイズ を PDF の サイズ に 調整 し たい 無理 です 。 AxAcroPDF で は PDF の サイズ を 外部 から 取り出す こと は 出来 ませ ん 。 ② PDF で 最初 に 開く ページ を 指定 ページ だけ 開き たい 。 無理 です 。 AxAcroPDF で は 表示 する ページ を 指定 する こと は 出来 ませ ん 。 ③ PDF の ナビゲーション は 不要 無理 です 。 AxAcroPDF で は ナビゲーション の 表示 ／ 非表示 の 切り替え は 出来 ませ ん 。 ④~⑥ fm 上 に は pdf . Dock = Do ck Style. Fill に し た AxAcroPDF が 存在 し て いる の です から 、 fm に は マウス イベント が 発生 し ませ ん し 、 AxAcroPDF に は MouseMove イベント が あり ませ ん 。 です から ④ は 無理 です 。 同様 に Class 2 で 作っ た ボタン は AxAcroPDF で 隠さ れ て しまう ので Click イベント が 発生 し ませ ん 。 です から ⑤ も 無理 です 。 ⑥「 モーダル に する と 、 イベント が 起き ない 」 モー ドレス の フォーム を 表示 さ せる の で あれ ば Class 1 の 中 で Class 2 の インスタンス を 作る の で は なく 、 main モジュール で Class 1 と Class 2 の インスタンス を 作る べき です 。 結論 から 言う と あなた の 理解 度 で は 自作 の フォーム を 継承 し て 新しい フォーム を 作る こと は 時期 尚早 だ と 言わ ざる を 得 ませ ん 。 
まず 、 現状 で は リスト ボックス に 表示 さ れ た データ が シート 上 の 何 行 目 な の か 、 という 情報 が あり ませ ん 。 そこで 、 ① my da ta2 ( cn , 3 ) = mydata ( i , 9 ) の 次 の 行 に 「 my Da ta2 ( cn , 4 ) = i 」 という 行 を 追加 し ます 。 ② 次に リスト ボックス の 列 数 を 4 列 （ ただし 4 列 目 は 非表示 ） に し ます 。 . ColumnCount = 3 . ColumnWidths = " 150 ; 30 ; 30 " を . ColumnCount = 4 . ColumnWidths = " 150 ; 30 ; 30 ; 0 " と し ます 。 ③ ListBox 1 _ Click イベント を 記述 し ます 。 Private Sub ListBox 1 _ Click () If ListBox 1 . ListIndex = - 1 Then Exit Sub Dim selRow As Integer selRow = ListBox 1 . List ( ListBox 1 . ListIndex , 3 ) With Worksheets (" Sheet 1 ") . Range ( Cells ( selRow , 1 ), Cells ( selRow , 22 )). Select ’ この 下 に フォーム 上 の テキストボックス に 値 を 設定 する 処理 を 入れる End With End Sub ユーザー フォーム 上 の テキストボックス に リスト の 値 を 設定 する に は 、 苗字 ・ 名前 ・ 社名 など が シート の 何 列 目 に あっ て 、 それぞれ の テキストボックス が なんと いう 名前 な の か が 判ら ない と コード で 示す こと は 出来 ませ ん 。 ８ 列 目 の セル の 内容 を TextBox 3 に 設定 する 例 です 。 TextBox 3 . Text = . Cells ( selRow , 8 ). Value 
いくつ か 方法 が ある ので 「 Excel VBA 画像 挿入 」 で 検索 し て あなた の 希望 に 沿っ た 方法 を 探し て み て 下さい 。 
下記 の サイト を 参考 に し て ください 。 ADO で MySQL に 接続 ＠ Excel マクロ ・ VBA http:// www . cocoaliz . com / excelVBA / index . php / 40 / コンボボックス に データ を 追加 する http:// office tanaka .net / excel / vb a/t ips / tips 157 . htm 
せっかく ソースコード を 貼り 付け て いただい て いる の です が 、 やり たい こと が 見え て き ませ ん 。 何 が どう だっ たら どう したい 、 という 風 に 文章 で 説明 し て もらえ ます か ？ 「 システム 更新 データ 」 の レイアウト も 提示 し て いただける と より 判り やすい と 思い ます 。 
ショートカット ファイル （ 拡張子 . lnk ） を Dir 関数 で 取り出し ます 。 WScript .S hell を 使い 、 CreateShortcut で ショートカット の オブジェクト を 作成 し 、 TargetPath で リンク 先 の パス を 取り出し ます 。 リンク 先 の パス から ファイル 名 の 拡張子 が . ppt or . ppt ? なら パワーポイント オブジェクト から Presentations . Open で ファイル を 開き . PrintOut で 印刷 し ます 。 サンプル です 。 印刷 の 条件 的 な こと （ 用紙 だの 印刷 レイアウト だ の ） は 何 も 設定 し て い ませ ん 。 Sub Sample () Dim WSH As Object Dim lnkFile As Object Dim fName As String Dim tPath As String Dim PPT As Object Dim Pre As Object tPath = " フォルダ A ￥" '<= フォルダ を 指定 し ます 、 最後 に 必ず ￥ を 付け ます Set WSH = CreateObject (" WScript .S hell ") Set PPT = CreateObject (" PowerPoint . Application ") ' シートカットファイル に対して 処理 を 行い ます fName = Dir ( tPath & "*. lnk ") Do Until fName = "" Set lnkFile = WS H. CreateShortcut ( tPath & fName ) ' ショートカット の リンク 先 が ppt ファイル なら If ( lnkFile . TargetPath Like "*. ppt ") Or ( lnkFile . TargetPath Like "*. ppt ?") Then ' ファイル を 開き ます Set Pre = PPT . Presentations . Open ( lnkFile . TargetPath ) ' 印刷 Pre . PrintOut ' ファイル を 閉じ ます Pre . Close Set Pre = Nothing End If Set lnkFile = Nothing ' 次 の ファイル fName = Dir () Loop PPT . Quit Set PPT = Nothing Set WSH = Nothing End Sub 
CONCATENATE () 関数 で は だめ でしょ う か 。 
ValueChanged イベント を 使い ましょ う 。 private void dateTimePicker 1 _ ValueChanged ( object sender , EventArgs e ) { if ( dateTimePicker 1 . Value > dateTimePicker 2 . Value ) { dateTimePicker 1 . Value = dateTimePicker 2 . Value ; } } private void dateTimePicker 2 _ ValueChanged ( object sender , EventArgs e ) { if ( dateTimePicker 2 . Value < dateTimePicker 1 . Value ) { dateTimePicker 2 . Value = dateTimePicker 1 . Value ; } } この よう に 記述 すれ ば OK です 。 あまり 褒め られ た やりかた で は ない 気 も し ます が 、 間違っ て は い ませ ん 。 
① について Range (" 3 : 7 "). Rows . AutoFit を Worksheets (" Sheet 2 "). Range (" 3 : 7 "). Rows . AutoFit として み て 下さい 。 今回 の よう に 複数 の シート を 扱う マクロ で Range や Cell を 指定 する とき は 、 常に 「 ターゲット と なる シート 」 を 明示 的 に 指定 する よう に 心がけ て 下さい 。 ② について 使用 し て いる メール ソフト が Outlook なら 多分 実現 可能 だ と 思い ます 。 が 私 は 詳しく ない ので 「 Excel メール 送信 」 で ググッ て み て 下さい 。 
この 長い 文字列 は PHP という プログラミング言語 の 「 セッション ID 」 という もの です 。 セッション ID は ランダム な 文字列 な ので 解読 する こと は 出来 ませ ん 。 
1 秒 ウエイト する の で あれ ば System . Threading . Thread . Sleep ( 1000 ) 
> どなた か 案 を ください 。 自分 の 身の回り に関する データベース で 考え て みる と イメージ が 湧く の で は ？ 複雑 な もの より 、 誰 が 見 て も 単純 で 実用 的 な 管理 システム の ほう が 作り やすい か と 思い ます ね 。 例えば 、 レンタル CD や DVD など を 利用 さ れ て いる の で あれ ば ビデオ 貸出 システム の 流れ が だいたい 分かり ます ね 。 後 は 、 在庫管理 システム 、 図書 貸出 システム 、 顧客管理 システム ・ ・ ・ など など 。 ビデオ 貸出 システム で あれ ば 、 フィールド として 題名 、 ジャンル 、 監督 名 、 主演 名 、 貸出 日 、 返却 予定 日 、 フラグ （ 返却 確認 用 ） 、 管理 ID など が 挙げ られ ます ので 、 それら を テーマ ごと に 分け た テーブル を 作成 し て 、 クエリ で 連結 さ せ ます 。 後 は 、 画面 と なる フォーム で 表示 さ せれ ば 良い です 。 > Access VBA を 用い て 成果物 を 作成 フォーム に ボタン を 配置 し て 、 各 フォーム を 表示 さ せ たり 、 題名 （ タイトル ） から 検索 できる ボタン など を 作成 すれ ば ・ ・ ・ 。 Access は データベース ソフト な ので 、 主 に たくさん の データ を 蓄積 し て 、 それら データ から 必要 な データ だけ を 抽出 し たり 、 編集 ・ 削除 し たり する システム を 作る もの です 。 失敗 し ない ポイント は 、 複雑 な テーブル 構成 に し ない こと です 。 単純 な テーブル で クエリ や フォーム が うまく 動く こと を 確認 し ながら 作っ て ください 。 
> 実行 する と Foprm 1 が 起動 し ます これ を Form 2 を 起動 する よう に し たい の と ① メニュー バー より 「 プロジェクト 」 → 「 xxxxx の プロパティ 」 （ 一番 下 ） ②「 スタートアップ フォーム 」 で 、 起動 時 の フォーム を 選択 。 （ ↓ 画像 参照 ） > ちなみに フォーム は 移動 する と 前 の フォーム は 消える の でしょ う か ？ > Form 1 から Form 2 に 移動 し て 再度 、 Form 1 に 戻る 時 Form 2 を 消し たい の です Form 1 . Hide () 等 で 自分 で 消さ ない 限り は 消え ませ ん 。 Form 2 を 消し て Form 1 に 戻る に は 、 From 2 を [ × ] で 閉じる か 、 Me . Hide () か Me . Close () で 閉じ ます 。 Form 2 を 開く とき に 、 Dim Frm As New Form 2 Frm .S howDialog () に する と 、 モーダル で 開く ので 、 Form 2 が 閉じ られる まで Form 1 の 操作 は 出来 ませ ん 。 > できれ ば 引数 A と B と C を 持っ て 行っ て 戻る 時 に 返し たい の です が 、 私 は 、 フォーム に プロパティ を 作成 し て 、 開く 前 に 値 を セット し ます 。 プロパティ について は 、 検索 すれ ば サンプル が 多く 出 て き ます 。 または 、 標準 モジュール で グローバル変数 （ Public ） を 作れ ば 簡単 です 。 
今度 は 「 ListBox 」 な の です ね 。 作っ て み まし た 。 前回 の 「 TextBox 」 と ほとんど 同じ です 。 - - - - - - - - - - - - ------------------------- Private Sub Button 1 _ Click ( sender As Object , e As EventArgs ) Handles Button 1 . Click OpenFileDialog 1 . Multiselect = True OpenFileDialog 1 . Filter = " すべて の ファイル (*.*)|*.*" OpenFileDialog 1 . InitialDirectory = " c :\" If OpenFileDialog 1 .S howDialog () = Windows . Forms . DialogResult . OK Then ListBox 1 . Items . Clear () For Each strFilePath As String In OpenFileDialog 1 . FileNames ListBox 1 . Items . Add ( strFilePath ) Next End If End Sub - - - - - - - - - - - - ------------------------- 
まだ 投球 再開 の メド も 立っ て ない みたい です 。 今シーズン の 復帰 は 難しい です ね 。 
画像 が 表示 出来る コントロール は 他 に も あっ たり 、 画像 ファイル の 種類 によって は 背景 が 透明 に なら なかっ たり 。 試す こと は 色々 … 頑張っ て み たら ？ 
各 項目 に ダブルクオーテーション を 付け た CSV ファイル を 出力 する ため に は 、 独自 に 項目 を 編集 し て ファイル に 出力 する しか あり ませ ん 。 また 、 「 全 項目 半角 」 に する ため に は StrConv 関数 を 使用 し ます が 、 全角 ひらがな や 漢字 の 場合 は 半角 に は でき ませ ん 。 【 サンプル 】 （ 出力 対象 セル が A 2 ～ N 73 として ） Sub CSV 作成 () Dim myFileName Dim fn As Integer Dim buff As String Dim rng As Range Dim x As Long Dim y As Long myFileName = Application . GetSaveAsFilename ( FileFilter :=" CSV ファイル (*. csv ,*. csv ") If TypeName ( myFileName ) = " Boolean " Then Exit Sub Application .S creenUpdating = False fn = FreeFile () ' CSV ファイル を 出力 で 開く Open myFileName For Output As # fn ' 行 2 ～ 73 を 繰り返し For x = 2 To 73 buff = "" ' 列 1 ～ 14 （ A ～ N ） を 繰り返し For y = 1 To 14 ' 項目 を ダブルクオーテーション で 括り カンマ を 付ける buff = buff & """" & Cells ( x , y ). Value & """," Next y ' 最後 の カンマ を 除き 、 半角 に 変換 buff = StrConv ( Left ( buff , Len ( buff ) - 1 ), vbNarrow ) ' 出力 Print # fn , buff Next x Close # fn Application .S creenUpdating = True End Sub 
下記 で 解説 さ れ て い ます 。 ■ クリップボード に 格納 さ れ て いる データ を 確認 する ■ クリップボード と データ の やりとり を する http:// www . moug .net / tech / exvba / 0150091 . html 
キーボード で 操作 し たい ん です か ね ？ コンボボックス は F4 で 開い た はず です 。 
Copy し た 直後 は 新しく コピー で 作成 さ れ た ファイル （ ブック ） が アクティブ に ある ため 、 r = 2 に なっ た 時 の WorkShees は 、 その 新しい ファイル の ２つ 目 の シート を コピー しよ う と する ため エラー に なり ます 。 以下 の よう に し て は どうでしょう か 。 Sub d () For r = 1 To 5 ThisWorkbook . Worksheets ( r ). Copy Next r EndSub 
こんち に は 。 If . Cells ( tRow , tCol ) Then vgyo = Worksheets (" 移動 シート "). Cells ( Rows . Count , tCol ). End ( xlUp ). row . Range (" D " & tRow & ": K " & tRow ). Copy _ Worksheets (" 移動 シート "). Range (" D " & vgyo + 1 & ": K " & vgyo + 1 ) とか 、 コピー 元 と 同じ サイズ に し たら 、 問題 は 少ない です 。 
以下 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim w As Integer Dim h As Integer w = 4 h = 5 Dim i As Long , j As Long Dim r As Long , c As Long For i = 1 To w c = w - i + 1 For j = 1 To h r = h - j + 1 Sheet 2 . Cells ( r , c ). Value = Sheet 1 . Cells ( j , i ). Value Next j Next i End Sub 
第一 の キラ 、 第 二 の キラ 、 Ｘ キラ 
high . s1 . xrea . com / q 12160481197 . xls リスト ボックス を 使っ た 対象 の 文字列 を 判別 する サンプル です 。 If strsc ( ac ( SplitCnt )) Then ' 条件 いずれ か に 一致 ･･･ Sheets (" 翻訳 作業 "). Cells ( z , 2 ) = ac ( SplitCnt ) z = z + 1 Else ' 条件 に 一致 し ない 場合 End If と する と 条件 に 一致 する か どう か を 判別 し て 結果 を True / False で 返す 関数 を 作っ て み まし た 。 Function strsc ( trg As String ) As Boolean Dim q As String Dim t As Boolean t = False For w = 6 To 12 ' リスト の 上限 row q = Sheets (" 翻訳 作業 "). Cells ( w , 10 ). Value Select Case Sheets (" 翻訳 作業 "). Cells ( w , 11 ). Value Case " から 始まる " t = ( Mid ( trg , 1 , Len ( q )) = q ) Case " 完全 一致 " t = ( q = trg ) Case " で 終わる " t = ( Right ( trg , Len ( q )) = q ) Case " を 含む " t = ( InStr ( 1 , trg , q ) <> 0 ) Case Else t = True End Select Sheets (" 翻訳 作業 "). Cells ( w , 12 ). Value = t ' テスト 出力 If t Then strsc = t End If Next w End Function 
If 文 の 並び 順 が ダメ な ん じゃ ない ん です か ね 。 コード は 上 から 処理 さ れる ので 、 bt と btt が 文字列 で あっ た として も 、 c1 に 何らかの 演算子 が 入力 さ れ て いれ ば 計算 し て しまい ます 。 エラー 判定 の コード を c1 の 記号 判定 の コード より 前 に 持っ て くれ ば 解決 する と 思い ます 。 どう でも いい 事 です が 、 c1 の 判定 処理 は If と ElseIf を 使う より も Select Case を 使っ た 方 が すっきり する か も しれ ませ ん ね 。 それでは 。 
こんにちは。 この コード だ と 、 リスト コントロール に 流し込ん だ データ を チェック し て ます よ ね 、 主 様 の し たい こと は 、 オート フィルター で 出来る 操作 な の で は ？ それ だっ たら 、 探し たい シート を 選択 し 、 探し たい フィールド で 、 フィルター 情景 を 設定 する 操作 を 自動 記録 を 作成 し て 、 それ に対して 「 検索 キー 」 を 渡し て あげる コード を 作成 し たら いい です 。 シート を 切り替え て 、 「 セル ジャンプ 」 し て いる 、 という コード な の です から 。 最初 から その シート を 開い て 、 フィルター を かける の が 、 「 あいまい 用 」 という こと で いい か と 。 
該当 の サイト の URL は いただけ ませ ん でしょ う か ？ 
入力 不備 の メッセージ を 表示 し た 後 Exit Sub で 終了 さ せ て い ます が 、 Application . EnableEvents = False し た まま です ので 、 イベント が 発生 し ない 状態 です 。 Application . EnableEvents = True として から Exit Sub する か 、 Application . EnableEvents = False を 入れる 場所 を 、 エラー 判定 し た あと に し ます 。 
こんにちは。 主 様 の デバイス に 、 google アプリ を インストール し 、 正しく ログイン し た 状態 で 使っ て いる 状態 が あり ます 。 続い て 、 本題 の 操作 です 。 1 ) デバイス の 「 google アプリ 」 の アイコン を タップ 2 ) 表示 し た 画面 に は 、 Google の イメージ 文字 と 、 「 検索 ボックス 」 と お勧め の 記事 など が 、 表示 さ れ て い ます 。 検索 ボックス は 、 タップ する と 、 「 文字 を 入力 する 、 url を 入力 する 、 など でき ます が 、 何 回 か 使っ て いる 、 履歴 の 表示 が あり 、 一番 下 の 行 に 、 「 検索履歴 の 表示 」 の 部分 が あり ます 。 そこ を クリック し て 、 履歴 の クリア の 操作 を する 、 という こと を 、 主 様 の ヘルプ 画面 で は 説明 し て い ます 。 Google は 、 Googleマップ や メール など 、 たくさん アプリ が あり ます 。 Google Chrome は 、 ブラウザー の アプリ です 。 それぞれ 、 イメージアイコン が 違っ て いる ので 、 よく 確認 し て ください 。 主 様 、 説明 画面 と 違う 操作 を し て いる よう です 。 
こんにちは。 O 列 の 関数 は 、 間違っ て い ます 。 1 ) 正しく O 列 を 入力 し ます 。 2 ) マクロ の 自動 記録 を 開始 し て 、 o 3 セル の 編集 と エンター として 、 関数 の マクロ コード を 取得 し ます 。 3 ) 記録 は 停止 。 これ で 、 出来 た コード と 差し替え て ください 。 コード は 、 m 3 : n3 の select を m 3 : o 3 と し たり 、 コピペースト の cells ( 13 , 14 の 部分 が m n o の 付近 です 。 ここ を 正しく あわせ て ください 。 
ThisWorkbook は その 名前 の 通り 、 ワークブック に対する イベント を 管理 する モジュール です 。 各 シート に Sheet 1 から でき て いる の と 同じ 。 確か に ThisWorkbook に Public の 関数 を 書け ば いろんな ところ から アクセス でき ます が 、 それ は Sheet 1 も 同じ こと 。 「 書ける 」 状況 が 「 適正 」 な 状況 で は ない 。 グローバルな 関数 を 書く の で あれ ば 標準 モジュール に 書く の が 適正 です 。 オブジェクト に 対応 し た モジュール の 中 に は その オブジェクト だけ を 扱い 、 共通 部品 など の 処理 は 標準 モジュール に 準備 する 。 それ が お約束 です 。 ThisWorkbook に 共通 関数 など を 作る メリット ？ と 言え ば モジュール の 数 が 少なく なる 。 デメリット は 処理 が 複雑 に なれ ば なる ほど どこ に 作っ た か 判ら なく なる 関数 が 現れる 。 
Session .S endAndReceive True を 設定 し て は どうでしょう 。 Const olFolderInbox = 6 With CreateObject (" Outlook . Application ") . GetNameSpace (" MAPI "). GetDefaultFolder ( olFolderInbox ). Display .S ession .S endAndReceive True End With 
サーバー に は データベース を 配置 。 ローカル の Book で は サーバ 上 の データベース と 値 を やり取り し ながら 加工 表示 する と か 。 
Forms ! は 『 開い て いる フォーム の 集まり 』 を 意味 し て いる ので 、 この エラー が 出 て いる という こと は F スタート が 開か れ て い ない のに 代入 しよ う と し た こと を 意味 し ます 。 事前 に F スタート を 開い て おい て 、 そのうえで OK _ Click を 実行 する と うまく セット さ れ ます 。 
Excel の 余計なお世話 機能 が 炸裂 する と 、 32 E 01 は 00320 と 同一 で 72 E 02 は 07200 と 同一 です 。 指数表記 と ゼロサプレス 表記 の 違い だけ で 数値 として は おなじ です から ね 。 これら が きちんと 文字列 として 格納 さ れ て いる の か 、 条件 付き 書式 の 数式 が きちんと 文字列 として 比較 し て いる か 、 の 2 点 が ポイント に なり ます 。 
こんにちは。 カレント プロジェクト の CN = の 部分 は 、 set CN = で 試し て ください 。 rs の open で 、 yahoo知恵袋 という の は 、 どんな 定義 でしょ う か さて 、 ie オブジェクト から 、 アクセス に 読込み さ せる 、 という こと な ん です が 、 実例 と し て だ と 「 ある webページ 」 に は 、 table タグ が あり ます 。 その テーブル に 表示 し た もの を アクセス に 読込み し たい という よう な 場合 だっ たら 、 ie に 検索 結果 を 表示 し 、 table タグ を get elements し て 、 cells と row の fornext で セル を 読込み する ループ を 組ん だら よい こと に なり ます が 、 いきなり re open し た という こと な ん です から 、 どんな 定義 な の か 、 説明 し て もらっ た ほう が いい ん でしょ う か ね 。 ( 単純 に 保存 し たい テーブル な の か 、 という こと です ) 
状況 が よく 分かり ませ ん が 、 CSV ファイル 以外 で データ の 管理 を し たい の いう の でしょ う か ？ 大量 の データ を 、 読み込み 、 追加 、 変更 、 削除 を 行う に は 、 通常 は データベース ソフト を 使用 し ます 。 Access 、 SQL Server 、 Oracle など を 使え ば 良い か と 思い ます 。 データーベース で データ を 扱う に は 、 SQL 文 を 使用 し ます 。 ↓ 「 SQL Server Express 」 （ 無料 ） http:// www . microsoft . com / ja - jp / server - cloud / products / sql - server - edi ... ↓ SQL 文 http:// sql . main .jp / cont / sql / map . html 私 は 、 Visual Basic 2012 と Access を 使っ て 大量 データ を 管理 し て い ます 。 CSV ファイル の データ を Access に 取り込め ば 、 大量 データ を 簡単 に 取り扱う こと が でき ます 。 
TAB 回数 という こと は 、 Sendkeys を 利用 し て いる という こと でしょ う か 。 IE 制御 なら ば 、 ie . document . getElementsByName (" PHPSESSID ")( 0 ). Submit ※ 前後 の HTML が 不明 な ので 、 仮に 配列 0 番 に し て あり ます 。 という こと に なり ます 。 
( xl , vbs ) ファンクション を 別 に し た サンプル です 。 ◆ 前提 エクセル 名 = Book 1 . xlsm vbs 名 = x . vbs 上記 2つ の ファイル は 同じ フォルダ に 在中 ◆[ vbs . vbs ] コード Dim xlBK Dim strResult Dim strPath ' vbs で [ strResult ] セット strResult = Now () Wscript . Echo strResult & Chr ( 13 ) & " これ は vbs の strResult " ' vbs から エクセル を ゲット オブジェ strPath = CreateObject (" Wscript .S hell "). Current Director y & "\ Book 1 . xlsm " Set xlBK = GetObject ( strPath ) ' vbs から エクセル ファンクション 実行 xlBK . Application . Run " step 2 _ getResult ", strResult set xlBK = Nothing ◆ エクセル vba Function step 1 _ retResult () Dim strPath As String ' vbs 実行 ⇒[ strResult ] を 取得 strPath = ThisWorkbook . Path & "\ x . vbs " strPath = Chr ( 34 ) & strPath & Chr ( 34 ) CreateObject (" Wscript .S hell "). Run strPath End Function Function step 2 _ getResult ( ByVal strResult As String ) As String MsgBox strResult & vbNewLine & " エクセル vba に 戻っ て き た ", vbInformation ' 残り の 処理 は ここ から 下 へ 記載 End Function ◆ エクセル vba から [ step 1 _ retResult ] 実行 
こんにちは。 結論 から 、 cmd の 印刷 オプション 印刷 オプション path ： ファイル パス printername ： プリンタ 名 と 、 あり ます 。 shell で 開く とき に 、 ファイル 名 を 指定 し 、 さらに 、 プリンター 名 を 追加 で 指定 し て ください https :// helpx . ado be. com / jp / acrobat / kb / 510705 . html 解説 、 エクセル で 、 プリンター を 切り替え て も 、 あまり 意味 が 無い です 。 エクセル が 起動 し て 、 「 エクセル の アクティブ 」 プリンター が 指定 でき ます が 、 OS の アクティブ プリンター に は 、 影響 し ませ ん 。 つまり 、 shell で 起動 し て も 、 os の 内容 に よる ので 、 今 の コード で は 、 対応 が でき ませ ん 。 
C :\ Test \ SaveBmp という フォルダ を 作成 し 、 その フォルダ 内 に 全て の タブ ページ を png 形式 で 画像 保存 する 例 です 。 Dim bmp As Bitmap System . IO . Director y . CreateDirectory (" C :\ Test \ SaveBmp ") For Each tpg As TabPage In TabControl 1 . TabPages bmp = New Bitmap ( tpg . Width , tpg . Height ) tpg . DrawToBitmap ( bmp , New Rectangle ( 0 , 0 , tpg . Width , tpg . Height )) bmp .S ave (" C :\ Test \ SaveBmp \" & tpg . Name & ". png ") Next 
私 は 40歳 過ぎ て から 仕事 の 必要性 から 勉強 し まし た 。 本業 で は なく いわゆる 片手間 プログラマ です 。 勉強 は スクール に 通い まし た 。 初心者 レベル なら 数 万 円 です 。 楽しい ですよ。 ゼロ を 一 に する の は 難しい です が 、 1 を 10 に する の は それほど でも あり ませ ん 。 自力 で 調べ られる よう に なる から です 。 最初 だけ は ある程度 投資 する こと を 勧め ます 。 資格 が あっ て 、 エクセル VBAエキスパート ・ ベーシック と スタンダード です 。 エキスパート な の か ビギナー な の か 分かり にくい 名前 です が 、 ベーシック 取得 を 目指し て 勉強 する と 、 必要 な 基礎 事項 を 網羅 出来る よう に なっ て ます 。 スクール や セミナー は 大抵 これ を 目指し て ます 。 セミナー は 薦め ませ ん 。 1 ～ 2日 の 集中 講義 で は 修得 出来 ない から です 。 スクール も 人件費 を 抑え た ビデオ 形式 の 方 が 、 何度も 見直し 出来 て 時間 の 都合 も 付け やすい です 。 仕事 で やる なら 、 内容 を 簡単 に 調べ て おい て 、 テーマ 解決 を 念頭 において 勉強 する と 捗り ます 。 ああ 、 今 ここ の 部分 を やっ てる ん だ な と 判る から です 。 ゼロ を 1 に 出来 たら 、 後 は ここ で 質問 する とか ググる とか 、 いくらでも 方法 は あり ます 。 
① について Do Until Cells ( line , 1 ) = "" Cells ( line , 2 ) = Application . WorksheetFunction . VLookup ( Cells ( line , 1 ), l in e2 , 2 , 0 ) If Err . Number = 0 Then line = line + 1 と し て い ます が 、 もし Application . WorksheetFunction . VLookup が エラー に なっ た 場合 、 Err . Number は 0 以外 な ので line = line + 1 が 実行 さ れ ませ ん 。 つまり 永久 に Do ループ が 終わら なく なり ます 。 フリーズ する 原因 は その ため です 。 エラー が 発生 しよ う が しまい が 、 line = line + 1 は 必ず 実行 さ せる 必要 が あり ます 。 ② について 「 1-2-3 」 は Excel で は 日付 形式 と みなさ れ ます 。 です から 値 を 設定 する 前 に セル の 書式 設定 を 「 文字列 」 に し て おく 必要 が あり ます 。 Cells ( line , 2 ). NumberFormatLocal = "@" を Cells ( line , 2 ) = Application . WorksheetFunction . VLookup ( Cells ( line , 1 ), l in e2 , 2 , 0 ) の 前 に 挿入 し ます 。 上記 を 踏まえ て 整理 し た コード を 示し ます 。 私 の PC で 2 万 件 の データ で 試し た ところ 約 30 秒 で 全 件 の 処理 が 終わり まし た 。 Option Explicit Sub 番号 () Dim line As Long Dim nValue As Variant Dim rn g2 As Range Application .S creenUpdating = False Set rn g2 = Worksheets (" Sheet 2 "). Range (" C : D ") With Worksheets (" Sheet 1 ") For line = 2 To . Range (" A " & . Rows . Count ). End ( xlUp ). Row nValue = "" On Error Resume Next nValue = Application . WorksheetFunction . VLookup (. Range (" A " & line ). Value , rn g2 , 2 , True ) On Error GoTo 0 If nValue <> "" Then . Range (" B " & line ). NumberFormatLocal = "@" . Range (" B " & line ). Value = nValue End If DoEvents Next End With Application .S creenUpdating = True End Sub 
「 ファイル ごと に 列方向 に まとめる 」 「 A 列 は どれ も 同じ で 」 「 A 列 一つ と ファイル の 個数 分 の B 列 を 含む ファイル を 作り たい 」 と いわ れ て も 具体 的 な イメージ が 湧き ませ ん 。 具体 的 な 例 を 示し て ください 。 
Option Explicit Sub 成績 () Dim CellGyo As Long For CellGyo = 4 To 23 If Range (" G " & CellGyo ). Value < 60 Then Range (" H " & CellGyo ). Value = " 不 合格 " End If Next CellGyo End Sub 
VBA で 使用 する ウィンドウ など は メニュー の 「 表示 」 から 選択 で い ます 。 ひょっ として 「 表示 」 という メニュー が なくなっ た の か な ？ だ と し たら 、 VBE 画面 の 右 上 （ メニュー バー や 標準 バー の ボタン の ない グレー 色 ） の 上 で 右クリック し て 「 ユーザー 設定 」 を 選択 し ます 。 「 ツールバー 」 タブ の 「 メニュー バー 」 を 選択 し て 、 右 下 の 「 リセット 」 ボタン を 押し て ください 。 
いい です 。 ただ 、 後で 読ん だ 際 に 見 やすい よう お勧め は ある よう です 。 例えば 、 一部 を 大文字 で 宣言 し て おき 、 入力 の 際 は 小文字 入力 する 習慣 を 付け て おく と 、 largeletter = と 書い て も LargeLetter = と 自動 修正 さ れ ので 、 誤 入力 し た 時 に は 修正 さ れ ず 判別 し やすい です 。 文字数 は A = と する より も 、 長く て いい から 内容 が わかる もの を 付ける 傾向 に あり ます 。 逆 に For i = 等 の いわゆる カウンター は どう でも いい 変数 な ので i = と 小文字 に し て 目立た ない よう に し ます 。 プロ の プログラマ なら 、 コーディング ルール として 変数 名 は ビシッと 決まっ て ます 。 複数 の 人数 で 見る もの です し 、 お客様 から の 仕様 で 決まっ てる こと も あり ます 。 ハン ガリアン 表記 と いっ て 、 strName の よう に 最初 の ２ ， ３ 文字 で 変数 の 型 や 種類 を 書く 方法 が あり ます 。 マイクロソフト 内 で ハンガリー 人 が 始め た 方法 だ そう です 。 ただ 、 今 は 推奨 さ れ て ない よう です 。 名前 の 付け方 は 流行り が ある よう です 。 
Sub test () Dim 変数 1 As Long Dim 変数 2 As Long Dim dic , xItem 変数 1 = 123 変数 2 = 456 Set dic = CreateObject (" Scripting . Dictionary ") With dic . Add Key :=" Key 1 ", Item := 変数 1 . Add Key :=" Key 2 ", Item := 変数 2 End With xItem = dic . Items ' ここ で は 、 123 と 456 と なっ て いる 。 For i = LBound ( xItem ) To UBound ( xItem ) Debug . Print xItem ( i ) Next 変数 1 = 987 変数 2 = 654 ' ここ でも 、 123 と 456 と なる 。 ここ で 987 と 654 に する 方法 は ？ With dic . Item (" Key 1 ") = 変数 1 . Item (" Key 2 ") = 変数 2 End With xItem = dic . Items For i = LBound ( xItem ) To UBound ( xItem ) Debug . Print xItem ( i ) Next End Sub Items メソッド と Item プロパティ は 別物 という わけ です 。 
クラス 内 の 定数 として もつ の が 良い と 思い ます 。 メモリ の 消費 について は 50 文字 程度 で あれ ば 全く 考慮 する 必要 は ありません し 、 速さ について は Release モード で コンパイル する と 最適 化 さ れる ので こちら も 気 に する 必要 は あり ませ ん 。 です ので コーディング の 際 は 可読性 と メンテナンス 性 を 優先 し て 構い ませ ん 。 ちなみに それぞれ の ボタン の Click イベント で の 処理 が ほぼ 同じ 場合 、 Click イベントプロシージャー は ひとつ に 統合 する こと が 出来 ます 。 下記 は DialogResult プロパティ を Yes 、 No 、 Cancel に 設定 し た ボタン の Click イベント の 記述 例 です 。 Private Sub Bu tt on_ Click ( sender As System . Object , e As System . EventArgs ) Handles Button 1 . Click , Bu t to n3 . Click , Bu t to n2 . Click Dim btn As Button btn = sender Select Case btn . DialogResult Case Windows . Forms . DialogResult . Yes ' Yes ボタン の 時 の 処理 Case Windows . Forms . DialogResult . No ' No ボタン の 時 の 処理 Case Windows . Forms . DialogResult . Cancel ' Cancel ボタン の 時 の 処理 End Select End Sub 
セル の 書式 を 日付 表示 に し て 、 360 を 加算 すれ ば いい です 。 日付 表示 は 、 「 書式 設定 」 で 選択 すれ ば いい です が 、 エクセル の 標準 表示 は 、 「 2016 / 4 / 1 」 に なり ます 。 これ を 、 「 2016 . 4 . 1 」 と 表示 さ せ たい なら 、 「 ユーザー 定義 」 を 選択 し て 、 「 yyyy "." m ”.” d ”.”」 と 設定 すれ ば 可能 です 。 データ の 入力 は 、 2016 / 4 / 1 と タイプ すれ ば 、 日付 データ として 認識 さ れ ます 。 ただし 、 上記 の よう に 表示 さ れる だけ で 、 実際 に は 1900年 1月1日 を 1 と し た 時 の 経過 し た 「 日 」 を 全て 加算 し た 数字 が 記憶 さ れ て い ます 。 「 2016 . 4 . 1 」 で あれ ば 、 42461 という 数字 に なり ます 。 添付 事例 は 、 表示 を 合わせる ため 、 「 yyyy "." mm ”.” dd 」 と し まし た 。 
Sub 一 例 です () Dim idx As Long , sh As Worksheet Const col As String = " A " Apprication .S creenUpdating = True For Each sh In Worksheets With sh For idx = 2 To . Range ( col & Rows . Count ). End ( xlUp ). Row If . Cells ( idx , col ). Value = " 1 " Then . Rows ( idx ). Hidden = True End If If . Cells ( idx , col ). Value = "＊" Then . Rows ( idx ). Hidden = False End If Next idx End With Next sh Application .S creenUpdating = False End Sub 未 実行 につき 不具合 ご 容赦 。 
選択 し て 貼り つける ところ だけ 。 エラー は 考慮 し て ませ ん 。 Range (" A1 "). Select With Application . FileDialog ( msoFileDialogFilePicker ) .S how ActiveSheet . OLEObjects . Add ( Filename := _ .S electedItems ( 1 ), Link := False , DisplayAsIcon := _ False ). Select End With 
私 は レジストリ を 使っ て い ます 。 ini フィル を 使う 、 テキストファイル を 使う 、 データベース を 使う など 、 方法 は いろいろ 有る か と 思い ます 。 
惜しい 。 【 修正 前 】 Web B ro ws er Do cumentCompletedEventArgs e 【 修正 後 】 Web B ro ws er Do cumentCompletedEventArgs ^ e ^ 記号 が 足り なかっ た だけ です ね 。 《 備考 》 Web B ro ws er Do cumentCompletedEventArgs 型 オブジェクト を 指す ハンドル という 意味 。 ^ 記号 が 無い と 実物 という 意味 に なっ て しまい ます 。 ^ 記号 の 有無 で ハンドル な の か 実物 な の か の 意味 が 変わっ て くる という わけ 。 
> 図 の 様に 図 が ない ので 、 やり たい こと と 一致 し て いる か わかり ませ ん が 、 以下 を 標準 モジュール に 記述 し て 、 アクティブ シート を 対象 に Samp 1 を 実行 し て み ます Public Sub Samp 1 ()     Dim rArea As Areas     Dim rng As Range     Dim i As Long     Application .S creenUpdating = False     With ActiveSheet . UsedRange        With . Columns ( 1 )           . UnMerge           On Error Resume Next           Set rArea = .S pecialCells ( xlCellTypeBlanks ). Areas           On Error GoTo 0        End With     End With     If ( rArea Is Nothing ) Then Exit Sub     For Each rng In rArea        i = rng . Count        If ( i > 1 ) Then           i = ( i - 1 ) \ 2 + 1           rng . Resize ( i ). Delete xlShiftUp        End If     Next     Application .S creenUpdating = True End Sub 
この プログラム は VBA でしょ う か ？ それとも VB . Net でしょ う か ？ 変数 ・ メソッド ・ プロパティ が すべて 大文字 な の は なぜ でしょ う ？ 
Sub 一 例 です () Dim sh 1 As Worksheet , sh 3 As Worksheet , rng As Range , i As Long i = 7 Set sh 1 = Worksheets (" Sheet 1 ") Set sh 3 = Worksheets (" Sheet 3 ") With Worksheets (" Sheet 2 ") For Each rng In . Range (" F2 ", . Cells ( Rows . Count , " F "). End ( xlUp )) If Application . CountIf ( sh 3 . Range (" E : E "), rng . Value ) > 0 Then i = i + 1 rng . EntireRow . Copy sh 1 . Rows ( i ) End If Next rng End With End Sub 
以下 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim rng As Range For Each rng In Range (" F2 : L 2 ") If IsNumeric ( rng . Value ) Then rng . Value = Round ( rng . Value , 3 ) End If Next rng End Sub 
「 下記 の よう な 表 」 は ちょっと 理解 でき ない です ね 。 とりあえず 、 1 行 目 で 最終 列 を 割り出す と すれ ば 、 ↓ の よう な 感じ 。 Sub 一 例 です () Range (" B2 : B 6 "). Copy Range (" C 2 ", Cells ( 1 , Columns . Count ). End ( xlToLeft ). Offset ( 1 )). PasteSpecial Paste := xlPasteFormulas End Sub 
縦横 を 同時に 変更 する の なら Size 、 縦 を 変更 する の なら Height 、 横 を 変更 する の なら Width です 。 
スクロールバー の 「 リンク する セル 」 を 設定 し て 、 WorkSheet _ Change イベント で その セル が 変更 さ れ たら グラフ に 反映 さ れる よう に し て は どうでしょう か ？ ただし この 方法 だ と マウス で スクロールバー を 変化 さ せる と 1 変化 ごと に グラフ 描画 が 行わ れる ので 「 うっと おしく 」 なる と 思う の です が ・ ・ ・ 
担当者 の 表示 です 。 活用 し て 下さい 。 Sub 担当者 () Dim temp As Variant Dim i , s As Long temp = Array (" 野田 100 ", " 川田 101 ", " 原田 102 ", " 山田 103 ", " 岡田 104 ", " 池田 105 ") For s = 100 To 105 i = i & temp ( s - 100 ) & vbCrLf Next MsgBox i End Sub 
マクロ の 登録 、 と 書い て ある という 事 は マクロ の 基礎 は お わかり な の です ね 。 > 一つ の シート に 8 列 10 行 の 物 を 60 個 作り ( ラベルシール に なり ます ) > それぞれ 印刷 し たい の です が 印刷 枚数 も 全部 違い ます 。 8 列 10 行 の 物 と は 1 ページ 内 に 8 列 10 行 な の か 、 その 組み合わせ で 60 個 な の か 。 また 何 を 印刷 し たい の か 、 固定 文字 の ラベル な の か 、 説明 が 不足 し て い ます 。 それぞれ の 枚数 が 違う という 、 それぞれ と は 何 か の 元 データ が ある の でしょ う か 。 マクロ と 書い て ある の に 設定 という もの 矛盾 し て いる と 思い ます が 、 設定 という 事 で なら 、 最初 の 回答者 の 方 が 言わ れる 通り 、 その よう な 設定 は あり ませ ん 。 
一 例 です 。 = IF ( COUNTIF ( セル 範囲 ," NG ")," NG "," OK ") 
・ 平成生まれ しか 考え ない ・ 10月 時点 って 10月 の いつ だ よ 末日 に し とく か という 条件 なら 、 基準 の 年 から 誕生 年 を 引き算 し た の が 「 誕生日 を 過ぎ た とき の 年齢 」 な ので 、 誕生 月 が 11月 以降 の 場合 だけ まだ 誕生日 を 過ぎ て ない として 1 引き ます 。 =( 基準 年 - 誕生 年 )-( 基準 月 < 誕生 月 ) これ だけ 。 
こんにちは。 サムネイル の 集まり の 画面 です けど ね 。 実際 クリック する と 、 記事 に なっ て しまう ので 、 「 画像 サムネイル 」 の 保存 という こと です google の 検索 結果 を 表示 し て いる とき の url を 、 メモ帳 で 直接 開く と 、 メモ帳 で ソース は 見る こと が 出来 ます 。 画像 の 検索 結果 で 、 img タグ の ソース は 、 アドレス が 長い です し 、 最後 は 引数 で 終わる ので 拡張 すら 、 あり ませ ん けど 、 その アドレス だっ たら 、 MS ペイント で も 直接 開き ます 。 つまり 、 VB 6 に ある よう な 、 「 url の 直接 ファイル 保存 」 が 、 できる という こと です 。 どこ まで 、 なに が 出来 て いる か で 、 話 が 変化 し ます 。 確認 し て み て ください 
素晴らしい 説明 が 有り まし た 。 ご 参考 に なれ ば 。 http:// qiita . com / mima _ ita / items / dd 95 ba 1 f2 5 ba 176 fccb 3 個人的 に は ActiveReport は 使い慣れ てる ので 、 そちら を 利用 し たい と 思い ます 。 追加 変更 ファイル の 配布 方法 で 考え た 方 が いい かも しれ ませ ん ね 。 
プロジェクト 名 の プロパティ を 開い て 「 リンカー 」 → 「 全般 」 → 「 追加 の ライブラリ ディレクトリ 」 に $( DXSDK _ DIR )\ lib \ x86 ; と いう を 追加 し て ください 。 「 C/C++ 」 → 「 全般 」 → 「 追加 の インクルード ディレクトリ 」 に $( DXSDK _ DIR ) include という の を 追加 し て ください 。 
未確認 です が 、 できる よう です 。 http:// vaindespair . blogspot .jp / 2012 / 04 / blog - post _ 7272 . html 
こんにちは。 変数 の 初期化 の 確認 の コード は 、 主 様 の その コード な ん でしょ う か 。 今 まで 、 エラー に なら なかっ た だけ の よう な 気 が する 。 redim の あと 、 doevents を 実行 し た ほう が 、 よほど 効果 あり そう です 。 
質問 が 大雑把 です ね 。 > vb の 課題研究 で なに か 作成 し なけれ ば いけ ませ ん 。 VB （ Visual Basic ） と 言っ て も 、 「 Visual Basic 6 . 0 」 「 Visual Basic .NET 」 「 visual Basic for Application s 」 等 で は 、 それぞれ 出来る 事 が 違い ます 。 課題研究 で 作成 する プログラム の 規模 や 、 あなた の スキル も 分かり ませ ん 。 ・ メモ帳 ・ スケジュール 帳 ・ 万年カレンダー ・ ゲーム ・ WEB ブラウザ ・ メーラー など など 、 無限 に ある か と 思い ます が ・ ・ ・ あなた は どんな 物 が 作り たい の でしょ う か ？ 
# include < stdio . h > int main ( void ) { int a , b , i ; FILE * file ; while ( 1 ){ printf (" 数値 1 の 入力 :"); scanf ("% d ",& a ); printf (" 数値 2 の 入力 :"); scanf ("% d ",& b ); if ( a == b ) printf (" もう一度 入力 し て ください 。 \ n \ n "); if ( a != b ) break ; } file = fopen (" range . txt "," w "); if ( a < b ) for ( i = a ; i <= b ; i ++) fprintf ( file ,"% d ", i ); else for ( i = b ; i <= a ; i ++) fprintf ( file ,"% d ", i ); fprintf ( file ,"\ n "); fclose ( file ); printf (" 出力 し まし た 。 \ n "); return 0 ; } for 文 の 外 で open し て ください 。 現状 で は １ 回 だけ の 出力 で は なく 、 上書き に なっ て いる だけ です 。 
http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1416049108 ... と 全く 同じ 質問 の よう です が ？ 
この まま で は 、 必ず location s に 指定 さ れ た A1 ～ I 1 に 転記 さ れ て しまい ます 。 希望 と すれ ば 転記 済 の 最終 行 の 次 の 行 に 転記 し たい です よ ね 。 です から 、 最終 行 を 求め 、 location s から その 行 数 分 下 に 転記 する よう に し ます 。 修正 例 （ 修正 部位 分 のみ ） ' 項目 入力 ボタン が クリック さ れ た 時 の 処理 Private Sub Command Bu t to n2 _ Click () Dim i As Integer Dim n As Long '<= 最終 行 を 入れ ます ' ブック が 開か れ て い なけれ ば 何 も し ない If bk Is Nothing Then Exit Sub ' アクティブ な シート が 日 シート で なけれ ば 転記 し ない Set st = bk . ActiveSheet If st . Name = " メイン " Then Exit Sub ' 最終 行 を 求め ます －－ ここ からーー n = st . UsedRange . Rows ( st . UsedRange . Rows . Count ). Row ' １ 行 目 に も 値 が ない 場合 は ０ に する If n = 1 And Application . WorksheetFunction . CountA ( st . Rows ( 1 )) = 0 Then n = 0 End If ’－－ ここ まで 追加 ーー ' 項目 １ から 項目 ９ を 転記 する For i = 1 To 9 ' SetValue の 2つ め の 引数 を 追加 SetValue location s ( i - 1 ), n , Me . Controls (" TextBox " & i ) Next i ' メッセージ を 表示 する DoEvents MsgBox " 転記 し まし た 。 " Command Bu t to n3 .S etFocus End Sub ' テキストボックス の 内容 を シート に 転記 する （ 2つ め の 引数 を 追加 ） Private Sub SetValue ( cell As String , n As Long , data As String ) On Error Resume Next ' 指定 の セル の n 行 下 に セット する st . Range ( cell ). Offset ( n ). Value = data On Error GoTo 0 End Sub > また シート 開く とき に ブック が 平成28年 1月 1 . xls に なる の は なぜ です か ？ ' ブック を 開く Set bk = Workbooks . Add ( bkPath & bkName ) と し て い ます が 、 Workbooks . Add で は ブック の 追加 に なり ます ので 、 すでに ある 「 平成28年 1月 . xls 」 を テンプレート として 新しい ブック を 追加 、 名前 は元 の ブック 名 に 「 1 」 を 付け て 「 平成28年 1月 1 」 に なっ て しまい ます 。 既存 の ブック を 開く の で あれ ば ' ブック を 開く Set bk = Workbooks . Open ( bkPath & bkName ) と し ます 。 
でき ない こと は ない です 。 http:// www . vba - ie .net / form / subroutine - input . html ただし 、 パスワード の 管理 など 適切 に やら ない と 危ない ので 、 やめ た ほう が いい と 思い ます 。 。 。 
下記 の コード でいか が でしょ う か ？ 一 個 の セル だけ で なく 、 複数 の セル 範囲 が 選択 さ れ た 場合 に も 対応 し て い ます 。 数字 以外 の セル に対して は 何 も し ませ ん 。 Option Explicit Sub Sample () Dim rng As Range If TypeName ( Selection ) <> " Range " Then Exit Sub For Each rng In Selection . Cells If IsNumeric ( rng . Value ) Then rng . Value = Round ( rng . Value / 2 , 3 ) End If Next rng End Sub 
質問 の 意味 は 、 わかり ます 。 もしも 私 が 解釈 し た 仕様 で あれ ば 、 その 仕様 は 、 ごちゃごちゃ し て 説明 し づらい と 思い ます 。 よって 、 まず その 仕様 を 下記 に 書き ます 。 [ もともと 行ない たかっ た 仕様 ] ピクチャ ボックス の 中 に （ 上 に ） ボタン を 配置 する 。 その 際 に 、 その ボタン は 、 透明 化 する （ ボタン の 文字列 や 枠 だけ 見え て 、 ボタン の 背景 は 透け て 、 ピクチャ ボックス の 画像 が 見える よう に する ） 。 [ 今回 の 質問 の 仕様 ] 上記 の 「 もともと 行ない たかっ た 仕様 」 で は 、 何 を やっ て も ボタン が 透明 化 し ない 。 そこで 、 以下 の 仕様 に する こと に し た 。 ピクチャ ボックス の 中 に （ 上 に ） 、 別 の ピクチャ ボックス を 配置 する 。 その 際 に 、 中 側 の （ 上側 の ） ピクチャ ボックス は 、 透明 化 する （ 中 側 の ピクチャ ボックス に 描画 する 枠 だけ 見え て 、 中 側 の ピクチャ ボックス の 背景 は 透ける よう に する ） 。 この 場合 、 中 側 の （ 上側 の ） ピクチャ ボックス の 透明 化 は 、 うまく 行く 。 しかし 、 中 側 の （ 上側 の ） ピクチャ ボックス を ボタン 代わり に する 際 に 、 その クリック イベント の 扱い 方 が 、 わから ない ので 本 質問 を 出し た 。 [ 回答 本編 : 方法 １ ] 上記 仕様 で 合っ て いる 場合 は 、 下記 の 通り です 。 画像 を 貼り 付ける ピクチャ ボックス を pictureBox 1 と し 、 ボタン 代わり に する ピクチャ ボックス を pictureBox 2 と する と 、 // pictureBox 2 の 親 コントロール を pictureBox 1 と 指定 する pictureBox 1 . Controls . Add ( pictureBox 2 ); と し ます 。 全体 の コード は 、 下記 に 記し ます 。 なお 、 下記 の 全体 の コード は 、 pictureBox 2 の クリック イベント の 扱い 方 まで は 書い て い ませ ん 。 しかし 、 普通に 、 pictureBox 1 . 何 々; と 言う 指定 が 行 なえる ので 、 イベントハンドラ を いじら なく て も 操作 が 行なえ ます 。 「 ＜ C# ＞ ピクチャーボックス の 上 に 、 透明 化 し た 別 の ピクチャーボックス を 配置 する サンプル No. １ --- 透明 化 ピクチャーボックス に 円 を 描画 する 」 http:// note . chiebukuro . yahoo . co.jp / detail / n3 75793 [ 方法 ２ ] やっ た こと は ない の です が 、 質問 の よう に Parent プロパティ を 使う 手法 でし たら 、 以下 の よう に すれ ば よい と 思い ます 。 Parent プロパティ を PictureBox クラス へ の キャスト （ 型変換 ） を すれ ば 、 ピクチャ ボックス として 機能 する はず です 。 PictureBox Pic _ Box _ Work = ( PictureBox ) button . Parent ; その あと は 、 普通に 、 Pic _ Box _ Work . 何 々; と 言う 指定 が 行 なえる ので 、 画像 表示 用 ピクチャ ボックス の 操作 が 行なえ ます 。 
いろいろ 問題 が 有り 過ぎ です ね ？ ＆ 演算子 も 勉強 し なおし です 。 Sub 消費税 計算 () Dim Teika As Long , Zei As Double , ZeiGaku As Double Teika = Range (" B 3 "). Value Zei = Range (" B4 "). Value ZeiGaku = Teika * Zei MsgBox " 定価 " & Teika & " の 消費税 は " & ZeiGaku & " です 。 " Range (" B5 "). Value = Teika + ZeiGaku End Sub 
sf As Double , lf As duble , lf As Double ) を sf As Double , lf As Double ) として み て ください 。 
こんにちは。 ファイル を 開い て 、 環境 を 用意 し たら 、 「 マクロ の 自動 記録 」 を 使っ て 、 コード を 生成 し 、 必要 に 修正 を 追加 する 、 という の が 、 ピボット の コード です 。 エクセル の バージョン でも 違い ます 。 最終 行 の 取得 は gyo = sheets (" シート 名 "). range (" A " & rows . count ). end ( xlup ). row で 変数 で ピボット に 与え ます 。 日々 変化 する の でし たら 、 変数 に する こと を 考え て ください 。 ブック が 変化 し ない 場合 は 、 シート の もともと の ピボットテーブル を 初期 化 する 考え方 も 必要 です 。 
別 シート の データ は どの よう に なっ て いる の でしょ う 。 ・ 下図 の 三 例 の うち どれ な の でしょ う か 。 ・ また 、 同じ 品名 が 複数 区分 に 存在 する こと は 無い の でしょ う か 。 
> Set w = ActiveSheet > w . PageSetup . Zoom = 30 ' 30 % に 縮小 と なっ てる ので 、 ActiveSheet だけ 縮小 さ れ てる から だ と 思い ます 。 不要 だ と 思える 部分 が ある よう です が 、 以下 で どうでしょう 。 Private Sub CommandButton 1 _ Click () For Each myWS In Worksheets If myWS . Name Like "*★*" Then myWS . PageSetup . Zoom = 30 ' 30 % に 縮小 myWS . PrintOut End If Next End Sub 
バージョン が わかり ませ ん が 、 たぶん どれ も 同じ だ と 思い ます 。 メニュー バー の [ ツール ]→[ オプション ] を 選択 。 [ テキスト エディター ] →[ すべて の 言語 ] →[ 全般 ] を 選択 表示 の [ 行番号 ] を オン に し ます 
Sub MakePDF () を 書き かえる の なら Sub MakePDF () Dim fName As String , i As Long , xToF As Boolean For i = 1 To 3 xToF = True If i <> 1 Then If Trim ( sh . Cells ( i , 1 ). Value ) = "" Then xToF = False End If End If If xToF Then With Worksheets (" Sheet " & i ) ' fName に 作成 する ファイル 名 fName = orgName & "_" & . Cells ( i , 2 ). Value & "_" & . Cells ( i , 3 ). Value & ". pdf " . ExportAsFixedFormat Type := xlTypePDF , Filename := _ nDir & "\" & fName , Quality := xlQualityStandard , _ IncludeDocProperties := True , IgnorePrintAreas := False , OpenAfterPublish := False End With End If Next i End Sub 未 実行 につき 不具合 ご 容赦 。 
こんにちは。 csv ファイル を 書き込み に 行く 前 に 、 ディレクトリ まで の パス を チェック する 形 で どうでしょう ？ Dim csvPath As String csvPath = " C :\ データ " ’ ここ に は 必要 な パス を 入れ て ください 。 If Len ( Dir ( csvPath , vbDirectory )) = 0 Then MkDir ( csvPath ) End If ただ 、 データ の 下 の 階層 まで 一 度 に は MkDir で い ない ので 注意 が 必要 です 。 
JavaScript どころ で は ない です 。 Flash や ある意味 Flash 以上 の 動き や 機能 を 付け られ ます 。 例 「 シューティングゲーム 猫 と エクセル 」 http:// www . geocities . co.jp / SiliconValley - Cupertino / 8748 / shooting . ht ... ↑ 過去 に 困り ごと が あっ た とき     この 作者 の 方 に 直接 質問 を し と こと など も あり ます 。     ( お返事 も 高度 過ぎ て 半分 以上 付い て いけ ませ ん でし た が 。。。) その他 の 例 「 エク セルアニメーション 第 １ 回 ( マクロ 準備 編 ） - エク セルアニメーション 」 http:// blog . goo . ne.jp / cisco 33 / e / 45 c5 f6 14633 cc 0 b6 7 e2 99 afbf 360 c1 0 e 「 がらくた 箱 猫 と エクセル 」 http:// www . geocities . co.jp / SiliconValley - Cupertino / 8748 / him it u. htm JavaScript って 結局 操作 する の が HTML な ん です よ 。 です から 制約 だらけ で 動き は かなり 作り にくい です 。 Flash は そもそも 動き を つくっ たり 見 たり する ため の ソフト で あっ たり コンテンツ です が Web 上 の クライアントサイド で しか 動作 し ない もの な ので 「 セーブ 」 みたい な こと は 他 言語 を 使わ なけれ ば でき ませ ん し Web ( ブラウザ ) で 見る 店 において は JavaScript 同様 セキュリティ も 厳しい ので 結構 制約 だらけ な ん です 。 Excel など の VBA は そういう Web 的 な 制約 が 無い 分 色々 な 意味 で の 「 動き 」 は JavaScript 以上 に 自由 に 作る こと が でき ます 。 ただし ！ Web 上 で は 動作 し ない とか Excel を 持っ て ない と 動か ない とか ( Flash と 同様 ， 基本的 に スマホ で は 動か ない でしょ う 。 ) その他 セキュリティ 面 で 弱い 分 ウィルス など に 注意 する 必要 が ある という 「 大きな 障壁 」 は あり ます 。 
ユーザー フォーム ２ を Show する 前 に 、 Load し 、 トグル ボタン の Value や フォーム の BackColor を 操作 し ます サンプル です ' フォーム ① の コマンド ボタン A を クリック し た 時 の 処理 Private Sub コマンド ボタン A _ Click () Load ユーザー フォーム 2 ユーザー フォーム 2 . トグル ボタン a . Value = True ユーザー フォーム 2 . BackColor = RGB ( 0 , 255 , 255 ) ユーザー フォーム 2 .S how End Sub ' フォーム ① の コマンド ボタン B を クリック し た 時 の 処理 Private Sub コマンド ボタン B _ Click () Load ユーザー フォーム 2 ユーザー フォーム 2 . トグル ボタン b . Value = True ユーザー フォーム 2 . BackColor = RGB ( 0 , 255 , 255 ) ユーザー フォーム 2 .S how End Sub 
＞ VBA で A1 〜 A15 に 入力 さ れ た 整数 の 中 から 最大 値 を C 2 に 表示 さ せる 方法 ⇒ 普通 、 ワーク シート 関数 で C 2 に = MAX ( A1 : A15 ) で 十分 ＞ if 〜 then もし 〜 なら ば GoTo 繰り返し 処理 ⇒ どうしても ＶＢＡ なら 一 例 です が GoTo は 使用 し ませ ん 。 Sub sample () Dim mx As Long , r As Range For Each r In Range (" A1 : A15 ") If IsNumeric ( r ) And r > mx Then mx = r Next Cells ( 2 , " C ") = mx End Sub また 、 ワーク シート 関数 を 利用 すれ ば こんな 感じ です 。 Sub sample 1 () Cells ( 2 , " C ") = Application . Max ( Range (" A1 : A15 ")) End Sub 
http:// www . grapecity . com / tools / support / technical / knowledge _ de tai l.a. .. 
vb.net の 話 なら 、 基本的 に は こんな でしょ う か 。 PictureBox 1 が ある 場合 です 。 Sub sample () With New OpenFileDialog () If .S howDialog () = DialogResult . OK Then PictureBox 1 . ImageLocation = . FileName End If End With End Sub 詳しく は 「 ファイル を 開く 」 ダイアログボックス を 表示 する http:// dobon .net / vb / dotnet / form / openfiledialog . html PictureBox コントロール に 簡単 に 画像 を 表示 する http:// dobon .net / vb / dotnet / graphics / pictureboximage . html を 参照 
こんな でしょ う か 。 Sub sample () Dim r As Long ActiveSheet . ResetAllPageBreaks ' 改 ページ 削除 ( 必要 なら ) r = 5 ' 見出 し行 Do r = r + 25 ' デー タ行 ActiveSheet . HPageBreaks . Add Before := Rows ( r + 1 ) ' 改行 挿入 ( 指定 セル の 前 ( Before ) で 指定 する ので + 1 し て いる ) Loop Until r >= ActiveSheet . UsedRange . Rows . Count ' 最終 セル を 超え たら 終わり End Sub 
If Range (" B 1 "). Value <> "" Then . AutoFilter Field := 2 , Criteria 1 :="*" & Range (" B 1 "). Value & "*" End If If Range (" B2 "). Value <> "" Then . AutoFilter Field := 3 , Criteria 1 :="*" & Range (" B2 "). Value & "*" End If If Range (" B 3 "). Value <> "" Then . AutoFilter Field := 6 , Criteria 1 :="*" & Range (" B 3 "). Value & "*" End If ↓ ↓ ↓ IIf Range (" B 1 "). Value <> "" Then . AutoFilter Field := 2 , Criteria 1 := Range (" B 1 "). Value & "*" End If If Range (" B2 "). Value <> "" Then . AutoFilter Field := 3 , Criteria 1 := Range (" B2 "). Value & "*" End If If Range (" B 3 "). Value <> "" Then . AutoFilter Field := 6 , Criteria 1 := Range (" B 3 "). Value & "*" End If 
一 例 です 。 Sub sample () Dim i As Long , j As Long , db , wk , wk 1 On Error Resume Next Set db = CreateObject (" Scripting . Dictionary ") With Sheets (" sheet 1 ") For i = 1 To . Cells ( Rows . Count , " A "). End ( xlUp ). Row wk = . Cells ( i , " A ") & "," & . Cells ( i , " B ") db ( wk ) = db ( wk ) & . Cells ( i , " C ") & " " Next End With wk = db . keys With Sheets (" sheet 2 ") . Cells . ClearContents For i = 0 To UBound ( wk ) . Cells ( j + 1 , " A ") = Split ( wk ( i ), ",")( 0 ) . Cells ( j + 1 , " B ") = Split ( wk ( i ), ",")( 1 ) wk 1 = Split ( Trim ( db ( wk ( i ))), " ") . Cells ( j + 1 , " C "). Resize ( UBound ( wk 1 ) + 1 ) = _ Application . Transpose ( wk 1 ) j = j + UBound ( wk 1 ) + 1 Next End With Set db = Nothing End Sub 
こんにちは。 基本的 に 、 fso は 、 処理 が 時間 かかり ます 。 ファイル の 数 が 多い こと で 、 ファイル の 処理 が 追いつい て い ない 、 という の でし たら 、 ファイル を ひとつ コピー し たら 、 一定 時間 待っ て みる か 、 コピー し 終わっ た 後 で 、 file の 確認 する コード を 追加 し て 、 ゆっくり 処理 さ せ たら 、 様子 が 変化 する か も しれ ませ ん 。 それ で 変化 し たら 、 os の 処理 が 、 期待 通り で は ない 、 という こと です 。 
.S aveAs Filename := mypath & sheetname & ". xlsx " ↓ .S aveAs Filename := mypath & Worksheets ( r ). Name & ". xlsx " 名前 が 空白 で 、 拡張子 だけ の ファイル 名 は ご法度 
match 関数 の 第 三 引数 を 確認 し ましょ う 。 
デフォルト だ と 、 Visual Studio の 右 の 方 に 「 ソリューション エクスプローラ 」 と 言う タブ が ある ので 、 クリック し て 表示 し ます 。 修正 し たい フォーム が 含ま れる プロジェクト を 選択 し て 、 フォーム を デザイナ で 表示 し ます 。 フォーム が デザイナ で 表示 さ れ たら 、 修正 する ボタン を 右クリック → プロパティ → 「 テキスト 」 と 言う 項目 が ある ので 、 それ を 修正 し ます 。 
こんな 感じ です か ね Public Class Form 1 Private Sub Form 1 _ Load ( sender As Object , e As EventArgs ) Handles MyBase . Load Dim dt As New DateTime ( Now . Ticks ) NumericUpDown 1 . Value = dt. Month NumericUpDown 2 . Value = dt. Day \ 10 NumericUpDown 3 . Value = dt. Day - ( dt. Day \ 10 ) End Sub Private Sub Button 1 _ Click ( sender As Object , e As EventArgs ) Handles Button 1 . Click Try Dim setyear As Integer = Now . Year Dim setmonth As Integer = NumericUpDown 1 . Value Dim setday As Integer = ( NumericUpDown 2 . Value * 10 ) + NumericUpDown 3 . Value Dim dt As New DateTime ( setyear , setmonth , setday ) MsgBox ( dt. ToString ) Catch ex As Exception MsgBox ( ex. Message , 16 ) End Try End Sub End Class アプリ 起動 時 に NumericUpDown へ 日付 を セット し ます 。 Button 1 を クリック する と DateTime 型 へ 変換 し ます 。 参考 ・ DateTime 構造体 https :// msdn . microsoft . com / ja - jp / library / system . datetime ( v = vs . 110 ).... 
モーダル で 開い たら 別 の フォーム の 操作 は 出来 なく なり ませ ん か ？ モーダル で 3つ の フォーム 開け て ます か ？ 
A1 と A 2 に は それぞれ 別 の 画像 の 名前 が 指定 さ れ て いる の です か ？ それなら 1 セル ずつ 処理 さ せ なけれ ば 一気に 2 枚 処理 は 出来 ませ ん 。 Range (" A1 : A 2 ") と し た 場合 、 デフォルト で 範囲 ( オブジェクト型 ) が 取ら れ ます 。 Range (" A1 ") と し た 場合 デフォルト で . value ( 値 ) が 取ら れ ます 。 これ が 型 が 違い ます と 言わ れ て いる 部分 です よ 。 Sub 画像 () With ActiveSheet . Pictures . Insert (" C :\ image \" & Range (" A1 ") & ". png ") . Left = Range (" E 1 "). Left . Top = Range (" E 1 "). Top ' With .S hapeRange . LockAspectRatio = msoTrue If . Width * Range (" E 1 "). Height / . Height < Range (" E 1 "). Width Then . Height = Range (" E 1 "). Height Else . Width = Range (" E 1 "). Width End If End With End With With ActiveSheet . Pictures . Insert (" C :\ image \" & Range (" A 2 ") & ". png ") . Left = Range (" E2 "). Left . Top = Range (" E2 "). Top ' With .S hapeRange . LockAspectRatio = msoTrue If . Width * Range (" E2 "). Height / . Height < Range (" E2 "). Width Then . Height = Range (" E2 "). Height Else . Width = Range (" E2 "). Width End If End With End With End Sub コード そのまま 分割 し た だけ な ので 未検証 です が どうでしょう 。 
書類 は ワープロ 等 で 出力 さ れ て いる もの です か ？ それとも 手書き です か ？ OCR など といった 技術 を 使っ て 、 数字 として 読み取る こと も 可能 です し 、 入力 さ せる こと も 可能 です が 、 ご 認識 を 考える と リスク の ほう が 大きい と 思い ます 。 手書き文字 です と 、 0 と ６ の 区別 、 ワープロ 文字 で も 0 と 9 の 区別 、 その他 、 2 と 5 、 1 と 7 など 、 特に 金額 の よう に 間違う と 大変 な こと に なる もの を 自動 化 する の は リスク が 大きい です 。 そもそも論 で 言え ば 、 書類 で いただく の を やめる か 、 書類 で もらっ た もの を （ 計算 が 必要 で なけれ ば ） そのまま スキャン し て 保存 し て おけ ば 良い です 。 Excel に 入力 し て 計算 する ひつ よう の ない 文書 や 、 内部 まで 詳細 に 検索 する 必要 の ない 文書 で あれ ば 、 社内 で わかり やすい ファイル 名 に する ルール を 作っ て 、 スキャン し て 終わり に すれ ば 良い です 。 「 本当に それ は 、 PC に 入力 し て 緻密 な データ に 変換 する 必要 が ある か ？ 」 を 考えなおし たほう が 良い でしょ う 。 つぶさに 見 なおせ ば 、 おそらく 金額 計算 用 の 数字 と 、 注文書 番号 だけ 入力 すれ ば 良い よう な 仕組み に なる と 思い ます よ 。 
>③ で D1 ＆ N 1 を 一番 右端 に 挿入 し A1 は 【 東京都 杉並区 鈴木 太郎 】 に する >④ で A1 【 東京都杉並区 鈴木太郎 】 に する と 言う よう な の は 不要 です 。 COUNTIFS という 便利 な 関数 が ある の です から 、 それ を 使わ ない 手 は ない でしょ う 。 以下 の 例 は 、 D 列 ＆ N 列 で 重複 を カウント し 、 結果 を B 列 へ 。 結果 が １ 以上 の 場合 、 B 列 の セル を 赤色 背景 に し て い ます 。 Sub 一 例 です () Dim i As Long For i = 1 To Cells ( Rows . Count , " D "). End ( xlUp ). Row With Cells ( i , " B ") . Value = Application . CountIfs ( Columns (" D "), Cells ( i , " D "), Columns (" N "), Cells ( i , " N ")) If . Value > 1 Then . Interior . Color = vbRed End If End With Next i End Sub ① ・ ② の 工程 は 、 ご 自身 で 考え て み て ください 。 
一番 左 の 名称 の 列 の 区切り の いい ところ 。 今回 は 15 行 の 所 と の 事 な ので 名称 列 15 行 の セル を 選択 し て 表示 タブ ＞ ウィンドウ ＞ ウィンドウ の 固定 で スクロール できる よう に なり ませ ん か ？ ？ マクロ を 組ん で 実施 し た こと が ない ため 間違え て い たり でき なかっ たら 申し訳 ありません 
それ は 大変 です ね 。 まぁ 、 中身 が 見え ない んで 何とも 言え ませ ん が 。 
改行 を 検索 し たい の ？ 改行 を 無視 し て 検索 し たい の ？ で 、 何 の Grep ? もしかして 自分 で Grep 作り たい の ？ 
誰 から も 回答 が 無い よう な ので 、 直接 の 回答 で は 有り ませ ん が 参考 に なれ ば 。 私 は Ｒ を 使っ た 事 が 無い ので Ｒ に 付い て は サッパリ 判り ませ ん が 、 ＣＳＶ ファイル は , で 文字列 を 区切っ た テキストファイル です 。 メモ帳 等 の テキストエディタ で 開く 事 が 出来 ます 。 処理 出来 て いる ファイル と 出来 ない ファイル を テキストエディタ で 内容 を 比較 すれ ば 原因 が 判る の で は ？ 
getElementsByClassName の 返り 値 は 配列 です から 、 「( 0 )」 を 付け なけれ ば 、 自動的 に 指定 し た クラス 全て が 配列 として 取得 さ れ ます 。 Set obj = objIE . document . getElementsByClassName (" class ") 後 は 、 配列 として アクセス すれ ば 良い だけ です 。 For n = 0 To obj . Length - 1 msg = obj ( n ). outer HTML Next getElements ○ ○ は 、 複数形 に なっ て いる こと から 分かる よう に 、 配列 で 複数 取得 さ れる 命令 です 。 
こんにちは。 主 様 、 どう 考え て も 、 最初 は 、 台帳 その 台帳 から 、 条件 を 与え て 、 請求書 の 作成 を する 、 という よう に し ない と 、 「 どこ に 請求書 を 作成 し た の か 、 が 、 わかり ませ ん 」 もし 、 「 今 だけ は 」 という の が ある の でし たら 、 与える ほう の データ は 「 生データ ー 」 という こと に なる ので 、 せっかく 転記 の コード を 作成 し て も 、 あらゆる 整合 チェック が 必要 という こと です 。 転記 し ない と いけ ない 伝票 の 数 の 最大 値 の 確認 。 ルール 違反 の データ の ある / なし の 確認 転記 が 正しく 出来 た か 、 出来 なかっ た か の 「 リスト 」 を 作成 。 リスト を 中心 に 、 転記 の 回路 作成 リスト を 順番 に 実行 という よう な 手順 と なり ます 。 あと 、 ブック の リンク とか 、 確認 です 。 その 程度 の 伝票 で 外部 に リンク が あっ たら 、 問題 です 。 
一 例 です 。 Sub Sample () Dim rng As Range , buf As String For Each rng In Range (" A1 : A " & Cells ( Rows . Count , 1 ). End ( xlUp ). Row ) If Val ( rng . Offset (, 1 )) >= 1 Then buf = buf & rng . Value & " " & rng . Offset (, 1 ) & " 回 " & vbCrLf End If Next rng MsgBox buf End Sub 
下 の 図 の よう な こと で よろしい でしょ う か ？ ・ データ 数 は 省略 し て 作っ て い ます 。 ・ なお 、 B 列 の 型番 の 数字 は 、 ” 文字列 数字 ” （ セル の 左寄り に なる ） で ある 必要 が あり ます （ 「 004 」 の よう に 前 に 「 0 」 が 付く 型番 の 場合 に 正しい データ が 表示 さ れ なく なる 可能性 が あり ます ） 。 ・ それ と 、 B 列 の 型番 の 範囲 内 に 空白 の セル が ない 、 という 前提 です 。 C 2 セル に は 、 ① = IFERROR ( LOOKUP ( 10 ^ 4 , MATCH ("*"& B $2 : B $10 &"*", A 2 ,), B $2 : B $10 ),"") の 式 を 入れ て 、 下 に オート フィル （ コピー ） し て い ます 。 
知恵袋 は 変数 でしょ う か 、 それとも 「 知恵袋 」 という 文字列 を 意図 し て いる の でしょ う か ？ もし 知恵袋 が 変数 で あれ ば 、 知恵袋 に は どの よう な 値 を 設定 し て い ます か ？ もし 知恵袋 が 文字列 なら 「 If フィルター = " 知恵袋 " Then 」 と し て み て ください 。 
> いきなり k = 32 と なっ て しまい ます そりゃ そう ですよ。 For j = 1 To 150 ' ｊ は 列 番号 です から 、 j が 32 に なっ た 時 に は k も 32 に なり ます から 。 For j = 1 To 15 ' ｊ は 列 番号 の 間違い です よ ね ・ ・ 
ご存知 だ と 思い ます が 、 手動 で 行う 場合 は B21 : C21 を コピー し て 、 B 16 : B2 0 を 選択 し て コピー すれ ば 問題 なく 参照 の 法則 が 変わり ませ ん よ ね 。 VBA に すれ ば Cells ( 21 , 2 ). Resize ( 1 , 2 ). Copy Selection . Offset (- 4 , 0 ). Resize ( 5 , 1 ) と なり ます 。 数式 だけ コピー し たい ん だ 、 って こと で あれ ば Cells ( 21 , 2 ). Resize ( 1 , 2 ). Copy Selection . Offset (- 4 , 0 ). Resize ( 5 , 1 ). PasteSpecial ( xlPasteFormulas ) Application . CutCopyMode = False と なり ます 。 では Selection . Offset (- 4 , 0 ). Resize ( 5 , 2 ). FormulaR 1 C1 = Cells ( 21 , 2 ). FormulaR 1 C1 で は うまく いっ て 、 Selection . Offset (- 4 , 0 ). Resize ( 5 , 2 ). FormulaR 1 C1 = Cells ( 21 , 2 ). Resize ( 1 , 2 ). FormulaR 1 C1 で は うまく いか ない の でしょ う か 。 私 も 詳しく は ない ので わかり ませ ん 。 です が 、 FormulaR 1 C1 は 数式 の 文字列 が はいる ので Selection . Offset (- 4 , 0 ). Resize ( 5 , 2 ). FormulaR 1 C1 = "= R1 C - RAN K. AVG ( R C1 , R [- 4 ] C1 : R C1 )" でも 思っ た 通り に なり ます 。 これ は Cells ( 21 , 2 ). FormulaR 1 C1 の 中身 が "= R1 C - RAN K. AVG ( R C1 , R [- 4 ] C1 : R C1 )" なので 当たり前 です 。 でも 、 Cells ( 21 , 2 ). Resize ( 1 , 2 ). FormulaR 1 C1 に する と 単純 に 文字列 で は なく 、 たぶん 配列 に なる ん だ と 思い ます 。 ただ 、 それ を Selection . Offset (- 4 , 0 ). Resize ( 5 , 2 ). FormulaR 1 C1 に 代入 する と あんな 式 に 変換 さ れる の か は 説明 でき ませ ん 。 
行列 の 積 って 一般 的 な 積 で いい の です よ ね 。 Excel VBA なら 、 Excel ワーク シート 関数 の MMULT を 使う の が 便利 だ と 思い ます 。 セル 範囲 等 が 分かり ませ ん が 、 例えば [ Sheet 2 ! A1 : C3 ]= Application . WorksheetFunction . MMult ([ Sheet 1 ! A1 : C3 ],[ Sheet 1 ! E 1 : G3 ]) の よう に すれ ば いい わけ です 。 もちろん 、 ループ を 組ん で 公式 どおり に 計算 し た って 構い ませ ん 。 たとえば 下記 の よう に 記述 すれ ば 同じ よう に 計算 でき ます 。 しかし たった １ 行 で 済む ところ を 、 この よう に 長々 と 書く の は 無駄 だ し 、 計算 も 遅い です 。 Dim A As Variant , B As Variant , C ( 1 To 3 , 1 To 3 ) As Variant Dim I , J , K As Long A = [ Sheet 1 ! A1 : C3 ] B = [ Sheet 1 ! E 1 : G3 ] For I = 1 To 3 For J = 1 To 3 C ( I , J ) = 0 For K = 1 To 3 C ( I , J ) = C ( I , J ) + A ( I , K ) * B ( K , J ) Next Next Next [ Sheet 2 ! A1 : C3 ] = C 
一般 的 な 用語 的 で 「 ケタ 」 と 言う の は 使わ ない と 思い ます 。 Y = Range (" C " & Rows . Count ). End ( xlUp ). Row で 、 Y に C 列 の 最終 行 の 値 を 取得 でき ます 。 ある 行 の 最終 列 を 求める 場合 は 、 X = Cells ( 5 , Columns . Count ). End ( xlToLeft ). Column と する と 、 X に 5 行 目 の 最終 列 の 値 を 取得 でき ます 。 
> 配列 （ tmp ) に csv ファイル の 全 行 カンマ 区切り 文字列 を 格納 し たい なに を し たい の か 伝わら ない です ね 。 とりあえず 、 適当 に 解釈 する と １つ １つ の 項目 を バラバラ に し て 、 配列 に 格納 する の なら Sub Sample () Dim xTxt As String , xAry , 配列 数 As Long With CreateObject (" Scripting . FileSystemObject ") With . GetFile (" C :\ AAA \ HogeHoge . csv "). OpenAsTextStream xTxt = . ReadAll . Close End With End With xTxt = Replace ( xTxt , vbCrLf , ",") xTxt = Replace ( xTxt , " ", "") xAry = Split ( xTxt , ",") 配列 数 = UBound ( xAry ) End Sub そう で は なく 、 「,」 は 残し 、 1 行 ずつ 配列 に 格納 する という こと なら Sub Sample () Dim xTxt As String , xAry , 配列 数 As Long With CreateObject (" Scripting . FileSystemObject ") With . GetFile (" C :\ AAA \ HogeHoge . csv "). OpenAsTextStream xTxt = . ReadAll . Close End With End With xTxt = Replace ( xTxt , " ", "") xAry = Split ( xTxt , vbCrLf ) 配列 数 = UBound ( xAry ) End Sub 全 行 一気に 読み込む なら 、 FileSystemObject が 扱い やすい です 。 
こういう こと ？ vp   =   " C :\"   '' 試験 用 '' Set   Name = CreateObject (" Shell . Application "). BrowseForFolder ( 0 ,   " script を 選択 ", 1 ,""   &   vp   &   "") If   Not   Name   Is   Nothing   Then    If   Name. Items . Item . Path   =   " C :\ Program   Files "   Then      WS cri pt. Echo ( Name. Items . Item . Name )      '' 特定 Script 実行 ''    End   If End   If 
Access の 帳票 フォーム は 行 ごと に プロパティ を 変更 する こと は 出来 ませ ん 。 条件 付き 書式 で なら 見た目 を いじる こと が 出来る ので 挑戦 し て み て は どうでしょう か ？ https :// support . office . com / ja - jp / article /% E 6 % 9 D % A1 % E 4 % BB % B 6 % E 4 % BB % 9. .. 
データ を 表示 する もの だ から データ の 保存 は やっぱり 既に 書か れ て いる 方法 に なる よう な 
環境変数 を 使わ ず とも 画像 ファイル の パス は System . IO . Pat h. Combine ( System . Environment . GetFolderPath ( Environment .S pecialFolder . MyPictures ), " 画像 フォルダ \ 画像 . png ") と すれ ば OK です 。 System . IO . Pat h. Combine System . Environment . GetFolderPath Environment .S pecialFolder . MyPictures の 意味 は ヘルプ を 参照 し て ください 。 
下記 の コード でいか が でしょ う か Sub b () Dim v ( 10 , 10 ) Dim i As Integer , j As Integer For i = 0 To 10 For j = 0 To 10 v ( i , j ) = Range (" F3 "). Offset ( i , j ). Value Next j Next i For i = 0 To 10 For j = 0 To 10 Range (" F3 "). Offset ( j , i ). Value = v ( i , j ) Next j Next i End Sub 
gnsgnsdrogno さん 1024 = 2 ^ 10 DFT 2 ^ 10 * 2 ^ 10 = 2 ^ 20 = 100 万 FFT 10 * 2 ^ 10 = 1 万 ??? 
Sheets (" sheet 1 "). Range (" A 4 : K 4 "). Copy _ Sheets (" sheet 12 "). Cells ( Rows . Count , 1 ). End ( xlUp ). Offset ( 1 ) ↓ ↓ ↓ Sheets (" sheet 1 "). Range (" A 4 : K 4 "). Copy _ Sheets (" sheet 12 "). Cells ( Rows . Count , 2 ). End ( xlUp ). Offset ( 1 ) 
質問 の プログラム は 、 標準 モジュール から ユーザー フォーム の ListBox 1 を 設定 し てる よう です が 、 以下 は ユーザー フォーム 内 の VBA です 。 あらかじめ ListBox 1 を 用意 し て ください 。 ' ユーザー フォーム 初期化 時 Private Sub UserForm _ Initialize () Dim ws As Worksheet Dim rng As Range Dim adr As String For Each ws In Sheets ' 全て の シート を 調べる If ws . Name <> " Sheet 1 " Then ' 注目 シート 名が " Sheet 1 " で なかっ たら Set rng = ws . Cells . Find ( What :=" 田中 ") ' 注目 シート で " 田中 " を 探す If Not rng Is Nothing Then ' 1 個 でも あっ たら adr = rng . Address ' 見つけ た 場所 を 記憶 ( 終了 チェック 用 ) Do ListBox 1 . AddItem ws . Name ' ListBox に 見つけ た シート 名 を 追加 ListBox 1 . List ( ListBox 1 . ListCount - 1 , 1 ) = rng . Address ' 上 で 追加 し た行 の 2 列 目 に 見つけ た セル を 記憶 Set rng = ws . Cells . FindNext ( rng ) ' 次 を 探す Loop Until rng . Address = adr ' 見つけ た アドレス が 最初 の アドレス なら 終わり End If End If Next End Sub ' ListBox が クリック さ れ た 時 Private Sub ListBox 1 _ Click () Sheets ( ListBox 1 . List ( ListBox 1 . ListIndex )). Select ' Sheet 選択 Range ( ListBox 1 . List ( ListBox 1 . ListIndex , 1 )). Select ' Range 選択 ' Unload Me ' ユーザー フォーム を 閉じる ( 必要 なら ) End Sub 
こんな でしょ う か 。 Sub 連続 印刷 () Dim c As Integer Dim lastColumn As Integer Worksheets (" 印刷 "). Select With Worksheets (" 台帳 ") lastColumn = . Cells ( 1 , Columns . Count ). End ( xlToLeft ). Column '" 台帳 " シート の 1 行 目 最終 列 For c = 3 To LastRow ' 注目 列 を 3 列 目 ( C 列 ) から 最終 列 まで Range (" E 1 "). Value = . Cells ( 1 , c ). Value '" 印刷 " シート の E 1 に " 台帳 " シート の 1 行 目 注目 列 の 値 を セット ActiveSheet . PrintOut '" 印刷 " シート 印刷 Next End With End Sub 
以下 の コード でいか が でしょ う か ？ Private Sub CommandButton 7 _ Click () Dim t mp3 As Variant If TextBox 17 . Text = "" Then t mp3 = Date Else t mp3 = TextBox 17 . Text End If TextBox 17 . Value = DateAdd (" d ", 1 , t mp3 ) & vbCrLf End Sub 
提示 さ れ た コード の 範囲 内 で は Excel 2016 で 動か ない 原因 は ありません し フォント の 相違 も 関係 あり ませ ん 。 他 の コード の 部分 、 または ActiveSheet が 違う シート に なっ て いる 、 という こと は あり ませ ん か ？ 
Private Sub UserForm _ Initialize () Me . TextBox 1 . Text = Sheet 1 . Range (" A1 "). Text End Sub で は うまく いか ない の です か ？ 
> COUNTIF の 答え が 2 に なっ て いる の が 、 原因 か な と 思う の です が 、 その 原因 が わかり ませ ん 。 原因 を 確認 し たい なら 以下 の 式 を 入力 し て 下 方向 に オート フィル し て ください 。 = COUNTIF ($ A $2 :$ A $350 00 , C 2 ) 添付 の 写真 の よう に 、 どちら に も ある のに 、 消え た ！ 新しい ！ と 言わ れ て 困惑 し て ます 。 この 場合 は 、 それら の セル が 同じ データ で ない こと を 示し て い ます 。 以下 の 数式 を 入力 し て 「 FALSE 」 が 返る こと を 確認 し て 、 その 違い を 調べ て ください 。 ＝ A 列 の セル ＝ C 列 の セル ＞ あと処理 時間 が 凄く かかり ます 。 他 に いい 方法 が あれ ば ご 教授 いただき たく 。 COUNTIF 系 の 関数 を 何 万 行 に 及ぶ 多数 の セル に 入力 する と 、 計算 に 時間 が かかる の は やむを得ない の です が 、 それ より も 重要 な こと は 、 この よう な 数式 を 多数 入力 する と 大量 の メモリー を 消費 する ので 、 場合 によって は エクセル が フリーズ する 可能性 が あり ます 。 目的 に も より ます が 、 この 数式 で 出 て き た 結果 を 利用 し て 特定 の 集計 を し たい ため に この よう な 数式 を 使用 し て いる なら 、 配列 数式 を 使用 する （ 計算 速度 は 基本的 に 変わり ませ ん が 、 エクセル が フリーズ する こと は なく なる ） 、 あるいは 計算 済み の セル は 一番 上 の セル を 残し て 、 それ 以外 の セル は 値 に 変換 し て おく など の 運用 が お勧め です （ 数式 が 必要 に なっ た 時 は 数式 セル の 右 下 を ダブルクリック する ） 。 
こんにちは。 テスト で は 、 最初 に 、 「 直接 文字列 を 設定 する 」 続い て 、 文字列 を エクセル の 文字列 に し て みる という 順番 に テスト と ます そう で ない と 、 なに が 原因 か 、 わかり ませ ん 。 コード を み て 、 Range (& quot ; D3 3 & quot ;) は Range (& quot ; D3 3 & quot ;). value に なっ て ほしい 、 という の は あり ます が 、 何 が 起こっ て いる の か 、 まずは 確認 し て ください 
> mies 197803 さん 2016 / 6 / 110 : 43 : 29 > どの よう に すれ ば 良い の か 分から ない ので 、 お 教え いただけれ ば と 存じ ます 。 FTP で 接続し 落とせ ば いい と 思い ます 。 
漢字 から ひらがな へ の 変換 が どんな 事例 を 見つけ られ た の か わかり ませ ん が よう は 《 決まっ た 単語 》 へ の 変換 な の か 《 不 特定 の 単語 》 の 変換 な の か で 変わら ない か な ？ 決まっ た 単語 なら 変換 さ せる 一覧 表 を 事前 に 作成 すれ ば 出来 そう だ けど 、 不 特定 なら そもそも 《 どの 漢字 を あてる の か ？ 》 が わ から ないじゃないですか ？ 実際 変換 さ せ て 文章 を 作成 する 際 に 候補 が 複数 あり ます し ね 
パターン "\ b (\ d ( 月 | 日 ))" 追加 re . Global = True 置換 の ２ 番目 " 0 $1 " か な ？ 
WsName = Left ( ts . Range (" D2 "). Value , 31 ) を if i = 1 Then ws . Name = Left ( ts . Range (" D2 "). Value , 31 ) Else ws . Name = Left ( ts . Range (" D2 "). Value , 31 ) & "（" & i & "）” End If として み て ください 。 2 枚 目 の シート 以降 も エラー は 出 なく なる と 思い ます 。 
【 式 1 】 K 8 = N ( J 8 =" 西田 C ") ★ 下 に コピー 【 式 2 】 L 8 = COUNTIF ( J 8 ,"* 西田 C *") または 、 L 8 = COUNT ( FIND (" 西田 C ", J 8 )) ★ 下 に コピー 
エラー を 表示 さ せ ない だけ なら 、 Sub の 後 に On Error Resume Next を 書け ば 、 エラー が 出て も そのまま 次 の ステップ に 進ん で くれ ます 。 普通な ら 、 Dir 関数 とか で 対象 の ファイル を チェック し て から 開い た ほう が よろしい か と 思い ます が ・ ・ サンプル （ ディレクトリ の 指定 は し て い ませ ん ） Dim Filename As String Filename = Dir (" Workbook *. xlsx ") Do Until Filename = "" Workbook . Open Filename Filename = Dir () Loop 
> myTemp = " C :\" & ThisWorkbook . Worksheets (" 御 見積 "). Range (" G7 ") & "_" & ". xlt " セキュリティ が 厳しく なっ て 、 C ドライブ 配下 に 出力 する と エラー の 原因 と なり やすい です 。 出力 先 を 、 My Documents など の ドキュメント 保存 用 フォルダ に 変更 し て み て 下さい 。 
一 例 です 。 Sub sample () Dim Target , rng As Range , i As Long , ii As Long With Worksheets (" 機種 別 "). Range (" K 1 : K5 ") ii = Application . CountA (. Cells ) If ii > 0 Then ReDim Target ( 1 To ii ) For Each rng In . Cells If rng . Value <> "" Then i = i + 1 Target ( i ) = rng . Value End If Next rng Worksheets (" 一覧 表 "). Range (" A3 "). Current Region . AutoFilter Field := 3 , _ Criteria 1 := Target , _ Operator := xlFilterValues End If End With End Sub 
① その システム は yonnkaku . png という 画像 ファイル を 使っ て いる ので 、 その 画像 ファイル を 入手 し ます 。 ② あなた の ＰＣ の デスクトップ に 「 rogozukei 」 という フォルダ を 作成 し ます 。 ③ 入手 し た 画像 ファイル を ② で 作成 し た 「 rogozukei 」 フォルダ に 入れ ます 。 ④ 再度 システム を 動かし て も 同じ エラー が 出る 場合 は 、 その システム の ソースコード に 「 C :\ Users \( その 方 の PC の アカウント 名 )」 と 書か れ た 部分 が ある はず です ので 、 その 部分 を 「 C :\ Users \( あなた の PC の アカウント 名 )」 に 修正 し て 再 コンパイル し て み て 下さい 。 
train _ benoist さん へ の 回答 リクエスト は 拝見 し まし た 。 そもそも columns ( 1 ), 0 の 意味 も わから ず 変え て も 結果 に 繋がる わけ も なく 。 columns ( 1 ) は A 列 を 検索 0 は 完全 一致 の ため の 引数 MATCH 関数 の 引数 で しか ない です 。 （ って 回答 リクエスト に も 説明 し て あっ た こと を 噛み砕い た だけ です けど ね ） その 結果 を . Cells ( i , 2 ). Value と 表現 し て い ます 。 ヒット し た行 の 2 列 目 ＝ B 列 、 に は = Range (" B4 "). Value 、 B4 の 値 を 入れる 。 そういう コード です よ 。 行 を 変える なら この ２ を ３ に し たら C 列 に なり ます 。 
For ～ Next の 使い方 に 誤り が あり ます 。 ( ロジック ミス です ・ ・ ・ 。) これ で は 、 r が 1 の 時 に i が 1 ～ 8 まで 回っ て r が 2 の 時 に i が 1 ～ 8 まで 回っ て ・ ・ ・ ・ と なっ て い ます よ ね 。 この よう な 処理 を 行う 時 は 、 Selection . Cut で は なく Selection . Copy を 使用 し て 最後 に データ を クリア する よう に すれ ば カット し た行 を 考え なく て も 済む の で は ない か と 思い ます 。 で あれ ば 、 > 次に >「 ２ 」 行 目 を 移動 先 の 「 ９ 行 目 」 と 移し て いき たい と 考え て い ます 。 も 簡単 に 考え られ ます よ ね ・ ・ ・ 。 
以下 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim bkNames As Variant , bkName As Variant Dim bk As Workbook , sh As Worksheet ' ブック を 選択 する （ 複数 可 ） bkNames = Application . GetOpenFilename ( FileFilter :=" Microsoft Excel ブック ,*. xls ?", MultiSelect := True ) ' キャンセル さ れ たら 終了 If VarType ( bkNames ) = vbBoolean Then Exit Sub ' 画面 更新 停止 Application .S creenUpdating = False ' 選択 さ れ た ブック すべて について 処理 を 行う For Each bkName In bkNames ' ブック を 開く Set bk = Workbooks . Open ( bkName ) ' 開い た ブック の すべて の シート について 処理 を 行う For Each sh In bk . Worksheets ' シート 名 に A が 含ま れ て いる とき If sh . Name Like "* A *" Then ' AY 1 に 1 を 設定 する sh . Range (" AY 1 "). Value = 1 ' シート 名 に B が 含ま れ て いる とき ElseIf sh . Name Like "* B *" Then ' AY 1 に 2 を 設定 する sh . Range (" AY 1 "). Value = 2 ' シート 名 に C が 含ま れ て いる とき ElseIf sh . Name Like "* C *" Then ' AY 1 に 3 を 設定 する sh . Range (" AY 1 "). Value = 3 ' シート 名 に D が 含ま れ て いる とき ElseIf sh . Name Like "* D *" Then ' AY 1 に 4 を 設定 する sh . Range (" AY 1 "). Value = 4 End If Next ' ブック を 閉じる （ 更新 さ れ て い たら 上書き保存 する ） bk . Close True Next ' 画面 更新 再開 Application .S creenUpdating = True End Sub 
w b2 . Worhsheets ( 1 ) は w b2 . Worksheets ( 1 ) の パンチ ミス です か ？ 
Loop の 前 の fname = Dir は fname = Dir () で は ？ この VBA を 実行 する ブック は 、 開こ う と するする ブック と 同一 フォルダ 内 に ある という こと で 良い です ね 。 この コード だ と 開こ う と する ブック は 、 すべて Xlsm で は ない と 駄目 です 。 OK です か ？ fname = ThisWorkbook . Path & "\*. xlsm ?" は 拡張子 xlsm の 後ろ に 何 か 文字 が 入っ て いる 場合 に は 有効 です が 、 それ は 無い です よ ね ？ fname = ThisWorkbook . Path & "\*. xls ?" で 良い の で は 。 これ だ と 、 xls も xlsx も xlsm も 対象 に し て くれ ます 。 
.S aveAs ( xPath & xName & ". csv ") を .S aveAs ( xPath & xName & ". csv ", xlCSV ) と し て 下さい 。 なお CSV 形式 で 保存 さ れ た ファイル は テキストファイル です 。 試しに メモ帳 で 開い て み て 下さい 。 
これ で は 、 1 行 しか 処理 さ れ ない でしょ う 。 For I = 1 To MaxRow は 、 空回り する だけ 。 何 も 処理 さ れ ない です 。 コピー する か し ない か の 判定 ( 1 だっ たら コピー ) まで 、 Sheet 3 に コピー し て いる の も 分から ない です が ？ Sub Sample () Dim I As Long , J As Long Sheets (" Sheet 1 "). Activate J = 8 With Sheets (" Sheet 3 ") . Cells . ClearContents For I = 2 To Cells ( Rows . Count , 2 ). End ( xlUp ). Row If Cells ( I , 1 ) = 1 Then J = J + 1 . Range (. Cells ( J , 1 ), . Cells ( J , 3 )). Value = _ Range ( Cells ( I , 1 ), Cells ( I , 3 )). Value . Cells ( J , 8 ) = Cells ( I , 4 ) End If Next I End With End Sub こんなん で 良い ん です か ね ？ Option Explicit の 宣言 を し て ない よう す が ？ VBA を 勉強 し たい の なら 、 まず ここ から です ね 。 http:// office tanaka .net / excel / vba / beginner / 11 . htm 
下記 の コード を Sheet 1 の シート モジュール に コピペ し て 下さい 。 それで A1 または A 2 を 変更 する だけ で 画像 が 表示 さ れる よう に なり ます 。 Option Explicit Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim rng As Range For Each rng In Target . Cells If rng . Column = 1 Then Select Case rng . Row Case 1 : SetPicture rng , Worksheets (" Sheet 2 ") Case 2 : SetPicture rng , Worksheets (" Sheet 3 ") End Select End If Next rng End Sub Private Sub SetPicture ( srcRng As Range , dstSheet As Worksheet ) Const FOLDER As String = " C :\" Dim pic , fName As String Dim shp As Shape ' 既存 の 画像 を 消去 する For Each pic In dstSheet . Pictures pic . Delete Next ' 画像 ファイル を 検索 する fName = Dir ( FOLDER & srcRng . Value & ". png ") ' 画像 ファイル が 見つから なけれ ば 画像 ファイル を " C :\ 0 . png " と する If fName = "" Then fName = FOLDER & " 0 . png " Else fName = FOLDER & fName End If ' B 1 に 画像 ファイル を 挿入 する Set shp = Nothing On Error Resume Next Set shp = dstSheet .S hapes . AddPicture ( _ Filename := fName , LinkToFile := msoFalse , _ SaveWithDocument := msoTrue , _ Left := dstSheet . Range (" B 1 "). Left , _ Top := dstSheet . Range (" B 1 "). Top , _ Width := 0 , Height := 0 ) If Not shp Is Nothing Then shp .S caleHeight 1 , msoTrue shp .S caleWidth 1 , msoTrue End If End Sub 
また 投稿 さ れ て い ます ね 。 調べ て み て い た ん です が 。 な さ そう です ね 。 自分 で 作る 方 が 早い か なぁ 。 
別 ファイル の 顧客情報 と あり ます が 基準 と なる もの が 不明 な ので シート の 種類 と 内容 、 主 と なる ワークブック が どれ な の か など シート の 構成 を もう少し 詳しく 教え て ください 。 顧客情報 ( ファイル A ） に は 顧客 名 それぞれ の シート が ある の でしょ う か ？ また 顧客情報 ( ファイル A ） と は 別 の ファイル に なる の でしょ う か 。 
> If 文 で 「 空欄 なら 」 は If R . Value = "" Then >「 移動 し て 空欄 なら 」 で は なく 、 「 ひとつ 下 の セル が 空白 なら 」 です If R . Offset ( 1 ). Value = "" Then Set R = R . End ( xlDown ). Offset ( 1 ) の 行 は こんな ふう に し たら どうでしょう か 。 If R . Value = "" Then ' R が 空欄 なら 移動 し ない ElseIf R . Offset ( 1 ). Value = "" Then ' R の １つ 下 の セル が 空白 なら 、 １つ 下 の セル に 移動 Set R = R . Offset ( 1 ) Else ' それ 以外 なら 最終 行 の 次 の 行 に 移動 Set R = R . End ( xlDown ). Offset ( 1 ) End If 
提示 さ れ た コード は Do ループ の 終わり が あり ませ ん し 、 あまりに も 中途半端 です 。 ダイアログ で 選択 し た ファイル を buf という 配列 に 読み込ん で 、 それ を dd という 配列 に 、 16 進数 表記 の 文字列 に 変換 し て セット し て いる ところ まで は 理解 でき ます が 、 それ を もと に 「 何 が し たい の か 」 が まったく 判り ませ ん 。 上司 の 方 は 何 を 目的 として マクロ を 組ん で いる の でしょ う か ？ 
Label は 配列 に す べき です が 、 とりあえず 、 x1 ～ x5 を 配列 に し て み まし た 。 Randomize () Dim xs ( 5 ) As Integer Dim duplicate As Boolean = False For i As Integer = 0 To 4 Do duplicate = False x = Int ( Rnd () * n 0 ) For j As Integer = 0 To i - 1 If x = xs ( i ) Then duplicate = True Exit For End If Next j Loop While duplicate = True Or sd ( x ). s4 = " 済 " Or sd ( x ). s1 = "" xs ( i ) = x Next i Label 1 . Text = sd ( xs ( 0 )). s1 Label 2 . Text = sd ( xs ( 1 )). s1 Label 3 . Text = sd ( xs ( 2 )). s1 Label 4 . Text = sd ( xs ( 3 )). s1 Label 5 . Text = sd ( xs ( 4 )). s1 
試し て い ませ ん が 、 If lst 物件 . Text = "" Then を If lst 物件 .S electedIndex = - 1 Then として み て ください 。 
一 例 です 。 Private Sub CommandButton 1 _ Click () Dim i As Integer With UserForm 1 If Len (. TextBox 1 . Value ) > 4 Then MsgBox " 5 ケタ に なっ て い ます 。 " Exit Sub End If For i = 1 To 4 . Controls (" TextBox " & ( i + 1 )) = Mid (. TextBox 1 , i , 1 ) Next i End With End Sub 
ActiveWorkbook .S heets (" 山 "). Copy after := Workbooks . Add .S heets ( 1 ) って おかしい です よ ね 。 Dim wb as workbook set wb = workbooks . add を 追加 し て おい て 、 ActiveWorkbook .S heets (" 山 "). Copy after := wb .S heets ( 1 ) で どうでしょう 。 
外部 データ の 取り込み を 使っ て み て は いかが でしょ う か ？ 頭 の ゼロ が 消え て 困る フィールド や 長い 数字 は 文字列 として 取り込み ます 。 
> opencv 2 で 使用 し て 「 使用 し て 」 って どういう こと ? > 主 に ソース ファイル が 開け ませ ん 正確 に その 通り な の です か ? > opencv と opencv 2 で の 表記 の 仕方 が 変わっ た から 質問 の 内容 から では 判断 し かね ます 。 多分 その 情報 から で は 誰 に も わから ない でしょ う 。 やっ た こと は 、 理想 として は 回答者 が まるまる 同じ こと を 再現 できる くらい に 詳しく 。 起こっ た こと は 、 理想 として は 全く 省略 なく そのまま。 質問 に 書い て 下さい 。 
※ １ は インスタンス なし で メソッド を 呼び だそ う と し て いる ので 当然 エラー です ね 。 それから Rena me クラス について 、 はっきり 言っ て この クラス の 存在意義 が 分かり ませ ん 。 単に クラス の 中 から 他 の クラス を 利用 する 例 として 述べ られ た だけ な の か 、 それとも 本当に Rename の 機能 を 実装 さ れよ う と し て いる の か 。 もし 後者 で あれ ば Rename クラス を 別に 作る 必要性 は 全く あり ませ ん 。 Project クラス 内 に Rename メソッド を 作れ ば いい だけ の 話 です 。 クラス 内 の フィールド 操作 は 外部 から 直接 する の で は なく 、 その クラス 自身 に さ せる よう に する の が オブジェクト指向 の 基本 指針 です 。 Text プロパティ について 言え ば 、 これ は 既に プロパティ として 外部 に 公開 さ れ て いる ので Rename メソッド を 作ら なく て も 外部 から 直接 Text プロパティ を 操作 する こと は でき ます 。 しかし いずれ の 場合 でも Project の インスタンス の 参照 が 必要 です 。 そもそも この Project クラス を 利用 する クラス は 何 か という 問題 が あり ます ね 。 Project クラス の インスタンス は 当然 それ を 利用 する 側 （ 作成 し た クラス ） が 管理 する べき もの です 。 この プログラム で は Project クラス の 中 に Main メソッド が ある ので 、 自分自身 で 自分 を 作成 し て い ます よ ね 。 Project インスタンス は １つ しか ない という こと です か ？ だとすれば Project インスタンス を static メンバ に 保存 し て 、 class Project : Form { public static Project me ; static void Main () { Application . Run ( me = new Project ()); } } class Rename { public Rename () { Project . me. Text = "（ リネーム 後 の タイトル ）"; } } と すれ ば 他 の クラス から 自由 に アクセス でき ます よ 。 
コネクション ストリング で は 、 データベース ファイル を 指定 する の で は なく 、 SQLSERVER を 指定 し ます 。 アプリケーション は は SQL 文 を サーバー に おくり ます 。 SQL の 実際 の 実行 は サーバー に やっ て もらい ます 。 です から 、 SQL サーバー の 指定 は 必要 です 。 SQL サーバー が データベース ファイル の 場所 を 把握 し て いる ので 、 データベース ファイル の 場所 を アプリケーション で 設定 する 必要 は あり ませ ん 。 
Sub Print _ Out _ 1 () ' セル に 値 を 設定 し ながら 印刷 する ' 定数 Const conStart As Long = 1 ' 開始 番号 Const conEnd As Long = 40 ' 終了 番号 Const conStep As Long = 1 ' 間隔 Const conCell As String = " B2 " ' セル 番地 ' 変数 Dim lngI As Long ↓ ↓ ↓ Sub Print _ Out _ 1 () ' セル に 値 を 設定 し ながら 印刷 する ' 定数 Const conStep As Long = 1 ' 間隔 Const conCell As String = " B2 " ' セル 番地 ' 変数 Dim lngI As Long Dim conStart As Long ' 開始 番号 Dim conEnd As Long ' 終了 番号 With Worksheets (" 印刷 シート ") conStart = . Range (" R1 4 "). Value conEnd = . Range (" S14 "). Value End With 
この コード で 減算 、 乗算 、 除算 の 連続 演算 出来 て いる と は 思え ませ ん 。 VB で の 「 +」 は 数値 の 加算 の ほか に 文字列 の 連結 を 行う 機能 も 持っ て い ます 。 です から TextBox 1 . Text = X + TextBox 1 . Text と する と 文字列 の 連結 の 意味 に なっ て しまい 、 「 6 + 5 + 8 」 は 「 658 」 に なっ て しまい ます 。 それ を 防ぐ ため に は 加算 する 各 項目 を 数値 に 直し て から + する 必要 が あり ます 。 TextBox 1 . Text = Val ( X ) + Val ( TextBox 1 . Text ) とすれば 連続 加算 に なる と 思い ます 。 
異なる イベント を １つ の イベント プロシージャ で 処理 する 事 は でき ませ ん 。 素直 に 「 処理 A 」 を サブ プロシージャ や 関数 に し て 下さい 。 
こんにちは。 リスト な ん です よ ね 、 adoRs . Open strSQL , adoCn ' SQL を 実行 し て 対象 を RecordSet へ while not adoRs . eof With ComboBox 1 . additem adoRs . fields ( 0 ). value End With adoRs . movenext wend adoRs . close という よう に なり ます 。 
並べ替え は 並べ替え （ ソート ） で 行う しか あり ませ ん 。 並べ 替え て から フィルター し て ください 。 
数式 で やる 範囲 を 超え て いる よう に 思い ます ので 、 下記 を 読ん で 検討 し て 下さい 。 これ は シート Ｂ の C3 の 式 です 。 = IF ( LEFT ( INDEX ( シート Ａ !$ C $5 :$ G $24 ,( MOD ( ROW ()+ 2 , 5 ))* 4 + COLUMN ()- 2 , INT (( ROW ()+ 2 )/ 5 )), 1 )=" A ", INDEX ( シート Ａ !$ A $5 :$ A $24 ,( MOD ( ROW ()+ 2 , 5 ))* 4 + COLUMN ()- 2 ,)& RIGHT ( INDEX ( シート Ａ !$ C $5 :$ G $24 ,( MOD ( ROW ()+ 2 , 5 ))* 4 + COLUMN ()- 2 , INT (( ROW ()+ 2 )/ 5 )), 2 ),"") ここ で 実現 でき て いる の は 、 パート A の 人で O の 人 まで です 。 勤務 は A か B で 数字 は 2 桁 限定 です 。 式 を コピー する と 、 P の 人 まで 入っ て しまい ます 。 P から T だけ 特別 に 右端 の 列 に する 事 は 出来 て い ませ ん 。 上記 実現 でき て い ない 事 を 更に 追加 する と 、 とてつもなく 長い 式 に なり ます 。 回答 の 欄 で 2 行 以上 に なる よう な 長い 式 は 理解 が 大変 だ し メンテナンス も 出来 ない と 思い ます 。 入力 方法 を 変更 でき ない の で あれ ば 、 VBA に し た 方 が いい と 思い ます 。 
> その あと 、 動い て くれ ませ ん 。 どこ で 、 どういう 風 に 「 動か ない 」 の か 症状 を 書か ない と 、 アドバイス しよ う が ない の は 、 お 解り に なり ます よ ね ？ とりあえず 、 以下 の 修正 は 、 必要 と 思い ます 。 t = WorksheetFunction .S um ( Range ( Range (" A5 "). End ( xlToRight ). Column , Range (" A5 "). End ( xlDown )) ↓ t = WorksheetFunction .S um ( Range ( Range (" A5 "). End ( xlToRight ), Range (" A5 "). End ( xlDown ))) 
> Q 1 . Label 1 . text など に 値 を 格納 する とき 、 Label 1 . text = null 、 nothing 、 " 空欄 " の それぞれ の 違い は なん でしょ う か ？ null , nothing は 使い ませ ん ね 。 Label 1 . text = null だ と エラー に なり ます 。 （ 主 に DB で 使用 ） nothing は オブジェクト 変数 に 使う 物 です 。 Label 1 . text = nothing で も エラー に は なり ませ ん 。 通常 は 、 Label 1 . text ="" か Label 1 . text = String . Empty を 使い ます 。 > Q2 .｢ And ｣｢&｣｢ AndAlso ｣ の 具体 的 な 違い は なん でしょ う か ？ また 、 これら の 使い分け は どう いっ た もの でしょ う か ？ If A = 1 And B = 2 And C = 3 Then と 、 If 文 など で 複数 の And 条件 が 有る 場合 ・ ・ And だ と 、 最初 の 「 A = 1 」 で 結果 が False に なっ て も 、 ２つ め 、 ３つ め を 評価 し に いき ます 。 If A = 1 AndAlso B = 2 AndAlso C = 3 Then に する と 、 最初 の 「 A = 1 」 で 結果 が False に なっ た 場合 、 残り の 評価 は 無駄 な ので 行い ませ ん 。 （ ３つ とも True に なる こと は 無い ので ・ ・ ） 条件 が 多く 有る 場合 、 この よう に 書く と 処理 が 少し 早く なり ます 。 同じ よう に 、 Or の 場合 は 、 OrElse が 有り ます 。 
Thread . Sleep で は なく 、 Timer を 使う の が よい か と 。 https :// msdn . microsoft . com / ja - jp / library / 3 tszykws ( v = vs . 110 ). aspx 
下記 の コード は 「 Sample 」 という マクロ を Sheet 2 に コピー する コード です 。 ただし 下記 の コード を 実行 する 前 に [ Microsoft Visual Basic for Application s Extensibility ] を 参照 設定 し て おく 必要 が あり ます 。 Sub CodeCopy () Dim procName As String , procStart As Long , procCount As Long Dim lines As String , i As Long procName = " Sample " With Application . VBE . ActiveVBProject With . VBComponents (" Sheet 1 "). CodeModule On Error Resume Next procStart = . ProcStartLine ( procName , vbext _ pk _ Proc ) On Error GoTo 0 If procStart = 0 Then MsgBox " 指定 さ れ た 名前 の マクロ が 見つかり ませ ん 。 " Exit Sub End If procCount = . ProcCountLines ( procName , vbext _ pk _ Proc ) lines = . lines ( procStart , procCount ) End With With . VBComponents (" Sheet 2 "). CodeModule . AddFromString ( lines ) End With End With End Sub 
A1 : D2 の 入力 規則 を 「 すべて の 値 」 に すれ ば 削除 できる と 思う の です が ？ 
下記 の コード でいか が でしょ う か 。 Private Sub Command Bu t to n4 _ Click () Frame 7 . Visible = getSt () End Sub Private Sub CommandButton 5 _ Click () Frame 8 . Visible = getSt () End Sub Private Function getSt () As Boolean Static st As Boolean st = Not st getSt = st End Function ただし Frame の Visible を 切り替える だけ なら 下記 で 出来 ます 。 Private Sub Command Bu t to n4 _ Click () Frame 7 . Visible = Not Frame 7 . Visible End Sub Private Sub CommandButton 5 _ Click () Frame 8 . Visible = Not Frame 8 . Visible End Sub 
下記 の コード でいか が でしょ う か ？ Option Explicit Sub Sample () Dim i As Long , buf As String Dim NM As String , r As Long Const Path As String = " C :\ Users \ AA \ Desktop \ A フォルダ \" r = 3 i = 3 Do While Range (" B " & r ). Value <> "" NM = Range (" C " & r ). Value buf = Dir ( Path & "*" & NM & "*.*") Do While buf <> "" Range (" F " & i ). Value = buf i = i + 1 buf = Dir () Loop r = r + 1 Loop End Sub 
接続 文字列 が Windows 認証 を 指定 し ます ね 。 Integrated Security = False と username , password を 指定 し ない と SQL 認証 に なり ませ ん 。 SQL 認証 を 有効 に する か どう か は サーバー レベル の 設定 です 。 混合 モード に 設定 し て いる の なら 、 その サーバー で 作ら れ た データベース は SQL 認証 「 も 」 使う こと が でき ます 。 SQL ユーザー は 作りました か ？ その SQL ユーザー に 適切 な 権限 を 与え まし た か ？ 確認 し て ください 。 SSMS は 接続 する とき の ダイアログ で Windows 認証 か SQL 認証 か を 選ぶ ドロップダウンリスト が ある はず です 。 SQL 認証 を 選ん で 、 SQL ユーザー の ユーザー 名 と パスワード を 入力 すれ ば SQL ユーザー で ログオン でき ます 。 
。 。 。 。 。 。 。 。 。 。 。 。 。 。 
それ を 開発 する の が プログラミング だろ ？ PDF の どこ に 情報 が ある の か 、 データ を 解析 する の も プログラミング に 必要 だ よ 。 ツール とか じゃなくて 、 データ の 仕組み を 調べ て よ 。 
アプリケーション 部 で の やり取り に関して は 分かり ませ ん けど 、 通信 処理 を 作り たい の で あれ ば 基本 的 な 事 を 書き ます 。 ・ 二 台 の PC による 通信 を テスト し たい の で あれ ば 、 まず IPアドレス 指定 で 普通 に パケット が 通る こと を 確認 → ping で も 何 でも 良い です 。 双方 の PC を 同一 ネットワークアドレス に 手動 で 設定 。 ゲートウェイ は お互い 対抗 する PC の アドレス で も 設定 し て おけ ば OK な はず 。 直結 なら クロスケーブル で 、 ハブ 経由 なら ストレートケーブル で 接続 。 ・ 受信 側 で パケット キャプチャ 起動 （ 例 ワイヤー シャーク 等 にて ） 。 そして 送信 アプリケーション を 動作 さ せ 、 きちんと キャプチャ できる か 確認 。 → キャプチャ さ れ て いる が 受信 処理 が 動か ない 場合 、 キャプチャ ログ が 意図 通り の 信号 内容 に なっ て いる か 確認 。 → キャプチャ さ れ ない 場合 、 受信 PC に パケット は 届い て い ない 。 ・ 受信 側 に キャプチャ さ れ て い なけれ ば 、 送信 側 PC に パケット キャプチャ を 掛けて 送信 側 アプリ を 起動 。 → キャプチャ さ れ て いる 場合 、 生成 さ れ た パケット に 何らかの 問題 が ある と 思わ れる ので 、 ログ を チェック 。 届か ない 要因 は UDP / IP 以下 の 階層 に 原因 が ある はず だ が 、 ソケット 制御 を カーネル に 任せ て いる 場合 は この 問題 は まず 発生 し ない と 思わ れる （ PING 等 が 通っ て いれ ば 、 の 話 ） 。 ROW ソケット 等 で 下層 プロトコル から 手動 生成 し て いる の で あれ ば 、 間違っ て いる 可能性 あり 。 → キャプチャ さ れ て い ない 場合 、 送信 側 アプリ が そもそも 正常 な ソケット 通信 に 失敗 し て いる と 思わ れる 。 もし ループ バック （ 送信 側 ） アドレス 指定 で キャプチャ できる の で あれ ば 、 その ログ から 問題 を 探す 。 キャプチャ でか ない の で あれ ば 、 送信 アプリ の ソケット 通信 手順 が 本当に 合っ て いる か 、 机上 で 確認 。 こんな 感じ です か ね 。 パケット 開通 の 有無 は アプリ レベル で 確認 する の で は なく 、 キャプチャ ログ で 下位 の プロトコル ごと 確認 する の が 、 面倒 な よう で も 結果的 に 確実 で 早い です 。 
他 の 方 の 回答 が 何故か 付い て しまい まし た が ・ ・ ・ 。 とりあえず 、 OS 、 IE の バージョン を 、 動く 方 と 動か ない 方と で 教え て ください 。 HTML の ソース が 変わる という こと は 、 ブラウザ が 影響 し て いる 可能性 が 高い と 思い ます 。 後 、 リクエスト し て いただい た から お答え し まし た が 、 もしも 最初 の 回答者 様 に 頼る の でし たら 、 その 旨 、 返信 し て ください 。 時間 の 無駄 を 省く 為 、 回答 を 取り消し ます 。 
> A 列 1 行 から 約 1000 行 に まで 単語 が 入っ て い ます 。 A 列 の 最終 行 まで に し て い ます 。 Sub sample () Dim xAry xAry = Application . Transpose ( Range (" A1 ", Cells ( Rows . Count , 1 ). End ( xlUp ))) Range (" C1 "). Value = Join ( xAry , " ") End Sub 
A 7 = INDEX ( A 4 : C 6 , SUMPRODUCT (( A1 : C3 <>"")*{ 1 ; 2 ; 3 }), SUMPRODUCT (( A1 : C3 <>"")*{ 1 , 2 , 3 })) 
私 の Excel 2010 では 貴殿 の 構文 の まま で 、 縦長 の 画像 も 横長 の 画像 も 特に 問題 なく 結合 セル の 範囲 内 に 収まり ます が 、 ただ エクセル の バージョン によって は 以前 同じ よう な 現象 が 起き た こと が あり まし た ので 、 一度 、 下記 の 構文 で 試し て み て 下さい 。 Private Sub Worksheet _ BeforeDoubleClick ( ByVal Target As Excel . Range , Cancel As Boolean ) Dim myF As Variant Dim mySp As Object Dim myAD 1 As String Dim myAD 2 As String If Application . Inter sect ( Range (" B5 , B21 , B 37 , N 5 , N2 1 , N3 7 , Z 5 , Z 21 , Z 37 , AL 5 , AL 21 , AL 37 , AX 5 , AX 21 , AX 37 "), Target ) Is Nothing Then Exit Sub Cancel = True With Application . FileDialog ( msoFileDialogFilePicker ) . Title = " 画像 の 選択 " . AllowMultiSelect = False . InitialFileName = Range (" B 3 "). Value If .S how = - 1 Then myF = .S electedItems ( 1 ) End If End With If myF = "" Then MsgBox " 画像 を 選択 し て ください 。 " Exit Sub End If For Each mySp In ActiveSheet .S hapes myAD 1 = mySp . TopLeftCell . MergeArea . Address myAD 2 = Target . Address If myAD 1 = myAD 2 Then mySp . Delete Next Set mySp = ActiveSheet .S hapes . AddPicture ( Filename := myF , LinkToFile := False , _ SaveWithDocument := True , _ Left := Target . Left , _ Top := Target . Top , _ Width := 0 , Height := 0 ) mySp .S caleHeight 1 , msoTrue mySp .S caleWidth 1 , msoTrue mySp . LockAspectRatio = msoTrue If mySp . Width / Target . Width > mySp . Height / Target . Height Then mySp . Width = Target . Width - 10 Else mySp . Height = Target . Height - 10 End If mySp . Left = Target . Left + ( Target . Width - mySp . Width ) / 2 mySp . Top = Target . Top + ( Target . Height - mySp . Height ) / 2 Set mySp = Nothing End Sub 
伝票 の フォーマット が ある の で あれ ば 、 あらかじめ 全て に ○ を 付け て おき 、 条件 に 合わせ て Delete し て いっ た ほう が 楽 かも しれ ませ ん ね 。 
参考 に どうぞ 。 ただ の 長方形 面積 の 積算 です 。 Dim result As String = "" For d As Double = 0 . 1 To 1 Step 0 . 1 Dim x , y As Double Dim sum As Double = 0 . 0 For x = 3 . 0 To 10 . 0 Step d y = 3 * x * x - 4 * x + 5 . 0 Dim xw As Double = 10 . 0 - x If xw < d Then ' 最後 の 短冊 の 幅 の 調整 sum += y * xw Else sum += y * d End If Next result += " delta =" + d . ToString (" F3 ") + ", sum =" + sum . ToString (" F3 ") + System . Environment . NewLine Next Label 1 . Text = result 
なん の マクロ な ん でしょ う か 
まる という 名前 の 単体 図形 と 、 まる という 名前 の 図形 を グループ 内 に 含ん だ 図 を 選択 する 例 です 。 Sub Test () Dim myShp As Shape , i As Long For Each myShp In ActiveSheet .S hapes If myShp . Name = " まる " Then myShp .S elect False If myShp . Type = msoGroup Then For i = 1 To myShp . GroupItems . Count If myShp . GroupItems ( i ). Name = " まる " Then myShp .S elect False Exit For End If Next End If Next End Sub 
> たとえば A = 10 と B = 20 この 「 A 」 「 B 」 は 変数 です か ？ どんな コード で エラー に なっ て い ます か ？ 単純 に TextBox 1 . Text = A & "～" & B で は だめ でしょ う か 。 
System . Diagnostics . Process .S tart で xdoc 2t xt を 呼び出し て 、 結果 は ファイル に リダイレクト し て おけ ば 、 後 は ファイル から データ を 読み込む 時 と 同様 に なり ます 。 xdoc 2t xt . exe 等 は 面倒 で あれ ば 自分 の 作っ た プログラム と 同じ 所 に 突っ込ん で おけ ば 動き ます 。 
ActiveWorkbook .S heets ( 1 ). Delete Application . DisplayAlerts = True ActiveWorkbook .S aveAs 保存 ファイル 名 , xl Normal ActiveWorkbook . Close False ↓ ActiveWorkbook .S heets ( 1 ). Delete ActiveWorkbook .S aveAs 保存 ファイル 名 , xl Normal ActiveWorkbook . Close False Application . DisplayAlerts = True を 試し て ください 。 
この 本 が 有名 です ね 。 http:// www . geocities .jp / excelgame / books / 結構 古い 本 です が 、 VBA で アクションゲーム を 作る 上 で の ノウハウ が 詰まっ て い ます ( 例えば 質問 に あっ た 待ち時間 の 処理 とか 、 ゲーム 全体 で は どの よう な ループ 処理 が 必要 な の か とか 、 キャラクター の 移動 の 際 に 発生 する 自 キャラ の 描画 と 背景 の 再 描画 を 簡略 化 する に は どう すれ ば いい か とか ....)。 ただ VBA そのもの の 解説 は 薄め な ので 、 この 本 だけ で VBA を 勉強 する に は 無理 が あり ます 。 CD が 付属 し て おり 、 その 中 に コード 閲覧 が 可能 な サンプル ゲーム が 複数 入っ て い ます 。 本 を 買う の が 嫌 なら 、 上記 サイト に ある サンプル ゲーム を ダウンロード し て コード を 見 たり 、 各 作者 の ホームページ を 見 に 行っ たり する だけ でも 勉強 に なり ます よ 。 本 に 付属 の CD に は もっと いろいろ な サンプル ゲーム が あり ます けど ね 。 それでは 。 
RIGHT や FIND は Outlook の VBA でも 使い 方 は 同じ です 。 
Phonetic を 使用 する の は 危険 だ と 思い ます 。 違う 読みで 入力 さ れ て いれ ば 、 違う カナ に なっ て しまい ます ね ・ ・ ・ 。 なお 、 この まま 使う なら その 下 に Replace 関数 を 複数 行 挿入 する 事 で 対応 出来 ます 。 tmp = Replace ( tmp ," ｬ "," ﾔ ") tmp = Replace ( tmp ," ｭ "," ﾕ ") tmp = Replace ( tmp ," ｮ "," ﾖ ") tmp = Replace ( tmp ," ｯ "," ﾂ ") 
一 例 です 。 作業 シート の C 列 に シート 名 、 D 列 に 図形 名 を 表示 し て ます 。 Sub sample () Dim rng As Range , sh As Worksheet , shp , xTxt As String Set rng = Worksheets (" 作業 "). Range (" B5 ") For Each sh In Worksheets If sh . Name Like " P ##" Then For Each shp In sh .S hapes xTxt = shp . TextFrame 2 . TextRange . Characters . Text If xTxt <> "" Then rng . Resize (, 3 ). Value = Array ( xTxt , sh . Name , shp . Name ) Set rng = rng . Offset ( 1 ) End If Next shp End If Next sh End Sub 
エラー の 内容 と エラー と なっ て いる コード を 提示 し て 下さい 。 
下 回答者 さん の 補足 です 。 rc = mciSendString (" close " & SoundFile , "", 0 , 0 ) rc = mciSendString (" open " & SoundFile , "", 0 , 0 ) rc = mciSendString (" Play " & SoundFile , "", 0 , 0 ) を 入れる 前 に 必ず rc = mciSendString (" stop " & SoundFile , "", 0 , 0 ) を 入れ て ください 。 （ つまり 、 CLOSE する 前 に 再生 中 の 音声 を 停止 する という 意味 ） CLOSE は あくまで 再生 中 の 音声 の 読み取り を 終了 する という 意味 で 、 再生 し て いる 音声 を 停止 する もの で は あり ませ ん 。 CLOSE を 送っ た 時 、 既に バッファ に すべて の 音声 が 読み込ま れ て い たら 、 当然 最後 まで 音声 が 流れ ます 。 音声 停止 は 明示 的 に 指示 する 必要 が あり ます 。 通常 、 MCI を 使う 場合 は NOTIFY で 終了 時 に コールバック ハンドル を 送り ます が 、 それ が 出来る の は VC など の 機械語 レベル 。 あと 、 根本 的 に MCI の 使い方 が 間違っ て い ます 。 mciSendString を 省き ます が 、 MCI コマンド で 書く と こう なり ます 。 OPEN C :\ Users \ Home \ OneDrive \ H2 8 \ あいさつ . mp3 alias aisatsu PLAY aisatsu 再生 停止 の 場合 は STOP aisatsu CLOSE aisatsu MCI を 使う 場合 は 、 必ず OPEN で ファイル 名 に対する ALIAS 名 を 割り当て 、 それ 以降 の ファイル ハンドル は ALIAS で 割り当て た 名前 を 使い ます 。 
以下 で どう なり ます か その シート に 以下 を 記述 し て 確認 し て み ます Private Sub Worksheet _ Change ( ByVal Target As Range )     Dim rng As Range     Dim i As Long , j As Long     Dim bV As Boolean     Const CRNG As String = " E 8 , G8 , I 8 , K 8 "     Set rng = Range ( CRNG )     Set Target = Inter sect ( Target , rng )     If ( Target Is Nothing ) Then Exit Sub     For i = 1 To rng . Areas . Count        If ( Not Inter sect ( Target , rng . Areas ( i )) Is Nothing ) Then           bV = rng . Areas ( i ). Value = ""           j = ( i + 1 ) * 10           Rows ( j ). Resize ( 10 ). Hidden = bV           j = i + 3           Worksheets (" Sheet 2 "). Rows ( j ). Hidden = bV        End If     Next End Sub ' 確認 用 簡易 データ 作成 標準 モジュール で Public Sub testData ()     Dim r As Range     Const CRNG As String = " C 8 , E 8 , G8 , I 8 , K 8 "     Const CRH As Long = 60     With Worksheets (" Sheet 1 ")        . Cells . Delete        For Each r In . Range (" A9 : Z 9 "). Resize ( CRH )           r . Value = r . Address ( False , False )        Next        For Each r In . Range ( CRNG )           r . Resize (, 2 ). Merge        Next        . Rows (" 20 : 59 "). Hidden = True        . Columns . AutoFit     End With     With Worksheets (" Sheet 2 ")        . Cells . Delete        For Each r In . Range (" A1 : Z 1 "). Resize ( 10 )           r . Value = r . Address ( False , False )        Next        . Rows (" 4 : 7 "). Hidden = True        . Columns . AutoFit     End With End Sub 
こんな で どうでしょう か 。 FindNext を 使う と 不具合 が あっ た ため 、 Find だけ で 処理 し て い ます 。 対象 セル は 選択 範囲 に なっ て ます が 、 Set target = Selection ' 選択 セル を 対象 を Set target = Cells ' 全 セル を 対象 に する と 全 セル が 対象 に なり ます 。 Set target = Range (" A1 : BH 5 ") ' 指定 セル を 対象 など に する と 、 指定 し た セル 範囲 ( ここ で は " A1 : BH 5 ") が 対象 に なり ます 。 Sub sample () Dim target As Range Dim rng As Range Dim adr As String Dim n As Integer ' Set target = Selection ' 選択 セル を 対象 ' Set target = Cells ' 全 セル を 対象 ' Set target = Range (" A1 : BH 5 ") ' 指定 セル を 対象 Application . FindFormat . Locked = False ' 非 ロック セル 検索 Application . FindFormat . FormulaHidden = False ' 表示 セル 検索 Set rng = target . Find ( What :="", After := Cells ( target . Row + target . Rows . Count - 1 , target . Column + target . Columns . Count - 1 ), LookAt := xlPart , SearchFormat := True ) ' 最終 セル の 次 から 探す ( A1 が 対象 の 場合 に 対応 ) If rng Is Nothing Then Exit Sub ' 無かっ たら 終わり adr = rng . Address ' 最初 に 見つけ た セル の アドレス n = 1 ' 表示 する 番号 の 初期 値 Do rng . Value = n ' 見つけ た セル の 番号 を 表示 n = n + 1 ' 表示 する 番号 + 1 Set rng = target . Find ( What :="", After := rng , LookAt := xlPart , SearchFormat := True ) ' 次 の セル を 検索 ( FindNext 打 と 不具合 が あっ た ので ) Loop Until rng . Address = adr ' 最初 の アドレス に なっ たら 抜ける End Sub 
コード 例 です 。 Private Sub Worksheet _ BeforeDoubleClick ( ByVal Target As Range , Cancel As Boolean ) If Not Inter sect ( Target , Range (" g2 : g1 52 ")) Is Nothing Then UserForm 1 .S how Cancel = True ElseIf Not Inter sect ( Target , Range (" e2 : e 152 ")) Is Nothing Then UserForm 2 .S how Cancel = True End If End Sub 
With ComboBox 2 . AddItem " A " . AddItem " B " . AddItem " C " . AddItem " D " ComboBox 3 . List = . List End With です か ？ 
以下 の コード です 。 Private Sub UserForm _ Initialize () Me . ListBox 1 . RowSource = " Sheet 1 ! A1 : A10 " Me . ComboBox 1 . RowSource = " Sheet 1 ! B 1 : B 10 " End Sub 参考 と なる サイト の URL を 提示 し て おき ます 。 http:// office tanaka .net / excel / vb a/t ips / tips 139 . htm 
Sub 一 例 です () Dim sh As Worksheet , xName , xVal , i As Long xName = Split ("* A *,* B *,* C *,* D *", ",") xVal = Array ( 1 , 2 , 3 , 4 ) For Each sh In Worksheets For i = LBound ( xName ) To UBound ( xName ) If sh . Name Like xName ( i ) Then sh . Range (" AY 1 "). Value = xVal ( i ) Exit For End If Next i Next sh End Sub 
下記 の コード を 入力 シート が 存在 する ブック の 標準 モジュール に コピペ し て ください 。 反映 シート は Boo k2 . xlsx と 仮定 し て い ます 。 Option Explicit Sub Sample () Dim bk1 As Workbook , bk 2 As Workbook Dim st As Worksheet , st 1 As Worksheet , st 2 As Worksheet Dim r1 As Long Dim dt As Variant Application .S creenUpdating = False Set bk1 = ThisWorkbook Set st 1 = bk1 . Worksheets ( 1 ) ' 反映 ブック を 開く Set bk 2 = Workbooks . Open (" Boo k2 . xlsx ") ' A5 から 最下 行 まで 繰り返す For r1 = 5 To st 1 . Range (" A " & st 1 . Rows . Count ). End ( xlUp ). Row ' 日付 を 取得 する dt = st 1 . Range (" B " & r1 ). Value Set st 2 = Nothing ' 日付 シート を 探す For Each st In bk 2 . Worksheets If st . Range (" A 2 "). Value = dt Then Set st 2 = st Exit For End If Next ' 日付 シート が 見つから なかっ た とき は シート を 追加 する If st 2 Is Nothing Then bk 2 . Worksheets (" 原紙 "). Copy After := bk 2 . Worksheets ( bk 2 . Worksheets . Count ) Set st 2 = bk 2 . Worksheets ( bk 2 . Worksheets . Count ) st 2 . Name = Day ( dt ) & " 日 " st 2 . Range (" A 2 "). Value = dt End If ' 号 炉 ごと に 合計 値 を 算出 する With st 2 . Range (" G7 "). Offset ( st 1 . Range (" A " & r1 ). Value ) . Value = . Value + st 1 . Range (" C " & r1 ). Value End With Next r1 ' 反映 ブック を 上書き保存 し て 閉じる Application . DisplayAlerts = False bk 2 . Close True Application . DisplayAlerts = True Application .S creenUpdating = True End Sub 
既に hdump さん が 回答 さ れ て い ます が 、 全く その 通り です 。 一つ の テキストボックス で 年月日 を 入力 さ せる の で は なく 、 あいだ の 「 /」 は ラベル を 用い て 、 年月日 それぞれ を 別々 の テキストボックス で 入力 さ せ て み て は どうでしょう か ？ 
Dim hogehoge As Range For Each hogehoge In Range ( Range (" I 2 "), Cells ( Rows . Count , 9 ). End ( xlUp )) hogehoge . Value = Application . RoundDown ( hogehoge . Value , 1 ) Next 
可能性 として は 最初 に 提示 いただい た 終了 条件 の 、 Range (" A1 "). End ( xlDown ). Row の 部分 が 列 A の A1 ～ 下 方向 にかけて 空白 で ない セル まで くりかえし といった 、 終了 条件 と なっ て いる ので たとえば A1 00 まで データ が あっ た として も 途中 の A5 3 の セル 値 が 空白 など で あっ た 場合 は A5 2 の セル で 終了 と なり ます が 、 データ は 空白 を 含み ます か ？（´∀｀） 
試し て み て ください 。 Sheet 1 表示 状態 で 実行 し ます 。 Sub Test () Dim r As Long , T As String , spT As Variant Dim L As Long , rng As Range r = 2 Do While Cells ( r , 1 ). Value <> "" If Cells ( r , 1 ). Value <> 0 Then _ T = T & Cells ( r , 2 ). Value & "," Set rng = Rows ( r ) r = r + 1 Loop spT = Split ( T , ",") For L = 0 To UBound ( spT ) - 1 r = 2 Do While Cells ( r , 2 ). Value <> "" If Cells ( r , 2 ). Value = spT ( L ) Then _ Set rng = Union ( rng , Rows ( r )) r = r + 1 Loop Next rng . Copy Sheets (" Sheet 2 "). Activate Rows ( 2 ). Select ActiveSheet . Paste rng . Delete Shift := xlUp End Sub 
> この よう な こと は GriedView を 使っ て でき ます か ？ ⇒ はい 、 でき ます よ 。 GridView の 列 の 中身 を カスタマイズ する に は 、 templateField という もの を 使い ます 。 これ を 使う と 、 列 の 中身 の コントロール を 自由 に 配置 する こと が 可能 です 。 http:// www . atmarkit . co.jp / fdotnet / vs 2005 db / vs 2005 db _ 04 / vs 2005 db _ 04 _... （ ちょっと 古い です が ） ＞ そして ユーザー に テキストボックス に 日 付 を 入力 し て もらい 、 ドロップダウンリスト の 内容 を 変え たい と 思っ て い ます 。 ⇒ これ は javascript と ajax を 使う の が スマート か と 。 ちょっと 敷居 高い かも です が 。 
何 か を 作れ って 言わ れ て い ない ？ なけれ ば 、 自分 の 仕事 の 中 で 使用 でき そう な もの を つくる 。 仕様書 作っ て 、 設計 し て 、 プログラミング し て 、 実行 結果 を まとめる 。 まで が 成果物 だ と 思う けど ？ 
まず 、 ホームページ は html と 言う ルール に 沿っ た 言語 で 書か れ て い ます 。 これ は 各 ブラウザ で 違う 所 も ある の です が 、 基本的 に は 各 ブラウザ 共通 の 言語 です 。 基本 の html だけ で は 色々 の 事 が 出来 ませ ん が 、 Dom ( Document Object Model ) と 言う 仕組み で 、 html を 色々 操作 する 事 が でき ます 。 これ は サーバ 側 で PHP や Java や Perl や javaScript ( java Script は 一部 クライアント 側 ) で 操作 する 仕組み な ので 、 基本的 に は クライアント 側 ( ブラウザ 側 ) から 操作 でき ない 仕組み です 。 ただ 、 Microsoft が 自分 の 会社 アプリケーション 同士 を 操作 できる OLE ( Object Linking and Embedding ) と 言う 仕組み を 組み込ん だ ので 、 VBA を 使っ て Microsoft Internet Explorer 上 の Dom を 使う こと が できる よう し まし た 。 ちなみに php は サーバ 側 で 動い て いる ので 、 VBA から は 操作 でき ませ ん 。 な ので 、 php や Dom は 、 データ を 使う ホームページ制作 を する なら 覚え た 方 が いい です が 、 VBA にとって は 本道 から 離れ て いる と 思い ます 。 特に 最近 の ホームページ で は Ole で は 対処 でき ない もの も 多く なっ て き て い ます 。 VBA から Dom を 使っ て 操作 できる ブラウザ は Microsoft Internet Explorer だけ です 。 php や Dom は サーバ 側 の 技術 です 。 Dom は JavaScript など の 本 の 方 が 詳しい と 思い ます 。 ちなみに 、 Microsoft の 新しい ブラウザ の Microsoft Edge も VBA から 操作 できる よう です が 、 詳しく は 不明 です 。 
自分 は 簡単 な VBA なら 組める って レベル です が 、 「 何 が し たい か 」 が 明白 で あれ ば 行動 に 移し やすい です 。 「 エクセル で ○ ○ を ○ ○ し たい ！ 」 という 欲求 が 有り 、 VBA で 実現 する に は どう すれ ば いい の か を ネット で 検索 し て … を ひたすら 繰り返す 、 という かし た の が 自分 の やり方 でし た 。 たとえば 英語 を 覚える のに アルファベット から 覚え て This is a pen . から 始める と ゴール は 遠い です が 、 来週 アメリカ に 旅行 に 行く ん だ けど 〜 て な 時 に は 「 必要 な 英語 だけ を とりあえず 覚え とく 」 方 が 効率 が いい です よ ね 。 
こんにちは。 主 様 が 実行 しよ う と し て いる 環境 そのもの が 、 特殊 です 。 たとえば 、 「 もともと クラウド 」 に あっ た エクセル ブック を 、 自動的 に ダウンロード し 、 マクロ の ブック が 開い て いる よう な 場合 です 。 クラウド の 場合 は 、 「 見せ掛け の シームレス 」 の ため に 、 舞台裏 は 、 とんでも なく 複雑 に なっ て い ます 。 主 様 の フォルダ の cache の 言葉 は 、 それ を 物語っ て い ます 。 この ブック を 「 ローカル パソコン 」 の ドキュメント フォルダ で 実行 し たら 、 主 様 の 期待 し た 動作 に なる はず です 。 ( 主 様 の 問題 が 、 複雑 な 舞台裏 の 仕様 が 原因 、 という こと です よ つまり 、 そこ だけ で しか 、 再現 でき ませ ん ) もし 、 社内 で 使っ て い て 、 という の でし たら 、 同じ よう な 環境 で の 実行 という こと でしょ う から 、 問題 は 起こり ます 。 問題 の 洗い出し と 、 回避 策 を 考え ましょ う 
左側 の グレー の スペース は メニュー 項目 の アイコン 表示 の ため の スペース です 必要 が なけれ ば ContextMenuStrip の 『 ShowImageMargin 』 を False に し て 見 ましょ う 項目 の ない 部分 で の 右クリック に対して は ListBox の MouseDown イベント にて if e . Button = MouseButton . Right then dim pt as Point = e . Location dim bflag as boolean ' 余白 か 項目 か を チャック for n as integer = 0 to ListBox 1 . Items . Count - 1 if bflag orelse ListBox 1 . GetItemRectangle ( n ). Contains ( pt ) then ' 項目 上 bflag = true exit for end if next if bflag = false then ' 余白 なら 右 メニュー を やめる listBox 1 . ContextMenustrip = Nothing else ' 項目 なら 右 メニュー を 設定 ListBox 1 . ContextMenuStrip = ContextMenuStrip 1 end if End if といった 具合 です 
最後 （ 一番 右 ） の シート の シート 名 が 数字 だけ で ない と エラー に なり ます 。 シート 名 を 確認 し て 下さい 。 
> 原因 を 教え て 下さい !! BlnA 3 = ISBLANK ( A3 ) ISBLANK という ステートメント ・ 関数 は 、 VBA に 存在 し ませ ん 。 A3 は 、 変数 です か ？ あと 、 示さ れ た コード は 、 冗長 な 部分 が 多い です 。 ダイエット し ましょ う 。 ↓ は 、 ダイエット 結果 の 一 例 。 Private Sub CommandButton 1 _ Click () Dim NextRow As Long , xDate As String xDate = Format ( Date , " mm 月 dd 日 ") ' 初めて 日付 ボタン を クリック し た 時 の 処理 If Cells ( 3 , 1 ). Value <> "" Then Cells ( 3 , 1 ). Value = xDate Else ' 日付 ボタン を 2回 以上 クリック し た 時 の 処理 ' F 列 に 値 が 入力 さ れ て いる 最終 行 を 取得 し て ､ 最終 行 の 次 の 行 及び 日付 列 に 次 の 日 の 日付 を 入力 する ｡ NextRow = Range (" F " & Rows . Count ). End ( xlUp ). Row + 1 Cells ( NextRow , 1 ). Value = xDate End If End Sub 
vba なら Split (" aaaa _ rehrte _ kore _ sert ", "_")( 2 ) で 、 ２つ め の _ と ３つ め の _ の 間 の 文字列 が 取り出せ ます 。 
質問 の 内容 は なん でしょ う ？ 
テンプレート に 書き込み し た ファイル を サーバ 上 で 保存 し て 、 Webページ から は その 保存 し た ファイル に リンク を 設定 する 要領 で 表示 でき ます 。 
質問 の 以下 の 内容 が 分かり ませ ん が .. よく 似 た 方法 で 例 を 回答 し ます 。 > 列 幅 を すべて 1 に 設定 し セル の 結合 で サイズ を 合わせ 、 > 固定 長 形式 の ファイル を 作成 する こと が でき まし た 。 >( 拡張子 を . prn →. txt ) 固定 長 の 仕様 が ） 社員 番号 ： 数字 4 桁 、 頭 0 漢字 氏名 ： 全角 10 字 （ 20 バイト ） カナ 指名 ： 半角 20 字 生年月日 ： 数 時 8 桁 （ yyyymmdd 形式 ） 性別 ： 半角 １ 字 シート 名 は 次 の よう な 想定 出力 ： 固定 長 の データ の 出力 元 固定 長 の ファイル 名 に し た ほうが 後 が 楽 か な ？ データ ： 元 データ （ エクセル 表 ） 見出し ： ヘッダー １ 行 目 、 フッタ ２ 行 目 に 設定 出力 シート の １ 行 目 A1 = 見出し ! A1 ここ に 直接 書い て も いい けれども ... ２ 行 目 A 2 = IF ( データ ! A 2 <>"", TEXT ( データ ! A 2 ," 0000 ")& LEFTB ( データ ! B 2& REPT (" ", 10 ), 20 )& LEFTB ( データ ! C 2& REPT (" ", 20 ), 20 )& TEXT ( データ ! D2 ," yyyymmdd ")& LEFTB ( データ ! E2 &" ", 1 ), IF ( データ ! A1 <>"", 見出し !$ A $2 ,"")) これ を 下 に コピー これ で 、 prn 形式 で 保存 し て ください 。 この 場合 、 列 幅 は 関係 あり ませ ん 。 ただし 、 フッター 以降 に 改行 だけ の データ が 大量 に できる と 思い ます 。 全角 漢字 氏名 は REPT 関数 で 全角 空白 を 繰り返し て い ます が 、 文字数 は LENB など 半角 換算 （ 全角 １ 文字 ＝ 半角 ２ 文字 ） で し て い ます 。 また 、 固定 長 に する 方法 として ＝ A 2& REPT (" ", 20 - LENB ( A 2 )) の よう な 回答 が 見受け られ ます が 、 元 の A 2 が 20 字 以上 入力 さ れる と 取り込む システム 側 で エラー に なる か 、 データ が ずれ ます 。 （ 私 は システム 管理者 側 で 経験 あり ） な ので 、 LEFT 関数 で 切り捨て て い ます 。 よく 使い そう な 、 文字 形式 は 網羅 し た つもり です 。 
visualstudio . com で 合っ て い ます 。 マイクロソフト の VisualStudio の 特設 ページ です 。 2010 は 5年 以上 前 の もの だ から 、 もう ない と 思い ます 。 今 の 無料 版 の 最新 版 は 、 VisualStudio Community 2015 です 。 ビジュアルスタジオ の 中 に VB 、 VC++ 、 VC # など の コンパイラ が 入っ て い ます 。 昔 は バラバラ に ダウンロード する 形式 でし た が 、 今 は セット で ダウンロード し ます 。 
試し て い ませ ん が 、 myRng . Copy . Cells ( 1 , 1 ) を myRng . Copy . Cells ( 1 , 1 ). PasteSpecial Paste := xlPasteValues として み て は どうでしょう か ？ 
こんにちは VB.NET で 回答 さ せ て いただき ます 。 ＞ AA とか BB を 表示 する に は そのまま 表示 する と 全部 表示 さ れ て しまい ます ので 、 3 文字 目 から 表示 する よう に し ます 。 Substring ( 2 ) を 利用 し ます 。 Substring は 3 文字 め から 最後 まで 表示 する に は 引数 に 2 を 入れ ます 。 1番 目 の 文字 の インデックス は 0 です 。 サンプル で は Button と Label 、 ListBox を 貼り 付け て い ます 。 Public Class Form 1 Private Sub f () Handles MyBase .S hown ListBox 1 . Items . Add (" 1 AA ") ListBox 1 . Items . Add (" 2 BB ") ListBox 1 . Items . Add (" 3 CC ") Label 1 . Text = "" Button 1 . Text = " 表示 " End Sub Private Sub Button 1 _ Click ( sender As System . Object , e As System . EventArgs ) Handles Button 1 . Click For Each st As String In ListBox 1 . Items Label 1 . Text &= st .S ubstring ( 2 ) & vbNewLine Next End Sub End Class 
masaya 13125 さん プログラム の 種類 等 、 あいまい 。 絶対パス で 書け ば よい 。 
グラフ を 表示 さ せる 手法 （ １ ） Chart コントロール を 用いる （ ２ ） Static コントロール 全体 を 描画 領域 として 軸 、 目盛り を 表示 する （ ３ ） グラフ 表示 領域 と メモリ 表示 領域 を 分けて Static コントロール に 描画 など 、 いくつ か の 方法 が あり ます 。 HTML など で は ビットマップ を 拡大 縮小 する 方法 が 取ら れる こと が 多い です が 、 C# 等 で は 利便性 と 自由 に 描画 できる ため 直接 描画 する ほう が 良い と 思い ます 。 目盛り 値 を 表示 する ため に ラベル を 用いる など は やら ない ほう が 良い と 思い ます 。 私 は スクロール を 含め 直接 描画 する ほう が やり 易い です ね 。 
. Find ( What := i ). Select で は あり ませ ん か ？ Range ( 1 ) といった 使い方 も でき ませ ん 。 検索対象 が 1 行 目 なら Rows ( 1 )、 1 列 目 なら Columns ( 1 ) を 使う と よい と 思い ます 。 あと コード だけ で は 判別 が し にくい ので 検索対象 の 行列 番号 、 シート 名 シート の 構成 など 内容 を もう少し 詳しく 教え て いただける と 回答 し やすく なり ます 。 
質問 の 意味 が イマイチ わからん けど 、 こういう 事 ？ Public Class Form 1 Private Sub Button 1 _ Click _ 1 ( sender As Object , e As EventArgs ) Handles Button 1 . Click Dim ItemList As New strList From {" 33 いう え ", " 00 えあ か ", " 11 あ いう ", " 22 いお か "} ItemList .S ort () ListBox 1 . Items . Clear () For Each str As String In ItemList ListBox 1 . Items . Add ( str .S ubstring ( 2 )) Next End Sub End Class Public Class strList Inherits List ( Of String ) Public Overloads Sub Sort () Dim ary () As String = ToArray () Me . Clear () AddRange ( ary . OrderBy ( Function (o) o .S ubstring ( 2 ))) ' 降順 なら OrderBy の 代わり に OrderByDescending End Sub End Class 
提示 さ れ た コード を 見る と 「 For Cnt = 1 To 25 」 と なっ て い ます ので 、 データ 貼付 シート の C 列 の データ 量 に かかわら ず 下記 を 25回 繰り返し て い ます ね 。 ①「 リスト と カード を 印刷 し ます か ？ 」 の メッセージ を 表示 する ② 管理 ﾘｽﾄシート を 印刷 する ③ P 1 - 2 シート を 印刷 する ④ P 3 - 4 シート を 印刷 する ・ 本当に 「 シート " P 1 - 2 " と シート " P 3 - 4 " だけ 」 が 沢山 印刷 さ れ て いる の でしょ う か ？ ・ ループ ごと に メッセージ を 表示 し て い ます が 、 ループ の 前 に 一 度 だけ 表示 し て No なら 何 も 印刷 し ない 、 という 方法 で は だめ な の でしょ う か ？ 
Pictures . Insert で 画像 を 貼り 付け た 場合 、 Excel 2007 ： 画像 情報 が Excel に 保存 さ れる の ・ ・ ・ msoPicture ( 13 ) Excel 2010 ： リンク オブジェクト として 取り込ま れる ・ ・ ・ msoLinkedPicture ( 11 ) と 変更 に なり まし た 。 ( 参考 )[ Microsoft サポート 情報 ] Excel 2010 で Pictures . Insert メソッド を 使用 し て 図 を ワーク シート に 挿入 する と 図が リンク オブジェクト として 挿入 さ れる https :// support . microsoft . com / ja - jp / kb / 2396509 基本的 に は Shapes . AddPicture を 使う よう に 書か れ て い ます 。 Set objShape = ActiveSheet .S hapes . AddPicture ( _ Filename := objFileName , _ LinkToFile := False , _ SaveWithDocument := True , _ Left := Selection . Left , _ Top := Selection . Top , _ Width := 50 #, _ Height := 50 #) With objShape .S caleHeight 1 !, msoTrue .S caleWidth 1 !, msoTrue End With この 中 で LinkToFile := False で リンク オブジェクト に し ない こと を 指定 SaveWithDocument := True で 画像 情報 を ファイル に 保存 する こと を 指定 こう する こと で 、 追加 し た 画像 は msoPicture ( 13 ) に なり ます 。 なお 、 以下 の サイト で Pictures . Insert し た 画像 を クリップボード に コピー し 、 削除 し た 後 貼り 付ける こと で リンク で ない 画像 に する 方法 が 書か れ て い ます ので 参考 に し て み て ください 。 [ moug モーグ ] 画像 ファイル を 挿入 する http:// www . moug .net / tech / exvba / 0120020 . html 
Msgbox TypeName ( Cells ( 1 , 1 ). Value ) 変数 型 を 調べる 命令 です が 、 これ を 実行 する と どう なり ます か ？ また 、 A1 の 数式 は 何 が 入っ て いる の でしょ う か 。 
例えば こんな 感じ の XAML で 。 < Window ・ ・ ・ xmlns : vw =" cl r-na mespace : WpfApplication 1 . Views " xmlns : vm =" cl r-na mespace : WpfApplication 1 . ViewModels "> < Window . Resources > < DataTemplate DataType ="{ x : Type vm : AViewModel }"> < vw : AView /> </ DataTemplate > < DataTemplate DataType ="{ x : Type vm : BViewModel }"> < vw : BView /> </ DataTemplate > < DataTemplate DataType ="{ x : Type vm : CViewModel }"> < vw : CView /> </ DataTemplate > </ Window . Resources > < DockPanel > < StackPanel DockPanel . Dock =" Top " Orientation =" Horizontal "> < Button Content =" A " Command ="{ Binding ChangeScreenCommand }" CommandParameter =" A " /> < Button Content =" B " Command ="{ Binding ChangeScreenCommand }" CommandParameter =" B " /> < Button Content =" C " Command ="{ Binding ChangeScreenCommand }" CommandParameter =" C " /> </ StackPanel > < Grid > < ContentControl Content ="{ Binding CurrentViewModel }" /> </ Grid > </ DockPanel > </ Window > ChangeScreenCommand で CurrentViewModel を 切り替え て 画面 切り替え を し ます 。 AViewModel に対する 画面 は AView 、 BViewModel に対する 画面 は BView 、 CViewModel に対する 画面 は CView という ユーザー コントロール に なり ます 。 
複雑 に 見え て いる だけ で 実際 は そう でも ない です 。 結合 セル と ひらがな が 目 くらまし に なっ て い て 表 は 添付 図 の よう に なっ て い ます 。 D 列 と E 列 に は B 列 が 空白 セル に なっ て い て B 列 の 情報 は ない わけ です 。 と いう より 、 空白 セル は ０ 扱い です から ４ ０ ０ ０ 未満 と 同じ です 。 なので 上 から ループ する とき B の ４ ０ ０ ０ 以上 ４ ０ ０ ０ 未満 の 判定 結果 を 保持 する 変数 を 使え ば いい です ね 。 B2 , B 3 , B4 は ４ ０ ０ ０ 以上 、 B5 で また 変数 に B ５ , B ６ , B ７ は ４ ０ ０ ０ 以上 、 B 8 で B 8 , B 9 B 10 は ４ ０ ０ ０ 未満 ・ ・ ・ ・ という 感じ です 。 集計 列 に は 文字 が 入っ て いる ので ＋ 演算子 が 使え ませ ん 。 SUM 関数 を 使い ます 。 Sub test () Dim Judge As Boolean Dim Csum As Long , Dsum As Long , Esum As Long , i As Long , d As Long With WorksheetFunction For i = 2 To Cells ( Rows . Count , 2 ). End ( xlUp ). Row + 2 If i Mod 3 = 2 Then Judge = Cells ( i , 2 ) >= 4000 ' 3 行 置き に 判定 If Judge Then Csum = .S um ( Csum , Cells ( i , 3 )) Dsum = .S um ( Dsum , Cells ( i , 4 )) Esum = .S um ( Esum , Cells ( i , 5 )) End If Next i Cells ( 4 , 7 ) = Csum Cells ( 4 , 8 ) = Dsum Cells ( 4 , 9 ) = Esum ' - - - - - - - - - - - - - - - - - - - - - - - - - ------------------------- ' 上 と 同じ こと を する Csum = 0 : Dsum = 0 : Esum = 0 For i = 2 To Cells ( Rows . Count , 2 ). End ( xlUp ). Row + 2 If i Mod 3 = 2 Then Judge = Cells ( i , 2 ) < 4000 ' 3 行 置き に 判定 If Judge Then Csum = .S um ( Csum , Cells ( i , 3 )) Dsum = .S um ( Dsum , Cells ( i , 4 )) Esum = .S um ( Esum , Cells ( i , 5 )) End If Next i Cells ( 8 , 7 ) = Csum Cells ( 8 , 8 ) = Dsum Cells ( 8 , 9 ) = Esum End With End Sub 
前半 だけ です が 、 これ で どうでしょう 。 Dim myKey As String Dim rng As Range sidx = 34 myKey = " 小計 " rng = Range (" E : E "). Find ( whgat := myKey ) If rng Is Nothing Then Exit Sub r = rng . Row Range ( Cells ( r , " H "), Cells ( r , " L ")). Formula = _ "= sum (" & Range ( Cells ( sidx , " H "), Cells ( r - 1 , " H ")). Address ( ColumnAbsolute := False ) & ")" 小計 を 探す の に find を 使い まし た 。 関数 の 一気 入力 を 使っ て ます 。 セル 範囲 . Formula =" 先頭 セル に 入力 する べき 関数 " これ で セル 範囲 全部 に 入力 さ れ ます 。 
こんにちは。 > Workbook _ Deactivate と Workbook _ WindowDeactivate 最初 の は 、 ブック レベル 、 次 の は 、 ウィンド レベル です 。 テスト は 、 ブック 1 を 開き 、 ウィンド から 「 新しい ウィンド 」 を 開く として 、 同じ ブック を 二つ の ウィンド で みる よう に し ます 。 つづい て 、 「 新規 ブック 」 を クリック し 、 ブック 2 を 表示 。 この とき 、 ブック 1 は 2つ ブック 2 で 、 合計 、 3つ の ウィンド が あり ます 。 この 状態 で 、 ウィンド を 順番 に クリック し て ください 。 発生 する イベント が どんな 順番 で 発生 する か 、 み て み て ください 。 で 、 説明 、 なん です が 、 ブック 1 と ブック 2 の 切り替え の 時 に 、 発生 する の が 、 Workbook _ Deactivate です 。 そして 、 ウィンド が 切り替わっ た とき に は Workbook _ WindowDeactivate です 。 つまり 、 ブック が 1 と ブック 2 しか 、 ない 、 という 環境 で は 、 両方 の イベント が 発生 し ます 。 違い が 分かる の は 、 同じ ブック を 、 複数 の ウィンド で 、 み て いる 場合 です 。 同じ ブック を 見 続け て いる 間 は 、 「 Workbook _ Deactivate 」 は 、 発生 し ませ ん 。 さらに 、 見 て いる ブック しか ない 、 という 場合 は 、 「 Workbook _ Deactivate 」 が 発生 する の は 、 ブック を 閉じる だけ に なり ます 。 OS レベル で 、 ウィンド を 切り替え た とき 、 イベント は 発生 し ませ ん 。 イベント の 処理 で は 、 状況 環境 に 合わせ て コード を 記述 する ので 、 最初 の うち は 、 テスト コード を 使っ て 、 確認 し て み ない と 、 分から ない こと が 多い です 
最終 的 に どの よう な 処理 を し たい の か 不明 です が 、 チェックボックス が オン に なっ て いる 数 を 数える の で あれ ば 以下 の よう な コード で 可能 です 。 Sub CheckBoxOn () Dim chk As Object , cnt As Integer For Each chk In ActiveSheet . CheckBoxes If chk = xlOn Then cnt = cnt + 1 End If Next chk MsgBox " オン は " & cnt End Sub 
こんにちは。 この アプリ は 、 そもそも 、 エクセル VBA から 、 window 制御 する 、 という よう な 実行ファイル で は あり ませ ん 。 この アプリ は 、 パス の 保存 の 設定 、 そして 、 展開 先 の フォルダ を 保持 する 仕組み が あり 、 設定 を 調整 する こと で 、 制御 し なく て も 保存 先 は 保持 できる よう です 。 高度 な 設定 に は 「 パスワード ファイル 」 なる もの が 使える よう な ので 、 その ファイル を 正しく 設定 する 部分 を エクセル で 作る こと が 出来 たら 、 その ファイル を 使っ て 、 展開 動作 を さ せる こと が 、 やっ て み ない と いけ ませ ん 。 パスワード ファイル そのもの も 、 暗号 に なっ て い たら 、 結局 、 アプリ で 作成 さ せる 、 という こと な ん です から 、 どこ か で あらかじめ 作業 が 必要 という こと です 
表 が 何 行 目 から 始まっ て いる とか 何 列 に ある とか の 情報 が ある と ズバリ の 数式 を 提示 できる の です が 不明 な ので 添付 図 の 場合 です 。 せめて 何 行 名 から 始まっ て も いい よう に 空い て いる 列 の ２ 行 目 に 数式 を 入れ ます 。 H2 = IF ( C 2 ="○", SUBSTITUTE ( TRIM ( H1 &" "& B2 )," ",","), H1 ) 下 に コピー し ます 。 （ 元 の 表 の 最終 行 に 合わせ て ） C 列 が 「 購入 」 列 、 B 列 が 商品名 の 列 という 想定 です 。 
① に 書か れ て いる For i = 1 To Worksheets ( 1 ). Range (" A " & Rows . Count ). End ( xlUp ). Row Worksheets ( r ). Range (" C1 "). Value = Worksheets ( 1 ). Range (" A " & i ) '★ Next i を みる と 、 「 r 」 は 、 変わら ず 「 i 」 は 、 １ ～ 最終 行 の 行番号 まで 変化 し ます 。 ★ のところ の 左辺 は 、 なに も 変わら ない 、 という こと は 、 i が 変わっ て も 、 同じ シート の C1 セル に 上書き さ れる だけ 。 最終 行 の 値 が 最後 に C1 セル に 残る こと に なり ます 。 という こと は 、 この 3 行 は 、 i = Worksheets ( 1 ). Range (" A " & Rows . Count ). End ( xlUp ). Row Worksheets ( r ). Range (" C1 "). Value = Worksheets ( 1 ). Range (" A " & i ) と 書く の と 同じ だ という こと です ね 。 全体 を 書き かえる と Sub d () For r = 2 To 5 i = Worksheets ( 1 ). Range (" A " & Rows . Count ). End ( xlUp ). Row '■ Worksheets ( r ). Range (" C1 "). Value = Worksheets ( 1 ). Range (" A " & i ) Next r '■ の ステップ は For 文 に 影響 さ れ ない ので 、 ループ の 外 に 持っ て いく と Sub d () i = Worksheets ( 1 ). Range (" A " & Rows . Count ). End ( xlUp ). Row For r = 2 To 5 Worksheets ( r ). Range (" C1 "). Value = Worksheets ( 1 ). Range (" A " & i ) Next r という こと に なり ます ね 。 Worksheets ( 1 ) の A 列 最終 行 の 値 を 、 他 の シート の C1 に 代入 し て いる という こと です ね 。 
イメージ 的 に は こんな 感じ か な 。 Sub Sample () Dim buf As String , i As Long , Check As String For i = 1 To Cells ( Rows . Count , 1 ). End ( xlUp ). Row If Cells ( i , " B ") = "○" Then buf = buf & vbCrLf & Cells ( i , " A ") & "," Check = Cells ( i , " A ") ElseIf Cells ( i , " A ") = Check And Cells ( i , " B ") = "" Then buf = buf & Cells ( i , " A ") & "," ElseIf Cells ( i , " A ") <> Check And Cells ( i , " B ") = "○" Then Else Check = "" End If Next i MsgBox buf End Sub 
一 点 目 If Range (" A1 "). Value = "" Then Range (" A1 "). Value = left Range (" B 1 "). Value = right Else With Range (" A1 "). End ( xlDown ) . Offset ( 1 , 0 ). Value = left . Offset ( 1 , 1 ). Value = right Wnd With End 二 点 目 無限ループ に なり ます 。 何 か 終了 条件 が 無い と 終わり ませ ん 。 Dim r As Long r = 1 Do If Range (" A " & r ). Value = "" Then Range (" A " & r ). Value = " 何 か値 " r = 1 Else r = r + 1 End If Loop 
カテゴリ が ファイル共有 ・ P2P に なっ て い ます 。 違反 報告 で 投稿 が 削除 さ れ ライフ が 減る 前 に カテゴリ 修正 する 事 を お勧め し ます 。 読み込ん だ 文字列 の 右側 1 文字 を 削る の は 如何 でしょ う か 。 但し 、 ファイル の 最終 行 は 改行 コード が 無い はず です ので 、 最終 行か どう か を If 文 で 判断 さ せる 必要 が ある か と 思い ます 。 あるいは 、 文字列 の 最後 の 文字 が 改行 か どう か 、 で 判断 さ せ て も いい です ね 。 https :// msdn . microsoft . com / ja - jp / library / cc 392241 . aspx 文字列 が buf という 変数 に 入っ て いる として 、 buf = Left ( buf , Len ( buf ) - 1 ) で 、 右側 1 文字 を 削れ ます 。 それでは 。 
おかしな 点 です が 、 For r = 1 To Worksheets ( 1 ). Range (" a " & Rows . Count ). End ( xlUp ). Row 1 から Ａ 列 の 最終 行 まで 処理 を し ます が 、 変数 r は Worksheets ( 1 ). Range (" c " & r ). Value と Ｃ 列 の 行 として 処理 し て い ます 。 Ｃ 列 の 最後 まで 処理 する の で は ない です か ？ Worksheets ( 1 ). Range (" b 1 : b 5 "). Find Ｂ 列 は ５ 行 目 まで で 固定 です か ？ Ｂ 列 の 最終 行 まで 処理 し ませ ん か ？ そういった こと を 考え て 変更 し た サンプル が 以下 に なり ます 。 Sub 文字 の 検索 () ' 先頭 の シート を アクティブ に し て おき ます Worksheets ( 1 ). Activate ' Ｃ 列 の 最終 行 まで 処理 し ます For r = 1 To Range (" C " & Rows . Count ). End ( xlUp ). Row ' Ｂ 列 の 先頭 から 最終 行 まで を 検索対象 に し ます With Range (" B 1 ", Range (" B " & Rows . Count ). End ( xlUp )) ' Ｃ 列 の 文字 で 検索 し ます Set Rng = . Find ( Range (" C " & r ). Value , lookat := xlPart ) ' １ 件 以上 あっ た 場合 If Not Rng Is Nothing Then ' 検索 結果 の 先頭 アドレス を 控え て おき ます first address = Rng . Address Do ' 左 の セル （ Ａ 列 ） に ○ を 入れ ます Rng . Offset ( 0 , - 1 ). Value = "○" ' 次 を 検索 し ます Set Rng = . FindNext ( Rng ) ' 検索 結果 が 先頭 に 戻る まで 繰り返し ます Loop Until Rng . Address = first address End If End With Next r End Sub 
おはよう ござい ます 。 セル の 代入 Cell (○○)＝ なにがし まで は 出来 て いる という 事 です よ ね 。 セル に セット する 内容 が 上記 内容 で 決め 打ち 出来る の なら 単純 に 文字列 を つない で おけ ば 良い の で は 無い でしょ う か ？ dim setCellData As String setText = "○○ は " & txtboxA & " 秒 、 ▲ ▲ は " & txtboxB & " 秒 、 ■ ■ は " & textboxC " & " 秒 " といった 感じ で 作っ て おい て 、 Cell (○○) = setCellData と 入れ て いく 。 もし セル の 内容 が だいぶ 複雑 で 対応 出来 ない の でし たら 正規表現 を 使う 事 と なり ます が 、 そこ まで し なく て も 良い の か な と 感じ まし た 。 http:// excel - mania . com / vba / regex p2 . html ただ 、 Cell が 数 百 に 及ぶ など です と 、 若干 重い かも 知れ ませ ん ね 。 この 場合 レンジ で 書き込む こと で 高速化 出来 ます が 連続 し て いる 必要 が ある ので word 表 （ たぶん Excel 表 の 埋め込み です よ ね ） の 仕様 を 変更 する 事 も 視野 に 入れる べき です ね 。 
変更 箇所 以外 を 判断 する ため に は 、 変更 する 前 の 内容 を 覚え て おく 必要 が あり ます が 、 その ため に は 「 変更 し た 」 と 見なす ルール を 明確 に する 必要 が あり ます 。 例えば 該当 の ブック が 最後 に 保存 さ れ て から 、 な の か 、 ある 日付 以降 、 な の か 、 など です 。 
数字 が １ ０ ０ に なる まで です 。 シート モジュール に Sub test () Cells . Clear With Range (" A1 ") . Value = "=( ROW ( A1 )- 1 )* 4 / 18 + COLUMN ( A1 )/ 2 + 0 . 5 " . Font .S ize = " 32 " End With Range (" A1 : A1 6 "). Merge With Range (" A1 : B 18 ") . Borders . LineStyle = True . AutoFill Destination := Range (" A1 : H1 8 ") End With Range (" A1 : H1 8 "). AutoFill Destination := Range (" A1 : H 450 ") End Sub 数字 が １ ０ ０ ０ まで 欲しい とき は 最後 の ２ 行 目 を Range (" A1 : H1 8 "). AutoFill Destination := Range (" A1 : H 4500 ") といった 具合 です 。 フォント サイズ 、 位置 、 罫線 、 結合 セル の 個数 など は 写真 から は 読み取れ ない ので 適宜 設定 を し て ください 。 
性別 が 「 男性 」 「 女性 」 に 限ら れ て いる の で あれ ば 都道府県 を 切り出す = LEFT ( A1 , LEN ( A1 )- 2 ) 性別 を 切り出す = RIGHT ( A1 , 2 ) でいか が でしょ う か ？ 
Option Explicit を 書か ない と 問題 が ない 、 という こと は あり 得 ませ ん 。 宣言 さ れ て い ない 変数 は 暗黙 的 に Variant 型 と みなさ れ て しまう ため 、 変数 の スペル ミス に 気付か ない こと が あり ます 。 その 結果 「 うまく いか ない 」 と 半日 悩ん で しまう こと も あり 得 ます 。 Excel VBA で の 例 に なり ます が 、 下記 の サイト を 参考 に し て ください 。 Office TANAKA - 今さら 聞け ない VBA 「 変数 って 宣言 し なく ちゃ いけ ない の ？ 」 http:// office tanaka .net / excel / vba / beginner / 06 . htm 
> 201601 ・ 201602 と 月 毎 に 名前 が 変わる ので 、 セル A1 に 2016 、 B 1 に 01 or 1 > と 入力 し た 場合 に 201601 の フォルダ を 指定 し フォルダ を 開く と 書い て あり ます が 、 質問 文 に 書か て いる コード が ① の もの なら 「 201601 」 という の は フォルダ なく ブック 名 だ と 思い ます 。 ブック 名 で いい と し たら 他 の 方 の ご 指摘 の よう に 、 変数 の 文字 が 違う 点 も あり ます が 、 それ 以外 に FName = Range (" A1 "). Value & Range (" B 1 "). Value & ". xlsx " 最後 の 拡張子 部分 が あり ませ ん 。 ② は ① と は 別 の 質問 です ね 。 フォルダ が どこ な の か 、 わかり ませ ん 。 最新 と は ファイル 名 で 「 収集 データ （ 最新 版 2 ） 」 の 最新 版 の 後 の 数字 で 判断 し て いい の です ね ？ 
他 の 質問 で 回答 し まし た が 、 これ は 質問 が おかしい ですよ。 10 進 の 0 . 00390625 を 表現 する に は 最低 何 バイト 必要 です か ？ なら 通じ ます 。 10 進 256 は 、 あなた の 書い た とおり 100000000 です から 1 バイト で は 1 ビット 足り ない です よ ね 。 しかも すべて 整数 として です 。 小数 を 表し たけれ ば 、 マイナス 何 乗 で 表す 必要 が あり ます 。 1 . 00000000 かける 2 の マイナス 8 乗 です から 指数 の プラス か マイナス を 表す ため に 1 ビット 指数 の 8 を 表す ため に 4 ビット ( 3 ビット だ と 7 まで しか 表せ ない ので ) 1 . 00000000 を 表す ため に 8 ビット あれ ば 良い ので 、 0 . 00390625 を 表し たい だけ なら 、 13 ビット あれ ば 良い の で 最低 1 . 625 バイト あれ ば 表現 でき ます 。 ( 面倒くさい ので 2 バイト と 言い たい ) 浮動小数点数 という やり方 です ね 。 実際 の プログラム の 世界 で は float 型 ( 4 バイト ) や double 型 ( 8 バイト ) を 使っ て 小数 を 表現 し ます 。 
正規表現 の 一 例 です 。 Sub sample () With CreateObject (" VBScript . RegExp ") . Pattern = " 文字列 " . Global = True MsgBox . Execute ([ a1 ]). Count End With End Sub 
2 行 目 が おかしい の で は 。 Dim s As String = TextBox 1 . Text TextBox 2 . Text = s ← 変更 If s . Length = 4 Then TextBox 2 . Height = 60 TextBox 2 . Width = 240 End If あと 、 TextBox の 高 さ を 指定 する に は 、 TextBox の MultiLine プロパティ を true に する 必要 が あり ます 。 
C# で PictureBox に 折れ線 を 引く の で あれ ば PictureBox の Paint イベント で DrawLines メソッド を 使う こと を お勧め し ます 。 参考 サイト ： http:// dobon .net / vb / dotnet / graphics / drawline . html # fold なお 、 グラフ を 描画 する の で あれ ば 保持 する 座標 データ は Point の 配列 で は なく 、 List < Point > 型 に し た 方 が 座標 点 の 追加 が 楽 です 。 また 、 キャンバス に 使う コントロール は PictureBox で は なく 、 Panel の 方 が 子 コントロール を 配置 する こと が 出来る ので レイアウト 調整 が 容易 に なり ます 。 
下記 の コード で うまく でき ます が .... Private Sub コマンド 12 _ Click () Dim DB As DAO . Database Dim RS As DAO . Recordset Set DB = CurrentDb () Set RS = DB . OpenRecordset (" リンクパステキスト ", dbOpenDynaset ) Do Until RS . EOF Kill RS ![ 画像 パス ] RS . MoveNext Loop RS . Close : Set RS = Nothing DB . Close : Set DB = Nothing End Sub 
最終 行 = RANGE (" C " & ROWS . COUNT ). END ( XLUP ). ROW FOR I = 1 TO 最終 行 IF RANGE (" C " & I )= Sheet 2 . RANGE (" C 7 ) THEN RANGE (" B " & I )= RANGE (" B7 ") RANGE (" D " & I )= RANGE (" D 7 ") NEXT で 試し て ください 。 
非表示 の フォーム を 起動 し て おい て 、 その フォーム の Form _ Unload が 動け ば ･･･ 普通に 終了 する 場合 は 、 その フォーム の Form _ Unload を 無効 に し て から 閉じる とか ･･･ 以下 参考 に なる と 思い ます ACCESS の 閉じる ボタン を 無効 に する ？ http:// hatenachips . blog 34 . fc2 . com / blog - entry - 163 . html 
見出 し行 が ２ 行 目 、 項目 が Ａ 列 で 合計 行 が 必ず 最終 行 の 前提 Ａ 列 の 最終 行 を 求め 、 ２ 列 目 から 最終 列 （ 見出 し行 の 最 右 列 ） まで を ０ か どう か チェック し て 、 ０ なら 非表示 に し ます 。 【 サンプル 】 Sub Sapmle () Dim r As Long Dim c As Long Dim m As Long ' 最終 行 （ 合計 行 ） を 求め ます r = Range (" A " & Rows . Count ). End ( xlUp ). Row ' 最終 列 を 求め ます m = Cells ( 2 , Columns . Count ). End ( xlToLeft ). Column ’ ２ 列 目 から 最終 列 まで を 繰り返し ます For c = 2 To m ’ 合計 欄 が ０ か どう か を 判断 If Cells ( r , c ). Value = 0 Then ' ０ なら 列 を 非表示 Columns ( c ). Hidden = True Else ' ０ で なけれ ば 、 列 を 表示 Columns ( c ). Hidden = False End If Next End Sub 
>「 画像 ﾌﾙﾊﾟｽ 」 テキストボックス の コントロール ソース に は 「 =[ 画像 検索 2 ]![ 画像 フル パス ]」 循環参照 に なり ます 。 コントロール 名 を 「 画像 ﾌﾙﾊﾟｽ １ 」 に 変更 すと ok です 。 
ＶＢ の バージョン は 何 です か ？ 普通 は 、 TextChanged イベント を 拾っ て if 文 で 、 text と "" を 比較 し て 違っ て い たら ボタン の プロパティー を Enabled = True に する の です 。 逆 に 、 "" だっ たら False に し ます 。 
コード が 変わっ て しまい ます が 良い です か ？ 以下 で どう なり ます か Sheet 1 の A 列 に 連 番 ？ で 、 B 列 が 名前 で 、 C 列 が 時間 で ある と し ます 標準 モジュール に 記述 し Samp 1 を 実行 し て み ます 時分 を 扱う 時 、 値 そのまま なら 誤差 が 入り込み やすい ので 、 文字列 に し て 比較 し ます Public Sub Samp 1 ()     Dim dic As Object , dicT As Object     Dim vA As Variant , vK As Variant , v As Variant     Dim dt As Date     Dim sS As String     Dim i As Long , j As Long , k As Long , n As Long     Set dic = CreateObject (" Scripting . Dictionary ")     Set dicT = CreateObject (" Scripting . Dictionary ")     For dt = # 6 : 00 : 00 AM # To # 2 : 00 : 00 PM # Step # 12 : 30 : 00 AM #        sS = Format ( dt , " h : nn ")        dicT ( sS ) = dicT . Count + 1     Next     With Worksheets (" Sheet 1 ")        With . Range (" A1 "). Current Region           vA = . Resize (, 3 ). Value           k = 0           For i = 2 To UBound ( vA )              sS = Format ( vA ( i , 3 ), " h : nn ")              j = dicT ( sS )              If ( j > 0 ) Then                 If ( Not dic . Exists ( j )) Then                    dic . Add j , CreateObject (" Scripting . Dictionary ")                 End If                 n = dic ( j ). Count + 2                 dic ( j )( n ) = vA ( i , 2 )                 If ( k < n ) Then k = n              End If           Next        End With     End With     If ( dic . Count > 0 ) Then        ReDim vA ( 1 To k , 1 To dicT . Count )        For Each v In dicT . Keys           vA ( 1 , dicT ( v )) = v        Next        For Each vK In dic . Keys           For Each v In dic ( vK ). Keys              vA ( v , vK ) = dic ( vK )( v )           Next        Next        Application .S creenUpdating = False        With Worksheets (" Sheet 2 ")           . Cells . Delete           With . Range (" A1 "). Resize ( k , UBound ( vA , 2 ))              . Value = vA              . Rows ( 1 ). NumberFormatLocal = " h : mm " '              . Columns . AutoFit           End With           . Activate        End With        Application .S creenUpdating = True     End If     Set dic = Nothing     Set dicT = Nothing End Sub ※ > access を エクセル に 変換 し た 表 だ と で あれ ば 、 クロス 集計 で Sheet 2 様式 の もの を 作っ て 、 単に 張り付けれ ば 簡単 そう です が ･･･ 例えば 、 Sheet 1 の データ が Access の テーブル ★ ★ に あり フィールド 名 ： an 、 名前 、 時間 の ３つ an は 数値 型 で 1 ～ の 重複 し ない 番号 時間 は 、 日付 / 時刻 型 と 仮定 し た 時 クエリ の SQL ビュー に 以下 を 記述 し て みる と 、 Sheet 2 の 様式 と 雰囲気 同じ 様に なる と 思い ます TRANSFORM First ( 名前 ) AS 値 SELECT 順 FROM ( SELECT Q 1 . 名前 , Q 1 . 時間 , Count ( Q2 . 時間 )+ 1 AS 順 FROM ★ ★ AS Q 1 LEFT JOIN ★ ★ AS Q2 ON ( Q 1 . 時間 = Q2 . 時間 ) AND ( Q 1 . an > Q2 . an ) GROUP BY Q 1 . an , Q 1 . 名前 , Q 1 . 時間 ) AS Q 3 GROUP BY 順 PIVOT Format ( 時間 ,' hh : nn '); 
コンボボックス に 表示 さ れる テキスト は 1 列 分 しか 設定 でき ませ ん 。 
対象 の 個人 名 は Ａ 列 のみ を 対象 に すれ ば 良い の でしょ う か 。 また 、 ２ 行 目 以降 を 対象 に すれ ば よい の でしょ う か 。 ファイル 名 は 、 氏名 の 前 に 何 か 付い て 、 後ろ に は 付か ない 、 かつ 拡張子 は . xlsx 固定 で よい の でしょ う か 。 上記 の 条件 で あれ ば 、 以下 は 一 例 です 。 【 サンプル 】 Sub Sample () Dim r As Range Dim TargetCell As Range Dim WSH As Object Dim TargetPath As String Dim WBfile As String Dim WB As Workbook ' 対象 フォルダ の 取得 （ Desktop 上 の ( 仮 ) 新規 フォルダ ） Set WSH = CreateObject (" Wscript .S hell ") TargetPath = WS H. SpecialFolders (" Desktop ") & "\( 仮 ) 新規 フォルダ \" Set WSH = Nothing ' A 列 で 値 が 入っ て いる セル を 抽出 （ ２ 行 目 以降 で 値 か 式 の 入っ た セル ） With Range (" A 2 ", Range (" A " & Rows . Count ). End ( xlUp )) On Error Resume Next Set TargetCell = .S pecialCells ( xlCellTypeConstants ) If TargetCell Is Nothing Then Set TargetCell = .S pecialCells ( xlCellTypeFormulas ) Else Set TargetCell = Union ( TargetCell , .S pecialCells ( xlCellTypeFormulas )) End If On Error GoTo 0 End With ' 対象 が ない 場合 は 終了 If TargetCell Is Nothing Then Exit Sub If TargetCell . Address ( False , False ) = " A1 " Then Exit Sub ' セル の 値 を 繰り返し 処理 For Each r In TargetCell WBfile = Dir ( TargetPath & "*" & r . Value & ". xlsx ") ' 対象 の ファイル は 一つ だ として ループ さ せ ませ ん If WBfile <> "" Then ' ファイル を 開く Set WB = Workbooks . Open ( Filename := TargetPath & WBfile ) ＊ ＊ ここ に 作業 部分 を 入れ ます ＊ ＊ ' ファイル を 閉じる （ 保存 する なら SaveChanges := True ） WB . Close SaveChanges := False End If Next End Sub 
>"( JANコード = '" & Jan & "' ) " & _ の カラム 「 JANコード 」 に 「 T .」 か 「 M .」 が 必要 という こと な の で は ？ 
GetOpenFilename を 使っ て テンプレート ファイル の 選択 を 行っ て は どうでしょう か 。 変数 の 定義 で Dim oftFile As String を 追加 。 For の 前 に ChDrive " C :\" ChDir " C :\ Users \ AA \ Desktop \ A フォルダ " oftFile = Application . GetOpenFilename (" テンプレート ,*. oft ", 1 , " テンプレート の 選択 ") If oftFile = " False " Then Exit Sub を 追加 テンプレート ファイル を 読み込む ところ を Set m = ol . CreateItemFromTemplate ( oftFile ) と し ます 。 
いろいろ 方法 は ある と 思い ます が 、 一 例 です 。 テーブル で 、 コピー 元 列 （ FAIL 1 の sheet 1 の 列 ） と コピー 先 の 列 （ FAIL 2 の sheet 2 の 列 ） を 並べ て 定義 し て おき ます 。 For ～ Next で それ を 取り出し て 、 コピー 元 の ２ 行 目 から 最終 行 まで を コピー し ます 。 【 サンプル 】 Sub Sample () Dim tbl As Variant Dim i As Long Dim SrcWs As Worksheet Dim DstWs As Worksheet ' コピー する 列 を 対 で 定義 し ます tbl = Array ( _ " A ", " B ", _ " B ", " D ", _ " C ", " A ", _ " D ", " E ", _ " E ", " C ") ' コピー 元 の ワーク シート Set SrcWs = Workbooks (" FAIL 1 . xlsx "). Worksheets (" sheet 1 ") ' コピー 先 の ワーク シート Set DstWs = Workbooks (" FAIL 2 . xlsx "). Worksheets (" sheet 2 ") ’ テーブル から ２つ おき に 処理 し ます For i = LBound ( tbl ) To UBound ( tbl ) Step 2 ' コピー 元 の 列 の ２ 行 目 から 最終 行 まで を コピー SrcWs . Range ( tbl ( i ) & " 2 ", SrcWs . Range ( tbl ( i ) & Rows . Count ). End ( xlUp )). Copy ' コピー 先 の 列 の ２ 行 目 以下 に 貼り 付け ます DstWs . Range ( tbl ( i + 1 ) & " 2 "). PasteSpecial Paste := xlPasteAll Application . CutCopyMode = False Next End Sub 
コード 例 です 。 ユーザー フォーム 上 に コマンド ボタン を 設置 し 、 記述 し て ください 。 Private Sub CommandButton 1 _ Click () With Workbooks . Open (" C :\ Users \...") '← ブック B の フル パス を 指定 . Worksheets ( 1 ). Range (" B5 "). Value = ComboBox 1 . Text . Close SaveChanges := True '← 記入 後 ブック B を 閉じ なけれ ば この 行 を 削除 End With End Sub 
Setting ファイル 、 独自 XML 、 ini ファイル 、 レジストリ 、 データベース 、 テキストファイル 。 何 で も 良い ん で 保存 すれ ば 良い ん じゃ ない です か 。 http:// dobon .net / vb / dotnet / index . html # file 
秀和システム は いかが でしょ う か はじめて の Excel VBA ［ 決定 版 ］ （ Windows 7 / Excel 2010 完全 対応 ） http:// www .s huwasystem . co.jp / products / 7980 html / 2710 . html はじめて の Access VBA http:// www .s huwasystem . co.jp / products / 7980 html / 1928 . html ※ 2007 以降 の VBA は どの バージョン で も 殆ど 同じ です 。 
この あたり です か ねぇ http:// www . asahi-net . or .jp /~ ef 2 o - inue / vbnet / sub 13 _ 05 _ 020 . html 
試し て い ませ ん が 、 SAVE _ PATH & FILENAME & " Microsoft Print to PDF Microsoft Print to PDF PORTROMPT " の 部分 を SAVE _ PATH & Filename & """ Microsoft Print to PDF Microsoft Print to PDF PORTROMPT """ として み て ください 。 
シート を コピー する だけ で 、 画像 が 崩れる こと は 考え られ ない 。 写真 を 張り付け た PC と 異なっ た PC で 開く と 、 写真 が 崩れ て しまう の で あれ ば 、 原本 の 貼付 け 作業 の し なおし 。 原本 の 貼付 け を マクロ ・ プログラム で 実施 し て いる の なら 、 その マクロ も 手 を 入れる 必要 あり 。 
21日 固定 なら 月 の 変わり目 を 考慮 する 必要 も ない し 、 シート 1 の どこ か に 開始 日 を 入力 し たら シート 2 の 最初 の 日付 は = シート 1 ! どこ か で 、 翌日 は = 最初 の 日付 + 1 で 、 シート 3 の 最初 の 日付 は = シート 2 ! 最終 日 + 1 です よ ね 。 何 の 問題 も あり ませ ん 。 
NETWORKDAYS . INTL 関数 を ご 確認 ください 。 （ 両端 入れ に なっ て いる ので 、 経過 時間 の 場合 に は マイナス 1 し ます 。 ） 日時 の 入力 を EXCEL 標準 の 日時 として 入力 し て ください 。 「 5 / 30 8 : 00 」 と スペース 区切り で 入力 する だけ です 。 そう すれ ば 、 時間 表示 の 方 は 引き算 し 、 そこ から 休日 を 引き算 する だけ で 済み ます 。 休日 = INT ( F2 )- INT ( E2 )-( NETWORKDAYS . INTL ( E2 , F2 , 11 , 祭日 )- 1 ) 稼働 時間 = F2 - E2 -( INT ( F2 )- INT ( E2 )-( NETWORKDAYS . INTL ( E2 , F2 , 11 , 祭日 )- 1 )) = NETWORKDAYS . INTL ( E2 , F2 , 11 , 祭日 )- 1 + MOD ( F2 , 1 )- MOD ( E2 , 1 ) 表示 形式 を ユーザー 定義 で 、 [ h ]: mm : ss ;; と し ましょ う 。 日にち の 方 です が 、 補足 欄 で 補足 し て ください 。 7 : 59 とか 、 23 : 59 など の アブノーマル な 考え方 は 捨て て ください 。 1日 が 23 : 59 で ある わけ が ない でしょ う 。 「 5 / 30 0 : 00 ～ 5 / 31 0 : 00 」 で 24 : 00 の 稼働 で 、 30日 = 24 : 00 、 31日 = 0 : 00 （ 稼働 無し ） と 考え て ください 。 ご 質問 の 趣旨 が よく 分かり ませ ん 。 日にち は 「 足掛け 何 日 」 という こと です か 。 「 5 / 30 8 : 00 ～ 5 / 30 8 : 30 」 の 場合 は 「 0 日 ・ 1日 」 の どれ に なる の です か 。 「 5 / 30 0 : 00 ～ 5 / 31 0 : 00 」 の 場合 は 「 1日 ・ 2日 」 の どれ に なる の です か 。 「 5 / 30 23 : 45 ～ 5 / 31 0 : 15 」 の 場合 は 「 1日 ・ 2日 」 の どれ に なる の です か 。 経過 日数 で 良い なら 表示 時刻 の 端数 を 切り捨てる だけ です 。 = INT ( B2 ) （ 表示 形式 を 標準 に し ます 。 ） 
「 VB 」 だけ で は バージョン が 分かり ませ ん 。 「 VB 6 . 0 」 系 と 「 VB.NET 」 系 で コーディング が 違い ます 。 ※ 何で 開発 し て いる の か くらい は 書き ましょ う 。 
こんにちは。 主 様 、 ２ 回 入り ます よ 。 たとえば 、 2 行 目 と 5 行 目 だっ た と し ます 。 i = 2 かつ j = 5 の 場合 と 、 i = 5 かつ j = 2 の 場合 です 。 同じ i = 1 to 10 と j = 1 to 10 で 、 主 様 、 本当に 、 やり たい こと が できる の でしょ う か 。 もしかして 、 for i = 1 to 10 for j = i to 10 とか では ありません か ？ ソート の 考え方 です 。 
こんにちは。 エクセル で 、 その 程度 で エラー という 場合 、 イベント の ネスト が 発生 し て い ない か 、 確認 し て ください 。 パソコン の メモリ や HDD の サイズ の 問題 で は あり ませ ん 。 リソース を あっという間に 食い 尽くし て しまう 、 コード の 問題 です 。 
Application . OnKey を 使っ て 、 イベント 作る しか ない です ね 。 特定 の セル だけ OnKey で Enter と Tab に イベント 紐 づけ て 、 その イベント で フォーカス を 飛ばし OnKey を 外す 。 ヘルプ https :// msdn . microsoft . com / ja - jp / library / office / ff 197461 . aspx サンプル http:// okwave .jp / qa / q 8243935 . html 
VBA で は 文字 を Unicode で 扱い ます から 、 ANK 文字 で あっ て も １ 文字 は ２ バイト です 。 VBA で は Excel の ワーク シート 関数 と 違い （ 同名 な ので ややこしい です が ） LEFTB , MIDB , RIGHTB 関数 を 使っ て も 「 全角 ５ 文字 分 の 幅 の 文字列 」 を 切り出す という よう な 事 は 出来 ませ ん 。 「 ANSI 形式 に し て 」 と おっしゃっ て い ます から 、 この 事 は 理解 さ れ て いる よう に 思い ます 。 Excel です ので 、 ワーク シート 関数 の MIDB 関数 など が 使える と いい の です が 、 残念 ながら 、 Application . WorksheetFunciton オブジェクト の メンバ に MIDB は あり ませ ん 。 Evaluate メソッド を 使う という の は どうでしょう か 。 例えば 文字列 が 変数 S に 入っ て いる として 、 Application . Evaluate (" MIDB (""" & S & """, 11 , 256 )") の よう に する わけ です 。 ただし 、 半角 と 全角 が 混じっ て いる という こと な ので 、 11 バイト 目 で は なく 10 バイト 目 から 取る 必要 が ある かも しれ ませ ん 。 です ので MID ( S , LEN ( Application . Evaluate (" LEFTB (""" & S & """, 10 )"))+ 1 ) の よう に する の が 無難 で は ない か と 思い ます 。 
If Worksheets ( 1 ). Range (" a1 "). Value = " 5 " Or " 55 ” Then で は なく If Worksheets ( 1 ). Range (" a1 "). Value = " 5 " Or Worksheets ( 1 ). Range (" a1 "). Value = " 55 ” Then 
A1 に 入力 さ れ た 文字列 が 名前 の 一部 に なっ て いる ファイル を E2 以下 に 書き出し ます 。 Sub Test () Dim i As Long , buf As String Dim NM As String Const Path As String = " C :\ Users \ AA \ Desktop \ A フォルダ \" NM = Cells ( 1 , 1 ). Value buf = Dir ( Path & "*.*") Do While buf <> "" If buf Like "*" & NM & "*" Then i = i + 1 Cells ( i + 1 , 5 ) = buf End If buf = Dir () Loop End Sub 
雰囲気 以下 で どう なり ます か 標準 モジュール に 記述 し て 、 処理 対象 の シート を アクティブ に し た 状態 で Samp 1 を 実行 し て み ます Public Sub Samp 1 ()     Dim dic As Object , dicE As Object     Dim vA As Variant , vK As Variant , v As Variant     Dim i As Long , j As Long , k As Long     Set dic = CreateObject (" Scripting . Dictionary ")     Set dicE = CreateObject (" Scripting . Dictionary ")     Application .S creenUpdating = False     With Range (" A1 "). Current Region        For j = 4 To . Columns . Count Step 4           vA = . Columns ( j ). Resize (, 2 ). Value           For i = 2 To UBound ( vA )              If ( vA ( i , 1 ) <> "") Then                 k = dicE ( vA ( i , 1 ))                 If ( k = 0 ) Then                    k = dic E.C ount                    dicE ( vA ( i , 1 )) = k                 End If                 If ( Not dic . Exists ( i )) Then                    dic . Add i , CreateObject (" Scripting . Dictionary ")                 End If                 dic ( i )( k ) = vA ( i , 2 )              End If           Next        Next        ReDim vA ( 1 To . Rows . Count , 1 To dic E.C ount )        For Each v In dicE . Keys           vA ( 1 , dicE ( v )) = v        Next        For Each vK In dic . Keys           For Each v In dic ( vK ). Keys              vA ( vK , v ) = dic ( vK )( v )           Next        Next        Range (. Columns ( 4 ), . Columns (. Columns . Count )). Delete        With . Columns ( 4 ). Resize (, UBound ( vA , 2 ))           . Value = vA           .S ort . Cells ( 1 ), xlAscending _              , Header := xlNo , Orientation := xlSortRows        End With     End With     Columns . AutoFit     Application .S creenUpdating = True     Set dic = Nothing     Set dicE = Nothing End Sub ' 確認 用 簡易 データ 作成 Public Sub testData ()     Dim r As Range     Dim vC As Variant     vC = Array (" たこ焼き ", " お好み焼き ", " コーラ ")     Randomize     Application .S creenUpdating = False     Cells . Delete     For Each r In Range (" A1 : O 30 ")        Select Case r . Row           Case 1              Select Case r . Column                 Case 1 : r . Value = " 氏名 "                 Case 2 : r . Value = " 生年月日 "                 Case 3 : r . Value = " 性別 "                 Case Else                    Select Case r . Column Mod 4                       Case 0 : r . Value = " 食べ物 "                       Case 1 : r . Value = " 好き嫌い "                       Case Else                          r . Value = r . Address ( False , False )                    End Select              End Select           Case Else              Select Case r . Column                 Case 1                    r . Value = Chr ( Asc (" A ") + Int ( 26 * Rnd ()))                 Case 2                    r . Value = Format ( Date + Int ( 1000 * Rnd ()), " yyyymmdd ")                 Case 3                    r . Value = IIf ( Rnd () > 0 . 5 , " 男 ", " 女 ")                 Case Else                    Select Case r . Column Mod 4                       Case 0                          If ( Rnd () > 0 . 5 ) Then                               r . Value = vC ( Int (( UBound ( vC ) + 1 ) * Rnd ()))                          End If                       Case 1                          If ( r . Offset (, - 1 ). Value <> "") Then                               r . Value = IIf ( Rnd () >= 0 . 5 , " 好き ", " 嫌い ")                          End If                       Case Else                          r . Value = r . Address ( False , False )                    End Select              End Select        End Select     Next     Columns . AutoFit     Application .S creenUpdating = True End Sub 
月 、 日 が 各 二 けた と 決まっ て いれ ば 下記 で OK Sub test () Dim i , r , s , t As String i = Range (" A1 "). Value r = Mid ( i , 1 , 4 ) & "/" s = Mid ( i , 6 , 2 ) & "/" t = Right ( i , 2 ) Range (" A1 "). Value = r & s & t End Sub 
時間 の 入力 方法 は （ 将来 的 に は ・ ・ の 記述 が あり ます ） 後回し に する として 。 入力 さ せる シート と 項目 、 出力 し たい シート と 項目 が わかり にくい です 。 Sheet 1 と Sheet 2 が 入力 で Sheet 3 を 作成 し たい の か と 思い まし た が そう だ と 、 代替 の 人 の 名前 は どこ に 入力 さ れる の か が わかり ませ ん 。 ご 自身 も 混乱 さ れ て いる よう です が 、 まず この 入出力 の 項目 を はっきり さ せ ない と 先 へ 進め ない と 思い ます 。 
＞ 違う ワークブック の 中 の 、 違う シート は 、 Boo k2 . xlsx 、 Sheet 2 の 時 の 例 です Sub sample () Dim i With Workbooks (" Boo k2 . xlsx "). Worksheets (" Sheet 2 ") i = Application . Match ( Range (" A3 "). Value , . Columns ( 1 ), 0 ) If Not IsError ( i ) Then . Cells ( i , 2 ). Value = Range (" B4 "). Value End If End With End Sub 
まだ 手直し が 必要 です が 、 一応 でき まし た 。 「 Sheet 1 」 H2 := COUNTIF ( A $2 : A 2 , A 2 ) I 2 := IF ( H2 = 1 , 1 , 0 )+ I 1 J2 := IFERROR ( INDEX ( A : A , MATCH ( ROW ( A1 ), I : I , 0 ), 1 ),"") これら を データ の ある 行 まで 下方 へ ドラグコピー し ます 。 K2 := MATCH ($ J2 , INDIRECT ( ADDRESS ( 1 , 1 )): INDIRECT ( ADDRESS ( 100000 , 1 )), 0 ) これ を J 列 の データ （ 名前 ） が ある ところ まで ドラグコピー し ます 。 L 2 := IFERROR ( MATCH ($ J2 , INDIRECT ( ADDRESS ( 1 + K2 , 1 )): INDIRECT ( ADDRESS ( 100000 , 1 )), 0 ) + K2 ,"") これ を 下方 へ は K 列 と 同じ 要領 で ドラグコピー し ます 。 そして 右 方 へ は データ が 表示 さ れ なく なる まで ドラグコピー し ます 。 「 Sheet 2 」 A3 := IF ( MOD ( COLUMN ()- 1 , 5 )<> 0 ,"", INDIRECT (" Sheet 1 !"& ADDRESS ( INT (( COLUMN ()- 1 )/ 5 + 2 ), 10 ))) 右 方 へ 全員 の 名前 が 出 終わる まで ドラグコピー し ます 。 この 次 が 未 完成 です 。 A 4 := IFERROR ( INDEX ( Sheet 1 ! B : B , INDIRECT (" Sheet 1 !"& ADDRESS ( INT (( COLUMN ()- 1 )/ 5 + 2 ), ROW ( Sheet 1 ! A1 1 ) )), 1 ),"") 下方 へ は データ が 表示 さ れ なく なる まで ドラグコピー し ます 。 右 方 へ は 、 とりあえず E 列 まで ドラグコピー し ます 。 そして C , D , E 列 は 表示 形式 を 00 : 00 に し ます 。 この A 列 から E 列 の 「 Sheet 1 ! B : B , 」 のところ を 「 Sheet 1 !$ B :$ B , 」 に 変更 し て から 、 ５ 列 まとめ て 右 へ コピペ し ます 。 ↓ Sheet 1 の 画像 
500 行 に 満た ない の で あれ ば 、 最終 行 まで を csv に し たら いい の で は ？ 
対象 と する データ は ２ 行 以上 有り ます か ？ 有る の に エラー に なる の でし たら ＰＣ を 再起動 し て み て 下さい 。 Ｗｉｎ ８ 以後 なら 「 完全 シャットダウン 」 し て 下さい 。 
御 望み の こと が よく 解っ て ませ ん が 、 ↓ の よう な 例 は 参考 に なら ない でしょ う か ？ Sub sample () Dim xTime As Date xTime = DateAdd (" n ", 10 , Range (" A1 "). Value ) If Time < xTime Then MsgBox " 期限 時刻 10 分 後 より 前 です " End If End Sub 
コード の 一部 から だけ で は なんとも 言え ない そもそも objIE って の は 変数 な ん だ から その 宣言 型 とか 見 て み ない と なんとも 言え ん ね （ たぶん Dim objIE As InternetExplorer こんな 感じ なんだろう けど 、 推測 だけ で は 回答 でき ない し ） 
以下 で どう なり ます か （ チョコチョコ 書き直し て ます ） Public Sub Samp 3 ()     Dim vA As Variant , vR As Variant , v As Variant     Dim sS As String     Dim i As Long , j As Long , k As Long , n As Long     Const CREP As String = " さん 年齢 "     Const CSP As String = " "     Const CRH As Long = 5     Application .S creenUpdating = False     For j = Range (" B 1 "). Column To Range (" DD1 "). Column        vA = Cells ( 65 , j ). Resize ( CRH ). Value        ReDim vR ( 1 To CRH * 2 , 1 To 1 )        k = 0        For i = 1 To UBound ( vA )           sS = StrConv ( vA ( i , 1 ), vbNarrow )           While ( sS Like "*" & String ( 2 , CSP ) & "*")              sS = Replace ( sS , String ( 2 , CSP ), CSP )           Wend           sS = Replace ( sS , CREP , CSP )           v = Split ( sS , CSP )           If ( UBound ( v ) > 0 ) Then              k = k + 1              vR ( k , 1 ) = Array ( v ( 0 ), Val ( v ( 1 )))           End If        Next        If ( k > 0 ) Then           n = 0           v = " Go "           While ( Not IsEmpty ( v ))              n = n + 1              v = Empty              For i = 1 To k - n                 If ( vR ( i , 1 )( 1 ) > vR ( i + 1 , 1 )( 1 )) Then                    v = vR ( i , 1 )                    vR ( i , 1 ) = vR ( i + 1 , 1 )                    vR ( i + 1 , 1 ) = v                 End If              Next           Wend           For i = k To 1 Step - 1              vR ( i * 2 , 1 ) = vR ( i , 1 )( 1 )              vR ( i * 2 - 1 , 1 ) = vR ( i , 1 )( 0 )           Next        End If        Cells ( 4 , j ). Resize ( CRH * 2 ). Value = vR     Next     Application .S creenUpdating = True End Sub 
EntireRow を 覚え ましょ う 。 Sub Macro 1 () Dim n As Long n = Cells ( Rows . Count , " A "). End ( xlUp ). Row + 1 Range ( Range (" A " & n ), Range (" A3 00 ")). EntireRow .S elect End Sub Sub 一行 で やる なら () Range ( Cells ( Rows . Count , " A "). End ( xlUp ). Offset ( 1 ), " A3 00 "). EntireRow .S elect End Sub 
通常 、 プログラム の 実行 開始 で Application .S creenUpdating = False 終了 時 Application .S creenUpdating = True と し ます 。 これ で 、 Excel は ディスプレイ の 描画 更新 を 行なわ なく なり 、 画面 の チラツキ が なくなり 、 実行 速度 も アップ し ます 。 
IE の 自動 操作 に は 、 HTML ソースコード が 不可欠 な の です が 、 ログイン が 必要 な ページ で は 、 部外者 は 基本的 に 手 が 出せ ませ ん 。 従って 、 こう いっ た 考え方 に なる 、 という 回答 に なり ます 。 まず 、 Firefox や Chrome に ある 、 HTML の 「 要素 を 調査 」 という 機能 を 使える よう に し て ください 。 ブラウザ を インストール すれ ば 、 右クリック で 出 て くる はず です 。 これ で 、 各 WEB パーツ が どの ソース に 該当 する の か を 調べる こと が でき ます 。 次に 、 上記 機能 を 使い 、 「 CSV 取込 」 タブ が どの タグ な の か を 調べ 、 その タグ を 取得 後 に クリック 、 という コード を 作っ て ください 。 その後 の ページ 移動 時間 です が 、 これ は 、 こちら で は どの よう に 動く の か が 分から ない ので 、 適当 な 時間 を 作っ て ください 。 ページ 移動 後 、 参照 ボタン を 押し ます 。 これ は 恐らく 、 FILE 属性 の INPUT タグ です 。 上記 と 同様 に タグ の ソース を 探し 、 その タグ を 取得 し て クリック する コード を 作っ て ください 。 ただし 、 これ は 後 に 記述 する Sendkeys の 動作 の 関係 上 、 JavaScript に 翻訳 し て 実行 さ せる 必要 が あり ます 。 後で 返信 し たい と 思い ます ので 、 とりあえず は VBA で 作成 し て ください 。 そして 次に 、 クリップボード に 文字列 を 送り 、 出 て き た ダイアログ に 「 Ctrl + V 」 で 貼り 付け 、 Enter キー を 押し ます 。 これ に Sendkeys を 使い ます 。 まずは 、 クリップボード に 文字列 を 送り込み ます 。 Dim clip As DataObject clip .S etText " C :\ EDIDATA \ RCV \ シーワ \ SW _ 0525 . csv " clip . PutInClipboard そして 、 Sendkeys を 使い 、 予定 し た キー 操作 を 行ない ます 。 ' ダイアログ が 出る まで 待つ Application . Wait [ Now ()+" 00 : 00 : 02 "] ' Ctrl + V Sendkeys "^ V " ' 少し 待つ Application . Wait [ Now ()+" 00 : 00 : 01 "] ' Enter Sendkeys "{ ENTER }" ' 少し 待つ Application . Wait [ Now ()+" 00 : 00 : 01 "] そして 、 「 取込 」 ボタン を 押し ます 。 これ は 、 これ まで と 同様 に 該当 タグ を 調べ て 、 取得 ・ クリック する コード を 作成 し て ください 。 その後 の ログアウト について は 、 どう いっ た 画面 に なる か が 分から ない ので 、 ボタン が 出 て いる なら ば 動揺 に 作成 する 等 、 対応 し て ください 。 
ＣＳＶ ファイル は , で 区切っ た テキストファイル で 拡張子 が CSV と 言う 定義 が 有る だけ です 。 データ を ” で 囲う か どう か で エクセル が 規定 の 状態 で 開い た 時 の 結果 は 異なり ます 。 ＶＢＡ の 勉強 の 為 に 行う なら 止め はしません が 、 テキストエディタ で ＣＳＶ ファイル を 開け ば違い は 一目瞭然 です 。 
> という コード を 付け加える こと で 解消 する こと が 出来 まし た 。 お 示し の 対策 で 解消 する こと は 考え られ ませ ん 。 シート モジュール の プログラム が なん か の 影響 を 与え て いる の でしょ う ね 。 > 他 に 良い 方法 が あれ ば 教え て いただけ ない でしょ う か 。 他 の プログラム の 存在 が あり 、 その プログラム の 処理 内容 が 解ら ない 以上 、 対応 策 を 提案 し にくい です 。 そもそも 、 「 Select すれ ば シート の 保護 が 解ける 」 という 事 自体 、 シート の 保護 を 掛ける 意味 が ある の か 疑わしく あり ませ ん か ？ 保護 制御 自体 見直す 方 が 良い かも 。 
VBA から なら 、 普通に Workbooks . Open " https ://------------/ dat a/a aa . xls " で 開け ませ ん か ？ ただ 、 使用 頻度 次第 です が 、 月 50 個 で 3年 間 分 なら 、 ローカル に ダウンロード し た 方 が いい かも しれ ませ ん 。 ダウンロード も API の URLDownloadToFile を 使え ば 自動的 に できる と 思い ます 。 
書か れ て いる コード は 改行 が おかしく なっ て い ます 。 エラー に なら ない よう に 改行 を 入れ て テスト し て み まし た 。 最後 の ほう の SaveAs の 「 FileFormat := xlWorkbookNomal 」 は 「 FileFormat := xlWorkbookNormal 」 の つづり 間違い だ と 思い ます ので そこ は 修正 し まし た 。 結果 、 ファイル は 作成 さ れ まし た 。 ただし 開く こと は でき ませ ん でし た 。 これ は 、 マクロ 有効 の ブック な ので SaveAs の FileFormat は 「 xlWorkbookNormal 」 で は なく 「 xl O pen XMLWorkbookMacroEnabled 」 と し なけれ ば なら ない こと が 原因 だ と 思い ます 。 （ もしくは FileFormat を 省略 ） いずれ に し て も 、 ファイル が 作成 さ れ まし た ので 、 プログラム の 問題 で は ない の かも しれ ませ ん 。 たとえば 、 該当 の フォルダ に対して 書込み の 権限 が ない とか 、 ディスク が いっぱい で 書き込め ない と か 。 On Error Resume Next で エラー を 無視 し て い ます ので 、 それ を コメント に （ あるいは 削除 ） し て エラー が 出 ない か 確認 し て は どうでしょう か 。 
Sheet 2 の C3 セル に = SUMIF ( Sheet 1 ! C $1 : I $1 , 1 , Sheet 1 ! C 6 : I 6 ) と 数式 を 入れ て 下 に コピー し ます 。 I から 右 に も データ が ある 場合 は Sheet 1 に は 他 の 表 が ない という 前提 で 全 列 計算 に 入れ ます 。 SUMPRODUCT 関数 の よう に 処理 が 重く なる こと は ない です 。 = SUMIF ( Sheet 1 !$ 1 :$ 1 , 1 , Sheet 1 ! 6 : 6 ) 下 に コピー し ます 。 
> シート １ の 特定 セル に 検索 値 を 入力 する と シート 1 の どの セル に 検索 値 を 入力 する の でしょ う か ？ 次 の よう な イメージ です か ・ ・ 。 シート 1 の A1 に 「 1001 」 と 入力 する と 、 VLOOKUP 関数 を 用い て 、 シート 3 の A 列 の 中 から 「 1001 」 を 検索 し 、 見つかれ ば シート 3 の 1001 の 行 の B 、 C 列 の データ を シート 1 、 および 印刷 用 の シート 2 に も 反映 さ れる よう に し て いる 。 マクロ の ボタン を 押す と 、 結果 と なる 値 が 表示 さ れ た シート 2 を 印刷 し 、 同時に シート 3 の A 列 で 「 1001 」 の 値 の ある 行 の D 列 に 本日 の 日付 を 入力 する ・ ・ 。 違っ て いれ ば 、 補足 し て ください 。 
Dim i As Integer = ListBox 1 . IndexFromPoint ( e . Location ) If i = - 1 Then Exit Sub Else ListBox 1 .S etSelected ( i , True ) End Sub ↓ の ６ － ５ が 求める もの に 近い の かも http:// homepage 1 . nifty . com / rucio / main / dotnet / Class Library / L 007 _ Syst ... 
DoCmd . PrintOut acPrintAll , , , , 梱包 数量 で ブレーク で 止め た 時 、 梱包 数量 は 幾つ に なっ て い ます か ？ 
残念 ながら マクロ で は 「 赤 に なる 」 という タイミング は 検知 する こと が 出来 ませ ん 。 単純 に B ３ 、 B ６ 、 B 17 、 B ２ ０ の 数字 が 赤 だっ たら A ３ 、 A6 、 A1 7 、 A ２ ０ の 数字 も 赤 に する 、 という マクロ でし たら 以下 の コード に なり ます 。 Private Sub Sample () Dim rng As Range For Each rng In Range (" B 3 , B 16 , B 17 , B2 0 "). Cells If rng . Font . Color = 255 Then rng . Offset (, - 1 ). Font . Color = 255 End If Next End Sub 
こんばんは 条件 分岐 で テキストボックス が 空 の 場合 は TextBox 1 . Enabled = False で 使用 不可 に でき ます 。 Public Class Form 1 Private Sub f () Handles MyBase .S hown Button 1 . Text = " 入力 し たら ボタン を 押し て ね 。 " End Sub Private Sub Button 1 _ Click ( sender As Object , e As EventArgs ) Handles Button 1 . Click If TextBox 1 . Text = "" Then TextBox 1 . Enabled = False End If End Sub End Class 
例えば A 列 から L 列 まで の 間 で そのよう な こと が ある として 色 を 付ける の でし たら A 列 から L 列 を 選択 し て から 「 条件 付き 書式 」 で 「 新しい ルール 」 を 選択 し ます 。 「 数式 を 使用 し て … 」 に チェック を し て から 、 下 の 窓 に は 次 の 式 を 入力 し ます 。 = AND ( COUNTIF ($ A1 : A1 ,"○"), COUNTIF ( A1 :$ L 1 ,"★")) 「 書式 」 を クリック し 「 塗りつぶし 」 の タブ で 好み の 色 を 設定 し て OK すれ ば よい でしょ う 。 どの 行 で あっ て も 同じ 行 に ○ と ★ が あれ ば その間 の セル に 色 が 付き ます 。 
> 自身 の PC 表示 設定 で は 、 拡張子 は 非表示 な ので 出 ない もの と これ は 表示 上 の 設定 だけ で ファイル の 名前 自体 は 拡張子 付き で ファイル 名 に なっ て い ます 。 ThisWorkbook . Name に は 拡張子 も つい て い ます から 、 そこ から ファイル 名 だけ 取り出さ なく て は なり ませ ん 。 質問 文 は 全部 が 書い て い ない ので 、 その 部分 だけ です 。 ThisWorkbook は マクロ 付き ブック な ので 拡張子 は 「 . xlsm 」 だ として 、 その 部分 だけ 書き ます 。 ファイル 名 は PA & "\" & Left ( ThisWorkbook . Name , Len ( ThisWorkbook . Name ) - 5 ) & Worksheets ( i ). Name & ". xls " 
VBA 初心者 です 。 よろしくお願いします 。 図 の 左 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1216023953 ... 上記 で の 、 Samp 1 / Samp 2 やっ て み て ダメ だっ た の でしょ う か 別 シート へ の 集計 でし た よ ね 
コード 例 です 。 Sub Sample () Dim Rng As Range Dim buf As String Dim Num As Long Dim i As Long Dim Score As Long '← 点数 に 小数点 以下 が あれ ば 「 As Double 」 Label 1 : buf = Application . InputBox (" 人数 を 入力 し て ください 。 ") If buf = " False " Then Exit Sub If Not IsNumeric ( buf ) Then MsgBox " 入力 値 が 不正 です 。 " & vbLf & " 数値 を 入力 し て ください 。 " GoTo Label 1 End If Num = buf Set Rng = Active Cell For i = 1 To Num Label 2 : buf = Application . InputBox ( i & " 人目 の 点数 を 入力 し て ください 。 ") If buf = " False " Then GoTo Label 3 If Not IsNumeric ( buf ) Then MsgBox " 入力 値 が 不正 です 。 " & vbLf & " 数値 を 入力 し て ください 。 " GoTo Label 2 End If Score = buf If Score * ( Score - 150 ) > 0 Then Score = - 5 Rng . Value = Score Label 3 : Set Rng = Rng . Offset ( 1 ) Next End Sub 
以下 で どう なり ます か Public Sub Samp 1 ()     Dim dic As Object     Dim r As Range     Dim vA As Variant     Dim i As Long     Const CF As String = _           "= IF ( COUNTIF ( RC4 : R C5 ,""* 小口 *""), 1 ,"""")"     Set dic = CreateObject (" Scripting . Dictionary ")     Application .S creenUpdating = False     With ActiveSheet . UsedRange        With . Resize (, . Columns . Count + 1 )           vA = . Columns ( 1 ). Value           With . Columns (. Columns . Count )              . FormulaR 1 C1 = CF              . Value = . Value              For Each r In .S pecialCells ( xlCellTypeConstants )                 dic ( vA ( r . Row , 1 )) = Empty              Next           End With           vA ( 1 , 1 ) = ""           For i = 2 To UBound ( vA )              If ( dic . Exists ( vA ( i , 1 ))) Then                 vA ( i , 1 ) = i              Else                 vA ( i , 1 ) = ""              End If           Next           i = . Columns . Count           . Columns ( i ). Value = vA           . RemoveDuplicates i , xlNo           . Columns ( i ). ClearContents        End With     End With     Application .S creenUpdating = True     Set dic = Nothing End Sub 
Sub test () Dim x As Long , i As Long Cells ( 2 , 6 ) = Cells ( 2 , 1 ) Cells ( 2 , 7 ) = Cells ( 2 , 2 ) Cells ( 2 , 8 ) = Cells ( 2 , 3 ) x = 2 For i = 3 To Cells ( Rows . Count , 3 ). End ( xlUp ). Row If Cells ( i , 1 ) = "" Then Cells ( x , 8 ) = Cells ( x , 8 ) + Cells ( i , 3 ) Else x = x + 1 Cells ( x , 6 ) = Cells ( i , 1 ) Cells ( x , 7 ) = Cells ( i , 2 ) Cells ( x , 8 ) = Cells ( i , 3 ) End If Next i End Sub 
Thisworkbook 上 の シート を コンボボックス に 追加 し た うえ で 、 選択 可能 に し た フォーム を 呼び出し 、 OK ボタン を クリック し た 際 に シート 分割 を 呼び出す 際 に 選択 し た シート 名 を 渡す もの を 作っ て み まし た （´∀｀） 補足 です が 、 なにか 特定 の シート を 名前 で 指定 し たい 場合 Sheets (" 対象 の シート 名 ") で アクセス 可能 です 。 high . s1 . xrea . com / sample 10 . xls 
ActiveWorkbook .S aveAs Filename := varFile , FileFormat := xlCSV , _ CreateBackup := False , Local := True Rows ( Range (" J " & Rows . Count ). End ( xlUp ). Row + 1 & ":" & 206 ). ClearContents ↓ With Cells ( Rows . Count , " J ") Range (. End ( xlUp ). Offset ( 1 ), . Cells ). EntireRow . Clear End With ActiveWorkbook .S aveAs Filename := varFile , FileFormat := xlCSV , _ CreateBackup := False , Local := True という こと です か ？ 
下記 で I 10 ～ I 32 の 処理 が できる と 思い ます 。 念の為 ファイル の バックアップ を 作成 し て から 試し て 下さい 。 Sub 印刷 () Dim i As Integer For i = 10 To 32 Range (" I " & i ). Select Selection . Copy Range (" B7 "). Select Selection . PasteSpecial Paste := xlPasteValues , Operation := xlNone , SkipBlanks _ := False , Transpose := False ActiveWindow .S electedSheets . PrintOut Copies := 1 , Collate := True , _ IgnorePrintAreas := False Next i End Sub 
いくつ も 設計 する と 分かり ます が 、 仕様変更 や 機能 追加 が 多い の は 、 入力 画面 、 売り上げ 計算 など の 集計 機能 、 ファイル 出力 や 印刷 など の 帳票 出力 です 。 これら に対して は 最初 から 、 種類 が 増え て も 対応 し やすい よう に 設計 する こと が 多い です 。 集計 する 種類 や 帳票 の 種類 が 最初 から 2 種類 以上 ある 場合 は 特に です 。 > どの よう な 基準 で Function や Class に する の か 、 手本 や 基準 など は ある の でしょ う か ？ 難しい かも しれ ませ ん が 、 「 デザインパターン 」 を 学ば れる と 良い と 思い ます 。 「 オブジェクト指向 における 再利用 の ため の デザインパターン ( 単行本 ) 」 http:// www . amazon.co.jp / gp / offer - listing / 4797311126 
> B . xlsm の Sheet 1 の A 列 と B 列 を 、 A . xlsm の Sheet 2 の C 列 と D 列 に コピー する Sub 一 例 です () Workbooks (" B . xlsm "). Worksheets (" Sheet 1 "). Range (" A : B "). Copy _ Workbooks (" A . xlsm "). Worksheets (" Sheet 2 "). Range (" C : D ") End Sub 
検索 部分 だけ の 回答 です 。 削除 や 書き込み など も そう です が 検索 も コマンド ボタン を 使っ た ほう が スムーズ です 。 ユーザー フォーム に コマンド ボタン を 挿入 し Caption を 「 Search 」 とか 「 検索 」 とか に し て おく と いい です 。 検索 ワード 用 が TextBox 1 で あと は 順番 に TextBox 2 ~ TextBox 11 という 配置 です 。 コマンド ボタン を 右クリック し て コード を 書き ます 。 Private Sub CommandButton 1 _ Click () Dim n , i As Long n = Application . Match ( TextBox 1 . Value * 1 , Sheets (" Sheet 1 "). Columns ( 1 ), 0 ) If IsError ( n ) Then MsgBox " 該当 番号 は 見つかり ませ ん ": Exit Sub For i = 2 To 11 UserForm 1 . Controls (" textbox " & i ). Text = Sheets (" Sheet 1 "). Cells ( n , i - 1 ). Value Next End Sub 他 に 標準 モジュール に Sub フォーム 起動 () UserForm 1 .S how vbModeless End Sub と ユーザー フォーム を 起動 する コード を 書い て おく と セル の 編集 も できる よう に なり ます 。 この コード は 図形 など に マクロ の 登録 し て シート に 置い て おく と いい です 。 感想 として は それほど 難しい コード で は ない と 思い ます 。 削除 など も 上 の コード の 変数 ｎ を 使え ば Rows ( n ). Delete で 簡単 に 削除 でき ます 。 ただ 新規 の 場合 は sheet 2 に 同様 の 項目 で 入力 とか の 意味 は よく わかり ませ ん 。 普通 新規 は 最終 行 の 下 に 書き 足し て いく の だ と 思い ます が ・ ・ ・ 
> 以下 の 条件 の もの を フィルター によって 非表示 に し たい ご 承知 の 通り 、 列 の 間 の 条件 は 、 AND 結合 。 OR は 使え ない です よ ね ？ な ので 、 フィルター を 使う なら 、 作業 列 を 設け 条件 式 を 組み込み 、 そこ を フィルタリング し なきゃ だめ 、 という こと に なり ます ね 。 ↓ は A ～ H 列 の 表 に対し 、 I 列 を 作業 列 に し た 例 です 。 1 行 目 は 項目 名 の 行 。 表 の 最終 行 は A 列 で 判定 。 Sub 一 例 です () Dim i As Long Const xFormula As String = _ "= OR ( AND ( B2 <> SUBSTITUTE ( B2 , "" ＡＡＡ "",""""), D2 ="" 1 - 100 ""), AND ( OR ( E2 =""○"", F2 =""○""), G2 <> H2 ))" i = Cells ( Rows . Count , 1 ). End ( xlUp ). Row Range ( Cells ( 2 , " I "), Cells ( i , " I ")). Formula = xFormula Columns (" I "). AutoFilter Field := 1 , Criteria 1 := False End Sub 
ご 質問 の 方法 は 、 ZIP ファイル を フォルダ として 扱える という 、 Windows 標準 の 機能 を 利用 し た もの です 。 単純 に 、 フォルダ オブジェクト を 取得 し 、 その 中 の ファイル を コピー する 、 という 体 な ので 、 パスワード 引数 など あり ませ ん 。 従って 、 パスワード 付き ZIP ファイル を 解凍 する の で あれ ば 、 Sendkeys 等 を 使っ て 、 力 技 で パスワード を 送り込ま なけれ ば なり ませ ん 。 VBS だ と 、 その 辺り の 動作 は 怪しい です し 、 UWSC あたり を 使っ た 方 が 楽 かも しれ ませ ん 。 UWSC で も 、 同様 に COM オブジェクト を 使っ て 処理 が でき ます し 、 はっきり と ターゲット を 絞っ た ウインドウ 操作 も 可能 です 。 
どの 程度 まで 勉強 し たい か と 、 あなた 自身 の パソコン 全般 の 知識 と プログラミング の 知識 に も より ます ので 、 大きめ の 書店 へ 行っ て 実際 に 手 に 取っ て み て みる こと を お勧め し ます 。 
前もって 言い ます が 、 ストレート な 回答 じゃ あり ませ ん 。 VBA で でき ない 処理 じゃあ ない ん です が 、 あくまで VBA で やる の か ？ という こと な ん です 。 こういう 処理 は ACCESS で RDB 使っ た 方 が 楽 な ん です よ 。 各 PC に クライアント 画面 を 配布 し て 、 サーバー と なる PC 上 の RDB に 更新 かけ させる の が 一般的 。 これ まで EXCEL で やって来 た から その 延長線 上 で やり たい の は 分かり ます が 、 大きな 声 を 出せ ば 全体 に 伝わっ て い た 企業 規模 から 脱し て 大きく なっ て いる 企業 な ん でしょ う ？ そろそろ 作業 の システム化 を 考える レベル な の です 。 VBA で ルール を 守ら ない 人 の リカバリ を する の で は なく 、 そもそも ルール を 破れ ない システム化 を する べき な の で は ない か な ？ 質問 の 件 は DIR 関数 、 FOR EACH 文 、 INSTR 関数 で 対応 でき ます 。 
Sub test () Dim i As Long , j As Long , ij As Long For i = 1 To 10 For j = 1 To 10 If Cells ( i , j ). Interior . Color = 0 Then ij = ij + 1 End If Next j If ij = 10 Then MsgBox i & " 行 目 は つながっ て い ます " ij = 0 Next i ij = 0 For i = 1 To 10 For j = 1 To 10 If Cells ( i , j ). Interior . Color = 0 And i = j Then ij = ij + 1 End If Next j Next i If ij = 10 Then MsgBox " 斜め 右 下 方向 でも つながっ て い ます 。 " End If ij = 0 For i = 10 To 1 Step - 1 For j = 1 To 10 If Cells ( i , j ). Interior . Color = 0 And i + j = 11 Then ij = ij + 1 End If Next j Next i If ij = 10 Then MsgBox " 斜め 右 上 方向 でも つながっ て い ます 。 " End If End Sub 
こんにちは。 管理 ファイル の シート 1 に 「 更新 ボタン 」 を 設置 し て 、 クリック イベント に コード を 記述 です 。 ターゲット ファイル は v 指定 データファイル 名 = " ドライブ 名 \ ファイル 名 . xlsx " ネットワーク ドライブ は 、 正しく 設定 し て 、 ターゲット の ファイル に 正しく パス が 通る よう に し て ください 。 VBA は 、 v 1 = dir ( v 指定 データファイル 名 ) if len ( v 1 )= 0 then なかっ た 処理 else あっ た 処理 set w 1 = application . workbooks . open ( v 指定 データファイル 名 ) v 特定 セル = w 1 .s heets ( 特定 シート ). range ( 特定 セル ). value if v 特定 セル =" まるまる " then セル = 色 の 変化 。 else セル = 色 の 変化 。 end if w 1 . close false と まあ 、 書い て いる 流れ だ と 、 こん か 様子 に なり ます 文章 が ふわーーー っと し て いる から 、 コード も ふわっ と し て ます 。 主 様 、 仕様 として 明確 に する の は 、 ターゲット ブック に対する パス を コンピュータ から 、 正しく ネットワーク ドライブ の 指定 が 必要 という こと 、 正しい ファイル 名 、 シート 名 セル の 座標 が 必要 です 。 セル の 色 の 変化 は 、 「 マクロ の 自動 記録 」 で でき た もの を 使っ て ください 。 あと 、 ブック の 更新日 時 を 取得 し て 、 その 変化 で 、 ブック を 開く 、 という よう に する の が 、 よく ある 考え方 です 。 仕様 、 煮詰め て ください 。 
使用 目的 や 使い方 さえ 間違え なけれ ば 、 VB だって 十 分 使える と 思う の です が 。 。 。 何故 そんなに 毛嫌い さ れる の でしょ う か ？ 理由 を お 聞か せ ください 。 
仕事 で 使わ れる の です から 、 自前 で 作成 でき ない 場合 は 費用 を 負担 し て 外注 さ れる こと を お勧め し ます 。 
以下 の コード でいか が でしょ う か ？ Option Explicit Sub チェック () Dim tbl As Range , rng As Range Dim var As Variant , match As Boolean ' 判定 用 の テーブル の セル 範囲 を 設定 する Set tbl = Worksheets (" Sheet 1 "). Columns (" E : F ") ' 一旦 選択 さ れ て いる セル 範囲 の 文字 色 を 自動 に 戻す Selection . Font . Color Index = xl Automatic ' 選択 さ れ て いる セル 範囲 を チェック する For Each rng In Selection ' 2 列 に 渡っ て 値 が 入っ て いる セル を チェック 対象 と する If rng . value <> "" And rng . Offset ( 0 , 1 ). value <> "" Then match = False ' 判定 テーブル 内 に 存在 する か チェック する On Error Resume Next var = Nothing var = Application . WorksheetFunction . VLookup ( rng . value , tbl , 2 , 0 ) On Error GoTo 0 If VarType ( var ) <> vbError Then ' 組み合わせ が 一致 し て いる か チェック する If rng . Offset ( 0 , 1 ). value = var Then match = True End If End If ' 組み合わせ が 一致 し て い なけれ ば 文字 色 を 赤 に する If Not match Then rng . Resize (, 2 ). Font . Color = RGB ( 255 , 0 , 0 ) End If End If Next rng End Sub 
DISK PLUS に は DISK PLUS 用 の アカウント を 取得 し て ください バンビジュ の アカウント と は 別 です 
テスト し て い ませ ん が 、 wd .S ections ( 1 ). Headers ( wdHeaderFooterPrimary ). Shapes . Range (" 世帯主 "). TextFrame . TextRange . Text = " 指定 し た 言葉 " とすれば でき ませ ん か 。 
getElementsByName は 、 < div name =" sample "> の よう に 、 NAME 属性 値 を 元 に タグ を 集める 命令 です 。 取得 しよ う と し て いる タグ に は NAME 属性 が あり ませ ん ので 、 意味 が あり ませ ん 。 どの よう な ページ 構成 な の か が 分から ない ので 、 少し 無駄 が ある 方法 を 提示 し ます 。 Set tmp = objIE . document . getElementsByTagName (" meta ") For Each t In tmp If ( t . getAttribute (" property ")=" example ") Then msg = t . getAttribute (" content ") Exit For End If Next 何 番目 の meta タグ か が 分かっ て いれ ば 、 もっと 単純 に でき ます 。 
以下 で どう なり ます か 標準 モジュール に 記述 し て 実行 し て み ます ※ ４ 階層 限定 に は なっ て ませ ん Public Sub Samp 1 ()     Dim dic As Object     Dim vA As Variant     Dim i As Long , j As Long , k As Long , n As Long     Set dic = CreateObject (" Scripting . Dictionary ")     With Range (" A1 "). Current Region        With . Offset ( 1 )           vA = . Value           For i = 1 To UBound ( vA )              For j = 2 To UBound ( vA , 2 )                 If ( vA ( i , j ) <> "") Then                    n = dic ( j )                    If ( n > 0 ) Then                       For k = j + 1 To UBound ( vA , 2 )                          If ( dic . Exists ( k )) Then                               dic . Remove k                          End If                       Next                    End If                    dic ( j ) = n + 1                    vA ( i , 1 ) = Join ( dic . Items , "-")                    Exit For                 End If              Next           Next           With . Columns ( 1 )              . NumberFormatLocal = "@"              . Value = vA           End With        End With     End With     Set dic = Nothing End Sub 
VC++ ランタイム の 配布 ページ で は vc _ redist . x64 . exe と vc _ redist . x86 . exe の 2つ が 配布 さ れ て い ます が 、 両方 とも インストール し まし た か ？ 通常 の PC 向け Windows の 64 bit 版 で は 、 64 bit ( x64 アーキテクチャ ) プログラム と 32 bit ( x86 アーキテクチャ ) プログラム の 両方 を 動かす こと が 出来 ます 。 そして 、 動かす 対象 の プログラム が 64 / 32 bit の どちら で ある か によって 必要 な ランタイム ( 再 頒布 可能 パッケージ ) も 変わっ て き ます 。 ( 単に OS の 64 / 32 bit と 合わせれ ば 良い わけ で は あり ませ ん 。 ) もし 片方 の ランタイム しか インストール し て い ない の で あれ ば 、 もう 一方 も インストール し て み て は どうでしょう か 。 
昔 は 基本的 に クエリ で 処理 する の を 進め られ て 覚え まし た が 、 実際 の 業務 で 作る と 、 単価 変更 が ある ため 、 その 時点 で の 単価 を 記憶 し て い なけれ ば なら ず 、 最近 は ( かなり 前 の 話 )、 ハードディスク の 容量 や PC に 搭載 さ れ た メモリ も 増え てる ので 、 処理 速度 も 上がっ てる ので クエリ でも いい かも しれ ない けれど 、 単価 や 金額 は フィールド に 埋め込ん で い まし た 。 個人 的 な 見解 です 。 だいたい 、 バックアップ に USBメモリ と 言う 時代 だ から 
Sub Macro () Dim AllData As Variant Dim i As Long i = 1 Do While Cells ( i , 1 ). Value <> "" AllData = Split ( Cells ( i , 1 ). Value , " ") Cells ( i , 1 ). Resize (, UBound ( AllData ) + 1 ). Value = AllData i = i + 1 Loop End Sub 
Backspace や Delete による 削除 は 入力 扱い で は ない よう で 「 可能 で は ない 」 と なり ます 。 VBA 使え ば 簡単 に 対応 できる の だ けれど 。 VBA を 使用 し たく ない と の こと です が 、 規則 で 使っ て は いけ ない の で なけれ ば 使っ た 方 が 格段 に 使い勝手 が 増し ます し 手作業 と は 比べ物 に なら ない 処理 力 も 得 られる よう に なり ます よ 。 最初 が とっつき にくい の は 確か です けど ね 。 
以下 の コード で どうでしょう か 。 Option Explicit Sub Sample () Dim FSO As Object , bkName As String , sCode As Variant Dim fName As Variant , fPath As String Dim bk1 As Workbook , bk 2 As Workbook Dim st 1 As Worksheet , st 2 As Worksheet Dim r1 As Long , r2 As Long Application .S creenUpdating = False Set FSO = CreateObject (" Scripting . FileSystemObject ") Set bk1 = Workbooks . Add Set st 1 = bk1 . Worksheets ( 1 ) r1 = 1 fName = Application . GetOpenFilename ( FileFilter :=" Excel ファイル (*. xls ),*. xls ") If VarType ( fName ) = vbBoolean Then Exit Sub If fName Like "* 集計 *" Then Exit Sub Set bk 2 = Workbooks . Open ( fName ) fPath = bk 2 . Path bkName = FSO . GetBaseName ( bk 2 . Name ) sCode = "" On Error Resume Next sCode = WorksheetFunction . VLookup ( bkName , ThisWorkbook . Worksheets (" マスタ "). Range (" A : B "), 2 , False ) On Error GoTo 0 For Each st 2 In bk 2 . Worksheets For r2 = 2 To st 2 . Range (" A " & st 2 . Rows . Count ). End ( xlUp ). Row If st 2 . Range (" D " & r2 ). Value = " A " Then st 1 . Range (" A " & r1 ). Value = st 2 . Range (" A " & r2 ). Value st 1 . Range (" B " & r1 ). Value = st 2 . Range (" B " & r2 ). Value st 1 . Range (" C " & r1 ). Value = st 2 . Range (" C " & r2 ). Value st 1 . Range (" D " & r1 ). Value = st 2 . Range (" D " & r2 ). Value st 1 . Range (" E " & r1 ). Value = sCode st 1 . Range (" F " & r1 ). Value = " " r1 = r1 + 1 End If Next r2 Next st 2 bk 2 . Close False Application . DisplayAlerts = False bk1 .S aveAs fPath & "\" & bkName & ". csv ", xlCSV bk1 . Close False Application . DisplayAlerts = True Application .S creenUpdating = True End Sub 
for ～ do ( の 閉じ 括弧 側 を ) | CLIP に すれ ば 流し込める や も 。 
作業 列 を 使っ て 対応 し ます 。 シート 1 は お 示し の 通り の 表 で A1 セル から F1 セル まで に は 項目 名 が ある と し ます 。 J2 セル に は 次 の 式 を 入力 し て 下方 に ドラッグ コピー し ます 。 = IF ( A 2 ="","", IF ( COUNTIF ( A $2 : A 2 , A 2 )= 1 , ROUNDDOWN ( MAX ( J $1 : J 1 ),- 3 )+ 1000 , ROUNDDOWN ( INDEX ( J $1 : J 1 , MATCH ( A 2 , A $1 : A1 , 0 )),- 3 )+ COUNTIF ( A $1 : A1 , A 2 ))) その後 に シート 2 に 移っ て 2 行 目 に 名前 を 表示 する として A 2 セル に は 次 の 式 を 入力 し て 右 横方向 に ドラッグ コピー し ます 。 = IFERROR ( IF ( MOD ( COLUMN ( A1 ), 5 )= 1 , INDEX ( Sheet 1 !$ A :$ A , MATCH ( ROUNDUP ( COLUMN ( A1 )/ 5 , 0 )* 1000 , Sheet 1 !$ J :$ J , 0 )),""),"") A3 セル に は 次 の 式 を 入力 し て 右 横方向 に ドラッグ コピー し た のち に 下方 に も ドラッグ コピー し ます 。 = IFERROR ( INDEX ( Sheet 1 !$ B :$ F , MATCH ( ROUNDUP ( COLUMN ( A1 )/ 5 , 0 )* 1000 + ROW ( A1 )- 1 , Sheet 1 !$ J :$ J , 0 ), MOD ( COLUMN ( A1 )- 1 , 5 )+ 1 ),"") なお 、 時間 が 表示 さ れる 列 に は 時刻 の シリアル 値 が 表示 さ れ ます ので それら の 列 を 選択 し て から セル の 表示 形式 で 「 時刻 」 から 好み の 表示 に 変え ます 。 なお 、 シート 1 の 作業 列 が 目障り でし たら その 列 を 選ん で 右クリック し 「 非表示 」 を 選択 すれ ば よい でしょ う 。 
Range (" A1 : K " & 最終 行 ). Sort Columns (" A "), xlAscending , Header := xlYes Range (" A1 : K " & 最終 行 ). Sort Columns (" C "), xlAscending , Header := xlYes ↓ Range (" A1 : K " & 最終 行 ). Sort Key 1 := Range (" A1 "), Order 1 := xlAscending , Key 2 := Range (" C1 "), Order 2 := xlAscending , Header := xlYes 
１つ め の For ~ Next 文 が 無茶苦茶 。 ２つ め も 疑問 だらけ 。 Range (" E2 3 : AH 36 "). Value の 戻り値 は 、 配列 に なり ます 。 素直 に 、 ワーク シート 関数 の SUM 関数 を 起動 し ましょ う 。 Sub Test 1 () Dim TmpSheet As Worksheet , i As Integer Dim ws As Worksheet Dim xCur As Range Set xCur = Selection Set TmpSheet = Worksheets . Add ( After := Sheets ( Sheets . Count )) With T mpSheet For i = 1 To Sheets . Count - 1 '●↓ ここ の 箇所 ↓ もともと セル 1つ 指定 だっ た の を 範囲 指定 に 変更 し まし た ● . Cells ( i , 3 ). Value = Application .S um ( Worksheets ( i ). Range (" E2 3 : AH 36 ")) Next For Each ws In Worksheets Cells ( ws . Index , 1 ) = ws . Name Next 
ユーザー フォーム の コマンド ボタン は 、 シート に 配置 する ボタン で たとえる と 、 フォーム コントロール の ボタン で は なく 、 ActiveX の ボタン の よう な もの です 。 ボタン に マクロ を 登録 する の で は なく 、 フォーム の モジュール に イベント の マクロ を 記述 し ます 。 たとえば 、 コマンド ボタン A を クリック し た 時 の マクロ は 、 ユーザー フォーム の モジュール に Private Sub コマンド ボタン A _ Click () End Sub で 記述 し ます 。 質問 の 例 で は 、 以下 の よう に 記述 し ます 。 Private Sub コマンド ボタン A _ Click () ThisWorkbook . Worksheets (" Sheet 1 "). Range (" A1 "). Value = " ボタン A ＝ 1 " Call Macro 100 End Sub Private Sub コマンド ボタン B _ Click () ThisWorkbook . Worksheets (" Sheet 1 "). Range (" A1 "). Value = " ボタン B ＝ 2 " Call Macro 100 End Sub 
以下 で どう なり ます か 標準 モジュール に 以下 を 記述 し 、 Samp 1 を 実行 し て み ます ※ Interior . Color Index で 色 指定 し て ます が 、 Interior . Color に する とか 適宜 変更 し て み て ください Public Sub Samp 1 ()     Dim rng As Range , r As Range     Dim sAdr As String     Set rng = Worksheets (" マスター "). Range (" A1 ")     With Worksheets (" データ "). UsedRange        . Interior . Color Index = xlNone        While ( rng . Value <> "")           Set r = . Find ( rng . Value , LookAt := xlPart )           If ( Not r Is Nothing ) Then              sAdr = r . Address              Do                 r . Interior . Color Index = _                    rng . Interior . Color Index                 Set r = . FindNext ( r )              Loop While r . Address <> sAdr           End If           Set rng = rng . Offset ( 1 )        Wend     End With End Sub 
質問者 さん の やり方 を 継承 する なら 、 If TypeOf tgo Is DBNull Then です ね 。 しかし メソッド の 引数 は 、 Null 許容 型 変数 の 方 が 望ましい と 思い ます 。 Private Function CalcWorkdate ( tin As DateTime ?, tout As DateTime ?, tgo As DateTime ?, tback As DateTime ?) As TimeSpan この 場合 だ と 判別 は 、 If tgo . HasValue Then ' 値 が 渡さ れ た 場合 の 処理 Else ' Null の 場合 の 処理 End If です ね 。 
こんにちは。 > エクセル 2007 から デフォルト と なっ た 列 幅 の 自動 調整 を キャンセル さ せる すみません 、 これ 、 はつみみ です 。 主 様 、 どんな 状態 で 、 自動 調整 に なっ た の でしょ う か 、 そこ を まず 、 明確 に 。 VBA の 話 は 、 その 次 です 
Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim xRngs As Range , xRng As Range Const xAdr As String = " C : C , E : E , G : G , I : I , K : K " On Error Resume Next Set xRngs = Inter sect ( Range ( xAdr ), Target ) If xRngs Is Nothing Then Exit Sub On Error GoTo 0 For Each xRng In xRngs Application . EnableEvents = False xRng . Offset (, - 1 ). Value = Date Application . EnableEvents = True Next xRng End Sub 
こんな 感じ で いかが です か 。 ・ ・・・・・・・・・・・・ Sub 重複 () Dim temp , i As Long temp = 2 Range (" A1 "). Current Region . RemoveDuplicates _ Columns := 1 , Header := xlYes Do While Range (" A " & temp ) <> "" temp = temp + 1 Loop For i = 2 To temp Range (" A " & i ) = Range (" A " & i ) & Range (" B " & i ) _ & Range (" C " & i ) & Range (" D " & i ) & Range (" E " & i ) Next Range (" B2 : E " & temp ) = "" End Sub 
PC で は 画像 が 細か すぎ て レイアウト の 詳細 が 判り ませ ん 。 タイトル は 何 行 目 から 何 行 目 、 表題 項目 は 何 列 目 から 何 列 目 が 結合 さ れ て い て ○ ○ 、 など レイアウト の 具体 的 な 内容 と を 示し て ください 。 
Currency は 通貨 型 です よ ね 。 小数点 の 場合 は Double で 定義 です 。 Sub Sample () Dim a As Double , b As Double a = Round ( Cells ( 2 , 2 ), 2 ) b = Round ( Val ( ActiveSheet . TextBox 1 . Text ), 2 ) If a >= b Then MsgBox " 正常 " Else MsgBox " 異常 " End If End Sub 
次 の よう な コード を 実行 する と 、 正しい 結果 が 返り ます 。 「 cells ( 2 , 2 )」「 text bo x1 」 の 値 を 調べる の が 先決 でしょ う 。 Dim a As Currency Dim b As Currency a = " 10 . 6 " b = " 10 . 2 " If a >= b Then MsgBox " 正常 " Else MsgBox " 異常 " End If 
どの よう な エラーリカバリ を し たい の でしょ う ？ 今 の 記述 で は 、 ・ エラー が あっ たら Err 1 に ･･･ ・ Err 1 で は 、 何 も 処理 せ ず に 、 エラー が 発生 し た ところ から 再 実行 ･･･ Resume だけ で は なく 、 ･･･ 処理 し た 後 に 、 Resume Next だっ たり ･･･ やり たい こと を まとめ た 上 、 処理 を 進め られ たら と 思い ます なお 、 Err 1 で は 、 想定 さ れる エラー に 対処 する 処理 を 記述 さ れ たら と ････ ファイル の あり なし だけ で は ない と 思い ます けど ･･･ ※ 処理 例 等 、 回答 する 際 に は 、 ほとんど 、 エラー 処理 を 省い た もの に なっ て いる か と 思い ます 
> 何 か 出力 先 を 決め れる よう な 機能 は ある でしょ う か ？ 普通 の Open メソッド と 同じ よう な 機能 な ので 、 その よう な 機能 は 、 無い でしょ う 。 一旦 開き 、 セル を お 好き な ところ へ コピー ＆ ペースト すれ ば 、 よい の で は ？ どうしても 、 直接 既存 シート に 取り込み たい の なら 、 QueryTables を 使う の でしょ う ね 。 EX 2010 で 言え ば 、 データ ＞ 外部 データ の 取り込み ＞ テキストファイル の マクロ 記録 が 元ネタ に なり ます ね 。 
＞ 式内 の 「 =+ IFERROR (( VLOOKUP ( A3 , Sheet 1 !$ N $」 ＞ ここ まで は 理解 し まし た が ちょっと 待っ て 、 それ は おかしい です 。 =+ IFERROR (( VLOOKUP ( A3 , Sheet 1 !$ N $2 :$ R $300 0 , 5 , 0 )),"") ↑ こう数 式 が あっ たら 、 まず 一番 内側 の 関数 を 読み ましょ う 。 VLOOKUP ( A3 , Sheet 1 !$ N $2 :$ R $300 0 , 5 , 0 ) これ で 最後 の 5 , 0 の 意味 が 解ら ない の なら VLOOUP 関数 が 理解 でき て い ない の です 。 ただし 最後 の 0 は 慣れ て いる 人 の 書き方 で 本来 関数 の ヘルプ など を 見れ ば FALSE と 書く べき ところ です 。 が 、 Excel の 場合 FALSE は 0 、 TRUE は 1 と なり ます ので FALSE を 0 と 書い て も 同様 に 機能 する の です 。 次に IFERROR ( VLOOKUP 関数 ,"") これ は VLOOKUP 関数 の 結果 が エラー だっ たら 空文字 を 表示 さ せ て い ます ね 。 VLOOKUP で 検索 値 が 見つから ない と # N/A と エラー 値 が 表示 さ れ て 見た目 が よろしく ない ので 空文字 に し たい の です ね 。 さて 、 先頭 の + の 意味 は 良く わかり ませ ん 。 数値 として 計算 し たい わけ で も な さ そう です し 、 無く て も 同じ じゃ ない でしょ う か ？ カッコ も 無駄 に 1 組 多い と 思い ます 。 =+ IFERROR (( VLOOKUP ( A3 , Sheet 1 !$ N $2 :$ R $300 0 , 5 , 0 )),"") ↓ = IFERROR ( VLOOKUP ( A3 , Sheet 1 !$ N $2 :$ R $300 0 , 5 , 0 ),"") 
確認 し ます 。 下記 の 様 な 表 は 存在 する の でしょ う か 時間 ＿＿＿＿＿＿ 料金 7 ： 00 ～ 8 ： 00 ＿＿_ 100 8 ： 01 ～ 9 ： 00 ＿ ＿ ＿ 200 ～ 13 ： 01 ～ 14 ： 01 ＿_ 300 14 ： 01 ～ 15 ： 00 ＿_ 400 始まる 時間 ＿ ＿ 終わる 時間 ＿ ＿ 総計 7 : 32 ＿＿＿＿＿＿ 13 : 50 ＿ ＿ ＿ 1000 6 : 00 ＿＿＿＿＿＿_ 8 : 00 _____ 14 : 01 _________ 19 : 00 _____ もし この よう な 表 に 基づき 関数 が ある なら シート を 増やさ ず に 時間帯 区分 の 行 数 を ふやせ ば シート を 増やす 必要 は ない の です が シート を 増やさ ず に では なく 行 を 増やさ ず と いう こと です か ？ 今 組ん で いる 関数 と は 具体 的 に どんな 関数 に さ れ て いる の でしょ う か その 関数 を が どう 組ま れ て いる か によって 例えば Ａ 列 に 区分 の ため の 記号 （ ７ ： ０ ０ 始まり の とき は 空欄 、 ６ ： ０ ０ 始まり の とき は ○ など ） を 入れ て 、 関数 を 切り替える 事 が 可能 か どうか 変わっ て き ます が ？ また 関数 によって は 7 : 00 ～ を 6 : 00 に ～ 15 : 00 を 19 : 00 に 変えれ ば すむ の で は ？ 
タイムテーブル は A 2 から 下 方向 に 日付 、 B 1 から 右 方向 に 「 ○ コマ 目 」 と 入力 さ れ て いる と し ます 。 ActiveX コントロール の コンボボックス を シート 内 に 設置 し 、 以下 コード を シート モジュール に 記述 し て ください 。 Private Sub ComboBox 1 _ Change () Dim TableRng As Range Dim Rng As Range Dim Results () As String Dim ResultRng As Range If ComboBox 1 . Text = "" Then Exit Sub ReDim Results ( 1 , 0 ) Set TableRng = Range (" A1 "). Current Region With T ableRng Set TableRng = . Offset ( 1 , 1 ). Resize (. Rows . Count - 1 , . Columns . Count - 1 ) End With For Each Rng In TableRng If Rng . Value = ComboBox 1 . Text Then If Results ( 0 , 0 ) <> "" Then ReDim Preserve Results ( 1 , UBound ( Results , 2 ) + 1 ) Results ( 0 , UBound ( Results , 2 )) = Format ( Cells ( Rng . Row , " A "). Value , " m / d ") Results ( 1 , UBound ( Results , 2 )) = Cells ( 1 , Rng . Column ). Value End If Next Set ResultRng = TableRng . Offset ( TableRng . Rows . Count + 1 , - 1 ). Cells ( 1 ) ResultRng . Resize ( Rows . Count - ResultRng . Row + 1 , 2 ). Clear ResultRng . Resize ( UBound ( Results , 2 ) + 1 , 2 ). Value = WorksheetFunction . Transpose ( Results ) End Sub Private Sub ComboBox 1 _ DropButtonClick () Dim TableRng As Range Dim Rng As Range Dim Members () As String Dim i As Long On Error Resume Next Do While Err . Number = 0 ComboBox 1 . RemoveItem 0 Loop On Error GoTo 0 ReDim Members ( 0 ) Set TableRng = Range (" A1 "). Current Region With T ableRng Set TableRng = . Offset ( 1 , 1 ). Resize (. Rows . Count - 1 , . Columns . Count - 1 ) End With For Each Rng In TableRng If Rng . Value <> "" Then For i = 0 To UBound ( Members ) If Members ( i ) = Rng . Value Then GoTo Label Next ReDim Preserve Members ( UBound ( Members ) + 1 ) Members ( UBound ( Members )) = Rng . Value ComboBox 1 . AddItem Rng . Value End If Label : Next End Sub 
こんにちは。 outerText を innerText は 、 試し て ください 。 通貨 記号 は 、 vba から み て も 、 特別 な 文字 な ので 、 できるだけ 触ら ない よう に 転記 し て 、 それから 、 考え て ください 。 
こんな 感じ で どうでしょう か Range (" B 1 "). Resize ( Range (" A " & Rows . Count ). End ( xlUp ). Row ). FormulaR 1 C1 = "= IF ( RC [- 1 ]="""","""", LEFT ( RC [- 1 ], FIND (""_"", RC [- 1 ])- 1 ))" Range (" C1 "). Resize ( Range (" A " & Rows . Count ). End ( xlUp ). Row ). FormulaR 1 C1 = "= IF ( RC [- 2 ]="""","""", MID ( RC [- 2 ], FIND (""_"", RC [- 2 ])+ 1 , LEN ( RC [- 2 ])))" 
Sub リスト 化 () Dim ws As Worksheet Dim RowCnt As Integer Dim ColCnt As Integer Dim y As Integer Dim x As Integer Dim z As Integer Dim i As Long z = 4 Sheets (" 作業 "). Cells . ClearContents For i = 1 To Worksheets . Count - 3 Set ws = Worksheets ( i ) RowCnt = ws . Cells .S pecialCells ( xlLastCell ). Row ColCnt = ws . Cells .S pecialCells ( xlLastCell ). Column y = 1 x = 1 For y = 1 To RowCnt For x = 1 To ColCnt If ws . Cells ( y , x ) <> "" Then z = z + 1 Sheets (" 作業 "). Cells ( z , 2 ) = ws . Cells ( y , x ) End If Next x Next y Next i End Sub こんな 感じ で は ？ 
提示 さ れ た ActiveSheet . UnprotectSheet の コード です が 、 保護 を 解除 し たい シート が Active に なっ て いる と は 限り ませ ん 。 おそらく Sheet (”△△△”) の シート の 保護 を 解除 し たい という こと だ と 思わ れ ます ので 、 ActiveSheet の 部分 を 以下 の よう に 明示 的 に シート 名 を 指定 し て み て ください 。 Sheet (”△△△”). Unprotect 
具体 的 な 事 が わかり ませ ん ので 、 例 です が 。 Ａ 1 セル に 値 （ 例えば 10 ） を 入れる なら Range (" A1 "). Value = 10 Ａ 1 セル の 内容 を Ｂ 1 セル に i 入れる なら Range (" B 1 "). Value = Range (" A1 "). Value Ａ 1 セル の 内容 と Ｂ 1 セル の 内容 を 入れ替える なら 変数 を 定義 し て （ 例 tmp という 変数 ） tmp = Range (" A1 "). Value Range (" A1 "). Value = Range (" B 1 "). Value Range (" B 1 "). Value = tmp > プルダウン の 選択 を 自動 で 自動 選択 という こと で なく 、 セル に 値 を 入れる だけ です ので 、 その 値 が 決まっ て いれ ば Range (" A1 "). Value = xxx の 構文 で 出来 ます 。 
Range (" A1 "). Value = ThisWorkbook . Name と し ます 。 ActiveWorkBook は 「 現時点 で アクティブ に なっ て いる ブック 」 を 指す ので 複数 の Excel を 開い て いる 場合 に 自分自身 で は ない 可能性 が あり ます 。 ThisWorkbook は その 名 の 通り 「 この ブック 」 な ので どんな 場合 でも 自分自身 を 指し ます 。 ActiveSheet は 「 現時点 で アクティブ に なっ て いる ワーク シート 」 を 指し ます 。 ActiveSheet . Paste は 「 現時点 で アクティブ に なっ て いる ワーク シート に セル 範囲 を ペースト する 」 という メソッド です ので この 使い方 は 誤り です 。 
コード の 一 例 です 。 Private BeforeText As String Private Sub TextBox 1 _ BeforeUpdate ( ByVal Cancel As MSForms . ReturnBoolean ) If TextBox 1 . Text = BeforeText Then MsgBox " 同じ 番号 です " Cancel = True Exit Sub End If BeforeText = TextBox 1 . Text End Sub オペレーション ミス の 例 として 、 ２つ 手前 の 商品 の コード を 読み込ん で しまう 可能性 は あり ませ ん か ？ そういう ミス が あり 得る の なら COUNTIF を 使う 方 が より 確実 だ と 思い ます 。 
Private Sub Worksheet _ SelectionChange ( ByVal Target As Range ) With T arget If . Count > 1 Then Exit Sub If . Column = 4 And . Value <> "" Then If . Row > 7 And . Row < 109 Then Select Case MsgBox (" 入力 さ れ て ます 、 編集 し ます か ?", vbExclamation Or vbYesNo ) Case vbYes Application .S endKeys "{ F2 }", True End Select End If End If End With End Sub > どうして でしょ う か ？ 複数 セル を 選択 する と その エラー が 表示 さ れ ます 。 ↑ の プログラム は とりあえず 、 １つ の セル だけ 選択 さ れ た とき 起動 する よう に し まし た 。 
こんにちは。 この a タグ に は 、 id や name は ない ので 、 for each で 、 リンク s を ループ し て 、 a タグ の テキスト 文字 が 15 / 07 / 28 に なっ て い たら 、 click を さ せる よう に 、 コード を 組ん で ください 。 if left ( obj . innertext , 8 )= " 15 / 07 / 28 " then obj . click という よう に なり ます 
更新 後 処理 （ AfterUpdate ） で は なく 、 フォーカス 喪失 時 （ Exit ） で チェック し 、 エラー なら ば フォーカス 喪失 を キャンセル し ます 。 （ サンプル ） Private Sub imp _ 端末 _ Exit ( Cancel As Integer ) Dim IMsg As String Dim IRet As Integer ' 長さ チェック If Len ( Me . imp _ 端末 ) > 10 Then IMsg = " 10 文字 以内 で 入力 し て ください 。 " IRet = MsgBox ( IMsg , vbCritical , " Error ") Me . imp _ 端末 = Null Cancel = True Exit Sub End If End Sub 
こんにちは。 原因 は 、 もっと 別 の コード です 。 dir 関数 は 、 ひとつ の 文字列 を 取得 する コード です 。 フォルダ 名 を 設定 し て 、 dir し たら 、 その フォルダ 名 が 表示 する だけ です 。 点 に なっ て いる の は 、 正しい 文字コード の 処理 が 出来 て い ない 、 という こと です 。 セル に 設定 する とき に 、 ' 記号 と 組み合わせ て もて ください 。 か 、 セル の 書式 を 文字列 に 変更 し て から 、 設定 という こと です 。 エクセル の 仕様 の 範囲 で は 、 ファイル の 取り扱い は 、 dir より は 、 filesystemobject で 処理 する よう に し て み て ください 。 windows の wsh や vbscript の 説明 ページ に 、 あり ます 。 
相対パス で は ありません が 、 どこ でも 動作 する という こと は 、 基準 を 決める という こと だ と 思い ます 。 なら ば 、 マクロ ブック の パス を 基準 に する の は どうでしょう か 。 strDir = ThisWorkbook . Path & "\" 
余計 な ところ に カギ かっこ [ が 入っ て ます よ 。 RC [- 11 ] の 前 Active Cell . FormulaR 1 C1 = _ "= IF ( RC [- 12 ]="""", IF ([ RC [- 11 ]="""","""", MID ( RC [- 11 ], 5 , 3 )), RC [- 12 ])" ↓ Active Cell . FormulaR 1 C1 = _ "= IF ( RC [- 12 ]="""", IF ( RC [- 11 ]="""","""", MID ( RC [- 11 ], 5 , 3 )), RC [- 12 ])" 
こんにちは。 そう いえ ば 、 この コード 、 なに が し たい ん でしょ う か 。 記号 を 検索 し て 、 ユニオン し て 、 usedrage ともし て いる し 、 結局 、 target の 記号 を み て 、 判定 し て ます よ ね 。 「 選択 し た セル 」 の 状態 を み て の 動作 だっ たら 、 最初 の 検索 って 、 なん の ため に し て いる の でしょ う か アクティブ シート の イベント で の 処理 な ので 、 できるだけ 最小 の 処置 に する こと 、 この イベント で 、 target に なに も なかっ たら 、 すぐ に 終了 さ せ たら いい です 
おはよう ござい ます 。 私 が 思っ て い た の は 、 ひとつ の ファイル を 開く 前 に 、 それぞれ の ファイル の パスワード を 入力 する の は どう か という こと です 。 pw = InputBox ( myFn &" 123 ") pw = InputBox ( myFn &" 321 ") pw = InputBox ( myFn &" 213 ") と いくつ も InputBox を 並べる の で は なく 、 pw = InputBox ( myFn &" の パスワード を 入力 し て ください ") と ひとつだけ 入れ て おけ ば 、 これから 開く ファイル の パスワード を 入力 を 聞く こと が でき ます 。 Sub TEST 01 () Dim myFn As String Dim pw As String Dim wb As Workbook ' 以上 変数 宣言 Application .S creenUpdating = False ' 画面 更新 一時停止 myFn = Dir ( ThisWorkbook . Path & "\*. xls ?") ' エクセル BOOK 検索 Do While myFn <> "" ' 対象 が 存在 する 限り 続行 If myFn <> ThisWorkbook . Name Then ' ファイル 名 が 自分 の 名 と 違っ て いれ ば pw = InputBox ( myFn &" の パスワード を 入力 し て ください ") Set wb = Workbooks . Open ( ThisWorkbook . Path & "\" & myFn , Password := pw ) ' 開く With wb Application . DisplayAlerts = False ' 警告 一時停止 .S aveAs Filename := wb . FullName , Password :="" ' パスワード なし で 上書 保存 . Close False ' 閉じる Application . DisplayAlerts = True ' 警告 停止 解除 End With End If myFn = Dir () ' 次 検索 Loop ' 繰り返し Application .S creenUpdating = True ' 画面 更新 停止 解除 MsgBox " 終了 し まし た 。 " End Sub 
貴方 が 書い た コード を 示し て み て ください 。 morg の ページ に 書い て ある コード を 参考 に し た 、 と の こと です が 、 該当 ページ の コード を 理解 し た 上 で 参考 に し て いる の で あれ ば 、 外部 プログラム の 開始 を 待機 し て しまう 、 という こと は ない はず です 。 
こんにちは。 表示 し て いる ページ の ソース を 確認 し て 、 「 どこ から コピー する の か 」 の name や id など 、 識別 できる もの を 探し ます 。 見つけ たら 、 それ を コピー する コード を 追加 です 。 示し て いる コード で 、 input タグ を 見つけ て 、 送信 を 2 かいし て いる ので 、 どこ で 、 どの 部分 を 読み たい か 、 分かり にくい です です ね 。 2度 目 の 送信 の 次 でし たら 、 end sub の 手前 に 、 「 待つ 」 という コード と 、 転記 の コード を 追加 し て ください 
2015 の 方 で OpenCV は 使える よう に し て ある の です ね ? それ と 、 ヘッダ 関係 は 2.0 だっ た か で 随分 編成 が 変わっ た はず です 。 使う バージョン で 、 使う 関数 が どの ヘッダ に 入っ て いる か 確認 し て 適宜 修正 の 必要 が ある と 思い ます 。 
異常 が 発生 し た 時 に ＰＣ の 再起動 は 試さ れ まし た か ？ （ Ｗｉｎ ８ や １ ０ なら ” 完全 シャットダウン ” から の 起動 です 。 ） 
オプション とか 違う ので 、 結果 が 違う の は 当然 だ と 思い ます 。 ( 全く 同じ に し て いる なら 話 は 別 です が ...) 
コード 例 です 。 シート 名 や キー 文字列 が 入っ た 列 は 適宜 書き換え て ください 。 （ シート 1 も シート 2 も A 列 として 書い て い ます 。 ） Sub Sample () Dim Row 1 As Long Dim Row 2 As Long Dim Sht 1 As Worksheet Dim Sh t2 As Worksheet Dim Sh t3 As Worksheet Dim KeyStr As String Dim CopyRng As Range Set Sht 1 = Worksheets (" シート 1 ") Set Sh t2 = Worksheets (" シート 2 ") Set Sh t3 = Worksheets (" シート 3 ") For Row 1 = 1 To Sht 1 . Cells ( Rows . Count , " A "). End ( xlUp ). Row KeyStr = Sht 1 . Cells ( Row 1 , " A "). Value For Row 2 = 1 To Sh t2 . Cells ( Rows . Count , " A "). End ( xlUp ). Row If Sh t2 . Cells ( Row 2 , " A "). Value = KeyStr Then If CopyRng Is Nothing Then Set CopyRng = Sh t2 . Rows ( Row 2 ) Else Set CopyRng = Union ( CopyRng , Sh t2 . Rows ( Row 2 )) End If End If Next Next If Not CopyRng Is Nothing Then CopyRng . Copy Destination := Sh t3 . Cells ( Rows . Count , " A "). End ( xlUp ). Offset ( 1 ). EntireRow End If Application . CutCopyMode = False End Sub 
移動 です よ ね ？ With Range (" C1 "). End ( xlDown ) . Offset (, - 1 ). Value = . Value . ClearContents End With 
下記 の コード でいか が でしょ う か 。 Option Explicit Sub Sample () Dim r As Long , c As Long , v As Variant For r = 1 To Range (" A " & Rows . Count ). End ( xlUp ). Row For c = 1 To 4 v = "" On Error Resume Next v = WorksheetFunction . Match ( Cells ( r , c ). Value , Range (" F " & r & ": H " & r ), 0 ) On Error GoTo 0 If v <> "" Then Cells ( r , c ). Font . Color = 255 End If Next c Next End Sub 
VBA で は WS H. Popup は 不安定 で 使わ ない 方 が いい そう です 。 ネット で 下記 の コード を 見つけ まし た 。 ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ MessageBoxTimeout っていう HiddenAPI （ 非公開 ＡＰＩ ) を 使っ て 見る と か 。 （ Sample ） Private Declare Function MessageBoxTimeoutA Lib " User 32 " _ ( ByVal Hwnd As Long , _ ByVal lpText As String , _ ByVal lp Caption As String , _ ByVal uType As VbMsgBoxStyle , _ ByVal wLanguageID As Long , _ ByVal dwMilliseconds As Long ) As Long Private Const MB _ TIMEOUT = & H 7 D0 0 Sub TimerMsgbox () Dim Sec As Long Dim Result As Long Dim sMsg As String Sec = 4 * 1000 ' 4 秒 sMsg = " 4 秒 後 に 消え ます 。 " Result = MessageBoxTimeoutA ( Application . Hwnd , sMsg , _ Application . Name , vbOKCancel + vbMsgBoxSetForeground , 0 &, Sec ) Select Case Result Case vbOK sMsg = " OK ボタン が 押さ れ た 。 " Case vbCancel sMsg = " キャンセル ボタン が 押さ れ た 。 " Case MB _ TIMEOUT sMsg = " 4 秒 経ち まし た 。 " End Select MsgBox sMsg End Sub ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ ＝ 
ジェネリック メソッド です 。 型 自体 を パラメータ として 与え て 汎用 的 な 使い方 が 出来 ます 。 
個体識別番号 は どんな 値 です か 。 例 を 複数 3 ～ 5 個 位 教え て ください 。 また テーブル を 受信 する よう です が 、 B 列 から ずらっと 受信 する の です か ？ シート を 変え て 受信 する の です か ？ 
ご 質問 の コード で は 、 ただ 単に ページ 上 に 存在 する リンク を 全て さらっ て いる だけ に なり ます 。 Google検索 結果 に は 、 結果 以外 に も リンク は あり ます ので 、 そこ を クリック し た の でしょ う 。 WEB ページ に は それぞれ 、 製作 者 が 定め た ルール が あり ます 。 それ を 知る こと が でき なけれ ば 、 目的 の 情報 を 自動 収集 する こと は でき ませ ん 。 その ため に は 、 HTML ソースコード の 解析 が 必要 です 。 Google検索 結果 の ページ は 、 ID 属性 値 「 rso 」 を 持つ DIV タグ に ぶら下がる 形 で まとまっ て い ます 。 ただし 、 中身 が 少し 複雑 で 、 CLASS 値 に 「 srg 」 を 持つ DIV タグ に 結果 リスト が まとまっ て い て 、 「 data - hveid 」 という 属性 値 を 持つ DIV タグ に ニュース トピック が まとまっ て いる よう です 。 それぞれ の まとまっ て いる 中身 の 構造 の 細かい 部分 は 置く として 、 H3 タグ に 、 結果 の リンク が 含ま れ て い ます 。 以上 を まとめる と 、 ・ ID 「 rso 」 の タグ を 取り出す ・ 上記 の 中 から CLASS 「 srg 」 の DIV タグ を 取り出す ・ 上記 から H3 タグ 群 を 取り出す ・ 取り出し た タグ に Click メソッド を 実行 ・ CLASS 「 data - hveid 」 に も 、 必要 なら ば 同様 の 処理 を 行なう という 手順 に なり ます 。 質問 日時 等 は 、 結果 情報 として まとまっ て いる タグ 群 の 中 から 、 必要 な もの を テキスト で 取り出し 、 更に 文字列 操作 で 抽出 する という こと に なり ます 。 いきなり コード を 示し て も 混乱 する だけ で 応用 する こと は でき ない でしょ う し 、 何より 私 自身 、 どの よう に 応用 する の か が 見え て い ませ ん 。 まずは 、 検索 結果 が 上記 の よう な 構造 に なっ て いる こと を 、 ブラウザ で ソースコード 解析 する こと で 確認 し て み て ください 。 Firefox や Chrome の 右クリックメニュー 内 「 要素 を 調査 」 が 便利 です 。 構造 が 分かれ ば 、 どう 命令 を 起こす か は さておき 、 どの よう な 流れ を 組む べき か は 見え て くる と 思い ます 。 
① テンプレート ファイル （. xlsx ） を コピー 、 と あり ます が 、 どこ に コピー する の でしょ う か ？ ② テンプレート ファイル から コピー する の は 特定 の シート だけ でしょ う か ？ それとも すべて の シート を コピー する の でしょ う か ？ ③ コピー し た テンプレート ファイル の シート (" ファイル 1 ") に 、 と あり ます が 、 画像 で は シート 名 は 「 1 」 です が 、 どちら が 正しい の でしょ う か ？ ④ ファイル 1 ～ 3 の ある パス に ③ で でき た ファイル を 名前 を 付け て 保存 、 と あり ます が 、 ファイル 1 は テンプレート ファイル の シート (" ファイル 1 ") だけ を 保存 する 、 という こと でしょ う か ？ ファイル 2 、 ファイル 3 も 同様 でしょ う か ？ ⑤ ファイル 1 ～ 3 の コピー 範囲 は 完全 に 固定 でしょ う か ？ 例えば 下 の 表 は 常に 見出 し行 1 行 + デー タ行 5 行 の 6 行 で 固定 な の でしょ う か ？ それとも 17 行 目 以降 に も データ が 続く 可能性 が ある の でしょ う か ？ 
private で は クラス 外 から は アクセス でき ませ ん 。 public class Foo { private void bar () { ... } } この 場合 、 クラス 外 から bar 関数 に は アクセス でき ませ ん 。 
ラムダ式 と 呼ば れる 表記法 で 、 そこ に 関数 を 作り出し ます 。 分解 し て 直せ ば .... private void func () { Tread . Sleep ( 5000 ); } .... await Task . Run ( func ); という よう な 感じ です 。 （ delegete つけ ない と いけ なかっ た か な ？ ） 以前 は Delegete と 呼ば れ て い た 表記 方法 を さらに 簡単 に 記述 できる よう に し た 書き方 だ と 思え ば よい です 。 今回 の 例 の よう に 外界 と 特別 な 接点 を 持た ない 処理 だ と あまり ありがたみ は ありません が 、 LINQ と 組み合わせ た 時 に 、 大きな 力 を 発揮 し ます よ 。 
それ は 無理 です 。 ご 質問 の よう な コード は 、 セル の 値 の 変化 といった 「 イベント 」 と 呼ば れる 変化 を キー と し て いる の です が 、 入力 中 の 変化 を 検出 する 方法 は あり ませ ん 。 キー 入力 イベント が あれ ば 良い の です が 、 ユーザー フォーム に は あっ て も 、 セル 入力 そのもの に は あり ませ ん 。 
どの 様 な 症状 に お 悩み な の か 、 よく 解っ て ませ ん 。 違和感 を 感じる の が 、 項目 を 編集 する 前 に 、 フォーム を 起動 し て いる 点 。 UserForm 2 .s how の タイミング が 早 過ぎ 、 なので は ？ 「 ・ ・ ・ ・ ・ 以下 同じ よう に 続き ます ・ ・ ・ ・ 」 と 画面 項目 を 編集 し た あと 、 .S how する の が 普通 の やりかた 、 の よう に 思い ます 。 
回答 し 直し て ます 2016 / 06 / 04 15 : 06 : 46 シート １ ・ ２ の 発送 日 （ C 2 列 ・ A 2 列 に ある 発送 日 ） の ある 物 だけ を 集計 する に は どの 様に コード を 書く の でしょ う か 。 手間 を 掛ける 事 に なり 、 重ね重ね ご 迷惑 を おかけ し まし て 大変 申し訳 あり ませ ん 。 何卒 、 よろしく ご 教授 の 程 、 お願い いたし ます 。 Sheet 3 から は 、 D2 8 ～ の 商品 コード を 入手 し 、 K 列 に 【 発送 日 の ある 物 】 の 集計 結果 書き出し Sheet 1 から は 、 【 C 2 ～ 発送 日 ( ある 物 のみ ） 】 、 F2 ～ の 商品 コード 、 AJ の 個数 を 入手 を Sheet 2 から は 、 【 A 2 ～ 発送 日 （ 全部 記載 ある ） 】 、 B2 ～ の 商品 コード 、 R の 個数 を 入手 ～～～～～～～～～～ 条件 に 抜け が あっ た という こと です ね Sheet 1 / Sheet 2 で 、 デー タ行 範囲 を 求める 際 、 発送 日 の 列 を 使っ た 方 が 良い の か ･･･ 商品 コード の 列 ･･･ 確実 に 行 範囲 を 決定 できる 商品 コード の 列 を 使っ て み ます ただ 、 商品 コード ２ 行 以上 ない 状態 で 実行 する と 、 エラー 処理 入れ て い ない ので ････ ポン ･･･（ これ は 前 から です が ） 変数 vC の Array 定義 部分 と 、 ★ 部分 を 変更 し て い ます これ も 未 実行 な ので 、 おかしかっ たら ごめんなさい Public Sub Samp 3 ()     Dim dic As Object     Dim vSh 3D ata As Variant     Dim vA As Variant , vB As Variant , vD As Variant ' ★     Dim vC As Variant , v As Variant     Dim i As Long , j As Long     vC = Array ( _           Array (" Sheet 1 ", " F ", " AJ ", " C "), _           Array (" Sheet 2 ", " B ", " R ", " A ") _        )     Set dic = CreateObject (" Scripting . Dictionary ")     With Worksheets (" Sheet 3 ")        With . Range (" D2 8 ", . Cells ( Rows . Count , " D "). End ( xlUp ))           vSh 3D ata = . Value           For i = 1 To UBound ( vSh 3D ata )              dic ( vSh 3D ata ( i , 1 )) = i              vSh 3D ata ( i , 1 ) = Empty           Next           For Each v In vC              With Worksheets ( v ( 0 ))                 With Range (. Cells ( 2 , v ( 1 )), . Cells ( Rows . Count , v ( 1 )). End ( xlUp ))                    vA = . Value                    i = Cells ( 1 , v ( 2 )). Column - . Column                    vB = . Offset (, i ). Value                    i = Cells ( 1 , v ( 3 )). Column - . Column ' ★                    vD = . Offset (, i ). Value ' ★                 End With              End With              For i = 1 To UBound ( vA )                 If ( IsDate ( vD ( i , 1 ))) Then ' ★                    j = dic ( vA ( i , 1 ))                    If ( j <> 0 ) Then                       vSh 3D ata ( j , 1 ) = vSh 3D ata ( j , 1 ) + vB ( i , 1 )                    End If                 End If ' ★              Next           Next           i = Cells ( 1 , " K "). Column - . Column           . Offset (, i ). Value = vSh 3D ata        End With     End With     Set dic = Nothing End Sub 以下 、 初期 回答 2016 / 6 / 3 11 : 57 : 40 私 が 回答 し た もの が ベース に 、 グチャグチャ に なっ て いる よう に 見受け られ ます まず 、 過去 に 回答 し た 、 ・ 誰 の ・ どんな 質問 に ・ どう 回答 し た これら を Access にて 自己 管理 し て い ます vSh 3D ata を キーワード に 検索 し て みる と ２ 件 ヒット し ます シート １ シート ２ の データ を シート ３ で 集計 し たい ネット で 調べ て た コード で 作成 し … http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q10 14739448 ... 前回 シート １ シート ２ の データ を シート ３ で 集計 し たい 質問 し た syokora 15329 です 。 http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1414743763 ... 現在 見え なく なっ た ちょい足し へ 記述 し た 内容 を み て も 、 同じ 記述 は 見当たり ませ ん >> グチャグチャ に と 表現 し た の は 、 > For Each v In vA 記述 の 下り の 処理 で v ( 1 ) は 使わ れ て い ない > With Worksheets ( v ( 0 )) > With . Range (. Cells ( 2 , v ( 3 )), . Cells ( Rows . Count , v ( 2 )). End ( xlUp )) > vShDay = . Value > i = Cells ( 1 , v ( 3 )). Column - Cells ( 1 , v ( 2 )). Column > vShData = . Offset (, i ). Resize (, CELM ). Value これ を 初め の ループ に 限っ て みる と With Worksheets (" Sheet 1 ") With . Range (. Cells ( 2 , " AJ "), . Cells ( Rows . Count , " F "). End ( xlUp )) vShDay = . Value i = Cells ( 1 , " AJ "). Column - Cells ( 1 , " F "). Column vShData = . Offset (, i ). Resize (, CELM ). Value どこ に も C 列 の 内容 を 読み込ん で いる ところ は ない ･･･ また 、 vShDay に は 、 F2 ～ Ajxxx の 広範囲 の 内容 を 読み込ん で い ます これ で 動い て いる と いわ れる 内容 > この マクロ は 現在 使用 中 > シート １ ． ２ の C 列 ・ A 列 は 発送 日 （ C 列 の 発送 日 は まばら に なっ て て 、 シート ２ の A 列 は 全て 記入 さ れ て い ます 。 ） この 処理 は 見つから ない > シート １ の AJ 列 に 個数 、 シート ２ は R 列 が 個数 、 集計 は シート １ の F 列 ・ シート ２ の B 列 が 商品 コード で 、 集計 シート ３ の D 列 の 商品 コード を 基準 に し て 、 発送 済 の シート １ ・ ２ の 合計 個数 を シート ３ で 集計 これ は 、 曲がりなりにも でき て い て 、 > . Resize (, CELM + 1 ). Value = vSh 3D ata これ により 、 D , E 列 に 上書き し て いる > 右 に 移動し K 列 に 集計 し たい 先 に 提示 し た URL で の 処理 は 、 １ ４ 列 分 を 一気に 集計 し て ････ Const CELM As Long = 14 で ･･･ という もの に し て まし た > 社員 の 誰 か 不明 について は id で 心当たり の 人 を 探す とか ･･･ と は いって も 、 今回 は 、 １ 列 分 の 集計 で 良い という お話 ？ Sheet 3 から は 、 D2 8 ～ の 商品 コード を 入手 し 、 K 列 に 集計 結果 書き出し Sheet 1 から は 、 F2 ～ の 商品 コード 、 AJ の 個数 を 入手 Sheet 2 から は 、 B2 ～ の 商品 コード 、 R の 個数 を 入手 という 条件 で 良い です か ？ 以下 は 未 実行 な ので 、 おかしかっ たら ごめんなさい Public Sub Samp 2 ()     Dim dic As Object     Dim vSh 3D ata As Variant     Dim vA As Variant , vB As Variant     Dim vC As Variant , v As Variant     Dim i As Long , j As Long     vC = Array ( _           Array (" Sheet 1 ", " F ", " AJ "), _           Array (" Sheet 2 ", " B ", " R ") _        )     Set dic = CreateObject (" Scripting . Dictionary ")     With Worksheets (" Sheet 3 ")        With . Range (" D2 8 ", . Cells ( Rows . Count , " D "). End ( xlUp ))           vSh 3D ata = . Value           For i = 1 To UBound ( vSh 3D ata )              dic ( vSh 3D ata ( i , 1 )) = i              vSh 3D ata ( i , 1 ) = Empty           Next           For Each v In vC              With Worksheets ( v ( 0 ))                 With Range (. Cells ( 2 , v ( 1 )), . Cells ( Rows . Count , v ( 1 )). End ( xlUp ))                    vA = . Value                    i = Cells ( 1 , v ( 2 )). Column - . Column                    vB = . Offset (, i ). Value                 End With              End With              For i = 1 To UBound ( vA )                 j = dic ( vA ( i , 1 ))                 If ( j <> 0 ) Then                    vSh 3D ata ( j , 1 ) = vSh 3D ata ( j , 1 ) + vB ( i , 1 )                 End If              Next           Next           i = Cells ( 1 , " K "). Column - . Column           . Offset (, i ). Value = vSh 3D ata        End With     End With     Set dic = Nothing End Sub 
なんか 、 統一 さ れ て い ない 書き方 です ね > " FROM [" & conSourceName & "] " & _ ここ で 、 テーブル / クエリ 名 を 動的 に 設定 しよ う と し て いる ･･･？ けど 、 > SELECT [ 10 出力 前 完成 _ Q ].[ Pin ]･･･ ここ で 、 固定 し て いる やる なら 、 " FROM [" & conSourceName & "] AS Q 1 " & _ とか AS し て 、 SELECT Q 1 .[ Pin ]･･･ する とか strSQL = " SELECT [{% 1 }].[ Pin ]･･･ FROM [{% 1 }] ･･･ とかし て おい て 、 strSQL = Replace ( strSQL , "{% 1 }", conSourceName ) で 一気に 書き換える とか 本題 で 、 上記 で 出来上がっ た strSQL を 一時 的 な クエリ として 扱い ます Set db = CurrentDb Set qd = db . CreateQueryDef ("", strSQL ) qd . Parameters ("★★") = ★ ★ へ の 値 Set rsHeader = qd . OpenRecordset qd . Parameters ("★★") で 、 " 10 出力 前 完成 _ Q " へ の パラメータ を 指定 し ます ※ ヘルプ で CreateQueryDef を 見 て おい た 方 が ･･･ 
マクロ 実行 中 に ユーザー フォーム を 表示 する 場合 です 。 この コード を マクロ の 中 に 記述 UserForm 1 .S how ユーザー フォーム に は リスト ボックス を 配置 下記 の コード を 用い ます 。 Private Sub UserForm _ Initialize () ListBox 1 . ColumnCount = 1 ListBox 1 . RowSource = " A 40 : A 42 " ListBox 1 . ControlSource = " A 4 " ListBox 1 . BoundColumn = 1 End Sub この 場合 、 アクティブ な シート を 変える と 別 な シート 上 でも 実行 でき ます 。 たくさん の シート が ある 場合 、 各 シート 上 に コントロール を 配置 する より 便利 かも しれ ませ ん 。 お 試し ください 。 
Sub sample () Dim i As Long , xAry , xDiv xAry = Split (" 2 , 3 , 5 , 7 , 11 , 13 ", ",") For i = 0 To 2 With Range (" A 2 "). Offset (, i ) If . Value > 1 Then ' A 2 は １ より 大きい か ？ For Each xDiv In xAry If . Value Mod xDiv = 0 Then . Offset (, 1 ). Value = . Value / xDiv . Offset ( 1 , 1 ). Value = xDiv End If Next xDiv End If End With Next i End Sub 未 実行 につき 不具合 ご 容赦 。 
フィルター の 詳細 設定 は 出来 ます か ? それ が できれ ば 条件 を コンボボックス や テキストボックス の 値 、 チェックボック が TURE の 場合 は 検索 条件 は "○" を 入れる よう に し て 条件 範囲 の 中 に いれ て フィルター を かけて やれ ば よい 。 わざわざ オプション ボタン は 不要 で コンボボックス に 入力 し ない 場合 は 条件 項目 は 空白 に し て おけ ば コマンド ボタン 一つ で 出来 ます 。 3つ 入れれ ば ３つ そろっ た もの が 抽出 さ れ ます 。 まず マクロ の 前 に フィルター の 詳細 設定 で 検出 できる よう に し て ください 。 次に マクロ の 記録 で 一度 行っ て マクロ を 作成 マクロ の 名前 を 付け て ください 。 次に コンボボックス テキストボックス の 値 を シート の 条件 範囲 の セル に 入力 する よう コード を 組ん で ください 。 それ が でき たら 先 ほど の マクロ 名 を 書き込ん だら 出来上がり です 。 全 データー 表示 は フィルター の 解除 で 出来 ます 。 または 検索 条件 を 全 クリアー で 検索 
> CSV の Excel ファイル を フォルダ の 中 に 作成 できる よう に なり まし た 。 > ただ 、 テキストファイル が 作れる コード が でき て い ない の が 問題 です 。 csv は テキストファイル ですよ。 . txt の ファイル 形式 で 作り たい の で あれ ば 、 filePath の 最後 を . txt に すれ ば 問題 ない です 。 
マクロ で シート 保護 する とき に ActiveSheet . Protect UserInterfaceOnly := True と すれ ば 、 保護 し た 後 でも マクロ から は セル が 操作 できる はず です 。 
Sub 複数 の ブック の シート を コピー する () Dim ファイル 名 一覧 As Variant Dim ブック As Workbook Dim i As Integer Dim s As Integer Dim dtkazu As Integer ' データ 数 ファイル 名 一覧 = Application . GetOpenFilename (" Excel の ファイル ,*. xls " _ , MultiSelect := True ) If VarType ( ファイル 名 一覧 ) = vbBoolean Then Exit Sub Application . EnableEvents = False For i = 1 To UBound ( ファイル 名 一覧 ) Set ブック = Workbooks . Open ( ファイル 名 一覧 ( i )) dtkazu = Cells ( 9 , 1 ). End ( xlDown ). Row - 8 s = InputBox (" シート の 番号 1 : 経費 清算 書 、 2 : 交通費 清算 書 ") ThisWorkbook . Worksheets ( s ). Cells ( 7 , 2 ) = ブック . Worksheets ( 1 ). Cells ( 4 , 2 ) ThisWorkbook . Worksheets ( s ). Cells ( 8 , 2 ) = ブック . Worksheets ( 1 ). Cells ( 5 , 2 ) ブック . Worksheets ( 1 ). Range ( Cells ( 9 , 1 ), Cells ( dtkazu , 11 )). Copy ThisWorkbook . Worksheets ( s ). Cells ( 9 , 1 ) ブック . Close Next Application . EnableEvents = True End Sub 集計 用 ブック に この マクロ を いれ ます 。 この マクロ を 起動 する と ファイル 選択 の ウインドウ が 出 ます ので 経費 清算 書 または 交通費 清算 書 の ファイル を 指定 し て 、 「 開く 」 を 押し ます 。 インプット ボックス が 現れ ます ので 、 経費 清算 書 の 場合 は 1 を 交通費 清算 書 の 場合 は 2 を 入力 し て ください 。 そうすると 経費 清算 書 の 場合 は B4 , B5 の データ を 集計 用 ブック の シート 1 の B7 , B 8 に 、 経費 清算 書 の A9 から 下 の K カラム まで の データ は 集計 用 ブック の シート 1 の A9 から 下 に すべて コピー さ れ ます 。 交通費 清算 書 の 場合 は B4 , B5 の データ を 集計 用 ブック の シート 2 の B7 , B 8 に 、 交通費 清算 書 の A9 から 下 の K カラム ( 経費 清算 書 似合わ せ て あえて K カラム まで と し まし た ) まで の データ は 集計 用 ブック の シート 2 の A9 から 下 に すべて コピー さ れ ます 。 回答 し ます 。 一応 これ で 試し て ください 。 複数回 実行 する とき は どう する の でしょ う か 。 
アメリカ で プログラマ を し て い ます 。 アメリカ と 日本 で は プログラマ と 呼ば れる 集団 の 構成員 が ずいぶん 違う ので 、 直接 の 比較 は あまり 意味 が ない と 思い ます よ 。 アメリカ で は プログラマ は 大学 で 専門教育 を 受け た 人たち が する 専門職 です 。 高卒 や 文系 大 卒 の 未 経験 者 が プログラマ として 採用 さ れる という の は まず 考え られ ませ ん 。 専門教育 を 受け て い ない プログラマ が 出来る 仕事 という の は 、 付加価値 の 低い 仕事 が 中心 に なる でしょ う 。 また 、 アメリカ で は 転職 が 当たり前 の 社会 です から 、 大手 企業 で も 中小企業 で も プログラマ で あれ ば 日本 ほど 給料 に 差 が 出 ませ ん 。 中小 の 会社 が 社員 として プログラマ を 雇う 場合 は 大手 と 遜色 ない 待遇 を 示さ なけれ ば 必要 な 人材 を 集める こと が でき ませ ん 。 基本的 に 正社員 の プログラマ は 好 待遇 で 付加価値 の 高い 仕事 を さ せ 、 付加価値 の 低い 仕事 は 契約社員 に 担当 さ せ たり 外注 し たり し ます 。 さらに 、 アメリカ で は プログラマ が 経験 を 積む と 経験 を 積ん だ プログラマ として 処遇 さ れ ます 。 プログラマ として より 多く の 責任 を 引き受ける よう に なり 、 責任 の 重さ に 応じ て 給料 も 上がり ます 。 日本 で は SE の 仕事 と さ れる よう な もの で も プログラマ の 仕事 で ある 場合 が 多い です 。 日本 で の SE の 下位互換 として の プログラマ は 、 アメリカ で は 経験 の 浅い プログラマ と ほぼ 同等 だ と 思い ます 。 もちろん 例外 は あり ます が 全体 的 な 傾向 として １ ． 日本 で プログラマ と 呼ば れる 人 の 教育 レベル が 低い こと 、 ２ ． 日本 で プログラマ と 呼ば れる 人 の 仕事 の 多く が 付加価値 の 低い 仕事 で ある こと 、 ３ ． 日本 で プログラマ と 呼ば れる 人 の ほとんど は 経験 が 浅い こと 、 を 考える と 、 日本 の プログラマ の 平均 収入 を アメリカ の プログラマ と は 単純 に 比べ られ ませ ん 。 日本 で も 平均 収入 の 母集団 を 、 理系 大学院 卒 、 大手 元請 企業 勤務 の プログラマ および SE と すれ ば 、 平均 収入 は かなり 上がる はず です 。 私 は 日本 で 中小企業 と 大手 外資系 の 両方 で 働い た 経験 が あり ます が 、 中小企業 退職 時 の 年収 は ３ ０ ０ 万 円 。 １ 年間 派遣 プログラマ を し た 後 、 大手 外資系 に 採用 さ れ た 時 の オファー は ボーナス 込み で ８ ０ ０ 万 ほど でし た 。 ２ 年 で 私 の 能力 が ３ 倍 に なっ た わけ で は なく 、 付加価値 の 低い 仕事 しか ない 現場 から 付加価値 の 高い 仕事 が ある 現場 に 移っ た だけ です 。 大手 外資系 で 働い て い た 時 に 付き合い の あっ た 他社 の プログラマ も 大体 同じ ぐらい の 待遇 でし た 。 何 が 言い たい か と いう と 、 日本 の プログラマ の 平均 収入 が 低い の は 、 日本 の プログラマ が 付加価値 の 低い 仕事 を し て いる から だ という こと です 。 日本の文化 や 言語 の 特性 も あっ て 、 付加価値 の 低い 仕事 が まだ 国内 に とどまっ て いる せい で プログラマ の 平均 収入 が 上がら ない の だ と 思い ます 。 付加価値 の 低い 仕事 を やめ て 、 付加価値 の 高い 仕事 に 注力 すれ ば プログラマ の 平均 収入 も 上がる はず です 。 
これ で OK です 。 ・ ・・・・・・・・・・・・・・・・・・・・・ Public Class Form 1 Private Sub Button 1 _ Click ( ByVal sender As System . Object , _ ByVal e As System . EventArgs ) Handles Button 1 . Click Dim proc As New Process () proc .S tartInfo . FileName = " C :\ Users \ Documents \ defg . exe " proc .S tart () End Sub End Class 
今 さ な なぜ VB ? って 気 も する が 、 個人的 に は Ruby は 飽きる と 思う 。 ので 、 この 二 択 なら 、 VB . Net 。 グラフィカル に ソフト を 開発 できる し ね 。 なん で 頑 なに Ruby 、 VB に 必死 な の ！ ？ 
素人 の 私 が 言う の も なん です が 、 作成 の 際 に 利用 する の が 知恵袋 という の は どう か と 。 。 。 ( 正直 、 その よう な ソフト は 信じ られ ない と 思う の は 私 だけ でしょ う か ？) 
以下 で どう なり ます か 以下 を 標準 モジュール に 転記 し て 、 Samp 1 を 実行 し て み ます （ 記述 量 は チョット 多い です が 、 それなり に 処理 し て ます ） 確認 用 簡易 データ 作成 testData で データ が 出来上がり ます この データ で 、 １ 秒 ソコソコ ･･･ かも Public Sub Samp 1 ()     Dim vA As Variant , v As Variant     Dim vP As Variant , vN As Variant     Dim i As Long , j As Long , k As Long     Const CH As String = "-"     vA = Worksheets (" SheetA "). Range (" A1 "). Current Region . Value     For j = 1 To UBound ( vA , 2 )        vN = Empty        i = 1        While ( i <= UBound ( vA ))           If ( vA ( i , j ) = CH ) Then              k = 1              Do While (( i + k ) <= UBound ( vA ))                 If ( vA ( i + k , j ) <> CH ) Then Exit Do                 k = k + 1              Loop              v = ""              If (( i + k ) <= UBound ( vA )) Then                 vP = vN                 vN = vA ( i + k , j )                 If ( Not IsEmpty ( vP )) Then v = ( vP + vN ) / 2              Else                 k = k - 1              End If              While ( k >= 0 )                 vA ( i , j ) = v                 i = i + 1                 k = k - 1              Wend           Else              vP = vN              vN = vA ( i , j )              If ( Not IsEmpty ( vP )) Then                 vA ( i , j ) = ( vP + vN ) / 2              Else                 vA ( i , j ) = ""              End If              i = i + 1           End If        Wend     Next     With Worksheets (" SheetB ")        . Range (" A1 "). Resize ( UBound ( vA ), UBound ( vA , 2 )). Value = vA        . Columns . AutoFit     End With End Sub ' 確認 用 簡易 データ 作成 Public Sub testData ()     Dim vA ( 1 To 100 , 1 To 1000 ) As Variant     Dim i As Long , j As Long     Randomize     For i = 1 To UBound ( vA )        For j = 1 To UBound ( vA , 2 )           If ( Rnd () > 0 . 8 ) Then              vA ( i , j ) = "-"           Else              vA ( i , j ) = Int ( 30 * Rnd ()) + 1           End If        Next     Next     With Worksheets (" SheetA ")        . Cells . Delete        . Range (" A1 "). Resize ( UBound ( vA ), UBound ( vA , 2 )). Value = vA        . Columns . AutoFit     End With End Sub 
上記 の 後 に do loop が 無い の なら 、 １ 行 しか ない ファイル な の で は ？ （ もしくは 先頭 行 だけ 読み込め ば 良い 。 ） 対象 と し て いる ファイル を メモ帳 で 開け ば 何 を 読み込ん で いる の か の 確認 は 簡単 です 。 
Cells ( r , c ). Value = FName Cells ( r , c + 1 ). Value = FileDateTime ( FPath & "\" & Fname ) 
こんな 感じ です 。 ・ ・・・・・・・・・・・・・・ Dim x As Integer Sub 乱数 () Dim a , c , d , j , h As Integer Dim b ( 50 ) As Integer Randomize a = 50 h = 0 owari : j = 0 d = Int ( Rnd () * a + 1 ) For c = 0 To a - 1 If b ( c ) = d Then j = 1 End If Next If j = 1 Then GoTo owari ElseIf h < a - 1 Then b ( h ) = d h = h + 1 GoTo owari End If If h = a - 1 Then b ( h ) = d End If For c = 0 To a - 1 Range (" E " & c + 1 ) = b ( c ) Next End Sub Sub ステップ () x = x + 1 Range (" A1 "). Value = "" Range (" A1 "). Value = Range (" E " & x ). Value End Sub Sub リセット () x = 0 Range (" A1 "). Value = "" End Sub 
> 設問 ID ごと に 自動 で 並べ 変える マクロ VBA は こういう とき に 全く 使い物 に なら ない ので perl とか ruby とか やっ た 方 が いい です 学ん で も 何 も 書け ない ので 別 の スクリプト言語 やっ た 方 が いい です 
貴殿 の 3つ の 条件 を 満たし 、 なおかつ 、 ④ B2 の 住所 が 間違っ て い た 場合 （ B5 : B 8 の 範囲 内 に ない 場合 ） 、 ⑤ C5 : C 8 の 範囲 内 が 全て 埋まっ て い て 、 なおかつ C 2 の 住所 が その 範囲 内 に ない 場合 、 も 想定 する と 数式 が 結構 長く なり まし た 。 ・ なお 、 C5 : C 8 の 範囲 内 に あえて ワイルドカード の 「 *」 は 必要 あり ませ ん 。 D2 セル に は 、 = IFERROR ( IFERROR ( LOOKUP ( 1 , 0 /(( B5 : B 9 = B2 )*( C5 : C 9 <>"")* COUNTIF ( C 2 , C5 : C 9 &"*")), D 5 : D 9 ), INDEX ( D 5 : D 9 , MAX ( INDEX (( B5 : B 9 = B2 )*( MATCH (" ーー ", C5 : C 9 , 1 )+ 1 ),)),)),"")&"" の 式 を 入れ て い ます 。 なお 、 ⑤ の ケース を 想定 し て 、 数式 で は 「 B5 : B 9 」 「 C5 : C 9 」 など と 空白 の 行 を 含め た 作り に し て い ます 。 
前回 の 質問 で 回答 し て い ます が 、 ボタン に 置き換わっ た の です ね 。 コマンド ボタン に 以下 の コード を コピペ し ます 。 Sub ボタン 1 _ Click () Dim Kanri As Worksheet , Kouji As Worksheet Dim EndRow As Long , i As Long Set Kanri = Worksheets (" 見積もり 管理 表 ") Set Kouji = Worksheets (" 工事 予定 表 ") With Kanri For i = 1 To 4 EndRow = Kouji . Cells ( Rows . Count , i ). End ( xlUp ). Offset ( 1 ). Row Kouji . Cells ( EndRow , i ) = . Cells ( 3 , i ) . Cells ( 3 , i ). ClearContents Next i End With Kouji .S elect End Sub ※ ただし 、 工事 予定 表 の A ～ D 列 の ２ 行 目 に は 見出し が 入力 さ れ て いる と し て い ます 。 
VBA で の やり方 は helpnanoda さん が 説明 さ れ て おり ます ので 関数 だけ で 処理 し て み ます 。 ただ 、 チェックボックス について です が 、 開発 タブ の 挿入 から 、 「 フォーム コントロール 」 の 「 チェックボックス 」 を 選択 設定 さ れ た という こと で 、 よろしい です か ？ Activex で は 、 ない です よ ね 。 Activex だ と 、 VBA を 使う という 前提 に なっ て しまい ます 。 1 . チェックボックス を 右クリック し 、 「 コントロール の 書式 設定 」 を 選択 。 2 . リンク する セル を 選択 し 、 離れ た 列 同 一行 の セル を 選択 。 ( 私 の 例 で は 、 F 列 と し て い ます ) 3 . 上記 1 . 2 . と 同様 の 作業 を 最下位 行 まで 、 行い ます 。 4 . チェックボックス に チェック を 入れ たり 、 外し たり し て み て ください 。 F 列 の 該当 する セル が 、 チェック が ON の 時 は 、 TRUE で OFF の 時 は 、 FALSE と 表示 さ れる はず です 。 5 . OK で あれ ば G 列 3 行 目 に 、 = IF ( F3 = TRUE , ROW (),"") と 入力 し 、 最下位 行 の セル まで 、 コピー 。 6 . H 列 3 行 目 に = IFERROR ( INDIRECT (" A "& SMALL ($ G $3 :$ G $7 , ROW ()- 2 )),"") と 入力 し 、 最下位 行 の セル まで 、 コピー 。 ＊ 5 . 6 . について です が 、 将来 的 に A ・ B 列 の データ が 増加 し そう なら ば 、 100 行 目 あたり まで コピー し て も OK です 。 Sheet 2 の A3 に = Sheet 1 ! H3 と 入力 し 、 下位 行 に コピー し ます 。 5 . 6 . で コピー し た行 数 と 同じ 行 数 と なる よう に し て ください 。 Sheet 1 の F ～ H 列 は 作業 領域 な ので 、 目障り なら ば 、 F ～ H 列 を 選択 後 非表示 に し て ください 。 以上 に なり ます が 、 不明 点 等 発生 し た 場合 は 、 お 気軽 に お 問合せ ください 。 
If Cells ( i , " B ") <> "" Then Cells ( i , " A ") = i - 4 を If Cells ( i , " B ") <> "" Then Cells ( i , " A ") = "'" & Right (" 000 " & Int ( i / 2 ) - 2 , 3 ) と し て 下さい 。 
↓ の よう な 考え方 の ほう が 、 解り やすい し 、 速度 的 に 有利 でしょ う 、 きっと 。 Sub 選択 () Dim ws As Worksheet Dim x As String For Each ws In Worksheets With ws If . Name Like " P ##" Then x = x & "," & . Name End If End With Next If x <> "" Then Worksheets ( Split ( Mid ( x , 2 ), ",")). Select End If End Sub 
この サンプル は yomikaki 0 , 1 , n , a ' ← ここ で １ 枚 目 の シート から 配列 a に 値 を 読み込む s = Time sortB n , a s = s & "->" & Time MsgBox " 経過 時間 ( バブル ) " & s yomikaki 1 , 2 , n , a ' ← ここ で ２ 枚 目 の シート へ 配列 a の 値 を 書き出す と なっ て い ます ので 、 シート が ２つ 存在 する こと が 前提 に なっ て いる よう です 。 シート を １ 枚 追加 し て み て ください 。 
以下 で 回避 可能 です 。 continue の ラベル が エラー 処理 と 固定 シート と で 共用 さ れ て いる の が 問題 ある か と 思い まし た ので ルーチン の 最後 に 固定 シート の 並び 替え を 置い て エラー 処理 と 分け まし た 。 あと 変数 名 に 日本語 は 控え た ほう が よい と 思い まし た が 動作 し て いる ので そのままで 掲載 し ます ね ＾ ＾ ； Sub 連 番 () On Error GoTo continue Dim n As Integer Dim 文字 連 番 As String Dim i As Long Dim a As Long Dim shname As String For i = 1 To Sheets . Count - 1 shname = Sheets ( i ). Name If Sheets ( i ). Name <> " 作業 " And Sheets ( i ). Name <> " 素材 " And Sheets ( i ). Name <> " 原紙 " Then 文字 連 番 = Mid ( i + 100 , 2 ) Sheets ( i ). Name = Sheets . Count - i If Left ( Sheets ( i ). Name , 1 ) <> " P " Then hoge : Sheets ( i ). Name = " P " + 文字 連 番 End If End If Next i GoTo End _ continue : If Err . Number <> 0 Then If Err . Number = 1004 Then ' 同 一 名 の シート 存在 時 エラー に なり シート 名 変更 が さ れ ない 状態 簡易 回避 Sheets (" P " + 文字 連 番 ). Name = " dummy " + CStr ( i ) Err . Clear Resume hoge End If End If End _: ThisWorkbook .S heets (" 作業 "). Move after := Sheets ( Sheets . Count ) Sheets (" 素材 "). Move before := Sheets (" 作業 ") Sheets (" 原紙 "). Move before := Sheets (" 素材 ") End Sub 
MonthCalendar の カスタマイズ について は 、 下記 サイト が 参考 に なる と 思い ます 。 http:// d . hatena . ne.jp / panda 728 z / 20090812 
回答 し ます 。 > VBS で テキストファイル を 1 文字 ずつ 読み込ん で 10 文字 目 の 文字 を メッセージ ボックス に 表示 する こと は でき ます か ？ → 必ず テキストファイル に 10 文字 以上 の 文字列 が 記述 さ れ て いる 保証 が ない ため 、 その 考慮 も 踏まえ て 、 プログラム を 作成 し て み まし た 。 サンプル プログラム は 以下 の 通り です 。 ■ 使用 方法 ① 空 の VBScript ファイル （ vbs ） を 開き 、 下記 の プログラム を 保存 し て ください 。 ② 起動 する とき に 、 読み込み たい ファイル を ① で 作成 し た ファイル に ドラッグ ＆ ドロップ し て ください （ ドロップ し たら プログラム が 起動 し ます ） 。 ■ プログラム Option Explicit Dim oFSO : Set oFSO = Nothing Dim oFile : Set oFile = Nothing Dim bFileOpenFlg : bFileOpenFlg = False Dim sFile : sFile = "" Dim sValue : sValue = "" Sub Main () ' ファイル 操作 を 行う ため の オブジェクト を 生成 Set oFSO = WS cri pt. CreateObject (" Scripting . FileSystemObject ") If Err . Number <> 0 Then Err . Raise Err . Number ' 引数 が 無い 場合 、 強制終了 If WS cri pt. Arguments . Count = 0 Then WS cri pt. Echo (" 引数 （ 読み込み たい ファイル ） を 指定 し て ください 。 ") WS cri pt. Quit (- 1 ) End If ' 引数 が 1 件 で ない 場合 、 強制終了 If WS cri pt. Arguments . Count <> 1 Then WS cri pt. Echo (" 引数 （ 読み込み たい ファイル ） は １ ファイル のみ 指定 し て ください 。 ") WS cri pt. Quit (- 1 ) End If ' 引数 を 取得 sFile = WS cri pt. Arguments ( 0 ) ' ファイル の 存在 確認 If oFSO . FileExists ( sFile ) = False Then WS cri pt. Echo (" 引数 （ 読み込み たい ファイル ） は １ ファイル のみ 指定 し て ください 。 ") WS cri pt. Quit (- 1 ) End If ' 拡張子 の 確認 Select Case LCase ( oFSO . GetextensionName ( sFile )) Case " txt ", " csv ", " dat " Case Else ' 上記 で 定義 さ れ た 拡張子 以外 の もの は 、 エラー と する WS cri pt. Echo (" 読み込み 可能 な ファイル で は あり ませ ん 。 ") WS cri pt. Quit (- 1 ) End Select ' ファイル の 読み込み （ 読み取り モード ） Set oFile = oFSO . OpenTextFile ( sFile , 1 ) If Err . Number <> 0 Then Err . Raise Err . Number bFileOpenFlg = True ' 全て の 文字列 を 取得 sValue = oFile . ReadAll ' 文字列 が 10 以上 存在 する か 確認 If Len ( sValue ) >= 10 Then ' 10 文字 目 の 文字 を 表示 WS cri pt. Echo " 10 文字 目 の 文字 は 『 " & Mid ( sValue , 10 , 1 ) & "』 です 。 " Else WS cri pt. Echo " 読み込ん だ ファイル に は 、 10 以上 の 文字 が 記述 さ れ て おり ませ ん 。 " End If ' ファイル を 閉じる oFile . Close Set oFile = Nothing End Sub Sub Try () Call Main () End Sub Sub Catch () On Error Resume Next Call Try () End Sub Call Catch () ' 変数 の 初期化 sFile = "" If Not oFile Is Nothing Then If bFileOpenFlg = True Then oFile . Close Set oFile = Nothing End If Set oFile = Nothing End If Set oFSO = Nothing ' 処理 中 に エラー が 発生 し た 場合 、 その 旨 の メッセージ を 表示 し 、 それ 以外 は 正常 終了 する If Err . Number <> 0 Then WS cri pt. Echo CStr ( Err . Number ) & ":" & Err . Description WS cri pt. Quit ( Err . Number ) Else WS cri pt. Quit ( 0 ) End If 
プログラム の ステップ 実行 は ご存じ でしょ う か ？ １ ステップ づつ 実行 し ながら 変数 の 変化 等 を 調べれ ば コード の ミス は 見つかる と 思い ます 。 変化 が 判る よう に Application .S creenUpdating = True の 状態 で 行い ましょ う 。 
日付 は 見える 日付 が 文字列 型 な の か 、 日付 型 ( 内部 的 に は 単精度 整数型 ) な の か によって 、 比較 の 仕方 が 異なる ので 、 シート の 日付 の 型 が 何で 、 どう やっ て 比較 し て いる の か で 変わっ て くる と 思い ます 。 
C 列 の 会社 名 を ブック 名 に する なら 、 > For r = 2 To w . Range (" A6 5536 "). End ( xlUp ). Row を For r = 2 To w . Range (" C " & Rows . Count ). End ( xlUp ). Row に 変更 。 > s = w . Cells ( r , " A ") & "_" & w . Cells ( r , " B ") を s = w . Cells ( r , " C "). Value に 変更 。 で どうでしょう か 。 
http:// office tanaka .net / excel / vba / file / file 07 . htm http:// office tanaka .net / excel / vb a/t ips / tips 69 . htm よく お世話 に なっ てる 有名 な VBA レクチャー サイト です 。 上 が エクセル シート へ の 書き出し 、 下 は その Dir 関数 の 注意 点 。 参考 まで に 。 
End ステートメント を 使っ て ください 。 ただちに 処理 を 終了 でき ます 。 似 た よう な ステートメント として STOP ステートメント も あり ます 。 こちら は 処理 を 中断 し ます 。 sub A () ・ ・ ・ ・ if 条件 then End End if ・ ・ ・ ・ End sub 
エクセル の オプション ☞ 詳細 設定 の 表示 ☞ 次 の シート で 作業 する とき の 表示 設定 で 「 改 ページ を 表示 する 」: OK … で Excel 終了 次 に Excel を 開く と … 改 ページ 表示 に なり ます . この ファイル で … ファイル ☞ 開く … 希望 する ファイル を 開き ます 。 
> 13 ファイル ある が 、 途中 で コピー が 止まり 、 3 ファイル で 終了 し て しまい ます 。 「 終了 」 と は 正常 に 終わっ た の です か 、 エラー に なっ て 終わっ た の です か 。 エラー で あれ ば 、 どこ で 、 どんな メッセージ が 出 て い ます か 。 > 又 、 コピー が 終わる と 、 その ファイル を 閉じる と 言う WB . close 部分 が デバック が 出 て しまう … そこ で エラー に なっ て 終わる という こと でしょ う か 。 その 時 の メッセージ は 。 先日 の コード に 、 回避 策 だけ 入れ替え た 場合 、 単純 な データ で は 問題 なく 動き まし た よ 。 C 列 から AA 列 まで 2000 行 に びっしり データ を 入れ た ファイル を 13 個 用意 し て 動かし まし た 。 2000 行 × 13 ファイル で 26000 行 の データ が きちんと でき まし た 。 やはり nagato _ blue _ noah さん の 書か れ て いる よう に 、 コード を 示し て いただか ない と わかり ませ ん ね 。 気 に なっ た の は 、 該当 の フォルダ に は 、 その 13 ファイル 以外 の ファイル は 入っ て ませ ん よ ね 。 フォルダ に ある ファイル を すべて 開く よう に なっ て い ます ので 。 
Private Sub ComboBox 1 _ Validating ( sender As System . Object , e As System . ComponentModel . CancelEventArgs ) Handles ComboBox 1 . Validating If Not ComboBox 1 . Items . Contains ( ComboBox 1 . Text ) Then ComboBox 1 . Text = String . Empty e . Cancel = True End If End Sub でいか が でしょ う か 。 
> テキストボックス B で 入力 中 の 文字 が 確定 せ ず そのまま 移動 し て しまい ます 。 > テキストボックス B で の 入力 を 取り消し て フォーカス を 移動 さ せる 方法 は ありま す でしょ う か 。 こちら の 環境 で は 、 テキストボックス B が 未 確定 で 下線 状態 の 時 に テキストボックス A や C に マウス クリック で フォーカス を 移動 する と 、 テキストボックス B は 未 入力 の まま に なり ます 。 また A 、 C 共 に 空白 の まま です 。 質問者 さん の 場合 は B の 入力 が 移動 し た よう に 見える 、 テキストボックス A または C が 未 確定 下線 状態 に なっ て しまう の でしょ う か ? そう だ と する と 以前 に リリース し た アプリケーション で 、 XP 環境 にて 同様 な 現象 が 発生 する エンド ユーザ さん の 端末 を 見 た こと が ある ので 、 質問者 さん の 場合 も 環境 依存 の 不具合 で は ない か と 思い ます 。 他 の マシン が ある 場合 は 、 同様 な 現象 が 発生 する か を 確認 し て み て 下さい 。 
質問者 さん の 場合 だ と 、 「 異常 有り なし 」 を 選択 する オプション ボタン は 非 連結 に し た 設計 の 方 が 良い の で は と 思い ます 。 その オプション ボタン の クリック イベント または 値 が 変更 さ れ た 場合 に 発生 する イベント で 「 異常 なし 」 の 場合 は レコード 次 へ 移動 する よう に 動作 さ せ ます 。 「 異常 有り 」 の 場合 は レコード は そのまま に し て おい て 、 コントロール に 値 を 入力 する よう に 動作 さ せ ます 。 そう すれ ば 「 異常 有り 」 で 別 フォーム を 開く 必要 ない でしょ う 。 この 動作 だ と 異常 なし の 場合 は コントロール を Disable に し て おい て 、 異常 有り の 場合 に Enable に する と 見た目 に も 分かり やすい し 、 異常 なし データ に 誤っ て 値 を 入力 し て しまう ミス も 防げる と 思い ます 。 どの よう な 動作 を 実現 し たい の か が 読み取れ ない 部分 が ある ので 、 こんな 回答 です が 。 
質問者 さん の 場合 だ と 、 「 異常 有り なし 」 を 選択 する オプション ボタン は 非 連結 に し た 設計 の 方 が 良い の で は と 思い ます 。 その オプション ボタン の クリック イベント または 値 が 変更 さ れ た 場合 に 発生 する イベント で 「 異常 なし 」 の 場合 は レコード 次 へ 移動 する よう に 動作 さ せ ます 。 「 異常 有り 」 の 場合 は レコード は そのまま に し て おい て 、 コントロール に 値 を 入力 する よう に 動作 さ せ ます 。 そう すれ ば 「 異常 有り 」 で 別 フォーム を 開く 必要 ない でしょ う 。 この 動作 だ と 異常 なし の 場合 は コントロール を Disable に し て おい て 、 異常 有り の 場合 に Enable に する と 見た目 に も 分かり やすい し 、 異常 なし データ に 誤っ て 値 を 入力 し て しまう ミス も 防げる と 思い ます 。 どの よう な 動作 を 実現 し たい の か が 読み取れ ない 部分 が ある ので 、 こんな 回答 です が 。 
http:// tsware .jp / study / vol 5 / event _ 09 . htm コンボ は 同様 に AfterUpdate でも 使え ば いい 。 
回答 １ 以下 の コード でいか が でしょ う か 。 Private Sub ComboBox 1 _ KeyDown ( sender As System . Object , e As System . Windows . Forms . KeyEventArgs ) Handles ComboBox 1 . KeyDown Dim p As Control p = CType ( sender , ComboBox ). Parent ' 下 矢印 の 時 Select Case e . KeyCode Case Keys . Down ' 最終 項目 が 選択 さ れ て いる とき If ComboBox 1 .S electedIndex = ComboBox 1 . Items . Count - 1 Then ' 直前 の コントロール を アクティブ に する p .S electNextControl ( ActiveControl , True , True , True , True ) e .S uppressKeyPress = False Exit Sub End If ' コンボボックス の 選択 項目 を ひとつ 下 の 項目 に する If ComboBox 1 .S electedIndex < ComboBox 1 . Items . Count - 1 Then ComboBox 1 .S electedIndex += 1 End If Case Keys . Up ' 先頭 項目 が 選択 さ れ て いる とき If ComboBox 1 .S electedIndex = 0 Then ' 直前 の コントロール を アクティブ に する p .S electNextControl ( ActiveControl , False , True , True , True ) e .S uppressKeyPress = False Exit Sub End If ' コンボボックス の 選択 項目 を ひとつ 上 の 項目 に する If ComboBox 1 .S electedIndex > 0 Then ComboBox 1 .S electedIndex -= 1 End If End Select End Sub 回答 ２ VB . Net の コンボボックス で は 何 も 指定 し なく て も ダブルクリック で 項目 の 全 選択 が 可能 です 。 
UserForm _ QueryClose は フォーム が 閉じ られる 場合 に 発生 し て 、 Cancel 引数 で イベント を 中止 する こと が でき ます 。 また 、 CloseMode 引数 で イベント が 発生 し た 原因 、 例えば × ボタン が 押さ れ た の か OS が シャットダウン しよ う と し て いる の か など を 知る こと が でき ます 。 UserForm _ Terminate イベント は Class _ Terminate イベント と 同じく クラス の インスタンス が 破棄 さ れる 直前 に 発生 し ます 。 この イベント で は 主 に 終了 処理 を 実行 し ます 。 
http:// excel - ubara . com / excelvba 4 / EXCEL 244 . html 
触っ た COM オブジェクト を 全て 解放 し ない と プロセス が 残る こと が 有り ます 。 http:// www . asahi-net . or .jp /~ ef 2 o - inue / vbnet / sub 13 _ 03 _ 030 . html オブジェクト を 管理 する ラッパー クラス を 作っ て 操作 する の が 一般的 です 。 
一 例 です 。 因みに Find 検索 は B4 の 次 の セル から に なり ます ので 開始 を B 3 に し まし た 。 Sub sample () Dim result As Range , r _ end As String Set result = Range (" B 3 : B 300 "). Find _ ( What := Range (" C1 "). Value , LookAt := xlPart ) If result Is Nothing Then MsgBox " 該当 データ が ありません ！" Exit Sub Else r _ end = result . Address Do result .S elect msg = MsgBox (" 検索 を 続け ます か ？", vbQuestion + vbOKCancel ) If msg = vbCancel Then Exit Sub Set result = Range (" B 3 : B 300 "). FindNext ( result ) Loop Until r _ end = result . Address MsgBox " 以降 に 該当 データ は 見つかり ませ ん でし た ！", vbInformation End If End Sub 
文法的 に いう と 正確 に は If Date > CDate (" 2016 / 6 / 2 ") Then や If Date > # 6 / 2 / 2016 # Then な ん でしょ う ね 。 Excel なら （ 他 の アプリケーション は 知り ませ ん ） If Date > " 2016 / 6 / 2 " Then で OK 
質問 の コード だけ を 実行 する と コピー さ れ た シート の ほう の A 2 から E3 の セル の データ が クリア さ れ ます が 、 コピー 元 の シート は データ は 残っ て い ます 。 たぶん 、 コード の 途中 途中 の コード が 抜け た 状態 を 質問 と さ れ て いる よう です ので 、 書か れ て い ない コード の ほう に 問題 が あり そう です ね 。 次 の よう に 書き換え て み て は ？ ShName に コピー 元 の シート 名 を 取得 し て から 、 その シート 名 を コピー し ます 。 コピー する と 、 コピー さ れ た シート が ActiveSheet に 自動 に なる こと を 利用 し て ください 。 Sub CopySh () Dim ShName As String ShName = ActiveSheet . Name With Sheets ( ShName ) . Copy after := ActiveSheet ActiveSheet . Name = . Range (" Y1 ") & " 月 分 " End With Range (" A 2 : E3 "). ClearContents End Sub 
面倒 がら ず に 画像 で は なく 、 文章 で 書い て 下さい 。 それ が 質問 する うえ で の マナー です 。 
minaaa _ x さん 1 . パズル は C++ の ほう が 、 組み やすい 。 下 の 順 で 解く ? 2 . 仮 置き なし で 、 解ける もの 。 3 . 仮 置き し て 、 解く もの 。 
R [- 33 ] C [- 10 ] は 相対 参照 です から 、 それ を 絶対 参照 に し たい の でしょ う か 。 現在 は 、 関数 が 指定 さ れ て いる セル から 33 行 前 の 10 列 前 が 指定 さ れ て い ます 。 たとえば 、 関数 が 指定 さ れ て いる セル が K 40 （ R40 C11 → 40 行 目 11 列 目 ） と すれ ば 、 33 行 前 の 10 列 前 は セル A 7 な ので ７ 行 目 1 列 目 な ので 「 R 7 C1 」 と し ます 。 
Visual Basic の カテゴリー で 質問 し た ほう が 、 的確 な 答え が 来る でしょ う 。 http:// chiebukuro . yahoo . co.jp / dir / list / d2 078297666 / list 
何 が 聞き たい の でしょ う か ？ 
何 が 聞き たい の でしょ う か ？ 
共に 数字 が ない 場合 に は And を 使っ て いる なら 、 どちら か なら Or とか ？ かけ算 を For Next で 累乗 の 回数 分 繰り返せ ば 良い の で は ？ 
面倒 がら ず に 画像 で は なく 、 文章 で 書い て 下さい 。 それ が 質問 する うえ で の マナー です 。 
回答 し 直し て ます 前回 提示 し た Samp 1 は 、 除外 する 人 が い なけれ ば ソコソコ 動き ます ある程度 、 除外 者 を 連続 設定 する と 、 無限ループ に 陥る ･･･ チョット 処理 を いじっ た Samp 2 を ･･･ 以下 記述 内容 として は 、 文字数 の 関係 で 、 前回 の 回答 の Samp 1 を Samp 2 に 置き換え た だけ です 前回 回答 2016 / 5 / 20 18 : 20 : 27 面白 そう だっ た ので 、 やっ て み まし た ソコソコ 動く と 思い ます が 、 サラッと しか 検証 し て い ない ので ････ おかしい ところ が あっ たら 、 ごめんなさい 以下 の コード は 標準 モジュール に 記述 し ます シート に は 、 添付 図 の 様に 作成 する 情報 を 作っ て おい て 、 その シート を アクティブ に し た 状態 で Samp 1 を 実行 する と 、 結果 を 新規 シート に 表示 し ます 用意 する シート の 情報 ） ・ A 列 A 2 ～ 氏名 ・ B 列 B2 ～ 場所 名 情報 ・ C 列 C 2 ～ 作成 し た 表 から 除外 する 日付 ・ D 列 D2 ～ 割当て 不可 の 人 が ある 日付 ・ E ～ 列 E2 ～ 割当て 不可 の 人 の 名前 表 を 作成 する 月 の 特定 順 ） C 2 , D2 を 順に 見 て 日付 が あっ たら その 月 C 2 , D2 に 日付 が ない 場合 、 実行 し た 翌月 ★～ ～★ を コメント に する と 、 A 2 ～ 記述 し た 人 順 で 割り当て て いき ます （ 除外 する 人が なけれ ば 、 毎月 同じ 順 パターン に ） また 、 A 2 ～ の 順 を 自力 で 変更 する と 、 それなり に 違う パターン に ★～ ～★ で は 、 処理 は 入る 前 に 、 人 の 順 を 変え て いる だけ ･･･ これ は 、 初期 の 表 を 作る だけ な ので 、 途中 で 都合 の 悪く なっ た 人 を 割り当て し なおす ･･･ 別途 コード を 作成 する こと に なり ます ※ やっ て み た 感想 で も いただけれ ば と 思い ます Public Sub Samp 2 ()     Dim dic As Object , dicM As Object , dicE As Object     Dim dicS As Object , dicU As Object , dicW As Object     Dim vA As Variant , vD As Variant , vK As Variant , v As Variant     Dim dt As Date     Dim i As Long , j As Long     Set dic = CreateObject (" Scripting . Dictionary ")     Set dicM = CreateObject (" Scripting . Dictionary ")     Set dicE = CreateObject (" Scripting . Dictionary ")     Set dicS = CreateObject (" Scripting . Dictionary ")     Set dicU = CreateObject (" Scripting . Dictionary ")     Set dicW = CreateObject (" Scripting . Dictionary ")     vA = Range (" A1 "). Current Region . Value     If ( vA ( 2 , 3 ) <> "") Then        dt = vA ( 2 , 3 )     ElseIf ( vA ( 2 , 4 ) <> "") Then        dt = vA ( 2 , 4 )     Else        dt = DateAdd (" m ", 1 , Date )     End If     dt = CDate ( Format ( dt , " yyyy / mm "))     For i = 1 To DateAdd (" m ", 1 , dt ) - dt        dic . Add dt , CreateObject (" Scripting . Dictionary ")        dt = dt + 1     Next     For i = 2 To UBound ( vA )        If ( vA ( i , 1 ) <> "") Then           dicM ( vA ( i , 1 )) = Empty        End If        If ( vA ( i , 2 ) <> "") Then           dicE ( vA ( i , 2 )) = dic E.C ount + 3           dic U. Add vA ( i , 2 ), CreateObject (" Scripting . Dictionary ")        End If        dt = vA ( i , 3 )        If ( dic . Exists ( dt )) Then dic . Remove dt        dt = vA ( i , 4 )        If ( dic . Exists ( dt )) Then           For j = 5 To UBound ( vA , 2 )              If ( vA ( i , j ) <> "") Then dic ( dt )( vA ( i , j )) = Empty           Next        End If     Next ' ★～     Randomize     For i = 1 To 10        v = dicM . Keys ()( Int ( dicM . Count * Rnd ()))        dicM . Remove v        dicM ( v ) = Empty     Next ' ～★     For Each vD In dic . Keys        For Each vK In dicE . Keys           Do While ( 1 )              For Each v In dic S.K eys                 If (( Not dic ( vD ). Exists ( v )) _                    And ( Not dicU ( vK ). Exists ( v ))) Then                    dic ( vD )( v ) = vK                    dicS ( v ) = dicS ( v ) - 1                    If ( dicS ( v ) <= 0 ) Then dicS . Remove v                    dicU ( vK )( v ) = Empty                    If ( dicM . Count = dicU ( vK ). Count ) Then                       dicU ( vK ). RemoveAll                    End If                    Exit For                 End If              Next              If ( Not IsEmpty ( v )) Then Exit Do              For Each v In dic S.K eys                 If ( Not dic ( vD ). Exists ( v )) Then                    dicU ( vK ). Remove v                    dicW ( v ) = Empty                    Exit For                 End If              Next              If ( IsEmpty ( v )) Then                 For Each v In dicM . Keys                    If ( Not dicW . Exists ( v )) Then                       dicS ( v ) = dicS ( v ) + 1                    End If                 Next                 dicW . RemoveAll              End If           Loop        Next     Next     ReDim vA ( 1 To dic . Count + 1 , 1 To dic E.C ount + 2 )     vA ( 1 , 1 ) = Format ( dic . Keys ()( 0 ), " m 月 ")     For Each vK In dicE . Keys        vA ( 1 , dicE ( vK )) = vK     Next     i = 1     For Each vD In dic . Keys        i = i + 1        vA ( i , 1 ) = Format ( vD , " d ")        vA ( i , 2 ) = Format ( vD , "( aaa )")        For Each vK In dic ( vD ). Keys           v = dic ( vD )( vK )           If ( Not IsEmpty ( v )) Then              vA ( i , dicE ( v )) = vK           End If        Next     Next     Application .S creenUpdating = False     With Worksheets . Add ( After := ActiveSheet )        With . Range (" B2 "). Resize ( i , UBound ( vA , 2 ))           . Value = vA           . Range (" A1 : B 1 "). Merge           . Rows ( 1 ). Interior . Color Index = 35           . HorizontalAlignment = xlCenter           . Borders . LineStyle = xlContinuous        End With        . Columns . AutoFit     End With     Application .S creenUpdating = True     Set dic = Nothing     Set dicM = Nothing     Set dicE = Nothing     Set dicS = Nothing     Set dicU = Nothing     Set dicW = Nothing End Sub 
まず 、 再 質問 と 書か れ て い ます が 、 ID 非公開 で は 再 質問 さ れ て も こちら は 以前 の 質問 を 見つける こと が 出来 ませ ん 。 以前 の 質問 と 関連付ける の なら 、 以前 の 質問 の ページ へ の リンク を 明記 し て ください 。 ブック の 結合 は 物凄く たくさん の 事例 が あり ます 。 「 Excel VBA 最終 行 取得 」 で Google なり Yahoo! なり で 検索 し て 見 まし た か ？ 
VBA の 勉強 の 前 に エクセル の 勉強 を し た ほう が よ さ そう です ね 。 ' 5 / 9 は 文字列 に なる ので 、 VBA で 何 か 作業 を し たい 場合 は気 を つけ て ください 。 日付 の まま で 表示 だけ 変え たい の で あれ ば 、 書式 設定 で m / d に し た ほう が いい と 思い ます 。 dim r as range for each r in range ( cells ( 1 , 1 ), cells ( 7000 , 44 )) if ' ５ 桁 の 数字 で 前 ２ 桁 が 42 の 場合 r . numberformatlocal =" m / d " end if next r お 勉強 中 で あれ ば if 分岐 の 部分 くらい 調べ て ください ね 。 
コード 例 です 。 全く 検証 し て い ない ので 、 不具合 が あれ ば ご 返信 ください 。 Sub Sample () Dim Row As Long Dim Code As String Dim BkFullName As Variant Dim Bk As Workbook Dim BkB As Workbook Dim ShtA As Worksheet Dim ShtB As Worksheet Dim i As Long Dim Shell As Object Dim Folder Path As String Dim BkName As String Dim NewBk As Boolean If MsgBox (" この ファイル 以外 の エクセル ファイル は 全て 閉じ て から 実行 し て ください 。 " & vbLf & " 実行 し ます か ？", vbYesNo ) = vbNo Then Exit Sub Set ShtA = ThisWorkbook . Worksheets ( 3 ) Set Shell = CreateObject (" WScript .S hell ") Folder Path = Shell .S pecialFolders (" Desktop ") & "\" & Format ( Date , " yymmdd ") If Dir ( Folder Path , vbDirectory ) = "" Then MkDir Folder Path End If Shell . Current Director y = ThisWorkbook . Path BkFullName = Application . GetOpenFilename (" Excel ファイル ,*. xls *", , , , True ) If Not IsArray ( BkFullName ) Then Exit Sub For i = 1 To UBound ( BkFullName ) For Each BkB In Workbooks If InStr ( BkFullName ( i ), BkB . Name ) > 0 Then GoTo Label 0 Next Set BkB = Workbooks . Open ( BkFullName ( i )) Label 0 : For Each ShtB In BkB . Worksheets NewBk = False Code = ShtB . Name For Row = 3 To ShtA . Cells ( Rows . Count , " A "). End ( xlUp ). Row If ShtA . Cells ( Row , " A "). Value = Code Then BkName = ShtA . Cells ( Row , " B "). Value & " 様 分 . xlsx " '← 拡張子 は 必要 に 応じ て 書き換え て ください 。 Exit For End If Next For Each Bk In Workbooks If Bk . Name = BkName Then GoTo Label 1 Next If Dir ( Folder Path & "\" & BkName ) = "" Then NewBk = True Set Bk = Workbooks . Add Bk .S aveAs Folder Path & "\" & BkName Else Set Bk = Workbooks . Open ( Folder Path & "\" & BkName ) End If Label 1 : ShtB . Copy after := Bk . Worksheets ( Bk . Worksheets . Count ) If NewBk Then Application . DisplayAlerts = False Bk . Worksheets ( 1 ). Delete Application . DisplayAlerts = True End If Next Next For Each Bk In Workbooks If Bk . Name <> ThisWorkbook . Name Then Bk . Close SaveChanges := True Next End Sub （ 注 1 ） この コード は ブック A に 記述 し 、 実行 前 に ブック A 以外 を 閉じ て から 実行 し て ください 。 （ 注 2 ） 保存 する ファイル の 拡張子 は 「 . xlsx 」 に し て い ます が 、 「. xls 」 など に 変更 し たい 場合 は 、 コメント を 入れ た 行 を 書き換え て ください 。 
以下 の 様 な 方法 は どうでしょう やっ て いる こと は Range (" A1 "). Current Region で データ の 範囲 を 求め て おい て 右 隣 の １ 列 を 作業 用 に 使っ て B 列 の 値 が ２ 週間 以内 なら 、 行番号 を 、 でなければ 空白 を これ を 作業 列 に 書き出し 、 重複 の 削除 作業 列 の 空白 だっ た 行 部分 は 削除 さ れ 、 行番号 が 残る ので きれい に し て 少なく なっ た データ に対して 並び 替え ･･･ Public Sub Samp 1 ()     Dim vA As Variant     Dim iDs As Long , iDe As Long     Dim i As Long     iDs = Format ( Date , " yyyymmdd ")     iDe = Format ( DateAdd (" d ", 14 , Date ), " yyyymmdd ")     With ActiveWorkbook . Worksheets (" Sheet 1 ")        With . Range (" A1 "). Current Region           With . Resize (, . Columns . Count + 1 )              vA = . Columns ( 2 ). Value              vA ( 1 , 1 ) = ""              For i = 2 To UBound ( vA )                 Select Case vA ( i , 1 )                    Case iDs To iDe                       vA ( i , 1 ) = i                    Case Else                       vA ( i , 1 ) = ""                 End Select              Next              Application .S creenUpdating = False              i = . Columns . Count              . Columns ( i ). Value = vA              . RemoveDuplicates i , xlNo              . Columns ( i ). ClearContents              .S ort . Cells ( 2 ), xlAscending , Header := xlYes              Application .S creenUpdating = True           End With        End With     End With End Sub 
Excel 2010 VBA の ソース で あれ ば 、 「 開発 」 タブ → 「 Visual Basic 」 で 編集 できる はず です が 、 パスワード でも かかっ て いる の でしょ う か ？ 「 開発 」 タブ が 無い 場合 は 、 「 リボン の ユーザー 設定 」 で 「 開発 」 の チェック を ON に すれ ば 表示 さ れ ます 。 VB （ VB 6 . 0 や VB.NET ） など で 作成 し て 、 . exe ファイル に なっ た 物 は 編集 でき ない ので 、 ソース ファイル が 必要 です 。 
実際 の 色 は 、 どんな 色 コード が 使わ れ て いる の です か ね ？ 色 が 変わら なかっ た セル を 選択 し て 、 ↓ の よう な プログラム で 調べ て み た の でしょ う か ね ？ Sub sample () With Active Cell . Interior If . Color = RGB ( 231 , 255 , 5 ) Then MsgBox " 予想 し て いる 色 と 同色 " Else MsgBox " 予想 の 色 コード ：" & RGB ( 231 , 255 , 5 ) & vbCr & _ " 実際 の 色 コード :" & . Color End If End With End Sub 
Msgbox TypeName ( Range (" A1 : B2 "). Value ) 上記 を 実行 し て みれ ば 分かり ます が 、 Variant 型 配列 を SetText で 扱お う と し て い ます ( 2次元 配列 )。 従っ て 、 ご 質問 の よう な 表記 は でき ませ ん し 、 まとめ て SetText で セット する こと も でき ませ ん 。 Copy メソッド で は 目的 に そぐわない という こと で あれ ば 、 1つ 1つ セル を 参照 し て 、 文字列 変数 に 構成 し 直す しか ない でしょ う 。 
最初 の コード は 、 コード 内 に 条件 と なる 「 男 、 女 」 を 書い て い ます 。 2つ 目 の コード は 、 Sheet 2 の A1 から A 2 に 条件 と なる 文字 を 入れ 、 Sheet 1 の A 列 と 比較 し て 判定 し て い ます 。 条件 と なる 文字 が 増え た 場合 は 、 3 行 目 の Sheet 2 の セル 範囲 を 修正 し ます 。 Sub SexCheck 1 () Dim i As Long For i = 1 To Range (" A " & Rows . Count ). End ( xlUp ). Row If InStr ( Range (" A " & i ), " 男 ") Or InStr ( Range (" A " & i ), " 女 ") Then Range (" B " & i ) = "○" End If Next i End Sub Sub SexCheck 2 () Dim i As Long , Word As Range , rng As Range Set Word = Worksheets (" Sheet 2 "). Range (" A1 : A 2 ") For Each rng In Word For i = 1 To Range (" A " & Rows . Count ). End ( xlUp ). Row If Range (" A " & i ). Value Like "*" & rng . Value & "*" Then Range (" B " & i ) = "○" End If Next i Next rng End Sub 
まず 、 準備 として 、 マクロ を 実行 する ため の 図 を 「 挿入 タブ 」 の 「 図形 」 から 邪魔 に なら ない 場所 に 設定 し て ください 。 Alt を 押し ながら 、 F1 1 を 押し て ください 。 VBA ( マクロ ) を 書く ウインドウ が 表示 さ れる と 思い ます 。 Alt を 押し ながら 、 I を 押し M を 押す と 何やら 真っ白 の 画面 が 出 て くる はず です 。 そこ に 、 下記 の コード を コピー ペースト 後 、 当該 画面 を 閉じ て かまい ませ ん 。 Option Explicit Sub TxtDtGet () Dim Tgt As String , Tmpc As String Dim I As Long , J As Long , K As Long Application .S creenUpdating = False Tgt = Application . GetOpenFilename (" Txt ファイル ,*. txt ") If Tgt = " False " Then Exit Sub End If Range ( Rows (" 2 : 2 "), Rows (" 2 : 2 "). End ( xlDown )). Delete Shift := xlUp I = 1 Open Tgt For Input As # 1 Do Until EOF ( 1 ) Line Input # 1 , Tmpc Tmpc = Replace ( Replace ( Tmpc , "、", ","), vbTab , ",") I = I + 1 K = 0 For J = 0 To UBound ( Split ( Tmpc , ",")) K = K + 1 Cells ( I , K ) = Split ( Tmpc , ",")( J ) Next J Loop Close # 1 Application .S creenUpdating = True End Sub 上記 で 作成 した図 を 左 クリック し 、 マクロ の 登録 を 選択 後 、 TxtDtGet を 選択 し 、 OK を クリック 。 これ で 図 を クリック する と 動く はず です 。 注意 ： 1 行 目 は 見出し と し 、 A 列 2 行 目 から 処理 する よう に なっ て い ます 。 実行 する 度 に 、 データ 部 を クリア する 必要 は あり ませ ん 。 見出し 部 を 残し 、 データー 部 を クリア し て 処理 する よう に し て い ます 。 マクロ を 含ん だ ワークブック を 保存 する 際 は 、 Excel 2003 以前 なら 問題 ない の です が 。 Excel 2007 以降 で あれ ば 、 必ず 拡張子 を xlsm と し て ください 。 
「 VisualBasic 2015 」 は 「 .NET Framework 」 上 で 動作 する ので 「 .NET 」 系 です 。 「 VisualBasic 6 . 0 」 と は 別物 です 。 （ 仕組み が 全然 違い ます ） ↓ Microsoft Visual Basic .NET https :// ja . wikipedia . org / wiki / Microsoft _ Visual _ Basic _. NET 「 バージョン の 履歴 」 など も 書い て 有る ので 、 「 VisualBasic 2015 」 が どっち な の か 分かる でしょ う 。 
A 社 ＿ 東京 ＿ 大阪 の リンク する PDFファイル の 保存 場所 ファイル 名 を フル バス で 教え て 下さい ・ ・ ・ HYPER LINK 関数 と INDIRECT 関数 の 組みあわせ で ・ ・ 
> 二つ目 の ＣＳＶ ファイル 選択 時 に キャンセル し た 場合 、 一つ 目 に 開い た ブック は 閉じ たい です 。 と いう より 、 先 に ファイル 選択 を ２ 回 し て 、 それ から ２ 回 Ｃ ＶＳ ファイル を 取り込ん で は どうでしょう か ？ （ strFileName も 配列 に し ます ） > 2つ の CSV データ を 、 ひとつ の エクセル に 抽出 し たい です 。 どの よう に ひとつ に し たい の でしょ う か 。 > ふたつ の ＣＳＶ を wb ( 1 ) と wb ( 2 ) に セット できれ ば 解決 し ます 。 上記 の コード で も wb ( 1 ) と wb ( 2 ) に セット さ れ て いる ので ＯＫ な ん でしょ う か ？ 思う に 、 一つ の ブック で １つ 目 の シート と 、 ２つ 目 の シート に 入れ たい の で は ない か と 想像 し ます が 、 違い ます か 。 （ サンブル ） Sub sample () Dim i As Long Dim strFileName ( 1 To 2 ) As String Dim wb As Workbook Dim ws ( 1 To 2 ) As Worksheet ' ファイル の 選択 を 繰り返し 、 途中 で キャンセル さ れれ ば 開か ず に 終わる For i = 1 To 2 strFileName ( i ) = Application . GetOpenFilename ( FileFilter :=" CSV ファイル (*. csv ),*. csv , テキストファイル (*. txt ),*. txt ", Title := cnsTITLE ) If ( strFileName ( i ) = " False ") Then Exit Sub Next i ' 新しい ブック を 一つ 追加 Set wb = Workbooks . Add For i = 1 To 2 ' シート が 足り ない 場合 は 追加 する If wb . Worksheets . Count < i Then wb . Worksheets . Add After := wb . Worksheets . Count ' ws に シート を セット し 、 CSV を セット する Set ws ( i ) = wb . Worksheets ( i ) With ws ( i ). QueryTables . Add ( Connect ion :=" TEXT ;" & _ strFileName ( i ), _ Destination := ws ( i ). Range (" A1 ")) . AdjustColumnWidth = False . TextFilePlatform = 932 . TextFileCommaDelimiter = True . TextFileColumnDataTypes = Array ( 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , _ 1 , 1 , 1 , 1 , 1 , 1 , 2 , 2 , 1 , 1 , _ 1 , 1 , 2 , 2 , 2 , 1 , 1 , 1 , 1 , 2 , _ 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 ) . Refresh . Delete End With Next i End Sub 
On Error の タイミング が 悪い でしょ う 。 あと 、 On Error は 出所 構わ ず 、 すべて の エラー を 対象 と する ので 、 ピンポイント で 使用 する の が 肝心 。 Sub シート 並べ替え () Dim i As Long With Worksheets (" 顧客 一覧 ") . Hyperlinks . Delete . Move before := Worksheets ( 1 ) For i = 2 To . Cells ( Rows . Count , 2 ). End ( xlUp ). Row On Error Resume Next Worksheets (. Cells ( i , 2 ). Value ). Move after := Worksheets ( i - 1 ) On Error GoTo 0 Next i . Activate End With End Sub 
コントロール ソース は 、 「 テーブル 上 の 各 フィールド 」 を 設定 し ます 。 これ だけ で フォーム 上 で 入れ た もの が テーブル に 格納 さ れ ます 。 その後 、 コンボボックス の 更新 後 処理 イベント において 、 各 テキストボックス に 「 代入 」 し ます 。 Private Sub コンボボックス 名 _ AfterUpdate () Me ![ テキストボックス 1 ] = Me ![ コンボボックス 名 ]. Column ( 1 ) Me ![ テキストボックス 2 ] = Me ![ コンボボックス 名 ]. Column ( 2 ) End Sub 
[ Ctrl ]+[ H ] で 置換 画面 を 開き ます 。 検索 する 文字列 に は 「 *」 を 入れ 、 その 右 の 「 書式 ボタン 」 を 押し て 、 該当 の 色 の 塗りつぶし を 選択 し ます 。 置換え 後 の 文字列 に セット し たい 数字 （ 文字 ） を 入れ ます 。 「 すべて 置換 」 ボタン を 押し ます 。 
上記 の コード なら 上書き で 出力 さ れ ます 。 ただし 、 Application . GetSaveAsFilename で 保存 先 ファイル 名 を 指定 する と 、 出力 先 の フォルダ は 変更 でき ます し 、 ファイル 名 も 変更 さ れ て しまい ます 。 もう 、 確認 せ ず に 上書き する なら csvFile = "￥￥ １ １ １ ． １ １ １ ． １ １ １ ． １ １ １ ￥ データ " & dname & Format ( buf , " mmdd ") & ". csv " として 、 ファイル 名 を 固定 化 し て しまえ ば 良い の で は ない でしょ う か 。 
若干 、 誤解 が 生じ そう な 質問 内容 です 。 Sub 一 例 です () Dim i As Long , rng As Range , rngs As Range Dim x1 Adr As String , xrow As Long With Range (" A1 "). Current Region With . Offset ( 1 ). Resize (. Rows . Count - 1 ) For i = 1 To . Rows . Count If . Cells ( i , 1 ). Value <> 0 Then Set rng = . Find (. Cells ( i , 2 ). Value , LookIn := xlValues , LookAt := xlPart ) If Not rng Is Nothing Then x1 Adr = rng . Address Do rng . Font . Color = vbRed If rng . Column = 2 Then If rngs Is Nothing Then Set rngs = rng Else Set rngs = Union ( rngs , rng ) End If End If Set rng = . FindNext ( rng ) Loop While rng . Address <> x1 Adr End If End If Next i If Not rngs Is Nothing Then Rows ( 2 ). Resize ( rngs . Cells . Count ). Insert rngs . EntireRow . Copy Rows ( 2 ). PasteSpecial rngs . EntireRow . Delete End If End With End With End Sub 
コンボボックス の 内容 が 変更 さ れ た とき に 、 その 値 で VLOOKUP 関数 を 使っ て Ｂ 列 の 内容 を 検索 し 、 Ｃ １ に セット する 。 サンプル Private Sub ComboBox 1 _ Change () If ComboBox 1 . ListIndex >= 0 Then Range (" C1 "). Value = Application . WorksheetFunction . VLookup ( ComboBox 1 . Value , Range (" A : B "), 2 , False ) End If End Sub 
シート が 保護 さ れ て いる の です から 、 セル に 色 を 付ける こと は でき ませ ん 。 方法 として は ( 1 ) 保護 を 解除 し て 色 を 付け て 、 再度 保護 する ActiveSheet . UnProtect Range (" K5 "). Interior . Color Index = 3 ActiveSheet . Protect ( 2 ) 対象 の セル （ K5 ） の ロック を はずし て おき 、 シート 保護 する 時 に 「 セル の 書式 設定 」 は 許可 する よう に する （ VBA なら ActiveSheet . Protect AllowFormattingCells := True ） ( 3 ) シート の 保護 を する 時 に UserInterfaceOnly を 付ける これ は VBA で 保護 する 場合 のみ 指定 できる オプション で 、 画面 上 から の 変更 は 保護 さ れ ます が 、 マクロ から の 変更 は 保護 さ れ ませ ん 。 ActiveSheet . Protect UserInterfaceOnly := True WorkSheet が 保護 さ れ た とき に セル を 赤く する 方法 は わかり ませ ん 。 
http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1416000673 ... この 質問 に対して 何 の 対応 も せ ず に 、 同じ 質問 です か ？ 納得 できる 理由 が なけれ ば 、 マルチポスト として 違反 報告 し ます が ？ 
dplyr という ライブラリ を 使う と 簡単 に でき ます 。 http:// qiita . com / matsuou 1 / items / e 995 da 273 e3 108 e233 8 e 基礎 編 と JOIN 編 が 参考 に なる と 思い ます 。 R の 基礎 は この あたり http:// cse . naro . affrc . go .jp / takezawa / r - tips / r . html グラフ は g gp lo t2 が あり ます 。 多少 クセ が あり ます ので 最初 は 一般 的 な plot 命令 が よい よう に 思い ます 。 
API を 使っ て 、 wav ファイル を 再生 し ます 。 Windows の 効果音 (" C :\ Windows \ Media \ tada . wav ") を 再生 する 例 です 。 Private Declare Function mciSendString Lib " winmm . dll " Alias " mciSendStringA " ( ByVal lpstrCommand As String , ByVal lpstrReturnString As String , ByVal uReturnLength As Long , ByVal hwndCallback As Long ) As Long Sub sample () Dim file As String file = " C :\ Windows \ Media \ tada . wav " ' 再生 し たい サウンド ファイル mciSendString " Play " & file , "", 0 , 0 End Sub ただ 、 再生 ファイル の フォルダ 名 や ファイル 名 に スペース が 含ま れる と 再生 でき ない ので 、 スペース を 含ま ない フォルダ と ファイル を 用意 し て ください 。 
こんにちは。 > Web ページ から の メッセージ 」 ボックス に 表示 さ れ て いる メッセージ の 取得 方法 を 教え て ください 。 セキュリティ の 挙動 の 取得 は 、 でき ませ ん よ 。 ie の セキュリティ がらみ の ウィンド 画面 の 制御 が 必要 な の でしょ う か 。 もしかして 、 ブラウザー の バージョン が 違っ て い て 、 仕様 の 限界 の よう な きが し ます ど 。 
アプリ も 問題 ある かも しれ ませ ん が 、 OS が なに か も 判っ て い ない し 、 ミドルウェア 有る なら 、 その 辺り も 変わっ て くる でしょ う 。 しかし 、 Windows 7 だっ た として も 推奨 メモリ は 32 ビット だ として も 「 快適 に 動作 さ せる 場合 は 2 GB 以上 を 推奨 」 と 謳っ てる ん です から 、 想定外 だ と 思い ます けど ね １ G メモリ の 環境 は 。 
一 例 です 。 Sheet 1 の シート モジュール に 登録 し て お 試し ください 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) If Target . Address ( 0 , 0 ) = " A1 " Then Select Case Target Case " a 001 ", " a 002 ": wk = " Sheet 2 " Case " b 001 ", " b 002 ": wk = " Sheet 3 " Case Else : wk = " Sheet 1 " End Select If wk <> "" Then Application . Goto Sheets ( wk ). Cells ( 1 , 1 ) End If End Sub 
せっかく な ので 確認 し て み まし た 。 Class Library 1 . dll 側 に Form 1 を 追加 し て 当該 の 処理 を 入れ まし た 。 back の 戻り値 を 確認 する ため に Case 文 の 前 に Console . Write Line ( back . ToString ) を 追加 し てる 以外 は 同じ です 。 Public Class Form 1 ____ Private Sub btnEnd _ Click ( ByVal sender As Object , ByVal e As EventArgs ) Handles btnEnd . Click ________ Dim back As Long ________ back = MsgBox ((" 当 処理 を 終了 し 画面 を 閉じ て よろしい です か "), vbOKCancel , " 終了 処理 ") ________ Console . Write Line ( back . ToString ) ________ Select Case back ____________ Case vbOK ________________' 閉じる ________________ Me . Close () ____________ Case vbCancel ________________ Return ________ End Select ____ End Sub End Class 一方 新規 で 作成 し た プロジェクト で Class Library 1 . dll を 参照 設定 し て Form 1 を 呼び出し ます 。 雑 で すい ませ ん が 名前 が 被る ので こちら の デフォルト Form は Form 2 に し て ます 。 ボタン を 押す と dll の Form 1 を モーダル し ます 。 Imports Class Library 1 Public Class Form 2 ____ Private Sub Button 1 _ Click ( sender As Object , e As EventArgs ) Handles Button 1 . Click ________ Dim f As New Class Library 1 . Form 1 ________ f .S howDialog ( Me ) ____ End Sub End Class これ を 実行 し て みる と 正常 に 動作 し まし た 。 また 、 back に は キャンセル 時 に 2 、 OK 時 に 1 が 入っ てる ので 正しく 分岐 出来 て ます 。 という こと で 質問者 さん の ソース の back の 中身 が 気 に なる ところ です 、 キャンセル し て も 閉じる という こと は 、 Case 文 で 分岐 し てる のに vbOK の 方 しか 走っ て ない という こと です よ ね ？ Console . Write line で 結果 を チェック し て み て ください 。 と 、 根本 的 な ところ です が 右 上 の × 印 を 押し た 時 も 確認 処理 を 入れる の で あれ ば そもそも ボタンクリックイベント に この 記述 する べき で は ない です 。 画面 を 閉じる パターン は 他 にも Alt + F4 の ショートカットキー とか あり ます から 終了 確認 は FormClosing イベント に 集約 する と いい と 思い ます 。 Public Class Form 1 ____ Private Sub btnEnd _ Click ( ByVal sender As Object , ByVal e As EventArgs ) Handles btnEnd . Click ________ Me . Close () ' 閉じる だけ ____ End Sub ____ Private Sub Form 1 _ FormClosing ( sender As Object , e As Windows . Forms . FormClosingEventArgs ) Handles Me . FormClosing ________ If MsgBox ((" 当 処理 を 終了 し 画面 を 閉じ て よろしい です か "), vbOKCancel , " 終了 処理 ") _ ________= MsgBoxResult . Cancel Then ____________ e . Cancel = True ________ End If ____ End Sub End Class 
Stream は IDisposable インターフェース を 実装 し て いる ので 、 コンストラクタ で 渡す 設計 は 個人的 に は し ない です ね 。 ただ 、 IDisposable インターフェース を 実装 し て いる クラス で も テスト 用 の コンストラクタ として 、 Stream の Mock など を 渡す よう に 設計 する こと は あり 得 ます 。 その 場合 は （ C ) でしょ う ね 。 また 、 Stream を 引数 と する メソッド を 作る 可能性 は 普通 に あり ます 。 
シート に リスト 形式 で データ を 作成 て いる なら Countif 関数 で 予め 氏名 に 一致 する データ の カウント 数 を 出し て If ステートメント で 条件 分岐 し 、 カウント 数 が 0 だっ たら エラーメッセージ を 表示 する よう に する 等 が いい の で は ？ あと は http:// office tanaka .net / excel / vb a/t ips / tips 142 . htm 等 が 参考 に なる かも しれ ませ ん 。 
シャットダウン を 止める 事 は 不可能 。 シャットダウン プロセス は 最高 位 の 権限 で 実行 さ れる こと な ので 一般 の アプリ から どうこう できる 物 じゃ ない 。 それ 以前 に PC の 電源 ボタン 長押 しさ れれ ば 、 強制 シャットダウン に なる ので どんな 手 を 使っ て も 阻止 でき ない から 。 それ が PC - AT互換機 ( 一般 的 な パソコン の 事 ) の 仕様 な ので 。 
コード の 記載 が ない ので 何とも です が 、 2次元 に し て おい て 、 出現 回数 を カウント し て は ？ または Countif で 範囲 内 の 数 を 数える か 。 
ご 質問 の 意図 が 分かり にくい の です が 、 作成 し コンパイル 済み の プログラム を 起動 する のに 、 PowerShell を 介し たい 、 という 意味 で は ない です よ ね ？ それ こそ 、 exe を 呼び出し すれ ば 良い だけ です し 、 そんな わけ は ない ん だ と 推察 し ます 。 何 を どう し たく て どこ が わから ない の か 、 具体 的 に お願い し ます 。 
マクロ で は 有り ませ ん が 4 . 0 マクロ 関数 ・ GET . WORKBOOK シート 一覧 名前 定義 で 名前 例 book 範囲 ブック 選択 参照 範囲 = GET . WORKBOOK ( 1 ) = IFERROR ( SUBSTITUTE ( INDEX ( book , ROW ( A 2 )),"["& doc &"]",""),"") 下 方向 に コピー 4 . 0 マクロ 関数 ・ GET . WORKBOOK ファイル は 名前 を 付け て 保存 で xlsm 形式 で 保存 http:// www . tipsfound . com / excel 2013 / 01306 
' 修正 例 Public Sub str ( ByVal a () As String ) Dim x As Integer = a . Length - 1 Console . Write Line ( x * 4 ) End Sub それ と VB.NET で は 、 配列 の 長さと 添え 字 ( Index ) は 異なり ます 。 質問者 さん の 場合 は Dim x As Integer = a . Length で は ない でしょ う か ? 
Set R = R . End ( xlDown ). Offset ( 1 ) は 、 セル R （ 最初 は A1 ） から 下 方向 に 有効 な セル を 探し て （[ Ctrl ]+[↓] を 押し た 時 と おなじ ） 、 さらに その 一つ 下 の セル を R に セット し ます 。 ようするに 、 次に コピー する セル 位置 を 移動 さ せ て い ます 。 なぜ エラー に なる か と 言う と 、 コピー が １ 行 しか さ れ なかっ た 場合 、 セル R の すぐ 下 は 空白 です 。 そんな 状態 で [ Ctrl ]+[↓] を 押す と 最下 行 に 行っ て しまい ます よ ね 。 その さらに 次 の 行 は 無い ため エラー に なり ます 。 回避 する なら If R . Offset ( 1 ). Value = "" Then Set R = R . Offset ( 1 ) Else Set R = R . End ( xlDown ). Offset ( 1 ) End If と する と 良い でしょ う 。 気 の せい か 、 昼間 に も 同じ よう な コード を 見 た よう な 気 が し ます が ・ ・ 
> 今日 の 日付 を 検索 しよ う と 思う の です が 上手く いき ませ ん 。 原因 は 、 B 列 の 日付 は = B5 + 1 として 日付 を 表現 し て いる から です 。 単なる 加算 の 場合 は 、 その 日付 は 見かけ で あっ て 、 本来 の 日付 を 表す シリアル 値 が 存在 し ない から です 。 そこで 、 現状 の まま で 検索 し たい の で あれ ば 、 B 10 から B 161 まで の 表示 形式 を 「 * 2012 / 3 / 14 」 に 変更 し て 以下 の コード で 検索 でき ます 。 Sub Test () Dim FoundCell As Range , Hani As Range , myToday As Date Set Hani = Range (" B 10 : B 161 ") myToday = Range (" B 1 ") Set FoundCell = Hani . Find ( What := DateValue ( myToday ), LookIn := xlValues ) If Not FoundCell Is Nothing Then FoundCell .S elect End If End Sub 表示 形式 を 「 m / d 」 など と 表現 し たい 場合 は 、 日付 の セル を 「 = B5 + 1 」 という もの で は なく 、 ちゃんと 「 2016 / 5 / 1 」 と シリアル 値 と 認識 できる 日付 で 入力 し て ください 。 連続 日 なら 、 日付 を 下 に ドラッグ する と 簡単 に １ 日 毎 の 日付 に なり ます 。 シリアル 値 の 日付 に し たら 表示 形式 を 変更 し て 、 以下 の コード に し ます 。 Sub Test () Dim FoundCell As Range , Hani As Range , myToday As Date Set Hani = Range (" B 10 : B 161 ") myToday = Range (" B 1 ") Set FoundCell = Hani . Find ( What := DateValue ( myToday ), LookIn := xlFormulas ) If Not FoundCell Is Nothing Then FoundCell .S elect End If End Sub ※ 変更 し た ところ は Find メソッド の LookIn 引数 の 定数 です 。 
こんにちは。 hidden で 、 innertext は 、 見え ない でしょ 。 もし 、 取り出せ たら 、 hidden で ない 属性 の とき です 。 どっち か 。 . value で 取り出せる か 、 やっ て み て ください 
InputBox は ２つ ある ので 注意 し て ください 。 Sub inputbox 関数 の 例 () Dim rtn rtn = InputBox (" 知恵袋 の 質問 ？") If rtn = "" Then Exit Sub MsgBox rtn & " が 入力 さ れ まし た " End Sub Sub inputbox メソッド の 例 () Dim rtn rtn = Application . InputBox (" 知恵袋 の 質問 ？") If TypeName ( rtn ) = " Boolean " Then Exit Sub MsgBox rtn & " が 入力 さ れ まし た " End Sub http:// office tanaka .net / excel / vb a/t ips / tips 37 . htm 
> 条件 Z 列 が C の 場合 、 E 列 の 値 を A 列 に 貼り 付け たい （ 値 のみ ） で あれ ば 、 Z 列 を 順に チェック し " C " なら E 列 の 値 を A 列 に 貼り 付け ます 。 （ サンプル ） Sub Sample () Dim r As Long ’ Ｚ 列 の 先頭 から 最終 行 まで 繰り返し For r = 1 To Range (" Z " & Rows . Count ). End ( xlUp ). Row ' Z 列 が " C " なら E 列 の 値 を A 列 に コピー If Range (" Z " & r ). Value = " C " Then Range (" A " & r ). Value = Range (" E " & r ). Value Next End Sub 
シート ２ の 全て の セル の 値 を 貼り 付け （ コピー し て 値 の 貼り 付け ） すれ ば 、 シート を コピー し て も 問題 ない と 思い ます 。 VBA で 簡単 に 行う 方法 として は Worksheets (" シート ２ "). UsedRange . Value = Worksheets (" シート ２ "). UsedRange . Value Worksheets (" シート ２ "). Copy で 一括 し て 行う こと が でき ます 。 ただし 、 この まま で は シート ２ の 式 が 消え て しまい ます ので 、 保存 せ ず に 終われ ば 元 に 戻り ます が 、 それ が でき ない 場合 も ある でしょ う 。 その 場合 は 、 まず シート ２ を コピー 。 その あと 、 シート ２ の 値 を 新しい シート （ コピー し た シート ） に 値 の 貼り 付け を し ます 。 Worksheets (" シート ２ "). Copy ThisWorkbook . Worksheets (" シート ２ "). UsedRange . Copy ActiveSheet . Range (" A1 "). PasteSpecial ( xlPasteValues ) Application . CutCopyMode = False 
こんにちは。 > 以前 visual basic で 作成 さ れ た 販売 管理 システム 示し て いる コード は 、 VB の コード で は あり ませ ん 。 確認 し て ください 
> If Dir ( Workbook _ path & "\" & Filename & Right (" 00 " & CStr ( fCount ), 3 ) & ". csv ") = "" Then で 、 これから 保存 しよ う と し て いる ファイル 名 の 存在 確認 を し て い ます よ ね 。 この 時 に 、 「 And 」 を 使っ て サブ フォルダ 内 について も 存在 確認 を する 方法 は どうでしょう か ？ If Dir ( Workbook _ path & "\" & Filename & Right (" 00 " & CStr ( fCount ), 3 ) & ". csv ") = "" And Dir ( Workbook _ path & "\ サブ フォルダ 名 \" & Filename & Right (" 00 " & CStr ( fCount ), 3 ) & ". csv ") = "" Then 
UTF-8 は Unicode の エンコード 方式 の 一つ です 。 Unicode に は 複数 の エンコード 方式 ( UTF-16 、 UTF-8 ) など が あり ます が 、 規格 内 に 収録 し て いる 文字 の 文字集合 ( レパートリー ) は 同一 です 。 ただし 、 Unicode 規格 は 今 も 改定 さ れ て おり 、 収録 文字数 は 増え 続け て い ます 。 UTF-16 の 場合 、 2 文字 の 組 ( 2 バイト * 2 文字 分 ) で 1 文字 を 表す サロゲートペア という もの が あり ます 。 Unicode に 対応 し て いる システム で も サロゲートペア 文字 を 正しく 1 文字 として 扱わ ない で 、 2 文字 として 扱う もの も あり ます 。 また 、 Unicode は 合成 文字 や 異体字 セレクター ( IVS ) など 非常 に 複雑 な 仕組み を 持つ 仕様 に なっ て い ます 。 シフトJIS ( Shift_JIS ) は 元々 規格 が あっ て でき て 文字コード で は なく 実装 ( 三菱 の マルチ 16 という PC 用 ) が 先 に あっ て 、 その後 日本 の PC 用 の 事実上 の 文字コード の 標準 として 広まり まし た 。 規格 として は 後 追い で JIS規格 の JIS X0208 の 付属 書 に シフト 符号化 表現 として 規定 さ れ まし た 。 ただし 、 実装 は 各社 の PC で 異なっ て い て 、 各社 の PC ごと に エンコード 方式 は 同じ です が 、 レパートリー が 異なる 「 シフトJIS 」 が あり まし た 。 今 は 、 Windows 上 の シフトJIS と Mac OS9 以前 で 使用 さ れ て い た シフトJIS に 収斂 し て い ます 。 Windows 上 の シフトJIS は 、 「 本当 の シフトJIS 」 に NEC 特殊文字 と IBM 拡張 文字 および NEC 選定 IBM 拡張 文字 を 付加 し た 文字集合 を 持ち ます 。 「 本当 の シフトJIS 」 と 区別 する 場合 は 、 コードページ 932 ( CP932 ) や Windows-31J 、 MS 漢字 コード など と 呼び ます 。 Mac OS9 以前 の 「 シフトJIS 」 は Mac Japanese と 言い ます 。 JIS X0208 の 後継 規格 で ある JIS X0213 に は 、 Shift_JIS - 2004 が 規定 さ れ 、 使用 できる 文字集合 が 拡張 さ れ まし た が 、 増え た 文字 の コード ポイント は 従来 の シフトJIS と 互換性 が ない ので 普及 し て い ませ ん 。 文字集合 の 大き さ は Unuicode > CP932 > Shift_JIS です 。 従って 、 Unicode → CP932 / Shift_JIS で は 変換できない 文字 が 出 て き ます 。 たとえば 森鷗外 の 「 鷗 」 は 森鴎外 に し ない と 文字化け し ます 。 CP932 → Shift_JIS の 場合 は 、 前述 の NEC 特殊文字 と IBM 拡張 文字 および NEC 選定 IBM 拡張 文字 は 使用 でき ませ ん 。 どの よう な 文字コード を 使う か は 使用 する データベース によって ことなり ます 。 たとえば SQL - Server は char 、 varchar で 格納 できる 文字コード は 日本語 環境 で は CP932 です 。 nchar 、 nvarchar は Unicode が 格納 でき ます 。 Shift_JIS は 半角 英 数 カナ は 1 バイト 、 全角 文字 ( 漢字 など ) は 2 バイト で エンコード さ れ ます 。 UTF-16 は 、 Unicode の 基本多言語面 に ある 文字 は 1 文字 2 バイト 、 その他 の 拡張 面 に ある 文字 は 1 文字 4 バイト ( サロゲートペア ) で エンコード さ れ ます 。 UTF-8 は 1 文字 1 バイト - 4 バイト で エンコード さ れ ます 。 ただし Oracle の 「 UTF-8 」 は 1 - 6 バイト で エンコード さ れ ます 。 本来 の UTF-8 の 場合 は 、 Oracle で は 「 AL 32 UT F8 」 という 名称 に なっ て い ます 。 1 バイト の 文字 は ASCII に ある 文字 で 、 漢字 や カナ は 3 バイト で エンコード さ れ ます 。 なお 、 合成 文字 や IVS が 使用 さ れる 場合 は 、 1 文字 の バイト 数 は 、 バイナリーエディター 等 で 確認 する まで わかり ませ ん 。 
マクロ の 一 例 。 データ は Sheet 1 の A 列 から D 列 で 20 行 目 まで と し て い ます 。 データ は Sheet 2 に 転記 。 Sub Test () Dim i As Long , j As Long , k As Integer k = 1 For i = 1 To 20 Step 2 For j = 1 To 4 Step 2 If Cells ( i , j ) <> "" Then Cells ( i , j ). Offset ( 1 ). Resize (, 2 ). Copy Sheets ( 2 ). Cells ( k , 1 ) k = k + 1 End If Next j Next i End Sub 
WIN 2015 って もの が 何 物 か 判り ませ ん が 、 EXCEL 2007 で あれ ば 。 「 こちら の 3 行 で 1 データ に つき 、 1 グラフ を 300 こ 近く 作り たい の です が 、 マクロ など で 可能 でしょ う か ？ 」 と 言う 質問 の 回答 は 「 可能 」 です 
「 " 0 : 00 " に なっ たら 、 処理 を 終了 する 」 と なっ て いる ので 、 モジュール 自身 を コール し たら ？ 
「 デスクトップ 」 や 「 マイ ドキュメント 」 など の 特定 の フォルダ 名 は 物理 的 な パス 名 と 異なっ て い ます 。 もしかして 、 TextBox 1 に は そういう 名前 を 指定 し て い ませ ん か ？ 
ブック B を アクティブ に し て 、 実行 し て ください 。 Sub 一 例 です 。 () Dim rng As Range , xPath As String , sh As Worksheet , sh 0 As Worksheet , i Application .S creenUpdating = False Set rng = Workbooks (" ブック A . xlsx "). Worksheets (" シート 2 "). Columns ( 1 ) With ActiveWorkbook xPath = . Path & "\" For Each sh In . Worksheets With sh i = Application . Match (. Name , rng , 0 ) If Not IsError ( i ) Then If sh 0 Is Nothing Then . Copy Else . Copy after := sh 0 Application . DisplayAlerts = False sh 0 . Delete Application . DisplayAlerts = True End If Set sh 0 = ActiveSheet sh 0 . Parent .S aveAs Filename := xPath & rng . Cells ( i ). Offset (, 1 ). Value & " 様 分 " End If End With Next sh End With If Not sh 0 Is Nothing Then sh 0 . Parent . Close savechanges := False End If Application .S creenUpdating = True End Sub 
With Worksheets (" Sheet 1 ") の 部分 以降 を 関数 化 し て 、 目的 の Worksheet 名 を 引数 で 渡す の が 一番 簡単 だ と 思い ます ね 。 Sheet 1 から 5 まで すべて が 対象 なら ば 、 for each 文 で 回す 手 も 有り ます が 、 複数 シート の 内 特定 の シート だけ と なる と 、 別 関数 に し た 方 が すっきり する と 思い ます 。 
提示 さ れ て いる 添付 図 を 参考 に し て い ます 。 職員 番号 を 入力 する シート に ボタン を 配置 し て 、 その ボタン に 下 の マクロ を 登録 し て ください 。 また 、 次 の こと を 前提 に し て い ます 。 ・ 職員 番号 は B4 に 入力 ・ C3 に 「 氏名 」 、 その 下 の C4 は 自動的 に マクロ で 氏名 が 表示 さ れる ・ D6 と E 6 に 、 「 品名 」 、 「 数量 」 という 見出し が 書か れ て いる 。 ・ 一覧 シート の 一行 目 に 見出し 「 職員 番号 」 「 氏名 」 「 品名 」 「 数量 」 が ある Sub KensakuDelete () Dim Bangou As Integer , FC As Range , Hani As Range Dim Ichiran As Worksheet , EndRow As Long , i As Long Set Ichiran = Worksheets (" 一覧 ") Bangou = Range (" B4 "). Value Set Hani = Ichiran . Range (" A1 "). Current Region Set FC = Hani . Columns ( 1 ). Find ( What := Bangou , LookAt := xlWhole ) If Not FC Is Nothing Then Range (" C4 ") = FC . Offset (, 1 ). Value Else MsgBox " 該当 する 番号 は ありません " Exit Sub End If With Hani . AdvancedFilter xlFilterCopy , Range (" C3 : C4 "), Range (" D6 : E 6 ") End With EndRow = Range (" D " & Rows . Count ). End ( xlUp ). Offset ( 1 ). Row Range (" D " & EndRow ). Value = " 合計 " Range (" D " & EndRow ). Offset (, 1 ). Formula = "= SUM ( E 7 : E " & EndRow - 1 & ")" ' 削除 With Ichiran EndRow = . Range (" A " & Rows . Count ). End ( xlUp ). Row For i = EndRow To 2 Step - 1 If . Range (" A " & i ) = Bangou Then . Rows ( i ). EntireRow . Delete End If Next i End With End Sub 
データ の 種別 [ 単なる 実数 ベクトル な の か 何らかの 構造 化 データ な の か ] でも 変わっ て くる でしょ う けど … 外れ値 R で ネット 検索 する だけ で それなり に 引っかかる か と 。 http:// www . okadajp . org / RWiki /? cmd = read & page = R % E3 % 81 % A 7 % E3 % 83 % 87% E3 %... bl <- hazureti ( iris $ Sepal . Width ) iris $ Sepal . Width [ bl $ caselist ] # 外れ値 を 抽出 # iris $ Sepal . Width [! bl $ caselist ] # 外れ値 以外 # #※ 分散 も var (～) で 計算 可能 http:// www . geocities .jp / ancientfishtree / R _ JI . html ページ 内 を 外れ値 で 検索 [ sg . R は UTF-8 ] 自分 で も 検索 し て 見れ ば 良い の で は 。 
Dim RAI As Integer = CInt ( TextBox 2 . Text ) ここ じゃ ない かしら ？ TextBox 2 の 内容 が 数値 か 同か 保障 さ れ て い ませ ん よ ね 。 おそらく 。 http:// adonetvb . com / Learning / TryParse . html この 辺り 確認 し て み て ください 。 
試し て い ませ ん が 以下 で どう です か ' TimeSpan で 1時間 0 分 0 秒 を 計算 し て おい て Dim d As New TimeSpan ( 1 , 0 , 0 ) ' 上記 d の 分 だけ 引き算 Dim c As TimeSpan = b - a - d ' # 01 : 00 : 00 # ■ 参考 http:// dobon .net / vb / dotnet / system / datetimecal . html 
ぱっと 見 です が 、 問題 が ある よう に は 思え ませ ん 。 > LST = Wsb . Columns (" Z "). Find ( objFind ). Row > LST = objFind . Row ... なんで 2つ の 行 の コード を わざわざ 変え て いる の ? という 疑問 は あり ます が ...。 > 実際 表 に は まだまだ 250 行 や 590 行 に も 山田 は あり ます 。 検索 で ヒット し た 山田 と 上記 2 行 の 山田 は 別 な ん じゃ ない です か ? 現状 の 検索 で は 完全 一致 し た セル しか 検索 し て い ませ ん 。 例えば 『 山田 』 とか 『 山田 』 とか 空白 が あっ たり する と 除外 さ れ ます 。 『 山 田 』 とか だ と Find メソッド で は 検索 でき ない です ね 。 確認 し て み て 下さい 。 https :// msdn . microsoft . com / ja - jp / library / office / ff 839746 . aspx F8 キー で ステップ 実行 し つつ 、 ローカル ウィンドウ や ウォッチ ウィンドウ で 変数 や 式 の 変化 状況 を 確認 し て みる と いい でしょ う 。 それでは 。 
Y1 に は 5 や 12 といった 数字 が 入っ て いる こと を 想定 し て いる よう です が 、 実際 に 入っ て いる の は 日付 の シリアル 値 で 書式 設定 で 月 だけ を 表示 し て いる よう に し て い ませ ん か ？ ステップ 実行 は 試し て み まし た か ？ 
たぶん 、 「 Workbooks (" 5月 線量 結果 . csv "). Worksheets (" 5月 線量 結果 ")」 の 部分 が 毎月 変わる ので 困っ て おら れる の です よ ね 。 ワークブック （ CSV ファイル も ） を 開い た 時 、 その ブック を 変数 に セット でき ます 。 さらに CSV ファイル なら シート は １つ しか あり ませ ん 。 開い た ブック が 変数 に セット さ れ 、 さらに １つ 目 の シート を 処理 すれ ば いい わけ です から 、 名前 など わから なく て も 処理 が でき ます 。 Dim WB As Workbook Set WB = Workbooks . Open ( FileName := strFileName ) WB . Worksheets ( 1 ). Range (" A : A , C : C , D : D , E : E , F : F , H : H , I : I , K : K , L : L , M : M , N : N , P : P , Q : Q , R : R , S : S "). Select Range (" S1 "). Activate Selection . Delete Shift := xlToLeft 以降 「 Workbooks (" 5月 線量 結果 . csv "). Worksheets (" 5月 線量 結果 ")」 を 「 WB . Worksheets ( 1 )」 に 置き換え ます 。 また 、 最後 あたり の ActiveWorkbook .S aved = True ActiveWorkbook . Close は WB .S aved = True WB . Close と 書け ます 。 （ または WB . Close SaveChanges := False で も 良い か と 思い ます ） 
Active Cell は 、 B 列 内 に あり ます か ？ After := は 、 その セル の 次 から 範囲 内 を 検索 し ます 。 After := に 指定 し た セル が 検索 範囲 内 に なけれ ば いけ ませ ん 。 
C 列 に 品番 が あり 、 それ を 検索 し 連 番 分 上 の 行 に ある ヘッダ の 行 を ヘッダ で 検索 する 例 です 。 Function プロシージャ 化 し て あり ます ので 、 品番 、 ヘッダ の 文字列 を 引数 に し て 呼び出す と 、 品番 の 行 と ヘッダ の 列 の 交わる ところ の 値 を 返し ます 。 なお 、 ヘッダ が ２ 行 ある こと を 考慮 し 、 ヘッダ の 引数 は ２つ 指定 できる よう に し て あり 、 ２つ 目 の ヘッダー は 省略 可能 。 省略 し た 場合 は １つ 目 の ヘッダ のみ で 検索 し 、 最初 に 現れ た もの を 返し ます 。 また ２つ 指定 が あっ て も ヘッダ が ひとつ しか ない 場合 は 無視 し ます 。 また 、 検索 する シート は アクティブ シート と し て い ます 。 検索 し た 結果 、 該当 の 品番 、 ヘッダ が ない 場合 は Null を 返し ます 。 Function 検索 サンプル ( Hinmei As String , _ Header 1 As String , Optional Head er2 As String = "") As Variant Dim Rng As Range Dim x As Long Dim y As Long Dim z As Long Dim i As Long 検索 サンプル = Null With ActiveSheet ' 品名 、 ヘッダ １ の どちら か が 空値 なら 終了 If ( Hinmei = "") Or ( Header 1 = "") Then Exit Function ' 品名 の 検索 （ 完全 一致 ） Set Rng = . Range (" C : C "). Find ( What := Hinmei , LookIn := xlValues , LookAt := xlWhole ) ' 品名 が なけれ ば 終了 If Rng Is Nothing Then Exit Function ' 品名 が 一致 し た行 （ x ） を 控える x = Rng . Row ' 連 番 数 上 の 行 （ i ） が １ より 小さい 、 あるいは ヘッダ で なけれ ば 終了 i = x - Rng . Offset ( 0 , 2 ) If i < 1 Then Exit Function If . Range (" E " & i ). Value <> " ヘッダ " Then Exit Function ' ヘッダ １ の 検索 Set Rng = . Range ( i & ":" & i ). Find ( What := Header 1 , LookIn := xlValues , LookAt := xlWhole ) ' ヘッダ １ が なけれ ば 終了 If Rng Is Nothing Then Exit Function ' ヘッダ １ が 一致 し た 列 （ y ） を 控える y = Rng . Column ' ヘッダ ２ の 指定 が あり 、 ヘッダ が ２ 行 ある 場合 は 一致 する まで ヘッダ １ を 繰り返し 検索 If ( Head er2 <> "") And (. Range (" E " & i + 1 ). Value = " ヘッダ " Then ' 最初 に 検索 し た 列 を 控え て おく z = y Do ' ヘッダ ２ が 一致 すれ ば ループ を 抜ける If . Cells ( i + 1 , y ). Value = Head er2 Then Exit Do ' 次に ヘッダ １ が 一致 する セル を 検索 Set Rng = . Range ( i & ":" & i ). FindNext ( Rng ) y = Rng . Column ' 最初 に 検索 し た セル に 戻っ たら ヘッダ ２ に 一致 する もの が ない ので 終了 If y = z Then Exit Function Loop End If ' 一致 し た行 （ x ） 、 列 （ y ） の 値 を 返す 検索 サンプル = . Cells ( x , y ). Value End With End Function 
ファイル を w モード で 開い て いる ため 、 毎回 1 文字 が 上書き さ れ て い ます 。 モード を 変更 する か 、 文字列 に し て から 書き込む よう に し ましょ う 。 
初回 の 検索 セル を ループ 終了 として い まし た が 、 「,」 が 置換 さ れる と エンドレスループ と なる ので 少し 修正 し て み まし た 。 Sub sa mpl e2 () Dim r As Range , r _ end As String Set r = Range (" A 4 : A1 000 "). Find ( What :="*") If r Is Nothing Then Exit Sub r _ end = r . Address With CreateObject (" VBScript . RegExp ") . Pattern = "(\ d )(,)(\ d +?)" . Global = True Do r = . Replace ( r , "$ 1 $3 ") Set r = Range (" A 4 : A1 000 "). FindNext ( r ) Loop Until r _ end = r . Address End With End Sub 
値 集合 ソース は元 に なる データ は テーブル です か ？ 以下 、 テーブル の 場合 の 回答 に なり ます 。 それ 以外 は でき ませ ん 。 値 集合 ソース の 元 に なる テーブル に テキストボックス の 値 を 追加 する 追加 クエリ を 作成 し 、 コマンド ボタン を クリック し たら 追加 （ クエリ の 実行 ) する よう に し ます 。 その後 、 マクロ の アクション で 「 再 クエリ 」 処理 する と 、 ② の 値 集合 ソース の 表示 に 反映 さ れ ます 。 
表示 し たい の は 特定 の セル に対して でしょ う か ？ それ なら ば 、 セル の 書式 設定 を すれ ば 良い の で は ない でしょ う か 。 Range (" A1 "). NumberFormatLocal = " m / d " その 上 で セル に 日付 を 入れ ます 。 
( ポリシー として 、 直接的 な コード の 回答 は 避け て おり ます 。 ご 容赦 ください 。 ) 初心者 なら ば 、 [ ツール ]-[ オプション ...] → 「 変数 の 宣言 を 強制 する 」 に チェック を 入れ て 、 各 変数 ごと に 、 きちんと Dim 構文 で 宣言 し た 方 が いい です 。 コード 記述 の ミス を 早期 発見 でき ます 。 2つ の ファイル を 使う の でし たら 、 それぞれ の ブック にて 使用 する シート を オブジェクト 変数 に 割り当てる 事 で 、 簡単 に 記述 でき ます 。 Dim 文 と Set 文 を 使い ます 。 たとえば 変数 C に Workbook (" データ 出力 先 . xlsx "). Worksheets (" sheet 1 ") が 割り当て られ て いる 場合 、 C . Cells ( 1 , 1 ). Value = " test " で セル A1 に test という 文字 が 入力 でき ます 。 > FormulaR 1 C1 これ は セル に R1 C1 形式 の 数式 を 代入 、 あるいは 取得 する ため の プロパティ です 。 セル の 値 の 操作 に は 、 これ 以外 に も 、 Formura ・ Value ・ Value 2 ・ Text が あり ます 。 それぞれ 用途 が 異なり ます ので 調べ て み て 下さい 。 まぁ 、 だいたい Formura と Value しか つかい ませ ん けど ね 。 日時 と お金 の 時 だけ 、 あえて Value 2 を 使う 事 が ある かも しれ ませ ん 。 > 書き方 が わかり ませ ん VBE の 画面 で ヘルプ を 見れ ば 分かり ます .... という の も 投げやり すぎ です か 。 概要 は 書き ます が 、 あと で ヘルプ も 見 て み て 下さい 。 ただし 、 今回 の 内容 は If より も Select Case の 方 が いい でしょ う 。 あと 、 「 Excel VBA Select Case MSDN 」 で ググる と 、 マイクロソフト の ネット 上 の ヘルプ に 辿り つけ ます 。 Select ( 調査対象 の 値 ) case ( 条件 1 ) ( 処理 する コード ) case ( 条件 2 ) ( 処理 する コード ) case else ( 処理 する コード ) end Select 今回 、 調査対象 の 値 は 、 データ 元 の B 列 の 値 です ね 。 条件 1 は 「 データ 」 とか 「 項目 型 」 とか 、 文字列 に なり ます 。 調査対象 の 値 と 条件 1 が 一致 する と 、 処理 する コード が 実行 さ れ ます 。 質問 の 中 に は あり ませ ん でし た が 、 上記 の 処理 を 「 複数 の 行 で 」 処理 する 必要 が ある の で は あり ませ ん か ? その 場合 、 処理 する 行 の 行 数 を 変数 に し て 、 この 変数 を 2 行 目 から 最終 行 まで 変化 さ せ ながら ループ 処理 を さ せる 必要 が あり ます 。 For ～ Next 文 です ね 。 「 Excel VBA For Next MSDN 」 で ググッ て 見 て 下さい 。 ググっ た 上 で 、 分から ない 内容 が あれ ば 、 返信 頂けれ ば 回答 し ます 。 それでは 。 
コード 例 です 。 動作 検証 し て い ない ので 、 不具合 が あれ ば ご 返信 ください 。 Sub Sample () Dim buf As Variant Dim Bk As Workbook Dim DestRng As Range Dim CopyRng As Range Dim i As Long Set Bk = Workbooks . Open ( FileName :=" C :\ 共有 \ マクロ . xlsx ") For Each buf In Array (" 様式 A ", " 様式 B ") Set CopyRng = ThisWorkbook . Worksheets ( buf ). Range (" B 16 : AA 2000 ") Set DestRng = Bk . Worksheets (" 様式 " & i + 1 ). Cells ( Rows . Count , " B "). End ( xlUp ). Offset ( 1 ) Set DestRng = DestRng . Resize ( CopyRng . Rows . Count , CopyRng . Columns . Count ) DestRng . Parent . Protect user interface only := True DestRng . Value = CopyRng . Value DestRng . Parent . UsedRange . EntireRow . RemoveDuplicates 2 i = i + 1 Next Bk . Close SaveChanges := True MsgBox "『 マクロ ブック 』 へ " & vbCrLf & " データ転送 し まし た 。 " End Sub 
こんにちは。 シート の イベント の マウス 右クリック イベント で cancel = true と する と 、 選択 の とき の 、 メニュー が 表示 し ませ ん 。 よく 使う の は 、 むしろ 、 こっち です けど ね 。 
仕様 が 一部 不明 です が 、 登録 で 重複チェック する の は 品名 だけ で いい の でしょ う か 。 TextBox 1 と TextBox 2 と Command Button 1 が 登録 用 です 。 TextBox 3 と TextBox 4 と Command Bu t to n2 が 削除 用 です 。 TextBox 5 と TextBox 6 と ListBox 1 と Command Bu t to n3 と Command Bu t to n4 が 修正 用 です 。 修正 は 、 TextBox 5 と TextBox 6 に 品目 と ロケーション を 入力 し て Command Bu t to n3 を 押す と 、 ListBox 1 に 対象 を 表示 し ます 。 ロケーション を 入力 し ない とき は 品目 が 一致 し た もの を すべて 表示 し ます 。 ListBox 1 を クリック する と 、 修正 モード の なる ので ロケーション を 修正 し て Command Bu t to n4 で 修正 実行 です 。 修正 は わかり にくい 操作 に なっ て しまい まし た 。 もっと 操作 を 工夫 し た 方 が いい かも しれ ませ ん 。 ' 登録 Private Sub CommandButton 1 _ Click () ' 入力 チェック If TextBox 1 . Value = "" Then ' 品目 入力 チェック MsgBox " 品目 は 必須 です " TextBox 1 .S etFocus ' 品目 選択 Exit Sub End If ' 重複チェック Dim lastRow As Long Dim n As Integer lastRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' A 列 最終 行 n = WorksheetFunction . CountIf ( Range (" A 2 : A " & lastRow ), TextBox 1 . Value ) ' 品目 の 重複 カウント If n > 0 Then ' 重複 が あれ ば If MsgBox (" 品目 が 既に " & n & " 個 あり ます " & vbCrLf & " 登録 し ます か ？", vbYesNo ) <> vbYes Then Exit Sub ' Yes じゃ なけれ ば 中止 End If ' 登録 ( A 列 最終 行 の 下 に ) Range (" A " & lastRow + 1 ). Value = TextBox 1 . Value Range (" B " & lastRow + 1 ). Value = TextBox 2 . Value ' 次に 備える ( 必要 なら ) TextBox 1 . Value = "" TextBox 2 . Value = "" TextBox 1 .S etFocus End Sub ' 削除 Private Sub Command Bu t to n2 _ Click () ' 入力 チェック If TextBox 3 . Value = "" Then ' 品目 入力 チェック MsgBox " 品目 は 必須 です " TextBox 3 .S etFocus ' 品目 選択 Exit Sub End If ' データチェック Dim lastRow As Long Dim n As Integer lastRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' A 列 最終 行 n = WorksheetFunction . CountIfs ( Range (" A 2 : A " & lastRow ), TextBox 3 . Value , Range (" B2 : B " & lastRow ), TextBox 4 . Value ) ' 品目 と ロケーション の 組み合わせ の 重複 カウント If n = 0 Then ' 重複 が 無けれ ば MsgBox " 見つかり ませ ん " Exit Sub End If If MsgBox ( n & " 個 の 重複 が あり まし た " & vbCrLf & " 削除 し ます か ？", vbYesNo ) <> vbYes Then Exit Sub ' 削除 を 確認 ' 削除 Dim target As Range Dim r As Long For r = 2 To lastRow ' 2 行 目 から 最終 行 まで If ( Range (" A " & r ). Value = TextBox 3 . Value ) And ( Range (" B " & r ). Value = TextBox 4 . Value ) Then ' 品目 と ロケーション が 同じ なら If target Is Nothing Then ' 初めて の 対象 なら Set target = Rows ( r ) ' 削除対象 を 設定 Else ' 初めて じゃ なけれ ば Set target = Union ( target , Rows ( r )) ' 削除対象 に 追加 End If End If Next target . Delete xlShiftUp ' 削除対象 を 削除 し て 上 に 詰める ' 次に 備える ( 必要 なら ) ListBox 1 . Clear TextBox 3 . Value = "" TextBox 4 . Value = "" TextBox 3 .S etFocus End Sub ' 初期 設定 Private Sub UserForm _ Initialize () ListBox 1 . ColumnCount = 2 ' ListBox 1 の 初期 設定 ( プロパティ で 設定 すれ ば 不要 ) End Sub ' 検索 Private Sub Command Bu t to n3 _ Click () ' 入力 チェック If TextBox 5 . Value = "" Then ' 品目 入力 チェック MsgBox " 品目 は 必須 です " TextBox 5 .S etFocus ' 品目 選択 Exit Sub End If ' Dim lastRow As Long Dim n As Integer lastRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' A 列 最終 行 If TextBox 6 . Value = "" Then ' ロケーション なけれ ば n = WorksheetFunction . CountIf ( Range (" A 2 : A " & lastRow ), TextBox 5 . Value ) ' 品目 の 重複 カウント Else ' 違っ たら n = WorksheetFunction . CountIfs ( Range (" A 2 : A " & lastRow ), TextBox 5 . Value , Range (" B2 : B " & lastRow ), TextBox 6 . Value ) ' 品目 と ロケーション の 組み合わせ の 重複 カウント End If If n = 0 Then ' 無けれ ば MsgBox " 見つかり ませ ん " Exit Sub ' 中止 End If ' リスト ボックス に 登録 Dim r As Long ListBox 1 . Clear For r = 2 To lastRow If Range (" A " & r ). Value = TextBox 5 . Value Then ' 品目 が 一致 し て If ( TextBox 6 . Value = "") Or (( TextBox 6 . Value <> "") And ( TextBox 6 . Value = Range (" B " & r ). Value )) Then ' ロケーション 無し か 、 ロケーション あり で 一致 し たら ListBox 1 . AddItem Range (" A " & r ). Value ' Listbox 1 に 品目 追加 ListBox 1 . List ( ListBox 1 . ListCount - 1 , 1 ) = Range (" B " & r ). Value ' 2 列 目 に 品目 追加 ListBox 1 . List ( ListBox 1 . ListCount - 1 , 2 ) = r ' 3 列 目 に 何 行 めか を 追加 ( 見え ない ) End If End If Next End Sub ' リストボックスクリック Private Sub ListBox 1 _ Click () If MsgBox (" 品目 ：" & ListBox 1 . List ( ListBox 1 . ListIndex ) & vbCrLf & " ロケーション ：" & ListBox 1 . List ( ListBox 1 . ListIndex , 1 ) & vbCrLf & vbCrLf & " を 修正 し ます か ？", vbYesNo ) <> vbYes Then Exit Sub ' 修正 し ない なら 終わり ' 修正 表示 TextBox 5 . Value = ListBox 1 . List ( ListBox 1 . ListIndex ) ' 品目 表示 TextBox 6 . Value = ListBox 1 . List ( ListBox 1 . ListIndex , 1 ) ' ロケーション 表示 TextBox 5 . Tag = ListBox 1 . List ( ListBox 1 . ListIndex , 2 ) ' 今 表示 し て いる データ の 行 を TextBox 5 の Tag に 格納 ( Gloval 変数 用意 し て も いい ) End Sub ' 修正 実行 Private Sub Command Bu t to n4 _ Click () ' 入力 チェック If TextBox 5 . Tag = "" Then ' まだ データ が 選ば れ て なけれ ば MsgBox " データ が 選ば れ て ませ ん " Exit Sub End If If TextBox 5 . Value = "" Then ' 品目 入力 チェック MsgBox " 品目 は 必須 です " TextBox 5 .S etFocus ' 品目 選択 Exit Sub End If If MsgBox (" 修正 し て も いい です か ？" & vbCrLf & " 品目 は 修正 さ れ ませ ん ", vbYesNo ) <> vbYes Then Exit Sub ' 修正 実行 Dim r As Long r = TextBox 5 . Tag ' 修正 対象 行 ' Range (" A " & r ). Value = TextBox 5 . Value ' 品目 ( 修正 する なら ) Range (" B " & r ). Value = TextBox 6 . Value ' ロケーション ' 後始末 ( 必要 なら ) TextBox 5 . Value = "" ' 品目 TextBox 6 . Value = "" ' ロケーション TextBox 5 . Tag = "" ' 行 TextBox 5 .S etFocus ' TextBox 5 選択 End Sub 
Application . CommandBars (" Cell ") の 部分 を Application . CommandBars (" Shapes ") と する の が 基本 です が ( 上 URL )… バージョン により 違い が ある よう です （ 下 URL ) http:// excelwork . info / excel / shortcutmenu / http:// www . ka - net . org / blog /? p = 5093 
この コード を 入力 シート の シート モジュール に 貼り 付け て ください 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) If Target . Value = "" Then Exit Sub If Target . Count <> 1 Then Exit Sub If Target . Column = 2 Then If Len ( Target . Value ) <> 13 Then MsgBox " 13 桁 の 数字 を 入力 し て ください 。 " Target .S elect Exit Sub ElseIf Not IsNumeric ( Target . Value ) Then MsgBox " 13 桁 の 数字 を 入力 し て ください 。 " Target .S elect Exit Sub Else Application . EnableEvents = False Target . Resize (, 3 ). NumberFormatLocal = "@" Target . Offset (, 3 ). Value = Mid ( Target . Value , 13 , 1 ) Target . Offset (, 2 ). Value = Mid ( Target . Value , 9 , 4 ) Target . Offset (, 1 ). Value = Mid ( Target . Value , 5 , 4 ) Target . Offset (, 0 ). Value = Mid ( Target . Value , 1 , 4 ) Application . EnableEvents = True Target . Offset (, 4 ). Select End If ElseIf Target . Column = 6 Then Target . Offset ( 1 , - 4 ). Select End If End Sub まず 、 B 列 に 13 桁 の 数字 を 入力 し て し ます 。 13 桁 を 4つ の セル に 自動 で 分割 し ます 。 次に F 列 に 入力 を 終える と 次 の 列 の B セル に 飛び ます 。 
こんにちは。 csv を 扱う とき に 、 「 どこ に 着目 する か 」 です が 、 テキストファイル の 1 行 目 と 2 行 目 について 、 できるだけ 細かく 、 状況 を 把握 。 csv の ファイル は 、 1 行 目 が 見だし な の か 、 そう で ない か 、 は 、 違い を 明確 に する 必要 が あり ます 。 データ 部分 の 説明 です が 、 「 コンマ 記号 」 が 区切り な ので 、 一つ 目 が 数値 な の か 、 文字列 な の か 、 文字列 の 場合 、 区切り 記号 で ダブル クォーツ が ある 、 とか 、 ない 、 と か です 。 次 、 仕様 の 説明 、 パー ターン A の 場合 は 、 かくかく 、 しか じ か 、 という データ に なり ます 。 という 説明 が 必要 。 これら を 、 正しく 表現 でき ない と 、 コード に は 、 なり ませ ん 。 処理 の 内容 で 見る と 、 エクセル で なく て も できる よう な 課題 な ので 、 「 どんな 入力 」 「 処理 内容 」 「 どんな 出力 」 を きちんと 整理 でき て いる 必要 が あり ます 。 あと 、 説明 の 内容 で は 、 「 出力 」 について 、 説明 が 不十分 です 。 出力 は 、 出力 の シート は 、 この 名前 、 1 行 目 の 構成 は 、 かくかく に なっ て い て 、 読み込み し た データ は 、 列 A と B と 、 という よう に 、 読み込み し た データ 1つ が 、 出力 に は 、 どう なっ て いる 、 という こと が 、 わから ない と いけ ませ ん 。 計算 する 、 と いえ ば 、 数値 の 合計 が できる こと 、 項目 は 、 どう する 、 と なり 、 読み込み が たとえ は 100 行 あっ て 、 出力 は 何 行 に なる か 、 も 、 イメージ し て い ない と いけ ませ ん 。 それら の 整理 を し て いっ たら 、 コード も 、 でき ます よ 。 
セル の 選択 が ひとつ の 場合 は 、 Buffer = rngTarget . Value として も Buffer が 配列 に は なり ませ ん ので 、 IsArray で 配列 か どう か 判定 し て 処理 を 分岐 さ せ ます 。 配列 で は ない （ セル の 選択 が ひとつ の 場合 ） は 単に Buffer に 対象 セル の 値 が 入る だけ な ので 、 その 先頭 の 空白 を 除く だけ です 。 （ 修正 し た サンプル ） Sub 空白 を 削除 () Dim rngTarget As Range Dim Buffer As Variant Dim lngRowCnt As Long Dim lngColCnt As Long Dim k As Long , j As Long Set rngTarget = Selection Buffer = rngTarget . Value If IsArray ( Buffer ) Then ' 選択 範囲 が 単一 で は ない 場合 は 配列 の 処理 lngRowCnt = UBound ( Buffer ) lngColCnt = UBound ( Buffer , 2 ) For k = 1 To lngRowCnt For j = 1 To lngColCnt Buffer ( k , j ) = LTrim $( Buffer ( k , j )) Next j Next k Else ' 選択 範囲 が 単一 の ば あい は 、 １ セル の 処理 Buffer = LTrim $( Buffer ) End If rngTarget . Value = Buffer Set rngTarget = Nothing End Sub 
前 の 質問 に対する 回答 で 誤解 が 生じ た の かも しれ ませ ん ね 。 UserForms . Add ( FormNameBox 2 . Text ) で 取得 し た ユーザー フォーム は 、 既に 開い て いる UserForm 1 と は 別物 の 新しい UserForm 1 オブジェクト な ん です 。 . List ( i ) で リスト ボックス の 内容 を 取っ て これ たり し ます が 、 それ は 新しい UserForm 1 の リスト ボックス の 内容 な ん です 。 だから 、 それ に対して .S etFocus し たり 、 . ListIndex = i し て も 、 元 の UserForm 1 の 内容 は 変わり ませ ん 。 その 場合 、 現在 開い て いる ユーザーフォームコレクション （ UserForms ） から ユーザーフォームオブジェクト を 取り出し 、 対象 の ユーザー フォーム か どう か を 判定 し ます 。 その 場合 . Name で は なく TypeName ( オブジェクト ） で 判定 し ます 。 詳しく は 以下 の サンプル を 見 て ください 。 （ UserForm 2 の CB t n2 _ Click サンプル ） Private Sub CB t n2 _ Click () Dim i As Long Dim uf As UserForm If TextBox 2 . Text = "" Then Exit Sub ' UserForms から UserForm を 順に 取り出す For Each uf In UserForms ' UserForm の タイプ 名 が FormNameBox 2 と 一致 し た 場合 If TypeName ( uf ) = FormNameBox 2 . Text Then ' ListBNameBox 2 の コントロール （ ListBox ） に対して 操作 With uf . Controls ( ListBNameBox 2 . Text ) ' リスト の 中身 を 順に TextBox 2 と 比較 For i = 0 To . ListCount - 1 If . List ( i ) = TextBox 2 . Text Then ' 一致 すれ ば ListIndex を 変更 ' MsgBox i & " 番 目 に 見つかり まし た " ' * * * * * ************************* .S etFocus . ListIndex = i ' * * * * * ************************* Unload Me Exit Sub End If Next End With MsgBox " 見つかり ませ ん でし た " Exit Sub End If Next MsgBox " フォーム が 見つかり ませ ん でし た " End Sub 
お おおぅ 、 回答 リクエスト なんて 初めて もらっ た ....。 maschsuke 12 さん と purinkichi さん の やりとり を 踏まえ て い ます 。 他人 の ふんどし で 相撲 を 取る よう で maschsuke 12 さん に は 申し訳ない の です が ....。 > やっ て み まし た が エラー に なり まし た 。 → コード にて 、 「 Sub ● ● ● () 」 という の は 、 「 ここ が ● ● ● という プログラム の 始まり ですよ 」 と 言う 事 を 意味 し て おり 、 「 End Sub 」 まで を ● ● ● という プログラム の 塊 として 扱い ます 。 よって 、 Sub の 行 から end Sub まで の 行 の 間 に Sub の 行 を 含める こと は でき ませ ん 。 また 、 Sub ・ End Sub 共 に 単体 で 使う 事 は 出来 ず 、 必ず セット で 使い ます 。 > 最終 行 の 下 で は なく 、 各 No. の 行 の 下 に 1 行 だけ 追加 する 方法 は あり まっせ ん か ？ → 表 を 見 て みる と 、 1つ の 項目 ( 図面 番号 ?) にて 複数 の 行 を 使用 し て いる 部分 も あり ます ね 。 なおかつ 、 1 行 だけ を 追加 する 場合 、 セル の 結合 か 、 あるいは 間 の 罫線 の 削除 を し て いる よう です 。 （ しかも 、 行 11 ～ 13 に関して は 、 11 ～ 12 行 目 に は 罫線 が ある の に 12 ～ 13 行 目 に は 罫線 が ない 。 ） 1 行 だけ の 追加 の 場合 に は 追加 の 処理 が 必要 に なる の で は ない です か ？ その 場合 、 図面 番号 として の 追加 な の か 、 図面 番号 の 入 力行 を 1 行 追加 な の か 、 判断 が 必要 に なり ます 。 最終 行 の 追加 のみ 図面 番号 として の 追加 、 という 事 で あれ ば 、 追加 する 行 が 最終 行か どう か を VBA で 判断 さ せる こと は 出来 ます 。 しかし 、 そう で ない 場合 （ 途中 でも 図面 番号 として の 追加 が あり 得る or 最終 行 で あっ て も 1 行 追加 が あり 得る ） 場合 に は 、 行 の 挿入 が どっち の パターン か VBA で は 判断 でき ない の で は ない でしょ う か 。 後者 の 場合 、 図面 番号 追加 用 の コード と は 別に 、 1 行 だけ 追加 の コード を 別に 用意 する 必要 が あり ます 。 図面 番号 追加 用 の プロシージャ (= sub ～ end sub の 塊 の 事 ) は maschsuke 12 さん の 提示 さ れ た コード で 大丈夫 です 。 1 行 追加 の プロシージャ は 、 画面 追加 用 の プロシージャ を 利用 し 、 End Sub の 1 行 上 に 、 セル を 結合 する か 罫線 を 削除 する コード を 挿入 すれ ば 出来 ます 。 もちろん 、 図面 番号 追加 用 の プロシージャ と は 別 の 名前 に し て 下さい ね 。 あ 、 ActiveX コントロール の クリック イベント だ から 、 プロシージャ 名 は 固定 でし た ね 。 結合 や 、 罫線 の 削除 は マクロ の 自動 記録 機能 を 使っ て てきとう に 記録 し て 、 生成 さ れ た コード を 見れ ば 記述 方法 が 分かる でしょ う 。 複数 領域 の セル の 選択 は 、 Range ( セル を 示す オブジェクト 1 , セル を 示す オブジェクト 2 ) で 記述 でき ます 。 Range で ヘルプ を 見 て み て 下さい 。 Selection と 、 Offset も 必要 に なる でしょ う 。 maschsuke 12 さん の コード で は 、 Offset ( 1 ) と なっ て い ます が 、 これ は Offset ( 1 , 0 ) を 省略 し て 記述 し た もの です 。 ここ まで の 内容 を ＋ VBA の ヘルプ と 、 MSDN を 見れ ば 、 思い通り の コード が 記述 できる と 思い ます 。 マクロ は 作る の は 大変 です が 、 メンテナンス は もっと 大変 です 。 自分 で 運用 する コード は 自分 で 把握 し て おか ない と 、 トラブル が あっ た 時 ( 大抵 そんな 時 は 緊急 で 対応 し ない と いけ ない ) に 痛い 目 に あい ます ....。 困っ た 時 は こちら の サイト を よく 利用 し て い まし た 。 http:// office tanaka .net / それでは 。 
miximixi 788 さん プログラム は 完結 し た もの を 書く と 、 テスト できる 。 
ExecuteExcel 4 Macro に は パスワード を 指定 する オプション は あり ませ ん ので 、 Application .S endKeys " password " Application .S endKeys "{ Enter }", True Cells ( 2 , 4 ) = ExecuteExcel 4 Macro (' D :\ M 管理 DATA \[ データ 2015 . xls ] データ BOX '! R25 C4 ) と し ます 。 「 excel vba ExecuteExcel 4 Macro パスワード 」 で ググっ たら 沢山 ヒット し まし た よ 。 
ユーザー フォーム の 中 に シート の データー を 表示 する の は 無駄 が 多い と 思い ます 。 その データー の 数 だけ テキストボックス を コントロール する 必要 が 有り ます ので 、 その マクロ が 必要 。 ただ その USERFORM を 開い た まま 別 シート 今回 の 場合 表示 し たい シート に 移動 する 事 は 可能 です 。 USERFORM の ＳｈｏｗＭｏｄａｌ を FALSE に し て おけ ば USERFOM 表示 し た まま 他 の 動作 シート の 移動 や セル 入力 が 出来 ます 。 
とりあえず 、 ざっくり こんな 感じ で どうでしょう 。 ☆ Module 1 ☆ Public num As Integer ' 問題 番号 Public exitFlg As Boolean ' 終了 フラグ Sub Start () num = 1 ' 問題 番号 1 から 始め ます exitFlg = False ' 終了 フラグ = False For i = 1 To 5 ' ５ 問 繰り返し ます If exitFlg Then ' 終了 フラグ が TRUE の 場合 、 終了 し ます 。 Exit Sub End If UserForm 1 .S how ' ユーザー フォーム を 表示 Next End Sub ☆ UserForm 1 ☆ ' 初期化 Private Sub UserForm _ initialize () TextBox 1 = Worksheets ( 1 ). Cells ( num + 2 , 2 ) ' テキストボックス に 、 「 num + 2 」 行 目 の 問題 を 表示 し ます ' OptionButton 1 ～ 5 に 、 答え を 設定 し て いき ます 。 For i = 1 To 5 Me . Controls (" OptionButton " & CStr ( i )). Caption = Worksheets ( 1 ). Cells ( num + 2 , i + 2 ) Next '↑ ' 左辺 は 説明 する と 長く なる ので 調べ て み て ください …。 ' 右辺 は 、 「 num + 2 」 行 目 、 「 i + 2 」 列 目 の 答え を 設定 する よう に し て い ます 。 End Sub ' Command Button 1 クリック Private Sub CommandButton 1 _ Click () '■ 変数 を 宣言 Dim myCtrl As Control ' チェックボックス や オプション ボタン の ON / OFF を まとめ て 管理 する ため の コントロール Dim flg As Boolean ' オプション ボタン を 押し て ある か を 調べる チェック フラグ '■ OptionButton に 未 選択 が ない か チェック For Each myCtrl In Controls ' UserForm 1 上 の コントロール を ひとつ ずつ 調べ ます If TypeName ( myCtrl ) = " OptionButton " Then ' コントロール の タイプ が 「 オプション ボタン 」 の もの だけ を 調べ ます If myCtrl . Value Then ' もし オプション ボタン の 値 が TRUE だっ たら flg = True ' フラグ を ON に し ます 。 End If End If Next '■ 結果 判定 If flg = False Then ' フラグ が FALSE だっ たら ret = MsgBox (" 答え を 選択 し て ください ！！", 48 , " 注意 ") ElseIf Me . Controls (" OptionButton " & CStr ( Worksheets ( 1 ). Cells ( num + 2 , 8 ))) Then ' 正解 の オプション ボタン が 選択 さ れ て い たら MsgBox (" 正解 ") Else ' 上記 以外 だっ たら MsgBox (" 不正解 ") End If End Sub ' 次 の 問題 へ 進む Private Sub Command Bu t to n2 _ Click () ' UserForm 1 を 閉じ ます Unload UserForm 1 ' 次 の 問題 番号 へ num = num + 1 End Sub ' UserForm 1 を 閉じ ます Private Sub Command Bu t to n3 _ Click () Unload UserForm 1 exitFlg = True End Sub 
コード 最適 化 さ れ たら 、 デバッグ ・ ストップ でき ない 行 が 、 含ま れ 兼ね ませ ん から 、 デバッグ ・ モード の コンパイル で は 、 一般 に 、 最適化 は 、 施さ れ ませ ん 。 それ は 、 Xcode も 同じ はず です 。 プログラム を 終わら せ ない で 、 もう一度 、 同じ 処理 を し て も 同じ 処理 時間 です か ？ Windows で は 、 . exe の 実行 時 に 、 DLL が 、 Load on Call （ デフォルト ） に なっ て いる と DLL 内 の 何れ か の 関数 の 最初 の コール で 初めて メモリー へ の ロード が 起きる ので 、 複数 の DLL が 、 関与 する 場合 、 それぞれ の 初回 で 、 負荷 を 生じる はず です 。 DLL に は 、 Preload という 設定 も 可能 で 、 予備 元 . exe の 実行 の タイミング で 関連 DLL は 、 メモリー に ロード さ れ ます 。 これ に 関連 し て 、 Ｘ code の 環境 と の 違い を 検証 し て み て 下さい 。 
明瞭 な 回答 で は ありません が 、 、 、 黄色 行 は 「 この 次に この 行 を 実行 する ぞ 」 の 印 な ので 、 この 時点 で は Range (" E 7 "). Value の 値 が Empty で あっ て も 異常 で は あり ませ ん 。 むしろ 気 に なる の は 黄色 行 で の KATABAN の 値 です 。 こちら が 異常 で エラー 終了 し て いる の です から 。 
> objInpTxt . Value = " Range (" A1 ")" を objInpTxt . Value = Range (" A1 ") に 個人的 に は objInpTxt . Value = Range (" A1 "). Value か objInpTxt . Value = Range (" A1 "). Text に し て ほしい 。 
以下 の コード でいか が でしょ う か ？ Sub Sample () If WorksheetFunction . CountIf ( Range (" F1 : F2 0 "), 1 ) > 0 Then MsgBox " 1 表示 あり " End If End Sub 
どの 表 を 取り出す の か が 分から ない の です が 、 基本的 に は 、 TABLE タグ を 取り出し 、 その 中 の TR タグ を 抽出 、 更に 各 TR タグ 毎 に TH もしくは TD タグ を 抽出 し て 各 要素 を 取り出す 、 という 手順 に なり ます 。 ' TABLE タグ を 取り出す ' 末尾 の 括弧 番号 は TABLE タグ の 出現 順序 ' 2 番目 を 取り出す 場合 は 1 に 変更 Set tbl = ie . document . getElementsByTagName (" table ")( 1 ) ' TR タグ を 取り出す ' これ が 行方 向 にあ たる Set tr = tbl . getElementsByTagName (" tr ") ' TH タグ ( タイトル 行 ) を 取り出す Set th = tr ( 0 ). getElementsByTagName (" TH ") ' 各 タグ の テキスト を セル に 代入 For c = 1 To t h. Length Cells ( 1 , c ). Value = th ( c-1 ). InnerText Next ' 行方 向 ループ For r = 2 To tr . Length ' TD タグ 取り出し Set td = tr ( r-1 ). getElementsByTagName (" td ") ' 列方向 ループ For c = 1 To td . Length ' タグ の テキスト を セル に 代入 Cells ( r , c ). Value = td ( c-1 ). InnerText Next Next 
こんにちは。 A1 から J 1 の コピー を 、 ソート の 後 で 実行 し て い ます よ ね 、 この 「 値 貼り 付け 」 は 、 AE の 値 貼り 付け の 次に 、 実行 を 、 検討 し て ください ソート は 、 できるだけ 、 値 だけ の 状態 に し ます 。 列 を 非表示 に し て い ます が 、 最初 に 全部 見える よう に し て い ない の は 、 どうして な ん でしょ う ね 。 フィルター の 解除 は 、 再 計算 の きっかけ と なり ます 。 最初 に フィルター を 解除 し て から 、 フィルター を 実行 し ない よう に し て ください 。 ソート 対象 が 2000 行 という こと です が 、 シート は 、 最小 の データ に する こと 、 できるだけ 削除 は 、 実行 し て ください 。 ターゲット の ブック の シート は 、 ひとつ でしょ う か 、 複数 でしょ う か 。 計算 式 も 、 できるだけ 少ない の が いい です 
こんにちは。 Do While obIE . ready State <> 6 の 行 は Do While obIE . ready State <> 4 です ね 。 ループ に は 、 doevents を さ せ て ください 。 それで 、 wait 行 の 手前 まで 、 実行 でき ます 。 
> シート 名 ( データ ) の 3 行 目 ～ 12 行 目 を １ 行 目 毎 に コピー し 、 2 行 目 に 貼り 付け 、 シート 名 ( 出力 ) を ３ 回 印刷 する もの この 処理 で いい の です か ・ ・ 。 やっ て いる こと は 「 データ 」 シート の ３ 行 目 から 12 行 目 を 順に コピー し て 、 同じ シート の 2 行 目 に 貼り 付け て い ます よ ね 。 そして 、 印刷 する の は 「 出力 」 シート です 。 「 出力 」 シート の セル と 「 データ 」 シート の 2 行 目 が 紐 づけ さ れ て いる の でしょ う か ・ ・ 。 一 例 の コード です 。 Sub PrintThree () Dim i As Integer With Worksheets (" データ ") For i = 3 To 10 . Rows ( i ). Copy . Rows ( 2 ) Worksheets (" 出力 "). PrintOut Copies := 3 Next i End With End Sub ※ むやみ に Select は 使わ ない ほう が 良い です 。 
他 の ブック に ある VBA を 動かす に は 、 Application . Run を 使い ます 。 http:// excel - ubara . com / excel vb a1 / EXCELVBA 427 . html 
こんにちは。 dirname は 、 作業 空間 の フォルダ を 設定 し て ください 。 メール の 近く で いい です 。 output の 次に 、 stop を 設定 し て 、 output の 変数 の ローカル スコープ を み て ください 。 型 が 違う 、 という の でし たら 、 別 の 理由 です 。 引数 の Para です が 、 サンプル も よく 確認 し て ください 。 スペース 記号 は 、 どう でし た か 。 
# include < stdio . h > # include < stdlib . h > # include < string . h > # define N 256 # define MM 22 void histogram ( double *, int ); int main ( void ) { char d [ N ],* t ; int n , i ; double * g ; printf (" 入力 \ n "); scanf ("% d ",& n ); getchar (); g =( double *) malloc ( sizeof ( double )* n ); fgets ( d , N , stdin ); t = strtok ( d ," "); i = 0 ; while ( t != NULL ){ g [ i ++]= atof ( t ); t = strtok ( NULL ," "); } histogram ( g , n ); return 0 ; } void histogram ( double * g , int n ) { int i , j , a , b , m [MM] ; for ( i = 0 ; i < MM ; i ++) m [ i ]= 0 ; for ( i = 0 ; i < n ; i ++) m [( int )( g [ i ]+ 0 . 5 )]++; a = 0 ; for ( i = 0 ; i < MM ; i ++){ if ( m [ i ]> 0 ){ a = i ; break ; }} b = 0 ; for ( i = a + 1 ; i < MM ; i ++) if ( m [ i ]> 0 ) b = i ; printf ("\ n 出力 \ n "); for ( i = a ; i <= b ; i ++){ printf ("% 2d ", i ); for ( j = 0 ; j < m [ i ]; j ++) printf ("*"); printf ("\ n "); } } ご 注文 の 通り に 作っ た つもり です けど 、 何 か 問題 が あれ ば 適当 に 修正 し て ください 。 プログラム の 解説 はしません 。 実数 1 個 で 1 行 の 入力 で は なく 、 全 実数 の 入力 が 1 行 で の 入力 に なっ て いる ので 、 面倒 な 処理 に なっ て いる 。 getchar (); は scanf で の 読み 残し の 改行 ( ENTER キー ) が ｆgets で 不具合 を 起こす ので 、 読み 飛ばし て いる 。 
> redim 動的 配列 名 ( 1 ) 配列 の インデックス は 常に 1 で 再 定義 さ れ て い ます 。 誤り で は ない でしょ う か ? redim 動的 配列 名 ( i ) では ？ > ボタン Ｘ の サブ プロシージャ における redim が プロシージャ 内 の 適用範囲 の ため ボタン Ｙ サブ プロシージャ で は 参照 でき ない の で は ない か と 思っ て い ます 。 動的 配列 名 を コード 上 で 右クリック → ウォッチ 式 の 追加 で 配列 の 内容 が ウォッチ できる ので 、 変化 を 確認 さ れ て は どうでしょう か ? 
プリプロセッサ 条件 に は OS の 環境変数 は 利用 でき ませ ん 。 環境変数 自体 は System . Environment . GetEnvironmentVariable で 取得 でき ます 。 
空白 文字 族 の 違い を 無視 する は 、 たいてい の diff ツール の 設定 オプション に あり ます よ 。 Winmerge なら [ 編集 ]-[ 設定 ] の 比較 - 空白 □ 変更 を 無視 する に チェック すれ ば よい の で は ？ http:// px . otogawa . com / winmerge . html 
その 場合 は sheet の インデックス を 取得 すれ ば 良い の で は 無い か と 思わ れ ます 。 Sub Sample () MsgBox ActiveSheet . Index MsgBox Sheets (" 予定 表 "). Index End Sub これ で 試し て み て 下さい 。 
VB の テキストボックス や C++ の エディット ボックス の 処理 、 また 、 コマンドプロンプト へ の 表示 も わりと 遅い と 思い ます よ 。 テキストボックス を 使っ て いる なら 、 使う の を 止め て 、 他の方法 を 試し て みる の が いい と 思い ます 。 C++ の TextOut () なら 速 そう な の です が 、 . Net で は ない です よ ね 。 Draw String () は どうでしょう か ？ 試し て み て は いかが でしょ う か ？ コマンドプロンプト へ の 表示 は テキストボックス より は 速い かも しれ ない ？ 
form を Submmit すれ ば いい と 思い ます 。 それ と パスワード 、 ＩＤ を 探す の に ループ さ せる 必要 は ない と 思い ます 。 Sub sample () Dim ie As Object Set ie = CreateObject (" InternetExplorer . Application ") ' ie ie . Visible = True ' ie 表示 ie . Navigate " https :// www .net bk . co.jp / wpl / NBGate " Do While ie . Busy Or ( ie . Ready State <> 4 ): DoEvents : Loop ' 表示 完了 待ち ie . Document . getElementsByName (" userName ")( 0 ). Value = " ユーザー 名 " ie . Document . getElementsByName (" loginPwdSet ")( 0 ). Value = " パスワード " ie . Document . getElementsByName (" LoginForm ")( 0 ). submit Do While ie . Busy Or ( ie . Ready State <> 4 ): DoEvents : Loop ' 表示 完了 待ち ' ie . Quit End Sub 
"\ p { Han }+" は 文字コード が Unicode の とき の 「 漢字 」 の 正規表現 です 。 VBS で は 文字コード は シフトJIS な ので "[ 亜 - 熙 ]" と し ます 。 
目的 の TD タグ を 取得 済み なら ば 、 getAttribute を 使え ば 取り出せ ます 。 msg = td . getAttribute (" rowspan ") 他 の 属性 値 も 、 同様 に し て 取り出す こと が 出来 ます 。 
テスト Excel . xls の クローズ 時 です よ ね ？ xl Boo k. Close ↓ xl Boo k. Close SaveChanges := True を 試し て ください 。 
複数 の シート 、 ブック を 扱う とき に は 、 それら を 省略 し たり 、 ActiveSheet や Activeworkbook など 不安定 な 記述 は 使わ ない よう に し ましょ う 。 With や 変数 を 使っ て 、 明示 的 に し ない と 頭 が 混乱 する だけ 。 Sub Macro 1 () Dim GYOU As Long Dim 様式 1 As Worksheet , 様式 2 As Worksheet Dim 様式 A As Worksheet , 様式 B As Worksheet With T hisWorkbook Set 様式 A = . Worksheets (" 様式 A ") Set 様式 B = . Worksheets (" 様式 B ") End With With Workbook . Open ( Filename :=" C :\ 共有 \ マクロ . xlsx ") Set 様式 1 = . Worksheets (" 様式 1 ") Set 様式 2 = . Worksheets (" 様式 2 ") 様式 1 . Unprotect 様式 2 . Unprotect 様式 A . Unprotect 様式 B . Unprotect 様式 A . Range (" A 2 : AA 2000 "). Copy 様式 1 . Range (" A " & Rows . Count ). End ( xlUp ). Offset ( 1 ). PasteSpecial xlPasteValues 様式 B . Range (" A 2 : W 2000 "). Copy 様式 2 . Range (" A " & Rows . Count ). End ( xlUp ). Offset ( 1 ). PasteSpecial xlPasteValues Application . CutCopyMode = False 様式 1 . Protect DrawingObjects := True , Contents := True , Scenarios := True 様式 2 . Protect DrawingObjects := True , Contents := True , Scenarios := True 様式 A . Protect DrawingObjects := True , Contents := True , Scenarios := True 様式 B . Protect DrawingObjects := True , Contents := True , Scenarios := True . Close SaveChanges := True End With End Sub 未 実行 につき 不具合 ご 容赦 
VB.NET は よく 知ら ない の です が 、 dt = Nothing に すれ ば いい の では ？ 呼び出し 側 は 、 dt = ExecuteSql (...) If dt Is Nothing Then で 判別 する 例外 の 内容 も 知り たい の で あれ ば 、 ExecuteSql メソッド に 、 参照 型 の 引数 を 追加 し 、 その 引数 に 例外 の 内容 を 格納 し て 返す 方法 が あり ます 。 私 だっ たら 、 単純 に 、 呼び出し 側 に 例外処理 を 追加 し て 、 ExecuteSql メソッド の 例外処理 は 削り ます が ...。 
まず 、 どこ まで 分かっ て いる の でしょ う か 。 1 . IE を 起動 2 . 目的 の ページ へ 接続 3 . 表示 終了 まで 待機 4 . 検索 窓 に キーワード 入力 5 . 検索 ボタン を 押す 6 . 表示 終了 まで 待機 検索 ページ が 不明 な ので 手順 しか 示せ ませ ん が 、 結果 まで の 手順 が こう なり ます 。 この 後 、 ・ 結果 ページ の HTML ソース を 解析 し て 、 結果 リスト の 規則 性 を 見つける 。 といった 手順 が 加わり 、 その 結果 から 、 適当 な ループ を 組ん で 、 Range オブジェクト を 使っ て セル に 代入 し たり 、 テキストファイル を 開い て 書き込ん だり し ます 。 検索 ページ によって コード は 個々別々 と 言っ て よく 、 サンプル コード といった 定型 フォーマット は あり ませ ん 。 とりあえず 上記 手順 を 参考 に 、 どこ が 分から ない の か を はっきり さ せ て 、 個別 に 尋ね て ください 。 
LIst ( Of T ) クラス から 派生 さ せ た SubList クラス を 定義 し て 現在 の _ d を 置き換え て み て は … Public Class SubList inherits List ( of String ) private _ sList as new List ( of String ) dim _ sortorder as SortOrder public overloads Sub Add ( ByVal item as string ) dim s1 as String = item .s ubstring ( 0 , 2 ) ' 前半 2 文字 を 記憶 _ sList . add ( s1 ) ' 3 文字 目 以降 を 記憶 MyBase . Add ( item .s ubstring ( 2 )) End Sub ' 昇順 : Ascending ' 降順 : Descending public property SortOrder as SortOrder get return _ sortorder end get set ( byval value as SortOrder ) _ sortOrder = value end set end Property private Function CompareTo ( byVal x as string , ByVal y as string ) as integer ’ Nothing と の 比較 if y is nothing then if _ sortorder = SortOrder . Descending then return - 1 end if return 1 end if if x <> y then if _ sortorder = SortOrder . Descending then ’ 降順 指定 の 場合 return y . CompareTo ( x ) end if ’ 昇順 指定 の 場合 return x . CompareTo ( y ) end if return 0 End Function public Orverloads sub Sort () ’ 3 文字 目 以降 の ソート MyBase .S ort ( Addressof CompareTo ) ’ 2 文字 目 まで の ソート _ sList .S ort ( AddressOf CompareTo ) End Sub End Class といった 具合 で どうでしょう ･･･ 
> 簡単 に 言う と > 選択 し た 雛形 ブック を コピー し て デスクトップ に 保存 と 書か れ て ます が 、 前半 の 説明 で は 複数 指定 さ れ た 雛形 を 一つ の ブック に まとめ て から 保存 する よう に 思え ます 。 その よう に する よう な サンプル を 以下 に 記載 し ます 。 なお 、 チェックボックス の 見出し に は かっこ （ 「 」 ） が 付い て いる ので 、 前後 １ 文字 ずつ を 除い た もの を 雛形 ブック 名 に し て い ます 。 出力 する ファイル 名 も わかり ませ ん ので 、 「 新規 ブック . xlsx 」 に し て い ます 。 （ サンプル ） Sub Command Button 1 _ Click () Dim desktop Path As String Dim hinagataPath As String Dim chkbox As OLEObject Dim cnt As Long Dim hinagataWB As Workbook Dim newWB As Workbook Application .S creenUpdating = False ' デスクトップ の パス 、 雛形 集 の パス を 取得 desktop Path = CreateObject (" WScript .S hell "). SpecialFolders . Item (" Desktop ") & "\" hinagataPath = desktop Path & " 雛形 集 \" ' すべて の OLE オブジェクト を 順に 処理 cnt = 0 For Each chkbox In ActiveSheet . OLEObjects ' OLE オブジェクト が チェックボックス の 場合 に 処理 する If TypeName ( chkbox . Object ) = " CheckBox " Then With chkbox . Object ' チェックボックス の チェック が 入っ て いる 場合 に 処理 する If . Value = True Then Set hinagataWB = Workbooks . Open ( Filename := hinagataPath & Mid (. Caption , 2 , Len (. Caption ) - 2 ) & ". xls ") If cnt = 0 Then ’ 選択 １つ 目 の 場合 に は 、 コピー で 新しい ブック を 作成 hinagataWB . Worksheets ( 1 ). Copy Set newWB = ActiveWorkbook Else ' 選択 ２つ 目 以降 は 、 新規 ブック の 最後 に コピー hinagataWB . Worksheets ( 1 ). Copy After := newWB . Worksheets ( newWB . Worksheets . Count ) End If ' 雛形 ブック は 閉じる hinagataWB . Close SaveChanges := False cnt = cnt + 1 End If End With End If Next Application .S creenUpdating = True If cnt = 0 Then ' チェック が ひとつ も ない 場合 は メッセージ を 表示 し て 終了 MsgBox " 雛形 が ひとつ も 指定 さ れ て い ませ ん " Else ' 新規 ブック を 保存 newWB .S aveAs Filename := desktop Path & " 新規 ブック . xlsx " MsgBox " 新規 ブック を 保存 し まし た " End If End Sub 
こんにちは。 1010 DATA 93 90 , 81 , 35 , 54 , 55 , 32 , 48 , 34 は 1010 DATA 93 , 90 , 81 , 35 , 54 , 55 , 32 , 48 , 34 ですよ。 最初 の データ 93 と 90 の あいだ の コンマ が 、 ない です 。 それ だ と 、 10 * 3 の データ そろい ませ ん 。 
Sub 一 例 です () Dim rng As Range , rtn On Error Resume Next Set rng = Range (" B4 ", Cells ( Rows . Count , 3 ). End ( xlUp )) _ .S pecialCells ( xlCellTypeConstants , xl Numbers ) If Err . Number = 0 Then rng .S elect rtn = MsgBox (" 入力 セル を 削除 し ます か ？", Buttons := vbYesNo ) If rtn = vbYes Then rng . Delete Shift := xlUp End If End If On Error GoTo 0 End Sub > コード の 意味 も 一緒に 解説 いただける と 幸い です 。 実質 10 行 程度 の コード 。 調べ て み て 解ら ない ところ を 返信 し て ください 。 調べる 技術 は 、 プログラミング 技術 の 重要 な 要素 の ひとつ 。 
仕様 が よく わから ない の です が 、 どこ か の フォルダ に " A1 00 . docx "," B 100 . docx "," C1 00 . docx " が あっ て 、 それ を 開く 場合 でしょ う か 。 それとも A1 の 値 の ワード 文章 を 開く という 事 でしょ う か 。 [" C :\ sample \" フォルダ に " A1 00 . docx "," B 100 . docx "," C1 00 . docx " が ある 場合 ] Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim folder As String folder = " C :\ sample \" ' ファイル が ある フォルダ If Target . Address <> "$ A $1 " Then Exit Sub ' A1 で なけれ ば 終わり If ( Target = " A1 00 ") Or ( Target = " B 100 ") Or ( Target = " C1 00 ") Then ' A1 の 値 が " A1 00 . docx "," B 100 . docx "," C1 00 . docx " なら With CreateObject (" word . application ") ' Word . Visible = True ' 表示 . Documents . Open folder & Target & ". docx " ' 開く End With End If End Sub [" C :\ sample \" フォルダ に A1 の ワード ファイル が あっ たら 開く 場合 ] Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim folder As String folder = " C :\ sample \" ' ファイル が ある フォルダ If Target . Address <> "$ A $1 " Then Exit Sub ' A1 で なけれ ば 終わり If Dir ( folder & Target & ". docx ") = "" Then Exit Sub ' 指定 フォルダ に ファイル が 無けれ ば 終わり With CreateObject (" word . application ") ' Word . Visible = True ' 表示 . Documents . Open folder & Target & ". docx " ' 開く End With End Sub 
どんな マクロ を 実行 し て いる の か 判ら ない ので 答え よう が ない です 。 
コード 例 です 。 コード 内 の 「 シート 1 」 や 「 シート 2 」 は 実際 の シート 名 に 書き換え て ください 。 動作 確認 は し て い ない ので 、 不具合 が あれ ば ご 返信 ください 。 Private Sub CommandButton 1 _ Click () Dim i As Long Dim Rng 1 As Range Dim Rng 2 As Range Set Rng 1 = Worksheets (" シート 1 "). Cells ( Rows . Count , " C "). End ( xlUp ). Offset ( 1 ). EntireRow Set Rng 2 = Worksheets (" シート 2 "). Cells ( Rows . Count , " C "). End ( xlUp ). Offset ( 1 ). EntireRow For i = 1 To 15 If Controls (" TextBox " & i ). Value = "" Then Exit For Rng 1 . Cells ( i ). Value = Controls (" TextBox " & i ). Value Rng 2 . Cells (( i - 1 ) Mod 3 + 1 ). Value = Controls (" Textbox " & i ). Value If i Mod 3 = 0 Then Set Rng 2 = Rng 2 . Offset ( 1 ) Next End Sub 
属性 値 の 取得 は 、 getAttribute を 使え ば 可能 です 。 タグ オブジェクト 「 t 」 が 取得 済み だ として 、 n = t . getAttribute (" name ") と し ます 。 他 の 属性 値 も 、 「 class 」 「 ari a-c hecked 」 といった よう な 属性 名 を 指定 する こと で 取得 可能 です 。 ただし 、 どの タグ を 対象 に する か は 、 事前 に 決め て おか なく て は いけ ない でしょ う 。 
> ブック を 開け ない 、 と エラー が 表示 さ れ ます 。 伝票 . xlsx は 、 カレント フォルダ に 格納 さ れ て いる という こと です よ ね ？ そう で ない の なら 、 Filename :=" 伝票 . xlsx " を Filename :=" C :\ AAA \ 伝票 . xlsx " といった フル パス 指定 に し て み て ください 。 > 開く と 他 の データソース へ の リンク が 含ま れ て い ます > と 表示 さ れ ます 。 手動 で 開い た という こと でしょ う か ？ もし 、 不要 な リンク という の なら 、 ネット 検索 で 探し http:// pc . nikkeibp . co.jp / article / column / 20081022 / 1009006 /? P = 1 の よう な サイト の 対応 策 を 実行 し て ください 。 必要 な リンク で 、 リンク の 更新 を 行わ なく て 良い の で あれ ば 、 Set TargetBook = Workbooks . Open ( Filename :=" 伝票 . xlsx ", UpdateLinks := 0 ) と 書け ば 、 メッセージ は 表示 さ れ ませ ん 。 
こんな 感じ です ね 。 Sub Sample () Dim Rng As Range Dim DelStrs As Variant Dim Str As Variant Dim Sht As Worksheet DelStrs = Array (" check ", "/ 確認 ") For Each Sht In Worksheets For Each Rng In Sht . UsedRange For Each Str In DelStrs If InStr ( Rng . Value , Str ) > 0 Then Rng . Value = Replace ( Rng . Value , Str , "") End If Next Next Next End Sub 
判り やすい ＝ 短い じゃ ない ですよ。 正直 、 電卓 って 、 近年 の イベント 駆動 型 の プログラム の 基本 中 の 基本 で 、 オブジェクト指向 の テストケース です 。 まずは ボタン を 押し たら どう なる 。 何 を 準備 し ない と 計算 処理 が 出来 ない か 。 など 、 画面 設計 の 良い サンプル で も あり ます 。 自分 の レベル に あっ た ソース は 自分 で 作る しか ない でしょ う 。 まぁな ん だ ｇｇｒｋｓ 。 プログラム の 勉強 を する なら 、 自分 で 調べる 事 を まずは 覚え ましょ う 。 https :// www . google . co.jp /? gws _ rd = ssl # q = C % 23 % E3 % 80 % 80 % E 9 % 9 B % BB % E 5 % 8 D ... もっと 言う と 、 ここ は Visual Basic の 板 です 。 
> 帳票 フォーム ？ サブ フォーム ？ 等 を 駆使 すれ ば いい の でしょ う か ？ はい 、 その とおり です 。 っていう か 、 こういう ユーザーインターフェース ( UI ) の 設計 は 、 やり たい こと が 実現 できれ ば すべて 正解 、 あと は 好み や センス の 問題 、 ユーザー にとって わかり やすく 使い やすく 、 操作 ミス に は 寛大 で 、 それ て い て 致命 的 な ミス は 許容 し ない 、 それ が 優れ た UI と 言わ れ て い ます 。 ちなみに 、 リスト ボックス に 直接 入力 する こと は でき ませ ん 。 この 場合 、 リスト ボックス の 近く に テキストボックス を 設け 、 さらに その 横 に コマンド ボタン を 貼っ て 、 テキストボックス に 入力 し た データ を ボタン を 押し て リスト ボックス に 追加 する よう に し ます 。 [ 追加 ] ボタン の 横 に は [ 削除 ] ボタン が あっ た ほう が いい かも 。 この 時 、 リスト ボックス で 選択 さ れ て い ない 状態 で [ 削除 ] ボタン が 押さ れ た 場合 に 備える 必要 が あり ます 。 それ か 、 帳票 フォーム の サブ フォーム を 埋め込ん で そこ に 入力 し て いく と か 。 
UserForm 上 における カーソル の 移動 は Sendkeys メソッド を 使う の が 安全 です 。 Me . Controls (" a " & n ). Visible = True の 次 の 行 へ SendKeys "{ TAB }" を 記述 する と どうでしょう か ? Me . Controls (" a " & n ). Visible = True SendKeys "{ TAB }" ' Me . Controls (" a " & n ). SetFocus ← この コード は 削除 タブ オーダー は a1 → a 2 → a3 → a 4 → b 1 → b2 → ... と 設定 し ます 。 
> 途中 何 も 入力 し ない 列 や行 に 変化 する 場合 も あり ます 。 > また 、 同じ シート に 複数 の 表 が あり ます 。 データ 部分 は 空白 が あっ て も 良い の です が 、 見出 し行 （ 例 の 場合 は ２ 行 目 ） は 必ず 何 か 入っ て いる と し ます 。 また 、 表 と 表 の 間 は １つ 以上 の 空白 列 が あり 、 上下 に は 並ん で いない と し ます 。 そういった 前提 条件 で こんな 感じ で は どうでしょう か 。 Dim r As Range Dim m As Long ’ 表 の 左上 を 起点 と し ます With Range (" B2 ") m = . Row ' 起点 から 左 方向 に 空白 に なる 手前 まで 処理 し ます For Each r In Range (. Address , . End ( xlToRight )) ' 各 列 の 最終 行 が 大きい も を 求め ます m = Application . WorksheetFunction . Max ( m , Cells ( Rows . Count , r . Column ). End ( xlUp ). Row ) Next ' 起点 から 左 方向 に 空白 に なる 手前 まで の 列 、 かつ 最大 行番号 まで を 選択 し ます Range (. Address , Cells ( m , . End ( xlToRight ). Column )). Select End With 
そういう とき は TEST 1 の 中 、 「 End 」 で は なく 「 Exit Sub 」 を 使い ましょ う 。 
最初 の Function SUBCONCATE NATE ( rngArea As Range ) As String は 、 なんで 途中 で 改行 さ れ て いる の でしょ う か ？ Function SUBCONCATENATE ( rngArea As Range ) As String と １ 行 に なっ て いれ ば 、 問題 なく 動き ます 。 セル で 「 = SUBCONCATENATE ( A1 : A5 0 )」 の よう に 使っ て も エラー は 出 ませ ん でし た よ 。 結果 も フィルタ で 表示 さ れ た値 のみ が 連結 さ れ まし た 。 
配列 じゃなくて Dictionary なら 簡単 に でき ます 。 Dictionary の Exists と 言う メソッド が 既に 存在 し て いる 値 か否 か を 判断 し て くれ ます んで 、 ぐるっと ループ すれ ば 出来上がり 。 配列 で やる と 手間 が もう 一周 増える ん です よ ね 。 って 、 Dictionary から 配列 に コンバート する に も ループ が 必要 だ から 手間 は 同じ です ね 。 VB .net なら メソッド 一 発 で 変換 出来る んで Dictionary や Collection を 噛ま す の が 一般 的 な ん です が 。 ↓ 各種 ロジック の 比較 http:// www . eurus . dti . ne.jp /~ yoneyama / Excel / vba / vba _ jyufuku . html 
よく わかり ませ ん が 、 作成 さ れ た チェックボックス が すべて 同じ 名前 な ので 、 For Each myChk In ActiveSheet . CheckBoxes の ルーティン で も 、 最初 の チェックボックス を 見 に 行っ て いる の で は ない でしょ う か 。 保存 後 、 閉じ ない で そのまま ２つ 目 以降 の チェックボックス の 名前 を 確認 し て み て ください 。 最初 の chkSelect から チェック xx の よう に 変化 し て いる はず です 。 作成 する 時点 で 、 チェックボックス の 名前 を chk . Name = " chkSelect " & i の よう に する と 、 最初 から 正しい アドレス が 取得 さ れ ます 。 
タブ コントロール の ページ に は 背景色 を 指定 でき ませ ん 。 代替 案 です が 、 よく やる の は 各 ページ に 四角 を 最初 に 配置 し 、 出来る だけ ページ いっぱい に し て 背景色 を 変え て おく くらい でしょ う か 。 
＞ 更新 を 1つ の ボタン で 処理 し たい の です が と は どう 言う 意味 です か ？ A . csv B . csv C . csv ・ ・ ・ の 処理 を ボタン １ 回 で 全て 行い たい と 言う 事 です か ？ だ と し たら MsgBox " 更新 1 が 完了 し まし た 。 " の 部分 を 下記 に 変更 すれ ば ” 更新 1 ” ボタン を 押す だけ で 全て できる はず です 。 （ 更新 2 以後 の ボタン は 削除 し て も 良い です が 、 プログラム コード は そのまま 使い ます 。 ） 更新 2 _ Click 更新 3 _ Click 更新 4 _ Click ・ ・ ・ MsgBox " 更新 が 完了 し まし た 。 " 
以下 の コード でいか が でしょ う か ？ Option Explicit Sub Sample () Const srcName As String = " 15本 番 データ " Const dstName As String = " 16 テストデータ " Dim fPath As String Dim fName As String fPath = ThisWorkbook . Path & "\" fName = Dir ( fPath & srcName & "*. xlsx ") Do While fName <> "" Name fPath & fName As Replace ( fPath & fName , srcName , dstName ) fName = Dir () Loop End Sub 
>' 印刷 ボタンアイコン を 使用 できる よう に する > Application . CommandBars (" Standard "). Controls ( 6 ). Enabled = True >' 印刷 ボタンアイコン を 使用 でき なく する > Application . CommandBars (" Standard "). Controls ( 6 ). Enabled = False エラー 9 と の こと な ので この 部分 が Excel の バージョン に 依存 し て エラー し て いる と 思い ます 。 印刷 ボタン アイコン の 使用 の 可 不可 を 切り替える 部分 を 、 便宜 的 に コメントアウト し て 必要 な 処理 を 実行 できる よう に し て は どうでしょう か ？ ' 印刷 ボタンアイコン を 使用 できる よう に する ' Application . CommandBars (" Standard "). Controls ( 6 ). Enabled = True ' 印刷 ボタンアイコン を 使用 でき なく する ' Application . CommandBars (" Standard "). Controls ( 6 ). Enabled = False ボタン の コントロール を 外す と コード の 実行 中 も 印刷 できる よう に なっ て しまう ので 、 期待 通り に 動作 する よう に なっ たら 、 別 の 質問 で リボン の 印刷 ボタン を コントロール する コード を 尋ね られ て は と 思い ます 。 それ と 、 この コード は Window の 動作 に も 依存 し て いる ので 、 Excel 2013 では 期待 通り に 動か ない 可能性 が あり ます 。 
> If Me . 連絡 先 = " 無 " Or Len ( Me ! 連絡 先 ) > 0 And Len ( Me ! 連絡 先 ) <> 11 Then で は 、 「 連絡 先 が " 無 " か 、 11 桁 で なけれ ば 」 な ので 、 その 時 エラー に なる ので 、 「 連絡 先 が " 無 " で ない し 、 11 桁 でも なけれ ば 」 エラー に する なら Private Sub 連絡 先 _ BeforeUpdate ( Cancel As Integer ) If ( Me . 連絡 先 <> " 無 ") And ( Len ( Me ! 連絡 先 ) <> 11 ) Then MsgBox " 携帯 は 11 桁 です 。 " Cancel = True End If End Sub と なる と 思い ます 。 または 、 Private Sub 連絡 先 _ BeforeUpdate ( Cancel As Integer ) If Me . 連絡 先 = " 無 " Then Exit Sub If Len ( Me ! 連絡 先 ) = 11 Then Exit Sub MsgBox " 携帯 は 11 桁 です 。 " Cancel = True End Sub と すれ ば 、 " 無 " の 時 と 11 桁 の 時 は ExitSub し て 、 それ 以外 の 時 は エラー を 表示 する という の で も いい と 思い ます 。 
実行 時 エラー 9 インデックス が 有効 範囲 に ありません ブック が 開か れ て い ない シート が 存在 し ない という こと 。 お 示し の コード で は 、 以下 の 2 点 を 最初 に 確認 し て ください 。 １ ） 以下 の ブック が 開か れ て いる こと " Boo k2 . xlsm " " Book 1 . xlsx " " Book 1 " ( 保存 前 ？？) ２ ） １ ） が OK なら 、 以下 の シート が 存在 する こと " Boo k2 . xlsm " の シート " wk " " Book 1 . xlsx " の シート " Sheet 1 " Thisworkbook （ 実行 中 の マクロ が 格納 さ れ て いる ブック ） の シート " wk " " Book 1 " の シート " Sheet 1 " 
ソート の ロジック や For ～ Next の 書き方 は 問題 ない です 。 ただし 、 Excel の セル 範囲 を 配列 に 入れる と 、 ２ 次元 配列 に なっ て しまい ます 。 しかも 、 あらかじめ 配列 で 定義 し た 変数 に は 代入 でき ませ ん 。 Variant 型 の 変数 、 それ も 配列 で ない 変数 に 代入 する と 、 それ が 勝手 に 配列 に なっ て しまい ます 。 「 なんで 」 と 思い ます が 、 そういう もの の よう です 。 それ を 考慮 し て 、 上記 の コード を 直す と こんな 風 に なり ます 。 Dim i As Long Dim j As Long Dim work As Variant Dim age As Variant '<= 配列 で ない 変数 age = Range (" D1 : D10 "). Value '<=. Select で は なく . Value （ もしくは 省略 ） i = 1 j = i + 1 For i = i To 9 For j = i To 10 ' これ 以降 、 ２ 次元 配列 な ので 、 ２つ 目 の 添え 字 「, 1 」 を 追加 If age ( i , 1 ) > age ( j , 1 ) Then work = age ( j , 1 ) age ( j , 1 ) = age ( i , 1 ) age ( i , 1 ) = work End If Next j Next i Range (" D1 : D10 ") = age '<= 戻す 時 は そのまま 
下記 の 質問 を し た 方 です か ？ http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1115895018 ... そう で ない なら ば 、 上記 QA が ヒント に なる でしょ う 。 もしも 同じ 方 でし たら 、 何故 、 返信 を 返さ ない の でしょ う か 。 分から ない に せよ 、 動か ない に せよ 、 応答 が なけれ ば 解決 し ませ ん ( 返信 する な 、 と 回答 し た 覚え は ない の です から )。 
この くらい なら UWSC ホームページ の サンプル // 掲示板 の スレ を テキストファイル として 保存 する # N2 7 [ http:// www . uwsc . info / sample . html # N2 7 ] を 参考 に すれ ば 作れ ます 。 今回 は 、 タグ を 調べ なく て も between str で 十分 です 。 問題 は 、 この ページ の 反応 が 非常 に 遅く 、 手動 の 方 が 速い くらい です 。 実用 的 に 使う に は 、 何らかの 工夫 が 必要 です 。 エクセル へ の 貼付 は 、 力量 も ・ 詳細 も 不明 です ので とりあえず 、 クリップボード 経由 で いい でしょ う 。 それ と 、 丸投げ 的 な 質問 に は 答えよ う が なく 、 大半 が スルー さ れる でしょ う 。 極力 、 自作 スクリプト を 提示 し て 、 アドバイス を 求める べき です 。 最初 の 内 は 「 参考 」 って 言っ て も 山 ほど 疑問 が 沸い て くる もの です 。 それ を 、 調べ て 解決 する 事 こそ が 、 最大 の 勉強 ですよ。 
値 の 左 4 桁 = Left ( 値 , 4 ) 値 の 右 6 桁 = Right ( 値 , 6 ) です 。 
なぜ に この カテゴリ へ ？ 
> Gmail の 本文 を 抽出 し たい です 。 Google Apps Script か VBA で コード を 書い て い た だけ ませ ん か ？ それ は ＩＤ 非公開 で 頼める よう な 事 で は 無い ので 、 クラウドソーシング や システム 屋 に でも 頼ん で やっ て もらい ましょ う 。 ただ 、 Google Apps Script や VBA で は なく 普通 に 作っ た 方 が 安く て 便利な物 に なる と 思い ます 。 
「 Finder 項目 を 検索 」 で 可能 です 。 また find コマンド を 使う こと でも 可能 です 。 コマンド は 「 シェルスクリプト を 実行 」 に 書き込む こと で Automator で 使う こと が でき ます 。 
＞( Press Retry to debug the application ) って 書い て ある ん だ から 、 Retry ( 再 試行 ) を 押し ましょ う 。 そう する と 、 デバッグモード に なっ て 、 該当 ソース 位置 で 止まり ます 。 input . cpp です が 、 それ は マイクロソフト の ライブラリ の ファイル 名 です 。 たぶん 「 ソース が ない よ 」 って 表示 さ れる ので 、 " 上 の 関数 に 戻る ボタン " を 押し ます 。 何 回 か上 に 上がる と 、 自分 の 書い た コード の fscanf とか getline とか fgets とか の 位置 ( または その 次 の 行 ) に 来る と 思い ます 。 それだけ な ん です が 「 stream != nullptr 」 に 注目 し て ください 。 これ は 「 stream ( ファイル ポインタ の 親戚 です ) が NULL 以外 で なけれ ば なら ない 」 という 意味 な ので 、 ret = fgets ( buffer , sizeof ( buffer ), file _ ptr ); とか の file _ ptr が nullptr ( または NULL ) である という こと だ と 推測 でき ます 。 つまり 、 ファイル を 開い た とき に 失敗 し て いる 可能性 が 高い という こと です 。 該当 ファイル が 相対パス なら ちゃんと 、 exe と 同じ フォルダ に あり ます か ？ デバッグ と リリース で フォルダ が 違っ たり する ので 確認 し て ください 。 絶対パス なら 、 「 C :\\ Users \\ username \\ Documents \\」 みたい に ちゃんと 書い て ある か 確認 を し て ください 。 または エディタ で 該当 ファイル を 開い て い て ロック さ れ て い て 、 プログラム から 開け ない 場合 も ある も しれ ませ ん 。 また 、 ファイル が なく て も デバック 画面 が 出る エラー に なら ない よう に 、 fopen 系 の 後 に 、 NULL チェック を 書い て ください 。 下記 の よう な 物 です 。 file _ ptr = fopen (" text . txt ", " r "); if ( NULL == file _ ptr ){ fprintf ( stderr , " File Open Error .\ n "); return 1 ; } 
「 コンボボックス を 選ん で も （ 修正 ） ２ 列 が 表示 さ れる 」 と 書か れ て い ます が 、 どこ に ２ 列 が 表示 さ れる の でしょ う か ？ コンボボックス が 選ば れ た とき の 処理 は Private Sub ComboBox 3 _ Change () に 記述 し ます 。 それ 以外 は 以下 の コード と なり ます 。 Option Explicit Private Sub UserForm _ Initialize () Dim st 2 As Worksheet Dim lRow 2 As Long , r As Long Set st 2 = Worksheets (" マスター シート ") lRow 2 = st 2 . Range (" A " & Rows . Count ). End ( xlUp ). Row With ComboBox 3 . ColumnCount = 3 . ColumnWidths = " 0cm ; 3cm ; 1cm " . BoundColumn = 1 For r = 2 To lRow 2 setItem r Next End With End Sub Private Sub CommandButton 1 _ Click () Dim st 1 As Worksheet , st 2 As Worksheet Dim rng As Range Dim w As Variant Dim r As Long Set st 1 = Worksheets (" Sheet 1 ") Set st 2 = Worksheets (" マスター シート ") ' テキストボックス の 内容 が 空欄 なら 何 も し ない If TextBox 1 . Text = "" Then Exit Sub ' Sheet 1 の A 列 から テキストボックス に 入力 さ れ た 内容 と 一致 する セル を 探す Set rng = st 1 . Range (" A : A "). Find ( TextBox 1 . Text ) If rng Is Nothing Then Exit Sub ' 該当 する セル が 存在 し なけれ ば 何 も し ない ' マスター シート の C 列 から 品 Ｎｏ が 一致 する セル を 探す Set rng = st 2 . Range (" A : A "). Find ( st 1 . Range (" C " & rng . Row ). Value , LookIn := xlValues ) If rng Is Nothing Then Exit Sub ' 該当 する セル が 存在 し なけれ ば 何 も し ない r = rng . Row ' コンボボックス の 内容 を 一旦 クリア する ComboBox 3 . Clear ' コンボボックス に 品 Ｎ ｏ 、 品種 、 年 を セット する setItem r End Sub Private Sub setItem ( r As Long ) Dim st 2 As Worksheet Set st 2 = Worksheets (" マスター シート ") With ComboBox 3 ' コンボボックス に 品 Ｎ ｏ 、 品種 、 年 を セット する . AddItem st 2 . Range (" A " & r ). Value . List ( r - 2 , 1 ) = st 2 . Range (" B " & r ). Value . List ( r - 2 , 2 ) = st 2 . Range (" C " & r ). Value End With End Sub Private Sub ComboBox 3 _ Change () Dim idx As Integer idx = ComboBox 3 . ListIndex If idx = - 1 Then Exit Sub ' 選択 さ れ た行 の 品 Ｎｏ は . List ( idx , 0 ) で 取り出せる ' 選択 さ れ た行 の 品種 は . List ( idx , 1 ) で 取り出せる ' 選択 さ れ た行 の 年は . List ( idx , 2 ) で 取り出せる End Sub 
具体 性 に 欠ける プログラミング 依頼 です ね 。 とりあえず 、 アクティブ な ブック の すべて の ワーク シート を 対象 に 、 B 1 セル に 、 「 ＝ A1 」 という 式 を 入力 する プログラム です 。 Sub 一 例 です () Dim sh As Worksheet For Each sh In ActiveWorkbook . Worksheets sh . Range (" B 1 "). Formula = "= A1 " Next sh End Sub 
まず 、 Dir で ファイル 名 を 取得 する 場合 、 「***. csv 」 で は なく 「*. csv " インポート する テーブル 名 が 「 " csv 定義 " & " csv "」→「 csv 定義 csv 」 と 固定 に なっ て しまう ため ひとつ の テーブル に 追加 さ れ て しまう 。 また 、 インポート する ファイル 名 myFilename に は パス 名無し の ファイル 名 が 入っ て いる ので 、 myPath を 前 に つけ て やる 。 （ 修正 し た サンプル ） Sub cmdImport () Dim myFilename As Variant Dim myPath As Variant myPath = " C :\ Users \ Desktop \ 過去 データ \" myFilename = Dir ( myPath & "*. csv ") Do Until myFilename = "" DoCmd . TransferText acImportDelim , , Left ( myFilename , Len ( myFilename ) - 4 ), my Pat h & m yFilename , True myFilename = Dir () Loop End Sub 
Sub 一 例 です () Dim xRng As Range With Selection . EntireRow . Copy Workbooks (" BookB . xlsx "). Worksheets (" Sheet 1 ") _ . Cells ( Rows . Count , 1 ). End ( xlUp ). Offset ( 1 ). EntireRow . PasteSpecial For Each xRng In . Areas xRng . Columns ( 1 ). Value = " 印 " Next xRng End With End Sub 
何処 で 一 回 と 数える か ？ と 言う 、 すさまじく 難しい 問題 は 置い て おい て 、 Workbook を 開く 度 に 1度 で あれ ば 以下 の よう な 方法 が 考え ら え れ ます 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim CheckRange As Range Static CheckSet As New Dictionary ' Microsoft .S cripting . Runtime を 参照 し て ください For Each CheckRange In Target If CheckSet . Exists ( CheckRange . Address ) Then ' 何 に も し ない Else ’ I 列 か 確認 If CheckRange . Column = 9 Then ’ 未 入力 、 削除 だっ たら 空 に する If IsNull ( CheckRange . Value ) Then Cells ( CheckRange . Row , 10 ). Value = "" Else ’ そう じゃ なかっ たら 値 を コピー Cells ( CheckRange . Row , 10 ). Value = CheckRange . Value End If ’ 処理 記録 ( 値 1 は 適当 ） CheckSet . Add CheckRange . Address , 1 End If End If Next End Sub 
難しい と いう より 、 面倒 な だけ です 。 仮に 、 「 HTML として の 完成 形 」 が 、 次 の よう な もの だ と し ます （ table 部分 のみ 抜粋 ） 。 < table border =" 1 " width =" 700 " height =" 635 "> < tbody > < tr > < td id =" f1 ">< a href ="./ sample 1 . htm "> 1 </ a ></ td > < td id =" f2 ">< a href ="./ sa mpl e2 . htm "> 2 </ a ></ td > < td id =" f3 ">< a href ="./ sa mpl e3 . htm "> 3 </ a ></ td > </ tr > </ tbody > </ table > これ は つまり 、 td 要素 の 直下 に 、 子 要素 として a 要素 を 追加 する 、 という 事 です 。 JavaScript で HTML DOM に 要素 を 新規 追加 する に は 、 １ ． createElement メソッド で 新規 要素 を 生成 する ２ ． 生成 し た 要素 に 必要 な 属性 を 追記 する ３ ． appendChild メソッド で 新規 要素 を 親 要素 に 追加 する という 手順 を 踏み ます 。 これ を 律儀 に JavaScript で 書く と 、 次 の よう な 感じ に なり ます 。 var arrayD = [ // 対応 する 配列 要素 に 、 必要 な データ を 全て 埋め込ん で おく {" id ":" f1 ", " link ":"./ sample 1 . htm "}, {" id ":" f2 ", " link ":"./ sa mpl e2 . htm "}, {" id ":" f3 ", " link ":"./ sa mpl e3 . htm "} ]; for ( var i = 0 ; i < arrayD . length ; i ++){ var elem = document . getElementById ( arrayD [ i ]. id ); // 親 要素 を 取得 var newElem = document . createElement (" a "); // 子 要素 を 生成 newElem . href = arrayD [ i ]. link ; // 子 要素 の href 属性 を 設定 newElem . innerText = i + 1 ; // 子 要素 の 内容 を 設定 ( 1 から 、 に し た ) elem . appendChild ( newElem ); // 子 要素 を 親 要素 に 追加 } また 、 必要 な リンク 先 アドレス が 、 計算 で 作れる の で あれ ば 、 配列 内 に 持た なく て も 、 次 の よう に 実装 でき ます 。 var arrayD = [" f1 "," f2 "," f3 "]; for ( var i = 0 ; i < arrayD . length ; i ++){ var elem = document . getElementById ( arrayD [ i ]); // 親 要素 を 取得 var newElem = document . createElement (" a "); // 子 要素 を 生成 newElem . href = "./ sample "+( i + 1 )+". htm "; // 子 要素 の href 属性 を 設定 newElem . innerText = i + 1 ; // 子 要素 の 内容 を 設定 ( 1 から 、 に し た ) elem . appendChild ( newElem ); // 子 要素 を 親 要素 に 追加 } この テクニック を 自在 に 使える よう に なる と 、 JavaScript で HTML を 自由 に 変更 できる よう に なり ます 。 ご 参考 に なれ ば 幸い です 。 
22 行 目 と 25 行 目 に 設定 し たい 数式 は R1 C1 参照 形式 で 表す と どちら も = IF ( AND ( R1 9 C >= R [- 2 ] C3 , R1 9 C <= R [- 2 ] C4 )," 1 ","") に なり ます 。 です ので 、 VBA で は 下記 の よう に なり ます 。 Sub Sample () Dim r As Range For Each r In Range (" G2 2 : BJ 22 , G2 5 : BJ 25 ") r . FormulaR 1 C1 = "= IF ( AND ( R1 9 C >= R [- 2 ] C3 , R1 9 C <= R [- 2 ] C4 ),"" 1 "","""")" Next End Sub 
テキスト 1 の 更新 後 処理 で 、 テキスト 1 の 値 が A 、 かつ テキ スト2 の 値 が 日付 で ない 場合 に 、 今日 の 日付 を テキ スト2 に セット 。 （ サンプル ） Private Sub テキスト 1 _ AfterUpdate () If [ テキスト 1 ]. Value = " A " And Not IsDate ([ テキ スト2 ]. Value ) Then [ テキ スト2 ]. Value = Format ( Now (), " yyyy / m / d ") End If End Sub 
start ftp - s : ftp _ AAA _ img . txt start ftp - s : ftp _ BBB _ img . txt 
長く なり ます が 、 下記 で 出来 ます 。 Dim i As Long , j As Long , k As Long , rr As Long i = Cells ( Rows . Count , " C "). End ( xlUp ). Row j = Cells ( Rows . Count , " D "). End ( xlUp ). Row k = Cells ( Rows . Count , " E "). End ( xlUp ). Row rr = Application . Max ( i , j , k ) Application . Inter sect ( ActiveSheet . UsedRange , Range (" C1 : E " & rr )). Select 
For i = 0 To 10 Application . OnTime Now + TimeValue (" 00 : 00 : 0 " & i ), " Sample ", , False ' Next ↑ 1 分 おき に Sample を 呼び出し て いる のに 、 これ で は 10 秒 先 まで しか キャンセル でき て い ませ ん 。 下記 コード で 試し て み て ください 。 Sub ボタン 2 _ Click () ' 停止 ボタン Dim i As Long On Error Resume Next For i = 0 To 60 Application . OnTime Now + TimeValue (" 00 : 00 :" & Format ( i , " 00 ")), " Sample ", , False Next End Sub 
＜ 0 . 1 ～ 1 . 0 の 間 で 、 100回 の 試行 回数 について だいたい 均等 に 分布 さ れる よう な 乱数 を 発生 さ せる ＞ 0 . 01 から 1 まで 0 . 01 刻み だ と １ ０ ０ 個 あり ます 。 それ を 均等 に という こと は さいこ ろ を ６ 回 振っ て １ ～ ６ まで を 均等 に 、 と 言っ て いる の と 同じ です 。 これ で は 丁半 博奕 の 人 は 困っ て しまい ます 。 C ２ セル に ０ ． ０ １ と 入れ ます 。 C3 セル に ０ ． ０ ２ と 入れ ます 。 C 2 : C3 セル を 下 に C1 01 まで コピー し ます 。 A 2 セル （ A1 セル は 空白 ） に = INDEX ( C $2 : C $101 , SMALL ( INDEX ( COUNTIF ( A $1 : A1 , C $2 : C $101 )* 1000 + ROW ( A $1 : A $100 ),), RANDBETWEEN ( 1 , 101 - ROW ( A1 )))) この 数式 で 均等 な 数字 を 出せ ます 。 A 2 セル を A1 01 まで コピー E2 セル に = COUNTIF ( C $2 : C $101 , A 2 ) と 入れ て E 101 まで コピー し て 検証 し ます 。 全部 １ に なれ ば OK です 。 これ は 均等 に 分布 し 、 ランダム に 並ん だ 表 を 作る 、 という こと で あっ て ランダム な 数字 を 作る の と は ちょっと 意味 が 違い ます 。 ランダム な 数字 が 欲しけれ ば = RANDBETWEEN ( 1 , 100 )/ 100 で 充分 だ と 思い ます 。 
＜ 0 . 1 ～ 1 . 0 の 間 で 、 100回 の 試行 回数 について だいたい 均等 に 分布 さ れる よう な 乱数 を 発生 さ せる ＞ 0 . 01 から 1 まで 0 . 01 刻み だ と １ ０ ０ 個 あり ます 。 それ を 均等 に という こと は さいこ ろ を ６ 回 振っ て １ ～ ６ まで を 均等 に 、 と 言っ て いる の と 同じ です 。 これ で は 丁半 博奕 の 人 は 困っ て しまい ます 。 C ２ セル に ０ ． ０ １ と 入れ ます 。 C3 セル に ０ ． ０ ２ と 入れ ます 。 C 2 : C3 セル を 下 に C1 01 まで コピー し ます 。 A 2 セル （ A1 セル は 空白 ） に = INDEX ( C $2 : C $101 , SMALL ( INDEX ( COUNTIF ( A $1 : A1 , C $2 : C $101 )* 1000 + ROW ( A $1 : A $100 ),), RANDBETWEEN ( 1 , 101 - ROW ( A1 )))) この 数式 で 均等 な 数字 を 出せ ます 。 A 2 セル を A1 01 まで コピー E2 セル に = COUNTIF ( C $2 : C $101 , A 2 ) と 入れ て E 101 まで コピー し て 検証 し ます 。 全部 １ に なれ ば OK です 。 これ は 均等 に 分布 し 、 ランダム に 並ん だ 表 を 作る 、 という こと で あっ て ランダム な 数字 を 作る の と は ちょっと 意味 が 違い ます 。 ランダム な 数字 が 欲しけれ ば = RANDBETWEEN ( 1 , 100 )/ 100 で 充分 だ と 思い ます 。 
こんにちは ② If TextBox 1 = Range (" E 135 ") Then は ② If val ( TextBox 1 ) = val ( Range (" E 135 ")) Then で 、 ためし て ください 。 オブジェクト を プロパティ を 使わ ない で if は 、 ちょっと 厳しい です ほそく の testbox . value は 、 結果 、 「 文字列 」 ですよ。 型 を そろえ て まみ ましょ う 
提示 さ れ て いる ソース に 間違い は 見つけ られ ませ ん 。 提示 さ れ て い ない ソース に バグ が ある もの と 推察 し ます 。 
表 の 仕様 が 分から ない ので 、 違っ た 視点 で の 一 例 です 。 塗りつぶし を 解除 し たい 場合 は 、 C 列 の セル を ダブルクリック する と し て い ます 。 Private Sub Worksheet _ BeforeDoubleClick ( ByVal Target As Range , Cancel As Boolean ) Const Iro 0 As String = xlNone Const Iro 6 As Integer = 6 With T arget If . Offset (, - 1 ) = "" Then Range (. Offset (, - 1 ), Cells (. Row , . End ( xlToRight ). Column )). Interior . Color Index = Iro 6 ElseIf Target . Offset (, 1 ) = "" Then Range ( Cells (. Row , . End ( xlToLeft ). Column ), . Offset (, 3 )). Interior . Color Index = Iro 6 Else . EntireRow . Interior . Color = Iro 0 End If End With Cancel = True End Sub 
回答 で は ありません が … いまいち 、 何 を し たい の か が わかり ませ ん 検索 範囲 は 、 ワーク シート 全体 な の でしょ う か ？ また 、 条件 に 合っ た 場合 右 列 に 指定 文字 を 入れる と 、 検索 順序 によって は 、 本来 検索対象 の 文字列 A が 有っ た に も かかわら ず 、 文字列 A を 消す よう に 指定 文字列 を 入れ て しまう 恐れ が あり ます よ ね 。 質問 内容 の 記載 方法 を ① 検査 範囲 は ワーク シート 全体 の 中 で 、 ② 検索対象 の 列 は 、 列 A 、 C 、 E の 奇数 列 を 検索 し て 行き ③ 参照 し た セル の 内容 が ④ 文字列 A を 含む 場合 で 且つ 文字列 B を 含ま ない 場合 に 限り 、 ⑤ 隣 の セル ( 列 B 、 D 、 F ) に 指定 文字 を 入れる の 様 に もう少し 具体 的 に する と 、 回答 も し やすく なっ て 、 より 多く の 回答 が 得 られる と 思い ます が 、 いかが でしょ う か ？ 
貴方 は その 文字化け する テキストファイル を どの よう に 処理 し たい の です か ？ １ ： そのまま 処理 し たい 。 ２ ： 文字化け し ない ファイル に 変換 し て から 処理 し たい 。 もし ２ なら 「 テキストファイル 文字化け 」 等 で ネット 検索 すれ ば 対処 方法 は 見つかる と 思い ます 。 もし １ なら 上記 と 同じ 検索 で 、 現在 の 文字コード が 何 か の 調べ 方 が 判る と 思い ます 。 文字コード が 判っ たら 、 改めて 処理 方法 を ネット で 調べ て 下さい 。 
リスト と 配列 は 別 です 。 リスト は " List < 型 >"、 配列 は " 型 []" の よう に 定義 する ので 、 この 場合 は 型 です 。 pt s2 . Remove ( 省略 ); の よう に できる の は リスト のみ です 。 従って 、 配列 で は なく リスト で 定義 し て あげる 必要 が あり ます 。 List < Point > pts = new List < Point > { new Point { X = 50 , Y = 50 }, new Point { X = 50 , Y = 75 }, new Point { X = 75 , Y = 80 }, new Point { X = 70 , Y = 60 }, new Point { X = 100 , Y = 70 }, new Point { X = 110 , Y = 45 } }; List < Point > pt s2 = new List < Point > { new Point { X = 200 , Y = 50 }, new Point { X = 250 , Y = 250 }, new Point { X = 290 , Y = 240 }, new Point { X = 300 , Y = 140 }, new Point { X = 400 , Y = 150 }, new Point { X = 450 , Y = 205 }, new Point { X = 500 , Y = 220 } , new Point { X = 460 , Y = 70 } }; List < Point > pt s3 = new List < Point > { new Point { X = 16 , Y = 10 }, new Point { X = 55 , Y = 95 }, new Point { X = 66 , Y = 92 }, }; 
◆ 条件 付き 書式 による 方法 です １ ） C1 : C1 0 の 範囲 を 指定 し て 、 【 図 - 1 】 ２ ） リボン の 「 ホーム 」 タブ の 「 条件 付き 書式 」 ボタン を クリック し て 、 ３ ） 「 新しい ルール 」 → 「 数式 を 使用 し て 、 書式 設定 する セル を 決定 する 」 の 「 次 の 数式 を 満たす 場合 に 値 を 書式 設定 」 に ４ ） = OR ( A1 = 1 , A1 = 3 ) と 入力 し て 、 右 下 の 「 書式 」 を クリック し て 、 【 図 - 2 】 ５ ） 「 表示 形式 」 → 「 ユーザー 定義 」 に し て 「 種類 」 に 、 '@' と 入力 し て 、 ＯＫ 【 図 - 3 】 
表 全体 ( 提示 の 表 で は 、 C3 ～ J いくつ でしょ う 、 まで ) を 選ん で 、 リボン の 条件 付き 書式 を 選び ます 。 新しい ルール を 開い て 「 ルール の 種類 を 選択 し て ください 」 の 一番 下 「 数式 を 使用 し て ～」 を 選び ます 。 「 ルール の 内容 を 編集 し て ください 」 「 次 の 数式 を 満たす 場合 に～ 」 に 以下 を 設定 し ます 。 その １ と その ２ は 別に 設定 し ます 。 その間 選択 セル は 動かし ませ ん 。 その １ = OR ($ F3 =" 土 ",$ F3 =" 日 ") 書式 を クリック し 、 塗りつぶし を 黄色 に し ます 。 その ２ =$ G3 ="◯" 書式 を クリック し 、 塗りつぶし を 黄色 に し ます 。 以上 を 設定 する と F 列 の 土日 、 G 列 の ◯ に 反応 し て 黄色く なり ます 。 なお 、 F 列 が 文字列 の 土日 で は なく 日付 シリアル を 表示 形式 で 土日 に し て い た 場合 は 別 の 数式 と なり ます 。 
セル Target の 列 は Target . column 表記 は ABC で なく 123 です 。 Select Case Target . column Case 4 Case 5 Case 6 
以下 の よう な 内容 でしょ う か 。 ユーザー フォーム 表示 用 （ 標準 モジュール ） ------- Sub ShowUF () Dim r As Long r = 2 With UserForm 1 . ComboBox 1 . AddItem Cells ( r , 1 ). Value Do While Cells ( r , 1 ). Value <> "" r = r + 1 If Cells ( r , 1 ). Value <> Cells ( r - 1 , 1 ). Value And _ Cells ( r , 1 ). Value <> "" Then _ . ComboBox 1 . AddItem Cells ( r , 1 ). Value Loop .S how 0 End With End Sub ------- UserForm 1 の コード ------- Private Sub ComboBox 1 _ Change () Dim fnd As Range , CP As String , r As Long ComboBox 2 . Clear Set fnd = Columns ( 1 ). Find ( ComboBox 1 . Value ) CP = fnd . Value r = fnd . Row Do While Cells ( r , 1 ). Value = CP ComboBox 2 . AddItem Cells ( r , 2 ) r = r + 1 Loop ComboBox 2 . ListIndex = 0 End Sub ------- 
以下 で どう なり ます か その シート モジュール に 記述 し て み ます Private Sub Worksheet _ Change ( ByVal Target As Range )     Dim rng As Range     Dim sS As String     Set Target = Inter sect ( Target , Range (" A3 : B 30 "))     If ( Target Is Nothing ) Then Exit Sub     Application . EnableEvents = False     For Each rng In Target . Rows        With rng . Offset (, 1 - rng . Column )           If ( WorksheetFunction . Count (. Resize (, 2 )) = 2 ) Then              sS = " × "              If ((. Range (" A1 ") = 1 ) And (. Range (" B 1 ") < 7 )) _                 Or ((. Range (" A1 ") = 2 ) And (. Range (" B 1 ") < 10 )) Then                 sS = "○"              End If              . Range (" C1 ") = sS           Else              . Range (" C1 "). ClearContents           End If        End With     Next     Application . EnableEvents = True End Sub 
出来る よう です ね http:// lglink . blog 81 . fc2 . com / blog - entry - 375 . html ? sp 
今日 の 日付 を 入力 する の で あれ ば Private Sub TextBox 1 _ DblClick ( ByVal Cancel As MSForms . ReturnBoolean ) TextBox 1 . Text = Format ( Date , " yyyy / mm / dd ") Cancel = True End Sub です 。 
まず 、 先頭 の 「 A 001 」 は 何 でしょ う か ？ シート の 名前 でしょ う か 。 それ で ある なら Worksheets (" A 001 "). Cells ( 2 , 32 ). Select と し ます 。 FormulaR 1 C1 に 関数 を 入れ て い ます が 、 FormulaR 1 C1 は R1 C1 参照 で 記述 し なけれ ば なり ませ ん 。 記述 さ れ て いる 関数 は A1 形式 な ので Formula に 関数 を 入れ ます 。 また 、 関数 式 です が 、 文字列 の 中 に " を 入れる 場合 は "" と ２つ 重ね て 書く 必要 が あり ます 。 したがって Active Cell . Formula = _ "= MID ( AC 8 , FIND (""@"", SUBSTITUTE ( AC 8 ,"","",""@"", 5 ))+ 1 , FIND (""@"", SUBSTITUTE ( AC 8 ,"","",""@"", 6 ))- FIND (""@"", SUBSTITUTE ( AC 8 ,"","",""@"", 5 ))- 1 )" の よう に 記述 し ます 。 関数 は ・ ・ 短く なら ない か な～ 
フォーム の イベント の 「 タイマー 時 」 で テーブル の 件数 を 確認 し 、 前回 と 変わっ て いれ ば 「 再 クエリ 」 する の は どうでしょう か ？ タイマー 間隔 を 短く すれ ば 、 近い 処理 に なり ます が 、 そう 神経質 な もの で なけれ ば 、 30 秒 ~ 1 分 ごと に 行っ て も 良い ます 。 
>○ は 、 入る けど 、 見出 し行 （ 1 列 ） まで ○ が 入っ て しまい For Each c In Worksheets (" sheet 1 "). Columns ( 85 ). SpecialCells ( xlCellTypeVisible ) と し た ば あい 、 可視 セル のみ 繰り返し ます が 、 オート フィルタ は 先頭 行 （ 見出 し行 ） が も 当然 可視 状態 な ので 、 見出し まで 「 ○ 」 が 入っ て しまい ます 。 回避 する 方法 として は ( 1 ) c の 行番号 が １ なら セット し ない If c . Row > 1 Then If c = "" Then Exit Sub End If Range (" a " & c . Row ) = "〇" End If ( 2 ) 処理 し た 後 で 、 Ａ 列 の 見出し を セット し なおす 処理 の 最後 に Cells ( 1 , 1 ). Value = " みだし " を 入れる > 次 の 、 「 2 」 で 「 ◎ 」 を 入力 が 、 動い て くれ ませ ん 。 Selection . AutoFilter Field := 85 , Criteria 1 :=" 2 " の 前 に Selection . AutoFilter を 入れ て ください 。 「 1 」 の フィルター を 解除 し て から やら ない と 、 「 １ 」 しか 表示 さ れ て い ない うえ に 「 ２ 」 の 行 を 処理 しよ う と し ます から 。 （ 「 １ 」 かつ 「 ２ 」 の 行 は ない です から ） ＞ 最後 に 、 フィルタ の 解除 。 最後 に Selection . AutoFilter を 入れ て 、 フィルター を 解除 し ます 。 
データ 範囲 の 自動 更新 なら こちら が 簡単 です よ 。 お 試し ください 。 Excel 2010 ： ピボットテーブル 【 データ 範囲 】 を 自動 更新 する に は http:// www . office - qa . com / Excel / ex 203 . htm 
Sub 一 例 です () Dim rng As Range With Worksheets (" シート ２ ") Set rng = . Cells ( 1 , Columns . Count ). End ( xlToLeft ) If rng . Value <> "" Then Set rng = rng . Offset (, 1 ) End If End With With Worksheets (" シート １ ") rng . Value = . Range (" A1 "). Value rng . Offset ( 2 ). Value = . Range (" A 2 "). Value rng . Offset ( 4 ). Value = . Range (" A3 "). Value . Range (" A1 : A3 "). ClearContents End With End Sub 
下記 の 要領 で コーティング し まし た 。 ▼ ダイアログ で フォルダ を 選択 ▼ 実行 用 の ファイル と 同じ 場所 に 、 集約 し た ファイル が 生成 さ れる 。 ※ 対象 シート の 条件 の 記載 が 無かっ た ので 仮 で A1 = 1 And B 1 ＝ 2 で 設定 し て い ます 。 実行 用 ファイル を 作成 し 、 標準 モジュール に 貼り 付け て 使っ て ください 。 Declare Function SHGetPathFromIDList Lib " shell 32 . dll " Alias " SHGetPathFromIDListA " _ ( ByVal pidl As Long , ByVal pszPath As String ) As Long Declare Function SHBrowseForFolder Lib " shell 32 . dll " Alias " SHBrowseForFolderA " _ ( lpBrowseInfo As BROWSEINFO ) As Long Declare Function GetDesktopWindow Lib " user 32 " () As Long Public Type BROWSEINFO hOwner As Long pidlRoot As Long pszDisplayName As String lpszTitle As String ulFlags As Long lpfn As Long lParam As Long iImage As Long End Type Function GetFolder ( Optional Msg ) As String Dim bInfo As BROWSEINFO Dim pPath As String Dim R As Long Dim X As Long Dim pos As Integer bInfo . pidlRoot = 0 & If Is Missing ( Msg ) Then bInfo . lpszTitle = " フォルダ の 選択 ..." Else bInfo . lpszTitle = Msg End If bInfo . ulFlags = & H1 X = SHBrowseForFolder ( bInfo ) pPath = Space $( 512 ) R = SHGetPathFromIDList ( ByVal X , ByVal pPath ) If R Then pos = InStr ( pPath , Chr $( 0 )) GetFolder = Left ( pPath , pos - 1 ) Else GetFolder = "" End If End Function Sub Sample () Dim lngAns As Long Dim FolName As String Dim FileName As String Dim Path As String Dim Flag As Boolean Dim Bo As Workbook Dim NewBo As Workbook Dim Sh As Worksheet FolName = GetFolder (" フォルダー を 選択 し て ください 。 ") If FolName = "" Then Exit Sub End If If Dir ( FolName & "\*. xls *") = "" Then MsgBox " 指定 し た フォルダー に Excel ファイル は 存在 し ませ ん 。 ", vbOKOnly + vbInformation Exit Sub End If lngAns = MsgBox (" 処理 し ます か ？", vbYesNo + vbQuestion ) If lngAns = vbNo Then Exit Sub End If Application .S creenUpdating = False FileName = Dir ( FolName & "\*. xls *") Flag = False Do While FileName <> "" Set Bo = Workbooks . Open ( FolName & "\" & FileName ) For Each Sh In Bo . Worksheets If Sh . Range (" A1 ") = 1 And Sh . Range (" B 1 ") = 2 Then ' 対象 シート の 条件 If Flag = False Then Sh . Copy Set NewBo = ActiveWorkbook Flag = True Else Sh . Copy After := NewBo . Worksheets ( NewBo . Worksheets . Count ) End If End If Next Application . DisplayAlerts = False Bo . Close SaveChanges := False Application . DisplayAlerts = True FileName = Dir () Loop Set Bo = Nothing Set Sh = Nothing If Flag = False Then MsgBox " 条件 を 満たし た シート は 、 存在 し ませ ん でし た 。 ", vbOKOnly + vbCritical Application .S creenUpdating = True Exit Sub End If Path = ThisWorkbook . Path If Dir ( Path & "\ 集約 . xlsx ") <> "" Then Application . DisplayAlerts = False Kill Path & "\ 集約 . xlsx " Application . DisplayAlerts = True End If Application . DisplayAlerts = False NewBo .S aveAs FileName := Path & "\ 集約 . xlsx " NewBo . Close Application . DisplayAlerts = True Set NewBo = Nothing Application .S creenUpdating = True MsgBox " 集約 し た Excel ファイル を 生成 し まし た 。 ", vbOKOnly + vbInformation End Sub 
計算 を し ない で 、 という の が 良く 分かり ませ ん が 。 要するに 、 円 の 範囲 の 文字 を クリア すれ ば 良い の でし たら 、 こんな 感じ です 。 元 の 処理 から 、 中心 位置 と 直径 を 指定 し て 下記 のようなもの を Call すれ ば いい か と 。 Private Sub 円 描画 ( ByVal 中心 row As Long , ByVal 中心 col As Long , ByVal 直径 As Long ) Dim r As Range For Each r In Range ( Range (" A1 "), Range (" A1 "). SpecialCells ( xlLastCell )) If (( r . Row - 中心 row ) ^ 2 + ( r . Column - 中心 col ) ^ 2 ) * 4 <= 直径 ^ 2 Then r . Value = "" Next End Sub 
残念 ながら 「 登録 ( 入力 ) 順 」 という テーブル の レコード 並び は 保障 さ れ て い ませ ん 。 （ 稼働 したて の 頃 は そう 見える かも しれ ませ ん ） テーブル に オート ナンバー の フィールド や フォーム ( VBA ) を 利用 し 自力 で 入力 順 に なる よう に ナンバリング 設計 し た フィールド を 設置 し ない と いけ ませ ん 。 
テスト は し て い ませ ん が 、 書か れ て いる こと を 忠実 に 行う と 以下 の よう な コード に なり ます 。 Dim m As Long Dim i As Long ' SHEETNAME の B 列 の 最終 行 を 求める m = Worksheets (" SHEETNAME "). Range (" B " & Rows . Count ). End ( xlUp ). Row ' 2 行 目 から 最終 行 まで 繰り返す For i = 2 To m ' TEMPLATE を 最後 に コピー Worksheets (" TEMPLATE "). Copy After := Worksheets ( Worksheets . Count ) With ActiveSheet ' シート 名 を SHEETNAME の A 列 の 値 に 変更 . Name = Worksheets (" SHEETNAME "). Range (" A " & i ). Value ' セル C1 に SHEETNAME の B 列 の 値 を セット . Range (" C1 "). Value = Worksheets (" SHEETNAME "). Range (" B " & i ). Value ' シート の 特定 セル を 値 コピー . Range (" D 5 : D1 5 "). Copy . Range (" D 5 "). PasteSpecial Paste := xlPasteValues . Range (" D1 8 : D2 8 "). Copy . Range (" D1 8 "). PasteSpecial Paste := xlPasteValues . Range (" D3 1 : D3 7 "). Copy . Range (" D3 1 "). PasteSpecial Paste := xlPasteValues . Range (" D40 : D4 3 "). Copy . Range (" D40 "). PasteSpecial Paste := xlPasteValues . Range (" D 58 : D1 06 "). Copy . Range (" D 58 "). PasteSpecial Paste := xlPasteValues Application . CutCopyMode = False End With Next 
こんにちは。 > マクロ で は なく 関数 で できる もの でしょ う か 。 管理番号 ごと の 品番 の 管理 を する の でしょ う から 、 キーワード を 追加 する 列 は 必要 です 。 データベース 関数 を 使っ て 、 管理 ごと の 品番 と 数量 の 計算 は でき ます が 、 それだけ の 項目 が ある の でし たら 、 シート で データベース を 構築 する の も 、 かなり 重労働 です 。 管理番号 が ロット な の か 、 伝票 番号 な の か 、 にも より ますが 、 先入れ 後 だし など 、 細かく 管理 する の でし たら 、 データ 1 行 に ユニーク な キー を 追加 し て 、 全体 を データベース 登録 する よう に し て 、 と 、 MS アクセス で 構築 し て みる 、 など です 。 
teraterm の データ と 言う の が 、 teraterm は なにか 決まっ た 形式 で データ を 出力 する わけ で は ない ので 意味 を 為し ませ ん 。 とりあえず 、 excel に 読み込ま せる テキスト形式 の ファイル という 点 で は " csv " について 調べ て みる と 何 か の 役に立つ かも 、 と は 思い ます 。 
問題 は 小数点 でしょ う ね 。 Excel で は 小数点 の 比較 など で は 誤差 が 生じる こと が あり ます 。 この よう な 場合 は Round 関数 など で 処理 を し て から 比較 する と 良い でしょ う ね 。 また 、 変数 宣言 は し て ください 。 Sub Test () Dim k As Double , s As Double k = Round ( Range (" C1 2 "), 2 ) s = Round ( Range (" E3 "), 2 ) If k >= s Then MsgBox " 問題 なし " Else MsgBox " 問題 あり " End If End Sub 
処理 が わかり ませ ん ので 、 最終 行 取得 部分 だけ です 。 rmax = Worksheets (" 個人 別 "). Cells ( Rows . Count , " D "). End ( xlUp ). Row With Worksheets (" 個人 別 "). Range (" D4 : D " & rmax ) rmax という 変数 を 使わ なく て も いい の です が 、 長く なる ので 一旦 変数 に 入れ まし た 。 
普通 に 上手く 実行 さ れ まし た ね 。 以下 の 条件 を 満たし て い て 、 うまく 実行 でき ない こと は ない はず 。 1 ） 特定 の ブック ” A ” の 特定 の シート ” AA ” を 、 アクティブ に し て おく ２ ） " C :\ temp \" に 「 . xls 」 を 持っ た Excel ブック を 格納 し て おく 。 これら の ブック が コピー 先 ステップ 実行 http:// hp . vector . co.jp / authors / VA 016119 / step / step 01 . html あたり を 使用 し て 実行 状況 を 観察 し て みる の が 、 最初 に やる こと でしょ う ね 。 ちなみに 、 「 複数 の ブック B ~ Z の 一番 左側に コピー し たい の です 。 」 の 要件 は 満たし て い ない プログラム です 。 右端 に コピー さ れ ます 。 
# include < stdio . h > という の は スタンダードヘッダーファイル の こと です 。 標準出力 の printf が 使える の この ヘッダーファイル の お陰 です 。 > can not open source file stdio . h は この スタンダードヘッダーファイル が 開け ない という こと > identifier printf is undefined という の は printf という の は みつから ない と いっ て い ます 。 ヘッダーファイル が ない から 当たり前 です 。 > Cannot open include file stdio . h no such file or director y その stdio . h という file を インクルード でき ない 。 そんな ファイル と ディレクト は 無い よ っていう エラー が 出 て い ます 。 まあ 結論 から 言う と C コンパイラー の パス を 設定 し て い ない んで コンパイル でき ない ん です 。 visual studio の メニュー から Project -> Properties -> Configuraton Properties -> VC++ Diretories -> Library Director ies パス の 追加 C :\ Program Files ( x86 )\ Windows Kits \ 10 \ Lib \ 10 . 0 . 10150 . 0 \ ucrt \ あなた の 環境 を 選ぶ そして また メニュー から C/C++ -> General -> Additional include director ies に パス を 追加 し て ください C :\ Program Files ( x86 )\ Windows Kits \ 10 \ Include \ 10 . 0 . 10150 . 0 \ ucrt 
なんか 凝っ た 作り です ね 。 単純 に 、 対象 セル の 中 で 改行 を 入れる の で は なく 、 規定 文字数 ごと に 対象 セル の 下 に 分割 し て 入れる の です ね 。 気 に なる ところ も 含め て 、 私 流 に 直す と こんな 感じ に なり ます Const RanVal As String = " A1 " ' セル の 個所 を 設定 Const MaxSt As Long = 44 ' 切り分ける 文字数 を 設定 Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim StVal As String Dim i As Integer ' 対象 の セル が 変更 さ れ た 範囲 に 含ま れ て いる か If Not Inter sect ( Range ( RanVal ), Target ) Is Nothing Then ' イベント の 無効化 Application . EnableEvents = False ' 文字列 を 変数 StVal に セット StVal = Range ( RanVal ). Value i = 0 ' 変数 StVal が 空白 に なる まで 繰り返し Do Until StVal = "" ' 対象 セル から 順に 対象 文字数 分 を セット Range ( RanVal ). Offset ( i , 0 ). Value = Left ( StVal , MaxSt ) i = i + 1 ' 対象 文字数 分 を 先頭 から 削る StVal = Mid ( StVal , MaxSt + 1 ) Loop ' イベント の 有効 化 Application . EnableEvents = True End If End Sub 
False を True に 変え て 実行 する だけ じゃ ない の ？ http:// hensa 40 . cutegirl .jp / archives / 1253 
まず 、 貴方 が 作成 し た マクロ を 提示 し て ください 。 そう で ない と 正確 な 回答 が 出来 ない 恐れ が あり ます 。 ちなみに ブレークポイント を 使っ た デバッグ は 試し て み まし た か ？ ブレークポイント ： プログラム の 動作 を 指定 し た行 で 一旦 停止 する 機能 使い方 ： 停止 さ せ たい 行 に カーソル が ある 状態 で 「 F 9 」 キー を 押す （ その 行 が 反転 し ます ） 
「 どこ に 」 という 指定 が ない ので 、 S 列 に 設定 する と 仮定 し て い ます 。 Sub avg () Dim maxRow As Long Dim start As Long Dim last As Long Dim i As Integer Dim avg As Double ' 最終 行 を 取得 maxRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' 変数 定義 start = 1 last = 1 ' 最終 行 まで 処理 For i = 1 To maxRow ' 諸元 名 が 一緒 の 場合 、 加算 処理 If Range (" B " & i ). Value = Range (" B " & i + 1 ). Value Then last = last + 1 Else ' 平均 を 計算 avg = WorksheetFunction . Average ( Range (" X " & start & ": X " & last )) Range (" S " & i ). Value = avg ' 開始 位置 を 更新 start = i + 1 ' 最終 位置 を 更新 last = last + 1 End If Next i End Sub 
フル パス 指定 し ない と 認識 し ない 、 もしくは ファイル 名 が 間違っ て い ます 。 分析 ツール - VBA の パス を 見る と atpvbaen . xlam と 見える の です が 、 対象 は これ です か ？ 
Do While Cells ( i , 2 ). Value <>"" ↓ Do While Cells ( i , 2 ). Text <> "" 
環境 の 再インストール か なぁ 。 ちょっと ググっ て 駄目 なら 、 自分 の 場合 は そう し ます 。 
Sub Macro 1 () Dim GYOU As Long '← ここ に GYOU 変数 を 定義 Workbook . Open Filename :=” C :¥ 共有 ¥ マクロ . xlsx ” ～ 
( 1 ) 構文 の 間違い Workbook . Open Filename :=” C :¥ 共有 ¥ マクロ . xlsm ” ↓ Workbooks . Open Filename :=" C :¥ 共有 ¥ マクロ . xlsm " ( 2 ) 転送 先 の マクロ . xlsm に は シート が １つ しか ない の でしょ う か 。 ブック を Open し た 直後 に Activesheet . Unprotect し て い ます が 、 大丈夫 でしょ う か 。 念 の ため Sheets (" 様式 "). Select として から Unprotect する か 、 Sheets (" 様式 "). Unprotect と し た ほう が 良い でしょ う 。 ( 3 ) 貼り 付け を ２ 回 行っ て いる 。 Selection . PasteSpecial Paste := xlPasteValues , Operation := xlNone , SkipBlanks _ := False , Transpose := True で 貼り 付け た 後 、 さらに ActiveSheet . Paste し て い ます 。 後 の ほう の ActiveSheet . Paste により 、 B 列 から Y 列 まで に 行方 向 （ 縦方向 ） に 24 行 の データ が 貼り 付け られ て しまい ます 。 後 の ほう の ActiveSheet . Paste は 不要 です 。 ( 4 ) 転送 先 の ブック を 保存 し て 閉じる 場合 に ActiveWorkbook .S ave ActiveWindow . Close と し て い ます が 、 保存 は ActiveWorkbook に対して 、 閉じる の は ActiveWindow も 間違い で は ない です が 、 どうせ なら 保存 し て 閉じる ので ActiveWorkbook . Close SaveChanges := True として は どうでしょう か 。 ( 5 ) 最後 の Application . CutCopyMode = False は 意味 が ない ので 不要 です 。 とりあえず 動作 さ せる に は ( 1 ) と ( 3 ) を 修正 すれ ば 動作 する と 思い ます 。 全体 を 見直し て 、 整理 し た サンプル コード （ Macro 1 のみ ） を 載せ て おき ます ので 、 参考 に し て ください 。 Sub Macro 1 () ' 転送 先 ブック を 開く Workbooks . Open Filename :=" C :\ 共有 \ マクロ . xlsm " ' 様式 シート に対して 処理 With Sheets (" 様式 ") ' シート の 選択 .S elect ' シート の 保護 を 解除 . Unprotect ' 自 ブック の ActiveSheet の セル C4 : C 27 を コピー ThisWorkbook . ActiveSheet . Range (" C4 : C 27 "). Copy ' B 列 最終 行 の 下 セル に 、 行列 を 入れ替え て 貼り 付け . Range (" B 65536 "). End ( xlUp ). Offset ( 1 ). PasteSpecial Paste := xlPasteValues , Operation := xlNone , SkipBlanks _ := False , Transpose := True Application . CutCopyMode = False ' シート の 保護 . Protect DrawingObjects := True , Contents := True , Scenarios := True End With ' 転送 先 ブック を 保存 し て 閉じる ActiveWorkbook . Close SaveChanges := True End Sub 
以下 で どう なり ます か Macro 1 と Samp 1 を 置き換え ます Public Sub Samp 1 ()     Dim vA As Variant , v As Variant     Dim i As Long , j As Long     Const CFILE As String = " C :¥ 共有 ¥ マクロ . xlsx "     Const CSHTNM As String = " 様式 1 , 様式 2 "     With ActiveSheet        With . Range (" C4 ", . Cells ( Rows . Count , " C "). End ( xlUp ))           If (. Cells ( 1 ). Row < 4 ) Then Exit Sub           j = . Rows . Count           If ( j > 24 ) Then              j = 24           ElseIf ( j < 20 ) Then              j = 20           End If           With . Resize ( j )              vA = WorksheetFunction . Transpose (. Cells )              . ClearContents           End With        End With     End With     Application .S creenUpdating = False     With Workbooks . Open ( CFILE )        For Each v In Split ( CSHTNM , ",")           With . Worksheets ( v )              i = . Cells ( Rows . Count , " B "). End ( xlUp ). Offset ( 1 ). Row              If ( i < 9 ) Then i = 9              . Unprotect              . Cells ( i , " B "). Resize (, j ). Value = vA              . Protect , True , True , True           End With        Next        . Close True     End With     Application .S creenUpdating = True End Sub 
基本 どおり 、 find を 使っ て み た 一 例 です 。 やり方 は いろいろ ある と 思い ます 。 dim obj as object dim Gyo as long dim Retsu as long set obj = range (" B 6 : B 10 "). find ( what := range (" B 3 "). value , lookat := xlwhole ) if obj is nothing then msgbox (" 該当 する No は 見つかり ませ ん 。 ") exit sub else Gyo = obj . row end if set obj = range (" B " & Gyo & ": D " & Gyo ). find ( what := range (" C3 "). value , lookat := xlwhole ) if obj is nothing then msgbox (" 該当 する 品名 は 見つかり ませ ん 。 ") exit sub else Retsu = obj . column end if cells ( Gyo , Retsu ). select 
基本 どおり 、 find を 使っ て み た 一 例 です 。 やり方 は いろいろ ある と 思い ます 。 dim obj as object dim Gyo as long dim Retsu as long set obj = range (" B 6 : B 10 "). find ( what := range (" B 3 "). value , lookat := xlwhole ) if obj is nothing then msgbox (" 該当 する No は 見つかり ませ ん 。 ") exit sub else Gyo = obj . row end if set obj = range (" B " & Gyo & ": D " & Gyo ). find ( what := range (" C3 "). value , lookat := xlwhole ) if obj is nothing then msgbox (" 該当 する 品名 は 見つかり ませ ん 。 ") exit sub else Retsu = obj . column end if cells ( Gyo , Retsu ). select 
sub tes は Sub test () でしょ う か 。 変数 s は 、 そのままで は ユーザー フォーム から 値 を 入れる こと は でき ませ ん 。 コード が 標準 モジュール 内 で あれ ば 、 Sub test () より 前 （ 他 の コード が ある 場合 は 、 それら の 前 ） に Public s as String と 記述 し ます 。 それで 、 ユーザー フォーム から も 変数 s が 使用 でき ます ので 、 ユーザー フォーム の コマンド ボタン を 押し た とき に s = " ボタン 名 " と する こと で 変数 s に ボタン の 名前 が 入り ます 。 
以下 の 変更 を 試し て み て ください 。 Set R = R . End ( xlDown ). Offset ( 1 ) ↓ Set R = Ws 1 . Cells ( Rows . Count , 1 ). End ( xlUp ). Offset ( 1 ) 
DAO で の 文字 の ワイルドカード は *、 ADO は % 例えば 端末 番号 LIKE '*" & Me . imp _ 端末 & "*'" ↓ 端末 番号 LIKE '%" & Me . imp _ 端末 & "%'" に 変更 が 必要 です 余談 ） SQL 作成 部分 は元 に 戻し た の です ね 
二 重 繰り返し に する 必要 は ない です 。 また 範囲 で コピー し た 方 が ステップ が 少なく て すみ ます 。 Sub Sample () Dim i As Integer , t As Integer t = 2 For i = 3 To 19 Step 4 Worksheets (" 1月 "). Range (" D " & i & ": I " & i ). Copy Destination := Worksheets (" 基本 "). Cells ( 3 , t ) t = t + 6 Next End Sub 
こんにちは。 示し て いる コード は 、 ファイル の 一覧 表 を 作成 する もの です 。 主 様 が し たい の は 、 ファイル の 中 に ある の か 、 ファイル の 名前 で 処理 する か 、 で 、 対応 が だいぶ かわり ます 。 メール の 場合 、 メール が メーラー に ある 場合 と 、 フォルダ に ある 場合 で 、 扱い が かわり ます 。 メール 本文 に 、 処理 し たい 文字列 が ある の でし たら 、 環境 により 必要 な 処理 と なり ます 。 結果 、 流用 の レベル で は 、 ありません 。 
こんにちは。 Sub main () For a = 1 To 20 Shell " C :\ Program Files \ Internet Explorer \ IEXPLORE . EXE http:// www . yahoo . co.jp /" Next End Sub です 。 修正 箇所 は 、 正しい url と 、 最後 の 記号 は 、 全角 の ダブルクォーツ から 半角 の ダブル クォーツ に 修正 し まし た URL の スラッシュ の 隣 です 。 それから 、 shell は 、 一行 です 。 よく 似 て い ます が 、 コンピュータ は 一文字 でも 駄目 なら 、 エラー に なる よう に なっ て い ます 。 
惜しい です ね 。 一見 正し そう に 、 見える の です が 、 FormNemuBox 、 ListBNemuBox は . Text または . Value を 付け て やる 必要 が あり ます 。 MsgBox UserForms . Add ( FormNemuBox . Text ). Controls ( ListBNemuBox . Text ). ListCount 
ヘッダ の フォント を 指定 する 場合 、 ヘッダ の 文字列 の 前 に 「 &" フォント 名 "」 を 入れ ます 。 実際 に は 、 ダブル クォーテーション （"） を 文字列 の 中 に 入れる ので 、 . CenterHeader = "&"" ＭＳ Ｐ 明朝 """ & Join ( Application . Transpose ( Sheets (" 管理 表 "). Range (" H 7 : H9 "). Value ), vbLf ) の よう に "" と ２つ 続け て 記述 し ます 。 
アクティブ な セル の 値 を 直接 クリップボード へ 取り込む コーディング 例 です 。 Sub 一 例 です () Dim xClip Set xClip = CreateObject (" new :{ 1 C3 B4 210 - F4 41 - 11 CE - B 9 EA - 00 AA 006 B 1 A6 9 }") With xClip .S etText Active Cell . Value . PutInClipboard End With End Sub 
VLOOKUP 関数 です ね ・ ・ ・ http:// www . tipsfound . com / excel / 04 vlookup 2 理解 できれ ば 、 エラー 回避 や IF 関数 を 絡める と 結構 使い やすく でき ます 。 
どの よう に 上手く 繋がら ない の か 、 もっと 具体 的 に 記述 し て ください 。 書い た コード も 示し て い ない の で は 回答 しよ う が ありません 。 
基本的 に 、 人 の 手 で 操作 できる こと は 可能 です から 、 作成 できる 範囲 です 。 ただ 、 一足飛び に 全て を 作ろ う と する と 、 慣れ て い ない 人 ほど ごちゃごちゃ に なっ て しまい 、 収拾 が つか なく なり ます 。 1つ ずつ 、 階段 を 上る よう に 、 試し ながら 作っ て いく と 良い でしょ う 。 これ が 出来 たら 次 は これ 、 分から なく なっ たら 調べる ・ 質問 する 、 という 風 に 進め て み て は いかが でしょ う か 。 マクロ は プログラム の 一 種 です から 、 手順 が 重要 です 。 手順 を 作る に は 要素 分解 は 必要 に なり ます 。 要素 分解 が でき て いれ ば 、 分から ない 部分 も はっきり する でしょ う から 、 質問 もし 易い こと と 思い ます 。 
以下 で どう なり ます か Public Sub Samp 1 ()     Dim i As Long     Const CROWH As Long = 1440     Application .S creenUpdating = False     For i = 2 To 100        Cells (( i - 1 ) * CROWH + 1 , " A "). Resize ( CROWH ). Cut Cells ( 1 , i )     Next     Application .S creenUpdating = True End Sub 
比較 の ところ で 、 isnull を 追加 し て み て は いかが でしょ う 。 instr ( isnull ( textbox ？. value ,""), ssm ) テキストボックス 値 が ヌル の 場合 、 instr は 何 を 返す の か は 、 ヘルプ 参照 の 事 。 
「 IsNull ( TextBox 2 . Value , "")」 は 間違い で 「 IIf ( IsNull ( TextBox 2 . Value ), "", IsNull ( TextBox 2 . Value )」 と す べき です 。 Access の VBA なら 「 Nz ( TextBox 2 . Value , "")」 と Nz 関数 を 使用 する こと も でき ます 。 
同じ よう な 質問 を いくつ も さ れ て い ます が 、 どれ に 回答 すれ ば 良い か わかり ませ ん よ 改行 が ある こと が 問題 なら ば 、 Replace 関数 で 改行 を 削っ て は どうでしょう か 。 改行 の コード を 表す 定数 に vbCrLf 、 vbLf 、 vbCr の 3つ が あり ます 。 この うち vbCrLf は vbLf ＋ vbCr です ので 、 vbLf 、 vbCr を "" に 置き換え ます 。 また 、 ３つ の TextBox で 置き換える ので 、 それ だけ を 別 関数 に し ます 。 （ サンプル ） Dim ssm As String ssm = " 通常 " If InStr ( 改行 を 削る ( TextBox 2 . Value ), ssm ) = 0 And _ InStr ( 改行 を 削る ( TextBox 3 . Value ), ssm ) = 0 And _ InStr ( 改行 を 削る ( TextBox 4 . Value ), ssm ) = 0 Then If TextBox 1 = "" Then TextBox 1 = ssm Else TextBox 1 = TextBox 1 & vbCrLf & ssm End If End If Private Function 改行 を 削る ( st As String ) As String 改行 を 削る = Replace ( Replace ( st , vbLf , ""), vbCr , "") End Function 
私 は 放送大学 の 学生 な ので アカデミック パック を 購入 し て い ます 。 もちろん 、 PC の ハード や ソフト は 確定申告 の 時 に 必要経費 として 計上 し て い ます よ 。 
ファイル を 相対パス で は 開く こと が でき ませ ん 。 カレント パス から の 相対 参照 なら ば Set pst = ppt . Presentations . Open ( CurDir & "\ × × \ ファイル 名 . pptx ") と する しか あり ませ ん 。 マクロ の ある ブック から の 相対 参照 なら ば ThisWorkbook . Path アクティブ な ブック から の 相対 参照 なら ば ActiveWorkbook . Path を 使い ます 
構成 マネージャー の 設定 を 変更 すれ ば 可能 です 。 一 例 を 示す と 、 Visual Studio の ビルドメニュー → 構成 マネージャー を 表示 し ます 。 構成 マネージャー の アクティブ ソリューション 構成 を インストーラ が ビルド さ れる 構成 ( 例えば Release ) に 変更 し ます 。 すると 質問者 さん の 場合 だ と 、 Setup プロジェクト と 実行ファイル の プロジェクト とも に 「 ビルド 」 チェック が ON に なっ て いる と 思い ます 。 実行ファイル の 「 ビルド 」 チェック を OFF に し て Setup だけ ビルド すれ ば 以前 に ビルド し た 実行ファイル の タイムスタンプ と 同じ に なる と 思い ます 。 上記 の よう に 、 Setup プロジェクト を ビルド する 時点 で は 、 アプリケーション の 実行ファイル は ビルド し ない よう に 設定 すれ ば OK です 。 アプリケーション を Release ビルド し た 時点 で の タイムスタンプ と 同一 に する に は 、 プロジェクト の プロパティ で 、 ビルド 出力 パス を Setup プロジェクト の 出力 先 に 変更 する か 、 ビルド イベント で ビルド 後 に 出力 を コピー する よう に コマンド を 実行 すれ ば よい と 思い ます 。 
こんにちは。 スプライト 機能 は 、 VBA の 場合 、 絵 の 情報 を 設定 し て いる 「 コントロール 」 と 、 その コントロール の left と top による 、 表示 位置 の こと です よ 。 その 当時 、 「 表示 の 部品 を 動かす 」 という こと は 、 「 移動 先 の VRAM 情報 と or を し た 画面 情報 を 計算 、 上書き 。 残像 の 部分 の 消去 」 を する 必要 が あり まし た が 、 windows の VBA の 場合 は 、 「 コントロール に 表示 さ せ たい キャラクタ 」 を 設定 し て 、 コントロール の 座標 情報 を 直接 操作 し ます 。 つまり 、 昔 の スプライト の よう な こと を 、 今 し て い ます 。 ドット絵 という レベル でし たら 、 MS ペイント で 作成 し て 、 その ピクチャー を 貼り 付け た 「 四角 」 の コントロール を 移動 さ せる こと を 考え て ください 
どう 「 うまく いか ない 」 の です か ？ どう 動け ば 正解 な ん です か ？ 
DSum ( Worksheets (" 入力 "). Range (" S3 : W50 0 "), Sheet 1 . Range (" V3 "), Worksheets ("① 全体 実績 "). Range (" R3 : S 4 ")) 次 の 2つ の 条件 を 満たし て いる なら 、 エラー は 起き ない と 思い ます 。 １ ） 2つ 目 の パラメータ 、 Sheet 1 . Range (" V3 ") の シート 指定 、 Sheet 1 が 「 入力 」 シート の コード 名 （ CodeName ) で ある こと 。 MsgBox Worksheets (" 入力 ). CodeName で 確認 できる 筈 。 ２ ） 「① 全体 実績 」 の R3 ： R 4 の 値 は 、 「 入力 」 シート の S3 ： W3 の 中 の いずれ か の 値 で ある こと 。 
こんにちは。 If TextBox 1 = "" Then TextBox 1 = ssm Else TextBox 1 = TextBox 1 & vbCrLf & ssm End If は If instr ( TextBox 1 . value , ssm ) = 0 Then if TextBox 1 . value = "" then TextBox 1 . value = ssm Else TextBox 1 = TextBox 1 & vbCrLf & ssm End If end if あと 、 コード は 、 2 から 4 の 3つ の コントロール すべて 、 「 ない 状態 」 で 発動 です 。 つまり 、 どれ か 、 ひとつ でも 「 文字 」 が 存在 し たら 、 設定 はしません 。 説明 で は 、 そんなに 厳密 な 説明 で ない ので 、 確認 です 
Windows Update が 残っ てる かも 
activeworkbook . path と 書け ば 同じ フォルダ 内 の ブック の 参照 に 必要 な アドレス が 取れる でしょ う 。 同じ フォルダ 内 の エクセル ファイル を 参照 する なら http:// office tanaka .net / excel / vb a/t ips / tips 69 . htm から Sub Sample 2 () Dim buf As String , msg As String buf = Dir ( activeworkbook . path & "\*. xls ") Do While buf <> "" ' 見つけ た xls 系 ブック へ の 処理 buf = Dir () Loop End Sub こちら の よう な 処理 とか 。 他 こちら の サイト に は 有用 な 情報 が たくさん あり ます 。 やり たい こと を 整理 する なら 、 ある ブック で B シート を すべて 値 に 変換 ( range (" A1 : X1 00 "). value = range (" A1 : X1 00 "). value の よう な 値 転記 )、 A シート を 削除 、 B シート の 名前 を ブック 名 と 同じ に （ 質問 文 に は ” ブック 名 を シート 名 ” と し て ます が 、 B シート の 名前 を ブック 名 に 、 の 間違い な の か な 、 と 。 ） その シート は 例えば VBA を 実行 し て いる ファイル に 移動 。 元 の ファイル は 保存 せ ず 閉じる 。 次 ファイル へ ＞ ＞ buf = Dir () 調べれ ば 出て き そう な お話 ばかり です ね 。 
日報 フォーム が 開か れ て い ない ため に 得意 先 コード が 取得 でき ない の が 原因 だ と 思い ます 。 たいてい の エラー は メッセージ 内 に 解決 の ヒント が あり ます 。 今回 の 場合 、 「 クエリ 式 '([ 得意 先 コード ]=) And ([ 商品 コード ]= S1 )' の 不要 な ')' が あり ます 。 」 の うち ([ 得意 先 コード ]=) が ネック です 。 = と ) の 間 に 値 が ない ため に 、 「 変 な ところ に ) が あり ます よ 」 と いっ て いる わけ です 。 ここ に 値 を 入れ て あげれ ば 解決 な の です が 、 入れ たい 値 は フォーム から の 参照 値 な ので 、 参照 できる よう に し ましょ う 、 という 回答 に なり ます 。 
定型 入力 は 「 コード ・ スニペット 」 を 使い ます 。 製品 版 だ と 「 マクロ 」 も 有り ます が 、 使っ た こと は 無い です ねぇ 。 https :// msdn . microsoft . com / ja - jp / library / 8 h3 1 zbch % 28 v = vs . 90 % 29 . aspx 
コンボボックス の 内容 を 変更 、 あるいは クリア ボタン で コンボボックス を クリア し た 時 に ComboBox 1 _ Change が 処理 さ れ 、 該当 する 値 が 無い ので エラー に なる の で は ない です か 。 テクスト ボックス に 値 を 入れる 前 に 、 コンボボックス が 有効 な 行 に なっ て いる か 判断 すれ ば 大丈夫 そう です 。 Private Sub ComboBox 1 _ Change () With Me ! ComboBox 1 If . ListIndex >= 0 Then Me ! TextBox 1 = . Column ( 1 ) End If End With End Sub と 、 こんな 感じ です 。 ※ ComboBox 1 . ListIndex は 選択 さ れ た コンボボックス 内 の 行番号 で 、 選択 さ れ て い ない 場合 （ 無効 な 値 の 場合 も ）- 1 が 入り ます 。 
ファンクション の F5 → セル 選択 → 空白 セル に チェック → OK これ で 空白 セル のみ 選択 さ れ て いる ので そのまま 右クリック → 削除 → 左 方向 に シフト 選択 → OK 
相変わらず 、 何 を どう し たい の か わかり ませ ん 。 プログラム も 数学 と 同じ で 、 積み重ね が 必要 です 。 わから ない ところ が 出 て き たら 、 入門書 に 戻っ て 、 ちゃんと 理解 し た から 、 先 に 進む よう に し ない と 、 同じ 事 の 繰り返し に なり ます 。 また 、 なれ ない うち は 、 仕様 を きちんと 紙 に かい て 、 整理 し て 見 て ください 。 ただ 、 闇雲 に プログラム を 書い て も うまく 行き ませ ん 。 理解 、 整理 でき て い ない ので 、 いろいろ な 事 が 不足 し て い ます 。 スレッド 、 デリゲート 、 IPアドレス 、 ポート 、 サーバー の 意味 、 クライアント の 意味 など 整理 し て み て ください 。 それ が 、 わかれ ば 応用 は きく と 思い ます 。 サーバー 側 の サンプル http:// xfs .jp / Bmtwq 8 
大学 、 専門 で ゲームプログラミング 講師 経験 者 です 。 確か 、 「 GameLib _ d.l ib 」 自体 、 標準 の ライブラリ で は 無い はず です 。 多分 、 添付 CD から HD に インストール （ コピー ） し ない と 使用 出来 ない と 、 考え られ ます 。 
Asp か php みたい な もの で の 実装 は どう です か 
簡単 な の は 、 対象 ファイル を 開い て 、 ペースト 先 に 指定 する 方法 です 。 Set wb = Workbooks . Open (" パス \ 保管 場所 . xls ") Set Sh 2 = wb . Worksheets (" シート 名 ") wb は Workbook オブジェクト です ので 、 最後 に 保存 なり 、 閉じる なり の 操作 を すれ ば 良い と 思い ます 。 
http:// office tanaka .net / excel / vba / file / file 09 . htm Save メソッド で は なく 、 SaveAs メソッド を 使っ て い ませ ん か ？ どの よう な コード を 書い て いる か 補足 し て もらえる と 回答 する 人が し やすい と 思い ます 。 
> 試そ う と し た の です が 、 よく 分かり ませ ん 。 ↓ を 参考 に し て http:// office tanaka .net / excel / vb a/t ips / tips 37 . htm InputBox 関数 を 使用 x = InputBox (" セル の アドレス を 入力 し て ください ") For Each Sh In Worksheets Sh . Range ( x ). Value = Sh . Name Next InputBox メソッド を 使用 Set MyRange = Application . InputBox ( Prompt :=" セル を 選択 し て ください 。 ", Type := 8 ) x = MyRange . Address ( False , False ) For Each Sh In Worksheets Sh . Range ( x ). Value = Sh . Name Next キャンセル ボタン 押さ れ た 時 や 、 InputBox 関数 の 場合 に 無効 な 値 ( セル アドレス 以外 ) を 入力 さ れ た 場合 は どの 様に する の か ？ 処理 を 継続 する 必要 が ある なら とりあえず A1 セル を 入力 対象 に する 有効 な 値 が 入力 さ れる まで ループ する 等 が 考え られる が ・ ・ ・ ・ 
マトリックス の 考え方 を 用い て 作成 し まし た 。 ①： 元 データ で ２ ０ ０ 行 まで 対応 と し まし た 。 ②： 元 データ で １ グループ につき 最大 Ｄ 列 （ ４ 列 ） まで と し まし た 。 ③： 元 データ で 最大 ４ 列 × １ ０ ０ グループ 対応 と し まし た 。 ④： 全 ５ シート で 作成 し まし た 。 回答 です 。 ＜ Sheet 1 ＞ シート ご 質問 の レイアウト の データ です 。 ＜ 作業 １ ＞ シート ◇ 数式 （ ここ から コピー し て 貼り 付け て 下さい 。 ） ★ A 2 := IF ( Sheet 1 ! A 2 ="","", IF ( Sheet 1 ! A 2 =" A ", 1 , 0 )) ★ B2 := IF ( Sheet 1 ! B2 ="","", IF ( Sheet 1 ! B2 =" A ", 1 , 0 )+ A 2 ) ★ A3 := IFERROR ( MATCH ( COLUMN ( A1 ), 2 : 2 , 0 ),"") ★ A 4 := IF ( A3 ="","", IF ( B 3 ="", COUNT ( 2 : 2 )- A3 + 1 , B 3 - A3 )) 各 １ ０ ０ 列 目 （ CV 列 ） まで ドラグコピー 。 ★ A6 := IFERROR ( IF ( 作業 ２ !$ B2 > A $4 ,"", IF ( OFFSET ( INDIRECT (" Sheet 1 !"& ADDRESS ( 2 , 1 + A $3 - 1 )), 作業 ２ !$ A 2 , 作業 ２ !$ B2 - 1 )= 0 ,"", OFFSET ( INDIRECT (" Sheet 1 !"& ADDRESS ( 2 , 1 + A $3 - 1 )), 作業 ２ !$ A 2 , 作業 ２ !$ B2 - 1 ))),"") 下方 へ は ８ ０ ５ 行 目 まで ドラグコピー 。 右 方 へ は １ ０ ０ 列 目 （ CV 列 ） まで ドラグコピー 。 ＜ 作業 ２ ＞ シート ◇ 数式 （ ここ から コピー し て 貼り 付け て 下さい 。 ） ★ A 2 := MOD (( ROW ()- 2 ), 200 )+ 1 ★ B2 := IF ( A 2 = 1 , 1 , 0 )+ B 1 各 ８ ０ １ 行 目 まで ドラグコピー 。 ＜ 作業 ３ ＞ シート ◇ 数式 （ ここ から コピー し て 貼り 付け て 下さい 。 ） ★ A6 := IF ( 作業 １ ! A6 <>"", 1 , 0 )+ A5 下方 へ は ８ ０ ５ 行 目 まで ドラグコピー 。 右 方 へ は １ ０ ０ 列 目 （ CV 列 ） まで ドラグコピー 。 ＜ Sheet 2 ＞ シート ・ ・ ・ 回答 シート です 。 ★ A3 := IFERROR ( INDEX ( 作業 １ ! A : A , MATCH ( ROW ( A1 ), 作業 ３ ! A : A , 0 ), 1 ),"") 下方 へ は ８ ０ ２ 行 目 まで ドラグコピー 。 右 方 へ は １ ０ ０ 列 目 （ CV 列 ） まで ドラグコピー 。 ★ A 2 := IF ( A3 ="","", CHAR ( 64 + COLUMN ())&" 1 ") 右 方 へ １ ０ ０ 列 目 （ CV 列 ） まで ドラグコピー 。 ※ 作成 し た ブック を 提供 し ます 。 下記 URL から ダウンロード でき ます 。 場所 ： ヤフーボックス ファイル 名 ： 並び 替え URL ： http:// yahoo .jp / box / ZHd 9 YK 2 . 9 M あり ます 。 
② も 動き ます 。 しかし ① は 少々 癖 の ある 変数 の 使い方 を し て いる ため 、 それ を 知ら ず に ① を 修正 し て ② に し て しまっ た 可能性 が あり ます 。 ① と ② で FoundCell の 型 宣言 は 何 に し て ます か ？① は 型 宣言 省略 あるいは Variant の 筈 です 。 型 宣言 を 省略 し た 場合 も Variant に なり ます 。 ② あなた は Range で 宣言 し て ませ ん か ？ 本来 は あなた の 使い方 に す べき です 。 Variant は 何 でも ＯＫ の 型 で 、 セル だろ う が 文字列 だろ う が 何 でも 入り ます 。 Set FoundCell = Range (" AO 3 : CJ 3 "). Find ( What := Range (" J3 "), LookIn := xlValues , LookAt := xlWhole , SearchOrder := xlByRows ) ここ で FoundCell に は セル が 入っ て ます 。 しかし 下 の 方 で FoundCell = Active Cell . Address 現在 アクティブ に なっ て いる セル の アドレス 、 つまり " A1 " 等 の 文字列 が 代入 さ れ て ます 。 Variant に は 何でも 入る 特性 を 使っ て いわゆる 「 変数 の 使い 回し 」 を し て ます 。 ② の 型 宣言 を Range に し て いる 場合 、 ここ で エラー に なり ます 。 修正 後 Sub macro 1 () Dim MaxRow As Long Dim FoundCell As Range Dim FoundAdrs As String MaxRow = 20 ' 記載 ない ため 勝手 に 決め まし た 。 FoundAdrs ="" Set FoundCell = Range (" AO 3 : CJ 3 "). Find ( What := Range (" J3 "), LookIn := xlValues , _ LookAt := xlWhole , SearchOrder := xlByRows ) If FoundCell Is Nothing Then MsgBox " 検索 に 失敗 し まし た " Else FoundCell .S elect Debug . Print FoundCell . Row ; FoundCell . Address End If Range (" J5 : M " & MaxRow ). Copy FoundAdrs = Active Cell . Address On Error Resume Next Range ( FoundAdrs ). Offset ( 2 , 0 ). PasteSpecial Paste := xlPasteValues Range (" J3 "). Copy Range ( FoundAdrs ). PasteSpecial Application . CutCopyMode = False Set FoundCell = Nothing End Sub この マクロ 、 Find で 見つから なかっ た 場合 は 、 どこ に ある の か も わから ない アクティブ セル が 代入 さ れ ます が 、 それ で いい の ？ 前後 の 記載 が 無い から 分り ませ ん が 。 
【 式 1 】 B 1 = A1 & REPT ("※", COUNTIF ( A1 ,"* 市場 *")) 【 式 2 】 C1 = SUBSTITUTE ( A1 ," 市場 "," 市場 ※") 【 式 3 】 B 1 = IF ( COUNTIF ( A $1 : A1 , A1 )= 1 ,"●"& A1 &"●","") 
体感 できる ほど の 時間 差 は ない と 思い ます 。 ところで 、 > いちど Application .S creenUpdating = True に 戻し て > ステータスバー に 処理 の 進捗 状況 を 表示 さ せ て ます 。 と あり ます が 、 ステータスバー は ScreenUpdating に かかわら ず 表示 し ます よ 。 Sub sample () Dim t As Single Dim i As Integer Application .S creenUpdating = False Application . EnableEvents = False t = Int ( Timer ) For i = 1 To 10 Application .S tatusBar = i Do While t = Int ( Timer ): DoEvents : Loop t = Int ( Timer ) Next Application .S tatusBar = False Application .S creenUpdating = True Application . EnableEvents = True End Sub VBA を 高速 化 し たかっ たら 、 「 セル の 読み書き は まとめ て する 、 行 や 列 の 削除 も まとめ て する 」 つまり 、 「 できるだけ セル に 触ら ない 。 やる まら まとめ て 。 」 でしょ う 。 
モジュール は 、 オブジェクト モジュール 、 フォーム モジュール 、 標準 モジュール 、 クラス モジュール に 分類 さ れ ます 。 この 分類 の 中 に どういう モジュール が ある の か を 表示 する の が 、 フォルダー 毎 に 表示 する 方法 です 。 一方 、 切り替え ボタン を 押す と 、 フォルダー 毎 の 表示 で は なく 、 全て の モジュール を アルファベット順 に 並べ て 表示 し ます 。 モジュール 名 で 探す とき は アルファベット順 に 表示 し た ほう が 探し やすい でしょ う 。 しかし 、 この こと は モジュール 名 を つける とき に 考え て おか なけれ ば いけ ない という こと を 意味 し ます 。 何 の 規則 性 も なく モジュール 名 を 適当 に つけ て しまう と 、 全て の モジュール を 表示 し た とき 、 オブジェクト モジュール 、 フォーム モジュール 、 標準 モジュール 、 クラス モジュール が 入り 混じっ て 表示 さ れ て しまい ます 。 （ それぞれ の 塊 で 表示 さ れ ない ） アイコン で 判別 は でき ます が 、 相当 見難く なっ て しまう でしょ う 。 メリット ・ デメリット と いう より 、 目的 や 見易 さ に 応じ て 使い分けれ ば いい の で は ない でしょ う か 。 
下記 の サイト を 参照 し て 下さい 。 http:// www . officepro .jp / excelvba / ini / index 2 . html 
Ｄ Ｘ ライブラリ は 誰 か が 作っ た 自作 関数 知ら ない 人が 作っ た 自作 関数 の 質問 なんて 誰 も 答え られる わけ が 無い 
siguma = WorksheetFunction .S tDevP ( Range ( Cells ( start , 24 ), Cells ( last , 24 ))) と し て ください 。 
こんにちは。 word や ppt の アプリ の 場合 、 「 自動 でし て ほしい こと 」 そのもの が 、 少ない ため 、 書籍 に し て も 、 かなり あり ませ ん 。 本来 、 VBA を 応用 し た 高度 な コード は 、 MSDN で の 資料 を 読みこなし 、 office の 開発 環境 が ある ユーザー の 善意 で 、 ツールバー 関係 の サンプル コード を 公開 し て い たり し て ます 。 ツール の 知識 の 習得 より も 、 「 そもそも なに が し たい 」 という 部分 を 明確 に し て 、 それ を VBA で 対応 で できる の か 、 という こと の ほう が 、 作り やすい です 。 word も ppt も 、 「 自動 の 記録 」 は 、 期待 でき ない ので 、 開発 環境 の ユーザー で ない と 、 相当 大変 です 。 
お尋ね 頂い た 事項 は 、 「 簡単 に は 」 でき ませ ん 。 Set ApplLST = GetObject (" winmgmts :"). InstancesOf (" win32 _ process ") で 、 インスタンス を 参照 可能 な 情報 が 得 られ て 、 「 Creation Date 」 という プロパティ で インスタンス が 作ら れ た 日時 が 取得 でき ます 。 です から 、 日時 を 比較 する こと で 「 最後 に 開い た もの 」 を 探せ そう に 思え ます 。 です が 、 （ 実際 に ApplLST で 取得 でき た インスタンス 情報 を リストアップ すれ ば 分かり ます が ） explorer は いくつ ウィンドウ を 開い て も 、 インスタンス の 実体 は １つ な の です 。 です ので お 示し 頂い た コード で いう と 、 For Each で 網羅 的 に ウィンドウ を 閉じ て いる よう に 思える けど 、 実は １つ の インスタンス を Terminate し て いる だけ です 。 それで 全部 の ウィンドウ が 閉じ て しまい ます 。 では ウィンドウ の 一覧 を 取得 すれ ば いい か と いう と 、 ウィンドウ から 作成 日時 情報 は 取り出せ ませ ん 。 な ので 、 これ も ダメ です 。 という 訳 で 、 まったく エレガント で は ない の です が 、 必要 な 期間 ずっと スクリプト を 動作 さ せ て explorer の 挙動 を 監視 し 、 ウィンドウ が 増減 する たび に その ウィンドウ の 参照 と 日時 を 記録 する 、 ぐらい しか 方法 が ない よう に 思い ます 。 
GroupBox の 枠 線 は プロパティ で 色 を 変える こと は 出来 ませ ん 。 Paint イベント で 自分 で 線 を 描画 する 必要 が あり ます 。 
下記 の コード で どうでしょう か 。 Sub sample () Dim bk1 As Workbook , bk 2 As Workbook Dim bkNames As Variant Dim num As Double , cnt As Double Dim i As Integer On Error Resume Next Application .S creenUpdating = False Set bk1 = ThisWorkbook bkNames = Array (" B . xlsx ", " C . xlsx ") num = 0 For i = 0 To UBound ( bkNames ) Set bk 2 = Workbooks . Open ( bkNames ( i )) num = num + CDbl ( bk 2 . Worksheets ( 1 ). Cells ( 1 , 1 ). Value ) bk 2 . Close If Err = 0 Then cnt = cnt + 1 Next If cnt > 0 Then bk1 . Worksheets ( 1 ). Cells ( 1 , 1 ). Value = num / cnt On Error GoTo 0 Application .S creenUpdating = True End Sub 50 ほど ある ブック を Array に 書き 連ねる の は 大変 だ と 思い ます 。 通常 は A の 邪魔 に なら ない 場所 （ たとえば Z 列 ） に ブック の 名前 を 書い て おく の が いい でしょ う 。 あるいは A と 同じ フォルダ に まとめ て おく 方法 も あり ます 。 これら の 方法 を とる 場合 の コード の 書き方 は 知恵袋 に も ネット に も たくさん Q&A が あり ます 。 
> エクセル の 住所 録 を ここ に いれ て 翻訳 結果 を エクセル に 取り込み たい です 。 その よう な こと は 可能 でしょ う か ？ 可能 です 。 > VBA 書い て い た だけ ませ ん か ？ ID 非公開 で 頼ん で やっ て もらえる よう な 物 で は あり ませ ん 。 > また 、 いくつ か 作業 が 必要 な の です が 、 こちら も 教え て いただけ ます か ？ それ は 取り込ん だ データー の 処理 な ので 、 物 が 無けれ ば 制作 する こと も 不可能 です 。 
> satoutakao 1515 さん 2016 / 5 / 714 : 50 : 07 > エクセル VBA で FX 自動売買 プログラム を 制作 出来 ます か ？ 出来る でしょ う が 、 自動売買 プログラム を 設計 出来る レベル の 人が エクセル VBA の よう な 非 効率 ＆ 妥協 を 予測 さ れる 物 で 作っ たり は し ない ん じゃ ない か な 。 
テーブル に は 制約 を 設け て 制約 の ある データ は 登録 出来 ない よう に する 機能 が あり ます 、 その 一つ に ユニーク （ UNIQUE ) 制約 が 有り ます 。 これ を DATE 型 の 列 に 設定 し て おけ ば 、 同じ 日 付け を 登録 しよ う と し た 場合 は エラー と 成る ので 、 プログラム で エラー を 拾っ て 再 入力 を 促し ます 。 ただし 、 基本的 に は 同じ 日 付け で も 良い はず です ので 、 ユーザー と 日 付け の ２ 項目 で ユニーク と さ れ た 方 が エラー と なら ない 分 ベター と 考え ます 。 
> Iferror を 外す と 、 うまく いき ます 。 IsError ( VLookup ( Sheet 2 ! AN 2 ), Sheet 3 !$ A $154 :$ B $154 , 2 , FALSE ) IsError に 、 引数 が 4つ ある という こと に なっ て ます ね ？ （） の 位置 を 見直す ところ でしょ う ？ 
こんな ぶつ切り の ソース で は 判り ませ ん 。 抜き出し 方 も 肝心 な 部分 を 外し て いる ので 全く 参考 に なり ませ ん ね 。 変数 名 に アンダースコア を 多用 し たり すべて 大文字 で 表記 する 、 という の は 誰 か から 教わり まし た か ？ 少なくとも VisualBasic で 推奨 さ れる 命名規則 から は かなり 逸脱 し て いる ので 、 やめ た 方 が いい ですよ。 初回 で 表示 し た 文字 が 消え ない という の は 、 ボタンクリックイベント の 先頭 で ラベル の テキスト を クリア し て い ない 可能性 が 非常 に 大きい です 。 
開始 日 は G 列 、 終了 日 は H 列 で ５ 行 目 以降 に 記述 さ れる と し ます 。 開始 日 、 終了 日 を 入力 さ れ た （ セル が 変更 さ れ た ） 場合 に 色 を 塗る よう に し ます 。 ワーク シート の モジュール に 記述 し ます 。 サンプル （ 何 を やっ て いる か は 、 コメント を 見 て ください ） Private Sub Worksheet _ Change ( ByVal Target As Range ) Dim Rng As Range Dim StartRng As Range Dim EndRng As Range Dim i As Long Dim m As Long Dim s As Long Dim e As Long ' 変更 さ れ た セル に G 、 H 列 の 5 行 目 以降 の セル が 含ま れる 場合 に 処理 する If Not Inter sect ( Target , Range (" G5 : H " & Rows . Count )) Is Nothing Then Set StartRng = Nothing Set EndRng = Nothing ' 日付 の 行 （ 4 行 目 ） の 最終 列 判定 m = Cells ( 4 , Columns . Count ). End ( xlToLeft ). Column ' 変更 さ れ た セル の うち G 、 H 列 の セル を 一つ ずつ チェック For Each Rng In Inter sect ( Target , Range (" G : H ")) ' 開始 日 を 変更 さ れ た 場合 If Rng . Column = 7 Then Set StartRng = Rng Set EndRng = Rng . Offset (, 1 ) ElseIf Rng . Column = 8 Then ' 終了 日 を 変更 さ れ た 場合 Set StartRng = Rng . Offset (, - 1 ) Set EndRng = Rng End If ' その 行 を 塗りつぶし なし に する （ 開始 日 、 終了 日 を 含め て ） StartRng . Resize (, m - 8 + 2 ). Interior . Color Index = xlNone If ( Not IsDate ( StartRng . Value )) Or ( Not IsDate ( EndRng . Value )) Then ' 開始 日 、 終了 日 の いずれ か の 指定 が なけれ ば 処理 なし ElseIf StartRng . Value > EndRng . Value Then ' 開始 日 ＞ 終了 日 の 場合 ・ ・ 開始 日 、 終了 日 の セル の 色 を 赤く する StartRng . Resize (, 2 ). Interior . Color = RGB ( 255 , 0 , 0 ) ElseIf ( StartRng . Value > Cells ( 4 , m ). Value ) Or ( EndRng . Value < Cells ( 4 , 9 ). Value ) Then ' 開始 日 が 日付 行 の 右端 より 大きい 、 終了 日 が 日付 行 の 先頭 より 小さい 場合 処理 なし Else ' 開始 日 、 終了 日 の 列 を 求める s = 0 e = 0 ' I 列 から 最終 列 まで チェック For i = 9 To m ' 開始 日 が 等しい か 小さい 日 が 最初 に 現れ た 列 番号 を 控える If ( StartRng . Value <= Cells ( 4 , i ). Value ) And ( s = 0 ) Then s = i ' 終了 日 が 等しい 日 が 最初 に 現れ た 列 番号 を 控える If ( EndRng . Value = Cells ( 4 , i ). Value ) And ( e = 0 ) Then e = i ' 終了 日 が 等しい 日 が 過ぎ 、 小さい 日 が 最初 に 現れ た 列 番号 の ひとつ 前 を 控える If ( EndRng . Value < Cells ( 4 , i ). Value ) And ( e = 0 ) Then e = i - 1 Next ' 開始 日 、 終了 日 が 見つかっ て い なけれ な 先頭 （ I 列 ） 、 最終 列 を セット If s = 0 Then s = 9 If e = 0 Then e = m ' 該当 範囲 の セル の 色 を 付ける （ 青色 ） Range ( Cells ( StartRng . Row , s ), Cells ( EndRng . Row , e )). Interior . Color = RGB ( 0 , 0 , 255 ) End If Next End If End Sub 
for 文 の 次 の 行 に if 文 を 入れ て m が 13 ～ 15 の 間 は 翌年 の 1 ～ 3月 に なる よう に 書き換え て あげ ない と ダメ です よ 。 
G 列 の データ で 今月 1日 以降 の 日付 の 件数 から 来月 1日 以降 の 日付 の 件数 を 引い た もの を 取得 する つまり 、 G 列 内 に 入っ て いる 日付 データ から 今月 中 の 日付 の 件数 が 算出 さ れ ます 
私 は 秀和システム の 「 ExcelVBA 逆引き 大全 」 という 本 と ネット の 「 Office TANAKA - Excel VBA Tips 」 http:// office tanaka .net / excel / vb a/t ips / index . htm 「 Excel VBA を 学ぶ なら moug モーグ 」 http:// www . moug .net / を 利用 し て い ます 。 ログ 解析 で 判ら ない こと が あっ たら 「 ログ 解析 ○ ○ 」 で ググ れ ば 何かしら の 情報 は 得 られ ます 。 
添付 図 を 参考 に し て い ます 。 左 図 は Sheet 1 、 右 図 は Sheet 2 として 。 Sub Test () Dim sh 1 As Worksheet , sh 2 As Worksheet , EndRow As Long Dim i As Long , num ( 2 ) As String , Gyou As Long Set sh 1 = Worksheets (" Sheet 1 ") Set sh 2 = Worksheets (" Sheet 2 ") With sh 1 EndRow = . Range (" A " & Rows . Count ). End ( xlUp ). Row Gyou = Active Cell . Row EndRow = EndRow - Gyou Select Case EndRow Case 0 num ( 0 ) = . Range (" A " & Gyou ) num ( 1 ) = . Range (" A 2 ") num ( 2 ) = . Range (" A3 ") Case 1 num ( 0 ) = . Range (" A " & Gyou ) num ( 1 ) = . Range (" A " & Gyou ). Offset ( 1 ) num ( 2 ) = . Range (" A 2 ") Case Else num ( 0 ) = . Range (" A " & Gyou ) num ( 1 ) = . Range (" A " & Gyou ). Offset ( 1 ) num ( 2 ) = . Range (" A " & Gyou ). Offset ( 2 ) End Select End With With sh 2 . Range (" A1 ") . AutoFilter Field := 3 , Criteria 1 := num , Operator := xlFilterValues End With End Sub 
FFFTP は FTP ソフト の 名前 。 サーバー で は あり ませ ん 。 1 . s という フォルダ に 業者 から もらっ た データ を 入れ （ すで に s フォルダ に 入っ て いる なら 新た に フォルダ を 作ら ず フォルダ ごと ） 、 サーバー に そのまま アップロード すれ ば OK 。 2 . 業者 に 頼み ましょ う 。 そこ まで やっ て もらえ ない なら 金 は 払え ない と 言い ましょ う 。 
こんにちは。 環境 が ない ので 、 その 対応 です が 、 1 小文字 の データ を 処理 し た とき の 、 パターン を 、 ビット イメージ で 、 ファイル つくり 、 ペイント で 、 見比べ て ください 。 どこ で 、 変換 エラー が ある か を 、 確認 し て ください 。 規格 資料 を 確認 し 、 大文字 と 小文字 の 違い が ある か の 確認 も 、 し て ください 。 もし 、 区別 の ない 仕様 なら ば 、 読み込み し て から 、 大文字 に 読み替える 関数 を 、 組み合わせる こと に 、 なり ます 。 
マクロ を 記述 し た ブック と 同じ フォルダ に 保存 し ます 。 Sub STC () Dim CSVST As Worksheet With Application . DisplayAlerts = False .S creenUpdating = False For Each CSVST In Worksheets CSVST . Copy ActiveWorkbook .S aveAs Filename := ThisWorkbook . Path & "\" & ActiveSheet . Name & ". csv ", _ FileFormat := xlCSV , CreateBackup := False ActiveWorkbook . Close False Next CSVST .S creenUpdating = True . DisplayAlerts = False End With End Sub 
AddRange で 追加 する の で は なく Add で 追加 する の で あれ ば Public Class Form 1 Private Sub Button 1 _ Click _ 1 ( sender As Object , e As EventArgs ) Handles Button 1 . Click ListBox 1 . Items . Clear () Dim item _ dataList As New Class 1 Class 1 . Main () For Each i As String In item _ dataList . d ’ ListBox 1 . Items . Add ( i ) ' d の 各 要素 の 4 文字 目 以降 で あれ ば … ListBox 1 . Items . Add ( i .S ubstring ( 3 )) Next End Sub End Class で 希望 通り の 動き な の で は … 
こんばんは 特定 の 行 だけ 色 を 変更 する サンプル です 。 Public Class Form 1 Private Sub Form 1 _ Shown ( sender As System . Object , e As System . EventArgs ) Handles MyBase .S hown ListBox 1 . DrawMode = DrawMode . OwnerDrawFixed ListBox 1 . Items . Add (" a ") ListBox 1 . Items . Add (" b ") ListBox 1 . Items . Add (" c ") End Sub Private Sub ListBox 1 _ DrawItem ( sender As System . Object , e As System . Windows . Forms . DrawItemEventArgs ) Handles ListBox 1 . DrawItem If e . Index = - 1 Then Exit Sub End If e . DrawBackground () ' 奇数 項目 の 背景 を ブルー に する 。 If e . Index = 2 Then ' 項目 が 選択 さ れ て いる 場合 は 色 を 塗ら ない 。 If CBool ( e .S tate And DrawItemState .S elected ) = False Then e . Graphics . FillRectangle ( Brushes . Blue , New RectangleF ( e . Bounds . X , e . Bounds . Y , e . Bounds . Width , e . Bounds . Height )) End If End If Dim myBrush As Brush = New SolidBrush ( ListBox 1 . ForeColor ) e . Graphics . Draw String ( ListBox 1 . Items ( e . Index ), e . Font , myBrush , New RectangleF ( e . Bounds . X , e . Bounds . Y , e . Bounds . Width , e . Bounds . Height )) e . DrawFocusRectangle () End Sub End Class 行 の 番号 は 自由 に 変更 し て ください 。 
A 列 に 顧客 NO 、 B 列 に 預かり 中 が 入力 さ れ て いる 時 の 例 です 。 Sub sample () Dim xDic , rng As Range , xAry Set xDic = CreateObject (" Scripting . Dictionary ") For Each rng In Range (" A1 ", Cells ( Rows . Count , 1 ). End ( xlUp )) With rng If . Offset (, 1 ). Value = " 預かり 中 " Then xAry = Split (. Value , "-") On Error Resume Next xDic . Add xAry ( 0 ), xAry ( 0 ) On Error GoTo 0 End If End With Next rng MsgBox " 預かり 中 は 、 " & xDic . Count & " 人 です " End Sub 
最初 に AutoFilter を 宣言 し て いる の は 何 の ため でしょ う か 。 AdvancedFilter を 使用 する なら 特に AutoFilter の 宣言 は 不要 だ と 思い ます 。 また 、 Range (" A 7 "). AutoFilter と し て いる ので 、 途中 に 空白 行 （ すべて の 列 が 空白 ） が あっ た 場合 に は 、 その 上 まで が 自動的 に AutoFilter の 範囲 に なり ます 。 ただし 、 実際 に は AdvancedFilter を かけ て い ます ので 、 AutoFilter は 無視 さ れる と 思い ます 。 また AdvancedFilter は Range (" A 7 : M50 00 ") に対して 行っ て い ます ので 、 AutoFilter の 範囲 は 関係 なく 、 7 行 目 から 5000 行 目 が 対象 です 。 > 新しく データ を 入力 し た もの や 、 > 元 に 入っ て いる データ を 書き 替え たり する と 、 > 全く 抽出 し て くれ ませ ん 。 新しく 入力 し た の が 5000 行 目 以降 という こと は あり ませ ん か ？ 書き 替え の データ が 抽出 でき ない の は ・ ・ わかり ませ ん 。 > 空欄 も あり ませ ん 。 空欄 も 抽出 する よう な 条件 が 入っ て いる の でしょ う か ？ とりあえず 、 最初 の AutoFilter は やめ 、 すでに フィルタ が かかっ て いれ ば 解除 する よう に 以下 の よう な ステップ を 追加 し て も だめ でしょ う か 。 If ActiveSheet . FilterMode = True Then ActiveSheet .S howAllData 
PowerShell の 配列 は 基本 固定 長 で 可変長 な 使い方 を する と 遅 め な ので 、 最初 から 可変長 な ArrayList 辺り を 使っ た 方 が 早く て 楽 か と 。 $ al = New - Object System . Collections . ArrayList $ al . Add (～) foreach ($ e in $ al ){ echo "[$ e ]"} $ al . Count $ al [ 2 ] # または $ al . Item ( 2 )# $ al . ToArray () 
C# 経験 者 で あれ ば VisualStudio で ASP.NET Web アプリケーション を 利用 し て 構築 する の が 早い です ね 。 社内 検証 用 で あれ ば 、 開発 機 が そのまま Webサーバ に なり ます 。 後 は DB と の 連携 です が , ASP.NET に 組み込み やすい の は MS SQL Server です ね 。 当然 UI 設計 は html , css , Java script など の 知識 が ある程度 必要 に なり ます 。 時間 ある なら まずは VS で プロジェクト 作っ て み て は ？ ない なら 外注 で 
ヘルプ で 出 て き た コード に ちょっと 加え て み まし た 。 Sub Sample () Dim triArray ( 1 To 4 , 1 To 2 ) As Single triArray ( 1 , 1 ) = 25 triArray ( 1 , 2 ) = 100 triArray ( 2 , 1 ) = 100 triArray ( 2 , 2 ) = 150 triArray ( 3 , 1 ) = 150 triArray ( 3 , 2 ) = 50 triArray ( 4 , 1 ) = 25 ' Last point has same coordinates as first triArray ( 4 , 2 ) = 100 Set MyDocument = Worksheets ( 1 ) With MyDocument .S hapes . AddPolyline ( triArray ) . Line . ForeColor . RGB = RGB ( 255 , 255 , 0 ) . Fill . ForeColor . RGB = RGB ( 0 , 255 , 0 ) . Fill . Transparency = 0 . 8 . Name = " ポリ ライン 01 " End With End Sub 
outlook VB msg 読み込み ↓ 参考 http:// www . dotnetgallery . com / lab / resource 157 - How - to - Read - MS - Outlook ... # キャスト でき ない 場合 の エラー 処理 等 は 追加 が 必要 です が 、 、 で 、 添付 は 普通に For Each buf In item . Attachments MsgBox ( buf . FileName ) Next こんな 感じ で 参照 でき ます 後 は 適当 に 保存 （ ここら 辺 の 添付 の 扱い は サンプル が ごろごろ 転がっ て ます ） 
> そこで A の 中 の もの を B へ USB 伝い で 移行 さ せ た の です が それ は 、 ファイル を コピー し た って こと です か ？ レジストリ の 設定 やら いろいろ ある ので 、 B で インストール し なけれ ば 使え ない でしょ う ね 。 ライセンス について は 詳しく ない の です が 、 Visual Studio は 開発者 ごと に ライセンス の はず です から 、 B に インストール し なおし て も 、 使う の 人 に ライセンス が あれ ば 問題 ない はず です 。 
下記 の コード でいか が でしょ う か 。 Public Class Form 1 Dim bDrag As Boolean , ptDrag As Point Private Sub PictureBox _ MouseDown ( sender As Object , e As EventArgs ) Handles PictureBox 1 . MouseDown , PictureBox 2 . MouseDown If bDrag = False Then bDrag = True ptDrag = Cursor . Position End If End Sub Private Sub PictureBox _ MouseMove ( sender As Object , e As EventArgs ) Handles PictureBox 1 . MouseMove , PictureBox 2 . MouseMove If bDrag Then sender . Location = sender . Location + Cursor . Position - ptDrag ptDrag = Cursor . Position End If End Sub Private Sub PictureBox _ MouseUp ( sender As Object , e As EventArgs ) Handles PictureBox 1 . MouseUp , PictureBox 2 . MouseUp bDrag = False End Sub End Class 
text bo x1 . clear () の 事 な の か な ？ 
明確 に なっ て い ない 部分 は 下記 の とおり で マクロ を 作成 し まし た 。 データ は 全て 1 行 目 から と し て い ます 。 1 行 目 が 項目 名 でし たら コード を 修正 し て 下さい 。 また 、 B ブック の 各 シート の データ に は 100 行 の 価格 データ が ある もの として 固定 で 扱っ て い ます 。 A ブック と B ブック は 同じ フォルダ に 入っ て いる もの と し ます 。 fpath = " D :\ Data \" ' ここ に 実際 の ディレクトリ を 設定 この 部分 で 設定 し て 下さい 。 （ 最後 に \ を つける の を 忘れないよ うに ） A , B どちら で も ない エクセル ファイル に この マクロ を 登録 し て 実行 し ます 。 Sub Sample () Dim fpath As String Dim wb 1 As Workbook , w b2 As Workbook Dim sh As Worksheet Dim rr As Long , rmax As Long Dim sname As String Application .S creenUpdating = False Application . DisplayAlerts = False Set wb 1 = ThisWorkbook fpath = " D :\ Data \" ' ここ に 実際 の ディレクトリ を 設定 Set wb 1 = Workbooks . Open ( fpath & " A . xlsx ") Set w b2 = Workbooks . Open ( fpath & " B . xlsx ") With wb 1 . Worksheets (" Sheet 1 ") rmax = . Cells ( Rows . Count , " M "). End ( xlUp ). Row For rr = 1 To rmax Step 100 sname = " 1510 C " & . Range (" M " & rr ). Value Set sh = Nothing With w b2 For Each sh In Worksheets If sh . Name = sname Then Set sh = w b2 . Worksheets ( sname ) Exit For End If Next sh End With If Not sh Is Nothing Then sh . Range (" B 1 : E 100 "). Copy Destination :=. Range (" C " & rr ) End If Next rr End With wb 1 .S ave wb 1 . Close w b2 . Close Application . DisplayAlerts = True Application .S creenUpdating = True End Sub 
こんにちは。 「 文字数 が 多い 」 の でしょ う か 。 URL の ルール を 守っ て い ない 、 つまり 、 間違っ た 文字列 に なっ て いる 、 という の が 心配 です 
検索 範囲 に 検索対象 の セル が 存在 する という の なら Dim r As Range Set r = Range (" A 2 : A9 9 "). Find ( ComboBox 1 . Value ). Offset ( 0 , 1 ). Value ComboBox 2 . Value = r Dim r As Range Set r = Range (" B2 : B 99 "). Find ( ComboBox 2 . Value ). Offset ( 0 , - 1 ). Value Set ComboBox 1 . Value = r ↓ Dim r As Range Set r = Range (" A 2 : A9 9 "). Find ( ComboBox 1 . Value ). Offset ( 0 , 1 ) ComboBox 2 . Value = r . Value Set r = Range (" B2 : B 99 "). Find ( ComboBox 2 . Value ). Offset ( 0 , - 1 ) Set ComboBox 1 . Value = r . Value 値 を 、 セル 範囲 を 表す 変数 を Set する の は おかしい です よ ね ？ 
例えば 1 行 目 が 見出し で 、 A 列 が 名前 、 B 列 が 血液型 、 C 列 が 生年月日 、 D 列 が 住所 の 場合 です 。 ユーザー フォーム に 、 ComboBox 1 , ListBox 1 , Command Button 1 , Label 1 , Label 2 , Label 3 が ある 場合 です 。 同姓同名 が 無い 場合 と 、 同姓同名 が ある 場合 の 2つ です 。 [ 同姓同名 が 無い 場合 ] ' ユーザー フォーム の 初期化 Private Sub UserForm _ Initialize () ' Combo 1 の 初期 値 ( 血液型 ) 設定 ComboBox 1 . AddItem " 全て " ComboBox 1 . AddItem " A " ComboBox 1 . AddItem " B " ComboBox 1 . AddItem " O " ComboBox 1 . AddItem " AB " End Sub ' コンボ 1 が 変更 さ れ た とき の 処理 Private Sub ComboBox 1 _ Change () Dim lastRow As Long Dim r As Long ListBox 1 . Clear ' リスト 1 クリア lastRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' A 列 最終 行 For r = 2 To lastRow ' 注目 行 を 2 行 目 から A 列 最終 行 まで If ( ComboBox 1 . Value = " 全て ") Or ( Range (" B " & r ). Value = ComboBox 1 . Value ) Then ' B 列 ( 血液型 ) の 注目 行 の 値 が コンボ 1 で 選ん だ 値 ( 血液型 ) なら ListBox 1 . AddItem Range (" A " & r ). Value ' リスト 1 に A 列 注目 行 の 値 ( 名前 ) を 追加 End If Next ListBox 1 .S etFocus ' リスト 1 を 選択 End Sub ' コマンド ボタン 1 を 押し た とき Private Sub CommandButton 1 _ Click () Dim rng As Range Dim r As Long Set rng = Range (" A : A "). Find ( ListBox 1 . Value , lookAt := xlWhole ) ' A 列 で リスト ボックス 1 の 値 ( 名前 ) を 探す If rng Is Nothing Then Exit Sub ' 無けれ ば 終了 r = rng . Row ' 名前 が あっ た 行 Label 1 . Caption = Range (" C " & r ). Value ' 生年月日 Label 2 . Caption = Range (" D " & r ). Value ' 住所 Label 3 . Caption = Range (" B " & r ). Value ' 血液型 End Sub [ 同姓同名 が ある 場合 ] ' ユーザー フォーム の 初期化 Private Sub UserForm _ Initialize () ' Combo 1 の 初期 値 ( 血液型 ) 設定 ComboBox 1 . AddItem " 全て " ComboBox 1 . AddItem " A " ComboBox 1 . AddItem " B " ComboBox 1 . AddItem " O " ComboBox 1 . AddItem " AB " End Sub ' コンボ 1 が 変更 さ れ た とき の 処理 Private Sub ComboBox 1 _ Change () Dim lastRow As Long Dim r As Long ListBox 1 . Clear ' リスト 1 クリア lastRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' A 列 最終 行 For r = 2 To lastRow ' 注目 行 を 2 行 目 から A 列 最終 行 まで If ( ComboBox 1 . Value = " 全て ") Or ( Range (" B " & r ). Value = ComboBox 1 . Value ) Then ' B 列 ( 血液型 ) の 注目 行 の 値 が コンボ 1 で 選ん だ 値 ( 血液型 ) なら ListBox 1 . AddItem Range (" A " & r ). Value ' リスト 1 に A 列 注目 行 の 値 ( 名前 ) を 追加 ListBox 1 . List ( ListBox 1 . ListCount - 1 , 1 ) = r ' 今 追加 し た リスト ボックス の 2 列 目 ( 見え ない けれど ) に 追加 し た 名前 の 行番号 を 設定 ( ちなみに ListBox 1 . ListCount - 1 な の は 、 Listbox 1 . List ( row , column ) の row , column は 0 から 始まる ので 例えば 1 行 目 なら row = 0 な ので ) End If Next ListBox 1 .S etFocus ' リスト 1 を 選択 End Sub ' コマンド ボタン 1 を 押し た とき Private Sub CommandButton 1 _ Click () Dim r As Variant If ListBox 1 . ListIndex = - 1 Then Exit Sub ' まだ リスト ボックス 1 ( 名前 ) が 選択 さ れ て ない なら 終了 r = ListBox 1 . List ( ListBox 1 . ListIndex , 1 ) ' 選ば れ た リスト の 2 列 目 の 値 ( 名前 の 人 の データ が ある 行 ) Label 1 . Caption = Range (" C " & r ). Value ' 生年月日 Label 2 . Caption = Range (" D " & r ). Value ' 住所 Label 3 . Caption = Range (" B " & r ). Value ' 血液型 End Sub 
細かい 仕様 が 不明 な ので 、 １ 行 目 が 見出し で 、 A 列 に 名前 、 B 列 に 血液型 と し ます 。 最終 行 は A 列 ( 名前 ) が ある 間 と し ます 。 コンボボックス 1 、 コンボボックス 2 は 、 ユーザー フォーム の コンボボックス と し ます 。 あらかじめ ユーザー フォーム に 、 ComboBox 1 、 ComboBox 2 という 名前 で 2つ の コンボボックス が 作ら れ て いる と し ます 。 ' ユーザー フォーム の 初期化 Private Sub UserForm _ Initialize () ' Combo 1 の 初期 値 ( 血液型 ) 設定 ComboBox 1 . AddItem " A " ComboBox 1 . AddItem " B " ComboBox 1 . AddItem " O " ComboBox 1 . AddItem " AB " End Sub ' コンボ 1 が 変更 さ れ た とき の 処理 Private Sub ComboBox 1 _ Change () Dim lastRow As Long Dim r As Long ComboBox 2 . Clear ' コンボ 2 クリア lastRow = Range (" A " & Rows . Count ). End ( xlUp ). Row ' A 列 最終 行 For r = 2 To lastRow ' 注目 行 を 2 行 目 から A 列 最終 行 まで If Range (" B " & r ). Value = ComboBox 1 . Value Then ' B 列 ( 血液型 ) の 注目 行 の 値 が コンボ 1 で 選ん だ 値 ( 血液型 ) なら ComboBox 2 . AddItem Range (" A " & r ). Value ' コンボ 2 に A 列 注目 行 の 値 ( 名前 ) を 追加 End If Next ComboBox 2 .S etFocus ' コンボ 2 を 選択 End Sub 
調べ 方 エラー が 出 たら 、 エラーメッセージ を 読む デバッグ ボタン が 表示 さ れ たら 押し 、 場所 を 確認 する 変数 に マウス を 当てる と 、 値 が 表示 さ れる ので 、 意図 し た 通り か 確認 する 
以前 の QA で 、 複数 の セル へ の 書き出し し て まし た が ･･･ 以前 に 、 こちら で VBA で の コード を 教え て もらい http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1415655149 ... Array ( 8 , 5 , 3 ) は 固定 で 良い です か 出力 先 に は 8 : 2 , 5 : 2 , 3 : 0 の よう な 形式 と し て みる と 、 処理 する シート の コード に 、 以下 を 記述 し て どう なり ます か Private Sub Worksheet _ Change ( ByVal Target As Range )     Dim vA As Variant , vB As Variant     Dim iNum As Long     Dim i As Long     Const CRC As String = " BA 7 " ' 入力     Const C 2 RC As String = " BB 7 " ' 出力 先     If ( Inter sect ( Target , Range ( CRC )) Is Nothing ) Then Exit Sub     iNum = Val ( Range ( CRC ). Value )     If ( iNum < 1 ) Then Exit Sub     vA = Array ( 8 , 5 , 3 )     vB = Samp 1 ( iNum , vA )     If ( Not IsEmpty ( vB )) Then        For i = LBound ( vA ) To UBound ( vA )           vB ( i ) = vA ( i ) & ":" & Val ( vB ( i ))        Next        Application . EnableEvents = False        Range ( C 2 RC ). Value = Join ( vB , ", ")        Application . EnableEvents = True     End If End Sub 
Do While Cells ( i , 2 ) <> "" で Cells ( i , 2 ) の 内容 が 空白 なら 終了 と し て い ます が 、 この 時 の シート が 指定 さ れ て い ませ ん 。 Do While Worksheets (" 入力 "). Cells ( i , 2 ) <> "" と する か 、 その 前 で Sheets (" 入力 "). Activate または Sheets (" 入力 "). Select で アクティブ シート を " 入力 " に する 必要 が あり ます 。 
Do While Cells ( i , 2 ) <> "" で Cells ( i , 2 ) の 内容 が 空白 なら 終了 と し て い ます が 、 この 時 の シート が 指定 さ れ て い ませ ん 。 Do While Worksheets (" 入力 "). Cells ( i , 2 ) <> "" と する か 、 その 前 で Sheets (" 入力 "). Activate または Sheets (" 入力 "). Select で アクティブ シート を " 入力 " に する 必要 が あり ます 。 
マクロ の 保存 先 と は 、 作業 中 の ブック 、 それとも 個人 用 マクロ ブック の こと です か ？ それなら 、 マクロ の 記録 の 開始 画面 で 指定 でき ます 。 標準 モジュール で あれ ば 、 プロジェクト ウィンドウ に モジュール が 表示 さ れ ます 。 記述 する マクロ を 分け たい なら 、 挿入 メニュー から 標準 モジュール を 追加 すれ ば 良い です 。 移動 は 、 マクロ （ プロシージャ ） 単位 で 切り取っ て 、 他 の モジュール 内 で 貼り 付け 。 モジュール 名 はいつ で も 変更 でき ます 。 名前 を 変更 し たい モジュール を 選択 し て 、 プロパティ ウィンドウ の 上 の 「 オブジェクト 名 」 の 右側 の テキストボックス で 任意 の 名前 を 入力 でき ます 。 
ZwQuerySystemInformation っていう 非公開 API を 使う よう です 。 http:// www . papy . in / bbs / delphi / 201002 / 10020065 . html 利用 例 http:// mrxray . on . coocan .jp / Delphi / plSamples / 332 _ ProcessListNtQuery .... 
シート の 保護 は ご存知 です か 。 リボン の 「 校閲 」 に 「 シート の 保護 」 という の が あり 、 これ を 行う こと で 「 ロック 」 を 掛け た セル は 入力 不可 に なり ます 。 ただし 、 全て の セル は 標準 で 「 ロック 」 が かかっ て いる ため 、 入力 可能 な セル のみ 「 セル の 書式 設定 」－「 保護 」 タブ を 開い て 「 ロック 」 の チェック を 外す 必要 が あり ます 。 色付け を 行っ て も 印刷 時 に 色 を 出 ない よう に する に は 、 リボン の 「 ページレイアウト 」 の 「 印刷 タイトル 」 を 開き 、 「 白黒 印刷 」 に チェック を 入れる と 塗りつぶし の 色 は 出 なく なり ます 。 Visual Basic の カテ な ので 、 これら の こと を VBA で 行い たい って こと な ん でしょ う か ？ 
Sub sample () Dim xFSO , xPath As String , xFld As String , xSub Set FSO = CreateObject (" Scripting . FileSystemObject ") xPath = ThisWorkbook . Path xFld = Dir ( xPath , vbDirectory ) Application .S creenUpdating = False Worksheets (" Sheet 6 "). Copy With ActiveWorkbook For Each xSub In FSO . GetFolder ( xPath ). ParentFolder .S ubFolders If xSub . Name <> xFld Then .S aveAs Filename := xSub & "\" & " AAA " End If Next xSub . Close savechanges := False End With Set FSO = Nothing Application .S creenUpdating = False End Sub 
可能 です 。 テスト し て みれ ば わかる と 思い ます が ・ ・ ただし 、 サンプル の コード で ListBox 1 _ Click の txt bo x3 . value =" & T & " 分 ～" & TT & " 分 ” は 構文 エラー です 。 
対象 行 を 決定 する ため に 、 A - E 列 の 中 に 重複 データ が 無い 列 が ある 場合 と 、 どの 列 も 重複 が ある 場合 が 考え られ ます 。 コマンド ボタン は Command Button 1 です 。 [ A - E 列 の 中 に 重複 データ が 無い 列 が ある 場合 ] 例えば A 列 が 重複 データ が 無い 場合 です 。 B - E 列 が 重複 データ が 無い 場合 は コメント に なっ て いる どれ か を 有効 に し て ください 。 Private Sub CommandButton 1 _ Click () ' チェック If ListBox 2 . ListIndex = - 1 Then MsgBox " 選ん で ください " ListBox 2 .S etFocus Exit Sub End If ' Dim rng As Range Set rng = Range (" A : A "). Find ( ListBox 2 . List ( ListBox 2 . ListIndex , 0 ), LookIn := xlValues , lookat := xlWhole ) ' A 列 で チェック する 場合 ' Set rng = Range (" B : B "). Find ( ListBox 2 . List ( ListBox 2 . ListIndex , 1 ), LookIn := xlValues , lookat := xlWhole ) ' B 列 で チェック する 場合 ' Set rng = Range (" C : C "). Find ( ListBox 2 . List ( ListBox 2 . ListIndex , 2 ), LookIn := xlValues , lookat := xlWhole ) ' C 列 で チェック する 場合 ' Set rng = Range (" D : D "). Find ( ListBox 2 . List ( ListBox 2 . ListIndex , 3 ), LookIn := xlValues , lookat := xlWhole ) ' D 列 で チェック する 場合 ' Set rng = Range (" E : E "). Find ( ListBox 2 . List ( ListBox 2 . ListIndex , 4 ), LookIn := xlValues , lookat := xlWhole ) ' E 列 で チェック する 場合 Rows ( rng . Row ). Delete End Sub [ A - E 列 の 中 に 重複 データ が 無い 列 が 無い 場合 ] リスト ボックス の 中 に 行 データ を 埋め込み ます 。 TextBox 1 _ Change に 変更 と 追加 を し ます 。 > ReDim Preserve w ( 1 To 6 , 1 To UBound ( w , 2 ) + 1 ) を ReDim Preserve w ( 1 To 7 , 1 To UBound ( w , 2 ) + 1 ) に 変更 する 。 > ReDim w ( 1 To 7 , 1 To 1 ) を ReDim w ( 1 To 7 , 1 To 1 ) に 変更 する 。 > w ( 6 , UBound ( w , 2 )) = Obj . EntireRow . Range (" F1 "). Value の 後 に w ( 7 , UBound ( w , 2 )) = Obj . Row を 追加 する 。 Command Button 11 _ Click です 。 Private Sub CommandButton 11 _ Click () ' チェック If ListBox 2 . ListIndex = - 1 Then MsgBox " 選ん で ください " ListBox 2 .S etFocus Exit Sub End If ' Rows ( ListBox 2 . List ( ListBox 2 . ListIndex , 6 )). Delete End Sub 
この 記述 を どの よう に 修正 し たら うまく いく でしょ う か ？ If c . Formula = "" Then c . Value = Range (" B 1 "). Copy c . PasteSpecial Paste := xlPasteFormulas ↓ If c . Formula = "" Then . Range (" B 1 "). Copy c . PasteSpecial Paste := xlPasteFormulas End If どうせ なら Sub test () With ActiveSheet . Range (" B 1 "). Copy For Each c In . Range (" B2 : B2 0 ") If c . Formula = "" Then c . PasteSpecial Paste := xlPasteFormulas End If Next End With End Sub > 上記 の 記述 以外 で 、 良い 方法 が あれ ば 、 お 教え 頂き たい です 。 Sub sample () Dim rng As Range With ActiveSheet On Error Resume Next Set rng = . Range (" B2 : B2 0 "). SpecialCells ( xlCellTypeBlanks ) On Error GoTo 0 If Not rng Is Nothing Then . Range (" B 1 "). Copy rng . PasteSpecial Paste := xlPasteFormulas End If End With End Sub 対象 セル が 、 1000 セル くらい に なる と 速度 の 違い が 解る はず 。 
コメントアウト の 最初 の ほう Workbooks ( ThisWorkbook . Path & "\" & FileName ). Activate は 、 パス は 不要 な ので Workbooks ( FileName ). Activate と し ます 。 次 の SelectedWorkbook . Range (" A 2 "). Value = 123 です が 、 「 SelectedWorkbook 」 なんて あり ませ ん ので 、 書く なら 「 ActiveWorkbook 」 です が 、 ブック の 指定 は あっ て も シート の 指定 が あり ませ ん 。 複数 シート が ある 場合 は どう する の でしょ う か ？ 開い た 時 に アクティブ な シート で 良けれ ば 、 特に 指定 なし で Range (" A 2 "). Value = 123 でも いい です 。 たとえば 必ず 先頭 の シート なら ActiveWorkbook . Worksheets ( 1 ). Range (" A 2 "). Value = 123 でしょ う か 。 
Visual Basic の 知識 が まったく ない の で あれ ば 手作業 で 行う こと を お勧め し ます 。 会社 の 業務 で マクロ を 使う の で あれ ば 多少なりとも VBA の 勉強 を し て から で ない と 、 失敗 し た とき の リカバリー が 効き ませ ん よ 。 
対象 は ソート さ れ て いる もの と 考え て 良い でしょ う か ？ EXCEL の COUNTIF 関数 を 使っ て 「 い 」 の 数 を 数え て 、 行番号 を 起点 行 ＋ COUNTIF 結果 で どうでしょう ？ － １ し ない と 「 ろ 」 の 先頭 を 取得 に は なり ます が 。 
上記 の よう な こと を 行う ため に は 、 ユーザー フォーム を 使用 し ます 。 新しい ユーザー フォーム を 作成 し 、 ラベル と コマンド ボタン を ４つ 配置 し ます 。 ラベル に は メッセージ を 書い て おき 、 コマンド ボタン を クリック さ れ たら その 結果 を 元 の モジュール に 返し 、 ユーザー フォーム を 閉じる 。 ここ で ユーザー フォーム の 作り方 を １ から 説明 する の は 簡単 な こと で は あり ませ ん ので 、 下記 の サイト など を 参考 に し て ください 。 Excel ユーザー フォーム 入門 http:// excel - ubara . com / excel vb a3 / VBA : ユーザー フォーム を 組み込み ダイアログ の よう に 使う http:// blog . goo . ne.jp / 40 vq 77 a 80 / e / cef 67 c4 dcf 3b 5 cef 2388 ad 69 a 547214 b 知恵袋 の 過去 の 質問 から http:// detail . chiebukuro . yahoo . co.jp / qa / question _ detail / q 1454138194 作成 途中 で 疑問 など が あれ ば 、 ここ で 質問 すれ ば 誰か が 答え て くれる でしょ う 。 －－－－－－－－－－－－－－－ 考え て みれ ば 、 最初 から シート の 登録 ボタン を ４つ 用意 する という 案 も あり ます よ 。 
コード 例 です 。 Sub Sample () Dim Rng As Range For Each Rng In ActiveSheet . UsedRange If Rng . Interior . Color = vb Yellow Then Rng . Interior . Color = vbBlack Next End Sub 
> すで に 結合 さ れ て いる セル を 更に 結合 する 場合 、 H 5 : H6 という よう な 先頭 の セル の > みの 指定 で いけ ます か ？ > それとも H 5 ： T 6 の よう な 全て を 指定 し ない と ダメ でしょ う か ？ 先頭 の セル のみ で も 結合 でき ます よ 。 （ 例 ） Range (" H 5 : H6 "). Merge ただし 、 列 数 が 違う 場合 に は 長い ほう に 合わせ られ ます 。 たとえば 、 H 5 ～ O 5 と H6 ～ T 6 の 場合 は H 5 ～ T 6 に なり ます 。 > 結合 さ れ て いる セル を 検索 し て 、 その 結合 さ れ て いる セル と下 の セル を 結合 する という よう な こと も できる の でしょ う か ？ 結合 し て いる セル の 検索 方法 は わかり ませ ん 。 しらみ潰し に MergeCells で 確認 する しか ない かも しれ ませ ん ね 。 特定 の 列 なら 上 から 順に チェック する と か 。 
特定 文字 B という の が 、 「" 特定 文字 A "」 と 同じ 意味 なら 、 こういう ↓ 変更 な の です か ね ？ 初級 の うち も 、 Option Explicit を 使用 する の が お勧め 。 If Not c . Offset ( 0 , - 1 ). Value Like "*" & 特定 文字 B & "*" Then ↓ If Not ( c . Offset ( 0 , - 1 ). Value Like "*" & " 特定 文字 B " & "*") Then 
VB は 詳しく ない けど 、 正規表現 は 使え ない ん ？ (.*？) え で 、 いける と 思う が 。 あ 、 「 あい うえ 」 に なっ ちゃう かも だ から 、 最後 の ” え ” は 、 消す 方向 で 。 「 正規表現 言語 名 」 で 検索 すれ ば 、 見つかる と 思う が 。 
一 例 で ・ ・ 。 Private Sub Worksheet _ Change ( ByVal Target As Range ) If Inter sect ( Target , Range (" D : D , F : F ")) Is Nothing Then Exit Sub Target . Offset (, - 1 ) = Date End Sub 
パスワード が 判っ て いる の なら 開け ます 。 Workbooks . Open " Book 1 . xlsx ", Password :=" aaaaa ", WriteResPassword :=" bbbbb " Workbooks . Open の 詳しい 使い方 は ヘルプ を 参照 し て ください 。 
下記 VBA の 修正 を お願い し ます 。 と 言わ れ て も テスト の 上 、 回答 し て い ます 。 その エラー は マクロ の ロジック が 原因 で は ない です 。 どの よう に 登録 し まし た か 。 出力 し たい エクセル の シート の シートモ － ジュール に 登録 する マクロ です 。 別 質問 を たてる の で は なく 、 元 の 質問 で 返信 し て 頂き たい と 思い まし た 。 
アマゾン で の JANコード 検索 という の は 、 どう やっ て 行なう の でしょ う か 。 それ が 分から ない と 、 コード の 組み よう が あり ませ ん 。 ちなみに 、 有料 ツール だ と 、 私 に は 手 が 出せ ませ ん 。 
こんにちは。 gyo = 1 for i = 2 to activeworkbook .s heets . count sheets ( 1 ). range (" A " & gyo ). value = sheets ( i ). name sheets ( 1 ). range (" B " & gyo ). value = sheets ( i ). range (" a1 "). Current Region .S pecialCells ( xlCellTypeLastCell ). Value gyo = gyo + 1 next です 。 
Active Cell . FormulaR 1 C1 に対して 関数 の 文字列 を 代入 し て い ます が 、 文字列 は ダブル クォーテーション （"） で くくっ て あり ます 。 しかし 、 文字列 の 途中 に も ダブル クォーテーション が ある こと から エラー に なり ます 。 文字列 の 途中 に ダブル クォーテーション が 入る 場合 は 、 ふたつ 重ね て 「""」 と する 事 で ひとつ の ダブル クォーテーション と 認識 し て くれ ます 。 したがって 、 次 の よう に 記述 し ます 。 Active Cell . FormulaR 1 C1 = "= IF ( ISERROR ( FIND ( CHAR ( 10 ), RC [- 30 ])),"""","" 改行 有 "")" 
クロス 集計 クエリ を 作成 し 、 製品 名 を 行 見出し 工程 順 を 列 見出し 工程 の 先頭 を 値 として 設定 し て ください 。 後 は この クエリ を Excel として エクスポート する か 、 単純 に 結果 を Excel に コピペ し て ください 。 
IE 操作 命令 だけ で は 取り出せ ませ ん 。 余計 な 文字 が どうしても つい て き ます ので 、 一旦 取り出し た 後 、 文字列 操作 命令 で 抽出 する 必要 が あり ます 。 msg = doc . getElementByID (" kabu _ ti "). InnerText p 1 = InStr ( msg , "[ 単 ]")+ 3 p2 = InStr ( msg , " 名 ")- 1 res = Mid ( msg , p 1 , ( p2 - p 1 )+ 1 ) 確認 し て い ませ ん ので 、 文字列 の 切り取り 位置 が 正確 か どう か は 分かり ませ ん 。 Mid ( 切り取り 対象 , 切り取り 開始 位置 , 切り取り 文字数 ) 書式 は こう なっ て いる ので 、 ずれ て い たら 調節 し て ください 。 
＞ A 列 に 記入 さ れ て いる 文字 を タイトル として PDF 出力 を 行い たい の です が 、 タイトル として 出力 と は ( 1 ) ヘッダー に する ( 2 ) ファイル 名 に する の どちら でしょ う か ？ わから ない ので 、 ヘッダー に 指定 し た うえ 、 ファイル 名 に し て い ます 。 （ ファイル 名 に は ". pdf " を 追加 し て い ます 。 以下 の サンプル で は 、 出力 する フォルダ は Const で 指定 し て い ます 。 やっ て いる こと は 、 ( 1 ) A 列 先頭 から 結合 セル なら 結合 し て いる 行 数 、 そう で なけれ ば 1 行 を 対象 と し ( 2 ) A ~ B 列 の 対象 行 数 を 印刷 範囲 に 指定 し 、 ヘッダー を 指定 （ ついで に 水平 方向 に 中央 寄せ ） ( 3 ) PDF 出力 ( 4 ) 対象 行 数 分 進め て ( 1 ) に 戻る サンプル （ 何 を やっ て いる か は コメント を 見 て ください ） Const outPath = " C :\ 出力 フォルダ \" Sub Sample () Dim i As Long Dim j As Long Dim m As Long ' 最終 行 を 求める m = Range (" A " & Rows . Count ). End ( xlUp ). Row ' 先頭 行 から はじめる i = 1 ' 終了 行 まで 繰り返す Do Until i > m With Range (" A " & i ) If . MergeCells Then ' 結合 セル なら 、 結合 さ れ て いる 行 数 を 控える j = . MergeArea . Rows . Count Else ' 結合 さ れ て い なけれ ば 行 数 は 1 j = 1 End If ' 印刷 範囲 、 ヘッダー 、 水平 方向 に 中央 寄せ ActiveSheet . PageSetup . PrintArea = . Resize ( j , 2 ). Address ActiveSheet . PageSetup . CenterHeader = . Value ActiveSheet . PageSetup . CenterHorizontally = True ' PDF に 出力 ActiveSheet . ExportAsFixedFormat Type := xlTypePDF , Filename := outPath & . Value & ". pdf " ' 行 数 分 進める i = i + j End With Loop End Sub 
> マクロ で 以下 のようなもの を 組ん だ の です が 、 これ だ と オート フィルター を > かける 範囲 が $ A $1 :$ U $100 1 を 超え た とき に うまく 作動 し なく なっ て しまう > ので 直し たい の です が 、 やり方 が うまく わから ず 困っ て い ます 。 よく やる 方法 として は 、 特定 の 列 の 最終 行 まで を 対象 と する 方法 です 。 ActiveSheet . Range ("$ A $1 :$ U $100 1 "). AutoFilter Field := 8 , Criteria 1 :=" AAA " ↓ With ActiveSheet . Range (. Range ("$ A $1 "), Range ("$ U $" & Rows . Count ). End ( xlUp )). AutoFilter Field := 8 , Criteria 1 :=" AAA " End With あるいは 有効 範囲 すべて を 対象 に する とか ActiveSheet . UsedRange . AutoFilter Field := 8 , Criteria 1 :=" AAA " 
単に Private Sub CheckBox 1 _ Click () If 条件 Then CheckBox . Value = False End If End Sub で は だめ な ん でしょ う か 。 
VBA で は 実行 し て いる モジュール の 情報 を 取っ て くる こと は でき ませ ん 。 単純 に Private Sub TextBox 2 _ Change () TextBox 3 = TextBox 2 . Name End Sub と する しか あり ませ ん 。 
細かい 仕様 が 不明 です が 、 商品 の 価格 マスタ が でき て いる という 事 です が 、 > １ ： 得意 先 毎 に 同じ 物 で も 販売 し て いる 物 の 単価 が 違う 。 は どの よう に し て いる の でしょ う か 。 また 、 商品 マスタ は 別に ある の でしょ う か 。 各 テーブル の 詳細 を 教え て ください 。 例えば 質問 の よう な 場合 は 、 商品 マスタ に 単価 を 持っ て いる けれど 、 特定 の 得意 先 の 特定 の 商品 は いくら だ と する 価格 テーブル を 別に 用意 し ます 。 また 、 ある 商品 の 単価 が 変わる と この 商品 の 特別価格 を 全て 変え なけれ ば なら ない ので 、 単価 で なく 、 価格差 を 持つ 方 が メンテナンス が 楽 に なる かも しれ ませ ん 。 価格 テーブル が ある だけ で 、 伝票 テーブル は 一般 的 な もの で いい と 思い ます 。 1 枚 の 売上 伝票 に 商品 は 1 個 だけ な の か 、 複数 な の か で 違っ て き ます が 、 通常 は 1 枚 の 伝票 に 1 得意 先 で 、 複数 行 の 商品 という こと だ と 思い ます 。 消費税 の 取り扱い によって テーブル の 内容 も 変わり ます が 、 簡単 に する ため に 全て 税込み の 場合 で 考え ます 。 その 場合 の テーブル の 例 です 。 [ 得意 先 マスタ ] 得意 先 コード : 長 整数 得意 先 名 : テキスト [ 商品 マスタ ] 商品 コード : 長 整数 商品名 : テキスト 通常 単価 : 通貨 型 [ 価格 テーブル ] 得意 先 コード : 長 整数 商品 コード : 長 整数 特別 単価 : 通貨 型 [ 伝票 見出し テーブル ] ID ： オート ナンバー 型 日付 ： 日付 型 得意 先 コード : 長 整数 [ 伝票 明細 テーブル ] 伝票 ID ： 長 整数 商品 コード : 長 整数 数量 ： 通貨 型 得意 先 マスタ 、 商品 マスタ 、 価格 テーブル は 一般 的 な フォーム で 作れる と 思う ので 以下 の よう な データ が 用意 さ れ て いる と し ます 。 [ 得意 先 マスタ ] 得意 先 コード , 得意 先 名 1 , あああ 2 , いいい 3 , ううう [ 商品 マスタ ] 商品 コード , 商品名 , 単価 1 , かか か , 100 2 , きき き , 200 3 , く くく , 300 [ 価格 テーブル ] 得意 先 コード 商品 コード 単価 1 , 2 , 50 1 , 3 , 40 2 , 3 , 30 ちなみに 価格 テーブル は " きき き " 商品 ( 商品 コード 2 ) は 200円 だ けれど 、 " あああ " 得意 先 ( 得意 先 コード 1 ) に は 50円 と し ます 。 " く くく " 商品 ( 商品 コード 3 ) は 300円 だ けれど 、 " あああ " 得意 先 ( 得意 先 コード 1 ) に は 40円 と し ます 。 " く くく " 商品 ( 商品 コード 3 ) は 300円 だ けれど 、 " いいい " 得意 先 ( 得意 先 コード 2 ) に は 30円 と し ます 。 と 言う 状況 です 。 伝票 見出 用 の クエリ と 伝票 明細 用 の クエリ を 作り ます 。 クエリ デザイン で 作る の です が 、 ここ で は 説明 が 難しい ので SQL ビュー の 画面 で 下記 の クエリ を 入力 し て ください 。 [ 伝票 見出 クエリ ] SELECT 伝票 見出し テーブル .*, 得意 先 マスタ . 得意 先 名 FROM ( 伝票 見出し テーブル INNER JOIN 伝票 明細 テーブル ON 伝票 見出し テーブル . ID = 伝票 明細 テーブル . 伝票 ID ) INNER JOIN 得意 先 マスタ ON 伝票 見出し テーブル . 得意 先 コード = 得意 先 マスタ . 得意 先 コード ; [ 伝票 明細 クエリ ] SELECT 伝票 明細 テーブル .*, 商品 マスタ . 商品名 , DLookUp ("[ 特別 単価 ]","[ 価格 テーブル ]","([ 得意 先 コード ]=" & [ Forms ]![ 伝票 フォーム ]![ 得意 先 コード ] & ") And ([ 商品 コード ]=" & [ 商品 マスタ ].[ 商品 コード ] & ")") AS 特別 単価 , IIf ([ 特別 単価 ]<> 0 ,[ 特別 単価 ],[ 標準 単価 ]) AS 単価 , [ 数量 ]*[ 単価 ] AS 金額 FROM 伝票 明細 テーブル LEFT JOIN 商品 マスタ ON 伝票 明細 テーブル . 商品 コード = 商品 マスタ . 商品 コード ; フォーム デザイン で 伝票 入力 フォーム を 作り ます 。 [ 伝票 明細 フォーム ] レコード ソース : 伝票 明細 クエリ 5つ の テキストボックス を 用意 し ます 名前 , コントロール ソース 商品 コード ： 商品 コード 商品名 ： 商品名 数量 ： 数量 単価 ： 単価 金額 ： 金額 商品名 、 単価 、 金額 の タブ ストップ を 「 いいえ 」 に し て ください 。 [ 伝票 フォーム ] レコード ソース : 伝票 見出 クエリ 3つ の テキストボックス と 、 サブ フォーム / サブ レポート と 、 コマンド ボタン を 用意 し ます 。 テキストボックス 名前 , コントロール ソース 日付 ： 日付 得意 先 コード ： 得意 先 コード 得意 先 名 ： 得意 先 名 得意 先 名 の タブ ストップ を 「 いいえ 」 に コマンド ボタン 名前 ： 登録 クリック 時 ： マクロ ビルダー ： レコード の 移動 ： 新しい レコード サブ フォーム / サブ レポート 名前 ： 伝票 明細 フォーム ソース オブジェクト ： 伝票 明細 フォーム リンク 親 フィールド ： ID リンク 子 フィールド ： 伝票 ID 
以下 の よう に 修正 Columns (" 2 :" & Col ). Delete ↓ Range ( Columns ( 2 ), Columns ( Col )). Delete 
セル の IF 関数 と 同じ で If Ａ = Ｂ = Ｃ Then という 書き方 は でき ませ ん 。 VBA なら ば If ( Ａ = Ｂ ) And ( Ａ = Ｃ ) Then に し ます 。 （ かっこ は 無く て も 大丈夫 です ） したがっ て 、 If Val ( TextBox 1 ) = Val ( Range (" H1 ")) = Val ( Range (" AA 3 ")) Then ↓ If Val ( TextBox 1 ) = Val ( Range (" H1 ")) And Val ( TextBox 1 ) = Val ( Range (" AA 3 ")) Then 
range 1 . Copy Range (" L 10 "). PasteSpecial Paste := xlPasteValues Application . CutCopyMode = False ↓ Range (" L 10 "). Resize ( range 1 . Rows . Count , range 1 . Columns . Count ). Value = range 1 . Value コピー 貼り 付け を し なく て も 、 この よう に Value プロパティ を 設定 すれ ば いい と 思い ます 。 
※ 指定 日 ( シート " A " の B2 の 日付 ） が シート A の A 列 に 該当 >> シート B の A 列 の ・ ・ ・ の 間違い で は ない です か 下記 の 表 です と 、 シート A の Ａ 2 ～ Ｋ 7 まで を 選択 し たい です >> そこ まで で よい の です か ? その あと は 自分 で コーディング する の でしょ う か 。 
ユーザー フォーム １ から ユーザー フォーム ２ を 開く 時 、 いきなり ユーザー フォーム ２ .S how と せ ず 、 一度 ロード し 、 値 を 入れ て から 表示 し ます 。 Load ユーザー フォーム ２ ユーザー フォーム ２ . コンボボックス １ . Value = Me . コンボボックス １ . Value ユーザー フォーム ２ .S how 
Sheets ( 1 ). Range (" A6 5535 "). End ( xlUp ). Offset ( 1 , 0 ). Select は A 列 の 最終 行 の 次 を 指定 する 分 です 。 １ 行 目 の 右端 を 指定 する なら Sheets ( 1 ). Cells ( 1 , Columns . Count ). End ( xlToLeft ). Offset ( 0 , 1 ). Select に 成り ます 。 
作業 用 の セル を 用いる 方法 が あり ます 。 ① D1 , E 1 , F1 と 同じ 行 で データ入力 に 差支え の 無い セル （ たとえば BZ 1 など ） の 幅 を D1 から F1 の 結合 さ れ た セル と 同じ 幅 に し ます 。 フォント や フォント サイズ も 同じ に し ます 。 ② BZ 1 に 「 = D1 」 という 数式 を 入力 し ます 。 ③ BZ 1 の 配置 を 「 折り返し て 全体 を 表示 する 」 に 設定 し ます 。 以上 で セル の 高さ が 自動 調整 さ れる はず です 。 
手動 で 設定 する と 、 ブラウザ で は Change イベント を 拾っ て いる はず です ので 、 その せい かも しれ ませ ん 。 Select 1 の 値 を セット し た 後 、 以下 の 方法 で 、 強制的 に Change イベント を 発生 さ せ て み て ください 。 また 、 下記 の 後 、 少し 待ち時間 を 作ら ない と いけ ない かも しれ ませ ん ( ログイン が 必要 な ので 、 こちら で は 試せ ませ ん )。 Set ev = objIE . document . createEvent (" HTMLEvents ") ev . initEvent " change ", True , True Select 1 . dispatchEvent ( ev ) 
Sub test () Dim i As Long With Selection . Areas If . Count <> 2 Then Exit Sub End If . Item ( 2 ). Resize ( 5 , 5 ). Interior . Color Index = xlNone For i = 1 To 25 If . Item ( 1 ). Resize ( 5 , 5 ). Cells ( i ). Value = . Item ( 2 ). Resize ( 5 , 5 ). Cells ( i ). Value Then . Item ( 2 ). Resize ( 5 , 5 ). Cells ( i ). Interior . Color = vb Yellow End If Next i End With End Sub 
こんにちは。 「 こんな こと が でき たら いい な 」 という 機能 の ほとんど は 、 基本 機能 の 組み合わせ で 、 なんとかなる 場合 が 多い です 。 マクロ を 使う の は 、 その 基本 部分 を 高速 に 処理 さ せ たい 、 という こと が 多い ん です 。 主 様 、 小額 の 費用 で 、 できる 、 と 考え て いる の が 、 間違い です 。 ビジネスモデル として は 今後 ある かも しれ ませ ん が 、 それ は 、 ボランティア で 作成 し た プログラマ に 、 チップ を 渡す 、 という よう な もの です 。 マクロ は 、 「 出来 て から 、 ユーザー の 手 に 渡り ます 」 ユーザー が 、 その マクロ を 理解 し ない と 、 正しい こと を し て いる の か 、 悪いこと を し て いる の か 、 分かり ませ ん 。 エクセル の 性能 限界 を 探す くらい 、 まず 、 調べ て ください 。 エクセル は 道具 です 。 結果 が 正しい の か 使う 側 で 理解 でき ない の は 、 関数 に し て も 、 信用 の ある ファイル と は 、 いえ ませ ん 。 
2016 で 追加 さ れ た textjoin 関数 の 出番 です ね 。 2013 以前 だ と 、 ユーザー 定義 関数 で 同様 の こと を ヤリ ます 。 配列 を 用意 すれ ば 区切り 文字 を 指定 し て 結合 出来る ので 、 rept 関数 を 使っ て 配列 を 生成 し ます 。 rept ( B $2 : I $2 , B 3 : I 3 ) B 列 から I 列 の 2 行 目 の 値 を 、 3 行 目 回 ずつ 返し ます 。 大昔 は これ で 暗黙 の 配列 として 扱え まし た が 今 は そう は いか ない ので index 関数 で 包ん で ちゃんと し た 配列 に し ます 。 index ( rept ( B $2 : I $2 , B 3 : I 3 ), 0 ) { 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 } という 配列 の 要素 を { 0 , 0 , 0 , 1 , 0 , 0 , 1 , 0 } 回 ずつ だ と 結果 は {"","",""," 4 ","",""," 7 ",""} と なり ます 。 これ を 指定 の 文字列 で 区切り ながら 空白 を 無視 し て 並べる の が textjoin 関数 。 

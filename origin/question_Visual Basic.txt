VBAでA列に3回連続、値が入力されたらユーザーフォームを呼び出したいのですがやり方が良く分かりません。VBA超初心者です。 どなたか教えて下さい。
VBAの書き方について質問です。 特定列のセルにおいて"5"が入力されたら、メッセージが出るようにしたいのですが。。それもマクロを実行して初めて出るのではなく、 入力した際に出るようにしたいのですが、 どういうコードを書けばいいのでしょうか？？ いろいろ調べたのですが、うまくいかないので教えていただけないでしょうか。 例）A列の○の箇所に数値が入力されたときにそれぞれメッセージを出したい。 （A,１）に５が入力されたときにメッセージ （A,２）に５が入力されたときにメッセージ・・・ 列 A B C D 行 １ ○ ２ ○ ３ ○ ４ ○
VB 多重不定ループの組み方を教えて下さい。 文字列の順列列挙をVBで組もうとしています。その際桁数が3桁ならば三重ループを、4桁ならば四重ループで列挙するプログラムを組まなければならない事はいろいろ検索して分かりました。 しかし対象桁数が不定である場合の不定多重ループの組み方が分かりません。 例えば、ForーNext や DoーLoop 等のループ構造を動的に組む方法を教えて下さい。 宜しくお願いします。
VBのデバッグテクニックを解説したサイトを教えてください。
エクセルVBAを教えてください。 データベース作成しているのですが、データ入力を効率よく進めたいと思っております。 そこで、例えば、エクセルシートに入力済みのデータ５０件があるとします。・A列にはIDナンバーがふられております。 ・セルB１には、＝now()として、時刻が表示されています。 で、B列の５１件目に時刻を入力したいのですが、VBAを使ってマクロで処理したいんです。 ①セルB１を選択 ②セルB１をコピー ③そのまま、エクセルダウンでデータの一番下まで移動。 ④そこから、オフセットでセル１個ぶん、下のセルに下がり、未入力のセルに移動したい。 ⑤コピーしたセルB１を値として貼り付けたい 我流で、試みておりますが、うまくいきません。 どなたか、このVBAを教えてくださる方いらっしゃいませんか？ お願いします。
全くの初心者ですが、エクセルVBAをこの本で学んでいます。ネットで調べればできるよ！とか周りには言われたりしてますか、 そのレベルになるにはどの程度できるようになればいいのでしょうか？ この本で勉強中です。 今、ちょうど100ページちょいの変数についてです。
Sheet1からマクロを実行し、外部（ネット）ファイルをオープン 其の中のデータをSheet2に、コピー アンド ペーストします。この時、マクロには「Application.ScreenUpdating = False '画面表示をしない」を 設定しているにも関わらずSheet1の画面が処理終了まで暗転してしまいます。 これを解決出来る方法が有ればご教授頂ければ助かります。 又、外部（ネット）ファイル読み込み時のタイトルバーも表示させたくないのですが 何か方法は有るのでしょうか。
VBAで Classを使用し、 引数/戻り値？が複数ある場合、どう記載すればいいのでしょうか？よろしくお願いします。 例えば下記のような場合などMsgBox cc.chcountでエラーが発生します。 モジュール側 Public txt As String, abc As Double Sub Sample01_Class1() Dim cc As New Class1 txt = "長谷川" abc = 100 cc.AddNumber txt, abc abc = 0.1 cc.AddNumber txt, abc MsgBox cc.retNum MsgBox cc.chcount Set cc = Nothing End Sub Class側 Public retNum As Double 'クラスのメソッド Public Sub AddNumber(txt, num) '引数 num が数値の場合、その値を加算 If IsNumeric(num) Then chcount = Len(txt) retNum = retNum + num + chcount End If End Sub
Excel VBAのコピー貼り付けについて質問です。 宜しくお願い致します。シート（A3：C3）をコピーして、その下に値を連続で貼り付けていきたいのですが、D列のセルにデータがある行まで貼り付けを行うにはどうすればよろしいですか？ D列のデータは不定数なのですが、設定の仕方が分からず質問させていただきました。 ご回答の程、宜しくお願い致します。
VBAを利用したフォルダ内にあるCSVファイルの統合について 取得したCSVファイルのデータを、同一シートにまとめたいと考えております。以下のコードによって実行する事は可能ですが、その他下記の2点が改善されればと思っております。 VBAに詳しい方、ご教示のほど宜しくお願い致します。 ①処理を実行したいフォルダの場所が指定出来る事。 ②1行目は項目となる為、2つ目以降のファイルについては2行目からデータの取り込みが出来る事。 Sub test1() Dim myPath As String Dim myFile As String Dim s As String myPath = ThisWorkbook.Path & "\" On Error Resume Next Kill myPath & "test.csv" On Error GoTo 0 myFile = Dir(myPath & "*.csv") If myFile = "" Then Exit Sub Open myPath & "out.csv" For Output As #1 Do Until myFile = "" Open myPath & myFile For Input As #2 Do Until EOF(2) Line Input #2, s Print #1, s Loop Close #2 myFile = Dir() Loop Close #1 End Sub
VBAを利用したフォルダ内にあるCSVファイルの統合について 取得したCSVファイルのデータを、同一シートにまとめたいと考えております。以下のコードによって実行する事は可能ですが、その他下記の3点が改善されればと思っております。 VBAに詳しい方、ご教示のほど宜しくお願い致します。 ①処理を実行したいフォルダの場所が指定出来る事。 ②1行目は項目となる為、2つ目以降のファイルについては2行目からデータの取り込みが出来る事。 ③処理終了後の保存先とファイル名が指定出来る事。 Sub test1() Dim myPath As String Dim myFile As String Dim s As String myPath = ThisWorkbook.Path & "\" On Error Resume Next Kill myPath & "test.csv" On Error GoTo 0 myFile = Dir(myPath & "*.csv") If myFile = "" Then Exit Sub Open myPath & "test.csv" For Output As #1 Do Until myFile = "" Open myPath & myFile For Input As #2 Do Until EOF(2) Line Input #2, s Print #1, s Loop Close #2 myFile = Dir() Loop Close #1 End Sub
エクセル マクロ コピー後のシート名変更について左から順に予約表(土)、予約表(金)、予約表(木)、予約表(水)、予約表(火)、予約表(月)のシートがあり、一番左にある予約表(土)のシートのC2の値をひろって、その値を各予約表のC2に+2（日曜のシートを作成しないため、土曜の値に+2をして月曜の値としている）をしたいのですが、なぜか一番右の予約表(月)シートのC2かもしくはコピーした予約表(月)シートのC2の値をひろってしまいます。 どこの場所が間違っているのでしょうか？ 下記に書いたマクロの修正箇所を教えて頂きたいです。 ちなみに投稿者はエクセル、マクロともに初心者です。 下記のマクロに Dim x As Long x = Sheets.Count を加えて、Sheets(1)をSheets(x)に変えてみましたが、それもだめでした。 （この点は関係ないと思いますが、一応） 各シートの C2にはyyyy年mm月dd日aaaaの表示 Y5には同シートC2の値をmm月dd日(aaa)の表示に分けています。 Sub シートコピー() Dim dt As Date dt = Sheets(1).Range("C2") Sheets(Array("予約表(土)", "予約表(金)", "予約表(木)", "予約表(水)", "予約表(火)", "予約表(月)")).Copy Before:=Sheets(1) Sheets("予約表(月) (2)").Range("C2") = dt + 2 Sheets("予約表(火) (2)").Range("C2") = dt + 3 Sheets("予約表(水) (2)").Range("C2") = dt + 4 Sheets("予約表(木) (2)").Range("C2") = dt + 5 Sheets("予約表(金) (2)").Range("C2") = dt + 6 Sheets("予約表(土) (2)").Range("C2") = dt + 7 Sheets("予約表(月) (2)").Name = Sheets("予約表(月) (2)").Range("Y5").Text Sheets("予約表(火) (2)").Name = Sheets("予約表(火) (2)").Range("Y5").Text Sheets("予約表(水) (2)").Name = Sheets("予約表(水) (2)").Range("Y5").Text Sheets("予約表(木) (2)").Name = Sheets("予約表(木) (2)").Range("Y5").Text Sheets("予約表(金) (2)").Name = Sheets("予約表(金) (2)").Range("Y5").Text Sheets("予約表(土) (2)").Name = Sheets("予約表(土) (2)").Range("Y5").Text End Sub ご指導、ご鞭撻の程、宜しくお願い致します。
マクロ初心者です。 エクセルから自動ＰＤＦを作りたいので自動記録を利用したのですがファイル名でつまずいてしまいました。店舗コードどこを直したらいいですか？エクセル2007です。 1234（得意先コード）-（”Ｐ5”）（店舗コード） 店舗コードはセルＰ5に数値入力されてます。（vlookupで引用） Sub PDF出力() ' ' PDF出力 Macro ' ' Keyboard Shortcut: Ctrl+i ' ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _ "C:\Users\Pc-User\Desktop\【請求書】1234-（”Ｐ5”）.pdf", Quality:=xlQualityStandard, _ IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _ True End Sub 宜しくお願いします。
VBAを利用したCSVファイルの取り込みについて、3度目の質問投稿になります。 前回、前々回と回答くださった皆様ありがとうございました。以前質問としましては、以下のダブルクォーテーションを削除するVBAを作成したいという内容でした。 商品名 " 仕入価格" 市場価格（A店） 市場価格（B店） ラジカセ " 8600" " 10565" " 14200" 電子辞書 " 5000" " 6200" " 6200" ドライヤー " 3000" " 4212" " 4212" 体重計 " 2380" " 3999" " 3999" トースター " 3400" " 3830" " 4940" コーヒーメーカー " 3600" " 3850" " 5837" 掃除機 " 7100" " 5250" " 9359" テレビ " 18000" " 20980" " 20980" 扇風機 " 12500" " 14090" " 16300" 机 " 16000" " 16180" " 18980" 前回、回答頂いた内容で正常に起動する事が出来たのは以下のコードだったのですが、こちらのコードはマクロを記述したブックと同一のフォルダにある「test.csv」というCSVデータを開くことが前提とされています。 今回、質問したい内容としましては処理を実行したいファイルを自分で選択指定ができる様にしたいと考えております。 VBAに詳しい方、再度ご教示のほど宜しくお願い致します。 Option Explicit Sub Sample() Dim bk As Workbook, st As Worksheet Dim fn As Integer, data As String Dim items() As String, item As String Dim r As Long, c As Long Set bk = Workbooks.Add Set st = bk.Worksheets(1) 'CSVファイルを開く r = 1 fn = FreeFile Open ThisWorkbook.Path & "\" & "test.csv" For Input As #fn Do While Not EOF(fn) 'ファイルを一行ずつ読み込む Line Input #fn, data 'カンマで区切って配列に格納する items = Split(data, ",") '配列の要素ごとに繰り返す For c = 0 To UBound(items) item = items(c) 'ダブルクォーテーションを削除する item = Replace(item, Chr(34), "") 'Tabコードを削除する item = Replace(item, vbTab, "") 'セルに書き込む st.Cells(r, c + 1).Value = item Next c r = r + 1 Loop Close #fn End Sub
Excel VBA での記入 A2セルから下の行へ自動で1.2.3.4.5…と表示させるコードは？Excelのマクロを勉強しております。当方初心者です。 ExcelのA2,A3,A4,A5,A6,A7セルに、自動で1.2.3.4.5.6と表示させるにはどのようにコードを書けばいいのでしょうか？ 現在以下のようにコードを書いているのですが、これだとA1セルから順に表示されてしまいます。 スタートをA2セルにしたいのですが、試行錯誤してうまくいきません。 Cellsのあとをいじるのかな？という気はしていますがいかがでしょうか？ 教えてください。 Sub ExitFor() Dim A As Integer Worksheets("Sheet1").Activate For A = 1 To 10 Worksheets("Sheet1").Cells(A, 1) = A If A = 6 Then Exit For End If Next End Sub ちなみに、 Sub test1() Range("A2").Value = "1" Range("A3").Value = "2" … のようには記入したくありません。 これしか方法がなければ致し方ないのですが… 宜しくお願い致します
エクセルのマクロのことで質問です。 自分で調べ、オートフィルターで絞り込んだリストの中で重複をカウントしないでデータの件数を数えるのに、 エクセル上での式はわかりました。しかしマクロ上でEVALUATEを使用してメッセージボックスに件数を表示させようとすると、 型が違うとエラーになってしまいます。 msgbox(Evaluate("=SUMPRODUCT((B2:B62<>""[?]"")*SUBTOTAL(3,INDIRECT(""D""&ROW(B2:B62)))/COUNTIF(B2:B62,B2:B62))")) どうしてエラーになってしまうのでしょうか？ また、何か良い方法はありますでしょうか。 できればセルに入力したり作業列を使ったりしないで処理したいのですが…
部分一致の値の並べ替え作業についてです。 諸事情から添付画像の様な表を編集しています。Ａ列：氏名 Ｂ列：不規則なファイル名（氏名は必ず入っている） Ａ列を基準にＢ列を並べ替えて、氏名とファイル名が対応している状態にしたいのですが、 ＶＬＯＯＫＵＰを使っても、ＦＡＬＳＥで参照されないことは勿論、ＴＲＵＥでも違うセルが参照されてしまいます。 単純に並べ替えを使うと数値は不規則、役職が先だったり、氏名が先だったりで、並べ替え条件が纏まりません。 データは300以上あるのですが… ワイルドカードを使えば上手くいくのでしょうか？ ＦＩＮＤ関数？ ゆくゆくはこれを利用してファイルをリネームするつもりです。 お知恵をお貸し下さい。
現在、VBAのUserFormでtenkeyを作りTextBox内に表示させるものを作っています。しかし、.(小数点)の入力が上手く行きません。 小数点を入力出来るようにするには、どうすれば良いでしょうか？ ご教示お願い致します。
以前、別の人がVBAで作ったデータを入力し更新ボタンを押すと、平均や誤差などの計算、グラフの描写などを行うプログラムがあります。業務命令でこのプログラムを改良しなければならないのですが、ボタンを押すと更新するマクロが何処を探しても見つからず困っています。 具体的には、ボタンを押すと更新していたものを定期的に自動更新させたいのです。 また、sheet1に描写されたグラフをsheet2に移したいのですが、 sub graph() Sheets("01").Activate ActiveSheet.ChartObject("graph2").Activate ActiveChart.ChartArea.Copy Sheets("02").Activate ("A3").Select ActiveSheet.Paste End Sub でコピーする形を取っています。 しかし、これだと更新する度にグラフが増えるてしまいます。 前回描写されたグラフを消すか、もっと良い方法を教えて頂けないでしょうか？ 宜しくお願い致します。
Crystal Report 2013 ズームのユーザ設定について 現在、以下の環境にてプログラムを作成しています。OS：Windows10 IDE:Visual Studio 2015 帳票:Crystal Report 2013 SP16 通常であれば、CrystalReportViewerのツールバーに並んでいるズームボタンからユーザ設定を選択すると、ズームダイアログが表示されます。 作成したプログラムでは、3つの画面をレイアのように表示しています。 ①テキストボックスやボタンを配置した画面 ②「処理中です」と表示するためだけの画面 ③CrystalRportsViewerの画面 ①の上に②を表示し、その上に③を表示するようなイメージです。 この状態で上述のズームダイアログを表示させると、ズームダイアログが①と②の間に表示されてしまいます。 ズームダイアログを③の上に表示させる方法はないでしょうか？ ちなみに②と③の画面は、表示させる際にTopMostプロパティをTrueに設定しています。
マクロについて教えて下さい。 複数のCSVファイルの11行目以降を、sheet1に読み込みたいのですが マクロが分かりません。 皆様のお力をお貸し下さい。
下記プログラムをサブフォルダを含めたファイル一覧を取得するプログラムに変更したいのですが どうしたらよろしいのでしょうか。 ご教授ください。Sub main() Dim fld As FileDialog Dim fd_path As String Dim fl_name As String Dim i As Long Set fld = Application.FileDialog(msoFileDialogFolderPicker) 'キャンセル時にマクロ終了 If fld.Show = 0 Then Exit Sub 'フォルダのフルパスを変数に格納 fd_path = fld.SelectedItems(1) '指定されたフォルダの一つ目のファイル名を取得 fl_name = Dir(fd_path & "\*") If fl_name = "" Then MsgBox "ファイルが存在しません。": Exit Sub Worksheets.Add Before:=Sheets(1) Range("A1").Value = fd_path Range("A2").Value = "のファイル一覧" Range("A4").Value = "ファイル名" Range("B4").Value = "最終更新日時" Range("C4").Value = "パス" i = 5 ChDir fd_path & "\" 'カレントフォルダの変更 Do Until fl_name = "" Cells(i, "A").Value = fl_name Cells(i, "B").Value = FileDateTime(fl_name) Cells(i, "C").Value = fd_path i = i + 1 fl_name = Dir '次のファイル名を取得 Loop MsgBox Sheets(1).Name & "に一覧を作成しました。" End Sub
ExcelのVBAでVLOOKUPのようにデータの抽出 抽出元シート：DATA 抽出先シート1：りんご 抽出先シート2：バナナ 抽出先シート3：時計 抽出先シート4：ネクタイ元シートのDATAには A列：りんご、バナナ、時計、りんご、ネクタイ、時計、時計、バナナ B列：果物、果物、小物、果物、小物、小物、小物、果物 C列～E列：適当な数値 A列と同名の各抽出先シートへデータの追加を行いたいのですが、 やり方が分からず難儀しています。
VBA初心者です。 他の人がVBAで作ったグラフを別のシートに移動させたいのですが、どのようにしたら良いか分かりません。 どなたか教えて下さい。
EXCELで特定の行を削除するVBAのコードについて EXCELで特定の文字列を含む行を削除して、上に詰めるVBAについてお助けください。Ａ列 Ｂ列 Ｃ列 100 ABC 111 200 @ABC 222 300 @ABC 333 400 ABC 444 上記のようなデータがあった場合、 Ｂ列の「＠」が先頭にある行を削除して、 上に詰めたいんですが、 どういったVBAになるんでしょうか？ １．Ｂ列の左から１番目の文字列が「＠」かどうかを判定 ２．「＠」がある場合、その時の行数を取得 ３．取得した行数の行を削除、上に詰める ４．データの入っている行（２行目～最終行）まで繰り返し といった感じになるとは思いますが、具体的なコードは どういうものが考えられるでしょうか。 アドバイスいただけましたら助かります。
転職してプログラマの職について会社でVB6を勉強中なのですが 家でVB6を導入するのは少々難しく 自宅でVBAエキスパートの資格取得の勉強しようと思うのですがどうでしょうか？VBAってVB6と似てるんですよね？
昨日もVBAについて質問させていただきましたVBA初心者です。（http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1116308097...） 詳しくは上記URLを参照していただけると助かります。 簡潔に説明させていただくと、 ①ブック内にある30以上のシートのシート名を各シート、A1セルからシート名を取得したい。 ②できれば、各シートのA1セル内容を管理している専用シート内にマクロ登録したボタンを設置し、ボタンを押せば反映されるようにしたい、という質問をしました。 本日、ベストアンサーの回答にあったマクロを標準モジュールに引用したところうまくでき大満足でした。 しかし、第三者からの要望で「反映されたか、わからない」「わざとエラーを出したら、よくわからない画面（標準モジュール）が開いた」などがありました･･･。（細かい第三者がいるもので、すいません・・・。） そこで引用したマクロにMsgBoxを用いた質問とエラーの場合のメッセージなどを追加したのですが、なかなかうまくいきませんでした。 今回は下記マクロにMsgBox関連のコードを追記していただきたいと考えています。 -------------------------------------------------------------------------------------------------------------------------------------- Sub sample() Dim sh As Worksheet, xAry, i xAry = Array("Sheet1", "Sheet3") '★ For Each sh In Worksheets With sh i = Application.Match(.Name, xAry, 0) If IsError(i) Then .Name = .Range("A1").Value End If End With Next sh End Sub -------------------------------------------------------------------------------------------------------------------------------------- 上記のマクロに追記していただきたい項目は次の通りです。 ① 全てのシートにA1セルの内容を反映させますか」の質問と「はい」「キャンセル」の回答をメッセージボックスに表示。 ② 「はい」を押して全てのシートの反映に成功した場合、「反映処理が完了しました」のメッセージボックスを表示。 ③ 「はい」を押して、シートの名前かぶりなどエラーがあった場合は「一部の反映処理に失敗しました」もしくは「反映処理にエラーがありました」とメッセージボックスを表示 ④ 実のところ自分で②③までの内容を試みたのですが、シートの数だけ「反映処理が完了しました」というメッセージボックスが出てきました。何度も出てきて煩わしいので、できればメッセージの表示は1度で済ませたいと思います。（シート名変更のマクロが全て終了してから、「成功」「失敗」ともに結果に応じたメッセージを1度だじぇ表示したいということです） ⑤ 「キャンセル」を押した場合は「キャンセルしました」のメッセージボックスを表示。 ⑥ すべてのメッセージボックスに「シート名の変更」のタイトルを表示。"：Title="シート名の変更"で試みました。 以上になります。 とてもボリュームの多い内容で既存のマクロだけを活かしつつというのは難しいかもしれませんが、よろしくお願いします。 ベストアンサーの方にはコイン500枚贈呈させていただきます。 何卒よろしくお願い申し上げます。
Excel VBAを使用して、指定先セルのコピーをし、そのコピー内容を検索（指定列にて）、ヒットしたセルの右に1、2セルに指定先セルの右1,2内容をコピーして貼り付けが可能かどうか。 わかりづらくてすみません。。添付のExcel画像より判断していただきたいのですが、 F11セル内容を、A列より検索し 該当セルの右に1、2セルに、 F11セルの右1、2セル内容を貼り付けたいのです。 ※F11・G11・H11セルは常に固定 ※A列は2000行ほどあります ①F11セルコピー ②F11セル内容をA列から検索 ③検索該当セル（添付の場合、A2セル）の右1、2セル（B2,C2）に、 G11,H11セル内容（甲子園、ホームラン）を挿入 オフセットを利用したいです。 可能でしょうか。 お手数おかけしますが、よろしくお願いいたします。
VBAで質問します リストボックスの更新のコードを探しています 今、品種更新のプログラムを作っています。 変更した物をシートへの入力はできました。 あとは、リストボックスの更新が出来ません。プログラム Dim 行 As Integer Dim e As Integer 行 = ListBox1.ListIndex With ListBox1 Integer 行 = -1 行 = e End With 実行すると、リストボックスの更新できませんでした。 なんでだろうか、ネットで調べたら、 Repaint メソッドは、指定されたフォームに対して、画面の更新操作がある場合はそれを実行します。また、Repaint メソッドは、更新に伴って、フォーム上のコントロールの再計算も行いますと書いてありました。 もしかしたら、リストボックスの更新も出来る事と思って UserForm1.Repaint 実行すると、リストボックスの更新できませんでした 誰か教えて下さい。よろしくお願いします。
VB6.0のSPバージョンはどこで調べればよいのでしょうか？
【至急】【VBS】 IF文での比較が何故か上手くいかない！【HTA】 お世話になっております。 HTA画面上のデータを .innertextで取得し配列に格納。DATA_A() そして、それを別に使いたいため、別の配列にも同じデータを格納 DATA_B() STARTDATA() ENDDATA() やろうとしていることは以下のような形です。 For i=0 to UBOUND(DATA_B) For j=0 to UBOUND(DATA_B) If STARTDATA(i) < DATA_B(j) and DATA_B(j) < ENDDATA(i) then Msgbox ENDDATA(i) & ">" & DATA_B(j) DATA_A(i)=DATA_B(j) Exit for Elseif ENDDATA(i) < DATA_B(j) then Msgbox ENDDATA(i) & "越えちゃったよ！" & DATA_B(j) Exit for End if Next Next DATA_BがSTARTDATAとENDDATAの間にあるか確認し、 あればDATA_AにDATA_Bのデータを入れる。 無ければ、DATA_AにはSTARTDATAの値を入れる。 STARTDATA{50000,70000,90000} ENDDATA{60000,80000,99999} DATA_A{0,0,0} DATA_B{40000,80000,88000} 上記のようなデータが入っている場合でも 60000越えちゃったよ！40000 のように表示されます。 比較を一切していないように思えます。 何か間違えているのでしょうか? 1時間悩み、色々試してみてますがもう限界です…
VBAについて質問です。 以下のマクロを実行すると、抽出したいシートとSheet1の2個ができてしまいます。 抽出したいシートのみのブックを作成するには、どのように変更すればよいでしょうか？お知恵をお貸しください。 よろしくお願いいたします。 Sub splitBook() Application.ScreenUpdating = False Const path As String = "C:\Users\...." Dim bk As Workbook Set bk = ActiveWorkbook Dim st As Worksheet For Each st In bk.Sheets Workbooks.Add st.Copy Before:=ActiveWorkbook.Sheets(1) ActiveWorkbook.SaveAs path & st.Name & ".xlsx" ActiveWorkbook.Close Next Application.ScreenUpdating = True End Sub
EXCEL VBA の動作がおかしいのですが。 CELLに代入する行を入れるとEXIT FOR されずプロシージャ が終了してしまいます。 入れなければ正常にEXIT FOR されます。私にはなぜだかわかりません。 WINDOWS７、EXCEL２０１３です。よろしくお願いいたします。 Sub testx() Dim i As Long Dim j As Long Dim a As Long For_ i = 1 To 5 For_ j = 1 To 5 If _ j = 3 Then a = a Cells(1, 1) = Cells(i, j) Exit For End If Next j Debug.Print_ i, j Next i End Sub *** "_"はスペースの代わりです。
ＶＢＡ 「＊」が含まれている行を削除する方法 「12345 *あいうえお」のようにセルに「＊」を含む文字列の行を削除できればと考えています。下記のように作成すると全てのセルが削除されてしまいます。どのように改善すればよいのでしょうか・・・。ご教示よろしくお願い致します。 For i = Cells(Rows.Count, 2).End(xlUp).Row To 10 Step -1 If Cells(i, 1) Like "***" Then Range(i & ":" & i).Delete End If Next i
エクセルマクロで重複箇所を削除できるでしょうか？B～D列で重複している番号を1つ残して、消したいです。 条件がA列で同じ番号の場合で。 B～D列それぞれの列で重複している個所を消します。条件は全て一緒でA列で同じ番号です。 ㅤㅤㅤAㅤㅤㅤㅤㅤㅤBㅤㅤㅤㅤㅤㅤ CㅤㅤㅤㅤㅤㅤDㅤㅤㅤㅤㅤㅤE 1ㅤㅤㅤ33 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 2ㅤㅤㅤ33 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 3ㅤㅤㅤ55 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 4ㅤㅤㅤ55 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 5ㅤㅤㅤ33 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 6ㅤㅤㅤ11 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 7ㅤㅤㅤ88 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 8ㅤㅤㅤ77 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 9ㅤㅤㅤ99 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 結果こうなりたいです。 ㅤㅤㅤAㅤㅤㅤㅤㅤㅤBㅤㅤㅤㅤㅤㅤ CㅤㅤㅤㅤㅤㅤDㅤㅤㅤㅤㅤㅤE 1ㅤㅤㅤ33 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 2ㅤㅤㅤ33 ㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤ ㅤㅤ ㅤㅤㅤㅤㅤ ㅤㅤㅤㅤㅤ100ㅤㅤ ㅤㅤㅤㅤㅤㅤ 3ㅤㅤㅤ55 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 4ㅤㅤㅤ55 ㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤ ㅤㅤ ㅤㅤㅤㅤㅤㅤ ㅤㅤㅤㅤ100ㅤ ㅤㅤㅤㅤㅤㅤ 5ㅤㅤㅤ33 ㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤㅤ ㅤㅤ ㅤㅤㅤㅤㅤㅤ ㅤㅤㅤㅤ100ㅤ ㅤㅤㅤㅤㅤㅤ 6ㅤㅤㅤ11 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 7ㅤㅤㅤ88 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 8ㅤㅤㅤ77 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100 9ㅤㅤㅤ99 ㅤㅤㅤㅤ500ㅤㅤㅤㅤㅤ 400 ㅤㅤㅤㅤㅤ300 ㅤㅤㅤㅤ100
Visual Basicについてわからないことがあったため質問させていただきます。VBでWebbrowserで表示させたHTMLの中のアンカータグ(<a>)に指定時間(2秒間)マウスオーバーすると MsgBoxを表示させることは可能でしょうか？ 初心者で初歩的な質問申し訳ございません。 ご教示いただければ嬉しい限りです。
TwitterのユニークID（数列）とアカウントID（＠以下のアルファベットID）を紐づけしたい こんにちは。Twitterのフォロワーリストを分析利用したいと思い、PHPツールを利用してユニークIDを抽出することに成功しました。（URLはそのサンプルです） https://docs.google.com/spreadsheets/d/1lI6gX5xp06jRVlsu79KiQM8sGKh... これでも十分便利なのですが、ユニークIDだと誰が誰だかわからないためユーザーIDとアカウント名を一緒に表示させたいのですがどうすればいいのかわかりません。 上のURLのファイルを例にするとC、Dの列にそれぞれユーザーIDとアカウント名が表示出来たら良いのですが、どう処理したら良いのか教えて頂きたいです。 excel vbaでこう処理したらいい、などの設計のアドバイスだけでも助かります。 どうぞよろしくお願いします。
Accessでのテキストファイルのインポートについて １．ボタンを押すとダイアログを表示 ２．ダイアログからテキストファイルを一度に複数インポートする下記のコードですと、１つしかインポートできません。 もし、下記のコードをベースに複数のテキストファイルをインポートする 方法があればご教授お願い致します。 Private Sub コマンド0_Click() Dim fDialog As Object Dim Rst As DAO.Recordset Dim file As String Set fDialog = Application.FileDialog(3) fDialog.InitialFileName = "指定のパス" fDialog.Show file = fDialog.SelectedItems(1) 'DoCmd.TransferText acImportDelim, "新しいテキスト ドキュメント インポート定義", "T1", vpath, False End Sub
会社で以下のようなマクロを使っています。これからVBAを勉強していくつもりなのですが、まずは身近なところのマクロを理解しようと思いました。中身は、工具名称と固有番号の重複確認をして重複していれば対応するセルを赤色に染めるというものです。 簡単で良いので1行づつ説明文を付け足していただけますでしょうか。プロのエンジニアの方々、よろしく御願いします。 Sub 名称ミスCHK() Dim Dic As Object Dim TgRng As Range Dim Rng As Range Dim FRng As Range Dim Fst As String Set Dic = CreateObject("Scripting.Dictionary") Set TgRng = Range("D4", Cells(Rows.Count, 4).End(xlUp)) TgRng.Interior.ColorIndex = xlNone For Each Rng In TgRng If Rng.Value <> "" Then If Dic.Exists(Rng.Value) Then If Dic.Item(Rng.Value) <> Rng.Offset(, 1).Value Then Rng.Interior.ColorIndex = 3 Set FRng = TgRng.Find(Rng.Value, Lookat:=xlWhole) If Not FRng Is Nothing Then Fst = Rng.Address Do FRng.Interior.ColorIndex = 3 Set FRng = TgRng.FindNext(FRng) Loop Until FRng.Address = Fst End If End If Else Dic.Item(Rng.Value) = Rng.Offset(, 1).Value End If End If Next MsgBox "ツール重複チェック完了。", vbInformation Set TgRng = Nothing Set Dic = Nothing End Sub
セルの連結で文字列を含むとき「オブジェクトは、このプロパティまたはメソッドをサポートしていません」と エラーが出てしまいます。文字列を含む場合はこういったエラーが出ると解説しているサイトをいくつか参考にしたのですが解決しません。 セルA1に、F1のセル（文字列）と、テキスト”-”と、H1のセル（文字列）とR1のセル（数値です。これを10倍します。）を結合したものを入れて、B列の最下部までコピーしたいです。 最初は関数の代入をしたのですが、型が一致しないとエラーになりました。 Range("A1").String = "=F1&" - "&H1&(R1*10)" お知恵をおかしください Sub A列関数を下までコピー() Range("A1").String = Range("F1").String & "-" & Range("H1").String & Range("R1").Value * 10 Range("B1", Range("B" & Rows.Count).End(xlUp)).Offset(, -1).Formula = _ Range("A1").Formula End Sub
VBA初心者です。 A1セルからシート名を取得するためにQ＆Aサイトで見つけた以下のマクロを標準モジュールにコピペしました。 ボタンも作成し、シート名を取得することはできたのですが・・・。できれば、全シートが1つのボタンで各シートのA１セルからシート名を取得したいと考えています。 VBA初心者のため不案内ですが、どなたかご教授いただければ幸いです。 ちなみに使用したマクロは以下の通りです。 ベストアンサーの方にはコイン500枚贈呈します。 何卒よろしくお願いします。 Option Explicit Private Sub Workbook_sheetChange(ByVal Sh As Object, ByVal Target As Range) If Target.Address = "$A$1" Then Sh.Name = Target.Range("A1").Value End Sub Public Sub Sheetname() ActiveSheet.Name = Range("A1").Value End Sub
VBで質問があります。 C言語のグローバル変数のように、どの関数からも読み書きが出来る変数の宣言ってどうやって処理したら宜しいでしょうか？
【HTA】モーダルウィンドウのソース、どこが間違えているのか分からない【VBS】 <html> <head> <title>Modeless Dialog</title><HTA:APPLICATION APPLICATIONNAME="Processes"> </head> <body> <span id="DataArea"></span> <input type="button" value="はい" onClick="CloseDO()"/> <script type="text/vbscript"> <!-- Sub Window_OnLoad DATA = window.dialogArguments DATA=Replace(DATA,")(","</TD><TD>") DATA=Replace(DATA,"((","<TABLE>") DATA=Replace(DATA,"))","</TABLE>") DATA=Replace(DATA,"(","<TR><TD>") DATA=Replace(DATA,")","<TD></TR>") DataArea.InnerHTML = DATA End Sub Sub CloseDO Msgbox "クローズ！" window.close End Sub --> </script> </body> </html> 「はい」ボタンを押しても、何も動作しません。 何が悪いのでしょうか? Onloadも読まれていないようです。
Excel VBA マクロ お詳しい方へ質問です。 Excelの初心者です。マクロ処理にかなりの時間がかかっているモジュールを簡素化（コードの省略）させたいのですが、ご教授をお願いいたします。コードは次の通りです。 Sub Macro3結果の右ズラし() ' ' Macro3結果の右ズラし Macro ' ' ActiveWindow.SmallScroll Down:=6 ActiveWindow.ScrollColumn = 22 ActiveWindow.ScrollColumn = 23 ActiveWindow.ScrollColumn = 25 ActiveWindow.ScrollColumn = 23 ActiveWindow.ScrollColumn = 22 Range("AA15:AA26").Select Selection.Cut Range("AF15:AF26").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=285 Range("AA295:AA306").Select Selection.Cut Range("AF295").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=276 Range("AA575:AA586").Select Selection.Cut Range("AF575").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA855:AA866").Select Selection.Cut Range("AF855").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=279 Range("AA1135:AA1146").Select Selection.Cut Range("AF1135").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=279 Range("AA1415:AA1426").Select Selection.Cut Range("AF1415").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA1695:AA1706").Select Selection.Cut Range("AF1695").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA1975:AA1986").Select Selection.Cut Range("AF1975").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=276 Range("AA2255:AA2266").Select Selection.Cut Range("AF2255").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA2535:AA2546").Select Selection.Cut Range("AF2535").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=279 Range("AA2815:AA2826").Select Selection.Cut Range("AF2815").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA3095:AA3106").Select Selection.Cut Range("AF3095").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=276 Range("AA3375:AA3386").Select Selection.Cut Range("AF3375").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA3655:AA3666").Select Selection.Cut Range("AF3655").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA3935:AA3946").Select Selection.Cut Range("AF3935").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=276 Range("AA4215:AA4226").Select Selection.Cut Range("AF4215").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA4495:AA4506").Select Selection.Cut Range("AF4495").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=279 Range("AA4775:AA4786").Select Selection.Cut Range("AF4775").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=285 Range("AA5055:AA5066").Select Selection.Cut Range("AF5055").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=279 Range("AA5335:AA5346").Select Selection.Cut Range("AF5335").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=279 Range("AA5615:AA5626").Select Selection.Cut Range("AF5615").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=279 Range("AA5895:AA5906").Select Selection.Cut Range("AF5895").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=279 Range("AA6175:AA6186").Select Selection.Cut Range("AF6175").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA6455:AA6466").Select Selection.Cut Range("AF6455").Select ActiveSheet.Paste Range("AA2").Select End Sub よろしくお願いいたします。
Excel マクロ VBA お詳しい方へ 再質問です。 おはようございます。 Excelの初心者です。マクロを作成したのですが、重たく、処理にかなりの時間がかかります。それを高速化したいのですが、マクロの高速化を初心者の私に≪詳細≫にご教授いただける方はいらっしゃいませんでしょうか？コードは次の通りです。文字数の都合から中略しています。 モジュール１ Function Kosujun(Hani As Range) As String Dim Rng As Range Dim Str As String Dim Cnt(6) As Long Dim Ptr(6) As Long Dim i As Long Dim j As Long For Each Rng In Hani Str = Rng For i = 1 To Len(Str) Select Case Mid(Str, i, 1) Case "1" To "6" Cnt(Mid(Str, i, 1)) = Cnt(Mid(Str, i, 1)) + 1 End Select Next i Next Rng Cnt(0) = 99999999 For i = 1 To 6 j = i Do Until Cnt(i) <= Cnt(Ptr(j - 1)) Ptr(j) = Ptr(j - 1) j = j - 1 Loop Ptr(j) = i Next i For i = 1 To 6 Kosujun = Kosujun & Ptr(i) Next i End Function モジュール６ Sub Macro1日付を右にズラす() ' ' Macro1日付を右にズラす Macro ' ' Range("AA10").Select Selection.Cut Range("AB10").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA290").Select Selection.Cut Range("AB290").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=276 Range("AA570").Select Selection.Cut Range("AB570").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA850").Select Selection.Cut Range("AB850").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA1130").Select Selection.Cut Range("AB1130").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=279 Range("AA1410").Select Selection.Cut Range("AB1410").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA1690").Select Selection.Cut Range("AB1690").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=276 Range("AA1970").Select Selection.Cut Range("AB1970").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 ≪中略≫ Range("AA5890").Select Selection.Cut Range("AB5890").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=276 Range("AA6170").Select Selection.Cut Range("AB6170").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=282 Range("AA6450").Select Selection.Cut Range("AB6450").Select ActiveSheet.Paste ActiveWindow.ScrollRow = 6447 ActiveWindow.ScrollRow = 6418 ActiveWindow.ScrollRow = 6315 ActiveWindow.ScrollRow = 6226 ActiveWindow.ScrollRow = 6109 ActiveWindow.ScrollRow = 5991 ActiveWindow.ScrollRow = 5903 ActiveWindow.ScrollRow = 5858 ActiveWindow.ScrollRow = 5800 ≪中略≫ ActiveWindow.ScrollRow = 1 Range("AA2").Select End Sub モジュール６が非常に処理時間がかかります。 よろしくお願いいたします。
マクロ初心者ですが、A（マクロ記述）,B（データ）,C（データ）という3つのブックを開き、ＣブックのデータをＢブックに入力しようとしています。次のコード（部分）のうち、 Do While～Ｌｏｏpの条件部分の WB1.Worksheets(1)～の「.Worksheets(1)」の文字色が反転して「コンパイルエラー：メソッドまたはデータメンバが見つかりません」と表示されてしまいます。 何か基本的なミスをしている予感（？）がするのですが・・・エラーが発生した箇所以降の部分のコードについても、ご指摘ご指導をおねがいします。 ちなみに、ここには引用していませんが、前半のコードによりＷＢ１及びWb2というブックはいずれもコードどおり開いた（open）状態です。 '予実利用者ファイルを開く Workbooks.Open ("C:\Documents and Settings\Owner\デスクトップ\要介護度集計表\" & yojitsu) '要介護情報を予実利用者情報に挿入する Dim I As Long Dim WB1 As Workbooks, Wb2 As Workbooks Set WB1 = Workbooks("C:\Documents and Settings\Owner\デスクトップ\要介護度集計表\" & yojitsu) Set Wb2 = Workbooks("C:\Documents and Settings\Owner\デスクトップ\要介護度集計表\" & kaigodo) I = 2 Do While WB1.Worksheets(1).Range("A" & I).variant <> "" WB1.Worksheets(1).Range("AU" & I).variant = Application.VLookup(WB1.Worksheets(1).Range("D" & I).variant, Wb2.Worksheets(1).Range("B2:G20000"), 6, 0) I = I + 1 Loop Application.ScreenUpdating = True End Sub
Visual Basicについて VBで、分数の四則演算のプログラムを作りたいのですが、何からどう手をつければいいのか まったくわかりません。どういったソースコードになるのかを教えてもらいたいです。 フォーム画面はこのような感じになっています。
質問失礼します。 エクセルについて質問です。 枠内に文字を抑える方法を教えてください。文字が出てしまいわかりにくいです。 次に日にちを入力しと時のに下に行くと１２３のように順番になります。すべて同じにしたい場合どのようにすればよろしいですか？ ご回答よろしくお願いします。
share point上のアクセスファイルへの VBA 接続 ADO での接続文字列は下記でしょうか？"Provider=Microsoft.ACE.OLEDB.12.0;" & _ "Extended Properties=WSS;IMEX=2;RetrieveIds=Yes;" & _ "DATABASE=#SharePoint_URL#;LIST=#アクセス名#" ◆ "#SharePoint_URL#" 部分は実際のURLです。 ◆ "#アクセス名#" の部分は実際のアクセスファイル名です。 ◆おそらく List部分が違うように思います。 シェアポイントに "保存" されているだけのアクセスファイル はもともと ADO接続はできないのでしょうか？ それとも、List部分さえ適正であれば、"保存" されている ファイルにも接続可能なのでしょうか？
マクロを使用してデータを抽出したいです。・使用するブック ①抽出先.xlsm（ここにマクロを入れる） ②新・データ表1.xlsx ③新・データ表2.xlsx ④新・データ表3.xlsx ⑤旧・データ表1.xlsx ⑥旧・データ表2.xlsx ⑦旧・データ表3.xlsx やりたいことは、[新・データ表]と[旧・データ表]の中にある、おなじ管理番号の行をコピーし、抽出先.xlsmのブックにに貼り付けたいのです。 管理番号とは、データ表にある全てのデータ（行）に個別の管理番号が付与されており、そのことです。（管理番号はすべてＡ列にあります） 抽出先のブックにユーザーフォームを作り、そこにテキストボックスを置いて、その中に、検索値である管理番号を入れてコマンドボタンを押すことで自動で抽出されるようにしたいです。 データ表のシートは、新／旧おなじシートが入っています。シート名は下記のようなものになっております。 データ表１のシート→[グレーディング][マーキング][デザイン] データ表２のシート→[海][花火][祭り] データ表３のシート→[音声][イラスト][色] 抽出先のブックには、データ表１・２・３に存在するすべてのシート名の表が入っています。データ表で、検索値である管理番号の存在するシートと、抽出先のブックにシート名が一致するシートがあれば、そのシート（抽出先のブック）に貼り付けたいです。 一つのシートで同じ管理番号のデータが複数行存在する場合がありますので、その場合は存在するすべての行を抽出したいです。 貼り付ける位置は、新・データ表はＡ３～、旧・データ表はＡ４３～へ、値貼り付け＆書式貼り付けで貼り付けたいです。 貼り付ける位置ですが、[色]のシートのみ、一つのシートで同じ管理番号のデータが大量に存在するので、[色]のシートは、新・データ表はＡ３～、旧・データ表はＡ６３～へ貼り付けたいです。 長くなってしまい、わかりづらいところがあればすみません。 どなたかお助けたいただけないでしょうか。
モニタのon,offの状態をvb.netから取得したいのですが、どうしたらできますか？
【至急！コイン５００枚】Excelのマクロについて Excelのマクロで、 「セル（A,1）の値が、別シートのセル（A,1）～（A、100）の値のどれかと一致する場合、1を返す。一致するものがない場合は2を返す。」 という関数を作ることはできますか？ 文章では分かりにくいと思うのですが、要するに IF関数の条件分（理論式）において、 ①別シートの値を参照する ②複数のセルを範囲指定する ということをやりたいです。
エクセルVBAで特定のセルにある図形を消すマクロを組んでいます。図形は消えるのですが、 If Not Intersect(Range(sp.TopLeftCell, sp.BottomRightCell), myrng) Is Nothing Then の部分でエラーが出てしまいます。 仕様としてはB2セルに１～９までの整数が入力されており、B4セルから１セルに１つずつB2セル値の数だけの図形があります。 おそらく、 Set myrng = Nothing からループして if not ~ is nothing のところで上手く行かないのかと思い、 色々調べて見ましたが解決しませんでした。 以下にソースを載せますので、どなたかご教授お願い致します。 Sub ブロック消去1() ' ブロック消去 Macro Dim i As Long Dim x As Long Dim myrng As Range Dim sp As Variant i = Range("b2") x = 1 + i Set myrng = Range(Cells(4, 2), Cells(4, x)) For Each sp In ActiveSheet.Shapes If Not Intersect(Range(sp.TopLeftCell, sp.BottomRightCell), myrng) Is Nothing Then sp.Delete End If Next Set myrng = Nothing End Sub
エクセルのVBAについての質問です。 下の2つのプログラムを組んだのですが、上の方の実行時間が30秒と時間がかかりすぎるので何が時間を食っているのかを知りたいと思い質問しました。ちなみに下の方の実行時間は1秒足らずです。 プログラムの内容はグラフの縦軸と横軸の作成です。上の方は縦軸を作っています。これは固定のものです。下の方は横軸を作っています。これは他のシートから読み込みを行い軸を調整します。ここでの値を別の処理に使うプログラムは書いていないので、なぜ遅くなっているのかわからず、途方に暮れています。 Sub LFgraphx() Dim termD As Long For termD = 1 To 10 Worksheets("forstudent").Cells(termD + 3, 1) = CStr(termD) + "term" Worksheets("forteacher").Cells(termD + 3, 1) = CStr(termD) + "term" Next termD ' Worksheets("forstudent").Cells(3, 1) = "day" ' Worksheets("forteacher").Cells(3, 1) = "day" End Sub Sub LFgraphy() Dim dayS As Long For dayS = 1 To 99 Worksheets("forstudent").Cells(3, 1 + dayS) = Worksheets("daytermlist").Cells(1 + dayS, 1) Worksheets("forteacher").Cells(3, 1 + dayS) = Worksheets("daytermlist").Cells(1 + dayS, 1) If Worksheets("daytermlist").Cells(1 + dayS, 1) = 0 Then Exit For Next dayS End Sub
Visual Basic で、文字＋数字となっている部分の、文字の部分だけを置換させる方法はありますでしょうか？プログラミングをほとんどやったことがないのですが、必要にかられてVisual Basicで文字列置換のプログラムをあれこれいじっている最中です。 ある文字列をそのままそっくり別文字列に置換する方法はさすがにすぐわかって簡単だったのですが、たとえば、 1の5 2の5 3の5 ・・・ というところを、 1 / 5 2 / 5 3 / 5 ・・・ という感じで早く置換できたら、と思っております。 "の"という文字はあらゆる所に出てくるので、今のところは、たとえば "1の" を "1 / " で置き換える、次は"2の" を "2 / " に置換、、という感じでただひたすら数字を変えて、置換していいかを確認しながら、いちいち手動で行っているような有り様です。 ここでおたずねしたいのですが、数字の部分の値がいくつであろうと、まとめて一気に置換できる方法は無いでしょうか？ この例ですと、 "(数字)の(数字)" の部分を "(数字) / (数字)" とか、 "の(数字)" の部分を " / (数字)" という感じで、とにかく一気に全部変換したい、ということです。 "の"という文字の次に（値に関係なく）とにかく数字が来るときだけそれを認識して置換する、というのをプログラミングでなんとかして面倒な作業を少しでも減らしたいです。 一応自分で、Visual Basic 文字列 変換 などで検索かけてみたのですが、参考になりそうなサイトさんをうまく見つけることが出来ませんでしたので、ここでおたずねしようと思った次第です。 もし方法があるのであれば、ヒントだけでもいただければありがたいです。 どうぞよろしくお願いします。
マクロについて教えてください。 A列に入力されている文字を整理したいと思っています。1,2,3,4,5,6、7のように連続しているなら1～7 連続していない場合は一文字だけ といったようにしたいと思っています。 以下の式を考えましたが全然だめです。 連続した数字なら何とかなりましたが 空欄ができるなど全然うまくいきません。 理想は画像のように整理したいと思っています。 Sub d() i = 2 i2 = 2 For r = 3 To 7 If Range("A" & r).Value - Range("A" & r).Offset(-1, 0).Value = 1 Then cnt = cnt + 1 Range("Ｄ" & r - cnt).Value = Range("a" & r).Value Range("Ｂ" & r - cnt).Value = Range("a" & r - cnt).Value Else Range("b" & r).Value = Range("a" & r).Value If Range("b" & r).Offset(-1, 0).Value = "" Then Range("b" & r).Cut Destination:=Range("b" & r).Offset(-1, 0) End If End If Next r End Sub
visual studio2015を使用し vb.netでdatagridview を使用してaccessのDBの管理が行えるよう勉強中の者です。 DBに数値型の年度というフィールドがあり4桁の値が入力されています 例 2016これをVB.netのdatagridviewで和暦で表示したいのですがうまくいかず困っています。 DBのフィールドは4桁の数字型を維持したいのですが日付型に変更しないと、 datagridviewで和暦表示することは難しいでしょうか？ 知っている方是非回答よろしくお願いいたします。
お世話になります。エクセル初心者です。 マクロで下記を作成しています。 テキストボックスの入力値を表に反映させていきたい。テキストボックス内に文字を入力し、 コマンドボタンを押した際に空白のセルを認識して、 ・空白ならばテキストボックスの入力値を反映する ・空白でなければ、セルを右に1つ移動してテキストボックスの入力値を反映する とういう内容です。 実際には毎日の測定を右にどんどん書き込んでいきたいという趣旨です。 下記でうまくいかないのですが、皆様のご教授をお願いいたします。 Private Sub CommandButton1_Click() Sheets("Sheet1").Select ActiveSheet.Range("b8").End(xlRight).Select ActiveCell.Offset(0, 1).Activate ActiveCell.Value = TextBox9 End Sub ※画像の内の「計測日」のセルを見て、空白でない為、右に移動という指示をさせようとしました。
エクセルVBAでのスクレイピングコードについて 少し長いです。 こんなコード書きました。 yahoo financeから、テーブルデータをスクレイピングするものです。------------------------ Dim objIE As InternetExplorer Dim htmlDoc As HTMLDocument Dim targetURL As String Dim colClass As IHTMLElementCollection Dim colTr As IHTMLElementCollection Dim colTd As IHTMLElementCollection Dim trCnt As Integer Dim tdCnt As Integer Dim k As Integer Set objIE = CreateObject("Internetexplorer.Application") objIE.Visible = True targetURL = "http://info.finance.yahoo.co.jp/history/?code=2914.T&sy=2010&sm=10&..." objIE.navigate targetURL Do While objIE.Busy = True Or objIE.readyState < READYSTATE_COMPLETE DoEvents Loop Set htmlDoc = objIE.document Set colClass = htmlDoc.getElementsByClassName("boardFin yjSt marB6") Set colTr = colClass(0).getElementsByTagName("tr") trCnt = colTr.Length 'tr要素の数→２１行になります For k = 1 To trCnt - 1 'k=0はth要素なので除いてk=1から。 Set colTd = colTr(k).getElementsByTagName("td") tdCnt = colTd.Length 'td要素数→７つになります Debug.Print colTd(0) '[object HTMLTableDataCellElement] next k ------------------------ 説明に不要なところは除きました。 trやtdの要素数はきちんソースコードの通り取れるのですが、最後の Debug.Print colTd(0) で、要素そのもののを取得して表示できません。 どうしても [object HTMLTableDataCellElement] と表示されてしまいます。 どこかミスをしているのでしょうか。 てっきり、うまくデータを取れているかと思ったのですが、どうやら違うみたいです。 行き詰まってしまいました。助言頂けませんでしょうか。
VBAのユーザー定義型の要素確認について。 エクセルVBAでユーザー定義型をつくり、その配列を宣言しました。トレースするために、実行途中のユーザー定義型の変数の値を確認したいのですが、debug.print ではうまくいきません。どのようなコードを書くと、うまく要素の値を表示できるのでしょう。 以下コードです。 －－－－－－－－－－－ Type User aaa As Variant bbb As Single ccc As String End Type Dim myArr(10) As User --- 配列へ値を格納する処理 --- for k =0 to 9 debug.print myArr(k).aaa debug.print myArr(k).bbb debug.print myArr(k).ccc next k －－－－－－－－－－－ こんな風にやりたいのですが、イミディエイトウインドウには、変数型が表示されるだけです。 これはどういう動きなのでしょう。そして、正しく要素を表示させるにはどのように書くと良いでしょうか。
iPhone用のQRコードを作っています。 顧客住所からQRコードを作成しGoogleMapに表示させたいのですが うまくいきません。 以下はVBAの失敗例です。変数="http://maps.apple.com/?q= 住所" 変数="http://maps.google.com/maps?q=住所" 変数="comgooglemaps://?q=住所" 変数="googlemaps://?q=住所" ↓ 変数を元にQRコード作成 ↓ 文字は間違いなく表示されるが起動はしない（safari、googlemapともに） （環境：windows10 64BIT ACCESS2007) iPhone5で実証中です。
ＣＳＶで書き出した表1を表2に変換したいです。 ボタンを押した時にＶＢＡで一括変換したいです。 表2の値は、表1からの区別、動労時間を表示 ＶＢＡ初心者の為、助言いただけると助かります。但し、区別と労働時間どちらも記載されている場合は エラーとして赤文字斜線で両方を表示 例.「公休720」
エクセルでの操作について、F5キーでのジャンプはどこまで応用できますか？ 表の入力で「アクティブセルの一列右の２行目に移動」という指定は出来るでしょうか？ 宜しくお願いします。
.vbsファイルで、USBやDVDドライブが差しっ放し・入れっぱなしでシャットダウンしようとすると、エラー表示が出るようなスクリプトを作成したいのですが、ご教授願えませんでしょうか？結果的には、ディスクやUSBなどが刺さっていないことを確認出来たら、シャットダウンが実行するようにしたいです。 途中まで作成しましたが、１度見ていただきどこを訂正し、このあとはどのようなスクリプトを作成すればいいのかを教えていただきたいです。 ---------------スクリプト構文--------------- Option Explicit Dim ObjFSO Dim Objshell Dim wmiLocator Dim wmiService Dim ObjEnumerator Dim objInstance Dim strLetter 'オブジェクト作成 Set ObjFSO = CreateObject("SCripting.FileSystemObject") Set wmiLocator = CreateObject("WbemScripting.SWbemLocator") Set wmiService = wmiLocator.ConnectServer Set ObjEnumerator = wmiService.InstancesOf("Win32_LogicalDisk") 'シェルオブジェクトを作成 Set ObjShell = WScript.CreateObject("WScript.Shell") '1.USBメモリーの感知 For Each objInstance In ObjEnumerator do strLetter = objInstance.Name ' WScript.Echo strLetter ' CドライブとDドライブ以外を検査する If Not strLetter = "C:" And _ Not strLetter = "D:" Then If objInstance.Size > 0 Then strLetter = Left(strLetter, 1) WScript.Echo strLetter & " ドライブにUSBドライバーが刺さっている為、シャットダウン出来ません。" End If End If '2.DVDドライバーの感知 'ディスクの調査とあった場合の警告 If Not strLetter = "C:" Then If objInstance.Size > 0 Then strLetter = Left(strLetter, 1) WScript.Echo strLetter & " ドライブにDVDが残っている為、シャットダウン出来ません。" End If End If '3.USB・DVD両方の感知 --------------以上-------------
エクセルVBAでshell関数を使って指定のフォルダを開けたいと考えています。 指定のフォルダのフルパスを入れるとうまくいますが、パスを変数にしたらエラーが出ます。Shell 変数 , vbNormalFocus どう書けばよいか教えてください。
エクセルVBAで教えてほしいことがあります。エクセルファイルの保存先の一階層上の別のフォルダを指定したい場合 ActiveWorkbook.Path & ”指定のフォルダ”ではうまくいきません。 フォルダAの中にフォルダBとフォルダCがあり、フォルダBにエクセルファイルがあった場合に フォルダCを指定したい。 フォルダAのパスは可変です。 教えてください。
VBで文字列の暗号化について VBで１０桁の文字列を１６桁（結果が固定の桁数なら何桁でも）の暗号に変更するような暗号化方式ってありますか？やりたいことは元の文字列に意味を持たせ、暗号化した文字列をライセンスキーとして配布しようというものです。そのために暗号化した結果を固定桁数にしたいのです。
いつもお世話になっております。 VBAについて質問させてください。 excel verは2010です。A列～J列まで1行目に見出し、2行目以降に数値データが入っていているシートが全部で100シートあるファイルでA列～J列のどこかに見出しが"時間" "名前" "住所"の3項目がある場合（シートごとに場所が異なります）その3項目を検索し、その列の最終行のセルをコピーしてK1にペーストするにはどのようなコードにすればよいのでしょうか？ 以上、お忙しいところ恐縮ですが、ご教授頂けると幸いです。 よろしくお願い致します。
access2010 検索フォームからVBAを用いた複数条件による絞り込みについて質問です。 下記のような取引先会社データベースを作成しています。 T_会社基本情報 会社ID（オートナンバー型） ←主キー 会社名（テキスト型） 住所（テキスト型） T_販売品目 会社ID（数値型） ←T_会社基本情報とリレーション A（yes/no型） B（yes/no型） C（yes/no型） T_販売品目詳細 会社ID（数値型） ←T_会社基本情報とリレーション a（yes/no型） b（yes/no型） c（yes/no型） 検索フォームにおいて、非連結テキストボックスで住所（部分一致検索）、チェックボックスでA～Bおよびa～cにチェックがあるレコードのみの絞り込みを行い、結果を参照フォームで表示させたいのですが、見よう見まねのVBAを組んでみましたがうまくいきません。 実際には販売品目のチェックボックスが50近くあり、絞り込みのスピードも心配しています。 access初心者のため、どうか先輩方の知恵をお貸しいただければ助かります。 よろしくお願いいたします。
基準値 4.158 振り幅 プラマイ2(6.158～2.158) 条件等 1セット 23回 乱数取得 これを、28セット。 各セットで、最大値と最小値を求めて絶対値で大きい方をそのセットの最大値とする。2セット目は1セット目の最大値の離れは0.5以上1.0以内。ただし、基準値の振り幅は守る。 -2.0 -1.5 -1.0 -0.5 0 0.5 1.0 1.5 2.0 が、行ったり来たりするイメージです。
excelのvbaで質問です。 A1のセルに "一覧表に記入する。" などの漢字交じりの文字列が入っています。 "マークを消す" のように漢字カタカナ交じりになることもあります。この文字列の1文字ずつのふりがなを取り出したいと思っているのです。つまり、 B1に "いち" C1に "らん" D1に ”ひょう" E1に ”に" F1に "き" G1に "にゅう" H1に "す" I1に "る" J1に"。" といった具合です。ダブルクオーテーションマークは不要です。 文字列の長さはまちまちですが、長くても10文字です。 上記のことができるのなら、関数でもかまいません。VBAにはこだわりません。 慣れない質問で見づらくなってしまい、申し訳ありませんが、よろしくお願いします。
エクセル VBAについてVBA初心者です。 bの列に名前 cの列に年齢 dの列に職業 を入れたとします。 aの列には上から1.2.3....と番号があるとします。 現在、その数字をダブルクリックすると作成するかどうかを選択するフォームが表示されるようにしてるのですが、そこで作成をするを押したときに、「別シートの名前、年齢、職業欄にその行の3つのデータ(ダブルクリックをしたその番号の行の)が入る」という風にしたいのですがどうすればいいでしょうか。 シート1(シート名) a列に番号、b列に名前、c列に年齢、d列に職業 シート2(シート名) a2に名前欄、b2に年齢欄、c2に職業欄がある。 という状況とします。 「 」で囲んだ部分のコードの書き方が知りたいです。よろしくお願いします。
エクセルＶＢＡでマクロの高速化についての質問です。 エクセルで下記のように処理による結果と合格した場合に”合格”と表示している 表があります。処理名は空白場所がありますが、例えばＡ３は処理Ａ、 Ａ７は処理Ｂとなっております。 まず、処理名を空白の部分に記入し、次にＢ列の結果で合格ならＣ列に 合格と、不合格なら何も記入しないといったマクロを作成しました。 実際は千件以上の記入が必要で、マクロの動作が遅くなります。 そこで、高速化のためにApplication.ScreenUpdating と バリアント型に配列を格納する手法を試してみました。 ですが、下記のマクロのように変数Ｖに配列を入れ、Vcells( , )としてみたところ オブジェクトが必要ですとエラーが出ました。 もしバリアント型に格納する方法をとるなら どのようなマクロにすればよろしいでしょうか？ よろしくお願いいたします。 Sub 処理() Dim i As Long Dim j As Long Dim V As Variant Application.ScreenUpdating = False For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row V = Range(Cells(2, 1), Cells(Cells(Rows.Count, 1).End(xlUp).Row, _ Cells(4, Columns.Count).End(xlToLeft).Column)) '処理名記入 Select Case V(i - 1, 1).Value Case Is = "以上" '以上まで読み込めば処理を終了する Exit For Case Is = "" V(i, 1).Value = V(i - 1, 1).Value End Select If V(i, 3) = "合格" Then V(i, 2).Value = V(i, 3).Value End If Next i Range(Cells(2, 1), Cells(Cells(Rows.Count, 1).End(xlUp).Row, _ Cells(4, Columns.Count).End(xlToLeft).Column)) = V Application.ScreenUpdating = True End Sub 知恵袋投稿用に若干編集しましたので、 多少表記がおかしいところがあるかと思いますが、 よろしくお願いします。
VBA初心者です！教えて下さい！ この写真のコードだと、エラーのメッセージも入力チェックも両方出てしまいます。 また、h2のセルに日付も出ません。泣 背景が黄色になっているものが出た時のみエラーを出す。 背景が黄色のものがなければ完了を入れて、日付を入れたいです。 どうすれば出来ますか？ callはだいたい文字で書いてある通りのものです。
ExcelのVBAマクロについて質問です。Windowsタイムスケジューラとauto_open関数を組み合わせて タイムスケジューラが6時になったらブックを開きマクロを実行するプログラムを作りたいのですが 条件として、タイムスケジューラでブックを起動したときのみauto_open関数が実行する仕組みにしようと コマンド関数を使いスケジューラの「引数の追加」の項目を「ファイル名.xlsm /cmd 1」としたのですが cmdの後に半角スペースを入れたせいか１をうまく認識してくれず 「１.xlsxが見つかりません、移動または削除された可能性があります」とエラーが出ます。 テストですがプログラムはこのように書きました。 Sub auto_open() If Command = 1 Then MsgBox ("1") Else MsgBox ("0") End If End Sub どうか解決策を教えてください。 また、上記の条件を満たす違うやり方もあるのでしょうか？
Excel VBAを使って、特定のセルの書式（フォント名・太字・塗りつぶし色）や罫線設定を、別のセルに適用したいのです。copyメソッドは使わず、５種類程度の書式を配列変数か何かに一旦格納して、select case文を使い、条件に応じて１～５の書式を適用していくようなものを考えています。 自分でも検索して色々試行錯誤しているのですが、どうにも分かりません。どうかよろしくお願いします。
エクセル(Excel2010)における入力規則のリストの複数条件に関して、Excelに詳しい方に教えていただきたいのですが…入力規則のリストという機能があると思うのですが、条件の組み合わせでプルダウンリストを作成したいと思っています。 ex)某セルでAを選択すれば、次のセルで名前定義A内の「a1～a5」の中で選択させたい。 この図のようにあらかじめA、Bに関しては名前定義A、名前定義Bを作成し、そこから選択させますが、C～Kまでを選んだ場合は、「その他」しか選択できない状況を作りたいです。C～Kまでそれぞれ名前定義を作成すればいいのですが、実際には多数選択肢がある状態で、現実的ではありません。 INDIRECT関数と、何かしら別の関数を組み合わせれば、問題は解決しますでしょうか？ どなたかご教示くださいますと幸いです。
どなたか教えてください。エクセルでどの関数を使うとできるのか教えてください。 内容は、 もしセルに何か文字が入力されたら、1セルを1とし、 その合計を出したいです。 これは商品、月別にして出したいのです。 よろしくお願いします。
ExcelのVBAについて質問です。先ほど、 cells(1,1).value=1 と入力しなくても、 cells(1,1)=1 と入力すればA1のセルに1が出力されることに気付きました。.valueを記載する意味や利点は何でしょうか？よくわかりません。
Excel VBA 可視セルを順に取得し、別シートに貼り付けるマクロの動かし方について フィルタリング後に残ったデータの、特定の列のデータを１つずつ取得、別シートに貼り付けるという動きをするマクロを組んでいるのですが、どうしても分からない部分があり、お知恵をお借りしたいです。 現在組んでいるマクロです(フィルタリング後の部分のみ) Dim KAZU KAZU = Sheets("サンプル").AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Count - 1 ※フィルタ後の可視データの下図を数える。タイトルを含んでいるので-1する Dim BANGO As Range Set BANGO = Sheets("サンプル").Range("A1") ※サンプルシートの、A1を選択しておく。後で For-nextを使って一つずつ下に動かす For i = 1 To KAZU Set BANGO = BANGO.Offset(1, 0) BANGO.Copy Sheets("別シート").Select Range("A1").Select ActiveSheet.Paste next i という流れです。 顧客番号を１つずつ下のものを取得させたいのですが、この状態では、A2,A3・・・と非表示のセルを取得してしまいます。 変数 BANGO に、 .SpecialCells(xlCellTypeVisible)を付けてもうまく動きません。 ご教授の程、お願い致します。
VBで2個のバイトデーターを結合する方法を教えて頂けませんでしょうか？例えば、０ｘD3と０ｘFAという2個のバイトデーターを結合して、 ０ｘD3FAという1個のInteger型のデーターにしたいのですが、どうやったらいいでしょうか？
VBA 初心者です。Excel2013で 入力フォーム上の数値の比較がうまくいきません。入力フォームで計算した２つの値「実重量」と「容積重量」のこのうち大きな値の数値を「配送重量」に入力します。IF構文の比較がどうしてもうまくいきません。大変お手数ですがご教示お願い致します。 Private Sub CommandButton1_Click() m3 = 縦 * 横 * 奥行 / 1000000 m3.Text = Format(m3.Text, "0.##0") M3合計 = m3 * 個数 M3合計.Text = Format(M3合計.Text, "0.##0") 実重量 = 個数 * 重さ 実重量.Text = Format(実重量.Text, "0.#0") 容積重量 = M3合計 / 0.006 容積重量.Text = Format(容積重量.Text, "0.#0") ’ここから下の構文がうまくいきません！ 'If 配送重量.Value = 容積重量.Value > 実重量.Value Then 容積重量.Value Else 実重量.Value 'End If End Sub
VBA 初心者です 上手く出来ないので、どこがおかしいか教えて下さい。泣 大文字小文字は気にしないでください！泣 上手く色が変わってくれません。 Dim i as integer Dim a as integer Dim b as integer Dim hantei as Boolean For b = 2 to 11 hantei = False If cells(b.1)<>""then hantei =true Else Exit for End if Next b For i 2 to 11 For a = 2 to 6 If hantei = True then If cells(i.a)<>""then Hantei= false Else With cells(i.a).interior .color = vbyellow End with End if Next a Next I End sub
Excelの、特定のセルにチェックマークを入れれるようにしたいのですが、 型が一致しませんと言って エラーで返ってきます。 どうすれば良いでしょうか(´･_･`)？
Excel VBAについて質問させてください。 作成された計算ファイルが正しいか確認するための簡単なデバグツールを作りたいと考えています。具体的には、選択した範囲の中で「異なる」数式が混ざっていないか確認したいと考えています。 たとえば選択した範囲の中の数式が全て相対参照の場合、 R1C1形式で見ると全て同じ数式が入っています。 この中で異なる数式を見つけるVBAを作成したいと考えています。 選択範囲の最初のセルから順にとなりのセルと比較し、異なるセルとぶつかるとそこで止まる。 もし最後まで異なるセルにぶつからない場合は最初のセルに戻って終了する。 シンプルかつ軽快に動くものを目指しています。 どなたかVBAが得意な方がおられましたら、どのようなコードを書けば良いか教えてください。
ACCESS VBA でフォームからボタンひとつで新規フォルダ作成するものを作成しています。固定名でのフォルダは作成できるのですが、フォームに表示された内容またはテーブルやクエリの条件から必要なフィールド名をつなぎ合わせたフォルダ名にしたいのですがやり方が分かりません。下記記述に追加する形で教えてください。 テーブル 進捗状況T フィールド 注文番号 ＆ エリア ＆ 担当者 以下が作成中のものです。 Private Sub コマンド18_Click() '作成するフォルダ名をtestとする str_dir_name = "test" 保存先 = 保存先 & str_dir_name & "\" 'フォルダの存在確認 Dim fso Set fso = CreateObject("Scripting.FileSystemObject") If (fso.FolderExists(保存先)) Then MsgBox "本日付のバックアップファイルは出力済です。", vbCritical, "ご確認ください" Exit Sub End If 'フォルダ作成 MkDir (保存先) End sub
帳票フォームの詳細に表示されているデータをcsv形式のテキストファイルに保存したいと思っています。 csv形式のテキストファイルの保存方法と任意の名前かつ任意の場所で保存する方法がわかりません。 VBAのコードもどう入力していいかわかりません。 Access初心者です。 Accessに詳しい方、教えてください。 よろしくお願いします。
ユーザフォーム上にコンボボックス一個作成3列を表示、検索するようにしたが結果が1列しかコンポボックスに反映されません、3列表示するにはどうしたらよいかを教えてください。具体的にはMシートに「A列メーカー名・B列サイズ・C列型番」の表が500行くらいあります。Aシートにユーザーフォームを立ち上げコンボボックスにメーカ名”m”などと入力するとダウンドロップメニューにMITSUBISHI/14.5/ABC、MATSUI/20.1/BBCなどと表示されます（この時点では3列表示されます）。その一覧表の中から該当するものをクリックして選択いたします。選択するとコンボボックスの一覧表は閉じMITSUBISHIのメーカ名しか表示されませんので選択したサイズ・型番が確認できないため不便です。選択した後3列（メーカー・サイズ・型番）が表示されるようにしたいのですがご教示ください。尚、選択した行をAシートB列から貼り付けします。よろしくお願いいたします。 コードは以下の通りです。 Private Sub CommandButton1_Click() Dim lRow As Long, i As Long Dim ListNo As Long ListNo = ComboBox1.ListIndex If ListNo < 0 Then MsgBox "いずれかの行を選択してください" Exit Sub End If With ActiveSheet lRow = .Range("E" & Rows.Count).End(xlUp).Row For i = 0 To 2 .Cells(lRow + 1, i + 3).Value = ComboBox1.List(ListNo, i) Next i End With ComboBox1.Value = "" End Sub ’------------------------------------------------------------ Private Sub CommandButton2_Click() Unload Me End Sub Private Sub UserForm_Initialize() Dim LastR As Long Dim myData With Worksheets("M") LastR = .Range("A" & Rows.Count).End(xlUp).Row myData = .Range("A2:C" & LastR).Value End With With ComboBox1 .ColumnCount = 3 .ColumnWidths = "50;50;50" .List = myData End With ' .List = myData CheckBox1.Value = False End Sub
ExcelVBA 連続文字列の入力のある2行目を参照し、F2以降文字列のある最後列まで、E1の数式をコピーするためのプログラムを教えてください。（図参照） 列ですと、以下のようになるのですがこれを行バージョンにしたいのです。 Range("C3:C" & Range("B3").End(xlDown).Row).Select Activesheet.paste 添付図は、最後列S列までしかありませんが、通常かなりのデータ量があり、かつ末尾はいつも異なります。 最終的に、3行目の数字と文字列混合値から数字のみを1行目に取り出し（関数MID）、VBA［Do until~Loop］で歯抜けの月数列を追加しようとしています。 元データはピボットを値の貼付したため、月数を数値又は日付と認識せず、Do until~loopで回せませんでした。 もし、よい方法があるのでしたら、ぜひそのプログラムもご教示いただけるとありがたいです。 よろしくお願いいたします。
Sheet1のデータをSheet2へ繰り返し処理等で反映させる方法を教えていただけませんでしょうか。 Sheet1には、１人分のデータ項目がRange("A5：BC5")まで入っています。また、Sheet1に入力する人数は最大で５００人程度（＝５００行程度）となります。 そして、Sheet2には、Sheet1に入力されている項目の内、必要なデータだけをRange指定して反映させるのですが、Sheet1は、１人分のデータを１行で管理し、並び替えをできるようにしたうえで、Sheet2では、１人につき２行を用いて表示させたいのです。 約５００人全員のデータを１０人ずつ区切ったマクロで反映させるようにしたものの（５００人をいっぺんに書き出すと、途中でエラーとなったため。）、Sheet1のBC列の途中のセルが「空白」となった場合、その時点で作業を終了したいのです。 １０人ずつ区切るマクロ（例示参照）ではなく、繰り返し処理（ループ）で考えるべきとは思うのですが、エクセルVBAのテキストを見てもなかなか理解できません。 お力を貸していただけませんでしょうか。 （例示） Sub Macro01() ‘ 1人目～10人目まで ' 1人目 Sheet2.Range("B9:D9").Value = Sheet1.Range("B5:D5").Value Sheet2.Range("D10").Value = Sheet1.Range("F5").Value Sheet2.Range("E9").Value = Sheet1.Range("M5").Value Sheet2.Range("F9:H9").Value = Sheet1.Range("S5:U5").Value Sheet2.Range("I9:M9").Value = Sheet1.Range("AS5:AW5").Value Sheet2.Range("I10:M10").Value = Sheet1.Range("AX5:BB5").Value Sheet2.Range("N9").Value = Sheet1.Range("BC5").Value ' 2人目 Sheet2.Range("B11:D11").Value = Sheet1.Range("B5:D5").Value Sheet2.Range("D12").Value = Sheet1.Range("F5").Value Sheet2.Range("E11").Value = Sheet1.Range("M5").Value Sheet2.Range("F11:H11").Value = Sheet1.Range("S5:U5").Value Sheet2.Range("I11:M11").Value = Sheet1.Range("AS5:AW5").Value Sheet2.Range("I12:M12").Value = Sheet1.Range("AX5:BB5").Value Sheet2.Range("N11").Value = Sheet1.Range("BC5").Value '3人目 ～ 10人目まで指定して End Sub Sub Macro02() ‘ 11人目～20人目まで ' 11人目 ～ 20人目まで指定して End Sub 以降500人目に達するまで・・・
VBAでGomplayerをアクティブにし、その再生中のファイル名を取得する方法をご存知の方 いらっしゃいませんか？
あるフォルダーの中のaabbcc.vbsのショートカットをオールユーザーのスタートアップに作るスクリプトを下のようにつくりました。このスクリプトと、aabbcc.vbsは同じフォルダーにあります。管理権限がある場合はショートカットが作成されます。無い場合は、「Wshshortcut.save」でエラーが出てしまいます。管理権限が無くても管理権限の昇格で対応できると思ったのですが、確認画面も出ません。（管理権の昇格の部分等、ネット上のものを使用させていただきました。） ＶＢＳについては、ほとんど知識がありません。よろしくお願いします。 Option Explicit dim fso, objShell, strTname, strFileName, objShortCut, myF Set fso = createObject("Scripting.FileSystemObject") myF=fso.getParentFolderName(WScript.ScriptFullName) Set objShell = WScript.CreateObject("WScript.Shell") strTname = objShell.SpecialFolders("AllUsersStartup") strFileName = strTname + "\aabbcc.lnk" Call RunAdmin() Set objShortCut = objShell.CreateShortcut(strFileName) With objShortCut .TargetPath =myF & "\aabbcc.vbs" .WorkingDirectory =myF .Save end with WScript.Echo strFileName & "にショートカットを作成しました。" WScript.Quit Sub RunAdmin() Dim WMI, OS, Value, Sha, wssh, fs, sh, ans do while WScript.Arguments.Count = 0 and WScript.Version >= 5.7 ' Check WScript5.7~ and Vista~ Set wmi = GetObject("winmgmts:" & "{impersonationLevel=impersonate}!\\.\root\cimv2") Set os = wmi.ExecQuery("SELECT *FROM Win32_OperatingSystem") For Each value in os if left(value.Version, 3) < 6.0 then exit do 'Exit if not vista Next ' Run this script as admin. Set sha = CreateObject("Shell.Application") sha.ShellExecute "wscript.exe", """" & WScript.ScriptFullName & """ uac", "", "runas" WScript.Quit loop Set WMI = nothing Set OS = nothing Set Sha =nothing End Sub
真剣に質問です今遠距離中の彼に好かれてる自信がないです 私は想ったことを言えないで、好きだということもあまり言えないです。そして会話も友達の頃いろいろ話をしたためネタギレみたいな感じで話す内容が思い付かず黙ったままとかなってしまいます。同じ共通点があまりなく、話をしてもお互いわからないとかで素っ気なくなってしまいます。最近では電話しながら音楽聞いてたりそれをお互い聞いてる感じです。電話しててもなんというか空気が重いというかなんか違うなというか。好きなのに素直に言えない私はどうすればいいかわかりません。それでも私は好きです。
EXCELのVBAで”部分的な正弦波”をきれいに曲線として書きたいと思っております。 はじめまして。 工学系大学に通い、研究に勤しむしがない学生です。最近、成果報告の際にパワポ用の絵をよく書くのですが、”部分的な正弦波”をきれいに書くことができず困っています。 １周期の正弦波はVBAを使って、自在曲線のノードを正弦波状に座標を合わせてプロットしていくことで書くことが出来ました。(100ﾉｰﾄﾞあればきれいに見えました） しかし、このプログラムを添付図のように「A2に描画開始位相、A5に描画終了位相」をユーザーが入力し、これらの値に従って正弦波の一部を曲線として吐き出すプログラムを書けないかと模索しております。 （ちなみにEXCEL2010、2016両方とも使用可能な環境です） 私の要望としましては、 ・1周期の正弦波を部分的に白い四角等で隠すのはNG ・背景が白の画像になるのもNG ・切り取りたい部分を0としてしまうのもNG ・とにかくきれいに書きたい ・A2、A5に値を入力しマクロを実行すればOK、という形にしたい ・VBA、マクロは一通り使えます ・描画用に別シートを作るなどもアリ などです。 どうか有識者の方がおられましたら、よろしくお願いします。
VBAで、ユーザフォームのデバイスコンテキストに描いた画像をbitmapで保存する方法を教えてください。Imageオブジェクトですと、SavePictureでできるのですが、デバイスコンテキストのデータを保存する方法がわかりません。 簡単なコード例を教えて頂けないでしょうか。
Excel上のVBAによるプログラミング お願いします本当に困っています。 学校の授業でプログラミングを行っていますが、本当の本当に何をしているのかわかりません。 最初の方の問題は、ヒントや検索をもとに乗り越えることができましたが最後の問題5からもうなにをしてるのか解読できません。。。 詳しい方いらっしゃいましたら教えてくださると嬉しいです。 自力では If Cells （1.9）> 79 then Cells（1.10）="優" Else If Cells （1.9）> 69 then Cells（1.10）="良" Else If Cells （1.9）> then Cells（1.10）="可" Else If Cells （1.9）< 60 then Cells（1.10）="不可" End If End If End If End If までやりましたが繰り返しの方法がわかりません。 よろしくお願い致しますm(__)m
オートシェイプ（線）の右横のテキストボックスに、自動で数字を入れたいと思っています。 テキストボックス上で、右クリックして出てくる「マクロの登録」に記載する、コードを教えていただきたいです。線の移動で、自動で数字が変わるようにするには、ワークシートにもマクロ登録が必要であればそのコードも教えてください。 よろしくお願いいたします。
社内で独自に開発したアプリのボタンを押すと、エクセル（Book1.xls）が画面に表示されます。次に私が作成したエクセルのマクロでこのBook1.xlsを変数に入れて使おうとするとエラーが出てしまいます。 Dim bk As Workbook Set bk=Workbooks("Book1") ←ここの行が黄色くなります VBAProjectを見ると、Book1.xlsの名前が表示されていないのです。 画面ではBook1が見えるのに、マクロではBook1が認識されていません。 対処方法を御教授下さい。 なお、エラーが出るのは、先に複数のエクセルが立ちあがているときに出ます。 私のマクロを実行する前にBook1.xls以外エクセルが立ち上がっていないときには、私のマクロは最後まで正常に作動します。
ExcelのVBAで、既にSheet1とSheet2とSheet3はある状態で、Sheet1のA1が選ばれている状態で、Sheet2のB2を選択するようにするには、どのような記述にしたらいいですか？----------------------- Sub test() Sheets("Sheet2").Range("b2").selct End Sub ----------------------- としたのですが、実行時エラーになります。
ExcelのVBAで --------------------------- sub test() With Range("a1") .value="aiueo"With.Font .bold=True .Size=16 End with .interior.color=vbRed End with End sub --------------------------- って書いてる物がありましたが、別に --------------------------- sub test() With Range("a1") .value="aiueo" .interior.color=vbRed With.Font .bold=True .Size=16 End with End with End sub --------------------------- でもいいと思いますが、前者の方がいい理由はありますか？下のほうがキレイにまとまって見えるのですが。
エクセルの下記のマクロで、オートシェイプの線の長さを変えられるようになったのですが、「4」の行をコピーして、「コピーしたセルの挿入」をすると、線右のテキストボックスの数字が消えてしまいます。消えないようにコピーして挿入できる、マクロを教えてください。 Private Sub Worksheet_Change(ByVal Target As Range) Dim xRngs As Range, shp, xRng As Range On Error Resume Next Set xRngs = Intersect(Target, Columns(2)).EntireRow On Error GoTo 0 If Not xRngs Is Nothing Then For Each shp In Me.Shapes Set xRng = Nothing On Error Resume Next Set xRng = Intersect(xRngs, shp.TopLeftCell).EntireRow On Error GoTo 0 If Not xRng Is Nothing Then shp.Width = xRng.Cells(2).Value * xRng.Cells(3).Width End If Next shp End If End Sub
エクセルＶＢＡについて シート１には下記のように １行目に品番がＩＲ列位まで、２行目３行目は各商品の原価と売価、 ４行目から３００行目位まで各店舗の発注数があります。【シート１】 Ａ列、 Ｂ列、 Ｃ列、 Ｄ列、 Ｅ列、 Ｆ列 ・・・ ＩＲ １ 品番、 ａ１、 ａ２、 ａ３、 ａ４、 ａ５、 ａａ１００ ２ 原価 、 １００、 ２００、 ３００、 ４００、 ５００、 ９００ ３ 売価 、 １１０、 ２１０、 ３１０、 ４１０、 ５１０、 ９９０ ４ Ａ店、 １、 ２、 ３、 ４、 ５、 １００ ５ Ｂ店 、 １１、 ２２、 ３３、 ４４、 ５５、 １１１ ６ Ｃ店 、 １１１、 ２２２、 ３３３、 ４４４、 ５５５、 １１１１ ・・・・・・・・ ・・・・・・・・ ・・・・・・・・ ３００ ＡＺ店、 ・ ・ ・ ・ ９９９ これを、エクセルＶＢＡを用いてシート２に下記のように並び替えるようにしたいです。 Ｂ列からＩＲ列までは可変です。 ４行目から３００行目の店舗数も可変です。 【シート２】（ＶＢＡ実行の結果） Ａ列、 Ｂ列、 Ｃ列、 Ｄ列、 Ｅ列 １ 品番、 原価、 売価、 店名、 数量 ２ ａ１、 １００、 １１０、 Ａ店 １ ３ ａ１、 １００、 １１０、 Ｂ店 １１ ４ ａ１、 １００、 １１０、 Ｃ店 １１１ ５ ａ２、 ２００、 ２１０、 Ａ店 ２ ６ ａ２、 ２００、 ２１０、 Ｂ店 ２２ ７ ａ２、 ２００、 ２１０、 Ｃ店 ２２２ ８ ａ３、 ３００、 ３１０、 Ａ店 ３ ９ ａ３、 ３００、 ３１０、 Ｂ店 ３３ １０ ａ３ ３００ ３１０ Ｃ店 ３３３ ・・・・・・ ｎ ａ９９ ９００ ９９０ ＡＺ店 ９９９ ＳＵＢからＥＮＤＳＵＢまでＶＢＡ全体の回答お願いします。 詳しくない者なので、お手数お掛けしますがよろしくお願いします。
マクロを用いて数式をセルに書き込みたいのですが上手く出来ません。何方かご教授いただけませんでしょうか宜しくお願いいたします。②のSumIfの数式一個でForでループすることでA列にある合計行C列～Z列まで書き込みたいのです。Range、Cellsの記載方が悪いのでしょうか。””ダブルクォーテーション””の位置でしょうか。 ①のSunIFは書き込みが出来るので、それをコピーする事で事は終わるのですが、マクロの勉強中のためどうかご教授ください。何卒、宜しくお願いいたします。 ◎ adr = Cells(Rows.Count, "A").End(xlUp).Row grng = Range("A:A").Find(What:="小 計", SearchDirection:=xlPrevious).Row num = Range("A1", "A" & adr).Find("合 計").Row y = num - grng If Cells(num, 1) = "合 計" Then ① Cells(num, 3).Formula = "=sumIf(A5:A" & num - y & ",""小 計"",C5:C" & num - y & ")" Cells(num, 4).Formula = "=sumIf(A5:A" & num - y & ",""小 計"",D5:D" & num - y & ")" End If End Sub ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ ◎ adr = Cells(Rows.Count, "A").End(xlUp).Row grng = Range("A:A").Find(What:="小 計", SearchDirection:=xlPrevious).Row num = Range("A1", "A" & adr).Find("合 計").Row y = num - grng ben = num - y If Cells(num, 1) = "合 計" Then For x = 3 To 26 ② Cells(num, x).Formula = "=sumif(Range(A5:A" & ben &",""小 計"",Range(Cells(5,x ), Cells( ben, x )))" Next x End If End Sub
以下の接続文字列を使用して、カンマ区切りのテキストファイルへSQL発行を行おうと 思ったのですが、ファイルの拡張子が「.dat」であるためかSQL発行に失敗してしまいます。※エラーの内容「データベースまたはオブジェクトは読み取り専用なので、更新できません」 なお、対象のファイルの拡張子を「dat」から「csv」へ変更すると成功します。 拡張子は、別のツールでデータベースの内容をアンロードすると 「dat」で作成されるのでそのまま使用できればと思っているのですが可能でしょうか？ 回避策として、ファイルをコピーして、拡張子のみを変更すればよいとは思うのですが アンロードデータが大きいとコピー処理に時間を要してしまうためできれば避けたいです。 ※リネームについてですが、アクセス前にリネームして、処理を行って、元に戻せばよいのでしょうが 途中で処理が失敗してしまった場合、リネームした状態で残ってしまうのでそれも避けれればと思っています。 -------------------------------------------------------------------- Public Sub Text() Dim objConnection As ADODB.Connection Dim objRecordSet As ADODB.Recordset Set objConnection = New ADODB.Connection objConnection.connectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" & _ "Data Source=" & ThisWorkbook.Path & ";" & _ "Extended Properties=""text;HDR=No;FMT=Delimited;"";" Call objConnection.Open ' Set objRecordSet = objConnection.Execute("SELECT * FROM TEST.CSV") ←うまくいく Set objRecordSet = objConnection.Execute("SELECT * FROM TEST.dat") ' ←エラーとなる。 Call objRecordSet.Close End Sub -------------------------------------------------------------------- 以下はschema.ini [test.dat] ColNameHeader=False Format=CSVDelimited Col1=社員番号 Char Width 6 Col2=名前 Char Width 10 -------------------------------------------------------------------- 以下はtest.dat A00001,"山田,太郎" B00001,"鈴木,一郎" B00002,"渡辺,二郎"
VBA超初心者です。 セルのAからCにそれぞれ測定データを入力するシートがあり、DにAからCの平均値を自動で出したいのですが 本などを調べながらやってもよくわかりません。 AからCのデータは、毎回変化します。 どなたか、教えて頂けないでしょうか？ お願いいたします。
アクセスのフォームでオプショングループを作成し、更新後処理を下記のように設定したら、オプションボタンを押したときに、黒くならなくなってしまいました。Private Sub フレーム名_AfterUpdate() [フィールド名] = Choose([フレーム名], "東京", "大阪", "名古屋, "静岡", "") End Sub どう記述すれば、オプションボタンを押したときに、黒丸の状態になるのか教えていただけないでしょうか？ ※更新後処理を設定する前は、オプションボタンを押したときに、ちゃんと黒丸の状態になっていました。
アクセスのテーブルで、修正変更されたフィールド内の文字色を赤く変更するには、どうすればいいのでしょうか？
エクセルの１セル内になる混在している文字と数字を数字のみを抽出し、計欄に１セル内の数字の合計が計算される計算方法教えてください。
html,javascriptについて質問です。var text = parseInt(document.h.b.value); var inp = new Array(3); for(i=0; i<4; i++){ inp[i] = text % 10: text = Math.floor(text / 10); } document.write(inp); 1行目ではテキストボックスに4桁の数字を入力しそれを数値としてtextに代入しています。この4桁の数値を配列に1桁ずつ代入したいと考えています。最後のdocument.writeはちゃんと計算できているか確かめるために入れています。このソースだとうまく動きません。どうすればいいでしょうか？
どなたかわかる方いたら教えていただきたいです。 エクセルのVBAについての質問です。 (投稿者はVBA初心者なので、難しい話は良くわかっていません。すみません。。) 評価点数を聞く設問で回答に●●点(▲▲)という選択肢があるのですが、●●以降の「点(▲▲)」をVBAを使用して一度に消したいと思っています。 ●●は0〜100点まで変動しており ▲▲は選択肢によって文字が異なります。 また、点数の選択肢は同じ列に並んでいるわけではなく元データにランダムに出てきます。。 また回答選択肢以外にコメントなどの中にも 「満点です」というように「点」という言葉が出てくるのですが、そちらは消えないようにしたいです。 理想としているのは、 ①元データを貼る ②別のシートにA列に置換前の言葉・B列に置換後の言葉のリストを入力しておく (例) A列…「●●点(▲▲)」 B列…●● と記入しておく。 ③マクロを実行すれば、そのリストを引用して「●●点(▲▲)」を●●のみに置換した状態のデータが完成する、というマクロを作りたいと思っています。 1,2件なら手作業で大丈夫なのですが、 自分が扱うのが大量のデータになるため効率を上げたくて質問させていただきました。 どなたかわかる方いたらご教示をよろしくお願い致します。
VBScriptについて質問です。 既に開いているファイル選択ダイアログにて特定のフォルダ配下のファイルを全て選択して開くプログラムを作成したいのですが、ご教授いただけますでしょうか。
エクセルのマクロ（VBA）を使い、フォルダ内の複数Excelファイルを１つのExceファイル（１シート）にまとめたいです。下記操作を実行するコードを知りたいです。 初めて知恵袋を利用します。至らない点、ご容赦頂けると幸いです。 （※出来れば金曜日までに回答を頂けるととても助かります!!） 【経緯】 小さな会社で事務員をしておりまして、各営業の週報をとりまとめています。 約15名のデータの集約をコピペして行っていて、手間がかかります。 恥ずかしながら、作業を効率化する方法としてマクロがあるとつい最近知りました…。 【操作】 全ファイルともフォーマットは一緒で、各ファイルに3シートありますが、1番目のシートの必要なデータのみを集約したいです。 必要なデータは、A～H列の表の7行目以降からデータが途切れる箇所までです。 また、統合後のファイルのデータ入力場所もそれぞれ指定したいと思っています。 【操作詳細】 ざっくりとなってしまったので、以下に条件をまとめました。 <実行したい操作> ・複数ファイルは、それぞれの1番目のシートのみが出力対象。 ・複数ファイルの１番目のシートの、A～H列が表となっており、7行目からデータが入っている。7行目から、データの途切れる箇所までを出力したい。 ・統合後のシートには、2行目からデータを入れたい <データの出入力範囲> 複数ファイル→統合後ファイル ・A列のデータ→B列 ・B～H列のデータ→E~K列 ・C4のセルデータ→D列 ※ というカタチにしたいです （※C4に各営業の氏名が入っており、D列にて氏名を羅列したいです。例えば、最初に取り込んだ田中太郎さんの週報に4行分のデータがあったとして、統合後のシートにD2: 田中太郎 D3: 田中太郎 D4: 田中太郎 D5: 田中太郎と入力されるように設定したいです。） 【挨拶】 これで状況・条件が伝わりますでしょうか…？ この条件だと難しい等あれば、近いものでも教えて頂けると非常に助かります。 長くなってしまい申し訳ありません。よろしくお願い致します。 ※画像はイメージとして、参考までに。
デスクトップにあるＡＡＡというフォルダ内にある複数のサブフォルダ内のファイルを ＡＡＡフォルダ直下に移動させたいと思っています。サイトより引用させていただいた下記コードでエラーは出ないのですが、肝心なファイル移動ができません。 どなたかご教授お願い致します。 Sub sample() Dim FSO As Object Dim Folder As Variant Dim folderObj As Object Dim fileObj As Object Set FSO = CreateObject("Scripting.FileSystemObject") For Each folderObj In FSO.GetFolder("C:\Users\Desktop\AAA").SubFolders For Each fileObj In folderObj.Files If fileObj.Name Like "0_*" Then fileObj.Move "C:\Users\Desktop\AAA\" End If Next Next Set FSO = Nothing Set folderObj = Nothing Set fileObj = Nothing End Sub
エクセル ２つのシート、複数列の重複チェック方法 Sheet1にA列とAW列、Sheet2にA列とM列にランダムな数字が100行以上あり、重複チェックする方法を教えて頂けるでしょうか。Sheet2のA列とM列は1つの行のデータとして考え、1行単位でSheet2のA列とM列両方が一致している場合になります。 Sheet2にあるA列の対象はSheet1にあるA列と重複チェック Sheet2にあるM列の対象はSheet1にあるAW列と重複チェック Sheet2 ㅤㅤA列ㅤㅤM列 3ㅤㅤ234ㅤㅤ54 4ㅤㅤ454ㅤㅤ32 5ㅤㅤ325ㅤㅤ48 Sheet1 ㅤㅤA列ㅤㅤAW列 17ㅤㅤ359ㅤㅤ54 18ㅤㅤ289ㅤㅤ32 19ㅤㅤ454ㅤㅤ32 この場合 Sheet2の4行目とSheet1の19行目が重複になっています。 Sheet2とSheet1で条件が合う場合、 Sheet1のAX列のそれぞれの行に重複と文字を入れる。 Sheet1 ㅤㅤA列ㅤㅤAW列ㅤㅤAX列 17ㅤㅤ359ㅤㅤ54 18ㅤㅤ289ㅤㅤ32 19ㅤㅤ454ㅤㅤ32ㅤㅤㅤ重複 Sheet2側でSheet1と重複がない場合 Sheet2の重複がない行に色をつける Sheet2 ㅤㅤA列ㅤㅤM列 3ㅤㅤ234ㅤㅤ54ㅤ←この行に色を付ける 4ㅤㅤ454ㅤㅤ32 5ㅤㅤ325ㅤㅤ48ㅤ←この行に色を付ける そのあと、Sheet2は削除予定ですが、削除してもSheet1のAX列の重複の文字は残せるでしょうか？ Sheet1は17行目からデータが入っており、Sheet2は3行目からデータが入っています。 説明がわかりずらくてすみませんが、どなたかわかる方がいましたらお願い致します。 Excel 2010、Windows10 使用です。
visual studioについての質問ですこういうことに関して初心者です どんなものかと思い色々触ってみました 有料だと聞いていたのに使えるような感じでした これは勝手に料金がかかってしまったということでしょうか？ 確認する方法があれば教えてほしいです
インプットボックスに入力した値をSheet Dtで検索してその行番号を取得するようにしたいのですが、match関数がエラーになって上手く出来ません。どこが悪いのか教えて頂きたいです。Sub 検索() Dim a As Variant, b As Variant, c As Variant, d As Variant, e As Long a = InputBox("日付を入力してください。例 210610") b = InputBox("社員番号を入力してください。") If a = "" Or b = "" Then MsgBox "入力されていません" End If On Error GoTo Err_Trap Worksheets("Dt").Activate c = Application.WorksheetFunction.Match(a, Columns("B"), 0) d = Application.WorksheetFunction.Match(b, Columns("C"), 0) MsgBox "検索値は" & c & "行目、" & d & "行目です" Exit Sub Err_Trap: MsgBox "エラーコードNo." & Err.Number & vbCrLf & Err.Description MsgBox "検索値が見つかりませんでした" End Sub
VBAについてお教えください。下記のようなコードを書き、実行したら、「型が一致しません」と表示されました。Dim R as Range Dim S as String S = "cells(1,3)" Set R = Union(range(cells,1,1),cells(1,2),S) しかし、Union(range(cells,1,1),cells(1,2),cells(1,3))と実行すると問題なく動きます。 Sの中に入っているデータと直接書き込んだデータは同じなのにエラーを発生されるということは何が間違っているんでしょうか？ 何か解決策みたいなものはございますでしょうか？
エクセルで以下のようなことをやりたいです。 簡単に言うとオートフィルを関数かVBAを使ってやりたいです。 シート１に以下の様な表があります。１００ 山田 １１０ 佐藤 １１０ 川田 １１０ 斎藤 １００ 水下 シート２のA１に１００を入れるとA2以降に１００のメンバーが一覧で表示され１１０を入力すると１１０の人が表示されるようにしたいです。 （例）A1に１００を入力したら A2 １００ 山田 A3 １００ 水下 と表示される。 VBAでも関数でも構いません。 人数は可変です。
VBSです 'WMIにて使用する各種オブジェクトを定義・生成する。Dim oClassSet Dim oClass Dim oLocator Dim oService Dim sMesStr Dim a Dim seetoo seetoo = inputbox ("指定したプロセスは全て終了します","終了するプロセス名を入力","ここに入力") 'ローカルコンピュータに接続する。 Set oLocator = WScript.CreateObject("WbemScripting.SWbemLocator") Set oService = oLocator.ConnectServer 'クエリー条件を WQL にて指定する。 Set oClassSet = oService.ExecQuery("Select * From Win32_Process Where Description= " & seetoo) If Err.Number = 0 Then Else a = "実行されていないか、終了する権限がありません" end if 'コレクションを解析する。 For Each oClass In oClassSet If Err.Number = 0 Then Else a = "実行されていないか、終了する権限がありません" end if oClass.Terminate If Err.Number = 0 Then Else a = "実行されていないか、終了する権限がありません" end if a = "PID が" & CStr(oClass.ProcessId) & "のメモ帳のプロセスを終了しました。" & vbCrLf Next '使用した各種オブジェクトを後片付けする。 Set oClassSet = Nothing Set oClass = Nothing Set oService = Nothing Set oLocator = Nothing msgbox a & "",64,"終了" '表示 上のプログラムで20行目でエラーが発生してしまいますどうしたらいいでしょう？ 開発環境 ver.5.812.10586.0 言語 japanese
「excel vbaに関して」 質問します。内容は 「Sheet1」シートに入力した値を「分け方」シートで検索する そして、それを「Sheet1」シートに戻って出力する というものです。 ですが、エラーが起こります。 If FoundCell.Address = FirstCell.Address Then の部分です。 不思議なのは、検索する文字によって起こる場合と起こらない場合があることです。 http://officetanaka.net/excel/vba/tips/tips123b.htm のプログラムを元にしています。 原因を教えてください。 あと、もしもっと簡単な方法がありましたら、それもよろしくお願いします。 Sub zz() Dim FirstCell As Range, Target As Range Dim rng As Range '選択されているセルの行番号を取得する際に使用 Dim 入力 As String Dim FoundCell As Range Dim r As String '最終データが入力されているセルに移動する際に使用 Dim i As Integer Dim date_list(1000, 5) Dim 発見件数 As Integer Set FirstCell = ActiveCell 入力 = Range("F1").Value Sheets("分け方").Select Set FoundCell = Cells.Find(What:=入力, LookAt:=xlPart) If FoundCell Is Nothing Or 入力 = "" Then '見つからない、空白の場合 MsgBox "見つかりません" Exit Sub Else '見つかった場合 Set FirstCell = FoundCell Set Target = FoundCell Do Set FoundCell = Cells.FindNext(FoundCell) If FoundCell.Address = FirstCell.Address Then Exit Do Else Set Target = Union(Target, FoundCell) End If Loop Target.Select '同じものを選択する 発見件数 = 0 For Each rng In Selection '選択セルの行番号を取得する date_list(発見件数, 0) = Cells(rng.Row, 1).Value 'Box名 date_list(発見件数, 1) = Cells(rng.Row, rng.Column).Value '検索結果 発見件数 = 発見件数 + 1 Next rng Sheets("Sheet1").Select Range("A2").Select For i = 0 To 発見件数 Selection.Value = date_list(i, 0) Selection.Offset(0, 1).Value = date_list(i, 1) Selection.Offset(1, 0).Select Next End If End Sub
秀丸で指定文字数（35文字）でその文字数の一番後ろの指定文字で改行するマクロの記述方法 秀丸で指定文字数（35文字）でその文字数の一番後ろの指定文字で改行するマクロの記述方法が分からず困っています 具体的には、一行が35文字で 35文字内に「、」「。」「？ 」「（笑）」「・・・・」 「★ 」「！」 「！？」「」」などの文字があった場合、 35文字以内の一番後ろの指定文字で 改行するマクロが作りたいです 例；今日は、朝から天気が良く、真夏日になるらしいので、熱中症対策には十分気を付けたいです。（笑）庭にブールーベリーやひまわりが植えているので暑くなる前に水やりをしたいと思ます★ブルーベリーの実がなってきて色づいてきたのでもう少ししたら収穫できるのではないかと今から楽しみでなりません！？朝から水やりをした後に近所でラジオ体操をやっているので、姪っ子と甥っ子を連れて、ラジオ体操に今から行ってきます。「眠い」と思わず声にでてしまう時も多々ありますが、さぼらないように頑張りたいと思います。 上記の文章を読みやすく見栄えの良い文章に改行し1行空けたいです。 35文字以内に指定文字がない場合は35文字で改行するようにしたいです 以下のように、秀丸でマクロを組んでみたのですが、 35文字以内の一番後ろの指定文字で 改行するってところがどう記述していいのか分かりません setcompatiblemode 0x0F; begingroupundo; replaceall "^.{35}\\f" , "\\0\\n" , regular, nocasesense, nohilight; if( ! result ) beep; endgroupundo 1; replaceall "\\n" , "\\n\\n" , regular, nocasesense, nohilight; if( ! result ) beep; endgroupundo 1; selectall; copy;
EXCEL VBAでIEへのテキストの書き込みをする方法についてです。 テキストボックスにidやnameが設定されていない場合にテキスト(セルの値)を入力することは可能でしょうか。もし可能であれば、その方法を教えていただきたいです。 ちなみに、Yahooのトップページのようにそのテキストボックスは最初から選択されているため、選択済のテキストボックスへの書き込みができればそれでも結構です。 よろしくお願いします！！
Access をフロントエンド、サーバにMySQLを入れて、社内で営業管理システムの運用を開始しました。 Accessファイルはほぼフォームのみで、使用者各々のローカルに入れてあります。パイロット版なので改良頻度が激しく、更新したAccessファイルを上書きさせるのも手間なので、起動専用の別ファイルを用意しようと考えております。 ・ファイル更新日時を比較し、新しければ上書き ・上書きされたファイルを開き、起動ファイルは閉じる このようなファイルをAccess で作ってみました。 参考したのは以下のURLです。 http://okwave.jp/qa/q8682627.html こちらのコードで一つ問題なのは、サーバに置いた最新版ファイルを上書きしたあと、その最新ファイルがフォルダから消え、別の人が起動する際に「ファイルがありません」とエラーになることがあります。 下記は、 test というファイル運用で、 test_new というファイルが最新である場合、更新し、起動し、自己閉鎖するようにしてあります。 最新版が存在しない場合、上書きを行わず、起動だけを行うようにしたいです。 または、常に最新版ファイルがフォルダに残されるようにしておきたいです。 VBAスキル不足の為、どなたかご教授頂けないでしょうか。 DoCmd.RunCommand acCmdAppMinimize Dim A, B Dim AA, BB, CC, DD Dim AAA, BBB, CCC, DDD AA = "C:\test.accdb" BB = "E:\test_new.accdb" Set AAA = CreateObject("Scripting.FileSystemObject") Set BBB = AAA.GetFile(AA) Set CCC = AAA.GetFile(BB) A = BBB.DateLastModified B = CCC.DateLastModified If B > A Then Kill AA CC = Left(AA, InStrRev(AA, "\")) DD = Right(BB, Len(BB) - InStrRev(BB, "\")) AAA.MoveFile BB, CC Set DDD = AAA.GetFile(CC & DD) DDD.Name = Right(AA, Len(AA) - InStrRev(AA, "\")) End If Shell ("C:\Program Files\Microsoft Office\Office15\MSACCESS.EXE C:\test.accdb") Application.Quit
集計表に小計・合計等の式を埋め込むためのマクロを見様見真似で作ったのですが、単体の（表にデータのみ）ファイルでは実行速度は満足できるのですが、本体は（サイズ10231KBでシートは1０枚）では実行処理に3分位かかります。実行速度を向上させるためにはどの様にすると良いのでしょうか、何方かご教授の程宜しくお願いいたします。 集計表の書式はA列に小計と合計が記載されてその位置は可変し最後の小計の下に合計があるとは限らないです。行数列数は増減するが今回は入力データ【範囲はC５からAD130】です。 集計は【C,Dは各列の合計】,【E列は式（D/C）E列の式（D/C)は=IF(ISERRORを使用したいのですが上手くいきません。】【F,Gは各列の合計】、【H列に（G/F）】,【I列～R列は各列の合計】、【S,T,は各列の合計】【U列は式（T/S）】で、【S,T,U】のパターンでAD列まで３度繰返す。 作成コードは Dim r As Long, num As Long, sidx As Long, adr As String sidx = 5 'Sum関数の加算最初の行をsidxとする Application.ScreenUpdating = False For r = 2 To Cells(Rows.Count, 1).End(xlUp).Row If Cells(r, 1) = "小計" Then Cells(r, 3).Formula = "=sum(C" & sidx & ":C" & r - 1 & ")" Cells(r, 4).Formula = "=sum(D" & sidx & ":D" & r - 1 & ")" Cells(r, 5).Formula = "=(R[0]C[-1] / R[0]C[-2])" Cells(r, 6).Formula = "=sum(F" & sidx & ":F" & r - 1 & ")" Cells(r, 7).Formula = "=sum(G" & sidx & ":G" & r - 1 & ")" Cells(r, 8).Formula = "=R[0]C[-1] / R[0]C[-2]" Cells(r, 9).Formula = "=sum(I" & sidx & ":I" & r - 1 & ")" Cells(r, 10).Formula = "=sum(J" & sidx & ":J" & r - 1 & ")" 省 略 Cells(r, 28).Formula = "=sum(AB" & sidx & ":AB" & r - 1 & ")" Cells(r, 29).Formula = "=sum(AC" & sidx & ":AC" & r - 1 & ")" Cells(r, 30).Formula = "=R[0]C[-1] / R[0]C[-2]" sidx = r + 1 End If Next adr = Cells(Rows.Count, "A").End(xlUp).Row num = Range("A1", "A" & adr).Find("合計").Row If Cells(num, 1) = "合計" Then Cells(num, 3).Formula = "=sumIf(A5:AD" & sidx-1 & ",""小計"",C5:C" & sidx-1 & ")" Cells(num, 4).Formula = "=sumIf(A5:AD" & sidx-1 & ",""小計"",D5:D" & sidx-1 & ")" Cells(num, 5).Formula = "=(R[0]C[-1] / R[0]C[-2])" Cells(num, 6).Formula = "=sumIf(A5:AD" & sidx-1 & ",""小計"",F5:F" & sidx-1 & ")" Cells(num, 7).Formula = "=sumIf(A5:AD" & sidx-1 & ",""小計"",G5:G" & sidx-1 & ")" Cells(num, 8).Formula = "=R[0]C[-1] / R[0]C[-2]" 省 略 Cells(num, 28).Formula = "=sumIf(A5:AD" & sidx-1 & ",""小計"",AB5:AB" & sidx-1 & ")" Cells(num, 29).Formula = "=sumIf(A5:AD" & sidx-1 & ",""小計"",AC5:AC" & sidx-1 & ")" Cells(num, 30).Formula = "=R[0]C[-1] / R[0]C[-2]" End If Application.ScreenUpdating = True End Sub
(VBA,正規表現) VBA（VBScript)の正規表現にて、 以下の山の名前をSubMatches(0)等に切り出したい 定義すべきパターンを教えて下さい利用する目的は同じ山名の数がいくつ登録されているか 調べたいためです（仮題） ◆現時点でパターンがコードできません A列ーA1〜A4に （１）富士山 （２）富士山,桜島 （３）桜島,富士山(静岡),八ヶ岳(長野) （４）八ヶ岳,月山,富士山(静岡) （１）〜（4)の番号は含みません。 各山は半角コンマ(,)で区切られてます 山名と山名の間には、全半角のスペースも存在しません 但し、山名の直後に所在位置の県名が半角の括弧「(,)」で 囲まれて付加されてる場合があります。 必要なのは山名だけです。 現時点で苦悶中のパターン "[^\,*](.+?)[\)\,]" ですが、混乱し全く機能しておりません 特に、 （１）のように,前後に、半角コンマがないケースとあるケース （２）（３）のように、県名が続かないケースと続くケース 等々を、統合されたパターンでどう記述すべきか、 システム XP(SP3), XL97
Visual Basic 2005のシステムをVisual Basic 2015にリプレースするやり方の段取りはどうすればよいかご存知でしょうか。 何卒、よろしくお願い致します。
Excel、VBA、リストボックス、複数列表示（条件付き）について教えてください。 下のVBAがうまく動きません。ご教授お願いします。worksheets(2) -------------------------------- 項目1 項目2 あああ 1 いいい ううう 1 えええ おおお 1 ------------------------------------ Private Sub UserForm_Initialize() Dim i As Long Dim lastRow As Long ListBox1.ColumnCount = 2 For i = 2 To 6 If Worksheets(2).Cells(i, 2) = 1 Then ListBox1.AddItem Worksheets(2).Cells(i, 1) ListBox1.List(i - 2, 1) = Worksheets(2).Cells(i, 2) End If Next End Sub ★目的 worksheets(2)のB列が1の行だけを リストボックスに表示する。 ★状況 ListBox1.List(i - 2, 1) = Worksheets(2).Cells(i, 2) でエラーがでるようです。 ちなみにIFを外すと、全部表示されてしまいますが、 エラーはでません。 ★エラーメッセージ※excel 2016 実行時エラー380 Listプロパティを設定できません。プロパティの値が無効です
エクセルの検索について エクセルで予約表作成をしています。 予約表にID入力したら名前が表示されるところまでは関数でできたのですが、その後の予約券作成で苦戦しております。どなたかお助けいただけないでしょうか。 投稿者はエクセルもマクロも初心者です。 予約表シート（例：8月15日、8月16日など。今後も増えます。）に入力したIDを検索し、予約表シートにIDがある場合は予約券印刷のシートに予約表のC2の日にち（もしくはシート名の日にち）と、予約時間（IDにあてはまる行と、BもしくはHの時間）をそれぞれ出力してもらいたいです。 上記ができれば関数でもマクロでも何でも構いません。 http://officetanaka.net/excel/vba/tips/tips123c.htm を参考にさせていただきましたが、私の知識不足で上記課題の解決に至りませんでした。 関数では増えていく予約表シートに対応するのが難しいように感じ、マクロは参考書を購入して読んでいる最中ですのでほとんど分かりません。 増えていくシートも検索対象にできるのであれば、マクロのほうが今回の課題解決になると思っています。 ご指導、ご鞭撻のほど宜しくお願いいたします。
条件付き書式のオートフィルコピー？はできますか？E4:AJ4の最大値のセル背景色を黄色にする条件付き書式を設定しています。 ↓ 通用先 =$E$4:$AJ$4 書式設定 =MAX($E$4:$AJ$4) 4行から17行まで同じ設定をしたいです。 ※加えて最小値（色は黄色以外）も設定します。 書式コピーもうまくできなく、このファイルが全部で5つあり、時間かければ不可能ではありませんが、この機会に覚えたいという思いもあります。 Excel関数でできなければ、VBAでも教えていただければ幸いです。 VBAは勉強中です。 よろしくお願いします。
ExcelVBAについての質問です。アルファベットを半角にしたいですが、対象はシート全体じゃなくて、A4からA33,そして、A38からA42までのセルの内容です。教えてください、お願いします。。(英文字だけでもいいし、じゃなくてもいいです、要はセルに入ってる内容を半角にしたいです)
PICのバーサライタプログラミング(CCS-C)で悩んでいます。(ハードウェアは作り終えており、これまで色々な動作が出来ていたことから、誤配線等はないと思います) 表示文字1は問題なく表示されるのですが、表示文字2が表示された後、表示文字1が表示されるようになってしまい、☆の行(表示文字2の左スクロール)が処理されません。 【現象】 i == 256のままでは全点灯もせず、表示文字2の左スクロールもせず、表示文字1が表示される。 i == 256の部分をi == 255に変えてみると、全点灯するが、 その後、表示文字2の左スクロールせずに、表示文字１が表示されてしまう。 変数iの値が255の後、0か何かにに戻ってしまっているように思えるのですが、何故そうなるのか分かりません。 i==255とi==256で明らかに動作が異なっています。 やりたいこと：表示文字2を左にスクロールさせたい どなたか、ご教授頂けると助かります。 環境：MPLAB IDE8.92 + CCS-C、Windows10(64bit)、書込みはPickit3。時計型バーサライタ #include <16F883.h> #FUSES INTRC_IO,NOWDT,NOPROTECT,PUT,BROWNOUT,NOMCLR #use delay( CLOCK = 8000000 ) #use fast_io(A) #use fast_io(B) //表示文字1 int const dataA1[166]={0x20,･･･}; int const dataC1[166]={0x20,･･･}; int const dataB1[166]={0x00,･･･}; //表示文字2 int const dataA2[212]={0xC0,･･･}; int const dataC2[212]={0x00,･･･}; int const dataB2[212]={0x00,･･･}; int i; int k; void main() { setup_oscillator(OSC_8MHZ); set_tris_b( 0x20 );//0:出力モード、1:入力モード set_tris_a( 0x00 ); set_tris_c( 0x00 ); output_a(0x00); output_b(0x00); output_c(0x00); i=0; while(1) { if(input(PIN_B5)==1)//一回転したらフォトインタラプタから入力信号あり。 { i++; if (i<=50)//文字1を表示する時間設定 { for( k=0; k <= 167; k++)//表示文字1を表示 { output_a( dataA1[k]); output_c( dataC1[k] ); output_b( dataB1[k] ); delay_us(300); } } else if (i<=217) //50+167：文字1を左スクロールする時間設定 { for( k=1; k <= 167-(i-51); k++)//表示文字1を左にスクロール { output_a( dataA1[k+(i-51)]); output_c( dataC1[k+(i-51)]); output_b( dataB1[k+(i-51)]); delay_us(300); } } else if (i <= 267)//文字2を表示する時間設定 { for( k=0; k <= 211; k++)//表示文字2を表示 { output_a( dataA2[k]); output_c( dataC2[k]); output_b( dataB2[k]); delay_us(350); } //↑ここまでは問題なく動作する。 if (i == 256) //↑☆ここでi==255とすると、下の全点灯処理が行われた後、表示文字1が表示される。 //i==256のままだと、全点灯もせず、表示文字１が表示される。 { output_a(0xFF); output_c(0xFF); output_b(0xFF); delay_ms(500); output_a(0x00); output_c(0x00); output_b(0x00); } } else if (i<=478)//←これ以降の行は処理されず、表示文字1が表示されてしまう。 { for( k=1; k <=211-(i-270); k++)//表示文字2を左にスクロール { output_a( dataA2[k+(i-270)]); output_c( dataC2[k+(i-270)]); output_b( dataB2[k+(i-270)]); delay_us(200); } } } output_a(0x00); output_b(0x00); output_c(0x00); } }
エクセル2013でVBA実行時エラーについて質問させてください。下記Mcroを実行すると 「実行時エラー'1004': アプリケーション定義又はオブジェクト定義のエラーです。」と出ます。この実行エラーが出ないようにしたいのですが、コードのどこを直せばよいのか教えてください。よろしくお願いいたします。 Private Sub Worksheet_SelectionChange(ByVal Target As Range) Dim 取消線 As Boolean Dim 文字太 As Boolean Dim MaxRow As Integer Dim 文字色, i As Long If Target.Row >= 3 Then If ActiveCell.Font.Strikethrough = True Then '値 値 = Cells(Target.Row, Target.Column).Value '取り消し線 取消線 = True '文字の太さ 文字太 = False '文字色 文字色 = RGB(128, 128, 128) Else '値 値 = Cells(Target.Row, Target.Column).Value '取り消し線 取消線 = False '文字の太さ 文字太 = True '文字色 文字色 = RGB(0, 0, 0) End If MaxRow = Cells(Rows.Count, Target.Column).End(xlUp).Row For i = 3 To MaxRow If 値 = Cells(i, Target.Column).Value Then ' If 取消線 = True Then Select Case TCol Case 9, 10 '文字色 Range(Cells(i, Target.Column), Cells(i, Target.Column + 1)).Font.Color = 文字色 'RGB(128, 128, 128) Case Else '文字色 Cells(i, Target.Column).Font.Color = 文字色 'RGB(128, 128, 128) End Select Cells(i, Target.Column).Font.Bold = 文字太 'False Cells(i, Target.Column).Font.Strikethrough = 取消線 End If Next End If End Sub
Office2003を使っています。例えば... 1 2 3 4 5 6 7 8 9 10 10 9 8 7 6 5 4 3 2 1 このように数字の入ったセルがあったとして３ポイント以上離れた数字だけを線で結ぶとかって出来ますか？
プログラム超初心者です。業務命令で、VB.net VBA SQL などを使いプログラムを組まなければいけなくなりました。 しかし、データベースの知識も殆ど無い状態でSQLとVB.netの基礎の講習を受けただけの知識しかなく、息詰まっています。 プログラム自体は、測定器からRS232Cを使って(プログラムを組んで)データをＤＢに取込み、そのデータをX-RS管理図にし、連続上昇などの場合には警告を表示したり、製品番号から製品情報を表示させたりするといったものです。 通信プログラムを組みＤＢに書き込み、そのデータを元に管理図などのプログラムを…位は分かっているのですが、具体的にどの様なプログラムを組めば良いか行き詰まっています。 こんな私が、どの様な勉強をするのが良いか、またプログラムを組んで行く上でどの様な点に注意するべきか教えて下さい。
[25枚]vbaのオーバーフローについて質問です。 Clen(8030/81) の値をセルに入れようとするのですが、 オーバーフローエラーが出てきます。Clen関数で整数に丸め込んでいるのに オーバーフローエラーが出るのはなぜでしょうか？ ご教授のほど、よろしくお願いいたします。
マクロでHyperlinkを起動するとエラーとなりますGoogleMapで表示させる地名をExcelにリスト記載し、どれかの地名をＷクリックすることにより、Ｅ４セルに表示させ、Ｅ３セルのHyperlinkを自動起動させています。 自動起動した途端にエラー９（インデックスが有効範囲にありません）が発生する。 Excel画面は図のとおりです。 マクロは次の通りです。 Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) 地図場所 = Range(Target.Address).Value If Target.Column = 5 Then Range("E4").Value = 地図場所 MsgBox Range("E4").Value & " をリンク表示します" Worksheets("Sheet1").Range("E4").Hyperlinks(1).Follow NewWindow:=True ''実行時エラー'9' インデックスが有効範囲にありません End If End Sub どこを改善すれば良いでしょうか？ よろしくお願いします。
ファイルコピーのアイデアを頂きたいです。 Access2013 で営業管理データベースを作成しました。 まだパイロット版で、皆の意見を聞きながら改良を続けています。Accessはフロントエンドとして使用、DATAはMySQLに入れております。 ですので、使用するメンバー個々のローカルにフォームのみ入れてあるAccessファイルを渡して運用しています。 改良(マイナーチェンジ)する都度、会社の共有フォルダに置いてある最新版ファイルを、ローカルPCにコピペしてもらう、という運用方法が最もシンプルなのですが、共有フォルダのファイルに複数人での手作業コピペをさせると、ドラッグしたり消去したりという誤作動が起きると思います。都度Backupするので再現は難しくありませんが、そんな作業は無駄ですよね。 本来なら WinUpdate みたいに自動で更新したいところですが、そうもいかないので、ひとまずVBAでコピペ作業を行いたいと考えております。 やり方は3通り考えられると思います。 1.既存のファイルではなく、更新の為だけのAccessファイルを別ファイルとして作成 2.既存ファイルを開くたびに、自動で上書きさせる 3.既存ファイルにボタンを作成、上書きさせる 特徴としては、 1.だと、更新の為だけに別作業をしなければなりませんが、確実に出来ます。 2.開くたびだと、わざわざ更新の手間は省けますが、開くたびに少々重く、負荷もかかる。 3.必要な時だけ更新すれば良いが、更新した旨のアナウンスの手間がかかる。 また、2、3、の方法だと、ファイルを開いた状態で上書きさせる、という事が可能かどうか、また可能であっても私のスキルでは困難で、皆様のご指導が必要です。 どの方法が良いか、またその場合、どのようなコードを記述すれば良いか、ご指導頂けると嬉しいです。 また、使用メンバーのPCによって、ファイル格納フォルダがC:\であったりE:\であったりマチマチです。 Cルート用、Eルート用、の2ファイルを作って各々に配布する、というのも芸がありません。 かといって、現段階での環境としては、CまたはEルートに統一するのも難しいです。 そのあたりもアドバイス頂けると最高です。 よろしくお願いします！
VBAの初心者を脱するのにオススメの本を教えていただけないでしょうか。「Excel VBA 超入門教室 Excel2010/2007/2003対応 (教えて!蔵之介先生シリーズ) 」 を使い終わったところです。次に読むのに良い本を教えていただけないでしょうか。 以上、何卒よろしくお願い致します。
マクロ初心者です。 希望マクロが作成できないため 助けて頂きたいです。 【book1】の"管理シート"に以下のような表があります。A列 B列 C列 D列 読み込みコード 製品名 部品名 部品コード 読み込みコードのA列にはバーコードでデータを読み取り、 別ブック【データ一覧】"sheet1"のA列から検索します。 先ほどの表のB列製品名、C列部品名、D列部品コードにデータ一覧表ブックから読み込みデータと一致するデータを貼り付けしたいです。 マクロでの処理を考えています。 以下のマクロを他のマクロを応用し作ったのですがうまくいきません。 Sub 抽出() Application.ScreenUpdating = False マクロファイル名 = ActiveWorkbook.Name 最終行 = Cells(65536, 1).End(xlUp).Row 行程 = ActiveSheet.Name Workbooks("データ一覧").Activate Sheets("sheet1").Select Workbooks(マクロファイル名).Activate For i = 3 To Cells(65536, 1).End(xlUp).Row Workbooks(マクロファイル名).Activate Flag = 0 注番 = Cells(i, 2) Workbooks("データ一覧").Activate Sheets("sheet1").Select With Range(Cells(1, 24), Cells(Cells(65536, 24).End(xlUp).Row, 24)) If Not .Find(注番) Is Nothing Then 現在行 = .Find(注番).Row 製品名 = Cells(現在行, 4) 部品コード = Cells(現在行, 8) 部品名 = Cells(現在行, 9) Workbooks(マクロファイル名).Activate Cells(i, 3) = 製品名 Cells(i, 4) = 部品コード Cells(i, 5) = 部品名 Else Workbooks(マクロファイル名).Activate MsgBox "検索できません" End If End With Next i Application.ScreenUpdating = True MsgBox "終了しました。" End Sub このようなマクロでなくても構わないので ぜひわかる方のお力をお借りしたいです。 宜しくお願い致します。
Visual Basic2015において、マウスを押している間のPictureBox上のRGB値を取得するようなプログラムを作りたいです。Dim r2 As Byte, g2 As Byte, b2 As Byte Dim b As Bitmap = PictureBox1.Image Dim color As Color = b.GetPixel(e.X, e.Y) Dim bytR As Byte = color.R Dim bytG As Byte = color.G Dim bytB As Byte = color.B r2 = bytR.ToString() g2 = bytG.ToString() b2 = bytB.ToString() Label8.Text = r2 Label9.Text = g2 Label10.Text = b2 上記のプログラムで取得しようと考えたのですが、上記のプログラムをMouseDownのSubに置いてもマウスを押した瞬間のPictureBox上のRGB値のみしか取得できません。 押したまま動かしている間でも、カーソルの下のRGB値を取得するにはどうすればよいでしょうか。
エクセルでの勉強記録表 こんにちわ。 行動記録表をエクセルで作りたいと考えています。図のようにsheet1には10分ごとに区切られたグラフがあります。sheet2には例えばA1に9:00、B1に9:56 C1 に生物 A２に10:01、B2に10:28、C2に休憩 というように、sheet2には開始時間、終了時間、行動 を入力していけばsheet1には時間分の色付け、行動のデータが反映されるようにしたいです。 しかしとても難しく、VBAも勉強中なのですがまったく歯が立ちません。 どなたか関数やVBAを使ってもよいので教えて頂けないでしょうか？ エクセルは2010です。表は縦でも横でもかまいません。sheet2の入力箇所も特に決まっていません。 色も2色のみでよいです。 時間と行動を入力すれば、セルの色がつきその下に行動が入力されるようにしたいです。 よろしくお願いします。
セルの値を保存名に及び指定の（ディスクトップ）に保存するマクロについて ほかの知恵のところからひっぱってきたのですが、デスクトップに保存されません。足りないコード、正しいコードを教えて下さい。宜しくお願いいたします。 今このような感じで登録してあります↓ Private Sub 保存_Click() Dim fileName As String ThisWorkbook.SaveAs "C:\Users\myname\Desktop" & fileName '指定フォルダに保存 fileName = "保存名 " & Range("B8") & "様 " & Range("J8") & " 日程 " & Range("E2") & " ～" & Range("E3") & " 会議日" & Range("I4") & ".xltm" 'ファイル名作成 If MsgBox(fileName & " で保存しますか？", vbYesNo) <> vbYes Then Exit Sub '保存するか確認して保存しない場合は終了 Application.DisplayAlerts = False '同名のファイルがある場合の警告禁止(必要なら) Application.DisplayAlerts = True '警告許可(上で警告禁止した場合は警告許可に戻す) End Sub
VBA初心者です。ご迷惑お掛けしてすみません。 下のマクロに、AE列に"A"という文字列があった場合、 その行を削除する、という処理を追加したいと思っています。見よう見まねで作ったものの、分からなくなってしまったので教えてください。 作成中のマクロ----------------------------------------- Sub ボタン_Click() Application.ScreenUpdating = False Dim FileName As String ChDrive Left(ThisWorkbook.Path, 2) ChDir ThisWorkbook.Path FileName = Dir("*.xls*") Do While FileName > "" If FileName <> ThisWorkbook.Name Then Workbooks.Open FileName Range("J:J,L:L,N:N,P:P,R:R").Delete Shift:=xlToLeft ActiveWorkbook.Save ActiveWorkbook.Close End If FileName = Dir Loop Application.ScreenUpdating = True End Sub ------------------------------------------------------------
例えばセルA1 30 セルB2 60...60/30＝2.0の時があったとして1.5以上の所だけ↑と表示したい時はどうしたら良いのですか？
VBでSDメモリに書き込まれたバイナリデーターを読込みたいのですが、InputBコマンドを用いてバイナリデーター列を読み込んだ所、０ｘ００のデーターだけが読み込まないで無視されています。全ての値のバイナリデーターを読込む方法はありませんでしょうか？ ちなみにVBのソースは次の通りです。 Dim buf As Variant Open myFileName For Input As #1 buf = InputB(10, #1)
Function CellColor(セル) CellColor = セル.Interior.ColorIndex End FunctionSub セル色数値換算()Dim Aa As Integer Dim Bb As Integer Aa = 4 Bb = 22 Range("C" & Aa + 0 & ":" & "BI" & Aa + 0).Formula = "=cellcolor(""C"" & bb +0)" Range("C" & Aa + 1 & ":" & "BI" & Aa + 1).Formula = "=cellcolor(""C"" & bb +3)" End Sub 下記のうように動かしたいのですが "=cellcolor(C22）” "=cellcolor(C25）” bbと入力して変数のBbに変換できないのもどうしたら良いのかわかりません。 どのようにしたらよいかわかりません。 教えて頂けないでしょうか。
下記マクロは、インターネットよりデータを取得し終了させるものですが 終了時に画面のチラつきが出ます。 これを無くしたいのですが良い方法は無いでしょうか? 宜しくお願いいたします。Sub Data更新() Application.ScreenUpdating = False Dim WB1, nbook As Workbook Dim sh1, d1, hist As Worksheet Set WB1 = Workbooks("book1.xlsm") Set sh1 = WB1.Worksheets("mein") Set d1 = WB1.Worksheets("Data1") '読取専用サイトを開く sh1.range("B64").Hyperlinks(1).Follow NewWindow:=False 'False Set nbook = ActiveWorkbook Set hist = nbook.sheets("histryall_dl") '読取サイトのデータをコピー d1.range("C24:BO36").Value = hist.range("C24:BO36").Value ' 読取専用ファイルを閉じる nbook.Close SaveChanges:=False Set WB1 = Nothing Set sh1 = Nothing Set d1 = Nothing Set nbook = Nothing Set hist = Nothing Application.ScreenUpdating = True End Sub
EXCEL VBAでの質問です。Dim cb As New DataObject txtA = cells(1,1).value With cb .SetText txtA .PutInClipboard End With のような流れでクリップボードにデータを入れる記述をしていました。 EXCEL 2010 Windows7 のときは問題なく運用出来ていましたが Windows10にアップデートしてからコピーした文字列をテキストエディタなどに貼り付けようとした時に 「・・」となり正常に貼り付け表示されません。 どなたか対処法をご存じの方いませんでしょうか？
VisualBasic.NETでPC/SCに対応したリーダライターを制御したいのですが、当方PC/SCの基本がわかりません。 基本がわかるサイトはどれもあたりましたが、いまいち頭に入りません。 コードがあれば多少わかるかもしれませんが、VB PC/SCとネット検索しても出てこないためわからない状態です。PC/SCに詳しい方よろしければ教えていただければと思います。よろしくお願いいたします。
エクセルマクロ 計算結果がマイナスの時にメッセージボックスを表示させるには、どう記述したらよいでしょうか？ よろしくお願いします。
Sub 行の表示() Rows.Hidden = False End Sub を、非表示の行のある各シートで行うと、 行が全表示されるシートと、されないシートがあります。全表示されないシートでは、 例えば、5行目～1000行目が非表示となっている場合、 Rows("5:1000").Hidden = False では、全表示されますが、 Rows("5:1001").Hidden = False や、 Rows("4:1000").Hidden = False となると、何も起こらなくなります。 どのような事が考えられるでしょうか？
EXCELのマクロでソルバーを連続して自動で求めるマクロを組みたいと思っています。下記のようなマクロを組んだのですが、実行するとソルバー実行のエラーが出現し 「Error in model. Please verify that all cells and constraints are valid.」と表示されソルバーが実行されません。 下記のマクロのどこがおかしいのか、ご教示いただけませんでしょうか？ （なお変化させるセルはM21からAJ２１で、23行ごとに10回繰り返します。数値が入力できる状態になっています。上記のエラーメッセージは10回表示されるので、なにかしらの処理を使用としていることしているようです） 宜しくお願いします。 ------------------------------------------------------------------------------------------ Sub Macro3() StartTime = Time Application.ScreenUpdating = False Dim 機種変更数 As Long: 機種変更数 = 0 For 機種変更数 = 0 To 9 SolverOK SetCell:=Worksheets("テスト").Cells(23 * 機種変更数 + 21, 4), MaxMinVal:=2, ByChange:=Worksheets("テスト").Range(Worksheets("テスト").Cells(23 * 機種変更数 + 21, 13), _ Worksheets("テスト").Cells(23 * 機種変更数 + 21, 36)) SolverAdd CellRef:=Worksheets("テスト").Range(Worksheets("テスト").Cells(23 * 機種変更数 + 21, 13), Worksheets("テスト").Cells(23 * 機種変更数 + 21, 36)), Relation:=1, _ FormulaText:=Worksheets("テスト").Range(Worksheets("テスト").Cells(23 * 機種変更数 + 22, 13), Worksheets("テスト").Cells(23 * 機種変更数 + 22, 36)) SolverAdd CellRef:=Worksheets("テスト").Range(Worksheets("テスト").Cells(23 * 機種変更数 + 17, 13), Worksheets("テスト").Cells(23 * 機種変更数 + 17, 36)), Relation:=1, _ FormulaText:=0.9 SolverAdd CellRef:=Worksheets("テスト").Cells(23 * 機種変更数 + 7, 36), Relation:=1, _ FormulaText:=Worksheets("テスト").Cells(23 * 機種変更数 + 25, 36) SolverAdd CellRef:=Worksheets("テスト").Cells(23 * 機種変更数 + 10, 13), Relation:=1, _ FormulaText:=Worksheets("テスト").Cells(23 * 機種変更数 + 12, 13) + 2000 SolverAdd CellRef:=Worksheets("テスト").Cells(23 * 機種変更数 + 10, 13), Relation:=3, _ FormulaText:=Worksheets("テスト").Cells(23 * 機種変更数 + 12, 13) - 2000 '整数 SolverAdd CellRef:=Worksheets("テスト").Range(Worksheets("テスト").Cells(23 * 機種変更数 + 21, 13), Worksheets("テスト").Cells(23 * 機種変更数 + 21, 36)), Relation:=4 SolverSolve Next 機種変更数 '/////////////////////////////////////////////////////////////////// Application.ScreenUpdating = True StopTime = Time StopTime = StopTime - StartTime MsgBox "所要時間は" & Minute(StopTime) & "分" & _ Second(StopTime) & "秒 でした" End Sub
visual stdioについて質問なのですが、この画像のような複数の項目で1と3だけが入力されている場合2が入力されていないため歯抜け状態になります。このような状態のときにエラーメッセージを表示させたいのですがどのようにすればよいのか教えてください
ExcelのVBAを使ってさいころの目の発生プログラムを書きたいです。
こんばんわ プログラムのVBAについて質問です。エクセルのシートにテキストボックスとコンボボックスを設置して、 コンボボックスの選択に合わせてテキストボックスの内容を変更するシステムを 作っています。 コンボボックスのプロパティにfmMatchEntryCompleteを設定し、 テキストボックスにはクリックイベントを設定しています。 今の状態ですと、コンボボックスに入力をした時にfmMatchEntryCompleteによって 候補が自動入力され、自動入力によってコンボボックスが選択状態になりテキストボックスのクリックイベントが動作して、私の要求通りの動作をしているのですが・・・ コンボボックスの一番最後の内容を入力しても、入力候補を自動入力するところまでは動くのですがコンボボックスが選択されず、クリックイベントが動かない状態になっていて困っています。 コンボボックス：000 001 002 Sub テキストボックス_Click 値変更の処理 End Sub 上記の内容で「000」と「001」は自動入力+クリックイベントで問題なく動作するのですが、 一番最後の要素の「002」を入力すると自動入力のみでクリックイベントが発生してくれないのです。 一番最後の要素もコンボボックスからクリックすれば、クリックイベントとして動作します。 一番最後の要素も入力してテキストボックスを変更させたいのですが、どうすればいいのでしょうか。 コンボボックスのプロパティのfmMatchEntryComplete、テキストボックスのクリックイベントとコード的な問題が見当たらないと思っているのですが・・・ ご教授願います。
EXCEL ＶＢＡのファンクションへの配列渡しでつまずいています。やりたいことはfunctionに配列を渡して操作するという物ですが、うまくいかなかったので単純化して まず配列をわたして中身が見えるか試してみたのですがダメでした。 ネットで調べてやり方は間違っていないと思うのですが、何処が悪いのかわかりません。 以下のコードを実行すると次のようなメッセージが出ます。 「コンパイルエラー 型が一致しません：配列またはユーザー定義型を指定してください」 ---------- コード始まり ------------------------------------- Sub main() Dim tmp(3) As Integer tmp(0) = 23 tmp(1) = 94 tmp(2) =120 tmp(3) = 56 func1 (tmp()) End Sub Function func1(ByRef t() As Integer) Dim Y As Integer Y = 1 With Worksheets("sheet2") For i = 0 To 3 .Cells(Y + i, 2) = t(i) Next i End Function ------- コード終わり --------------------------------
VBA sheet1のC4～C23までデータが入力されています。 そのデータをsheet2 G7～AT7に転記する場合のコードは どう作成したら良いのでしょうか。sheet2 G7～AT7は（G7,H7) （I7,J7) (K7,L7) ・・・・(AS7,AT7) というようにセルが結合されています。 色々試したですがうまくいきません。よろしくお願いします。
Paraflaで脱出ゲームをつくっています。左右２つのボタンを「左左右右左右」と押すと、_root.last_pass_6 = true になるようにしたいですがうまくいきません。変数がよくわからないので以下の方法で記述しましたが、どこがおかしいでしょうか？ またもっとすっきりさせられますか？ ※_root.last_pass_1ー6は、初期化で「false」に設定してあります。 ＜左＞ on(release){ if(_root.last_pass_1 == false) {_root._last_pass_1 = true; _root.message = ""; _root.s_message.gotoAndPlay("push"); }else if ((_root.last_pass_1 == true)&&(_root.last_pass_2 == false)){ _root._last_pass_2 = true; _root.message = ""; _root.s_message.gotoAndPlay("push"); }else if (((( (_root.last_pass_1 == true)&&(_root.last_pass_2 == true)&& (_root.last_pass_3 == true)&&(_root.last_pass_4 == true)&& (_root.last_pass_5 == false) )))){ _root.last_pass_5 = true; _root.message = ""; _root.s_message.gotoAndPlay("push"); }else{ _root.last_pass_1 = false; _root.last_pass_2 = false; _root.last_pass_3 = false; _root.last_pass_4 = false; _root.last_pass_5 = false; _root.last_pass_6 = false; _root.message = ""; _root.s_message.gotoAndPlay("push");} } ＜右＞ on(release){ if(( (_root.last_pass_1 == true)&&(_root.last_pass_2 == true)&&(_root.last_pass_3 == false) )){ _root._last_pass_3 = true; _root.message = ""; _root.s_message.gotoAndPlay("push"); }else if((( (_root.last_pass_1 == true) && (_root.last_pass_2 == true) && (_root.last_pass_3 == true)&&(_root.last_pass_4 == false) ))) {_root._last_pass_4 = true; _root.message = ""; _root.s_message.gotoAndPlay("push"); }else if((((( (_root.last_pass_1 == true) && (_root.last_pass_2 == true) && (_root.last_pass_3 == true) && (_root.last_pass_4 == true) && (_root.last_pass_5 == true)&&(_root.last_pass_6 == false)))))) {_root._last_pass_6 = true; _root.message = ""; _root.s_message.gotoAndPlay("push"); }else{ _root.last_pass_1 = false; _root.last_pass_2 = false; _root.last_pass_3 = false; _root.last_pass_4 = false; _root.last_pass_5 = false; _root.last_pass_6 = false; _root.message = ""; _root.s_message.gotoAndPlay("push");} }
VBA超初心者です。教えてください 選択したセルの外側に実線（xlcontinuous） 内側の線を波線にするマクロが作りたいのですが Sub Macro1() Selection.BorderAround.LineStyle = xlContinuous Selection.Borders.xlHorizontal = xlDot Selection.Borders.xlVertical = xlDot End Sub これではなぜダメなのでしょうか？全く分かりません。どうか宜しくお願い致します
Visual Basic2015でお絵かきソフトを作っています。 下記のプログラムで制作しているのですが、どうしてもペンが途切れてしまいます。ペンを途切れさせずにこのような形でお絵かきソフトを作ることはできないでしょうか。 Public Class Form1 Dim DrawFlg As Integer 'ドローモード Dim Gr As Graphics 'グラフィックオブジェクト Dim intX As Integer 'マウスポインタX Dim intY As Integer 'マウスポインタY Dim g As Graphics Dim picbmp As Bitmap Dim mpen As New Pen(Color.FromArgb(150, 0, 0, 0)) Dim wid As Integer Dim pr As Byte, pg As Byte, pb As Byte Dim camr As Byte, camg As Byte, camb As Byte Dim cr As Byte = 255, cg As Byte = 255, cb As Byte = 255 Dim myBrush As SolidBrush = New SolidBrush(Color.FromArgb(cr, cg, cb)) 'フォーム Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load picbmp = New Bitmap(PictureBox.Width, PictureBox.Height) PictureBox.Image = picbmp g = Graphics.FromImage(PictureBox.Image) g.FillRectangle(myBrush, PictureBox.ClientRectangle) 'グラフィックオブジェクトを作成します。 Gr = Graphics.FromImage(PictureBox.Image) End Sub 'フォームを閉じたとき Private Sub Form1_Closing(ByVal sender As Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles MyBase.Closing 'グラフィックオブジェクト解放 Gr.Dispose() End Sub '左クリックしたとき Private Sub PictureBox1_MouseDown(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles PictureBox.MouseDown 'ドローモード DrawFlg = True intX = e.X intY = e.Y End Sub '左クリック動かすとき Private Sub PictureBox1_MouseMove(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles PictureBox.MouseMove Label2.Text = e.X Label4.Text = e.Y If DrawFlg = False Then Exit Sub End If 'ドローモード、初期色 Gr.DrawLine(mpen, intX, intY, e.X, e.Y) mpen.Width = wid '描画 PictureBox.Refresh() 'ポインタをレジスト intX = e.X intY = e.Y End Sub '左クリック離したとき Private Sub PictureBox1_MouseUp(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles PictureBox.MouseUp 'ドローモード初期化 DrawFlg = False End Sub
VBAで検索システムを作っています。 自分で調べれる範囲いろいろ改良しましたがすぐエラーが出てしまったりします。システムとしては、シート1にあるボタンでユーザーフォームを出しユーザーフォームには書名、著者名、シリーズ名がそれぞれ打ち込めるようにしており、検索のボタンも作っています。 検索のボタンを押すとシート2には書名、著者名、シリーズ名などの書誌リスト(1000件)があり、その中からそれぞれの各項目で適合する文献をシート1の6行目以降ににコピーしたいです。 またこれは、複数項目埋めた場合はそのすべてに適合する文献を探し、すべての項目埋めない場合は、メッセージボックスで注意をし該当文献が見つからない場合もメッセージボックスで知らせます。 検索結果が出た場合、それをカウントしておきそれもメッセージボックスで出すようにしたいです。 今私が仕上げた現状が下記です。アドバイスをいただけると助かります。 お願いします。 Private Sub kensaku_Click() Dim sh1 As Worksheet Set sh1 = Sheets("sh1") Dim sh2 As Worksheet Set sh2 = Sheets("sh2") Dim T1 As Variant Dim author As Variant Dim Series As Variant Dim i As Long Dim j As Long Dim cnt As Long Books = TextBox1 authors = TextBox2 Series = TextBox3 If Books = "" And authors = "" And Series = "" Then MsgBox ("どれかに入力してください") Go to Label1 End If For i = 2 To 1000 Step 1 j = 6 cnt = 0 If Books = [sh2.Cells.("i",4).Value] Or Books = "" And authors = [sh2.Cells.("i",5).Value] Or authors = "" And Series = [sh2.Cells.("i",6).Value] Or Series = "" Then Rows("i").Copy sh1.Rows("j").PasteSpecial cnt = cnt + 1 j = J + 1 End If Next i MsgBox (""cnt"件該当") End If cnt = 0 Then MsgBox ("該当文献はありません") End If Label1: End Sub
vbaでの在庫管理で困っています。210などの品番が100種以上あり、 縦軸に品番、横軸に日付けがあり、 1日 2日 3日 在庫数 210 生産数 残数 というようになっております。 textbox1=日付け textbox2=品番 textbox3=在庫数 textbox4=生産数 と記入欄を作成したのですが、 select Case日付け、品番を条件付けて記載していくと、膨大な量のプログラムになってしまいました。 何か効率の良い方法はございませんでしょうか。 初心者なもので、vlookupを使いたいのですが、使い方がわかりませんでした。 どなたかわかる方居られましたら、宜しくお願い致します。
現在開いているマクロブック以外のマクロブックを開こうとした時に、強制的に開けないようにする方法はありませんか？売上管理A.xlsmというファイルを起動していたとして、他に売上管理B.xlsmや売上管理C.xlsmなど違うマクロブックを開こうとした時に、誤作動防止のため強制的に開けないようにしたいのですが良い方法はないでしょうか。 できれば売上管理〜と名のついたファイルを複数開けないようにしたいですが、エクセルファイル自体複数開けなくしても大丈夫です。 よろしければお力添えお願いします
エクセルでバーコードリーダーを使用して同一商品なのかのチェックするソフトを開発したいのですが、ＶＢＡでどの様なプログラムを組めば良いのでしょうか（リーダからエクセルへバーコードを取り込む方法を教えて下さい）。 バーコードを読ます。 もう一方のバーコードを読ます。 この二つのバーコードが一致しているかどうかの判別。
エクセルのオートシェイプ（線）を右クリックすると、「マクロの登録」が表示されますが、これを使って、あるセルを参照して、オートシェイプの線の長さを変えたいです。
以前、計画を組むに当たりソルバーの組み方について詳しく教えて頂いた者です。 あれは誠に素晴らしい案でして、上司にも褒めて頂きました。 どうも、有難うございました。大変恐縮なのですが、またki00073様にお伺いしたい事がございます。 一度、下記の案件をご覧頂けませんでしょうか？ やりたい事は、ひと月の計画を日毎に最適な数字を入れていく事です。 一度画像をご覧頂けますでしょうか？ まず、13～50行とP～AJ列は非表示にしてありますが、連続した値が入っております。 5,6日は土日で休みです。 計算式は55行目はSUM(3,5,7,9･･･53行目)が入ってまして、 AM列にはSUM(H～AL列)が入っております。 1番のPointの部分はAM55に200,590が入ってまして、これを稼働日(例えば20日)で割ります。 約10,000が出ますが、この値の数を55行目に、出来る限り近い数字を入れていきたいです。 製品Aは優先順位が高く、製品Zは優先順位が低いです。 製品Aは合計7,040になるよう、1日と2日に基準数の3,520が入ります。 製品Eは8～10日に3,210が入っているので、合計が9,630になります。 O55が9,750になっているのは13行目～が非表示になっているからです。 このような形で、優先順位の高いものから基準数を入れ、55行目を平準化したいです。 これをソルバーかVBAを使用して作りたいのですが･･･とても難しく、私には組めません。 どうかお力を貸して頂けませんでしょうか？ 宜しくお願い申し上げます。
マクロの記録を使って保存したマクロを使って、表の行を1行づつ追加したいのですが、5回マクロを実行(5行追加)すると最後の行の下枠線(A~E列)が、消えてしまいます。何故でしょうか？すみませんが、どうぞよろしくお願いします。 記録しましたマクロには、少し変更を加えています。 Sub 行挿入() ' ' 行挿入 Macro ' Rows("37:37").Select Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove Range("F36").Select Selection.AutoFill Destination:=Range("F36:F37"), Type:=xlFillDefault Range("F36:F37").Select Range("A37").Select End Sub
エクセルVBAについて質問です。 以前、ここで下記のコードを教えて頂いたのですが、よく見るとfor nextステートメントに 変数が使用されていません。ですが何も問題なく稼働します。for nextステートメントは他に使用方法があるのでしょうか。 知識不足なもので、どなたか教えて頂きます様お願い致します。 変数が宣言されておらず、それ以降のコードも変数が使用されていない Application.ScreenUpdating = False ActiveSheet.Unprotect Base = 9 For a = 1 To 20 Range("J" & Base & ":N" & Base).Copy Range("i" & Base) Range("i" & Base & ":m" & Base).Copy Range("i" & Base + 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Range("J" & (Base + 2) & ":N" & (Base + 2)).Copy Range("i" & (Base + 2)) Range("i" & (Base + 2) & ":m" & (Base + 2)).Copy Range("i" & Base + 3).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Range("J" & (Base + 4) & ":N" & (Base + 4)).Copy Range("i" & (Base + 4)) Range("i" & (Base + 4) & ":m" & (Base + 4)).Copy Range("i" & Base + 5).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Range("J" & (Base + 6) & ":N" & (Base + 6)).Copy Range("i" & (Base + 6)) Range("i" & (Base + 6) & ":m" & (Base + 6)).Copy Range("i" & Base + 7).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Range("J" & (Base + 10) & ":N" & (Base + 10)).Copy Range("i" & (Base + 10)) Range("N" & (Base) & ":N" & (Base + 7)).ClearContents Range("N" & (Base + 10)).ClearContents Range("f" & (Base + 12) & ":f" & (Base + 13)).ClearContents Base = Base + 17 Next Range("i9").Select ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _ False Set 社内用 = Worksheets("社内用") 社内用.Protect Password:="1111" Application.ScreenUpdating = True End Sub
VBAについて教えてください。 ソートをかけたいのですが、元の構文があり、それを一部修正し、ソート数を増やしたいと思っています。BFU列で第４ソートをかけたいと思っていますが、 デバッグが出てしまいできません。 《元の構文》 Range("BFE10:BFZ207").Select Selection.Sort Key1:=Range("BFH10"), Order1:=xlAscending, Key2:=Range("BFJ10" _ ), Order2:=xlDescending, Key3:=Range("BFI10"), Order3:=xlAscending,, Header:=xlGuess, OrderCustom:=1, MatchCase:= _ False, Orientation:=xlTopToBottom, SortMethod:=xlPinYin, DataOption1:= _ xlSortNormal, DataOption2:=xlSortNormal 《変更したもの》 Range("BFE10:BFZ207").Select Selection.Sort Key1:=Range("BFH10"), Order1:=xlAscending, Key2:=Range("BFJ10" _ ), Order2:=xlDescending, Key3:=Range("BFI10"), Order3:=xlAscending, Key4:=Range("BFu10" _ ), Order4:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _ False, Orientation:=xlTopToBottom, SortMethod:=xlPinYin, DataOption1:= _ xlSortNormal, DataOption2:=xlSortNormal なぜできないのか教えていただけますでしょうか？
解答をいただいたものです。Option Explicit Sub Sample2() Dim I As Long, Dt As Variant Application.ScreenUpdating = False Dt = Range(Range("A2"), Cells(Rows.Count, 1) _ .End(xlUp)).Offset(0, 1) For I = 1 To UBound(Dt) If Dt(I, 1) = "" Then Dt(I, 1) = Dt(I - 1, 1) End If Next I Range(Range("B2"), Cells(UBound(Dt) + 1, 2)) = Dt Application.ScreenUpdating = True End Sub をご回答いただきました。ありがとうございました。ただ、ほかのデータが５列AとBの間に入り込んだことからどうにもわからなくなりました。式の説明もご教示いただけると助かります。
ExcelのVBAで入力フォームを作りRange("A1048576").End(xlUp).Offset(1).Select で最終行の次の行にデータを追加するように設定したいと思ってますが、 オートフィルタでデータを絞り込んだとき、本当の最終行ではなく絞り込んだデータの最終行の次の行、すなわち空白ではなくデータが存在している行に追加されてしまうでしょうか？
VB6.0で質問です。 Dim a As String a = 1a2b"3c4"d5 と変数aに値が格納されていた場合に、 "←の前後にまた、"←を追加したいです。結果としては、 a = 1a2b""3c4""d5 というようにしたいです。 aという変数の中に何が入っているかわからない状態で、 このような変換する処理等あれば教えてください。 宜しくお願い致します
VBA初心者です。 エクセルでセルC2に数字が順番に入力されると、E2に氏名が入力され、 連続印刷できるマクロは組めました。これを、シートとしてどんどん追加していくというマクロはどのように考えれば よいのでしょうか？ シート名には、できれば、E2の氏名がシート名になるとよいです。
私は今visual basicの練習で電卓のプログラムを書いているのですが、その後で悩んでいます。 一応簡単な電卓のプログラムは出来たのですが、これにボタンの履歴を付けたいんですがどうすればいいかわかりません。 例えば2+4＝6の計算をした後には履歴として2、+、4、＝が入力されたわかるようなものです。 どのようなプログラムを書けばいいのか教えてください。 今使っているのはvisual studio express 2015 です。 電卓プログラムは文字数が多いためのせられませんでした。
VBAについてご教授ください。 VBAでCALLのプロシージャ名を変数としたいのですが可能でしょうか？A="HE" B="LL" C="0" NAME= A & B & C CALL NAME or CALL A & B & C もちろん上記どちらのCALLもエラーになってしまいます。 このNAMEの部分を変数とするやり方はありますか？ RunではなくできればＣａｌｌがいいです。 よろしくお願いします。
VBAのLoadPicture関数を使ってCMYK形式のJPGファイルを取り込んで いろいろ動作確認しようと以下のコードを書きました。Sub test_CMYK_LoadPicture() Dim p As Object On Error GoTo Err_Trap Set p = LoadPicture("CMYK形式のJPGファイルをフルパスで") Stop Exit Sub Err_Trap: Debug.Print Err.Number, Err.Description End Sub 実際に動かしたところ、以下のエラーがイメディエイトウィンドウに出力されました。 -2147467259 オートメーション エラーです。 エラーを特定できません CMYK形式のJPG画像をLoadPicture関数で扱おうとした場合、必ずこのエラーが出るものでしょうか? 最終的な目的としてはCMYKを使えない画像として排除したいので 必ずこのエラーが出ることがわかればエラートラップで対処できるかなぁと考えています。
cmdで自動生成(特定のファイルの移動やzipファイルの解凍など)をしようと思っているのですが、vbaのマクロの記録のように、実際にアクションを起こしたら、自動でコードを書ける方法はありますでしょうか？
UWSCの画面操作について。先日質問さしてもらったことの続きのような形になるかもしれませんがよろしくお願いします。今度は同じタブ内でページ移行した場合、新しく開いたページに対してIE操作が引き継いで行くにはどのような。 ウインドウ処理が必要なのでしょうか。 例 http://www.yahoo.co.jp/ ↓ トラベルのリンククリック ↓ http://travel.yahoo.co.jp/?sc_e=ytmh（同タブ内で新しく開いたページ ） ↑ こちらのIE操作なのですが。 例文などありましたら助かります。
スプレッドシート起動時に、毎回メッセージが出るスクリプトを組みたいです シート名は「計画表」で、「記入漏れがないか必ず確認してください」とメッセージボックスを毎回出したいですスクリプトをどう書けばよいか、ご指導お願いします
VBAで特定セルと同名のシートを作成 ・[Main],[data]のシートが有り、[Main]のB列にシート名のリストが存在 ・[Main]のB列は9～50程度で変動・既に同名のシートが存在する場合は作成をスキップ ・シート作成時は[data]のシートをコピーし、シート名のみを[Main]から取得したシート名に設定 現在は以下のように同名シートが存在しない前提でシート作成を行っていますが、 同名シートが存在した場合はスキップ、存在しない場合はコピーにて追加を行う場合の記述をご教授頂ければと思います。 '対象者を選択 Range("B9", Cells(Rows.Count, "B").End(xlUp)).Select '対象者のシートを追加作成 Dim hoge As Range For Each hoge In Selection Sheets("temp").copy After:=ActiveSheet ActiveSheet.Name = hoge.Value Next hoge Worksheets(1).Activate
エクセル2013の関数について教えてください。 下記のような表があります。表２のように、ある一定のセル（この場合は表２のＡ９、Ｂ９、Ｃ９）を選択した場合、別シートの任意の２つのセルに表１の同じ番号（この場合はＡ２、Ｂ２、Ｃ２に記された”１”、”２”、”３”）のうち、はじめと終わりの番号をそれぞれ表示させるにはどうしたらよいでしょうか？ よろしくお願いします。
時間を分単位で表示してある表で、実行できません。 ソースは下記の通りです。助言の程お願い致します。 本当に勉強不足で申し訳ございません。Sub ボタン4_Click() Dim Rng As Range For Each Rng In ActiveSheet.UsedRange.Offset(1, 1) If IsDate(Format(Rng.Value, "nn")) And Cells(1, Rng.Column).Value <> "ID" Then Select Case Format(Rng.Value, "nn") Case 0 Rng.Value = "×" Case 1 To 360 Rng.Value = "△" Case 390 To 510 Rng.Value = "▲" Case 540 To 1440 Rng.Value = "◎" End Select Else Select Case Rng.Value Case "公休" Rng.Value = "×" End Select End If Next End Sub
VBAで複数のシートをパス付PDF出力したい 以下のようなシート構成で特定シートのみパスワード付PDF出力を行いたいです。◆シート構成 [Main]、[名前A]、[名前B]…[名前X]、[DATA]、[TEMP] ◆実行内容 ・Mainシート上にボタンを設置し、実行する事で名前A～Xのシートのみをパス付PDF出力 ※特定のみが難しければ、一旦全てのシートを出力した後、不要なPDFを削除 ・名前A～Xはシート名、シート数共に変動 ・名前A～Xと同名のデータがMainシートB列にあり、D列に各名前のパス値が存在 ・パス値は電話番号を引用、Mainシートの該当データはハイフン付となっている為、数値のみに置換 ◆[Main]シート内配列 A | B | C | D | № | 氏名 | 数値 | TEL(パス) パスワード付での出力が難しければ、別途パス付でZIP化するスクリプトを作成するので、特定シートのPDF化だけでもご教授頂けると幸いです。
エクセル2010を使ってのデータベース機能についてご教示下さい。 エクセル2010で、１つのブックにシートが６つに分かれています。（シート名は下記参照） 【シート名】 １．ワード上級 ２．ワード一般 ３．エクセル上級 ４．エクセル一般 ５．パワーポイント ６．アクセス それぞれのシートには、個人の成績が、大問（分野ごと）に記載されています。 例えば、「ワード上級」シートには、 A1＝氏名 B1＝「文書の管理と共有」分野の得点 C1＝「高度な機能を使用した文書のデザイン」分野の得点 D1＝「高度な機能を使用した参考資料の作成」分野の得点 E1＝「ユーザー設定の Word 要素の作成」分野の得点 他のシートもA1は、氏名となっていますが、分野名や分野の数（何分野に分かれているか）が違っています。 《やりたいこと》 シートをまたいでA1に記載されている個人名ごとの成績を1枚のシート（エクセル）にまとめたい。 個人によっては、1～６まですべての試験を受けているわけではないので、受験している試験の結果のみを1枚にまとめたいです。その際、試験によっては、分野数がちがうのですが、行は縮めて分野ごとに横罫線を入れたいです。また、 同姓同名はいませんので、考慮しなくてOKです。人数は、MAX300名程度です。１つのシート（ひな形）に差し込み印刷のような形態で（マクロでループさせる。これに関しては、別に質問をたてる予定）、あくまでも同じエクセルブック内で処理を完了させたいです。 例に記載の破線は、実際には実線の罫線を希望しています。 お分かりになる方、どうぞご教示の程、よろしくお願いいたします。 《例》 試験結果 氏名 山田 太郎 受験科目 大問（分野） 得点 ワード上級 「文書の管理と共有」 １０ 「高度な機能を使用した文書のデザイン」１０ 「高度な機能を使用した参考資料の作成」 ３０ 「ユーザー設定の Word 要素の作成」 １５ ----------------------------------------------------------------------- エクセル上級 「表計算式の理解」 １０ 「セルの結合」 ３０ 「図形描画」 １５ ----------------------------------------------------------------------- エクセル一般 「関数」 ２０ 「書式設定」 ４０ ------------------------------------------------------------------------- アクセス 「テーブル入力」 ３０ 「クエリ」 １０ 「印刷フォーマット」 ２０ 「データベースの基礎」 １５ ------------------------------------------------------------------------
エクセルのマクロについて 昨日エクセルのマクロについて勉強しだしたばかりの超初心者です。今回縦に貼り付けたものを指定した行数ごとに改行するというマクロを組みたいのですが、 いろいろ調べながら書いたマクロが下のものになります Sub aaa() Dim i, j, m m = 1 For i = 1 To Cells(Rows.Count, 1).End(xlUp).Row For j = 1 To 20 Step 2 Range("A" & m).Copy Range(Cells(1+i,1+j)).PasteSpecial Paste:=xlPasteValues←ここでエラー Application.CutCopyMode = False m = m + 1 Next j Next i すごく初歩的なものだと思うのですが、セルを指定してiとjごとに横や縦に移動させたいのですが 貼り付けの時に縦と横をそれぞれ指定する関数？がわかりませんでした。 どのように変えれば動くようになりますでしょうか。 やりたいことの例 a b c d e f g ↓ a b c d e←指定した行で改行 f g
【500枚】エクセルのVBA（マクロ）で教えて頂けないでしょうか？以下のマクロがあるのですが、1点、条件を付け加えたいと思っています。 「入力用」ページのW列に「○」と記入されている部分（行）のみ、 マクロ起動の対象としたい場合、どのようなコード入力の追加を行えば良いでしょうか。 「入力用」ページでW列に「○」となっている行だけ、 「注文書」を再作成（上書き）するマクロを作成したいと思っています。 注文書作成、上書きの部分までは、何とかなっているのですが、 今のコードだと、マクロを起動すると、不要な部分まで回し直しとなってしまいます。 詳しい方、お力をお貸し下さい。お手数をおかけしますが、宜しくお願い致します。 ----------------------------------------------------------------------------------------------- Sub ≪注文≫() Dim sh As Worksheet, sh0 As Worksheet, xFld As Long Dim rng As Range, rng0 As Range Set sh = Worksheets("入力用") With Worksheets("注文書") For Each rng In .AutoFilter.Range.Rows(1).Cells xFld = xFld + 1 If rng.Address = "$AF$14" Then Exit For Next rng For Each rng In sh.Range("A2", sh.Cells(Rows.Count, 1).End(xlUp)) On Error Resume Next Set sh0 = Worksheets(rng.Offset(, 1).Value) If Err.Number = 0 Then Application.DisplayAlerts = False sh0.Delete Application.DisplayAlerts = True End If On Error GoTo 0 .Copy after:=Worksheets(Worksheets.Count) With ActiveSheet .Name = rng.Offset(, 1).Value .Range("P1").Value = rng.Value .Cells.Copy .Cells.PasteSpecial xlPasteValues With .AutoFilter.Range .AutoFilter Field:=xFld, Criteria1:=0 Set rng0 = Nothing On Error Resume Next Set rng0 = Intersect(.SpecialCells(xlCellTypeVisible), .Offset(1).Resize(.Rows.Count - 1)) On Error GoTo 0 If Not rng0 Is Nothing Then rng0.Delete Shift:=xlUp End If End With .AutoFilterMode = False .Range("A1").Select End With Next rng End With End Sub
Message body プログラミング初心者です。 VB2008を使用しています。２つのFormを使いForm1でリストボックスを３つ作成しリストボックスの項目を選択して決定ボタンを押すとForm2の3ヶ所のテキストボックスに選択した項目を表示させる というプログラムを作成しております。 現在は項目を選択する時にリストボックス１+リストボックス2+リストボックス3の３ヶ所を選択しているのですが、 リストボックス１を選択すると選択した項目と同じ位置のリストボックス2の項目を自動で選択させるといった様に修正したいと思うのですが可能でしょうか？ リストボックスの項目はプログラム起動時にテキストファイルから読み取りリストボックスに表示させています アドバイス等よろしくお 願いいたします。
VBAの質問です。 以下、ブック内の全シートに対してシート名に「FMT」という文字が含まれる場合は 削除する記述なのですが 実行途中で「インデックスが有効範囲にありません」と表示されます。************************************************* Sub FMT表示されているものを削除() Dim i As Long For i = 1 To Worksheets.Count If InStr(1, Worksheets(i).Name, "FMT") <> 0 Then Application.DisplayAlerts = False Worksheets(i).Delete Application.DisplayAlerts = True End If Next i End Sub **************************************** VBAの勉強中です。 インデックスが有効範囲にありませんと表示されず実行されるように 一文加えていただけると幸いです。 みなさまよろしくお願いいたします。
VBAでセル値と同名の各シートへのハイパーリンクについて シート名:Main、セルB9～B100に氏名が入力されており、 同名の各シートへハイパーリンクを設定する方法を教えて下さい。・行Bの範囲は可変で、必ずしもB100までデータが有る訳ではありません。 ・同名のシートは必ず存在します。 ・行Bの各セルに対してハイパーリンクを設定します。
画像をセルの大きさに変更して張り付ける際、 以下ではまれに縦長の画像（スマホの縦撮）を枠に収めることができません。 確実に枠の大きさになるようにしたいのですが、どうすれば良いでしょうか？Sub 選択セルに合わせて() Dim myFileName As String If TypeName(Selection) <> "Range" Then MsgBox "セルを選択して実行して下さい。" Exit Sub End If myFileName = Application.GetOpenFilename( _ FileFilter:="画像 ,*.jpg; *.gif; *.bmp", MultiSelect:=False) If myFileName <> "False" Then With ActiveSheet.Pictures.Insert(myFileName) .Left = Selection.Left .Top = Selection.Top .Width = Selection.Width .Height = Selection.Height End With End If End Sub
以前↓のような質問をさせていただき、頂いた回答：IF(ISBLANK(C13)=TRUE, "", VLOOKUP(C13,[★★一覧★★.xlsm]現場一覧!$B$5:$C$70,2,FALSE)) という解答をいただいたのですが、うまくいったと思ったのですが、やはりダメでした。 空欄を読み込まない関数、またはVBAのコードを教えていただけると、嬉しいです。 よろしくお願いいたします。 ***************************************************************** エクセル関数でご教授ください。 C列に文字列を入力したときに、D列にも文字が入る式です↓ D列のコード→VLOOKUP(C13,[★★一覧★★.xlsm]現場一覧!$B$5:$C$70,2,FALSE) C列がまだ何も入力されていない空欄の場合、D列も空白にしたいのですが、そのような式は 関数では無理ですか？ VBAのコードでD列を読み込むとき、まだ入力されていないD列の数式を読んでしまうようで、 エラーになってしまいます。 または、この関数自体をVBAに直した方がよいのでしょうか？
質問です。 オートフィルタで複数列を1つの条件で抽出したいのですが、教えてください。たとえばA列が納品書№・B列が受注№・C列が商品№なのですがすべて数字の為、出来ればInBox一回でA-C列を検索してほしいです。 指定納品書NO 受注NO 元品番 元画番 品名漢字 受注年月日 委託残 21812 3252608 77 8011 15CM花瓶 20151112 1 21880 3307989 32B 4171L 32PCｾｯﾄ(6ﾆﾝﾖｳ) 20160112 1 22053 3389769 95414A 9459 12CMﾌﾟﾚｰﾄ 20160408 12 22050 3389770 67312H 5047 12.5CM小深皿 20160408 12 22052 3389771 67312H 5055 12.5CM小深皿 20160408 8 22050 3389773 67118H 5048 18CM 浅皿 20160408 6 以下の様なマクロを作ってみましたが、 A-C列全てに一致しないと抽出しないようです。 どなたかご教授いただけないでしょうか？ マクロ '条件1 の設定 Dim 検索NO As Variant '抽出キーの入力指示 検索NO = InputBox("検索NOを入力てください。") 'キャンセルした場合の処理 If 検索NO = Empty Then Exit Sub End If 'オートフィルタがかかっていなかったらかける 'かかっていたら念の為一度解除し再設定 If ActiveSheet.AutoFilterMode = False Then Range("A2:O2").Select Selection.AutoFilter Else Selection.AutoFilter Range("A2:O2").Select Selection.AutoFilter End If Selection.AutoFilter Field:=1, _ Criteria1:=">=" & 検索NO, Operator:=xlAnd, Criteria2:=" " & 検索NO Selection.AutoFilter Field:=2, _ Criteria1:=">=" & 検索NO2, Operator:=xlAnd, Criteria2:=" " & 検索NO2 Selection.AutoFilter Field:=3, _ Criteria1:=">=" & 検索NO3, Operator:=xlAnd, Criteria2:=" " & 検索NO3 AutoFilterMode = False Application.ScreenUpdating = True End Sub よろしくお願いいたします。
お世話になります。 エクセル関数についても質問です。 F列に関数を組むとしてお願いします。A列の５単語を組み合わせた商品タイトルの中から、 H列にある単語（完全一致と部分一致で教えてほしいです） をヒットさせて、 H列の横にあるG列の７桁の番号をはじき出すには どんな関数を組めばいいのでしょうか？ vlookup関数やhlookup関数など試してみましたが、 やり方が悪いのかそもそも適切な関数でないのか うまくいきません。 できるだけシンプルにわかりやすい関数を希望します。 お手数おかけしますがよろしくお願いいたします。m(_ _)m
vba教えてください。 製品のデータ登録修正 まとまりのない記述で見にくいかもしれませんが、 下記実行時、 Selection.Cut すると、元の行が空白のまま残ります。これを削除してほしいのですが。 何とかできないでしょうか？？ Sub 新規重複() Dim Result As Long Dim rowno As Long num = Sheets("データ入力").Range("a2") Set c = Sheets("データ一覧").Columns("A:A"). _ Find(num, LookIn:=xlValues, LookAt:=xlWhole) If Not c Is Nothing Then Sheets("データ一覧").Select c.Select Result = MsgBox("重複しています。ﾃﾞｰﾀを呼び出しますか？", vbYesNo + vbExclamation) If Result = vbYes Then rowno = ActiveCell.Row Rows(rowno & ":" & rowno).Select Selection.Cut Sheets("編集前データ").Select Rows("2:2").Select Selection.Insert Shift:=xlDown Sheets("編集前データ").Select Else Exit Sub End If End If End Sub
VBA初心者です。 検索システムをVBAで作ろうとしているのですがなかなかうまくいきません。 教えていただけると助かります。ユーザーフォームで書名、著者名、シリーズ名を打ち込むようにして一括検索をするとシート2にある本の情報(書名、著者名、シリーズ名、出版社など)から適合している文献を検索するシステムを作りたいです。 検索結果は適合書籍の本の情報すべてが一覧でシート1に出るようにしたいです。 また、検索は3項目のうち1つ以上入力すればよく、複数入力した場合はその複数の条件に合うもののみ検索されるようにしたいです。 システムがなかなかうまくできずに悩んでいます。 答えていただけるとありがたいです。 お願いします。
Visual Studio 2015でC++を使っている者ですが、MIDIデータを扱いたくてOpenMidiProjectなるサイトにて配布されているオープンソースを試してみました。まず初めにMIDIメッセージ入出力用ライブラリ『MIDIIOライブラリ』(DLL)の最新版をダウンロードし（http://openmidiproject.osdn.jp/MIDIIOLibrary.html）、解凍してプロパティの設定をした後、このサイトで書かれているサンプルコード（ドの音を3秒鳴らす）を実行したところエラーが発生してしまいました。 構成がDebugのときリンカーの追加のライブラリディレクトリにMIDIIOd.libのパスを、ReleaseのときMIDIIO.libのパスを追加し、すべての構成においてはリンカーの入力にMIDIIOd.libとMIDIIO.libをそのまま打ち込みました。 また、MIDIIIO.hはプロジェクト内にコピペしインクルードもしてます。 MDIIO.dllとMIDIIOd.dllはOS(C:)>Windows＞SysWOW64内にコピペしました。 何がいけないのか教えていただけると幸いです。 よろしくお願いいたします。 解凍したものはこちら MIDIIO ├readme.txt はじめにお読みください(このファイル) ├license.txt ライセンス(原文・英語) ├MIDIIO.c Cソースファイル ├MIDIIO.h C/C++用ヘッダーファイル ├MIDIIO.def C/C++用モジュール定義ファイル(dllを作るときに必要) ├MIDIIO.mak C/C++用メイクファイル ├MIDIIO.sln Visual C++ 2008 Service Pack 1用ソリューションファイル ├MIDIIO.vcproj Visual C++ 2008 Service Pack 1用プロジェクトファイル ├MIDIIO.bas Visual Basic 4.0/5.0/6.0用インポートモジュール ├Debug │├MIDIIOd.lib オブジェクトライブラリモジュール(デバッグ用) │└MIDIIOd.dll ダイナミックリンクライブラリ(デバッグ用) ├Release │├MIDIIO.lib オブジェクトライブラリモジュール(リリース用) │└MIDIIO.dll ダイナミックリンクライブラリ(リリース用) └docs ├MIDIIO.html 公式ガイドブック ├MIDIIO02.gif 公式ガイドブックで使われている図 ├MIDIIn.gif 公式ガイドブックで使われている図 ├MIDIOut.gif 公式ガイドブックで使われている図 └MIDIThru.gif 公式ガイドブックで使われている図
仕事で急遽エクセルVBAを作成せねばならず、ご質問です。 初心者なので、お見苦しく吸いません。■ファイル ファイルA・・・更新されるの日々の予算予算 ファイルB・・・ファイルAから該当した文字を含む行のみを抽出してまとめたファイル(ここにマクロが書いてある) ■やりたいこと ファイルAのD行に”○○”が含まれていたら、その行のC列～P列までをコピーし、 ファイルBの文字が入っていない一番下の行にペーストする ※ファイルBは、歯抜けのようなデータではなく必ずデータが入っているものとする ■書いたソースコード Set Opnbook = Workbooks.Open(ファイルB) Set Opnbook2 = Workbooks.Open(FPss) For j = 5 To 200 If Opnbook.Sheets(m1).Range("D" & j).Value = "検索キーになるワード" Then Opnbook.Sheets(m1).Range("C" & j & ":" & "P" & j).Copy ⇒ Workbooks(FPss).Activate LastRow2 = Cells(Rows.Count, "A").End(xlUp).Row + 1 Workbooks(ファイルA).Sheets(Sheet1).Range("A" & LastRow2).PasteSpecial Paste:=xlValues End If Next j End Sub ※FPss=ファイル名まで含む絶対パス ■現状 ⇒の部分で、インデックスが有効範囲にありますとエラーがでてきてしまいます。 ファイルBはコピーの範囲選択まではされているようですが、貼り付けまで行っていないようです。 どこがおかしいのか、どのように修正すればいいのか、是非教えていただければと存じます。 何卒、よろしくお願いいたします。
現在、マクロ＆VBAの通信講座に取り組んでおり、 下記課題が分らなく、ご教授いただければ幸いです。問題：名前を「書式の置換」で新たにマクロ（プロシージャ）を作成し、セル「B2」に入力されている備品名と一致するデータを表（A9：A54）から検索し、一致するセルを「太字」に置換するステートメントを作成してください。 Sub 書式の置換() With Application.ReplaceFormat .Font.FontStyle = "太字" End With Range("A9:A54").Replace what:=Range("B2").Value, _ LookAt:=xlWhole, Searchformat=False ReplaceFormat=true 上記にて作成しましたが、起動しなく行き詰っております。 分かりづらいとは思いますが、よろしくお願い致します。
windows7のPCでエクセル２０１０を開こうとしたら アプリケーションを正しく起動できませんでした。 （0xc0150002) という表示がでます。マイクロソフトのサポートに問い合わせてみたら、１マン以上かかるといわれました。 いろいろネットなどで調べているのですが、お金がかからず直っいる方もいるようで。。。 Microsoft Visual C++ 2008 SP1 再頒布可能パッケージ (x86)とかをダウンロードしてみたのですが ダウンロードできず、種類も多くていろいろダウンロードしてみてるのですが、ダウンロードができず、プログラム？の中に残っていくばっかりでどうすればいいのかわかりません。 どなたか教えてください〜(T ^ T)
VBAで、 debug.print &H8000 -32768 となるのは「仕様」でしょうか？ また「&H8000」に対して算術処理をしようとするとオーバーフローを起こすのも 「仕様」でしょうか？
VBAで、 debug.print &H8000 -32768 となるのは「仕様」でしょうか？ また「&H8000」に対して算術処理をしようとするとオーバーフローを起こすのも 「仕様」でしょうか？
SaveASを使っているのに、加工指図書が上書き保存されてしまう。Workbooks("加工指図書.xlsm").SaveAs Filename:="Z:\台帳データ\指図書Data" & "\" & FolderY & "\" & FolderM & "\" & NameParts & ".xlsm" このプログラムを使うと、Zのドライブに、P1606001というファイルができるのですが、加工指図書を開くとP1606001と同じデータになってしまいます。 加工指図書を常に同じ状態で使いたいのですが、SaveAsではないのでしょうか。 VBA初心者です。説明不足かもしれませんが、よろしくお願いします。 Dim rc As VbMsgBoxResult rc = MsgBox("保存して終了しますか？", vbYesNo + vbQuestion) If rc = vbYes Then Dim myDate As Date Dim NameParts As String Dim FolderY As String Dim FolderM As String Dim Fname As String With Sheets("指図書") myDate = .Range("J2").Value NameParts = .Range("D3").Value End With FolderY = Format(myDate, "yy年") '年度フォルダ、月フォルダ、日付フォルダを決定する FolderM = Format(myDate, "mm月") FolderD = Format(myDate, "yymm") MakeFolder myPath & "\" & FolderY 'ファンクション"MakeFolder"にフォルダを作成させる。すでに有る場合は回避。 MakeFolder myPath & "\" & FolderY & "\" & FolderM Application.DisplayAlerts = False Workbooks("加工指図書.xlsm").SaveAs Filename:="Z:\台帳データ\指図書Data" & "\" & FolderY & "\" & FolderM & "\" & NameParts & ".xlsm"
マクロ初心者です。全てのシートを数値化するマクロを作ってみたのですが これではactiveなシートしか数値化してくれません。 どこが間違っているのでしょうか？Sub あああ() Dim S As Worksheet For Each S In Worksheets Cells.Copy Cells.Select Selection.PasteSpecial (xlPasteValues) Next S End Sub
[100枚]vba 表の列をかえるコードについて質問させてください。 A-I列の各１行目に項目があります。 ２行目以降に各データが入っています。J列(10列目)の１－４行目に、項目名が４つありこの順で、 表の列を並び替えたいと思います。 以下のコードではうまくいかないのですが、 誤っている点を教えていただきたいと思っています。 日本語等で、わからないところがありましたら、 ご連絡いただければ、幸いです。 '表の列の並び替え Dim myRange As Range '表を格納する変数 Dim myCell As Range '表を格納する変数 For i = 1 To 4 For Each myCell In Range("A1:I1") If Cells(i, 10).Value = myCell.Value Then If myCell.Column <> i Then myRange.Columns(myCell.Column).Cut myRange.Columns(i).Insert shift:=xlToRight End If Exit For End If Next Next
エクセル2003A1:D80に文字リスト A列のリストをtextboxに入力してラベル表示はVLookupで出来ましたが、C列のリストをtextboxに入力してA列のリストをラベル表示もしたいのですが、お暇な方教えてください。 userform errorは気にしないでください。 i=textbox1 if i=””then end if on error goto error j=worksheetFancion.VLookup(i,Range(”A1:D80”),3,False) label1.caption=j 以下略
Excelで、フィルタをかけて行が青くなることには どのような意味がありますか。Rows(10).HIdden などで可視性をいじっても、青くならないですが、 この青いのは、何らかのプロパティでしょうか？ どうしてこんなことを思ったかというと、 フィルタで抽出している状態(行が青い)の時、 Hiddenを操作すると、 ①非表示行のみに対してHIdden=True → その行が非表示となる ②表示行のみに対してHidden=False → その行が表示される ③表示行、非表示行を含む複数行に対してHidden=True → その行が非表示となる ④表示行、非表示行を含む複数行に対してHidden=False → 何も起こらない 問題なのは④で、行の右クリックメニューの「再表示」でも、 表示行と非表示行を含む場合は表示されません。 Hiddenでは行は青くならないので、オートフィルタでは可視性以外にも何かが変わった結果として、このような事が起こっているのではないかと推測しました。 ②ではしっかり表示されるので、表示行、非表示行を含む場合にだけ特別にHiddenで表示させられない理由が分かりません。 これは、根源にはどのような仕様があるためでしょうか。或いは、Excelそのもののプログラミングがキレイでないだけでしょうか。 ※「○○がしたい」という質問ではなく、謎が解きたい、という好奇心タイプの質問ですね。どうぞよろしくお願い致します。 Excel2013、Windows7です。
ユーザーフォームを使い、任意のブックを呼び出したい エクセルを使い、ある事柄についてまとめた管理表(1)を 作成しているのですが、管理表(1)とは別の事柄についてまとめた 管理表(2)を、管理表(1)のマクロを使って 呼び出したいのです。 管理表(1)を最小化して、管理表(2）を手動で起動すればいい話なのですが 今後、管理表(2)(3)(4)(5)・・・と増えていき、フォルダ階層を 遡っていくのが大変になるので、管理表(1)のユーザーフォーム等で 呼び出しが簡単になったら、と考えています。 このような方法があれば、教えていただきたいです。
VBAについて質問です。下記の①利用者データのA列の管理が他社の場合 ②の表にC列の利用事業者ごとに（東京なら東京の利用者の一覧）の表を作り、A列が自社の場合③の表に利用者の一覧を作成するというVBAを作りたいと思い一先ず他社の分を Range("A1:F1").AutoFilter .Range("A1:F1").AutoFilter Field:=1, Criteria1:="他社", Operator:=xlOr .Range("A1:F1").AutoFilter Field:=4, Criteria1:="東京" .Range(.Range("A3"),.Range("A3").SpecialCells(xlLastCell)).SpecialCells(xlCellTypeVisible).Copy Range("A3") 色々検索しというような感じで作ってみたのですが、これだと一列コピーすることしかできず、表の罫線なども消えてしまいうまくいきませんでした。 また、自社の表については利用事業所が複数ある場合 名前 上限額 他社利用事業所 事業所電話番号 備考～ 高橋 100 アメリカ 000-000-000 高橋 100 フランス 111-111-111 というう風にしたいのですが、どのように作成したらいいのでしょうか？ 知恵をお貸しください。よろしくお願いします. 表を添付してみたのですが、小さいので・・・ ①利用者データ A/ B/ C/ D/ E/ E/ F/ G～ 管理/ 氏名/ 利用事業所/ 月額/ 上限事業所/ 備考欄/ 他社利用事業所 自社/ 高橋/ 東京/ 100/ 東京/ ○○/ アメリカ/ フランス/ 他社/ 田中/ 東京/ 200/ 大阪/ 他社/ 砂糖/ 大阪/ 100/ 名古屋/ A列には CとEが一致したら自社不一致なら他社と表示するように関数をいれています。 ②他社管理データ A /B/ C/ D/ E/ F～I 氏名 /上限額 /上限事業所 /事業所連絡先 /備考 /手書きのため空欄 D列の事業所連絡先は別シート（事業所連絡先）を参照するようにVLOOKの式を入れようかと 思っています。 ③自社管理データ A/ B/ C/ D/ E/ F～I 氏名/ 上限額/ 他社利用事業所/ 事業所連絡先/ 備考/ 手書きのため空欄 こんな感じです。
先ほど下記質問をして解決したと思ったら、「インデックスが有効範囲にありません」と エラーが出るようになりました。何がいけないのでしょうか。http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1216271744... すいませんが教えてください。 Sub Main() Dim ws As Worksheet 'CSVファイルのファイルパス Const FILE_PATH As String = "C:\抽出結果.csv" On Error GoTo ERROR_PROC 'Sheet2を取得 Set ws = ThisWorkbook.Worksheets("全件") 'Sheet2の全てのセルをクリア ws.Cells.ClearContents 'クエリテーブルを利用して、CSVファイルを取り込む With ws.QueryTables.Add(Connection:="TEXT;" & FILE_PATH, Destination:=ws.Cells(1, 1)) .Name = "CsvData" .TextFileCommaDelimiter = True .TextFilePlatform = 932 .Refresh End With 'クエリテーブルを削除 ws.QueryTables("CsvData").Delete 'ws.Names("CsvData").Delete GoTo END_PROC ERROR_PROC: MsgBox Err.Description, vbExclamation, "System Error" END_PROC: 'オブジェクトのクリア Set ws = Nothing End Sub
ExcelのVBAにて 毎日18時に動いてくれるマクロを組みたいのですが どのように書けばできるでしょうか？この場合、18時にExcelを起動していないとマクロは動作しないのでしょうか？できれば起動していなくても動いてくれると嬉しいのですが・・・ VBA初心者なのでわかりやすく できれば簡単なプログラムで例をつけていただけると嬉しいです。
Excel VBAに関しての質問です。・ オブジェクト ・ オプション ・ ステートメント ・ メソッド ・ 引数 ・ 関数 ・ 定数 ・ 変数 を、わかりやすく説明していただける方、よろしくお願いします。 たくさん本やサイトを見たのですが、覚え方があいまいなので、 基礎をしっかり覚えるためにも、簡潔にわかりやすく知りたいです。 例などがあるとわかりやすいかもしれません。。。
教えてください。 下記プログラムを実行すると「アプリケーション定義またはオブジェクトと定義エラーです。」と表示されるのですが、どこがいけないのかわかりません。・やりたいこと CSVファイルをxlsmファイルのあるシートにコピーしたいのです。 よろしくお願いします。 Sub Main() Dim ws As Worksheet 'CSVファイルのファイルパス Const FILE_PATH As String = "C:\抽出結果.csv" On Error GoTo ERROR_PROC 'Sheet2を取得 Set ws = ThisWorkbook.Worksheets("全件") 'Sheet2の全てのセルをクリア ws.Cells.ClearContents 'クエリテーブルを利用して、CSVファイルを取り込む With ws.QueryTables.Add(Connection:="TEXT;" & FILE_PATH, Destination:=ws.Cells(1, 1)) .Name = "CsvData" .TextFileCommaDelimiter = True .TextFilePlatform = 932 .Refresh End With 'クエリテーブルを削除 ws.Names("CsvData").Delete GoTo END_PROC ERROR_PROC: MsgBox Err.Description, vbExclamation, "System Error" END_PROC: 'オブジェクトのクリア Set ws = Nothing End Sub
現在、治療院で働いているのですが、集客の為に統計を取ろうとデータをExcelで作っています。 写真のような形で作っているのですが、月の来院回数を入れるのに月末にまとめて入れなければなりません。 そこで、随時来院される毎にワンクリックで来院回数が1回増えるシステムは作れますか？ また、No.に対し氏名、年齢、住所、電話番号など、パーソナルデータを登録させることは可能ですか？ 別の窓でNo.を入れると当日のその方の来院がカウントされるようなシステムとか… そのような業者もあるのですが、自分で作れるなら作ってみたいと思ったので、質問させて頂きます。 難しい言葉も調べながら行うので、やり方を教えて頂ければ幸いです。
win32apiでのウィンドウ操作について Windows7(32bit/64bitどちらも使用)とExcel2013 VBA(32bit)の組み合わせでWindowsのAPIを使用し、他のアプリケーションのウィンドウを操作したいのですが、 あるアプリだけうまく操作できないため、方法がないか教えてください。 やりたいのは、ウィンドウの最大化と最小化で、 自分でマウスを使ってウィンドウ右上にある最小化、最大化、閉じるボタンをクリックすると その通り動作するのですが、 SetWindowPos、ShowWindow、SetWindowPlacementを試してもまったく動作しません。 SendInputでボタンをクリックさせようとしたのですが、最小化状態から最大化するには どうしたらよいかわからずあきらめました。 UISpyというソフトでウィンドウハンドルを確認しましたが、ハンドルは正しく取得できており、 問題のアプリのウィンドウ内のエディットのテキストとかそういう情報を取得したり 書き換えたりはできました。 ですがなぜか、最小化、最大化などのウィンドウ操作ができません。 また、UISpy上で、この操作できないアプリについて、 タイトルバーの情報を取得したところ、ほかでは起きていない メニューバーや最大化、最小化ボタンの情報が取得できないエラーが起きていました。 これが原因なのかも知れないと思ったのですが、このアプリは私が作成したものでないため、 どうしてもアプリ修正などは出来ない状態です。 当たり前かも知れませんが 試しにフリーソフトのUWSCを使用しても、ウィンドウ操作はできませんでした。 このような状態で、ウィンドウ操作できる方法はないでしょうか？ よろしくお願いします。 【UISpyで取得した、問題のアプリのタイトルバー情報】 -------------- ＊の部分はアプリ名で、伏せさせてもらいました。 General Accessibility AccessKey: "" AcceleratorKey: "" IsKeyboardFocusable: "False" LabeledBy: "(null)" HelpText: "" State IsEnabled: "True" HasKeyboardFocus: "False" Identification ClassName: "" ControlType: "ControlType.TitleBar" Culture: "(null)" AutomationId: "TitleBar" LocalizedControlType: "タイトル バー" Name: "*************************" ProcessId: "4304 (****)" RuntimeId: "4 3015250 0" IsPassword: "False" IsControlElement: "True" IsContentElement: "False" Visibility BoundingRectangle: "[オブジェクトの現在の状態に問題があるため、操作は有効ではありません。]" ClickablePoint: "(null)" IsOffscreen: "False" ControlPatterns ------------------------------------------------------------------------------- 以上です
エクセルのマクロに関してご教授願います。 現在、入庫データをエクセルで管理してますが 日付・時間・商品毎にレコードが作られている状態です。そのデータに対して、マクロを使って入荷箱数毎に 表示させるようにしたいと思っております。 色々調べてみましたが、回答が出ず困っております。 詳しい方がいらっしゃいましたら、お教え頂けませんでしょうか。 ※イメージを画像にしましたので添付しておきます。
Ａ列がグルーブ番号、同じグループのＢ列の数字を合計したものがＣ列となるのが正解として、間違っているもの、合計がCと違うものを探したいです。ＶＢＡでどのように作れば良いかを教えて下さい。 よろしくお願いします。
あるシートにファイルの一覧があります。 Ａ列：ファイル名、Ｂ列：パスＣ列：ファイル種別、Ｄ列：最終更新日です。そのシートの最終更新日をキーに期間指定して任意期間のファイルリストだけを抽出するプログラムです。 任意に選んだ期間にリストが無いと「400」というエラーだけ表示されます。 これを回避したいのですがどうしたらよいのでしょうか。 Private Sub prog3_() Dim myStart As String, myEnd As String Dim myRow As Long Dim Sh2 As Worksheet, Sh3 As Worksheet Set Sh2 = Worksheets("結果") Set Sh3 = Worksheets("s") myStart = InputBox("日付のはじまりを入力" & vbCrLf & "記入例）2016/01/20"): If myStart = "" Then Exit Sub myEnd = InputBox("日付の終わりを入力" & vbCrLf & "記入例）2016/01/20"): If myEnd = "" Then Exit Sub With Sh2 .Range("A1").AutoFilter Field:=4, Criteria1:= _ ">=" & myStart, Operator:=xlAnd, Criteria2:="<=" & myEnd myRow = .Range("A" & Rows.Count).End(xlUp).Row Sh3.Range("A:E").ClearContents .Range("A1:E" & myRow).Copy Sh3.Range("A1") .Range("A1").AutoFilter End With Worksheets("結果").Activate ActiveSheet.Range("A1").Select
ExcelのVBAを勉強しています。シート１の売上表の10以上ある項目から 店舗名、商品の種類、値段を抽出して シート２に 店舗名→商品の種類→売上額合計 店舗名→商品の種類→売上額合計 ・・・ のような感じにしてくれるようにマクロを組みたい場合どのようにしたらよいのでしょうか。 ネットなどで調べながらでようやく種別ごとにすることはできたのですがそこから 表の作成や分類ごとの合計額となったところで詰まってしまいました。 よろしくお願いいたします。
エクセルVBAで教えて頂きたいことがあります。 自身のファイルの最終シートの後に選択したファイル内のシートを全てコピーする。 選択したファイルは保存せずに閉じる。という事をしたいと考えております。 自分で書いてみました。 -------------------------------------------------------------------- '取り込みを選択し開く SetPath = "選択したいファイルが入っているフォルダ" ret = SetCurrentDir(SetPath) Set ExcelApp = CreateObject("Excel.Application") If ret = 0 Then MsgBox "フォルダが存在しません" + vbCrLf + SetPath Exit Sub End If file = Application.GetOpenFilename("xlsファイル(*.xls),*.xls", 1, "読み込むエクセルファイルを選んで", False) If file = "False" Then Exit Sub Workbooks.Open file '開いたファイル内のシートを全て本ファイルの最終シートに貼り付ける。 With ThisWorkbook For Each Sh In Worksheets Sh.Copy after:=.Worksheets(.Worksheets.Count) Next Sh End With ActiveWorkbook.Close False End Sub -------------------------------------------------------------------- ファイルを選択し自身のファイルの後にコピーできるのですが、選択したファイルを閉じることが、 できません。ActiveWorkbook.Close Falseなので自身のファイルが閉じてしまいます。 選択ファイルを閉じるにはどう書けば良いか教えて下さい。
非表示となっているExcelが拾えない あるブックを非表示状態(Application.Visible=False)で実行している場合があり、編集したいときに再表示させたいのですが、次のコード： Sub 全てのエクセルを表示() Dim xlApp As Excel.Application Set xlApp = GetObject(, "Excel.Application") xlApp.Visible = True Set xlApp = Nothing End Sub を実行しても、ブックが表示されません。 非表示状態のブックは、Excel.Applicationに含まれないのでしょうか？ また、別のコード： Sub 全てのエクセルを表示②() Dim wbk As Workbook For Each wbk In Workbooks wbk.Application.Visible = True Next End Sub も試しましたが、「このコードを実行するExcel」と、「非表示状態のExcel」の計2つのExcel（それぞれは別インスタンスで立ち上げたもの)が立ち上がっている状態で実行しても、Forは1回しか回らず、「非表示状態のExcel」を参照していない様子でした。 では、非表示状態のExcelを再び表示させるには、どういったコードで可能なのでしょうか？
エクセルVBAで教えて頂きたい事があります。 shell関数を使って指定のフォルダを開こうと思っています。 指定のフォルダは自身のエクセルファイルのパスの中にある受注データというフォルダです。下記にように記述するとエラーになります。 Shell ActiveWorkbook.Path & "￥受注データ", vbNormalFocus フルパスを入れると上手くいくのですが、運用上パスが変更になることがあります。 ご教示願います。
VBA初心者です。コードを教えて頂きたいです。 画像のような図が一つのシートに8個入っています。（1月～7月） このシートが30個あるファイルが２つあります（シートは営業所別になっているので、60営業所分）。 この図の性別軸が合計のところ、年代合計の所の合計金額（画像の表だと、21058円の部分）の数字を抽出して違うシートに載せたいのです。 1月 2月 3月・・・・・・・・ Ａ営業所 Ｂ営業所 ・ ・ ・ このような感じです。 8×30×2＝480なので 480個も毎月コピペ作業をするには結構時間がかかります。 よろしければこれを実行するためのコードを教えて頂ければと思います。 大変申し訳ございませんが、なにとぞよろしくお願いいたします。
コイン500枚 ExcelのVBAのループ処理について質問させて下さい。 現在、webクエリを使用して複数のページからデータを取り出す物を作っています。具体的にはhttp://info.finance.xxxxx.co.jp/ranking/?kd=31&tm=d&vl=a&mk=3&p=1というようなページからデータを取り出しています。 このURLの最後の"1"の文字を次の空欄に自動で書き込む際に"2"、次は"3"になるようしたいのですが、どのように設定すればいいでしょうか？ 現時点では下記のようにB3セルから縦方向の次の空欄にwebクエリを登録する物は作成出来ました。 Private Sub CommandButton1_Click() With ActiveSheet.QueryTables.Add(Connection:= _ "URL;http://info.finance.xxxxx.co.jp/ranking/?kd=31&tm=d&vl=a&mk=3&p=1", _ Destination:=IIf(Range("b3").Value = "", Range("b3"), Range("b" & Cells.Rows.Count).End(xlUp).Offset(1, 0))) .Name = "?kd=31&tm=d&vl=a&mk=3&p=1" .FieldNames = True .RowNumbers = False .FillAdjacentFormulas = False .PreserveFormatting = True .RefreshOnFileOpen = False .BackgroundQuery = True .RefreshStyle = xlInsertDeleteCells .SavePassword = False .SaveData = True .AdjustColumnWidth = True .RefreshPeriod = 0 .WebSelectionType = xlAllTables .WebFormatting = xlWebFormattingNone .WebPreFormattedTextToColumns = True .WebConsecutiveDelimitersAsOne = True .WebSingleBlockTextImport = False .WebDisableDateRecognition = False .WebDisableRedirections = False .Refresh BackgroundQuery:=False End With End Sub 可能であれば、選択しているセルの列の次の空欄にページ数+１をしたwebクエリを登録するループ処理が出来る物を作成したいです。 お手数ですがご教授よろしくお願い致します。
VBSについて質問です。 IEでファイルをアップロードしようと思い その箇所をVBSにより クリックして ファイル選択画面を出すようにしたのですが そこからプログラムが進行しません どうしてでしょうか？ ファイル選択画面は 小さい新たなウインドウででくるので そこを制御できてないのでしょうか？ よろしくお願いします。
VBA 粗利率を求める式で、正しく計算してくれません。 textbox7に粗利金額 textbox5に売上金額が入力されています。TextBox8.Value = val(TextBox7) / val(TextBox5) * 100 TextBox8.Text = Format(TextBox8.Text, "#.#0") このコードで粗利率を出したかったのですが、全然正確な数字を出しくれません。 textbox7や5の数字は、下記のコードで取得しているので、そこからして何か違っていますか？ TextBox7.Value = val(Format(TextBox5.Value, "0")) - val(Format(TextBox6.Value, "0")) TextBox7.Value = Format(TextBox7.Value, "#,##0")
Access 2013 VBAを用いて 水泳大会の入賞者管理システムを作成しています。 テーブル・リレーションシップ・レポートについては下記のとおりです。【テーブル】 「名簿テーブル」 ID、名前、性別、出場種目(◎)、受賞した賞(○)、出場大会名（△） ※性別～大会名は数値型。性別は0=男、1=女とする。 「種目マスタテーブル」(◎) 1.自由形 2.平泳ぎ 3.背泳ぎ ※数値型、短いテキスト 「賞マスタテーブル」(○) 1.金賞 2.銀賞 3.銅賞 ※数値型、短いテキスト 「大会年度マスター」（△） 1.平成27年度大会 2.平成26年度大会 3.平成25年度大会 4.平成24年度大会 5.平成23年度大会 ※数値型、短いテキスト ※◎と○と△はそれぞれリレーションシップを行っています。 【レポート】 「大会年度別」（選択クエリの後クロス集計クエリ） 種目｜金賞｜銀賞｜銅賞 ーーーーーーーーーーーー 自由形｜北島｜佐藤｜田中 平泳ぎ｜伊藤｜松本｜吉田 背泳ぎ｜井上｜森田｜渡辺 ーーーーーーーーーーーー 「賞別」 賞｜氏名｜性別｜出場種目 ーーーーーーーーーーーー 金賞｜北島｜男｜自由形 ｜伊藤｜男｜平泳ぎ ｜井上｜男｜背泳ぎ ーーーーーーーーーーーー 銀賞｜佐藤｜男｜自由形 ｜松本｜男｜平泳ぎ ｜吉田｜男｜背泳ぎ ーーーーーーーーーーーー 銀賞｜井上｜男｜自由形 ｜森田｜男｜平泳ぎ ｜渡辺｜男｜背泳ぎ ーーーーーーーーーーーー そこで、質問がいくつかあります。 ①フォームより入賞者を検索できるようにしています。 そこで、出場者～大会名はコンボボックスでの検索とし、 範囲検索ができるようにしています。 例）「金賞」～「銅賞」、「平成27年」～「平成23年」 しかし、その際にどのようなSQL文を書けば良いのか分かりません。 ②性別のみの検索をするとパラメータークエリが表示される。 入力すると実行時エラー3071。 キャンセル押すと実行時エラー2001がそれぞれ表示。 ③検索の際、「クリア」ボタンを押したあとに検索し直すと 実行時エラー3075が表示される。 ②・③のそれぞれを表示させないようにするにはどうすれば良いか。 ④検索結果に設置した印刷ボタンを押すと 印刷選択画面にてレポート形式をオプションボタンにて選択できる。 しかし、この画面からレポートに移るには どのようなコードを書けば良いのか分かりません。 ⑤レポート「大会年度別」に「平成○○年度～」という 大会名を表示したいのですが、 どのようにすれば表示できるのか分かりません。 質問が複数あって申し訳ないですが、 みなさんの分かる範囲で教えていただけないでしょうか。 よろしくお願いします。
ユーザーフォームへのコピーペースト、貼り付けについて 会社で使っている専用のシステム・エミューレータがあります。 今まではその画面の一部のデータを選択して、ＥＸＣＥＬに貼り付けてました。列は2列で行は5行から15行になります。 ＥＸＣＥＬ上ではＡ1を選択して貼り付ければ、一気にＡ：Ｂ列に上から順に貼り付けになると思います。 ユーザーフォーム上で上記をやりたいのですが、例えばテキストボックスなら当たり前ですが1行分しか入力されません。 単純に一行づつコピペを繰り返すのも手ですが、煩雑になるのでやりたくありません。 あとはＶＢＡ側でエミュレーターをコントロールできればいいのですが、どうも出来ないようです。 最終的にはＥＸＣＥＬに一旦貼り付けてから、ユーザーフォームのリストボックスなどに取り込む方がシンプルなのかとは思っていますが、なんとか直接ユーザーフォームのコントロール上に貼り付けれないものかと思っています。 主にＰＣに慣れないパートさんが処理するので、今までのＥＸＣＥＬのシート上にコントロールを配置して入力させてましたが、ユーザーフォームに切り替えたいので。 御教授頂ければと思います。
エクセルのVBAについて質問なんですけど forループでカウントアップを作ってその中にCells(x,y)で指定したセルに条件付けでそのセルに到達したら条件をこなす文を作りたいんですが可能なのでしょうか？
エクセル VBA excel 下記、表を実現するマクロをお願いします 例 条件が 東京×春 のときのC列の値を全て見る １つでも、AAがあれば表に○をいれる、、、 というものを実現したいです。本来データは10000件ぐらいあるので、マクロでお願いしたいです。 よろしくお願いします
エクセルvbaについて。 連番で数字の名前がついているワークシートがあり、それぞれのワークシートから一部のセルを抜き出して別のシートに集計したいと考えています。 下記のマクロを作成したのですが、なぜかワークシートの選択ができず、途中でとまってしまいます。 なにが悪いかわからず困っております。 どう修正すればよいのか、お知恵を貸していただけないでしょうか。 よろしくお願いします。   Sub 各シートの集計() Dim i As Long   For i = 1 To 100 ThisWorkbook.Worksheets("集計").Range("b2:f7").Offset(7, 0).Value = _ ThisWorkbook.Worksheets(i).Range("o3:s8").Value Next i End Sub
マクロについて教えて下さい。sheet1 A列、B列 東京、１００ 名古屋、２００ 大阪、３００ 福岡、４００ sheet2 A列、B列 東京 大阪 【マクロ実行後】 sheet2 A列、B列 東京、１００ 大阪、３００ 名古屋、２００ 福岡、４００ 上記のように、sheet1のA列とsheet2のA列が一致した場合、B列の値をsheet2へ転記。 sheet1のA列のあって、sheet2のA列に無かった場合、sheet2の最終行以降にsheet1のA列、B列を転記したいです。 皆様のお力をお貸しください。
[50枚]vbaについて質問です。'指定されたworkbookを開く ①fl_name = Dir(txtGetPath.Value & "￥" & "*.xlsx") ②Workbooks.Open Filename:=fl_name ①で、fl_nameに正しく値が格納されているのに ②でワークブックを開くことができません。 この理由は、なぜでしょうか。 ご教授の程、よろしくお願いします。 ちなみに、開くExcelのプロパティをプログラム名 のところが、WPS Spreadsheets原因でしょうか？ 拡張子は、xlsxになっているのですが・・・。
vb.netでIEを使ってyahooを見るとかできませんか？' Ｙａｈｏｏ！を開く System.Diagnostics.Process.Start("http://www.yahoo.co.jp") ' ＩＥを起動する Dim ProcessStartInfo1 As New ProcessStartInfo() ProcessStartInfo1.FileName = "C:\Program Files\Internet Explorer\iexplore.exe" ProcessStartInfo1.WorkingDirectory = System.Environment.GetEnvironmentVariable("HOMEDRIVE") & System.Environment.GetEnvironmentVariable("HOMEPATH") Process.Start(ProcessStartInfo1) 事前設定はなしで、ＶＢ側で制御する事が前提です。 通常使うブラウザをＩＥに設定した状態で上記「Ｙａｈｏｏ！を開く」をしたり、 ＩＥのスタートページをwww.yahoo.co.jpにしておいて「ＩＥを起動する」を行うのは不可です。 ＶＢ側で強制的にＩＥを使用してwww.yahoo.co.jpにアクセスする方法が知りたいです。
先日は回答、返信いただきありがとうございました。 その後お返事をしましたが、自分の返信が遅く締め切りになってしまい、 その後のやり取りができなくなってしまいました。そのため再度こちらにて質問します。よろしければ、教えていただけるとうれしいです。 先日教えていただいたことは無事に解決できました。 今度は新たな問題がありまして…。 質問① 範囲検索（つまり、コンボ1とコンボ2が入力されている場合）はできるようになりましたが、片方のみでの検索（つまり、コンボ1かコンボ2のみが入力されている場合）を行いたいんですが、できません。いろいろと工夫しましたが、コンボ2のみでの検索はできますが、コンボ1のみでの検索ができません。 If IsNull(コンボ1) = False And IsNull(コンボ2) = False Then StrSQL = StrSQL & "And 大会 BETWEEN '" & Me.コンボ1 & "' AND '" & Me.コンボ2 & "'" ElseIf IsNull(コンボ1) = False And IsNull(コンボ2) = True Then StrSQL = StrSQL & "And 賞 >= " & Me.コンボ1 & "" ElseIf IsNull(コンボ1) = True And IsNull(コンボ2) = False Then StrSQL = StrSQL & "And 賞 <= " & Me.コンボ2 & "" End If 質問② 検索時に入力したものを一度クリア（破棄）し、再度入力して検索すると実行時エラー3075（クエリ式 '名簿ID Like '*' ～ And 大会 BETWEEN " AND "'"）と表示されます（”～”は省略部分）。 Private Sub btnClear_Click() Me.Undo txtID.Value = "" ～～～～～～～～～～～～～（”～”は省略部分） Me.コンボ1.Value = "" Me.コンボ2.Value = "" MsgBox "クリアしました。" End Sub 以上２点について再度教えていただけないでしょうか。 よろしくお願いします。
[50枚]vbaについての質問です。C:￥GetPathの下にエクセルファイル(.xlsx)が存在している状況下で、 fl_name = Dir("C:￥GetPath" & "￥*.xisx") を書いて実行したのですが、 うまくfl_nameにファイル名が入ってくれません。 どのようにすれば、入ってくれるでしょうか？ ご教授、よろしくお願いします。
お世話になります。 VBA のユーザーフォーム上にチェックボックスを25個作成しています。その名前（caption)をある条件によって別シートの名前に変更したいのですがうまくいきません。 for i = 1 to 25 for j = 4 to 28 contorol("checkbox"&i).caption =worksheets("リスト") .cells(j,3).value next next ちなみに CheckBox1.Caption = worksheets("リスト").Cells(4, 3) ・ ・ ・ CheckBox25.Caption = worksheets("リスト").Cells(28, 3) でコードを作成すると思ったように動くのですが、cells(28,3)の3（列）が条件によって変わるので 条件の数だけ同じようなコードを作成するより良い方法があればと思っています。 よろしくお願いします。
【Excel2010】マクロ ある条件のもののみを抽出して、統合するマクロをマクロの記録で作成したのですが、 BOOK名が変わっても同様に処理を進めるにはどのようにすればよいでしょうか？下記は、「マクロの記録」にて記録されたものです。 実際は「アドレスとブック名.xlsm」の部分が、実際のアドレスとブック名になっているのですが こちらをフリーにしたいといいますか・・・ 何卒、よろしくお願い致します。 Sub 統合() ' ' 統合 Macro ' ' Range("D24:AA1048576").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:= _ Range("AC21:AC22"), CopyToRange:=Range("AC24:AJ24"), Unique:=False ActiveWindow.ScrollColumn = 6 ActiveWindow.ScrollColumn = 7 ActiveWindow.ScrollColumn = 8 ActiveWindow.ScrollColumn = 9 ActiveWindow.ScrollColumn = 10 ActiveWindow.ScrollColumn = 11 ActiveWindow.ScrollColumn = 12 ActiveWindow.ScrollColumn = 13 ActiveWindow.ScrollColumn = 14 ActiveWindow.ScrollColumn = 15 ActiveWindow.ScrollColumn = 16 ActiveWindow.ScrollColumn = 17 ActiveWindow.SmallScroll Down:=-18 Range("AD25:AD50,AG25:AH50").Select Range("AG25").Activate Selection.Copy ActiveWindow.SmallScroll Down:=9 Range("AD51").Select ActiveWindow.SmallScroll Down:=-39 Range("AD25:AD60").Select ActiveWindow.SmallScroll Down:=-27 Range("AD25:AD60,AG25:AH60").Select Range("AG25").Activate Application.CutCopyMode = False Selection.Copy Range("AD61").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=-30 Range("AD25:AD60").Select ActiveWindow.SmallScroll Down:=-33 Range("AD25:AD60,AI25:AJ60").Select Range("AI25").Activate Application.CutCopyMode = False Selection.Copy ActiveWindow.SmallScroll Down:=42 Range("AD91").Select ActiveSheet.Paste ActiveWindow.SmallScroll Down:=-102 Range("AM25").Select Application.CutCopyMode = False Selection.Consolidate Sources:= _ "'アドレスとブック名.xlsm]Sheet1'!R24C31:R130C32" _ , Function:=xlSum, TopRow:=True, LeftColumn:=True, CreateLinks:=False ActiveWindow.SmallScroll ToRight:=3 Range("AL26").Select ActiveCell.FormulaR1C1 = "=INDEX(C30:C31,MATCH(RC39,C31,0),1)" Selection.AutoFill Destination:=Range("AL26:AL59"), Type:=xlFillDefault Range("AL26:AL59").Select ActiveWindow.SmallScroll Down:=-39 Range("AL24").Select ActiveWindow.SmallScroll Down:=-78 End Sub
添付画像の状況で、Ｃ６をアクティブにして、以下のコードを実行します。Sub sample() Dim nm As String, zp As String, adr As String With ActiveCell 'アクティブセルがA列以外なら何もしない 'If .Column <> 1 Then Exit Sub '姓名を取得する nm = .Value '郵便番号を取得する zp = .Offset(1, 1).Value '住所を取得する adr = .Offset(2, 1).Value '名前・郵便番号・住所のいずれかが空欄なら何もしない 'If nm = "" Or zp = "" Or adr = "" Then Exit Sub '転記する .Offset(3, 0).Value = zp & vbLf & adr & vbLf & nm & "さま" .Value = .Offset(3, 0).Value Range(.Offset(1, 0), ActiveCell.Offset(3, 5)).Merge ActiveCell.Offset(1).Resize(3).EntireRow.Delete End With ActiveCell.Copy ActiveCell.Offset(0, 1).Activate ActiveSheet.Paste ActiveCell.Font.Size = 14 ActiveCell.Offset(0, -1).Activate ActiveCell.Value = "" End Sub すると、目的の処理は完遂するのですが、「セルを結合すると左上の端の・・・・」というアラートが出てきます。これが邪魔なので、出てこないようにしたいのですが、どうすればいいでしょうか？ よろしくお願いします。
エクセル初心者です。エクセルで出来るかどうかすらわからない状況でアドバイスが欲しいです。 エクセルのシート1に顧客情報名簿があり、1人の情報が一行にまとめてあります。データシート2に ____A _____ B_____ C_____ 2 お客様名 住所 購入履歴等 3 … 4… A2にお客様名を入力するとシート1からB2、C2の必要情報項目へデータを抽出して反映させたいのです！またA3、A4…と下にお客様名を追加していく予定です。 できればお客様名をヨミで入力したいのですが、そうするとどうしても同姓同名の別の方が出てきてしまいます。同名の際はその抽出した複数のデータから入力者が住所を見て選択して反映させる…というような事は可能なのでしょうか？
access2016のVBAについて -（ハイフン）が入っているフォームをいくつか作ってしまいました。再クエリしたいのですが、 Forms!F-フォーム名.Requery と記入するとコンパイルエラーになってしまいます。 結構進めてしまったので、できることならフォーム名を変えたくないのですが、 なにか方法はあるでしょうか？
エクセルを使って以下の事が処理したいです。 ★sheet1の内容 下表はC列の注番に対して分納指定されている食品を表しています。（注番が同じで、納期1、数量1、納期2、数量2・・・） ___A列___B列__C列___D列____E列___F列_____G列___H列______I列 01_県名__食品_注番__納期1___数量1__納期2___数量2_納期3____数量3 02_埼玉__魚____1____16/8/4__10____16/9/4___60____16/10/20_60 03_栃木__野菜__ 2____16/8/5__20 04_茨城__果物__3____16/8/6__50 05_東京__肉____4____16/8/7__60____16/10/4__50 ★sheet2の内容 sheet1の納期、数量が複数回ある場合（分納の場合）は、納期2、数量2を納期1、数量1の 下行に追加し、そこにA～C列の情報も記載したいです。 ___A列__B列__C列_D列_______E列 01_県名_食品_注番_納期_____数量 02_埼玉_魚____1___16/8/4___10 03_埼玉_魚____1___16/9/4___60 04_埼玉_魚____1___16/10/20_60 05_栃木_野菜__2___16/8/5___20 06_茨城_果物__3___16/8/6___50 07_東京_肉____4___16/8/7___60 08_東京_肉____4___16/10/4__50 VBAを使って処理したいと考えています。 実行するとsheet1の情報を基にsheet2に展開したいです。 お手数ですが、ご教示お願い致します。
accessについて勉強中です。 販売管理システムを制作中なのですが、いきずまってしまった為、 教えてください。［売上伝票］フォームには、納品先、住所、電話番号のテキストボックスがあります。 それらに、検索対象の文字を入力し、そのすぐ横に設置した【検索】ボタンを押すと ［取引先一覧］フォームから、検索対象の住所録が抽出される様になっています。 問題はその後で、抽出された情報を再度、横に設置した【抽出】ボタンを押し、 ［売上伝票］フォームに転記させたいのですが、うまくいきません。 コードを教えて頂きたいです。 Private Sub 選択_Click() Forms!売上伝票!名前 = Me!名前 Forms!売上伝票!郵便番号 = Me!郵便番号 Forms!売上伝票!所在地 = Me!所在地 Forms!売上伝票!電話番号 = Me!電話番号 Forms!売上伝票!担当者 = Me!担当者 DoCmd.Close Exit Sub End If 'Forms![売上伝票]![テキスト183] = Me![現場名] 'Forms![売上伝票]![テキスト205] = Me![所在地] 'Forms![売上伝票]![テキスト207] = Me![電話番号] End Sub
マクロ セルに入力して シートを開いて、データ転記する セルに入力してボタンを押して シートを開く シートは１ (１日） Ａ2に｢1」 Private Sub CommandButton1_Click() Workbooks.Open Filename:="C:\/\/\/\7月.xlsx"Sheets(Range("A2").Name).select（セルに入力） MsgBox(ActiveSheet.Name) Windows("日報.xlsx").Activate （ファイル名） Range("A1:B6").Select （コピー転記） Selection.Copy Windows("7月.xlsx").Activate （貼り付け） Range("A1").Select ActiveSheet.Paste Range("C4").Select Application.CutCopyMode = False ActiveWorkbook.Save （保存） ActiveWindow.Close （７月.xlsx閉じる） End Sub うまくできません。 よろしくお願いします。
VBAを利用したCSVファイルの取り込みについて 以前にも、知恵袋から質問投稿しておりましたが問題未解決のため再投稿しました。 前回、ご回答頂いた方ありがとうございました。質問内容ですが、CSVデータをExcelで普通に開くと数字の計算が出来なくて困っております。 このCSVファイルをテキストで開くと、以下のように数字にダブルクオーテーションが付いている状態です。 商品名 " 仕入価格" 市場価格（A店） 市場価格（B店） ラジカセ " 8600" " 10565" " 14200" 電子辞書 " 5000" " 6200" " 6200" ドライヤー " 3000" " 4212" " 4212" 体重計 " 2380" " 3999" " 3999" トースター " 3400" " 3830" " 4940" コーヒーメーカー " 3600" " 3850" " 5837" 掃除機 " 7100" " 5250" " 9359" テレビ " 18000" " 20980" " 20980" 扇風機 " 12500" " 14090" " 16300" 机 " 16000" " 16180" " 18980" その為、この数字に付いているダブルクォーテーションを削除するVBAを削除したいと考えております。 VBAに詳しい方、ご教示のほど宜しくお願い致します。
エクセルのVBAでの質問です。 セルの数値を読み取って、数値によって図形の色を変化させたいです。しかし、セルの値は計算結果を参照しているためWorksheet_Changeでは思い通りに動作してくれませんでした。そこで、Worksheet_calculateを使ってみたのですが「オブジェクトが必要です」とエラーが出てしまいます。具体的にどこをどうしたらいいのかを教えてもらえると助かります。 Worksheet_calculateを使わなくても、結果的に計算結果によって図形の色が変化すれば良いです。VBAについて素人のため具体的な回答をお願いいたします。 Private Sub Worksheet_calculate() Select Case Target.Address(0, 0) Case "A1" ActiveSheet.Shapes("図形１").Select Case "A2" ActiveSheet.Shapes("図形２").Select Case Else Exit Sub End Select Select Case Target.Value Case Is = 1 Selection.ShapeRange.Fill.ForeColor.SchemeColor = 8 Case Is = 2 Selection.ShapeRange.Fill.ForeColor.SchemeColor = 12 Case Is = 3 Selection.ShapeRange.Fill.ForeColor.SchemeColor = 10 End Select Target.Select End Sub
エクセルのVBAを教えてください エクセル2010でOutlookも2010です エクセルに記載している人をOutlookの新規メールを立ち上げ宛先を振り分けたいです シート１のA列に記載している人は宛先がto Ｃ列に記載している人はccにしたいです 記載しているのはOutlookに登録している名前です。このような事できますか？ あと署名は設定してますので署名も出てほしいです。題名等は不要です
Excelでの入力規則を用いた２段階絞り込みについて（関数でもVBAでも構いません） お世話になってます。図に示すように、Sheet1のUserNameで選択した文字列（あ）に対応するデータ（a,e,f）をSheet1のSampleNameから入力規則のリストを用いて選択できるようにしたいと考えています。 この際、Sheet2のデータにはオートフィルタ等の並び替えが起こっても構いません。 関数でもVBAでも構いませんので、コード等わかる方いらっしゃいましたらご教授下さい。 よろしくお願いします。
条件付き書式について、 エクセルでレンタル備品のスケジュール管理をしようと思っています。別の管理ソフトから落としたレポートの「項目番号」と「日付」を参照して該当する「開始日」～「終了日」の該当する箇所を色づけしたいです。 ガンチャート方式で一項目に対して1つの「開始日」「終了日」だったら条件付き書式で可能なのですが、レンタル品の為、1カ月の間に複数の「開始日」と「終了日」があり、まず項目番号を参照し、該当があるものだけ色づけがする事ができません。 リストは日にちが経過するにつれ増加する予定です。 カレンダーは月を変えると日付が変更するように作っていますので、できれば月が替われば該当部分の色塗りも変更するようにしたいです。 会社のものなのでソフトを使用することはできないのでエクセルでなんとかしたいです。 エクセルは2010を使用しています。 よろしくお願いいたします。
EXCEL2010のマクロに関する質問です。 貼付図みたいに、A列に商品品番、B列に単価、C列に量（kg）、D列に売上という表があります。 D2にはB2*C2となっています。これを例えば、７商品でマクロの記録をすると、以下になりました。 これを１００商品あれば、勝手に１００行計算、１６７行あれば１６７行計算するようなマクロの組み方を教えていただけませんでしょうか？ 宜しくお願い致します。 Sub Macro2() ' ' Macro2 Macro ' Range("D2").Select Selection.AutoFill Destination:=Range("D2:D8") Range("D2:D8").Select Range("A1").Select End Sub
EXCEL のアドインに分析ツールと分析ツール-VBAというのがありますが、インストールの 方法はWEBに山ほど書いてありますがどんなことに使うのかが見つかりません。 わかる方お願いします。
ＥＸＣＥＬ ＶＢＡの質問です。 Ａ行に Ａ１、Ａ２・・・といった装置の名前を羅列しております。 それぞれの行のＢ～Ｆのセルにその装置の 条件などを記入しております。この装置の一覧の中で、 Ｓ１、Ｓ２、Ｓ３の名称の装置に関する行を削除する マクロを作成しました。 Sub n() Dim i As Long Dim s As Variant Dim c For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row For Each c In Range(Cells(2, 1), Cells(Cells(Rows.Count, 1).End(xlUp).Row, 1)).Value s = Array("S1", "S2", "S3") If InStr(c.Value, s) <> 0 Then Rows(i).Delete End If Next c Next i End Sub これだとInStrのところで オブジェクトが必要ですとエラーが表示されました。 目的の行を削除し、上に詰めるといったことをしたいのですが。 どのようにマクロを作成すればよろしいでしょうか？ また、空白の行を詰めるマクロも合わせて ご教授願えませんでしょうか？
エクセル関数についての質問です。 シート１に表Ａ、シート２には表Ｂがあります。 二つの表は列数や列毎の項目名等全く同じです。シート３に関数を用いて表Ａ、表Ｂの順に立てに空白行無しに並べて、一つの大きな表にしたいです。 ただし、表Ａは行数が変動します。 ここでお尋ねしたいのですが、行数が変動する表Ａのすぐ下にどのように表Ｂを挿入すればいいでしょうか。 具体的に関数の式を使ってご説明いただけるとありがたいです。 統合機能を使えばできる作業なのですが、できれば関数を用いて作りたいです。 ご回答よろしくお願いします。
Visual Basicを利用して、エクセルみたいな表を作って画像として出力するソフトって作れますか？自分や知り合いがやる分にはマクロを組んだエクセルファイルを共有すれば事足りるんですが アプリケーションファイル（exe）として共有したい都合が出来ました。まずは環境を、と Visual Studioをインストールした段階です。 （１）オプションボタン、コンボボックス等を利用して、表に罫線や文字、画像を加えたい。 （２）２つのウィンドウで作業をし、１つのウィンドウに結果をすぐ反映するエクセルのようなテーブル表、もう一つは（１）のような作業をするユーザーフォーム。 （３）テーブル表はエクセルのセルのような感じで、選択中のセルを認識してくれる。そこに文字や絵を加えられる。 （４）最後に出来た表をpngやbmp等で出力する。 このようなことをしたいのですが、可能でしょうか？ もし可能であれば、ちょっとアドバイスしていただけると助かります。
教えてください。エクセル（2010）で、連続する値を別のシートへ抽出する際、１つのセルを空白、その次に値を１セットとして抽出したいです。1,2,3,4,5,6・・・・ → 1,空白,2,空白・・・のように。その後、右列へオートフィルを行うこと可能でしょうか。よろしくおねがいします。
ページの設定を固定するコード？エクセルでシートをPDFで出すのをマクロの記録でつくりました。 これをページの設定で横向きでかつ次のページ数に合わせて印刷で横1、縦を空白で出したいです。以下コードです。 Sub 出力（） Sheets("シート名").Select ChDir _ThisWorkbook.Path ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF,Filename:=ThisWorkbook.Path&"¥"&"シート名.pdf"_ ，Quality:=xIQualityStandard,IncludeDocProperties:=True， lgnorePrintAreas_ :=False,OPenAfterPublish:=False MsgBox"シート名が出力されました" End Sub 一回ページの設定をしてからPDFで出すのをマクロの記録で作ってみたのですがコードが長すぎて、もうちょっと短くできないかとおもったのです、、、 方法がなければ諦めます、、 どなたかいい案があれば宜しくお願い致します。
エクセルのマクロを教えてください。 「月」フォルダ内に複数の「日報」エクセルブックがあります。各ブックのシート3、H12からH35までの数値データ（２４個）をコピーして集計用の「年」ブックの「月」シートに貼り付けたいです。この「年」ブックには「月」シートがあって1日からその月末までの日にちがセルB2、C2、D2…に記入してあります。各日にちの行の下（1日であればB3からB26、24個）に貼り付けるようにマクロを組みたいです。 「日報」エクセルブック名称：D20160701.xls 「年」ブックの「月」シート名称：2016.7月 「日報」と「年」ブックは別の場所にあります。 初めてのマクロで自分で調べてもなかなか前に進みません。 図々しいのはわかっていますがどうかよろしくお願い致します。
ユーザーのリソース追加について いつもお世話になっております。 文書の保管場所を登録し、文書名を入力すれば文書の保管場所がテキストと画像で表示されるプログラムをVBで作ろうと思っています。(初心者のため、今練習として作成しています。) テキストの登録・データの呼び出しくらいは頑張れば出来そうな気がしますが、画像の登録(ユーザーのリソース追加?)について、やり方がわかりません。 OpenFileDialogクラスを使用してできますか?(Streamの利用?) ご教授いただけないでしょうか。 よろしくお願いします。
Arduinoを用いて得られた5つの電圧値をエクセルのcsv形式として直接保存したいのですがどのようなプログラムをかけばよろしいのでしょうか？現在は 例) 3998,421,312,1132,2543 4000,420,312,1100,2500 ........... (単位は[mV]) といったシリアルモニタに表示される数値をノートにコピペし、csv形式で保存しているのがとても手間がかかって困っています。
エクセル条件付き書式がうまくいきません。 こちらの背景色を3色に分ける変更を条件付き書式で設定後、マクロに記録、実行して、そのあと重複箇所1つ残して他を手作業で削除する予定です。3色に分ける条件がこちらです。 ・P～S列の行にA列で重複した場合、F列の1と2は除く、背景色黄色をつける ・P～S列の行にF列で1が入っている場合に背景色オレンジをつける ・Q列とR列の行にF列で2が入っている場合に背景色オレンジを付つける ・P列とS列の行にF列で2が入っている場合に背景色ピンクを付つける 試したのがこちらですが、③からうまくいきませんでしたので何かいい方法があれば教えて頂きたいです。 ①P～S列の行にA列で重複した場合、F列の1と2は除く、背景色黄色をつける =AND($F1<>1,$F1<>2,COUNTIF($A:$A,$A1)>1) ②P～S列の行にF列で1が入っている場合に背景色オレンジをつける =$F1=1 ③Q列とR列の行にF列で2が入っている場合に背景色オレンジを付つける =$F1=2 ④P列とS列の行にF列で2が入っている場合に背景色ピンクを付つける =$F1=2 おそらく②と③が競合しているため、③からうまくいきませんでした。
対象の列の値が入ってる一番したの行を取得したいのですが、vbsではEnd(xlup).rowのような、コードはないのでしょうか？ ご教示願います。
WindowsのWSHについてお教えください。環境はWindows 7です。 あるファイルが自分のパソコン上（ローカル）に存在するか、ファイルサーバー上にあるか判断したいと思っています。例えばmytext.txtというファイルがローカルハードディスク上のXドライブ上にあるとすると、「このファイルはローカルハードディスクに存在します。」というメッセージを流し、ファイルサーバー上にあるとすると、「このファイルはファイルサーバーに存在します。」 といったメッセージを表示したいと思っています。ネットで検索しても、やり方を見つけられませんでした・・・よろしくお願いいたします。
形の同じＣＳＶファイルを１つのＣＳＶファイルに統合したいのですが、 以下のコードでは、容量に限界があるようです。 容量が大きいファイルになると、それぞれのファイルが合体できません。統合後３０万行程になるのですが・・・ 大きな容量でも統合することができるようにするには、どうすれば良いのでしょうか？ 教えて頂けると助かります。 よろしくお願い致します。 Sub ファイル統合マクロ() Dim folder As String Dim file As String Dim fso As Object Dim ts As Object Dim f As String Dim itxt As String Dim otxt As String folder = "C:\ファイル\それぞれのファイル" file = "統合.csv" Set fso = CreateObject("Scripting.FileSystemObject") f = Dir(folder & "*.csv") Do While f <> "" Set ts = fso.OpenTextFile(folder & f) itxt = ts.ReadAll ts.Close If Not itxt Like "*" & vbCrLf Then itxt = itxt & vbCrLf Name folder & f As folder & f & ".del" If otxt <> "" Then itxt = Mid(itxt, InStr(itxt, vbCrLf) + Len(vbCrLf)) End If otxt = otxt & itxt f = Dir Loop Set ts = fso.OpenTextFile(folder & file, 2, True) ts.Write otxt ts.Close Kill folder & "*.del" '".del"ファイル削除 Set fso = Nothing End Sub
お世話になっております。 ExcelVBAでの質問です。 ユーザーform1に TextBoxが10個 コマンドボタンが10個 をセットのような扱いでおいています。コマンドボタンはすべてユーザーform2を開くようになっています。 ユーザーフォーム2にはリストボックスとコマンドボタンが1つづつあり、 そこで質問なんですが、リストボックスのデータ選択してコマンドボタンを押すとそのデータがユーザーform1に受け渡せるようにしたいのですがどのようにしたらよいでしょうか？ 例 コマンドボタン1でform2を開いた場合、受け渡すデータはTextBox1へ コマンドボタン2でform2を開いた場合、受け渡すデータはTextBox2へ のような流れにしたいです。 説明がわかりにくいかもしれませんがよろしくお願いします。
東京芸術大学の先端芸術表現科についての質問です。実技審査とは具体的にどのような感じの問題なのでしょうか？ もし、小論を選んだとしたらその次に行われる実技はどんなものですか？ よく違いがわからないので、教えてください！
imacrosについて 最近、imacrosという自動化ツールを知ったことから、業務でPC作業の自動化を行おうと考えています。繰り返し処理を行ってくれるので、単純な作業には積極的に導入しようと考えているのですが、繰り返し処理の一部を手動で行うようなプログラムを書くことは可能ですか？ どのように記述すればよいのでしょうか？
VBAに関する質問です。当方、プログラミングは初心者ですが、よろしくお願いいたします。 内容としては、フィルターでできるレベルですが、VBAでの回答を希望します。VBAで条件をすべて満たす行を抽出して、別のシートに表示させたいです。 具体的には、ツイートのデータベースから条件を指定し（項目は、id、name、nickname、date、tweetとなっており、今後20項目まで増える可能性があります。）、それらに該当する行を抽出し、該当するデータを表示させたいです。その際、１データにつき１シートで、結果を出したいです。 イメージとしては、 入力フォーム id、name、 nickname、 date、 tweet aaa 2016/0719 イチロー 野球 3000本 上記を満たす行をデータベースより抽出したいです。（tweet欄はイチロー 野球 3000本という単語がすべて含まれるツイートを探したいという意味です。） 結果出力のイメージとしては、 入力条件 id、name、 nickname、 date、 tweet aaa 2016/0719 イチロー 野球 3000本 出力結果 id、name、nickname、date、 tweet 34 aaa abcd 2016/0719 本日、野球選手のイチローが3000本達成！ 1560 aaa hijk 2016/0719 野球選手のイチローが3000本達成した模様 よろしくお願いします。
DGVのｾﾙの値を掛け算して表示したい。 補足して再質問します。 合計=時間×分率 です。時間列と分率列の入力が確定後に 合計を表示させるようにしたいです。 よろしくお願いします。
Excel VBAに関して質問です。 プログラムを組んだのですが思ったように動作しないのでお力を貸していただきたいです。 B列に数字が入力されています。その配列の中で、0未満から0以上になった時の行番号をC列に入力していきたいです。 例えば、 1 1 2 -1 3 -6 4 4 5 3 6 -8 7 1 だとすると、 3行目から4行目、6行目から7行目が条件を満たしています。 なので、C1に3、C2に6を入力されるように組みたいです。 --------------------------------------- Sub macro() N = 99999 B = 2 K = 1 L = 3 For i = 1 To N If Cells(i, B) < 0 And Cells(i + 1, B) >= 0 Then Cells(K, L)= i And K = K + 1 Next End Sub ---------------------------------------
エクセルのＶＢＡで質問です。以下の構文で、作業するブックを選び、Workbooks(2).Worksheets(1)をSet sheetobjで定義した後、sheetobj.Range("a1").AutoFilter など作業していきたいのですが、現在使用しているＰＣのみうまくできません。ほかのＰＣでは問題なく処理できます。 具体的には Set sheetobj = Workbooks(2).Worksheets(1) が Set sheetobj = Workbooks(1).Worksheets(1) となって作業が進められてしまいます。 解決方法をご教授いただけますでしょうか。 宜しくお願い致します。 Set myFD = Application.FileDialog(msoFileDialogOpen) myFD.FilterIndex = 2 If myFD.Show = -1 Then myFD.Execute Else Exit Sub End If Set sheetobj = Workbooks(2).Worksheets(1) sheetobj.Range("a1").AutoFilter
VB2013について質問です 現在、簡単な在庫管理を作っていますが わからないことがあり教えてください。Comboboxにリストを作り リストを選ぶと textboxにリストの商品名 textbox2に在庫数というまではできたのですが リストが変わればもちろん商品名は変わります しかし textbox2が一つで表示させてるので 前の在庫数から加算したり減算しか できません ＋と--のボタンを設置して そこで加算、減算させる予定です。 ひとつずつの格納はわかりますが リストを選ぶたびに textbox2の数値が リストの項目の一つに保存されてる数値に切り替わったり 0に戻したりなどはどうすればいいのでしょうか？？ リストが５つあったら ５つの変数を用意して そこに数値を保存してなど 考えましたが どーしても切り替えても 呼び出したり 保存されてないなど 不具合が起きます。 教えていただけると助かります。
エクセルＶＢＡ？マクロ？について困っています。 ・・もともとあったエクセルのファイルにマクロが登録されていて それを押せば色々処理ができるようになっていたのですが、 いざそれを押してみると、○内はファイル名＝「○○○ボタンを実行できません。このブックでマクロが使用できないか、またはすべてのマクロが無効になっている可能性があります。｝ と表示され実行することができません。 ・・ですがリボンの「開発」から「マクロ」内のマクロ名？一覧からマクロを選択して「実行」ボタンを押すと きちんと動作します。 ・・マクロ名についてですが、元のファイルで例「あいうえ」とあったマクロ名が私のパソコンで表示すると 「あい」と途中までしか表示しておらず、ＶＢＡで直接マクロ名のところを編集しようとしたのですが 「あいうえ」と入力して別のところをクリックすると「あい」の状態になり、「うえ」は自動的に消去されてしまいます。 ・・別の文字で試してみたところ「あいああああ」と入力してみると、消えることなく編集可能でした。 ・・セキュリティセンターのマクロの設定ではすべて有効にしています。 ・・エクセル内のそのボタン上で右クリックを押して「マクロの登録」を選択して登録すると 一時的にボタンからマクロを実行することができます。（上書き保存して再度表示すると最初に出たエラーメッセージが表示されます） 何か解決策はあるのでしょうか よろしくお願いします。
Access VBAについて。 コンボボックスを用いて範囲検索を行う場合 SQL書き方は下記で合ってますか？------------------------------------------------ 数値型 Between コンボ1 And コンボ2 テキスト型 Between "コンボ1" And "コンボ2" ------------------------------------------------ 違っていた場合はどのように書けばよいでしょうか？
エクセルでマクロ処理をして下記の作業が出来るようにしたいです。どんなコードになるかお教えください。「Sheet1」のF列に入力した文字列が「Sheet2」のG列にある文字列を含む場合は、その行の「Sheet2」のC列の文字列を「Sheet1」のE列に抜き出す 但し「Sheet2」のG列にある文字列が複数含む場合は、文字列を多く含む行を優先して「Sheet1」のE列に抜き出す
以下のコードなのですが、もともと2つの 差分用のシートは用意されていて、 毎回の抽出の際にに差分用のシートを新規につくるのではなく、 差分用のシートの内容だけを書き換えるにはどう変えたらいいでしょうか。 ちなみに1行目には項目が入るので 2行目以下から消して、新しく出る削除結果、追加変更結果を上書きしたいです。 一旦差分用のシートを削除する 差分用のシートを新規に作成する の部分を自分なりにかきかえてみたのですがうまくいきません。 なぜこれではいけないのかと言うと このあとの処理で追加変更データを PDFで吐き出すのですが、 最初は設定をしておけば Aセル〜Hセルまで1枚で出ますが 次に比較させてから吐き出すときに ABセルで1枚、CDセルで1枚…… と出力されてしまうしまうので予め 追加・変更シートの 印刷の設定をしてそれを使いまわせば 次に比較してからPDFで吐き出すときに 1枚で出ると考えたためです。 よろしくお願いいたします。 Option Explicit Sub Sample() '以下のシート名は適宜変更してください。 Const DelSheet As String = "削除データ" Const AddSheet As String = "追加・削除データ" Dim stName As Variant, i As Integer Dim st1 As Worksheet, st2 As Worksheet Dim st(2) As Worksheet Dim rSrc As Long, rDst As Variant 'Excelの再描画を一時停止する Application.ScreenUpdating = False Set st1 = Worksheets("Sheet1") Set st2 = Worksheets("Sheet2") '一旦差分用のシートを削除する Application.DisplayAlerts = False On Error Resume Next Worksheets(DelSheet).Delete Worksheets(AddSheet).Delete Worksheets(ChgSheet).Delete On Error GoTo 0 Application.DisplayAlerts = True '差分用のシートを新規に作成する For Each stName In Array(DelSheet, AddSheet, ChgSheet) Set st(i) = Worksheets.Add(After:=Worksheets(Worksheets.Count)) st(i).Name = stName st1.Rows(1).Copy st(i).Range("A1") i = i + 1 Next stName '削除データ抽出（注文番号がSheet1にあってSheet2にないものを抽出する） 'Sheet1を全件調べる For rSrc = 2 To st1.Range("B" & Rows.Count).End(xlUp).Row '注文番号がSheet2にあるかどうかを判定する rDst = Application.Match(st1.Range("B" & rSrc), st2.Columns("B"), 0) '注文番号が存在しない場合は削除データシートに書き出す If VarType(rDst) = vbError Then st1.Rows(rSrc).Copy st(0).Rows(st(0).Range("B" & Rows.Count).End(xlUp).Offset(1).Row) End If DoEvents Next rSrc '追加データ・変更データ抽出 '注文番号がSheet2にあってSheet1にないものは追加データ '注文番号がSheet2にもSheet1にもあって、他が異なっているものは変更データ 'Sheet2を全件調べる For rSrc = 2 To st2.Range("B" & Rows.Count).End(xlUp).Row '注文番号がSheet1にあるかどうかを判定する rDst = Application.Match(st2.Range("B" & rSrc), st1.Columns("B"), 0) '注文番号が存在しない場合は追加・変更データシートに書き出す If VarType(rDst) = vbError Then st2.Rows(rSrc).Copy st(1).Rows(st(1).Range("B" & Rows.Count).End(xlUp).Offset(1).Row) Else '注文番号が存在する場合、他が異なっているかどうかを判定する If st2.Range("A" & rSrc).Value <> st1.Range("A" & rDst).Value Or _ st2.Range("C" & rSrc).Value <> st1.Range("C" & rDst).Value Or _ st2.Range("D" & rSrc).Value <> st1.Range("D" & rDst).Value Or _ st2.Range("E" & rSrc).Value <> st1.Range("E" & rDst).Value Or _ st2.Range("F" & rSrc).Value <> st1.Range("F" & rDst).Value Or _ st2.Range("G" & rSrc).Value <> st1.Range("G" & rDst).Value Then '他が異なっている場合は追加・変更データシートに書き出す st2.Rows(rSrc).Copy st(1).Rows(st(1).Range("B" & Rows.Count).End(xlUp).Offset(1).Row) End If End If DoEvents Next rSrc 'Excelの再描画を再開する Application.ScreenUpdating = False End Sub
マクロ教えてください！ 次の二つの条件を満たすマクロのチェックツールのようなもを作成しようと考えています。１、Ｄ列に”山”という文字があるとき、Ｏ列に”川”以外の文字が入力されている場合Ｏ列該当セルを赤くし警告文を出力。 可能でしたら、Ｄ列に山があった場合０列は”川”がセル内に入力されていればＯＫとしたいです。 例）河川敷でも川が含まれているので、赤くしない ２、Ｄ列に”ゴンドラ”という文字があるとき、Ｅ・Ｇ・Ｉとひとつ飛ばしのセルへ何か文字が入力されている場合、その次のセル（Ｅに入力があればＦ）に”○”、入力がなければ”×”と記載されているかチェックし、違った場合は該当セルを赤くし警告文を出力 以上になります。どちらかの条件のみでもいいですが、なるべく二つを同時にチェックできるようなものをお願いします。
マクロでナンバリングをしました、桁が6ケタ以上になると、オーバーフローになってしまいます。 どのようにすればいいか教えてください。Sub NumberPrint() Dim idx As Integer Dim frmPage, toPage Dim a frmPage = Application.InputBox("連番を挿入して印刷します" & Chr(13) _ & "開始番号を入力してください", Type:=1) toPage = Application.InputBox("終了番号を入力してください", Type:=1) a = MsgBox("開始番号は" & frmPage & "、終了番号は" & toPage & "です。" & vbCrLf & _ "印刷しますか？", vbYesNo, "印刷確認") If a = vbYes Then If frmPage > 0 And toPage >= frmPage Then For idx = frmPage To toPage Range("O1").Value = idx ActiveSheet.PrintOut Next idx Else MsgBox "開始番号、終了番号が不適切です。印刷は行いません" End If End If End Sub
Excel VBA初心者です。 教えてください。Aブックが開かれた状態で 1-AブックのSheet１のボタンクリック 2-同一フォルダにAブックをコピー 3-コピーしたブックを開く 4-ブックの名前をSheet１のセルA1入力で変更 という処理を行いたいのですがどうすればいいでしょうか？
excel vbaで、ユーザーフォームの画面を更新してから音を鳴らしたい Userフォーム上のラベルやテキストボックス等に文字列を表示してから音を鳴らしたいと考えています。音を鳴らすのは PlaySound ActiveWorkbook.Path & "\sound\complete.wav", 0, 0 のようにしております。 コードの書き順はもちろん[ユーザーフォーム上に文字列を表示]⇒[音を鳴らす]の順で書いているのですが、音がなった後にユーザーフォームの画面が更新されて文字列が表示されてしまいます。 Application.ScreenUpdating = False のコードを書いて画面描画をとめているわけでもありません。 どのように対処すればよろしいでしょうか。
【Excel2010】関数 A2~E13 を元データとして その集計を G2~K7へ算出したいのですが、ご教授をお願いいたします。DSUMをこころみましたが、うまくいかず悩んでおります。 よろしくお願いいたします。
Visual Studio(VB)についての質問です。「ボタンを押したときAの画像を表示させ、0.5秒経ったら自動的にBの画像が表示される（こちらは時間制限なし）」プログラムを組みたいのですが、timer(?)などの使い方もよくわからず困っています。 どのようなプログラムを組めばよいのでしょうか。 回答よろしくお願いいたします。
エクセルのマクロの作業でA１に「一丁目」と入力したら「１丁目」となるようにしたいです。どのようなコードにすればいいですか
C#のフォームのイベント追加 いつもお世話になっています。 VisualStudioでC#を用い、プログラムを作成しているのですが、デザイナではなく、コード中でイベントの追加が出来ません。 ボタンやテキストボックスであれば、 コントロール名.発生させたいイベント += コードで作成したイベント名 でそのコントロールにイベントを追加させることができるのですが、フォームに対して上記の方法だとエラーが起きてしまいます。 デザイナからフォームに対してイベントを追加すれば動くのですが、コードからフォームに対してイベントの追加はなぜできないのでしょうか。 できる方法をご存知の方、教えて下さい
VS2010(VB)でプログラミングしています。Zip圧縮ファイル作成でつまずいています。お知恵を拝借できれば幸いです。 Import文でSystem.IO.Compressionを指定していますが ZipFile.でコンパイルエラーが出ます System.IO.Compressionの後は CompressionMode DeflateStream GZipStream しかありません。 ちなみに、.NetFrameWork4.5をインストールしようとすると最新バージョンが既にインストールされていますと出ます。おそらく4.5以上と思われます。 開発環境はWindows7ですが、Windows10でも同じでした。
以下の式について間違っている部分をご教授いただきたく思います。if テキストボックスB=is null テキストボックスB Then me.テキストボックスB=テキストボックスA end if 【やりたい事】 フォーム上にテキストボックス（A）、テキストボックス（B)があり、コマンド実行時テキストボックスBが空白ならテキストボックスBにテキストボックス（A）の内容を表示、それ以外はテキストボックスBの内容を表示という式を組みたいと思っていますが上手くいきません。 どうかお力添えお願い致します。
記述したい場所に上手く記入できませんどなたかアドバイスいただけませんでしょうか Private Sub CmdBtnRgst3_Click() ActiveSheet.Name = "実績記入シート" Dim i As Integer Dim myRange As Range Set myRange = Cells(Rows.Count, 1).End(xlUp).Offset(0, 1) 'ここがUserForm4(同じ記述有り)と競合している？ どちらかを抜くと一方は上手く動くが、 _ もう一方は記載のエラーが出る。 For i = 1 To 100 Step 1 Select Case Cells(i + 2, 2).Value '生産量計算シートのA列（品番）D列（生産数）から160tの着工枚数を _ 実績記入シートのO列（品番）P列（生産数）に上から転記する。 Case "X207", "X980", "X981", "982", "983" myRange.Offset(0, 15).Value = Worksheets("生産量計算シート").Cells(i + 1, 1).Value myRange.Offset(0, 16).Value = Worksheets("生産量計算シート").Cells(i + 1, 4).Value '「Cells(i+2,15)=Worksheets("生産量計算シート").Cells(i + 1, 1).Value」だと貼付行に空きができる。 '生産量計算シートのA列（品番）D列（生産数）から200tの着工枚数を _ 実績記入シートのQ列（品番）R列（生産数）に上から転記する。 Case "222" myRange.Offset(0, 17).Value = Worksheets("生産量計算シート").Cells(i + 1, 1).Value myRange.Offset(0, 18).Value = Worksheets("生産量計算シート").Cells(i + 1, 4).Value '生産量計算シートのA列（品番）D列（生産数）から400tの着工枚数を _ 実績記入シートのS列（品番）T列（生産数）に上から転記する。 Case "210", "211", "212", "213", "216", "217", "218", "219", "220", 223, "224", "300", "301", _ "400", "450", "501", "502", "504", "505", "506", "507", "508", "509", "510", "525", "526", "536", _ "537", "539", "546", "551", "552", "553", "561", "562", "564", "566", "570", "572", "573", "574", _ "575", "576", "577", "579", "629", "786", "910", "911", "912", "913", "914", "915", "916", "924", _ "925", "926", "927", "930", "931", "932", "S403", "S405", "S407", "S408", "309", "310", "311", _ "312", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", _ "327", "328", "329", "330", "331", "332", "333", "334", "335" myRange.Offset(0, 19).Value = Worksheets("生産量計算シート").Cells(i + 1, 1).Value myRange.Offset(0, 20).Value = Worksheets("生産量計算シート").Cells(i + 1, 4).Value '生産量計算シートのA列（品番）D列（生産数）から600tの着工枚数を _ 実績記入シートのU列（品番）V列（生産数）に上から転記する。 Case "215", "221", "225", "365", "366", "520", "521", "540", "541", "542", "545", "547", "549", _ "550", "560", "567", "568", "571", "581", "583", "675", "676", "757", "790", "908", "909", "928", _ "929", "S601", "S602", "S605", "S606", "307", "308" myRange.Offset(0, 21).Value = Worksheets("生産量計算シート").Cells(i + 1, 1).Value myRange.Offset(0, 22).Value = Worksheets("生産量計算シート").Cells(i + 1, 4).Value '生産量計算シートのA列（品番）D列（生産数）から1000tの着工枚数を _ 実績記入シートのW列（品番）X列（生産数）に上から転記する。 Case "214", "360", "362", "500", "673", "674", "900", "901", "905", "906", "907", "E101", "E102", _ "E103", "E104", "E107", "E109", "E150", "E151", "E152", "E155", "E605", "E630", "S101", "S102", _ "S103", "S104", "S107", "S108", "S109", "S111", "S113", "S115", "S116", "303", "304", "305", "306" myRange.Offset(0, 23).Value = Worksheets("生産量計算シート").Cells(i + 1, 1).Value myRange.Offset(0, 24).Value = Worksheets("生産量計算シート").Cells(i + 1, 4).Value '生産量計算シートのA列（品番）D列（生産数）からL/Pの着工枚数を _ 実績記入シートのY列（品番）Z列（生産数）に上から転記する。 Case "207", "980", "981", "982", "983" myRange.Offset(0, 25).Value = Worksheets("生産量計算シート").Cells(i + 1, 1).Value myRange.Offset(0, 26).Value = Worksheets("生産量計算シート").Cells(i + 1, 4).Value '生産量計算シートのA列（品番）D列（生産数）からR/Fの着工枚数を _ 実績記入シートのAA列（品番）AB列（生産数）に上から転記する。 Case "100", "101", "105", "106" myRange.Offset(0, 27).Value = Worksheets("生産量計算シート").Cells(i + 1, 1).Value myRange.Offset(0, 28).Value = Worksheets("生産量計算シート").Cells(i + 1, 4).Value '空欄の場合 Case " " End Select Next i End Sub
Word 2013 VBAにて、コマンドボタンを押し 「クラスの人数、人数分の各所持金」を入力すると、 「所持金の合計、平均、最大値、最小値」 を出力したいとします。そこで以下のプログラムを組んだのですが、 最小値が出力されません。 (最小値が「1000000000」と表示されます。) 軽い条件としまして、「If」と「ループ」で 解決したいです。 どうすればよいでしょうか？ 回答お願い致します。 ---------------- Private Sub CommandButton1_Click() s = 0 m = 0 b = 1000000000 n = InputBox("クラスの人数を半角で入力してください") For i = 1 To n a = InputBox(i & "人目の所持金を入力してください") s = s + a If m < a Then m = a Else If b > a Then b = a Else End If End If Next h = s / n MsgBox ("このクラスの所持金の合計は「" & s & "円」で、平均は「" & h & "円」です" & Chr(13) & "また、最大値は「" & m & "円」で、最小値は「" & b & "円」です") End Sub
「Visual Basic」についての質問です。 現在、高校での課題研究の授業で、 「Visual Studio 2013」の 「Windows フォーム アプリケーション」を使っています。クイズの問題や選択肢などが入った、CSVファイルを読みだし、 ラジオボタンを使った、 三択問題のソフトを作ろうと頑張っているのですが、 現在の状況で合っているのかがわかりません。 下記のプログラムは、 私が現在行っている、CSVファイルを読み出すプログラムです。 http://www.atmarkit.co.jp/fdotnet/dotnettips/487csvparser/csvparser... 上記のページを参考に、作成しました。 CSVファイルの名前は、”abc”にしています。 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー ' csvparser.vb Imports System Imports Microsoft.VisualBasic.FileIO Class Form1 Shared Sub Main() Using parser As New TextFieldParser("Y:abc.csv") parser.TextFieldType = FieldType.Delimited parser.SetDelimiters(",") ' 区切り文字はコンマ While Not parser.EndOfData Dim row As String() = parser.ReadFields() ' 1行読み込み For Each field As String In row field = field.Replace(vbCrLf, "n") ' 改行をnで表示 field = field.Replace(" ", "_") ' 空白を_で表示 Console.Write(field + vbTab) ' TAB区切りで出力 Next Console.WriteLine() End While End Using End Sub End Class ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー このプログラムが合っているかどうか、 また、読み込んだ内容を出力する方法を教えてください。 VB初心者なので、わかりやすく教えてくださると、助かります。 不明な点等ございましたら、お尋ねください。 よろしくお願いします。
辞めた社員が作成したエクセルVBAを修正しなければいけなくなりました。これまでのエクセルの項目列にはなかった年齢列を設けて、また、これまで存在しなかったとある転職サイト（エン転職）さんのCSVファイルを新たに取り込むことになりました。 これまで他の転職サイト（マイナビ）さんのCSVファイルのVBAを修正して取り込もうと思ったのですが、うまく取り込めません。 ■取り込みたいCSVファイルの列 （A列～Z列まであり、取り込みたい列は以下の5列です。 O:氏名○, P:氏名○ ,Q: R:年齢 ○ ,Y:携帯電話番号○, Z:Mail○ 以下は実際のCSVデータの列です（☓は取り込まず、○を取り込みます） A:☓ B:☓ C:☓ D:☓ E:☓ F:☓ G:☓ H:☓ I:☓ J:☓ K:☓ L:☓ M:☓ N:☓ O:氏名○ P:氏名○ Q: R:年齢 ○ S:☓ T:☓ U:☓ V:☓ W:☓ X:☓ Y:携帯電話番号○ Z:Mail○ ■元となるエクセルの列 A：項 B:状況 C:雇用形態 D:勤務地 E:応募媒体 F:応募詳細 G:氏名 H:かな I:年齢 J:電話番号 K:Mail L:入力日 という具合です。 エクセル側のVBで【E列:の応募媒体】、【L列:入力日】,【G列：氏名】、【H列:かな】の項目だけはなんとか修正できました。 ■【J列：電話】は、電話番号の左３文字目までを””にて文字列として扱うようにしたのですが、どうしても１文字目の０が省かれてしまいます、 ■I列に取り込みたい年齢 、K列に取り込みたいmailの２項目を色々と修正をしてみたのですが、どうしてもうまく取り込めません。 どなたか、修正箇所をお教え頂けませんでしょうか？ Sub entensyoku() On Error GoTo ErrorTrap Application.ScreenUpdating = False Application.DisplayAlerts = False Dim Ret As Long Ret = SetCurrentDirectory("\\D\2014年度") fret = "\\D\2016年度\" ChDir fret Filename = ThisWorkbook.Name Maxrow = Range("G65536").End(xlUp).Row + 1 filetoOpen = Application.GetOpenFilename("CSV（カンマ区切り）,*.csv") If (filetoOpen <> "") Then Workbooks.OpenText Filename:=filetoOpen Filename2 = Dir(filetoOpen) Dim LastRow As Long LastRow = Range("A2").End(xlDown).Row Range("A:C").Select Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove Range("I2:J2").Select Range(Selection, Selection.End(xlDown)).Select Selection.Phonetics.CharacterType = xlHiragana Range("A2:A" & LastRow).Value = "=RC[15]" Range("B2:B" & LastRow).Value = "=PHONETIC(RC[15])" Range("C2:C" & LastRow).Value = "=IF(OR(LEFT(RC[25],3)=""090"",LEFT(RC[25],3)=""080"",LEFT(RC[25],3)=""070""),RC[25],IF(RC[25]="""",RC[25],RC[25]))" Range("A2:C" & LastRow).Select Selection.Copy Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Application.CutCopyMode = False Columns("D:P").Delete Shift:=xlToLeft Range("A2:D" & LastRow).Copy Workbooks(Filename).Activate Range("G" & Maxrow).Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Range("E" & Maxrow & ": E" & Maxrow + LastRow - 2).Value = "06.エン転職" Range("L" & Maxrow & ": L" & Maxrow + LastRow - 2).Value = Date Application.Goto Range("A" & Maxrow), True Workbooks(Filename2).Close Else Application.DisplayAlerts = True Application.ScreenUpdating = True Exit Sub End If Exit Sub ErrorTrap: MsgBox "cancel", vbOKOnly, "採用管理表" Application.DisplayAlerts = True Application.ScreenUpdating = True End Sub
エクセルのVBAについて質問です。 シートに記載されている全角カタカナデータを全て半角カタカナに変換したいと思います。 セルA6からZZ末尾までを半角カナにするためのVBA記述をお教え下さい。 よろしくお願いします。
VBAに関する質問です。当方、プログラミングは初心者ですが、よろしくお願いいたします。 内容としては、フィルターでできるレベルですが、VBAでの回答を希望します。VBAで条件をすべて満たす行を抽出して、別のシート（シートよりはユーザーフォーム）に表示させたいです。 具体的には、ツイートのデータベースから条件を指定し（項目は、id、name、nickname、date、tweetとなっており、今後20項目まで増える可能性があります。）、それらに該当する行を抽出し、該当するデータを表示させたいです（ユーザーフォームに表示できたら最高です）。その際、１データにつき１シートor画面（100人該当なら100シート)で、結果を出したいです。 イメージとしては、 入力フォーム id、name、 nickname、 date、 tweet aaa 2016/0719 イチロー 野球 3000本 上記を満たす行をデータベースより抽出したいです。（tweet欄はイチロー 野球 3000本という単語がすべて含まれるツイートを探したいという意味です。） 結果出力のイメージとしては、 入力条件 id、name、 nickname、 date、 tweet aaa 2016/0719 イチロー 野球 3000本 出力結果 id、name、nickname、date、 tweet 34 aaa abcd 2016/0719 本日、野球選手のイチローが3000本達成！ 1560 aaa hijk 2016/0719 野球選手のイチローが3000本達成した模様 上記結果を各行ごとに別のシート（別のウィンドウ）に表示させたいです（この場合では２ウィンドウ）。 現在の進捗状況といたしましては、 シート１ データベース シート２ 入力条件 として、シート２に検索したい単語を入力し、別のシートに表示させるという段階までなんとかいけました（非常にアナログです笑）。 上のほうで述べた仕様には程遠いため、質問を投稿しております。 大きな課題点としては、 ①現段階では、条件検索の指定した単語を含むツイートがある行を抽出することはできるが、ほかの条件も同時に満たす検索をできない。（idやdate、nameなども同時に指定したい。） ②仮に結果が100件あったとして、それがすべてシート３に表示される。 （100件あるなら、100シートにそれぞれ表示させたい ③シート２に条件を入力し、実行することで結果を得ているが、シートではなくユーザーフォーム画面に入力し、結果もそのような画面で得たい。（そもそもこれは可能なのでしょうか？） 非常に長くなりましたが、以上、よろしくお願いいたします。 （わかる部分だけでもご回答いただければ幸いです。） 以下に、現段階でのコードを示します。 -------------------------------------------------------------------------------------------------------- Const SHEET1 As String = "sheet1" 'ツイートDB Const SHEET2 As String = "sheet2" '条件シート Const SHEET3 As String = "sheet3" '結果シート Const COL_TW As Integer = 5 'ツイートのある列 Const INT_EM As Integer = 5 '条件項目列数 Sub tweet() Dim Endrow As Long Dim Editrow As Long Dim EmName As String Dim ws As Worksheet EndrowTw = Worksheets(SHEET1).Cells(Rows.Count, COL_TW).End(xlUp).Row Editrow = 1 For m = 1 To INT_EM EmName = Worksheets(SHEET2).Cells(1, m).Value endrowEm = Worksheets(SHEET2).Cells(Rows.Count, m).End(xlUp).Row For Each ws In Worksheets If ws.Name = EmName Then Application.DisplayAlerts = False Worksheets(EmName).Delete Application.DisplayAlerts = True End If Next ws Set ws = Worksheets.Add() ws.Name = EmName For i = 2 To EndrowTw For k = 2 To endrowEm If InStr(StrConv(Worksheets(SHEET1).Cells(i, COL_TW).Value, vbWide), StrConv(Worksheets(SHEET2).Cells(k, m).Value, vbWide)) Then Worksheets(SHEET1).Select Worksheets(SHEET1).Rows(i).Select Worksheets(EmName).Rows(Editrow).Value = Selection.Value Editrow = Editrow + 1 Exit For End If Next k Next i Editrow = 1 Next m End Sub
Excelのセルの値をシート名にするマクロ Excel2013使用です。 結合したセルRange("E4:U4")に入っている名前をシート名にしたいです。ActiveSheet.name=Range("E4:U4").Value にしたのですが、うまく行きません。 40枚近くあるシートのE4:U4（結合されている）に入っている文字をそれぞれのシート名にするにはどのようにすればよいでしょうか？ ご教示の程よろしくお願い致します。
エクセルVBAです。 WebBrowser1コントロールが消えてしまいます。 Userform1上にMultiPage1を配置しました。MultiPage1上のPage1にWebBrowser1を配置しました。 MultiPage1上のPage2には何もありません。 これが全てのフォーム、コントロールです。 マクロを実行します。 Page1とPage2をクリックしてページを切り替えます。 最初はPage1上のWebBrowser1は表示されるのですが、 Page2に切り替えてから、Page1に戻ってくると WebBrowser1がきえてしまっています。 WebBrowser1が消えないようにするには、 どうすればいいですか。
エクセルでテキストボックスに挿入した画像を変更するマクロを作りたいです。 Excel2013で作成し、できれば古いバージョンでも使用してもらえるようにしたいです。使用する状況としては、私が作成して別の作業者が別のPCで開きます。 【最初の状態】 １、テキストボックス作成→書式→図の塗りつぶし→図→ファイルを選んで図を挿入（ファイル「A.jpg」とする） ２、図形の書式設定で、透明度、トリミング（画像の位置、トリミング位置）を変更 以上の手順で画像を挿入してある。 【やりたいこと】 １、図形の書式設定で、図の挿入元のファイルボタンをクリックし、「図の挿入」を開く ２、任意のファイルを選んでもらう ３、図形の書式設定を引き継いだまま画像だけさし変わる ↓ という手順を作業者には “ボタンを押す→画像を選択する”、という２ステップで済むようにします。 【補足】 ・作業者が選ぶファイルをB.jpgとすると、下記の図のようになります。 ・最初にA.jpgを挿入しているのはガイドにするためなのですが、 何もない状態からテキストボックスにB.jpgを挿入して 図形の書式設定を反映、挿入する場所もこちらで指定した位置（A.jpgが入っていた位置）に 挿入できればその方法でも大丈夫です。 ただしその場合も、“ボタンを押す→ファイルを選んでもらう” の2ステップのみにしたいです。 ・B.jpgのファイル名は作業者によりバラバラですが、 ファイル名を指定のものにリネームしてもらうことで“ボタンを押す”の1ステップでできるなら その方法でも大丈夫です。 マクロは初心者で、いろいろ調べたのですがわからずお力お借りしたいです。 ２ステップで難しければほかの方法があるのか教えていただきたいです。 ちなみにテキストボックスに挿入しているのは、半透明にしてセルの罫線を重ねて使用するためです。 よろしくお願いします。
エクセルのVBAプログラム 添付画像のようなデータがあり、 例えば 東京×夏 というの場合 すべてとてもよいならば◎、とてもよい、もしくは 1つでもよいがあれば●、というように別シートに集計したいです。 参考データは実際10000個ぐらいあり、それをクロス集計？のようにまとめたいです よろしくお願いします
ExcelのVBAについて質問があります。 私は今、入力フォームを作り、その中で、VBAにて経過時間を計算するマクロを作成したいと思っています。 動作としては、開始時間(例:2016/08/01 08:00:00)をtext box1に手入力し、終了時間はコマンドボタン①を押し、now関数を使い、text box2に入力します。 そして、コマンドボタン②を押すとtext box2-text box1の計算結果がtext box3に出力されるというものです。 今現在以下のように作成しましたが、開始時間と終了時間の差が24時間以上だった場合24:00以上の数字が表示されません。 例として25時間の差だった場合、1:00と表示されてしまいます。 24:00以上の差を正しく表示させるにはどこを直せばよいでしょうか？ Private Sub CommandButton1_Click() TextBox2.Text = Now() End Sub Private Sub CommandButton2_Click() Dim T1 As Date, T2 As Date, T3 As Date T1 = TimeValue(TextBox1.Text) T2 = TimeValue(TextBox2.Text) T3 = T2 - T1 TextBox3.Text = Format(T3, "hh:nn") End Sub
マクロ_入力フォーム_入力文字を含む行削除 エクセル2010を利用しております。 下記のマクロを組みたいです。 何卒教えてください。 SheetA・SheetBのシートがあり シートBには住所録があります。 SheetAにコマンドボタン「起動」を押すと 入力フォームが起動し TEXTBOX1～20それぞれ に検索したい文字を入力します。 入力が終わりましたら 入力フォーム内にある「開始」ボタンを クリック マクロが動き始め SheetBのA列内にTEXTBOX1～20に 入力した文字列を含む行は削除します。 ※TEXTBOXはすべて入力せず 1～5のみ入力するときもあれば1のみ入力する 場合があります。
VBAのコードついて質問します ×ボタンをクリックすると、このフォームを閉じて、新しいフォームを開く事が出来るコード作りました。Cancel = ｔrue/False（フォームを開閉）と勉強しました。（認識不足ですみません） Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer) If CloseMode = 0 Then Cancel = False UserForm3.Show End If End Sub これを実行すると、新しいフォームは開く事が出来ました。 しかし、古いフォームはそのままで、閉じることができませんでした。 どうしたら、うまく実行が出来るようになりますか
VBAでシートを警告のポップアップ無しで削除したいです。下記コードで試してもならないのですが 何がいけないのでしょうか。Private Sub CommandButton2_Click() Dim xWsheet As Worksheet Dim xFlag As Boolean For Each xWsheet In Worksheets If xWsheet.Name = "結果" Then xFlag = True Next xWsheet If xFlag = True Then '該当のシートがある場合の処理 'すべてのセルの内容をすべてクリアする() Cells.Clear '※１ Sheets("s").Cells.Clear '※２ Application.DisplayAlerts = False '確認メッセージを非表示にする Sheets("結果").Delete Application.DisplayAlerts = True '確認メッセージを表示にする Else ' 該当のシートがない場合の処理 ' Sheets("s").Cells.Clear End If End Sub
エクセルを開いた時にどのシートで終了をしても今度開くときは必ずシート１にするにはどうしたらいいですか？
vbaによるテキストの貼り付けについて、お教え下さい。 現状、以下の事は再現できます。1・テキストを1行毎に1セルにコピペ 2・テキスト全部を1セルにコピペ やりたい事は1なのですが、現状時間がかかっています。 Sub テキスト読込() Application.ScreenUpdating = False Dim buf As String, n As Long Open "テキストデータフルパス" For Input As #1 Do Until EOF(1) Application.StatusBar = n & "個目処理中..." Line Input #1, buf n = n + 1 Cells(4 + n, 1) = buf Loop Close #1 Application.StatusBar = False End Sub 例えば、テキストデータを全部選択して、セルに貼り付ければ、 そこから1行毎に分けられたデータで貼り付け出来ます。 この様な事が出来るとしたら、そのコードはどのようになるでしょうか？ 何卒御教示のほどよろしくお願い致します。
エクセルVBA初心者です。 見積りを作っています。 別ﾌﾞｯｸでDBを作っているので、リンク元ﾌﾞｯｸにボタンでリンク先ﾌﾞｯｸを開くために下記にしました。Sub 住設DB() Workbooks.Open "C:¥Users¥tarou-pc¥Desktop¥見積りver2¥設備DB.xlsx" End Sub きちんと開きます。。。 しかしこのリンク元ﾌﾞｯｸとリンク先ﾌﾞｯｸを、別支店の人にメールで送ると、 予想通り、ボタンを押してもリンク先が開きません。。 "C:¥Users¥tarou-pc¥Desktop・・・・がダメからだと思います。 他人に送っても開く方法はどうすれば良いのでしょうか？？ "C:¥Users¥他人のパソコン¥Desktop・・・・という風にイチイチ変更しなければならないのでしょうか？ VBA知らない状態で調べ調べ作っているので、行き詰ってしまいました。 わかりやすい答えをいただければと思います。 よろしくお願いいたします。
VBAが詳しい方に質問です。保護されていて、Open時にパスワードが要求されるブックがあります。 普段、不特定多数のユーザーが開く時にはパスワードが要求され、開けませんが 別ブックで、その保護ブックと紐付けたいブックを開いた時に、その別ブックのOpenイベントで、 保護ブック.Open などで、保護ブックを開きたいのです。 そして、その際にパスワード入力画面が表示されずに開かせたいのですが、方法はありますでしょうか？
エクセル マクロについての質問です。 下記のコードでセルに画像を合わせて貼り付け、表を作成しています。が、このコードだと画像の保存先を移動させると画像が表示されなくなり、分類でフィルターをかけるとバラバラの違う画像が表示されてしまったりして困っています・・・。 どなたか良いご意見を頂ければと思い、投稿しました。よろしくお願いします！ Sub PictFit() Dim PicFile As String Dim Pic As Picture PicFile = Application.GetOpenFilename() '画像のパスを取得 If PicFile = "False" Then Exit Sub Set Pic = ActiveSheet.Pictures.Insert(PicFile) '画像を貼り付ける With Pic .Height = ActiveCell.MergeArea.Height '画像の高さ .Top = ActiveCell.Top '画像の上位置を変更 .Left = ActiveCell.Left + (ActiveCell.MergeArea.Width - .Width) / 2 '画像の横位置を変更(セル幅中央に画像中央) End With End Sub
VBScriptでTSV(タブ区切り)ファイルの上下を反転させるプログラムが書きたいのですが、サンプルコードをお伝えいただける方、お願い申し上げます。
excel VBAのワイルドカードの使い方について教えて下さい。全excelファイルを対象にしたいので （一部を抜粋） myF = Dir(myFLD & "*.xlsx") と「*」を指定しましたがデバッグ画面がでて止まってしまいます。 因みにテストで「*」の代わりに直接1ファイル名を入れると、問題なくマクロが終了します。 従ってマクロ自体は間違っては居ないと思いますが、全体或いは共通部分を盛り込み一部を「*」で指定すると動きません。 「*」の使用法が間違っているのでしょうか。 宜しくお願いします。
VBAでブックが新規生成したら、下記のプログラムで1秒間毎に、プログラムを実行するようにしているのですが、対象ブックのメニューでファイルを開くを実行しようとしたり、セルの編集をしようとするとプログラムが停止していまいます。 プログラムを停止しないようにするには、どうしたらいいでしょうか？ Private Sub Auto_Open() Call 再帰呼出1 End Sub '指定時間待って、処理関数を起動 Sub 再帰呼出1() Application.OnTime Now + TimeValue("00:00:01"), "再帰呼出2" End Sub '処理関数 Sub 再帰呼出2() Call メイン処理 '再帰的な呼び出しを実行 Call 再帰呼出1 End Sub
bat ファイル について質問です現在カメラのSDカードからバッチを立ち上げたら自動で指定のフォルダに写真を移動するようにしてるのですが、保存元のパスがカメラの種類によってかわるので、その都度追加パスを追加しないといけないのですが、＊などでパスをあいまいに指定することはできないでしょうか？ バッチファイルにはあまり詳しくないので、ネットから色々さがして、つなぎあわせた感じになっています。 もしよろしければ、フォルダの保存先も選べるようにもしたいのですが、教えて下さい。 @echo off rem メッセージボックスの表示 set msg="あじさい組のフォルダにカメラのデーターを移動します。よろしいですか？" set title="あじさい組" for /f "usebackq tokens=* delims=" %%A in (`call cscript //Nologo \\192.168.◎.◎\Photo_Now\施設名\クラス別カメラ\写真移動コマンド\msgbox.vbs %msg% "%title%"`) do set ret=%%A if "%ret%"=="0" goto A if "%ret%"=="1" goto B :A REM 保存先フォルダの指定 set outputdir=\\192.168.◎.◎\Photo_Now\施設名\クラス別カメラ\あじさい組 REM %date以降の文字列では2000-01-01（年-月-日）という形式の文字をつくる set outputdir=%outputdir%\%date:~-10,4%-%date:~-5,2%-%date:~-2,2% mkdir %outputdir% REM この三重ループで、IからLまでのドライブにある、 REM 「138_PANA」フォルダにある、 REM 拡張子がjpg、jpeg、cr2のファイルをoutputdirに移動する for %%i in ("E" "F" "G" "H" "I" "J" "K" "L" "M") do ( for %%j in REM ↓が毎回追加しないといけないんです。ここを省略したい ("DCIM\138_PANA" "DCIM\100___03" "DCIM\100___04" "DCIM\100___05" "DCIM\101___04" "DCIM\101___05" "DCIM\101___06" "DCIM\102___05" "DCIM\102___06" "DCIM\102___07" "DCIM\102___08" "DCIM\103___06" "DCIM\103___07" "DCIM\104___08" "DCIM\105___09" "DCIM\201___04" "DCIM\201___05" "DCIM\201___06" "DCIM\201___07" "DCIM\161_FUJI" "DCIM\132_PANA" "DCIM\100NIKON" "DCIM\204___03" "DCIM\204___07" "DCIM\200___03" "DCIM\162_FUJI" ) do ( for %%k in (jpg jpeg cr2) do ( if exist %%i:\\%%j\*.%%k ( move /-Y %%i:\\%%j\*.%%k %outputdir% ) ) ) ) REM 使い終わったので消しておく set searchdir= set outputdir= echo msgbox "あじさい組のフォルダに移動しました。正しく移動されているか確認してください。",vbInfomation,"移動完了" > %TEMP%/msgboxtest.vbs & %TEMP%/msgboxtest.vbs start \\192.168.◎.◎\Photo_Now\施設名\クラス別カメラ\あじさい組 goto end :B exit goto end
エクセルで質問です。 プログラムを入力したのですが画像のようなエラーが発生してしまいました。 この意味は何なのですか？ あと、この状態で実行するとアプリケーションまたはオブジェクト定義のエラーとでるのですがどこが間違っているのかわかりません。 ご教授おねがいします。
vba の send について質問です。 send実行時に９割方成功するのですが、たまにサーバが応答しません、という エラーで止まってしまいます。on error resume nextで無視しても大丈夫な部分なんですが、 エラーが出た場合に再送する方法はないでしょうか？ 試した方法： on error goto で飛ばした先に sleep 1000をかましてsendを実行したのですが結局止まってしまいました。 （あまりsendの部分で時間をかけたくないのでsleepの値は大きくしたくありません） on error goto senderror labelA: msg.send exit sub senderror: sleep 1000 msg.send goto labelA よろしく御願いします。
B列が変更されたらAO列に変更日、AN列に入力日を表示したいマクロなのですがB列のみ変更する場合はきちんと動くのですが範囲貼り付けをしたら変更日を入れたいセルより右側にたくさん今日の日付が入ってしまいます 例えばB1:F10範囲に貼付けしたら AN1:AS10までに日付が入ってしまうのを防ぎたいのです 別のサイトに描いてあった物をそのままマクロにしているので修正できません AO列とAN列のみピンポイントで今日の日付が入るマクロはどこを修正したらよいでしょうか？ どうぞよろしくお願いします Private Sub Worksheet_Change(ByVal Target As Range) If Target.Column <> 2 Then Exit Sub Target.Offset(, 39).Value = Now If Target.Offset(, 38).Value = "" Then Target.Offset(, 38).Value = Now Application.EnableEvents = True End If End Sub という質問をここでしたら 以下の様な回答を頂きました ＞最初のコードでループさせればいいだけでは？ Private Sub Worksheet_Change(ByVal Target As Range) Dim r For Each r In Target If r.Column = 2 Then r.Offset(, 39) = Now If r.Offset(, 38) = 0 Then r.Offset(, 38) = Now End If End If Next End Sub しかしこのマクロではシートの行が10000を超えているので 処理がかなり遅いのです あまりにも遅いので質問前のマクロを使っています そこそこ早い処理で行毎に入力日を入れるマクロ無いでしょうか？ ご教授のほどよろしくお願いいたします
明日提出のプログラミングのデータが飛んでしまい困ってます 得意な方教えていただけませんか？ 私は文系なんですが、履修を 適当にとってしまい、 四年というぎりぎりな立場で 単位取るのに必死です、、、 この紙に書いたものを 作って、あとは式？みたいなのを 作っていかないといけないのですが 先生にやってもらいながら やっていたので全くわかりません！ システム設計得意な方力を貸してください(*T_T*) Visual Basic を使用しています。
EXCEL VBAの質問です。 あるフォルダ内にある最新のファイルを開くためのマクロを調べているのですが、 いい方法が見つかりません。ネットや参考書から下記のマクロを途中まで作成してみたのですが、 その先がわかりません。 Sub Fileopen () Dim myFSO As New FileSystemObject, myFolder As Folder Dim Filelist As Files, myFile As File, Set myFolder = myFSO. GetFolder("C:￥Download￥") Set Filelist = myFolder.Files For Each myFile In Filelit ここからはDateCreatedプロパティを使って、 作成日がフォルダ内のファイルの中で最新だったら そのファイルを開くといった感じの マクロを作成したいと思っております。 VBAも最近勉強を始めたばかりで 上記のマクロが良いのかもわかりません。 もっと簡単な方法がありましたらご教授いただけませんでしょうか？ よろしくお願いいたします。
入力フォームでチェックボックスの使用について お世話になります。 前回は申し訳ございませんでした。シートを一つにして解決致しました。そこで以前に回答していただいた以下の箇所で '状況列が「削除」ではなくデータが入力されている（実際には日付）ときはスキップするように するにはどのようにしたらよいのでしょうか。 よろしくお願い致します。 '状況列が「削除」のときはスキップする If CheckBox1.Value = True And .Offset(, 1).Value = "削除" Then Else Option Explicit '閉じるボタンが押された時の処理 Private Sub CommandButton2_Click() Unload Me End Sub 'フォームの初期化時の処理 Private Sub UserForm_Initialize() ListBox1.ColumnCount = 4 ListBox1.ColumnWidths = "2cm;5cm;2cm;2cm" End Sub '検索ボタンが押された時の処理 Private Sub CommandButton1_Click() Dim st1 As Worksheet Dim Area As Range, FoundCell As Range, FirstAddress As String Dim Item As Variant Set st1 = Worksheets("Sheet1") 'テキストボックスが未入力ならメッセージを表示して処理を終了する If TextBox1.Text = "" Then MsgBox "データを入力してください！" Exit Sub End If 'セルを検索する Set Area = st1.Range("A2:K" & st1.Range("A" & Rows.Count).End(xlUp).Row) Set FoundCell = Area.Find(What:=TextBox1.Text, LookIn:=xlValues) '該当セルが見つからなければメッセージを表示して処理を終了する If FoundCell Is Nothing Then MsgBox "見つかりません" Exit Sub End If 'リストボックスをクリアする ListBox1.Clear FirstAddress = FoundCell.Address Do With FoundCell '検索結果が営業所以外のときはスキップする If .Column = 3 Or .Column = 6 Or .Column = 9 Then ’↓ここを変えたい！ '状況列が「削除」のときはスキップする If CheckBox1.Value = True And .Offset(, 1).Value = "削除" Then Else 'リストボックスに顧客・営業所名・状況・更新日を設定する ListBox1.AddItem st1.Range("B" & .Row).Value ListBox1.List(ListBox1.ListCount - 1, 1) = .Value ListBox1.List(ListBox1.ListCount - 1, 2) = .Offset(, 1).Value ListBox1.List(ListBox1.ListCount - 1, 3) = .Offset(, 2).Value End If End If End With '次のセルを検索する Set FoundCell = Area.FindNext(FoundCell) If FoundCell Is Nothing Then Exit Do Loop While FoundCell.Address <> FirstAddress End Sub
お金をかけずにシステム開発するなら、どんなシステム構成がよいでしょうか。LAMPだと、実行環境はホスティングサービスを利用するとして、ライセンス購入しないといけないものってないですよね？でも、利用するPCの画面解像度により見た目が変わるのが嫌で（デスクトップPCとノートPCなど）、なるべく採用したくないです。そこで、例えば、Windows ApplicationのクライアントとMYSQLサーバとの連携を考えた場合、WIN APP側からDBに対するIDとPASSを送るのは危険だと思うのですが、どういったつくりがよいと思いますか？（※WEB API側にDBに対するIDとPASSを持たせる方法はありそうですが、例えば、ログイン用のユーザIDとPASSをWEB APIの引数として渡し認証したとして、その後のクライアントとサーバとのやり取りはどうなるのでしょう？都度 認証するわけにはいかないと思うので。。。）
VBAのプログラミングついて、困っています。ある観測データがExcelに 0.117 0.114 0.114 0.102 0.102 0.093 0.09 0.09 0.09 ←こんな数値の羅列が100万くらいがB列に並んでいます。 １、このような数値の羅列のあるシートから別のシートにこの観測データのなかで−１＞Xに当てはまる数値の除外かつそのデータを5000毎に分割 ２、そうすると（行×列）5000×100に数値が埋め込まれるはずで、さらにそのなかの偶数行の数値を上下反対にしたいのですが 例えば 0.117 0.117 0.117 0.117 ←これを 0.116 0.116 0.116 0.116 0.115 0.115 0.115 0.115 0.104 0.114 0.114 0.114 0.103 0.113 0.113 0.113 0.117 0.113 0.117 0.113 ←このように偶数列のみ上下逆にしたいです 0.116 0.114 0.116 0.114 0.115 0.115 0.115 0.115 0.104 0.116 0.114 0.116 0.103 0.117 0.113 0.117 やり方がわからず悪戦苦闘しています、よろしくお願いします。
次のバッチファイルで、 終わりから２行目、 ECHO 作業時間 %終了% - %開始% の、引き算の計算をするにはどう書けばいいですか？よろしくお願いします。 ------------------------------------------ rem 作業時間を測定・表示する ECHO OFF SET 開始=%TIME% rem … この間作業 … SET 終了=%TIME% rem 表示 ECHO 開始 %開始% ECHO 終了 %終了% ECHO 作業時間 %終了% - %開始% PAUSE
新しいファイルに名前をつけて保存するときダイアログボックスで最初から選択されている保存先を変えるにはどうすればいいですか？エクセルVBAでやりたいです。だいたい前回保存したフォルダーをパソコンが記憶しているみたいですがこれをVBAで変えたいです。保存は手動でやります。今デフォルトがデスクトップですが試しにデフォルトをデスクトップの１２３というフォルダーに変えられるかどうか下のコードを実行してみましたが変わっていませんでした。どうやればいいでしょうか？ Sub a() ChDir Path:="C:\Users\xxx\Desktop\123" End Sub
Visual Basicについてです。 課題で四則演算の計算プログラムを作っているのですが 足し算以外のソースコードの書き方がわかりません。教えてください。参考に足し算で書いたプログラムを載せます。 Dim nBo1, nBo2, nShi1, nShi2 As Integer Dim nCombo As Integer Dim nComShi As Integer nBo1 = Me.txtBunbo1.Text nBo2 = Me.txtBunbo2.Text nShi1 = Me.txtBunshi1.Text nShi2 = Me.txtBunshi2.Text nCombo = nBo1 * nBo2 nComShi = (nBo1 * nShi2) + (nBo2 * nShi1) Me.txtBunshiKotae.Text = nComShi Me.txtBunboKotae.Text = nCombo Dim nA, nB As Integer Dim nMod As Integer nA = nCombo : nB = nComShi Do Until (nA Mod nB) = 0 nMod = nA Mod nB nA = nB nB = nMod Loop nCombo \= nB nComShi \= nB Dim nSei As Integer nSei = nComShi \ nCombo nComShi = nComShi Mod nCombo Me.txtSuu.Text = nSei If nSei = 0 Then Me.txtSuu.Visible = False Else Me.txtSuu.Visible = True Me.txtBunshiKotae.Text = nComShi Me.txtBunboKotae.Text = nCombo Me.txtBunboKotae.Visible = True Me.txtBunshiKotae.Visible = True Me.Label5.Visible = True If nComShi = 0 Then Me.txtBunboKotae.Visible = False Me.txtBunshiKotae.Visible = False Me.Label5.Visible = False End If
2017年度センター試験、数学ⅡBについて、BASICがなくなるという話を聞いたのですが、詳しくはどうなるのでしょうか？ 調べたのですがはっきりしたものが見当たらなかったので質問しました。 数学Bの教科書から「数値計算とコンピュータ」が消えたので、やはりなくなるのでしょうか？ (VBと十進BASICの違いはわかりますがカテ2はとりあえずVBにしています…)
vbsにて、Excelファイルをドラッグ&ドロップし、ドラッグしたExcelファイルのsheet1のA1セルの値をメモ帳に書き込むことは可能ですか？ 可能でしたら参考となるコード、サイトをご教示願います。よろしくお願いします。
VBAにてご相談です。A列のｾﾙの結合をA5～100まで、2行づつ行いたいのですが、 元々のﾏｸﾛでは、構文が長くなる為、ｼﾝﾌﾟﾙにしたく、 FOR NEXTの構文を作りましたが、上手くいきません。 お手数ですが、知恵をお貸しください。 何卒宜しくお願い致します。 ◆元々の構文 Range("A5:A6").Mergecells = True Range("A7:A8").Mergecells = True Range("A9:A10").Mergecells = True Range("A11:A12").Mergecells = True 省略 Range("A99:A100").Mergecells = True ◆簡略化した構文 Dim i As Long Dim j As Long Dim k As Long i = 2 j = 3 k = 1 For i = 2 To 100 For j = 3 To 100 For k = 1 To 100 Range("A" & i + 2 + k, "A" & j + 2 + k).MergeCells = True Activecell.offset(1,0).select Next k Next j Next i
映画「マトリックス」に出てくる人たちは、どうして射撃があんなに下手くそなのですか?
Excel2010VBAでinsert→addpictureに変更したいです お知恵をお貸しください ・・・・・ActiveSheet.Pictures.Insert(File_path).Select Selection.ShapeRange.LockAspectRatio = msoTrue ' XshapeN$ = Selection.Name XshapeH# = Selection.ShapeRange.Height XshapeW# = Selection.ShapeRange.Width ・・・・・ 宜しくお願いします。
VBA 別ブックからシートコピーし重複するシートがあれば元シートを削除、 重複がなければそのままシートコピー VBA素人です。いろいろと調べながらトライしてみましたが、わかりませんでした。ご教示ください。以下トライ内容。 ①コピー先ブックのA1セルの文字をブック名に含む別ブック(コピー元)を開き、別ブックの"入力シート"をコピー。 ②"入力シート"をコピー先へ。名前をコピー元"入力シート"のB6セル文字+"入力シート"に変更。 したいのですが、同名のシートがある場合は元シートを削除するようにしてみたところ、 同名シートがない場合に、"実行時エラー9 インデックスが有効範囲にない"というエラー になります。 別ブックからシートコピーし重複するシートがあれば元シートを削除、重複がなければ そのままシートコピーする方法をご教示いただきたく、お願いいたします。 以下、上記エラーが発生する自分なりのVBAです。 Sub テスト() Dim FName As Variant, wb As Workbook, myPath As String, ws As Worksheet, wsname As String myPath = ThisWorkbook.Path FName = myPath & "\" & Dir(myPath & "\*" & ThisWorkbook.Worksheets("sheet1").Range("A1") & "*.*") Set wb = Workbooks.Open(FName) wsname = wb.Sheets("入力シート").Range("B6").Value & "入力シート" Set ws = ThisWorkbook.Worksheets(wsname) On Error Resume Next Application.DisplayAlerts = False ws.Delete Application.DisplayAlerts = True On Error GoTo 0 wb.Sheets("入力シート").Copy after:=ThisWorkbook.Worksheets("sheet1") ThisWorkbook.Worksheets("入力シート").Name = ThisWorkbook.Worksheets("入力シート").Range("B6").Value & "入力シート" End Sub
いつもお世話になっております。ThisWorkBook.Nameが、★スズキ タロウ様test.xlsm ThisWorkBook.Pathが、I:¥テスト です。 このファイルからマクロを実行して、 SaveAsメソッドで、ファイル名をスズキ タロウ様test.xlsmで改めて保存して閉じる。 その後、元々の★スズキ タロウ様test.xlsmを消すということをしたいのですが、下記のマクロで上手くいきません。どこが間違っているのか教えてください。 Sub 保存するマクロ() Dim i As Long Dim fName,strSaveName As String i = InStrRev(ThisWorkBook.name,".") fName = Mid(Left(ThisWorkBook.Name,i-1),2,Len(Left(ThisWorkBook.Name,i-2))) strSaveName = "I:¥テスト¥" & fName & ".xlsm" Application.OnTime EarliestTime := Now + TimeValue("00:00:10"), _ Procedure := "'ファイルを消すマクロ """ & fName & """'" ThisWorkBook.SaveAs strSaveName ThisWorkBook.Close End Sub Sub ファイルを消すマクロ(fdName As String) MsgBox "★" & fdName & ".xlsmを消します。" Kill "I:¥テスト¥" & "★" & fdName & ".xlsm" End Sub 保存するマクロは無事終了するのですが、ファイルを消すマクロのMsgBoxでokを押下したあと、 実行時エラー53 ファイルが見つかりません とエラーになり、Killステーメントが黄色くなります。 ファイルは今さっき操作していたファイルであるため、無いはずないのですが、エラーになってしまい困っています。 よろしくお願いいたします。
関数からVBAに直したいのですが、ご教授ください。＝SUMIF（D6:K40,combobox1,K6:K40) Userformを作成し、comboboxに入れた文字列の7つ隣の数字の和を求めたいです。 よろしくお願いいたします。
vb.netでエクスプローラを起動しダウンロードを開く方法を教えて下さい dos窓でなら cd %USERPROFILE%\downloadsというパスで辿り着けますが、これは使えないようです。 上手く行くパターン ' C:を開く System.Diagnostics.Process.Start("file://c:\") ' マイドキュメントを開く System.Diagnostics.Process.Start("file://" & My.Computer.FileSystem.SpecialDirectories.MyDocuments) 上手く行ってないパターン ' ダウンロードを開く System.Diagnostics.Process.Start("file://%USERPROFILE%\downloads") ' ユーザーのプロファイルを開く System.Diagnostics.Process.Start("file://%USERPROFILE%")
Visual Basicでの定積分のコードを教えていただきたいです。f(x)=x^7を0~1の範囲で台形公式を用いて積分せよ。 という問題です。 Button1をクリックすると計算できるようにしたいです。お願いします。
エクセルVBA で、同じ値のセルの結合を複数列で行うコードを教えてください。 添付画像のように処理したい列が複数あります。（A列、B列、C列・・・） ただし、A列の結合範囲が「A2～A3」なら、「B列もB2～B3」、C列も「C2～C3」・・・にしたいです。 （バージョンはMicrosoft Excel 2010です） よろしくお願いします。
マクロVBAについて質問です。 以下コードを繰り返し処理などでまとめる方法などありましたら教えていただきたく思います。 ファイルダイアログで開いたCSVにはAI列まで値や数字が入力されており そのうち指定列(B、O、Z、AB)の値が入っている最終行までをコピーし 別ブック(マクロが入力されているブック)の指定列に貼り付ける内容となっています。 (※その後も処理がありますが、ここでは省略しています。） よろしくお願いいたします。 ----------------------------------------------- '最終行を格納する変数 Dim LastRowB As Long, LastRowO As Long, LastRowY As Long, LastRowZ As Long, LastRowAB As Long 'ワークシートを格納する変数 Dim wst As Object, ast As Object, Set wst = ThisWorkbook.Worksheets("sheet2") 'ファイルダイアログにて開いたCSV Set ast = ActiveSheet '各最終行を変数に格納 LastRowB = Cells(Rows.Count, "B").End(xlUp).Row LastRowO = Cells(Rows.Count, "O").End(xlUp).Row LastRowZ = Cells(Rows.Count, "Z").End(xlUp).Row LastRowAB = Cells(Rows.Count, "AB").End(xlUp).Row If ast.Range("B2").Value <> "" Then 'セルB2～値の入力されている最終行まで書式を数値にする ast.Range("B2:B" & LastRowB).NumberFormatLocal = "0_ " 'セルB2～値の入力されている最終行までコピーして貼付ける ast.Range("B2:B" & LastRowB).Copy wst.Range("D1") 'セルO2～値の入力されている最終行までコピーして貼付ける ast.Range("O2:O" & LastRowO).Copy wst.Range("L1") 'セルZ2～値の入力されている最終行までコピーして貼付ける ast.Range("Z2:Z" & LastRowZ).Copy wst.Range("E1") 'セルAB～値の入力されている最終行までコピーして貼付ける ast.Range("AB2:AB" & LastRowAB).Copy wst.Range("G1") Else End If End sub
Exel VBAで集計表を作成したいのですが、このコードではワークシート"合計"しか作成されず、三か月合計の売り上げが反映されません。どこを修正すべきでしょうか？Sub 複数シートへの同時入力() Sheets(Array("Sheet1", "Sheet2", "Sheet3")).Select Sheets("Sheet1").Activate Cells.Select Selection.Clear Range("A1").Activate ActiveCell = "今月分の売り上げ" Range("A3").Activate ActiveCell = "商品名" Range("B3").Activate ActiveCell = "単価" Range("C3").Activate ActiveCell = "数量" Range("D3").Activate ActiveCell = "金額" Range("A4").Activate ActiveCell = "コーヒー" Range("A5").Activate ActiveCell = "紅茶" Range("A6").Activate ActiveCell = "ケーキ" Range("A7").Activate ActiveCell = "Aランチ" Range("A8").Activate ActiveCell = "Bランチ" Range("B4").Activate: ActiveCell = 280 Range("B5").Activate: ActiveCell = 300 Range("B6").Activate: ActiveCell = 250 Range("B7").Activate: ActiveCell = 650 Range("B8").Activate: ActiveCell = 600 Range("C4").Activate: ActiveCell = 50 Range("C5").Activate: ActiveCell = 30 Range("C6").Activate: ActiveCell = 40 Range("C7").Activate: ActiveCell = 60 Range("C8").Activate: ActiveCell = 80 Range("D4:D8").Select Selection.Formula = "=B4*C4" Range("D9").Activate ActiveCell.Formula = "=SUM(D4:D8)" Range("A1").Activate Sheets("sheet1").Select End Sub Sub 集計表の作成() Dim mm As Variant, sht_name As Variant For mm = 1 To 3 sht_name = "Sheet" & mm Sheets(sht_name).Select Range("A1") = mm & "月分の売り上げ" Next mm '新しいワークシート追加 Set newWS = Worksheets.Add(before:=Sheets("Sheet1")) newWS.Name = "合計" Range("A1") = "3ヶ月合計の売り上げ" Range("A3") = "商品名" Range("B3") = "単価" Range("C3") = "数量" Range("D3") = "金額" Range("A4") = "コーヒー" Range("A5") = "紅茶" Range("A6") = "ケーキ" Range("A7") = "Aランチ" Range("A8") = "Bランチ" Range("B4") = "280" Range("B5") = "300" Range("B6") = "250" Range("B7") = "650" Range("B8") = "600" Range("C4:C8").Formula = "=SUM(Sheet1:Sheet3!C4)" Range("C4:C8").Formula = "=B4*C4" Range("D9").Formula = "=SUM(D4:D8)" End Sub
エクセルVBAで質問です。 Recordsetのデータを取得するためにプログラムを入力したのですが、何度も画像のメッセージが表示されます。 何が原因なのか教えてください。
エクセルVBAで質問です。 Recordsetのデータを取得するためにプログラムを入力したのですが、何度も画像のメッセージが表示されます。 何が原因なのか教えてください。
Ardinoで開発したものを動かしている時に、USBを通じてセンサーからの電気信号をプログラミング開発環境でなく他のアプリ、例えばVisual BASICのserialPortコントロールで読み取ったり、またはVisualBasicからの出力値をUSBでつながっているArduinoに送ることはできますか？
【至急】 VBA ユーザーフォームのチェックボックスについて 同じセルに表示したいのですが、チェックボックスが複数選択された場合のプロシージャを教えてくださいなお今後希望する講座は複数個選択できるため、選択されたものを、 ／で区切り羅列するらしいです
ExcelVBAについての質問です。関数のグラフを作成するコードを書きたいのですがうまく動作しません。どこを修正すべきでしょうか？Sub 関数の値() Set MyWs = Worksheets("数学関数") MyWs.Select Cells.Clear Set MyRange = Range("A1:E1") With MyRange .Value = Array("X", "X*X", "√X", "sin(X)", "cos(X)") .HorizontalAlignment = xlCenter .Interior.ColorIndex = 35 End With For i = 2 To 33 Cells(i, 1) = (i - 1) / 10 Next i Range("B2:B33") = "=A2 *A2 " Range("C2:C33") = "=sqrt(A2)" Range("D2:D33") = "= sin(A2)" Range("E2:E33") = "=cos(A2) " End Sub Sub グラフ描画() Set MyWs = Worksheets("数学関数") With MyWs.Select.ChartObjects.Delete px = Columns("F").Left + 20 py = .Rows("1").Top + 10 End With Set MyRange = MyWs.Range("A1:E33") Set MyChart = MyWs.ChartObjects.Add(px, py, 300, 200) MyChart.Activate MyChart.Name = "MathGrah" With ActiveChart .ChartType = xlLine .SetSourceData Source:=MyRange, PlotBy:=xlColumns .HasTitle = True .ChartTitle.Characters.Text = "関数のグラフ" .Axes(xlCategory, xlPrimary).HasTitle = False .Axes(xlCategory).TickLabels.Orientation = xlHorizontal End With MyRange.Select MsgBox "描画完了" End Sub Sub グラフ更新1() Set MyWs = Worksheets("数学関数") MyWs.Select Set MyRange = Application.InputBox(prompt:="範囲を選択してください", Type:=8) MyWs.ChartObjects("MatchGraph").Activate ActiveChart.SetSourceData Source:=MyRange, PlotBy:=xlColumns MyRange.Select MsgBox "描画完了" End Sub Private Sub CommandButton1_Click() Set MyWs = Worksheets("数学関数") Call 関数の値 Call グラフ描画 End Sub Private Sub CommandButton2_Click() Call グラフ更新1 End Sub Sub グラフ更新2() Set MyWs = Worksheets("数学関数") MyWs.Select Set MyChart = MyWs.ChartObjects("MatchGraph") With MyWs n = .ComboBox1.ListIndex + 1 Select Case (n) Case 1: Set MyRange = .Range("A1:A33") Case 2: Set MyRange = .Range("B1:B33") Case 1: Set MyRange = .Range("C1:C33") Case 1: Set MyRange = .Range("D1:D33") Case 1: Set MyRange = .Range("E1:E33") End Select MyChart.Activate ActiveChart.SetSourceData Source:=MyRange If .OptionButton1.Value = True Then ActiveChart.ChartType = xlLine Elself.OptionButton2.Value = TrueThen ActiveChart.ChartType = xlColumnClustered End If If .CheckBox1.Value = True Then ActiveChart.HasTitle = True Else ActiveChart.HasTitle = False End If If .CheckBox2.Value = True Then ActiveChart.HasLegend = True Else ActiveChart.HasLegend = False End If End With MyRange.Select MsgBox "描画完了" End Sub Sub Auto_Open() Set MyWs = Worksheets("数学関数") With MyWs.ComboBox1 .Clear For Each r In Range("A1:E1") .AddItem r.Value Next r .ListIndex = 3 End With MyWs.OptionButton1 = True MyWs.CheckBox1 = True MyWs.CheckBox2 = True End Sub Private Sub CommandButton3_Click() Call グラフ更新2 End Sub
アクセス2013に関する質問です。 「詳細検索フォーム」フォームの「詳細画像」と「詳細画像２」の二つのテキストボックスに検索値（ID）を入力して画像を検索するシステムを作っています。画像は下記の式にある「ＱＡ検査画像」フォルダにＩＤを付けて収めています。 二つのテキストボックスの内、片方のテキストボックスが空欄でもエラーが出ないように したいと思い、下記のような式をVBに書き込んだのですが上手く行きません。 ＶＢにクエリのSQL文と同じものを使用したのが間違いでしょうか？ 正しい構文をお教え頂けませんでしょうか？ Private Sub Form_Current() IIf(IsNull([Forms]![詳細検索フォーム]![詳細画像2]),True,Me!詳細画像検索イメージ.Picture = "\\123.456.78.90\MainMenu\QA検査結果記録システム\QA検査画像" & "\" & [Forms]![詳細検索フォーム]![詳細画像ID2] & ".JPG") End Sub
エクセルVBAについて教えてください。 以下のコードは、任意のフォルダのファイル名を取得するコードです。Option Explicit Sub ファイル一覧取得マクロ() Dim f As Object, cnt As Long Dim FF FF = Range("C1").Value With CreateObject("Scripting.FileSystemObject") For Each f In .GetFolder(FF).Files cnt = cnt + 1 Cells(cnt, 1) = f.Name 'Cells(cnt, 2) = f.DateCreated Next f End With End Sub 上記の「 cnt = cnt + 1」の部分で、取得したファイル名を 貼り付ける行を指定しており1行目から開始となっています。 便宜上、開始行を変更できるようにしたいのですが、 方法がわかりません。 たとえば、現状の1行目開始ではなく7行目からデータの 貼り付けを開始したい場合はどのようにコードを書けば よいのでしょうか？
c#のフォームアプリケーションについて C#でフォームアプリケーションを作成しています 右クリックで表示されるコンテキストメニューにスクロールバーを表示したいです 方法を教えてください Visual Studioを使用しています
VB.netのコンボボックスについて コンボボックスの処理で悩んでいるのですが、いい方法はありますでしょうか。 やりたいことは以下の通りです。２つのコンボボックスを用意し、１つはグループ名、１つは名前が入ります。 大元になるデータはcsvファイルから読み取り、グループ名、名前を入れていきます。 [user.csv] グループ名1,名前1,名前2 ~ 名前10 グループ名2,名前1,名前2 ~ 名前10 ※グループ名、名前の数の上限は無し このデータからグループ名をグループコンボボックス、名前を名前コンボボックスに入れていきます。 グループコンボボックスにはcsvから読み込んだすべてのグループ名が表示され、 名前コンボボックスにはそのグループに所属している名前だけを表示させるようにします。 ここの処理のロジックが思いつきません・・・ 今考えているのは、グループの数だけ配列を用意し、グループごとに格納しようかなと思っているのですが、他に良い方法などありますでしょうか。 グループの数だけ配列を用意するのもめんどくさい気がします・・・ 以上、よろしくお願いします。
Visual Studio 2013で使うヘッダーファイルの内容は何でもいいんですか？ わかる人は内容も教えていただけるとありがたいです。
Excel マクロプログラムの内容の一部を変更して頂けませんか。Sub test() Dim r As Range Dim rr As Range Set r = Selection For Each rr In Range("AE1:BH1") rr.Offset(1).Value = WorksheetFunction.CountIf(r, rr.Value) Next Range("AE1:BH2").Sort Key1:=Range("AE2"), Order1:=xlDescending, Header:=xlGuess, _ OrderCustom:=1, MatchCase:=False, Orientation:=xlLeftToRight, SortMethod _ :=xlPinYin, DataOption1:=xlSortNormal End Sub このマクロの内容は、AE1からBH1に入力済みの数字が、任意選択された範囲に、それぞれ何個存在するか数え、その個数を、AE1からBH1の各数字の下（AE2からBH2）に入力し、個数の多い順にAE1:BH2を並び替える内容です。 変えて頂きたい箇所は、選択範囲です。このマクロでは、任意選択で毎回変わりますが、選択範囲を固定したいのです。 その範囲は、H列～N列の範囲で、データが入力された最下行を含めて、上方向に１５行です。 例えば、現在、H列～N列のデータが入力された最下行は、H1080～N1080だとすると、その行も含めて上に１５行ですから、範囲はH1080：N1066となります。 H列～N列最下行から上方向に空白セルは存在しません。 どうぞ、よろしくお願い致します。バージョンは２０１０です。
VBAにて特定ｼｰﾄ②つ（①：価格MAS,②品目MAS）以外のｼｰﾄ数が可変する ｼｰﾄにて有償/無償をRange("E4")にて選択するのですが、選択されていない場合、MsgBoxにて警告の上、ﾏｸﾛを中止。 すべてのｼｰﾄで選択されていたら、可変するｼｰﾄのC/H/I列を ｺﾋﾟﾍﾟしたいです。 ※C/H/I列には数式が含まれている為、ｺﾋﾟー＆値の貼付をしたい ただ、以下のﾏｸﾛだと、ActivesheetしかC/H/I列のｺﾋﾟﾍﾟが実行されず、 上手く、行きません。※保護はすべてのｼｰﾄで実行されます。 Next wsが最後にあるので、そこまで、Forが有効なのではと思うのですが。。 以下が現状の構文となります。 お手数ですが、知恵をお貸しください。 '品目MAS,価格MASｼｰﾄ以外保護解除(有償/無償選択なしならﾏｸﾛ中断） For Each ws In Sheets If ws.Name <> "品目MAS" And ws.Name <> "価格MAS" And ws.Range("E4") = "" Then MsgBox "有償無償を選択してください！！" Exit Sub End If ws.Unprotect 'C/H/I列ｺﾋﾟﾍﾟ For Each col In Array("C", "H", "I") rowMax = Range(col & Rows.Count).End(xlUp).Row With Range(Cells(10, col), Cells(rowMax, col)) On Error GoTo 0 .Copy .PasteSpecial xlPasteValues End With Next col Next ws
エクセルVBA初心者です 教えてください。Sheet１のB2をSheet２のB列にコピーしていきたいのですが B列がなにもない空欄の場合は，1行目に 2行目以降は最終行にとしていきたいのですが、 どうすればいいでしょうか？
VBAで「逆引き」と「正引き」という用語の意味について。VBAを勉強している初心者ですが、VBAで逆引きと正引きという用語の意味を調べたんですが なんだか納得できるような説明がなく意味がわかりませんでした（汗） そこで先輩方に質問です。 この「逆引き」と「正引き」の用語を初心者の私でもわかるように噛み砕いてわかりやすく何かいい例えがあればぜひ説明してください。 たとえばVBAでいうこういう部分が逆引きだよでもいいし、日常生活でたとえばこういう部分も逆引きだよみたいなかんじでどんどん例を出して説明してくださると理解が進みます。 皆様、お手数かけますがどうぞよろしくお願いします。
先ほどのやつを打ち直してみたのですが、インデックスが有効範囲にありませんと表示されてしまいます。どうしたらいいですか？Dim x(100) As Double Dim k As Integer x(0) = 0 x(1) = 0 Debug.Print x(0) k = 0 Do x(k + 2) = 1.999 * x(k + 1) - 0.99905 * x(k) + 0.00098 Debug.Print x(k + 1) k = k + 1 Loop While k < 101
Excel VBA でユーザーフォーム内にテキストボックスを2つ配置しています。 テキストボックス１には、金額を入力し テキストボックス２には、１で入力した金額を元に消費税を出しています。が、両方のボックスにカンマを表示したいのですが、金額のボックス１の方が出来ません。 ボックス１には、今消費税を表示させるために TextBox1.Text = Int(Val(TextBox2.Text) * 0.08) を記述しています。 ボックス２には、 TextBox2.Text = Format(TextBox2.Text, "#,##0") を記述しています。 ボックス１にもカンマを表示させる方法を教えてください。
エクセル関数でご教授ください。C列に文字列を入力したときに、D列にも文字が入る式です↓ D列のコード→VLOOKUP(C13,[★★一覧★★.xlsm]現場一覧!$B$5:$C$70,2,FALSE) C列がまだ何も入力されていない空欄の場合、D列も空白にしたいのですが、そのような式は 関数では無理ですか？ VBAのコードでD列を読み込むとき、まだ入力されていないD列の数式を読んでしまうようで、 エラーになってしまいます。 または、この関数自体をVBAに直した方がよいのでしょうか？
VBA,コードを簡潔にする方法はありますか？下記のコードが12月まであります。 一応、コードはうまくいったのですが、勉強のために簡潔にしたいです。 ご教授お願いいたします。 If ComboBox1 = "4月" Then Range("A1:I100").Select Selection.Copy Workbooks("一覧").Worksheets("現金").Range("AA16").PasteSpecial If ComboBox1 = "5月" Then Range("A1:I100").Select Selection.Copy Workbooks("一覧").Worksheets("現金").Range("BA16").PasteSpecial If ComboBox1 = "6月" Then Range("A1:I100").Select Selection.Copy Workbooks("一覧").Worksheets("現金").Range("CL16").PasteSpecial If ComboBox1 = "7月" Then Range("A1:I100").Select Selection.Copy Workbooks（”一覧").Worksheets("現金").Range("DD16").PasteSpecial end if end if end if end if end sub
エクセルのＶＢＡでのソートの仕方 エクセル2010を使用しています。 1月～12月までの各シートをＶＢＡにて別シートで集計（Ａ列日付、Ｂ列住所、Ｃ列名前、Ｄ列フリガナ、Ｅ列金額)しています。 その集計したデータをＤ列のフリガナを基準にソートしたいのですがうまくいきません。 ご教授ください。 宜しくお願いいたします。
エクセル VBA のプログラムについて質問です。 下記を実現するプログラムを組んでいただければ幸いです。 A列セルの値でB列の語を検索し、一致すればC列にA列と同じ値を入れたいです。例は、名前で行っていますが、 実際はB列で複数語が該当することはないとします。(例:B列に山田太郎がいて、山田と太郎に両方にヒットする) 実際は検索語100、検索対10000件ぐらいあるので、関数などではなくVBAで行いファイルを軽くしたいと考えています。 よろしくお願いします
エクセルのテキストボックスからテキストボックスへエンターキーで動かしたいのですが、方法を教えてください。（テキストボックスに入力してエンターキーを押したら次のテキストボックスへ移動して入力できるようにしたいです） また、調べて Private Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer) End Sub If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then TextBox2.Activate End If End Sub というＶＢＡを書きましたが動きません。 合わせて教えてください
VBAのDo Loopについて質問です。Do Do 処理 Loop while 条件１ Loop while 条件２ （スペースを入れたのですが消されてしまうようで、 ベタっとした書き方になってしまいました。見づらくてすみません） というような内容で、条件１自体を変数にすることは可能でしょうか？ 一回目の条件１は「A=0」で、それが抜けたあと もう一度内側のループに入ったら条件１は「B＝0」としたい場合 変数にできれば、きれいにまとまりそうかなと考えました。 実際 Dim 条件１ as String if ～ then 条件１="A=0" else 条件１="B=0" end if としてみても、型が違うといことでエラーになってしまいます。 何か方法はあるのでしょうか？ それとも、もう別のループとして書くしかないのでしょうか？ よろしくお願いいたします。
下記のフォルダーにPDF形式の図面ファイルを入れてあります。C:\Users\kojin\Desktop\製造工程\図面\123.pdf 等 これら図面をExcelVba にて印刷したいのですが 但しPDFファイルを開かず実行できるのがBestですが 印刷終了後はpdfを閉じるようにしたいと思っております。 どなたかご教授頂ければ助かります。
ＶＢＡで文字に色を付けたいです。 ＡＡＡＡＡＡの文字がＬ列にあったら青に＆太文字。 ＢＢＢＢＢＢの文字がＬ列にあったら緑＆太文字。 ＣＣＣＣＣＣの文字がＬ列にあったら太文字のみ。バラで動かした時は動いた筈ですが、他のマクロに組み込んだら、★マークの所で 「オブジェクト変数または With ブロック変数が設定されていません」のエラーが起きてしまいました。 何がいけないのか、いまいち解らなくてＬ列に確かに「ＡＡＡＡＡＡ」という文字はあるのに・・・ お力添えを頂けると助かります。 Dim cl As Range For Each cl In Range("L2:L301") r = InStr(cl, "ＡＡＡＡＡＡ") ★ここでエラーが起きます。 If r <> 0 Then cl.Characters(r, 4).Font.Color = vbBlue cl.Characters(r, 4).Font.Bold = True End If Next For Each cl In Range("L2:L301") r = InStr(cl, "ＢＢＢＢＢＢ") If r <> 0 Then cl.Characters(r, 4).Font.Color = 32768 cl.Characters(r, 4).Font.Bold = True End If Next For Each cl In Range("L2:L301") r = InStr(cl, "ＣＣＣＣＣＣ") If r <> 0 Then cl.Characters(r, 4).Font.Bold = True End If Next
Excel VBAでの質問です。 全角数字の数字を半角にしたいです。 あと、全角のハイフンも半角にしたいです。▽例 Bの列に ○○県○○市○○町５０－５ と 書いてあるものを ○○県○○市○○町50-5 と 置換したいです。 置換したいのは列にあるものすべてです。 そして、行のケツを決めるのではなく、 それをループさせたいのですが、どうプログラムを書いたらいいかまったくわかりません。 Replace,Do Loop,vbNarrow.strConv等を使うと書いてあるですが どなたか素人の私に簡単に説明していただけないでしょうか？ ※Bの列にある全角数字を半角にし、ループする ということはわかるのですが・・・ よろしくお願いします。
Excel2013にて個人毎に項目Ａ（金額）、Ｂ（金額）、Ｃ（率：パーセント表示）を列Ａに個人名、列Ｂに項目Ａ、Ｂ、Ｃを入力して、１行目に４月から３月までの表を作成し、個人名で特定できる様オートフィルターをかけて複合グラフを作成しています。グラフはＡ、Ｂを主軸、Ｃを第２軸としていますが、Ａ、Ｂの数値に対して、Ｃは余りに小さいため、一旦、３項目を棒グラフにて作成した後、主軸を対数グラフにしてＣの棒グラフが可視できるようにした上でＣの棒グラフを選択し、折れ線グラフに変更して、主軸を元に戻しています。 ざっくり言うとこの手順で複合グラフを作成していますが、個人名に対して３項目楯列にデータが存在するため個人名部分のセルは結合しているいます。そのため通常のフィルターでは思うように機能しないため下記ＵＲＬの裏技を使用してフィルターをかけています。 http://officetanaka.net/excel/function/tips/tips64.htm これをマクロとして １．オートフィルターを設定し、コンボボックスにて個人名を指定してフィルターをかける。 ２．絞り込んだ表を参照範囲として指定して、上記のような複合グラフを作成する。 ３．表をグラフを印刷する。 ４．グラフを削除し、オートフィルターを解除する。 の順に登録し、にわかなＶＢＡの知識で加工しています。 この方法で２人目まえではうまくグラフ表示されるのですが３人目から同じ構文で参照範囲だけ変更したマクロを呼び出しグラフを作成するという手順をとっているにも関わらずうまく複合グラフが作成できません。 ※ＶＢＡ初心者のため、個人毎にフィルターをかけたあと個々に複合グラフを作成するマクロを作って呼び出しています・・・ やっていることに無理があるのか、もっと良い方法があるのか分かり兼ねています。よかったらアドバイスをお願いします。 ちなみにグラフを作成しているVBAの構文を以下の通りです。 Sub グラフの作成01() ' ' グラフの作成01 Macro ' Range("B1:N4").Select ActiveSheet.Shapes.AddChart.Select ActiveChart.ChartType = xlColumnClustered ActiveChart.SetSourceData Source:=Range("'2016'!$B$1:$N$4") ActiveChart.Axes(xlValue).Select ActiveChart.Axes(xlValue).ScaleType = xlLogarithmic ActiveChart.Axes(xlCategory).Select ActiveChart.SeriesCollection(3).Select ActiveChart.SeriesCollection(3).ChartType = xlLineMarkers ActiveChart.Axes(xlCategory).Select ActiveChart.SeriesCollection(3).Select ActiveChart.Axes(xlCategory).Select ActiveChart.Axes(xlCategory).Select ActiveChart.Axes(xlCategory).Select ActiveChart.SeriesCollection(3).Select ActiveChart.SeriesCollection(3).AxisGroup = 2 ActiveChart.Axes(xlValue).Select ActiveChart.Axes(xlValue).ScaleType = xlLinear 'グラフの移動 Dim GName As String GName = Mid(ActiveChart.Name, Len(ActiveSheet.Name) + 2) With ActiveSheet.Shapes(GName) .Left = 100 .Top = 150 .Width = 1000 End With End Sub これが１人目の複合グラフを作成するマクロで２人目以降は参照範囲を変更しています。
エクセルのマクロについて、質問させて下さい。 行いたい処理については、一つ一つクリアにしていったら、こんがらがったしまい 迷走してしまいました。行いたい処理は以下の順で行いた いです。 ①エクセルのデータ上、文字列で”<N/A>”が入ってしまっているので、 シート全体で、置換を行い、空白に置換します。 ⇒この方があとあとフィルタリングする時に都合が良いので・・。 こちらの処理は、まず問題ありませんでした。（うまくいっております） ②項目列が入っているエクセルの表なのですが、フィルタリング処理を行います。 ですが、後々列も追加される可能性がるので、項目列の文字列でフィルタリング をしたいです。（例えば"elem_value"列） この列に対しては、空白行以外（文字列や数値も混在している値なので）でフィルタリング処理を行います。 フィルタリング自体はうまく処理できているとは思っておりますが、どうも指定した文字列列でフィルタリング出来ているかが、怪しいです。 ③上記②にてフィルタリングした値をコピーして、3列隣の行から、値で指定した文字列（例えば"add"）が入っている場合はコピーし、最終列まで行う処理をフィルタリングした全ての行で繰り返し行う処理です。 以上の処理を行いたいです。
Excelのマクロでご教授ください。 コピー・ペーストの繰り返しについてです。 作りたいのは↓こんな感じです。Sub テスト() Sheets("元データ").Select Range("○○:○○").Select Selection.Copy Sheets("集計").Select Range("F4").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=Flase, Transpose:=True End Sub ○○:○○の部分は 月ごとに変わり 31日の月だと 「R6:U36」「R42:U72」「R78:U108」… 30日の月だと 「R6:U35」「R41:U69」「R75:U105」… これが200回くらい繰り返されます。 この指定範囲はエクセルの関数で出しているのでマクロでなくてokです。 最終行までループ処理をしたいのですが、可能でしょうか。 セルに書かれた文字を使ってのループ処理がうまく調べられませんでした。
自身で書いたメモが分かりません！ VBAで、「:=引数」というのは、 オプションの右側につけることが出来るみたいです。この「:=引数」というのは、メソッドの右側に直接つける場合もありますか？
VBAでメソッドの右側にオプションが付く場合があると思いますが、オプションがついても引数がつかない場合はありますか？
現在、Excel VBAを使用して、見積書に下記の機能を取り入れたいのですが、どうやればいいのかわかりません。下記のような表があり、コマンドボタンを押した時に、数量蘭が空白のセルがあった場合、同じ列の単価と金額の文字色が白に変わって、見えなくなる機能を取り入れたいと考えています。 コマンドボタン ←押すと数量蘭が空白のセルと同じ列の単価と金額が白に変わる 数量 / 単価 / 金額 1 / 20 / 20 / 30 / 0 ←文字色が白に変わる 3 / 40 / 120 / 50 / 0 ←文字色が白に変わる やり方がわかる方、教えてください。 よろしくお願いします。
エクセル VBA について質問です If構文で Aでないかつ、Bを含む という条件を定義したいです。 If Cells(i,1).Valte〈〉"A" and Cells(i,1).Value Like "＊" & &quot;B" & "＊" Then Cells(i,1)= "C" と書いたのですがエラーが出てしまいます。 よろしくお願いします
VBAで会員IDから子会員のリストを作成 こんにちわ。 VBA初心者です。多少ですがVB.net経験があり、PHPもやっています。 今回やりたいことは、以下の手順のようなことです。1.別シートの支払い列の値が入力してあるものを抽出 2.その行の会員IDを取得 3.その会員IDの親会員を抽出 4.親会員のIDを取得し、その親会員を抽出 （3.4は繰り返し） 最終的にしたいことは、支払いがある会員の親会員がいなくなるまでの親会員IDのリスト化です。 アドバイスよろしくお願いします。
VBA初心者です。 Aという名前のブックの非表示シートを別ブック（新規に作成するブック）へコピーしそのブックをアクティブにしておきたいのですがどうしたらよろしいのでしょうか。Sub prg4_2_1() 'シートを新規ブックへコピー Worksheets("s").Visible = True Worksheets("s").Copy 'コピーしたシートはアクティブになります。 ActiveSheet.Name = "抽出結果" End Sub Sub prog4_3() ThisWorkbook.Activate Worksheets("s").Activate Worksheets("s").Visible = False End Sub Sub prog5() MsgBox "抽出完了", vbInformation End Sub
VBAで教えてください。下記コードを実行したときにキャンセルボタン（対象フォルダを選択しない）を押したら後続処理が流れないようにしたいのですがどのようにしたらよろしいのでしょうか。エラーになって困っています。 Dim xRng As Range Private Sub CommandButton1_Click() Call Sanple_Main Call prog4_2 Call prog5 Call sample_eb07c_02 UserForm1.Hide End Sub Sub Sanple_Main() Dim cFld As String, xFld As Object With Application.FileDialog(msoFileDialogFolderPicker) .Title = "対象フォルダー選択" If .Show = True Then cFld = .SelectedItems(1) & "\" Else Exit Sub End If End With Application.ScreenUpdating = False With Worksheets.Add(After:=Worksheets("Sheet1")) .Name = "結果" .Visible = False Set xRng = .Cells(1, 1).Resize(, 4) End With xRng.Value = Array("ファイル名", "パス", "ファイル種別", "最終更新日") Set xFld = CreateObject("Scripting.FileSystemObject").GetFolder(cFld) Call Sample_Folder_Proc(xFld) With xRng.CurrentRegion .Columns.AutoFit .Borders.LineStyle = True End With Application.ScreenUpdating = True Sheets("Sheet1").Activate End Sub Sub Sample_Folder_Proc(xFld As Object) Dim xFile As Object, sh As Worksheet, xSubFld As Object For Each xFile In xFld.Files Set xRng = xRng.Offset(1) With xFile xRng.Value = Array(.Name, xFld.Path, .Type, .DateLastModified) End With Next xFile For Each xSubFld In xFld.subfolders Call Sample_Folder_Proc(xSubFld) Next xSubFld End Sub Sub prog4_2() Dim myStart As String, myEnd As String Dim myRow As Long Dim Sh2 As Worksheet, Sh3 As Worksheet Set Sh2 = Worksheets("結果") Set Sh3 = Worksheets("s") myStart = InputBox("日付のはじまりを入力" & vbCrLf & "記入例）2016/01/20"): If myStart = "" Then Exit Sub myEnd = InputBox("日付の終わりを入力" & vbCrLf & "記入例）2016/01/20"): If myEnd = "" Then Exit Sub With Sh2 .Range("A1").AutoFilter Field:=4, Criteria1:= _ ">=" & myStart, Operator:=xlAnd, Criteria2:="<=" & myEnd myRow = .Range("A" & Rows.Count).End(xlUp).Row Sh3.Range("A:E").ClearContents .Range("A1:E" & myRow).Copy Sh3.Range("A1") .Range("A1").AutoFilter End With Worksheets("結果").Activate ActiveSheet.Range("A1").Select End Sub
エクセル マクロで質問です。以前こちらで下記コードをご教授頂き、利用しておりましたが 下記コードの中で"AAA"と"BBB"で有った場合は同じ処理 "CCC"が入力値で良かったのですが、今回処理を分けるよう にと上司に言われました。 AAAとBBBとどちらの場合でもCCCの値を入力していましたが 今後は"AAA"は"AAACCC" BBBは"BBBCCC"と入力値を 変えなけばなりません。 IF文使って試行錯誤していますが全くうまく動きません。 どのような構文を使いすればよろしいでしょうか？ Private Sub data3() f = 1 With Worksheets Set Sh = .Item("データベース") Sh.Cells(1).Resize(, 7).Value = Split("所属,日付,内容,担当,金額,会社名,種別", ",") With .Item("A班").Cells(1).CurrentRegion For Each rng In .Offset(1, 1).Resize(.Rows.Count - 1, .Columns.Count - 1) With rng If .Value Like "*BBB*" Or .Value Like "*CCC*" Then ii = 1 - .Row If .Offset(ii).Value <= Sheets("Sheet2").Cells(5, 2) Then g = 1 - .Column ii = 1 - .Row f = f + 1 .Offset(ii).Copy Sh.Cells(f, 2) .Offset(, g).Copy Sh.Cells(f, 4) End If End If End With Next rng End With End With With Sh.Cells(2).CurrentRegion With .Offset(1).Resize(.Rows.Count - 1) .Columns(3).Value = "AAA" .Columns(5).Value = 28500 End With End With End sub
波動方程式のシュミレーションをするプログラムについて。 現在、エクセルのVBAにて二次元の波動方程式を差分法にて解き、それをグラフで描画して アニメーションで表示したいと考えております。その、差分法で解くプログラムについてですが、下記の二つのURLを参考にして作成しました。 http://www.geocities.jp/supermisosan/secondwaveequation.html file:///C:/Users/user/Downloads/waveequation%20(3).pdf そして、僕が作成したプログラムは下記のプログラムです。 t=0の時の初期値を確認するとしっかり配列uの中に入れられているのですが、 ｔ＝3を超えると全てのuの値が0になってしまい、上手く波の様子を描画できません。 この原因はどこにあるのでしょうか？ よろしくお願いいたします。 プログラム本文 ※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※ 'ｔ＝0での初期条件 領域0～10の4～6のuを50とする。LYとLXはそれぞれ10である。 t1 = 0 For j2 = 1 To LY For j = 1 To LX If (j >= 4 And j <= 6 And j2 >= 4 And j2 <= 6) Then u(t1, j, j2) = 50 Else u(t1, j, j2) = 0 End If Next j Next j2 'ｔ＝1の時の初期条件を決める。波が動かないものとして計算。 'αはc*dt*dt/dx*dxを表す。 また、α < 0.25以下になるように設定。 For j2 = 1 To LY - 1 For j = 1 To LX - 1 u(1, j, j2) = u(0, j, j2) + (α / 2) * (u(0, j + 1, j2) + u(0, j - 1, j2) + u(0, j, j2 + 1) + u(0, j, j2 - 1) - 4 * u(0, j, j2)) Next j Next j2 '境界条件 For j = 0 To LX u(1, j, 0) = u(1, j, LX - 1) = u(1, 0, j) = u(1, LX - 1, j) = 0 Next j '以下残りの計算を行う。iは時間を表す。 For i = 2 To M For j2 = 1 To LY For j = 1 To LX newu(i, j, j2) = α *( u(i - 1, j + 1, j2) - 2 * u(i - 1, j, j2) + u(i - 1, j - 1, j2) + u(i - 1, j, j2 + 1) - 2 * u(i + 1, j, j2) + u(i - 1, j, j2 - 1)) + 2 * u(i - 1, j, j2) - u(i - 2, j, j2) '境界条件 newu(i, j - 1, 0) = newu(i, j - 1, LX - 1) = newu(i, 0, j - 1) = newu(i, LX - 1, j - 1) = 0 Next j Next j2 For j2 = 1 To LY - 1 For j = 1 To LX - 1 u(i + 2, j, j2) = newu(i + 2, j, j2) Next j Next j2 Next i MsgBox "終了しました" End Sub
Private Sub Worksheet_Change(ByVal Target As Range) Worksheets(1).Activate Worksheets(1).Range(Cells(288, 11), Cells(311, 11)).Select End Sub
'開始時を入力 objIE.Document.getElementById("MonthSelect").SelectedIndex = Cells(3, 10) objIE.Document.getElementById("DaySelect").SelectedIndex = Cells(3, 11) objIE.Document.getElementById("HourSelect").Value = "0" objIE.Document.getElementById("MinSelect").Value = "0" 以上のようにVBAを記述して今まで動いていたマクロがデバックとなってしまいました。 ソースを調べても変更が無いようなのですが、こういう場合は何が原因なのでしょうか? お詳しい方がいましたら是非、ご教授ください。 よろしくお願いします。
visual studio codeでRunnerという拡張機能を実装したいのですが、http://nekko1119.hatenablog.com/entry/2015/11/26/040531こちらの方法で設定し、hello world!を出力してみると 'clung' A R } h ܂ O R } h A \ ȃv O ܂ o b ` t @ C Ƃ ĔF Ă ܂ B '071023042743.exe' A R } h ܂ O R } h A \ ȃv O ܂ o b ` t @ C Ƃ ĔF Ă ܂ B c:\Users\ユーザー名\Dropbox\C\071023042743.exe  ܂ ł B のような出力になり、途方に暮れております。解決策をご教授ください。 OSはwindows10です。
ユーザーにファイルを選択させるダイアログボックスを表示させずに、 ファイルを取り込む方法はあるのでしょうか？下記コードを作成したところ、ユーザーからこのように言われてしまいました。 理由は、いちいちファイルを選択するのがわずらわしい。 共有フォルダに、取り込みたいファイルと取り込み先ファイルは存在します。 取り込みたいファイルは毎日共有フォルダへ貼られ、取り込み先ファイルへ書き込み終えたら、 完了フォルダへ移ります。 連休明けまでに仕上げなくてはいけないのですが、 この二日間調べてみてもどうしてもわからなくて、途方にくれています。 どなたか教えて下さい。よろしくお願いいたします。 Sub AssembleBooks() Dim otherBook As Workbook Dim fNames As Variant, fn As Variant Dim mf As String ChDir (ThisWorkbook.Path) fNames = Application.GetOpenFilename( _ FileFilter:="Excelブック(*.xlsx),*.xlsx", MultiSelect:=True) If IsArray(fNames) Then For Each fn In fNames Set otherBook = Workbooks.Open(fn) otherBook.Worksheets(1).Copy _ after:=ThisWorkbook.Worksheets(ThisWorkbook.Worksheets.Count) Application.DisplayAlerts = False mf = Dir(fn) otherBook.SaveAs Filename:= "C:\Users\完了\" & mf Kill fn otherBook.Close savechanges:=False Application.DisplayAlerts = True Next Else MsgBox "キャンセルされました" Exit Sub End If
Excel VBAについて質問です。ActiveSheet.Shapes.SelectAll をした後、シェープが存在する場合は Selection.Placement = xlFreeFloating とし、存在しない場合は、何もしないという処理が書きたいです。 どうやって書けばよろしいでしょうか？
C# Windows Formsアプリケーションで、IMEで入力された読みを取得する場合で、全角スペースが取れません。 こちらを参考に作成し、読み仮名は取得できました。http://www.atmarkit.co.jp/fdotnet/dotnettips/875imeyomi/imeyomi.htm... しかし、全角スペースが無視されるようです。 WndProcプロシージャ内のswitch (m.Msg)の部分かとは思うのですが・・・。 よく分からずに使っているので、どう対処して良いのか分かりませんでした。
インデザインでノンブルを付けたいのにできない。 テキストボックスで特殊文字→マーカーの手順でやりましたがそのページに番号がついただけで全ページにつきません。どうすればいいでしょうか?
Aというファイルの特定シートから右側をすべてを、Bというファイルにコピーするマクロを考えているのですが、以下では上手くいきません。Sub test() Workbooks.Open Filename:="C:\Users\shimizu\Desktop\Aファイル.xls" Dim n As Integer Dim i As Integer n = Worksheets.Count For i = n To Worksheets("特定シート").Index + 1 Step -1 Application.DisplayAlerts = False Worksheets(i).Copy _ After:=Workbooks("Bシート.xls").Sheets(1) Application.DisplayAlerts = True Next End Sub どの様にすればよいか、ご教授ください。 宜しくお願い致します。
vbでtimerとlabelを使って起動したら1分30秒カウントダウンするにはどうしたらいいですか？ HH:mm:ssのように表示したいです
VB.NETでシリアル通信を行うアプリケーションを作りたいのですが、通信相手のスタブとして使えるようなフリーソフトがありましたら教えてください。
エクセルVBAでフォームに設置したボタンを押してラベルとテキストボックスを表示させるものを作りました。Private Sub CommandButton1_Click() Set tLabel = UserForm1.Controls.Add("Forms.Label.1", "Label", True) tLabel.Left = 10 tLabel.Caption = "ラベル" Set tText = UserForm1.Controls.Add("Forms.TextBox.1", "TextBox", True) tText.Left = 50 End Sub これを今度は別なボタンを押してラベルとテキストボックスをフォームから削除したいと考えていますが上手く行きません。 UserForm1.Controls.Removeを試しましたがエラーになってしまいます。 自分なりに色々調べてトライしてみましたが上手く行きませんでした。 どなたか記述方法を教えてください。よろしくお願いします。
ｖｂｓ初心者です プログラムで、同じウィンドウ（タブ？）を一度に たくさん表示したいのですがどうすればいいのでしょうか？
ExcelのVBAで、引数名の無い引数ってありますか？例えば、Addメソッドで、シートの枚数を指定したい場合は、 countって引数名があるものを使って、 -------------------------- Sub シート追加() Worksheets.Add Count:=2 End Sub -------------------------- って値を指定すればいいことはわかります。
ExcelのVBAの質問で、値（定数）という回答をもらったのですが、変数は入らないという意味でしょうか？ 値＝定数って意味ではないですよね？http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1316229960...
ExcelのVBAで、 -------------------------- Sub シート追加() Worksheets.Add Count:=2 End Sub-------------------------- を誤って、 下記のように2を入力し忘れて、=を入力後エンターキーを押した時はすぐに「コンパイルエラー：構文エラー」と出て、引数に数字を入れ忘れてたんだとわかりますが、 -------------------------- Sub シート追加() Worksheets.Add Count:= End Sub -------------------------- もし下記のように誤って入力してしまった場合は、実行時に、 実行時エラー'1004'：'Add'メソッドは失敗しました：'Sheets'オブジェクト と表示されて、実行するまでわかりません。 -------------------------- Sub シート追加() Worksheets.Add Count End Sub -------------------------- 後述の方は、なぜコンパイルエラーではなくて実行時エラーになるのですか？
Vbaにて奇数または偶数の行を消去するプログラムを教えていただいたのですが、下記のIsEvenもしくはIsOddで返した値とMaxRow_Zの和の所がわかりません。MaxRow_Zはここには書いてませんがINtegerで定義してあります。 MaxRow_Z = MaxRow_Z + Application.IsEven(MaxRow_Z) '奇数行を消す場合はこっち 'MaxRow_Z = MaxRow_Z + Application.IsOdd(MaxRow_Z) '偶数行を消す場合はこっち For i = MaxRow_Z To 3 Step -12 Rows(i).Delete Next i
ExcelのVBAのオプションって「：＝」まで含めてオプションですか？例えばAddメソッドに対するCountオプションなら下記のような記述だと思うのですが、 -------------------------- Sub シート追加() Worksheets.Add Count:=2 End Sub -------------------------- こういう場合、 Count部分がオプションで、:=2が引数なのか、 それとも、 Count:=までがオプションで、2だけが引数なのか、 どちらですか？
Visual Studio 2015にてCのプログラムを作成しました。 このプログラムの実行時間を測定したいのですが、どのように操作すればいいでしょうか？time.hをincludeするなどはせず、プログラム自体は書き換えずにVisual Studioでの機能を用いて測定したいのですがそのような機能はあるのでしょうか。
Excec2013VBAのユーザーフォームで、その他コントロールを追加できません。Excel2013(32bit)VBAのユーザーフォームにて（OSはWindows10 64bit）、ツールボックス内の余白で右クリックで「その他のコントロール」、もしくは、VBEメニューのツールから「その他のコントロール」を選択しても、マウスポインタが一瞬ＷＡＩＴ状態になって（0.1秒とか一瞬です）、その後なんの変化もありません。何度クリックしても同じです。新規のExcelブックでも試してみましたが同様です。 設定の問題なのでしょうか？ ご存知の方がいらっしゃいましたら、ご教授いただけると幸いです。 以前同じような質問をされていた方がいました。しかし、回答では、「アドインでアクティブにすればよい」となっていましたが、よくわからず参考になりませんでした。
http://skylinker.blog.fc2.com/blog-entry-50.html これのvbのソースが欲しいです....
Excelの検索について質問です。 会社のパートさんが使う業務報告書をExcelで作ることになったので、 パートさんでも操作しやすいようにActiveXコントロールでコマンドボタンとテキストボックスを使って検索ボタンを作ったのですが、上手く検索されません。 例えば、B列の9番目のセルに「販売日」と入力されている状態で『販売』と検索しても出てきません。 『販売日』と検索するとヒットします。 検索するワードを含むセル(B列のみ)を全て検索するには、 以下コードのどこを直したら良いかお教えいただけませんでしょうか？ 何卒宜しくお願いいたします。 Private Sub CommandButton1_Click() Dim i As Long For i = 2 To Cells(Rows.Count, 2).End(xlUp).Row If TextBox1.Value = Cells(i, 2) Then Cells(i, 2).Select MsgBox Cells(i, 2).Row & "行目にあります" End If Next End Sub
いつもお世話になっております。 やりたいこと。◆右No1～右No31:[TYPE1] ◆右No2～右No32:[TYPE2] の、それそれのタイプでシートコピーを作成して１～３２の順番にシート を並べ替えたいのですが現状だと右No1、右No3、右No5まで動作をして 止まってしまいます。 原因は、いまあるシートの後ろ、後ろにコピーが作成されてしまうためです。 まずは、No1の後ろにNo3、No5と作成していきたいのですがどうすれば 良いのでしょうか？ ご教示願います。 -------------------------------------------------------------------- '現在アクティブなシートの後ろにコピーする Sub 記録シート() Dim TYPE1, TYPE2 Dim sh_name Dim 鋼矢板No 鋼矢板No = 3 For 鋼矢板No = 3 To 34 Step 2 With Worksheets("TYPE1") '奇数No .Copy after:=Worksheets(鋼矢板No) End With sh_name = Worksheets("入力シート").Cells(鋼矢板No, 1).Value ActiveSheet.Name = "右No" & sh_name ActiveSheet.Tab.ColorIndex = 4 ActiveSheet.Range("G5").Value = "右No." & sh_name Next 鋼矢板No = 4 For 鋼矢板No = 4 To 34 Step 2 With Worksheets("TYPE2") '偶数No .Copy after:=Worksheets(鋼矢板No) End With sh_name = Worksheets("入力シート").Cells(鋼矢板No, 1).Value ActiveSheet.Name = "右No" & sh_name ActiveSheet.Range("G5").Value Next 鋼矢板No End Sub -----------------------------------------------------------------
エクセル グラフ マクロエクセルで円グラフを新規作成する際に、二つのデータを比べある特定の片一方のデータがもう片方のデータを上回っていた場合にデータラベルの文字を赤く表示するマクロはありますでしょうか?わかる方いましたら教えていただけると嬉しいです。
excelで決められた合計になる組み合わせを作成するVBAをインターネット上で見つけ、使用していますが、プログラムの変更について教えて下さい。A１：A30 まで数値を入力できるようになっています。A３３に目標値を入れ、組み合わせパターンをB列以降に表示するようになっています。 現状、マクロの編集で 「Const N = 10 ' データの数」の１０の部分を変更し使っていますが、A35のセルでデータを数え（COUNTAにて）その数をNとしたい場合（イメージとしては Const N ＝ A35 としたい）Constは定数なので変数に変更すればいいかと思いますが、どういう風に変更すればいいか初心者なので困っています。 マクロには下記の様になっています。 どうか宜しくお願いします。 Const N = 10 ' データの数 Dim wa(N) As Long Sub knap_main() Dim w As Long, wmax As Long Dim i As Integer, j As Long, k As Integer Dim y1 As Integer, y2 As Integer Dim b As Long y1 = 1 ' A1:Anにデータを入れておく y2 = y1 + 1 ' B列以降が結果 For i = 1 To N wa(i) = Cells(i, y1).Value Next wmax = Cells(33, y1).Value ' A33に目標値を入れておく For j = 1 To 2 ^ N - 1 w = 0 b = 1 For k = 1 To N If j And b Then w = w + wa(k) b = b + b Next If w = wmax Then b = 1 For k = 1 To N If j And b Then Cells(k, y2).Value = wa(k) b = b + b Next y2 = y2 + 1 End If Next End Sub
Track Viewについて教えて
ASP.NET MVCで以下の動作をさせるにはどのようにすればよいのでしょうか？ボタンクリック→サーバ側でボタンクリック時の処理を実行 ASP.NET Webフォームでボタンクリック時に発生するClickイベントのようなものです。
macro初心者です。どなたか修正方法をご教示いただけませんでしょうか？同一フォルダー内にBOOKが100～200あります。 セルの（"M3").Valueで"C:\TEST"フォルダーより"C:\TEST2"へBOOKを 移動させたいです。 ホルダー内のBOOKに対して同一の作業をすることが多いので、 まずmacro2でLOOPするmacroを作成してあります。 そこでmacro1を実行します。（こちらは問題なく動きます。） Macro1で移動のmacroを作ったつもりが、 「コンパイルエラー ユーザー定義方は定義されていません」 とのエラーメッセージが出てしまいます。 いろいろやってみたのですが、上手く変更できないのでどなたかよろしくお願い申し上げます。 ************************************************ Sub macro1() If Range("M3").Value = 201606 Then 'M3値で条件分岐 Dim fso As New FileSystemObject Dim fol, fol2 As String fol = "C:\TEST" ' フォルダの指定 fol2 = "C:\TEST2" ' フォルダの指定 ActiveWorkbook.Close fso.MoveFile fol, fol2 End If End Sub ************************************************ Sub Macro2() Dim fol As String Dim f As String Dim wb As Workbook fol = "C:\TEST" ' フォルダの指定 f = Dir(fol & "\*.xls*") 'フォルダ内の指定拡張子のファイル名取得 Do While f <> "" 'フォルダに～指定拡張子のファイルが～ある限り～♪ Set wb = Workbooks.Open(fol & "\" & f) 'ブックを開く Call macro1 f = Dir() Loop Set wb = Nothing '変数の解放 End Sub ************************************************
vbaを勉強したいです。25枚!! 関数やオブジェクトの基本的な扱い方を勉強したいです。 C言語離れした見た目に少し戸惑っています。 javascriptができます。オブジェクト指向関数型など基本的なことはわかります。なおjavaはできません。 vba版サイ本他いいサイトなどがあれば教えてください。
JavaからＡＳＰ.netへ移行 アプリケーションの老朽化対応をしています。Java7のシステムですが、Javaはメジャーアップデートの度にコストがかかるので、 ASPへの移行を検討してくれとの命題です。 ASPは確かにOSの契約があればパッチは無償提供でランニングは良さそうですが、 それだけで検討して良いか思慮しています。 ASPにするとこんなデメリットが考えられるよ。 という事案があったら教えてください。
visual studio2013のエラーについて leap motionという手の動きを検出できるセンサーを、visual studio2013を使って処理しています。プログラムを実行すると以下のようなエラーが出てきます。 エラー 1 error MSB3073: コマンド "xcopy /Y C:\LeapSDK\lib\x86\Leap.dll C:\Users\Documents\LeapMotionIntroduction2-master\LeapMotionIntroduction2-master\C++\LeapSample05\Debug\ xcopy /Y C:\LeapSDK\lib\x86\msvcp120.dll C:\Users\Documents\LeapMotionIntroduction2-master\LeapMotionIntroduction2-master\C++\LeapSample05\Debug\ xcopy /Y C:\LeapSDK\lib\x86\msvcr120.dll C:\Users\Documents\LeapMotionIntroduction2-master\LeapMotionIntroduction2-master\C++\LeapSample05\Debug\ :VCEnd" はコード 4 で終了しました。 C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\V120\Microsoft.CppCommon.targets 132 5 LeapSample05 このエラーは何が原因で出てくるのでしょうか？ 教えていただきたいです。 プログラムは長いので載せていませんが、動くことが確認されているプログラムですので、 おそらくプログラム以外の設定でミスをしていると思っています。 情報が少なくて申し訳ありませんがよろしくお願い致します。 以下使用環境： Windows7 Leap Motion SDK Windows2.3.1 Cinder0.8.6 Visual Studio Express 2013 for Windows Desktop
ExcelのVBAで入力フォームを作り、『番号、名前、年齢、〒、住所』など各項目を入力して『登録』ボタンを押すことで、データが存在している最も下の行の一つ下の行(＝すなわち空欄)にデータが追加されるようにしたいと思ってます。 その際、オートフィルタでデータの絞り込みをしている状態でも、絞り込んだデータの直下ではなく、全データの中で一番最後の行の一つ下の行にデータが追加されるようにするには、どのように記述すれば良いのでしょうか？ ど素人なので、できればコピペで設定できる状態で教えていただければ幸いです m(_ _)m
エクセルのマクロについて質問です。ex(1),ex(2),・・・と同じテンプレにそれぞれ違った値を"Room"シートから読み取って入力されているシートがたくさんあるとします。これらのうち、例えばC4のセルに値が入ってるシートのみを印刷するボタンを作りたいときは、どのようなマクロを書けばよいですか？説明がわかりづらくてすいません。。
ExcelのIF文について質問です。あるシートの中に製品の規格を入れる欄（セル）があり、規格を満たしていれば○、満たしていなかったら×を、ただし未記入の場合には空欄になるように数式を組みたいです。ただし…の前までは普通に組めるのですが。。。 誰か頭のまわらない私にご教授ください、よろしくお願いいたします。
excel VBA 初心者です。 以下コードでエラーが出てしまうのですが何が悪いのかわかりません。 詳しい方よろしくお願いします。Private Sub worksheet_selectionchange(ByVal target As Range) Dim t_range As Range Dim t_path As String Set t_range = Intersect(target, Range("A3:A7")) If t_range Is Nothing Then Exit Sub If t_range.Count >= 2 Then Exit Sub t_path = "C:\pict\" & Selection.Value & ".JPG" ActiveSheet.Shapes.Range(1).Fill.UserPicture t_path End Sub セルのA3からA7までにJPGの名前がはいっておりセルの選択すると写真の表示がされるはずなのですが…エラー実行時は2147024893です。 よろしくお願いします。
VBA初心者です。フォルダ内のファイル（エクセル、PDF等）名、フルパス、各ファイルの最終更新者を一覧化し、エクセルに落としたいのですが、どのように設定すればよいでしょうか？ 因みに、Windows7です。 宜しくお願いしますm(._.)m
空白の行があれば、記入されている文字を上に詰めるマクロについて。 画像を見て頂けますでしょうか。AからIの二行を結合した行A20からA54まで記入する行があります。 こちらの行への書き込みは、いくつかのactiveXボタンで各行にコードを登録してあります。 空白の行が出てしまうときがあるので、枠の線を(A57まで)くずさずに、上に詰めるマクロを教えて頂けませんでしょうか。(空白は下に移動？する感じ) A20から順に詰めていきたくて、データの並び替えだと順がバラバラになってしまいました。 まったくの初心者です。説明に不備があるかもしれませんがよろしくお願いいたします。
またエクセルマクロで行き詰まってしまい、質問させていただきます。いつもありがとうございます。エクセルファイルを一時保存するとき、ファイル名をお客様の名前の頭に★をつけて保存しています。 (★スズキ タロウ様という感じのファイル名になります。) その後、そのファイルを編集して、完成保存させるとき、★を除いたファイル名にしたく、①と②の方法で試したのですが、なぜか上手くいかないのです。 ①Nameステートメントを使ったもの Sub TestName() ThisWorkBook.Save ThisWorkBook.Close Name "I:¥テスト¥★スズキ タロウ様.xlsm As _ "I:¥テスト¥スズキ タロウ様.xlsm End Sub ①を起動させても、エラーにはならないのですが、SaveとCloseだけが処理され、Nameステートメントが何も作動しないので、★スズキ タロウ様というファイルのままです。ファイル内容はちゃんと上書き保存されています。 ②Killステートメントを使った方法 Sub TestKill() ThisWorkBook.SaveAs "I:¥テスト¥スズキ タロウ様.xlsm" ThisWorkBook.Close Kill "I:¥テスト¥★スズキ タロウ様.xlsm" End Sub ②を起動させても、エラーにはならず、マクロは終わるのですが、テストフォルダには、★スズキ タロウ様のファイルも残ってしまいます(もちろんスズキ タロウ様というファイルも追加で作成されます。) ①でも②でもいいのですが、何がおかしいのかわかりません。 ご教授お願いいたします。
このコードを、VBAで打ったのですが、どこが違うかわかりません 教えてください！Sub ex1() Dim x(k) As Double Dim k As Integer x(0) = x(1) = 0 Debug.Print x(0) k = 0 Dox(k + 2) = (2 - 0.0001) * x(k + 1) - (1 - 0.0001 + 0.0000005) * x(k) + 0.00098 Debug.Print x(k + 1) k = k + 1 Loop While k < 101 End Sub
プログラムに関しての質問です。 今vbaのプログラミングを勉強しています。 ３の付く数字と３の倍数をアホにさせたいのですが、うまくできません。内容もセル上ではなくイミディエイトウィンドウ上の表示でして、これもうまくいきません。 ぜひ教えてください。
Win8[64bit]でVB6ソースコードを見たいのですが 方法を教えて頂きたいと思い質問させて頂きました。当方25歳（入社半年、入社前経験なし）で現在COBOLをメインとした所でシステムエンジニアをしております。 前任者（数十年一人でシステム課をやっていた）がロクに引き継ぎもなしに会社を辞めたため さっぱりわけのわからない状態です。 現在Win7で（開発環境なし）朝8時にタスクスケジューラより実行されているVB6のexeと思われるものがあります。 その中身がどうなっているか知りたいのですが ソースがどれなのか、そもそもWin7/8/10 64bitで確認が行えるのか知りたいです。 昔、WinXPでVB6を開発してたような事は聞きましたが社内にそれが可能なパソコンは存在しないのです。 フリーソフトなどでソースを見て、修正・変更・確認の出来る物はないでしょうか？ ご教授お願い致します。 [存在するファイル類] ・form.frm ・MSSCCPRJ.SCC ・8時.exe ・8時.vbp ・8時.vbw ・Project1.vbw
PHP超初心者です。 PHP始めたばかりの超初心者です。下記のようなプログラムがあり、日付けを取り出すことには何とか成功したのですが、取出した日付けをyy/mm/ddの書式にして、１日付けごとに改行して結果に出したいです。 ◆プログラム◆ foreach($rows as $each_rows) { $page_date_source = $each_rows['page_date']; $trading_day = substr($page_date_source,10,15); echo $trading_day; $i++; ◆実行結果◆ May 31, 2016. *Jun 2, 2016. *Jun 3, 2016. *Jun 6, 2016. *Jun 7, 2016. *Jun 8, 2016. *Jun 9, 2016. *Jun 10, 2016. *Jun 13, 2016.・・・・・ 今日substrを初めて使った超初心者です。 分かりやすく、簡潔な回答をお願いします。m()_ _m
visual basic初心者ですがテキストファイルがよくわかっていません。 電卓プログラムなんですがボタンを押したらテキストファイルに何が押されたかの履歴が出るようにしたいです。プログラムは↓ Public Class Form1 Dim z As Double Dim y As Double Dim x As String Dim ans As Double Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load Me.FormBorderStyle = FormBorderStyle.FixedSingle z = 0 Label1.Text = z y = 0 Label2.Text = "履歴" End Sub Private Sub Button1_Click(sender As Object, e As EventArgs) Handles ボタン0.Click If z = 0 Then z = z + 0 If y = 0 Then Label1.Text = z Else Label1.Text = y & x & z End If Else z = z * 10 + 0 If y = 0 Then Label1.Text = z Else Label1.Text = y & x & z End If End If TextBox1.Text = TextBox1.Text & " 0" Call TextWrite(sender) End Sub Private Sub TextWrite(ByVal sender As Object) Dim strBuf As String = Now.ToString & vbTab & CType(sender, Button).Name & "が押されました" 'Text保存 End Sub End Class プログラムボタン0以降のボタンはボタン0と同じで値だけ違います。
Visual Studio(VB)についての質問です。 「ボタンを押したとき、テキストボックスの文字を、拗音を除いて数える」プログラムを組みたいのですが、うまくいかず困っています。以下は、プログラムの内容です。 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click Dim buf As String, i As Long, cnt As Long Dim t As Integer buf = Textbox1.text For i = 1 To Len(buf) If Mid(buf, i, 1) = "あ" Then cnt = cnt + 1 ★ Next i t = cnt End Sub 最後は、拗音を除いて数えた文字数をtとおきます。 これでは、"あ"しか数えられないと思うのですが、どう変えればよいのか（特に★部分）検討もつきません。文字コードを使うにしても、どう宣言すればよいかもわかりません。 回答をよろしくお願いいたします。
VBAで質問があります。 共有モードでチェックボックスの生成ができません。生成する方法を教えてください。 下記にソースを記載します。Set cbx1 = .CheckBoxes.Add(Left:=Cells(1, 1).Left, _ Top:=Cells(1, 1).Top, _ Height:=Cells(1, 1).Height, _ Width:=Cells(1, 1).Width) cbx1.Text = " " cbx1.Display3DShading = True
VBAに関する質問です。当方、プログラミングは初心者ですが、よろしくお願いいたします。 下記コードについて、１行づつどのような処理が行われているのか教えていただけないでしょうか？よろしくお願いします。 ---------------------------------------------------------------------------------------------------------------------------------- Const SHEET1 As String = "sheet1" 'ツイートDB Const SHEET2 As String = "sheet2" '条件シート Const SHEET3 As String = "sheet3" '結果シート Const COL_TW As Integer = 5 'ツイートのある列 Const INT_EM As Integer = 6 '条件項目列数 Sub tweet() Dim Endrow As Long Dim Editrow As Long Dim EmName As String Dim ws As Worksheet EndrowTw = Worksheets(SHEET1).Cells(Rows.Count, COL_TW).End(xlUp).Row Editrow = 1 For m = 1 To INT_EM EmName = Worksheets(SHEET2).Cells(1, m).Value endrowEm = Worksheets(SHEET2).Cells(Rows.Count, m).End(xlUp).Row For Each ws In Worksheets If ws.Name = EmName Then Application.DisplayAlerts = False Worksheets(EmName).Delete Application.DisplayAlerts = True End If Next ws Set ws = Worksheets.Add() ws.Name = EmName For i = 2 To EndrowTw For k = 2 To endrowEm If InStr(StrConv(Worksheets(SHEET1).Cells(i, COL_TW).Value, vbWide), StrConv(Worksheets(SHEET2).Cells(k, m).Value, vbWide)) Then Worksheets(SHEET1).Select Worksheets(SHEET1).Rows(i).Select Worksheets(EmName).Rows(Editrow).Value = Selection.Value Editrow = Editrow + 1 Exit For End If Next k Next i Editrow = 1 Next m End Sub
Excelのマクロを使って、IEからホームページへ、商品画像を3000件登録したいです。 マクロを教えてください。◆マクロの知識レベル 「マクロの記録」機能を使ってのマクロを使うことができますが、 今回はこの機能だとうまく動作せず困っています。 ◆Excelファイル A列：画像登録用URL ※商品によって1件ずつURLは異なります B列：登録をしたい画像名 ※ランダムな英数字です。 これが3000行あります。 ◆動作内容 ①A1セルにあるURLをコピペし、IEにてURLへアクセス ②ファイルアップロード用の「参照」ボタンをクリックしファイル選択画面が出てくる ③マイピクチャからB1セルにあるファイル名をコピペし検索→ファイルの選択 ④「画像の登録」ボタンをクリック ①～④を3000回繰り返し
EXCELが開けません。 VBAにて、台帳等作成しております。 一度閉じて再度開こうと思ったら、開けなくなってしまいました。 下記のメッセージが出ます。苦労して作ったブックなので、涙が出そうです。。。
ichigojamについてです!初心者で、BASICについて無知なので調べながらやってるんですがLチカのプログラムが全然できませんそれどころか「Run」を使ったプログラムができません何がおかしいのでしょうか? Runを打つといっつもおなじ「undefined line in 70 70 GOTO 10」と出ます どのようにすればいいのか わかりやすくお願いいてします
Androidstudioで開発しています。 excelVBAで、コードの一部をjavaファイル形式で出力するツールを作り、実装の負担軽減を計っています。 そこで質問です。複数ある変数名横のコメント位置を揃えたいのですが、揃いません。 ツールでは Space(コメント開始位置－変数宣言文字数)として スペースを挿入させコメント開始位置が揃うようにしています。 しかし出力したファイルをサクラエディタ等で見ると揃っていますが、Androidstudioで見るとずれてしまいます。原因や解決法をご存じの方がいましたらご教授いただけると幸いです。
EXCEL VBAで複数のワークシートを選択し、ファイル名をセルから引用してPDF形式で保存するプログラムを作成し、PDF形式で保存はできたのですが、そのファイルを開こうとすると下記メッセージが表示され開くことができません。 『ファイル名のドキュメントを開くときにエラーが発生しました：Error[Operating system]:プロセスはファイルにアクセスできません。別のプロセスが使用中です。』 また、EXCELのファイルを閉じて、PDFファイルを開くと下記エラーメッセージが表示されてしまいます。 『ファイル名のドキュメントを開くときにエラーが発生しました：Error[PDF Structure 40]:Invalid file format 注意：ソースのフォーマットはPDFではありません。』 下記にプログラムを記載しております。 どの記述が問題があり、PDFファイルが開けないのか原因が分かりません。 VBAも素人レベルで、ネット上で情報を拾ってプログラミングを組んでおります。 ご教示のほど、何卒よろしくお願いいたします。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Sub PDFファイル保存() ' ' PDFファイル保存 Macro ' 'ワークシート一括選択 Sheets(Array("見積", "明細", "追加見積", "追加見積もり 明細")).Select Sheets("見積").Activate Dim fname As String '名前を付けて保存ダイアログ fname = Application.GetSaveAsFilename( _ Title:="保存先を選べ！" _ , InitialFileName:="" & Range("B10").Text & "様_御見積もり(" & Range("T18").Text & "_" & Range("C18").Text & "KW)" _ , filefilter:="PDF形式だよ,*.pdf,すべてのファイル,*.*") If fname = "False" Then 'キャンセルの場合 Exit Sub Else 'ブックを保存する ActiveWorkbook.SaveAs fileName:=fname End If Sheets("入力フォーム").Select ActiveWindow.SmallScroll Down:=-6 Sheets("入力フォーム").Select Range("A18").Select Sheets("入力フォーム").Select ActiveWindow.SmallScroll Down:=-12 Range("A2").Select End Sub ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ ※エラーメッセージも添付しておきます。
マクロの組み方につきまして マクロを下記の形で組みたいのですが、恥ずかしながら出来かねてましてご教授をお願い致します。2016年7月7日と入力し検索開始ボタンを押しますと、別ユーザーフォームが出て【木】と表示されます。 完成されたファイルのように見えますが、人の誤操作によってはデバックが出ます。 デバックを出ないようにし、各条件にあったエラーメッセージを表示するようにしたいです。 誤操作は以下の3パターンを追加したいです。 1.年数に誤って文字列を入力してしまった場合 2.1900年以前の日付を入力してしまった場合 3.うるう年じゃないのに2月29日を入力してしまった場合 プログラムが成功すれば、デバックではなくそれぞれ指定されたエラーメッセージが1つだけ出てきます。 「文字列」を入力した場合→【年数に数値以外が入力されています】のエラーメッセージが出ます。 「1900年以前」を入力した→【1900年1月1日以前の日付が入力されている為、検索できませんでした】 「2200年2月29日」を入力した→【2200年はうるう年ではない為2月29日の曜日を検索できませんでした】 「2400年2月29日」を入力した場合は正解の【火】とだけ出ます。 下記に現状のを記載致します。 Private Sub UserForm_Activate() 'ユーザーフォームが開いたら１～１２の値を月コンボボックスに加える For i = 1 To 12 月コンボ.AddItem i Next i 月コンボ.Style = fmStyleDropDownList 年テキスト = Year(Now()) End Sub Private Sub 月コンボ_Change() '月コンボボックスの値によって、日コンボボックスに加わる値の内容が変わる 'ここでは31日30日29日の３パターンの表示 日コンボ = "" 日コンボ.Clear 検索開始ボタン.Enabled = False Select Case 月コンボ Case Is = 1, 3, 5, 7, 8, 10, 12 For i = 1 To 31 日コンボ.AddItem i Next i Case Is = 2 For i = 1 To 29 日コンボ.AddItem i Next i Case Else For i = 1 To 30 日コンボ.AddItem i Next i End Select 日コンボ.Style = fmStyleDropDownList If 年テキスト <> "" And 月コンボ <> "" And 日コンボ <> "" Then 検索開始ボタン.Enabled = True End Sub Private Sub 年テキスト_Change() If 年テキスト <> "" And 月コンボ <> "" And 日コンボ <> "" Then 検索開始ボタン.Enabled = True End Sub Private Sub 日コンボ_Change() If 年テキスト <> "" And 月コンボ <> "" And 日コンボ <> "" Then 検索開始ボタン.Enabled = True End Sub Private Sub 検索開始ボタン_Click() ThisWorkbook.Activate With Sheets("操作画面") .Range("B1") = 年テキスト & "/" & 月コンボ & "/" & 日コンボ 検索値 = .Range("B1").Value * 1 - Int(.Range("B1").Value / 7) * 7 If 検索値 = 0 Then 検索値 = 7 曜日 = Mid("日月火水木金土", 検索値, 1) .Range("B1").NumberFormatLocal = "G/標準" .Range("B1") = "" End With 曜日フォーム.答えラベル.Caption = 曜日 曜日フォーム.Show ここから、下記のを追加したくございます。 '年テキストに文字列が入力された場合にメッセージ表示 ' MsgBox "年数に数値以外が入力されています" '数値は入力されたが、1900年1月1日以前の日付が選択された場合 ' MsgBox "1900年1月1日以前の日付が入力されている為、検索できませんでした" '数値は入力されたが、1900年1月1日以降でうるう年以外で2月29日が選択された場合 ' MsgBox 年テキスト.Value & "年はうるう年ではない為2月29日の曜日を検索できませんでした" End Sub マクロをまだまだ勉強不足でして、ここからの組み方を教えて頂けますようお願い申し上げます。 お手数おかけ致しますが、よろしくお願い致します。
Excelのvisual basicでプログラムを作りたいですSR 2種類 1%R 6種類 3% N 16種類 5% のカードゲームを100回ランダムで引いてC1〜c100のセルに書き出したいです。 もしできるのならばこのシミュレーションを100回繰り返したいです
Excelのvisual basicでプログラムを作りたいですSR 2種類 1% R 6種類 3% N 16種類 5% のカードゲームを100回ランダムで引いてC1〜c100のセルに書き出したいです。 もしできるのならばこのシミュレーションを100回繰り返したいです
VBA初心者です。 Excel VBAでリンク切れをチェックしたいです。添付のように、リンク一覧からリンクを調べて、問題なければ「○」を表示し、リンク切れの場合は「×」と表示し、その行を赤色で塗りつぶしをしたいのですが、どんなプログラムを組めばよいですか？ すみませんが、よろしくお願いします。
エクセル マクロの登録でのエラーに関して教えて下さい。 業務上でマクロを使用して処理をしたくマクロの登録を行ったのですが、エラーが発生して上手くいきません。マクロ自体詳しくない為、どこを修正すれば良いのか見当が付かず困っております。詳しい方、修正方法等ご教示頂けないでしょうか？ 【行いたい作業】 ①日付でフィルタが掛けられた売上台帳の内容の、必要な部分をコピー ※A列からAC列までほぼデータが入っていますが、コピーはF列からAA列まで。 ※日付でフィルタを掛けるのは、手作業で行います。外すデータもある為。 ※フィルタを掛ける関係で毎回データの行数が違います。 ※フィルタを掛けた段階では一部、グループ化で見えなくなっている列がある為、 グループ化のボタンを押して列を表示させてから、可視部分のF列からAA列をコピー。 ②他エクセルを開き、コピーした内容を値で貼り付け ③貼り付けした内容のW列とX列の内容を削除 ④元のエクセルに戻り、M列に1を入力し、赤くセルを色付けし、グループのボタンを押す。 【登録したマクロの内容】 Sub Macro1() ' ' Macro1 Macro ' ' Range("N4:N6").Select ActiveWindow.SmallScroll Down:=-189 ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=2 ActiveWindow.SmallScroll Down:=-18 Range("G231").Select Selection.SpecialCells(xlCellTypeVisible).Select ActiveWindow.SmallScroll Down:=-12 Range("F17:AA675").Select ActiveWindow.SmallScroll Down:=12 Selection.Copy Range("A1").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Range("M15").Select ActiveWindow.SmallScroll Down:=-18 Range("R1:S3").Select Windows("台帳.xlsx").Activate End Sub 【エラー表示】 実行時エラー”1004” この操作には、同じサイズの結合セルが必要です。 ※上記マクロの下記部分が黄色くなっております。 『 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False』 ※元のエクセルはセルの結合等はしていません。 ※①の対象部分をコピーした段階でエラー表示が出ています。 どなたか詳しい方お願いします！
C#2015でバックグラウンドで処理をしたいのですが Taskの書き方ってこんな風でいいのでしょうか 画面は立ち上げっぱなしですprivate bool m_flgTask = false; private void Form1_Load(object sender, EventArgs e) { m_flgTask = true; taskNagai(); } private uint Kansu() { //処理 return 10; } private async void taskNagai() { uint uiLv; await Task.Run(() => { while (m_flgTask == true) { //このループはm_flgTask=falseになるまで1日でも1年でもずっと続く Thread.Sleep(10); uiLv = Kansu(); //条件によっては画面に表示 } } ); }
Excel VBAで文字列の２次元配列化（Split）について お世話になってます。 cells(2,1)にハイフンとカンマで繋がった文字列があります。これを、cells(5,1)を基点にして、図のように分割したいと考えています。 VBAで実現させる場合、Split関数で区切り文字を指定して配列化し、Application.Transposeで縦横の入れ替えをした後、要素数をUboundで取得してResizeからの貼り付けでいけるかなと思ったのですが、２つの区切りで考えると上手くいかず困っています。 良い方法があればご教授下さい。よろしくお願いします。
ExcelVBAで教えて下さい VLOOKUP関数の参照範囲を 指定したいです。ABCフォルダ -Aフォルダ ---book１ -Bフォルダ ---book２ と、book1がマスタ登録です book２がVLOOKで参照させたいbookです。 同時にbookを開く方法も試したのですが Dim mypath As String With CreateObject("Scripting.FileSystemObject") mypath = .GetFolder(ThisWorkbook.Path).ParentFolder& & "\..\book1" End With Workbooks.Open Filename:=mypath & "\book2.xlsm" と上記のようThisWorkBookにしているのですが、 先にbook２が開くため更新しますか？とでてしまいます。 ようは、book更新画面がでることなく、進めたいのです。 ２つのやり方を教えていただければ助かります！
Excel VBAについて質問です。シート内のオブジェクト全てについて位置をそのままに別シートにコピーする方法はございませんでしょうか。ご存じの方、よろしくお願い申し上げます。
エクセルマクロについて たくさんのエクセルファイルが、 あるフォルダ内にさらにフォルダがあって・・・（階層的？）という感じに保存されています。 これら１個１個のファイルには複数のシートがあって、 そのシート中にデータ（数値や文字）が入ってます。 シートの左上の方にはタイトルや連番があって その下の方に表があります。 行のキーワードと列のキーワードが交差する部分が欲しいデータです。 ※欲しいデータは5種類ぐらいあるのでキーワードはこちらで任意に変更できるとうれしいです。 １個１個開いてデータを確認するのは大変な量なので マクロで一気に確認する方法はありませんか？ エクセルにデータベースのように保存したいです。 フィールドをファイルのパス、ファイル名、シート名、タイトル、連番、欲しいデータ１～５として 階層フォルダ内の各エクセルの各シート単位でレコードにする感じです。(その２）
エクセルマクロについて たくさんのエクセルファイルが、 あるフォルダ内にさらにフォルダがあって・・・（階層的？）という感じに保存されています。 これら１個１個のファイルには複数のシートがあって、 そのシート中にデータ（数値や文字）が入ってます。 シートの左上の方にはタイトルや連番があって その下の方に表があります。 行のキーワードと列のキーワードが交差する部分が欲しいデータです。 ※欲しいデータは5種類ぐらいあるのでキーワードはこちらで任意に変更できるとうれしいです。 １個１個開いてデータを確認するのは大変な量なので マクロで一気に確認する方法はありませんか？ エクセルにデータベースのように保存したいです。 フィールドをファイルのパス、ファイル名、シート名、タイトル、連番、欲しいデータ１～５として 階層フォルダ内の各エクセルの各シート単位でレコードにする感じです。(その１）
VBScriptでの実装に関して質問です。 ＴＳＶ(タブ区切り)のリストファイル(行数は一致)の横つなぎ連結を簡単に行う方法をサンプル付きで教えていただけないでしょうか。なお、一番左の列はＮｏフィールドとなっており、ここは連結の起点となる最初のリストファイルのものだけを残し、横つなぎしていくファイルのものは削除して連結したいと思っています。 よろしくお願い申し上げます。
VBAを使って下記の処理をしたいと思っています。 1.VBAのファイルと同じフォルダ内のexcelファイルを開く。 （VBAファイルは色々なフォルダに置いて使いまわします。） 2.開いたファイルのA列、C列、D列を削除する。 3.上書き保存して、ファイルを閉じる。 4.フォルダ内のファイル全て1～3の処理を行う。 1.の段階で躓いてしまったため、1の処理だけでも ご教示いただけると助かります。 ちなみに、一気に全部のファイルを開いて、 削除処理をした後に全部閉じる、とかでも全然構いません。 よろしくお願いいたします。
先日のシートのコピーの質問について、追加質問です。 質問は以下のURLをご参照ください。http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1016218295... シートをコピーした時、コピーして出来たシートのA1セルにその日の日付を入力するにはどうしたらいいですか。
エクセルで以下の様なことをしたいです。 シート１（シート名はメイン）のA列にブック内のシート名の一覧を取得したいです。（例） シートが、メイン、原本、１、２、３、４、５とある場合 A２に１ A3に２ A4に３ という感じでシートのある分だけ取得したいです。 シート数は随時増えていきます。
EXCEL VBAでIEを操作しようとしています。ネット銀行の自動ログインを作っています。その中で乱数表を照合して３つのコードを入力させる必要があります。下部にその画面のソースを貼っています。<HEAD>の前の部分です。その後半部に fldGridChallange1="J1" fldGridChallange2="E3" fldGridChallange3="A2" とありますが、このJ1,E3,A2といったコードが毎回変わるので、これを取得したい。 つまりfldGridChallange1~3がそれぞれ何かと取得したいのです。 どうすればよいのでしょう？ APIはもちろん使用可です。 初心者なので恐縮ながらよろしくお願い申し上げます。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><script language="JavaScript"> var fldNumSeverity; var fldShortErrDesc;var fldSessionID;var fldPresStyleSheet;var fldErrorID;var fldLangErrorDesc;var fldNumSeq;var fldImage=new Array();var fldImageRefNo=new Array();var fldStartNum;var fldEndNum;var fldGridChallange1;var fldGridChallange2;var fldGridChallange3;var fldStatus;var fldErrorCode;var fldErrorDesc;var fldUSNSesID;var fldUSNHnwFlag;var fldFlagPrevNext;var fldRegAuthFlag;var fldDtLastLogin;var fldFlgUsnAvail;var fldFlgImageAvail;fldErrorID=""; fldLangErrorDesc=""; fldNumSeq="1"; fldImage[0]=""; fldImageRefNo[0]=""; fldStartNum=""; fldEndNum=""; fldGridChallange1="J1"; fldGridChallange2="E3"; fldGridChallange3="A2"; fldStatus="O"; fldErrorCode="0"; fldErrorDesc="0"; fldUSNSesID=""; fldUSNHnwFlag=""; fldFlagPrevNext=""; fldRegAuthFlag="A"; fldDtLastLogin=""; fldFlgUsnAvail=""; fldFlgImageAvail=""; fldSessionID='rldjekak6MZ3vJPl01'; fldPresStyleSheet='flexcube@_Pres1.css'; </script><html xmlns="http://www.w3.org/1999/xhtml">
VBA初心者です。教えてください。 下記プログラムは抽出したデータを新規のシートに張り付けます。 この張り付けるシートの名前を「結果」としたいのですがどこを変更したらよいかわかりません。Dim xRng As Range Sub Sanple_Main() Dim cFld As String, xFld As Object With Application.FileDialog(msoFileDialogFolderPicker) .Title = "対象フォルダー選択" If .Show = True Then cFld = .SelectedItems(1) & "\" Else Exit Sub End If End With Application.ScreenUpdating = False With Worksheets.Add Set xRng = .Cells(1, 1).Resize(, 4) End With xRng.Value = Array("ファイル名", "パス", "ファイル種別", "最終更新日") Set xFld = CreateObject("Scripting.FileSystemObject").GetFolder(cFld) Call Sample_Folder_Proc(xFld) With xRng.CurrentRegion .Columns.AutoFit .Borders.LineStyle = True End With Application.ScreenUpdating = True End Sub Sub Sample_Folder_Proc(xFld As Object) Dim xFile As Object, xSubFld As Object For Each xFile In xFld.Files Set xRng = xRng.Offset(1) With xFile xRng.Value = Array(.Name, xFld.Path, .Type, .DateLastModified) End With Next xFile For Each xSubFld In xFld.subfolders Call Sample_Folder_Proc(xSubFld) Next xSubFld End Sub よろしくお願いします。
質問です。 自分は、VB2012を使っていて現在ボタンのクリック時に画像が変わりボタンを押したよ憂な感覚のあるものを作りたいと思っているのですが、なかなか調べても出てきません。どなたか作っていただけませんか？
エクセルでF列に住所を入れたらE列に郵便番号を自動で表示させたいのですが、アドインを使用せずマクロで出来ますか
VBAでもう一つ教えてください。 comboboxのリストを他ブックから引用したいのですが、 下記コードだと、 メソッドまたはデータメンバーがみつかりません。 と出てしまいます。どこが違うのでしょうか？ Private Sub Worksheet_Activate() Me.ComboBox1.ListFillRange = "[一覧.xlsm]支払先!B2:B45" End Sub
VBA初心者です。 エクセルマクロで質問なのですが セルに任意の数字（2桁 - 2桁）を2組入力して、その数字を元に連番を作成し、別シートに出力させたいです。例としましては、13 - 22と15 - 43を入力したら、13 - 22から13 - 99まで、桁が上がり14 - 01から同様に15 - 43まで出力したい、ということです。 01 - 01から99 - 99の固定であれば下記で出来ましたが、任意の数字の場合桁上がりで躓いてしまいました…。 ご教授願います。 Sub 採番() Dim lno As Integer Dim lno2 As Integer Dim cnt As Integer cnt = 1 For lno = 1 To 99 For lno2 = 1 To 99 Cells(cnt, 4).Value = Format(lno, "00-") & Format(lno2, "00") cnt = cnt + 1 Next Next End Sub
Excel VBA初心者です。 質問させていただきます。コピーについてなのですが、 Sheet１で range("B5,C5,D5,E5,F5,F7,G5,G7,H5,H6,H7,I5,J5,K5,L5).select range("B8,C8,D8,E8,F8,F10,G8,G10,H8,H9,H10,I8,J8,K8,L8).select ↓行が＋３ずつしているのが後、１３あり それらを コピーで Sheet２に B1＝Sheet１のB5、C1＝Sheet１のC5、D1＝Sheet１のD5・・・とselectしている範囲を１行目に貼付 し、Sheet１のデータをリセットし、 次回入力するときに次は２行目に貼付けする（最終行に貼付をしていく） というふうにしたいのですが、 selectだと少し時間がかかってしまうのと、次回コード修正の際、ややこしくなってしまう恐れがあり 最適でないと感じております。 良い方法はありませんでしょうか？ 説明が下手で申し訳ございませんがどうかよろしくお願いします。
証券会社のホームページにログインする方法で行き詰まっています。 参考のヒントを頂けると助かります。例えばSMBC日興証券にログインする場合のプログラムは下の感じて旨く行きそうですが、最後のボタン（ログインボタン）を手で押せばログインできるところまで完成しました。 Sub 日興ログイン() Dim objIE As ObjectSet objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True objIE.Navigate "https://trade.smbcnikko.co.jp/Logout/B616H0000762/login/ipan_logout..." Do While objIE.Busy = True Or objIE.ReadyState <> 4 DoEvents Loop objIE.document.all.koza1.Value = "●●●"’～～～～～～～～～～～～支店コード objIE.document.all.koza2.Value = "●●●●●"’～～～～～～～～～～～～口座番号 objIE.document.all.passwd.Value = "＊＊＊＊＊＊＊"’～～～～～～～パスワード ここでログインボタンを押す作業のプログラムを入れるとは思いますが、分かりません。 End Sub
エクセルの中での別シートからの文字の抽出＆判定などについて質問です。 子供達にボランティアで使用したいと思い、国語系のドリルを作成したいと考えています。楽しくわかりやすい表示などもあればあわせて教えていただきたいです。 では、さっそく本題に入ります。内容としては、 ①シート1にあるボタン1（新しい問題を表示）をクリックする。シート1のB1（語句の意味）にシート2にあらかじめB1からB100まで記載していた語句の意味の文字をランダムで表示します。 この時あわせて、シート１のC1（語句の用例）にシート2のBセルに隣接するCセル（例えば、B8がランダムで選択された場合、シート2のC8）の内容が抽出表示されます。 ②シート１のセル A1に任意で文字を入力します。（入力方法に何か別の面白いアイデア（図形など）があればそれも知りたいです。） ③ボタン2（判定）をクリックすると、シート１のA1の内容が、シート2のBに隣接するAセル（B1であれば、A1）の内容と一致した場合、シート1のセルに判定結果として〇が表示される。一致しなければ、×と表示される。 この内容のVBAプログラムもしくはマクロを知りたいです。 どこに何を書くのか、いろいろな考え方を知りたいので、教えていただけると助かります。
エクセルマクロの記述[シート複数選択]について 現在、マクロを組んでおりますが 今まで出来ていた処理が、ある日を境に実行不可となってしまい 原因が不明の為、投稿させて頂きました。処理コードは下記の通りです。 Sheets("シート1").Select Sheets("シート2").Select False 上記処理では[シート1]を選択し、追加で[シート2]が選択されると思いますが [シート1]のみ選択されたまま[シート2]が選択されません。 過去、問題なく実行できていた頃のバックアップデータを元に 実行しても同様に[シート2]が選択されずスルーし処理が進んでしまいます。 他処理が何かしらの影響を与えている事も考え 新規にエクセルを作成し上記マクロ2行のみを記載し実行しても同様の結果です。 条件切り分けの為に他PCで実行した場合の結果は 問題なく正常に動作します。 考えられるとしたらエクセル自体の設定を変更してしまった為 このような結果になってしまったと思われますが、そのような事が 起こりうるエクセルのオプションはあるのでしょうか。
vb.net KeyPreview = Trueの使い方 お世話になります。 業務でソフトを作成している過程でキーを押された文字によって処理を振り分ける処理を書いています。あるキーを押された時にformに貼り付けたwebブラウザーにｐｄｆファイルを表示させますと、以後、KeyDownイベントが発生しなくなります。添付しましたソースに不足な点がある事が考えられますがどこに不備があるのかが分かりません。お手数ですがご教示をお願い致します。 以下にソースを貼ります。 Public Class Form1 Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load Me.KeyPreview = True End Sub Private Sub form1_keydown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Me.KeyDown If e.KeyCode = Keys.K Then Me.WebBrowser1.Navigate("C:\TEMP\HOGE.PDF") 'MessageBox.Show("K") End If If e.KeyCode = Keys.J Then MessageBox.Show("J") End If If e.KeyCode = Keys.H Then MessageBox.Show("H") End If If e.KeyCode = Keys.L Then MessageBox.Show("L") End If End Sub End Class
直リンク禁止の画像を一括ダウンロードするには Webに詳しい方、お知恵をお貸しください。１ページに複数の画像を載せたサイトがあり 複数ページの画像を纏めて一括ダウンロードしたいのですが ローカルに作ったプログラムからAPIの「InternetReadBinaryFile」に画像URLを渡すと、 直リンク禁止の403エラーが表示されました。 条件等は以下になります。 ・別セッション内で画像アドレスを開くと、403 Forbidden エラーが表示される ・同一セッション内で画像アドレスを開くとエラーではなく目的画像が表示される ・画像上で右クリックダウンロード可能 ・Chrome機能で一括ダウンロード可能 ・画像アドレスはソースから読取済み ・別サイト(直リンク禁止でない)の画像はAPIの「InternetReadBinaryFile」でダウンロード確認済み Chrome機能ではダウンロード可能なので、 直アドレス以外のダウンロード方法があると思うのですが どういう方向で調べればよいのか詰まってしまいました。 （画像キャッシュ？右クリックの偽装？） ヒントでも頂けると嬉しです。 よろしくお願いいたします。
VBA でSQL Serverに接続するには？クラスモジュールの中で、SQL Serverに接続するコードを作りました。 Private mCon As ADODB.Connection ' Connectionオブジェクトを生成 Public Sub connect() Dim cn As String '+ *** 接続文字列 *** ' サーバのIP/ホスト名とDBインスタンス名は適当に書き換えられたし '"Trusted_connection=yes"はDB認証にWindows認証を使う場合に使用します。 cn = _ "Provider=SQLOLEDB;" & _ "Network Library=DBMSSOCN; " & _ "Trusted_connection=yes; " & _ "Data Source=127.0.0.1,1433; " & _ "Initial Catalog=Payroll;" & _ "Server=PC名\SQLEXPRESS; " Set mCon = New ADODB.Connection mCon.CursorLocation = adUseClient mCon.Open cn End Sub 「"Initial Catalog=Payroll;" & _」を無くせばエラーは発生しません。 しかし、このままですと接続されるデータベースは「master」になってしまいます。 SQL Server側での操作で、「規定のデータベース」を「Payroll」に設定しているのに 「"Initial Catalog=Payroll;" & _」を無くした状態で接続すると 接続されるデータベースは「master」でした。 データベース「Payroll」に接続しようと上記の構文を追加すると 画像ファイルの様なエラーが発生します。 データベース「Payroll」に接続に接続するためには、 どうしたらいいでしょうか。 ご教示願いませんでしょうか。 よろしくお願いします。
aspでPDFを画像に変換したいのですが VBScriptでのImageMagickの使い方がわかりません。ImageMagickをCOM+に登録して使用していますが PDFが複数ページある場合全ページが変換されます。 ページ指定して画像変換できるのでしょうか。 PDF名.pdf[0] を指定してもエラーとなってしまいます。 解決策お願いします。
コイン500枚。 VBAでのWEBクエリのループの設定について質問させて下さい。 あるサイトからリアルタイムで更新されるランキングのデータをWEBクエリで抽出する作業をしています。現時点で作る事が出来た物は下記になります。 セル A (1) (2) (3) (4) B http;//〇〇/p(1) http;//〇〇/p(2) http;//〇〇/p(3) http;//〇〇/p(4) C WEBクエリで読み込んだランキング 1 … +51行 WEBクエリで読み込んだランキング 2 このようにセルAで抽出したいサイトのページ数に当たる数値を算出して、セルBの末尾に入るように設定してあります。 このセルBのURLをセルCに読み込ませるVBAの作り方が分かりません。 マクロの記録で基本となる物は作る事が出来ました。 Sub Macro1() ' ' Macro1 Macro ' '     With ActiveSheet.QueryTables.Add(Connection:= _         "URL;http://info.finance.〇〇◯.co.jp/ranking/?kd=19&tm=d&vl=a&mk=3&p=1", _         Destination:=Range("$C$3"))         .CommandType = 0         .Name = "?kd=19&tm=d&vl=a&mk=3&p=1"         .FieldNames = True         .RowNumbers = False         .FillAdjacentFormulas = False         .PreserveFormatting = True         .RefreshOnFileOpen = False         .BackgroundQuery = True         .RefreshStyle = xlInsertDeleteCells         .SavePassword = False         .SaveData = True         .AdjustColumnWidth = True         .RefreshPeriod = 0         .WebSelectionType = xlAllTables         .WebFormatting = xlWebFormattingNone         .WebPreFormattedTextToColumns = True         .WebConsecutiveDelimitersAsOne = True         .WebSingleBlockTextImport = False         .WebDisableDateRecognition = False         .WebDisableRedirections = False         .Refresh BackgroundQuery:=False     End With End Sub このデータを縦に並べて抽出したいのですが1ページで50項目あり、2つ目以降を読み込む際に51行下、もしくは次の空欄に読み込むというような設定をしないと、上手く読み込む事が出来ないでしょうか？ 似たような質問でこのような物を使用しているのを見かけたのですが、上手く使う事が出来ませんでした。 Dim myQT As QueryTable Dim i As Long Dim myURL As String Cells.Delete For Each myQT In QueryTables: myQT.Delete: Next Range("A1").Select 可能であれば知識に乏しい初心者でも理解出来るようにご教授よろしくお願い致します。
エクセルマクロのデータ作成 関数の=COUNTIFの様な方法でマクロを作成したいのですが、 例えば、 A 1 W1 2 W1 3 W1 4 W2 5 W26 W3とあるときにB列に A B 1 W1 1 2 W1 2 3 W1 3 4 W2 1 5 W2 2 6 W3 1 のような表示をしたいのですがどのようにすれば良いでしょうか？
テキストデータからボタンなどを押すとtextbox1に一行目、textbox2に二行目を抽出したいです。テキストボックスの名前はreadme.txtでプログラムと同じ階層にあるとします。初心者で上手くいかないので教えてください。
Access 2013 VBA について質問です。 「金賞」～「銅賞」 「平成27年」～「平成23年」 といった範囲検索を行いたいです。 Betweenを使いのでしょうか？教えてください。よろしくお願いします。
エクセルの関数でA列を検索して、A列が同じだったらB列の文字を カンマで区切りながらC列に表示する事はどうやっても無理でしょうか？現在マクロを少し勉強中でどうにか自分で できないかと調べてはいますが自分が思っているようなものが見つかりません。 いいアイディアがある方がいたらぜひ教えていただきたいです。 ※イメージのエクセルデータ↓です（分かりにくくなってしまっています、すみません） A B C １ 太郎 100 100,200,300 ２ 太郎 200 100,200,300 ３ 太郎 300 100,200,300 ４ 花子 100 100,200 ５ 花子 200 100,200 ６ 良子 100 100 A1～A3まで太郎 B1に100、B2に200、B3に300となっていおり C1に100,200,300という風に入力したいたいのです ＆で結べばできるのですが、数がたくさんあるためできるだけ簡単な方法を探しています。
エクセルのマクロの作り方を教えて頂きたく。やりたこと(1)： 添付データから１つの車型を入力検索すると・・・ ①各月の台数と仕向国が表示させたい ②暦年で台数と仕向国を表示させたい やりたこと(2)： 添付データから１つのNo.を入力検索すると・・・ ①各月の台数と仕向国が表示させたい ②暦年で台数と仕向国を表示させたい ※フィルター機能のように１つの車型を車型入力検索にてデータを 抽出するところまでは出来ました。 マクロ初心者です。 何卒わかりやすくご教授頂きたく、よろしくお願い申し上げます。
マクロ作成について Sheet2に A B C D E F あ 6:14 6:15 6:16 6:17 6:18 い 6:41 6:42 6:43 6:44のように入力されており Sheet1に A B C あ 6:14 6:14 あ 6:15 6:15 あ 6:16 6:16 あ 6:17 6:17 あ 6:18 6:18 い 6:41 6:41 い 6:42 6:42 い 6:43 6:43 い 6:44 6:44 のようにデータを入力したいのですが 良い方法はありますでしょうか？
実行したいマクロが多いのですが、簡潔に楽に実行できる方法はないでしょうか例えば特定のセル（A1）に既に登録してあるマクロ名（細胞）を入力し、ボタンを押すことで"細胞"マクロ実行することはできますか？実行したいマクロが多く、一つ一つボタンを作ると大変でｺﾞﾁｬｺﾞﾁｬしてしまうため、簡素な方法を探しています。 他に適切な方法があれば教えていただけると幸いです。m(_ _)m
VB6.0で 、アスタリスク（*) の表示についてお教えください。ユーザーが文字をテキストボックスに打ち込んだ時に、 そのまま文字をテキストボックスに表示させるのではなく、 アスタリスク(*)にして表示させる方法を教えていただきたいです。 打ち込んだ文字がそのままアスタリスクとして表示させるのができないという場合は、 打ち込んでフォーカスが変わった直後にアスタリスクに変更されるような処理があれば お教えください。 宜しくお願いします。
VBAで複数の引数を扱う、クラスのメソッドの例が記載してあるアドレスをご存じな方、いらっしゃいませんか？
エクセルのマクロで以下の様なことをしたいです。 エクセルブックに以下の様なシートがあります。メニュー 原本 メニューにあるシートのコピーというボタンを押すと原本シートが原本シートの後ろにコピーされるようにしたいです。 メニュー 原本 20160712（原本シートのコピー） としたいです。
macro初心者です。どなたか修正方法をご教示いただけませんでしょうか？同一フォルダー内にBOOKが100～200あります。 セルの任意の値をBOOK名にして変更保存したいです。 ホルダー内のBOOKに対して同一の作業をすることが多いので、 まずmacro2でLOOPするmacroを作成してあります。（M3値で条件分岐のIfあり） そこでmacro1を実行します。(こちらは問題なく動きます） Macro1は任意のセル値をファイル名にしBOOK名を変更して保存したいのですが 同一のファイル名が複数できてしまうので、ダブり分には連番をふりたいのですが、 うまくいきません。Macro1の方はいくつか方法を考えたのですがこのうちのどれかで構いませんので 修正方法をご教示いただけませんでしょうか？ よろしくお願い申し上げます。 Sub Macro2() Application.DisplayAlerts = False '確認メッセージ省略 Application.ScreenUpdating = False '高速化 Dim fol As String Dim f As String Dim WB As Workbook fol = "C:\TEST" ' フォルダの指定 f = Dir(fol & "\*.xls*") 'フォルダ内の指定拡張子のファイル名取得 Do While f <> "" 'フォルダに～指定拡張子のファイルが～ある限り～♪ Set WB = Workbooks.Open(fol & "\" & f) 'ブックを開く If Range("M3").Value = 201606 Then 'M3値で条件分岐 Call macro1 WB.Close Kill fol & "\" & f '元ファイルを削除 Else WB.Close End If f = Dir() Loop Set WB = Noth ing '変数の解放 End Sub :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: Sub macro1() Dim fileName As String Dim n As Variant Dim WB As Workbook 'ブック Set WB = ActiveWorkbook Dim i As Long i = 2 '枝番初期値 Application.DisplayAlerts = False '確認メッセージ省略 Application.ScreenUpdating = False '高速化 If Range("M1") = "" Then n = "超過" Else n = Range("M1") End If fileName = "【" & Range("M3") & "】" & Range("C3") & "【" & n & "】" 'ファイル名作成 'If MsgBox(fileName & " で保存しますか？", vbYesNo) <> vbYes Then Exit Sub '保存するか確認して保存しない場合は終了 'Application.DisplayAlerts = False '同名のファイルがある場合の警告禁止(必要なら) 'ThisWorkbook.SaveAs "c:\TEST2\" & fileName '指定フォルダに保存 ActiveWorkbook.SaveAs "c:\TEST2\" & fileName '指定フォルダに保存 'Application.DisplayAlerts = True '警告許可(上で警告禁止した場合は警告許可に戻す) On Error Resume Next Do Err.Clear ActiveWorkbook.SaveAs "c:\TEST2\" & fileName & "(" & CStr(i) & ")" i = i + 1 Loop Until Err.Number = 0 On Error GoTo 0 End Sub :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: Sub macro1() Dim fileName As String Dim n As Variant Dim WB As Workbook 'ブック Set WB = ActiveWorkbook Dim i As Long i = 2 '枝番初期値 Application.DisplayAlerts = False '確認メッセージ省略 Application.ScreenUpdating = False '高速化 If Range("M1") = "" Then n = "超過" Else n = Range("M1") End If fileName = "【" & Range("M3") & "】" & Range("C3") & "【" & n & "】" 'ファイル名作成 'If MsgBox(fileName & " で保存しますか？", vbYesNo) <> vbYes Then Exit Sub '保存するか確認して保存しない場合は終了 If Application.DisplayAlerts = False Then ' 同名のファイルがある場合の警告禁止(必要なら) ActiveWorkbook.SaveAs "c:\TEST2\" & fileName & "(" & CStr(i) & ")" '指定フォルダに保存 Else ActiveWorkbook.SaveAs "c:\TEST2\" & fileName End If 'pplication.DisplayAlerts = True '警告許可(上で警告禁止した場合は警告許可に戻す) i = i + 1 End Sub :::::::::::::::::::::::::::::::::::::::::::::::::::::::::: Sub macro1() Dim fileName As String Dim n As Variant Dim WB As Workbook 'ブック Set WB = ActiveWorkbook Dim i As Long i = 2 '枝番初期値 Application.DisplayAlerts = False '確認メッセージ省略 Application.ScreenUpdating = False '高速化 If Range("M1") = "" Then n = "超過" Else n = Range("M1") End If fileName = "【" & Range("M3") & "】" & Range("C3") & "【" & n & "】" 'ファイル名作成 'If MsgBox(fileName & " で保存しますか？", vbYesNo) <> vbYes Then Exit Sub '保存するか確認して保存しない場合は終了 ActiveWorkbook.SaveAs "c:\TEST2\" & fileName If IsError(fileName) Then Else ActiveWorkbook.SaveAs "c:\TEST2\" & fileName & "(" & CStr(i) & ")" '指定フォルダに保存 i = i + 1 End If End Sub
特定の２つのシートの間の全てのシートをPDF化するマクロというのは出来ますか？独学でマクロを弄っていますので、基本が抜けているところがあると思いますがご容赦下さい。 例として以下の様な順番でシートが表示されているとします。 シート１／シート２／表紙／シート３／～ ･･･ ～／シート１０／裏表紙／シート１１ この状態で、「表紙」と「裏表紙」のシートの間に挟まれている全てのシート（表紙・裏表紙も含めて）を一つのPDFにするマクロというのは出来ますか？ シート名は「表紙」「裏表紙」以外は変更されることがあり、シートの並び順もこの限りではありません。 またシートの総数も変更されるため、間のシート数を固定で指定することは出来ません。 マクロの記録をしたところ、シート名を全て記述した上でPDF化するコードになりましたので使えません。 いろいろ検索もしてみましたが、アクティブなシートをPDF化くらいしか見つかりませんでした。 マクロでは無理な操作なのでしょうか？ もし宜しければ、ご教授お願い致します。
Excel2013で、テキストボックスの文字列を置換するマクロを組んだら、フォントまで...Excel2013で、テキストボックスの文字列を置換するマクロを組んだら、フォントまで変わってしまった。 ボタンを押したら、テキストボックス内の「あいうえお」を「ＡＢＣＤＥ」に置換することを意図したマクロを組みたいです。 図の上側のように、テキストボックスの中でフォントを分けている場合に、 以下のようなプログラムを実行したところ、文字列は意図したとおりに置換されたのですが、図の下のように、フォントまでタイトル部分と同じになってしまいました。 フォントや左揃えなどを保持したまま、文字列だけを置換することはできないでしょうか？ Sub ボタン1_Click() Dim shp As Shape, Buf As String, Buf2 As String For Each shp In ActiveSheet.Shapes 'メッセージボックスの場合 If (shp.Type = msoTextBox) Then '置換前の文字列 Buf = shp.TextFrame.Characters.Text '置換後の文字列 Buf2 = Replace(shp.TextFrame.Characters.Text, "あいうえお", "ＡＢＣＤＥ") shp.TextFrame.Characters.Text = Buf2 End If Next shp End Sub
Vbaにて Dim MaxRow As String MaxRow = CStr(Cells(Rows.Count, 1).End(xlUp).Row) Dim initial As String Cells(4, 128) = "稼働時外気温度" initial = "S" MaxRow = initial +MaxRow Cells(4, 129).Formula = "=AVERAGEIFS(S3:MaxRow,S3:MaxRow,"">0"")" このようなコードをかいたのですが、出力セルには#NAME$がでてしまいます。どのようにすればちゃんと出力されますか？
マクロ テキストボックスを利用する Sub 抽出3() Range("A2").SelectSelection.AutoFilterActiveSheet.Range("$A$3:$A$20000").AutoFilter Field:=1, Operator:= _ xlFilterValues, Criteria2:=Array(1, "5/30/2016") End Sub このようなマクロを使い日付を抽出しているのですが、 日付をユーザーフォームを利用して範囲指定のような形で 抽出できるようにしたいと考えているのですが、良い案はありますでしょうか？ フィルターは使いたくありません。
Visual basic2015においてお絵かきソフトを制作しています。 PictureBox上に線を自由に引くことはできるのですが、マウスを素早く動かすとその線が途切れてしまいます。マウスを早く動かしても途切れない方法はありますか？ プログラムはこちらの知恵袋の回答者様からお借りしています。 http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1097283555 Public Class Form1 Private img As Bitmap Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load img = New Bitmap(Me.ClientSize.Width, Me.ClientSize.Height) PictureBox1.Image = img End Sub Private Sub PictureBox1_MouseMove(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles PictureBox1.MouseMove 'ペイントを使用するための宣言 Dim g As Graphics = Graphics.FromImage(img) '左クリックをした際の処理 If e.Button = MouseButtons.Left Then g.FillEllipse(Brushes.Red, e.X, e.Y, 10, 10) PictureBox1.Invalidate() End If End Sub End Class
Vbaにて3行目以上の奇数行を削除するこーどをかいてみたのですが、すごく時間がかかります。高速化するにはどうすればよいでしょうか？ For intHen = 3 To MaxRow_Z If intHen Mod 2 <> 0 Then strRow = intHen & ":" & intHen If intHen = 3 Then H2.Range(strRow).Select Else Union(Selection, H2.Range(strRow)).Select End If End If Next intHen Selection.Delete shift:=xlUp
アクセス初心者です。 アクセスに検索フォームをつけようとしたところ「コンパイルエラー End Subが必要です」と出て検索できません。修正箇所を教えてください。 Private Sub 名前で検索_Click() Private Sub 名前で検索_AfterUpdate() Me.Filter = "氏名 like'*" & （検索窓） & "*'" Me.FilterOn = True End Sub
VBAのMergecellsプロパティについて 以下の文でセルが結合されてしまうのですが、なぜなんでしょうか。。Range(Cells(RowPos(1), ColPos(1)), Cells(RowPos(1), ColPos(1) + 2)).MergeCells = True ColPos(1) = ColPos(1) + 3 Mergecellsはセルが結合されているかどうか判定し、trueかfalseで返すのではないですか？ なぜこれで結合されてしまうんでしょうか。
エクセルVBAのFindメソッドについて教えて頂きたいです。 やりたい事は【sheet1内のB列に含まれている文字列を検索して行番を返す。】です。 取得する行番を変数 Nで設定しています。検索する文字列を変数 iで設定しています。 下記内容ではエラーがでます。 N = Worksheets("sheet1").Range("B:B").Find(i).Row 問題があれば、御指摘頂きたいです。
現在、access2010を本を見ながら勉強しています。accessでフォームを作成しあいまい検索をしたいと考えています。 テキストボックスに氏名 ボタンに検索 リストボックスに氏名一覧 を作成し、あいまい検索すると一覧で表示できるようにしたいと考えています。 イベントプロシージャにどの様な文章をかけばよいのかわかりません。 初心者にも説明できる方、申し訳ありませんが教えて下さい。 本やネットを使って挑戦していましたが全然できずお手上げです。
下記のマクロで For i = x To 1 Step -1部分で 構文エラーが出ます。 何処が間違いなのでしょうか？ With ActiveSheet x = .UsedRange.Cells(.UsedRange.Count).Column For i = x To 1 Step -1 If Application.CountA(.Columns(i)) = 0 Then .Columns(i).Delete Next End With End Sub
VBAで質問です。sheet1に ABCDEFGHIJ 店舗コード、担当者コード、担当者名、メーカー名、商品名、売上数量、売上金額、仕入価格、仕入価格×売上数量、売上金額ー仕入価格×売上数量 １ 1000 伊藤 タナカ リンゴ 20 3000 130 2600 400 ２ 2000 佐藤 キクチ ブドウ 5 1000 180 800 200 １ 1000 伊藤 サトウ モモ ３ 1200 370 1100 100 １ 1000 伊藤 タナカ リンゴ ４ 600 130 520 80 １ 1000 伊藤 タナカ みかん 10 800 70 700 100 １ 1001 加藤 タナカ リンゴ 12 1800 130 1560 240 ・ ・ ・ 以上の内容が約10,000行ほどあります。このsheet1の内容をA～Eまでが完全に重複しているものを足し合わせて店舗コードを小さい順に並べ、担当者コードも数字が小さいものから順にしかつメーカー名、商品名はアイウエオ順に表示したいと考えています。 １ 1000 伊藤 サトウ モモ ３ 1200 370 1100 100 １ 1000 伊藤 タナカ みかん 10 800 70 700 100 １ 1000 伊藤 タナカ リンゴ 24 3600 130 3120 480 １ 1001 加藤 タナカ リンゴ 12 1800 130 1560 240 ２ 2000 佐藤 キクチ ブドウ 5 1000 180 800 200 ・ ・ ・ このような状態にしたいと思っています。 一度、VBAを使って作成を試みたのですが、商品ごとの全体の合計しか出せませんでした。 どうか皆さんでわかる方がいらっしゃったら教えていただけないでしょうか？
Visual Basicの問題です。 わからないので、どなたか教えてください。問題：身長と体重のデータを入力し、基準値＝身長ー１１０なる基準値に対して、 体重＜基準値ー８ "痩せすぎ" 基準値ー８≦体重＜基準値＋８ "ちょうどいい" 基準値＋８≦体重 "太りすぎ" を判定しメッセージを表示しなさい。 よろしくお願いします。
入力フォームを使用して複数シートによるデータ検索の方法についてお願いします。先日質問して回答していただいた件のまた続きになるのですが、A列に通し番号、Ｂ列に顧客名、Ｃ列にメイン営業所名、Ｄ列に状況、E列に更新日、Ｆ列にサブ１営業所、Ｇ列に状況、Ｈ列に更新日、I列にサブ２営業所、Ｊ列に状況、Ｋ列に更新日、が表記してあるリストがあります。またこのリストから営業所名を検索して営業所名と期限とＢ列の顧客名（1番左端表示）を表示したいと思います。このとき期限の欄に"削除"が入力されている行は含みません。ここまでは教えて頂いたコードでうまくいきました。（下記データ参照） 次に新しく2つの条件を加えたいのです。 一番目にはシートが複数ある場合のコード表記（シート名は決まっていて、仮にSheetA,SheetB,SheetCにします） 二番目にはリストボックス２に表示した検索結果をクリックして下のテキストボックス２（営業所名）、テキストボックス３（状況）、テキストボックス４（日付）にデータを表示させて、修正して CommandButton3（修正ボタン）によりシートのデータを反映できるようにしたいと思います。 お手数おかけ致しますがご教示お願い致します。 以下これまでのコード Option Explicit Private Sub 閉じる_Click() Unload UserForm2 End Sub Private Sub UserForm_Initialize() ListBox2.ColumnCount = 4 ListBox2.ColumnWidths = "2cm;5cm;3cm;3cm" End Sub '検索ボタンが押された時の処理 Private Sub CommandButton1_Click() Dim st1 As Worksheet Dim Area As Range, FoundCell As Range, FirstAddress As String Dim Item As Variant Set st1 = Worksheets("Sheet1") 'テキストボックスが未入力ならメッセージを表示して処理を終了する If TextBox1.Text = "" Then MsgBox "データを入力してください！" Exit Sub End If 'セルを検索する Set Area = st1.Range("A2:K" & st1.Range("A" & Rows.Count).End(xlUp).Row) Set FoundCell = Area.Find(What:=TextBox1.Text, LookIn:=xlValues) '該当セルが見つからなければメッセージを表示して処理を終了する If FoundCell Is Nothing Then MsgBox "見つかりません" Exit Sub End If 'リストボックスをクリアする ListBox2.Clear FirstAddress = FoundCell.Address Do With FoundCell '検索結果が営業所以外のときはスキップする If .Column = 3 Or .Column = 6 Or .Column = 9 Then '状況列が「削除」のときはスキップする If CheckBox1.Value = True And .Offset(, 1).Value = "削除" Then Else 'リストボックスに顧客・営業所名・状況・更新日を設定する ListBox2.AddItem st1.Range("B" & .Row).Value ListBox2.List(ListBox2.ListCount - 1, 1) = .Value ListBox2.List(ListBox2.ListCount - 1, 2) = .Offset(, 1).Value ListBox2.List(ListBox2.ListCount - 1, 3) = .Offset(, 2).Value End If End If End With '次のセルを検索する Set FoundCell = Area.FindNext(FoundCell) If FoundCell Is Nothing Then Exit Do Loop While FoundCell.Address <> FirstAddress End Sub Private Sub ListBox1_Click() Dim Target As String Target = Split(ListBox1.Value, vbTab)(0) Sheet1.Range(Target).Select End Sub 以上、よろしくお願い致します。
ﾏｸﾛ,VBAについて質問です。（ｴｸｾﾙ2010を使用しています） A列のA2からA?までにデータの計測時間があります。（計測時間は任意で毎回異なります、） B列のB2～B?までは計測データが計測時間分入っています。 例えばA列に0秒～300秒まで0.1秒刻みで値が入っていたとします。 B列にはA列と同様に計測データが入っているとします。 このとき0~30秒、30.1秒~60秒、60.1秒~90秒・・・・ のように30秒刻みでB列のデータの平均値をC1からC2、C3と張り付けていき、A列の秒数がなくなるまで平均値をC列に抽出したいです。 またデータの刻み量も0.1秒毎とは限らず、0.2秒毎や0.5秒毎に変わります。 データの計測刻み量が変わっても平均値を抽出できるマクロをどなたか教えてください。
Visual Basicの問題です。 わからないので、どなたか教えてください。 問題：値を一個ずつ入力し、偶数か奇数かを判定して各々の個数をカウントします。入力終了後、個数と奇数の個数を表示しなさい。 （参考） （値 Mod2）＝０なら偶数、それ以外は奇数 よろしくお願いします！！
VBA初心者です。コードも教えていただけると助かります。 添付のエクセルの４行目に年月日時分（シリアル値）が記載されています。その年月日時分で任意の期間のみにデータを絞り抽出をしたいのですが どうすれば良いかわかりませせん。 ご教示ください。 Sub prog4_2() Dim myFld As String, myCri As String Dim myRow As Long Dim Sh2 As Worksheet, Sh3 As Worksheet Set Sh2 = Worksheets("Sheet2") Set Sh3 = Worksheets("s") 'myFld = InputBox("検索は何列目ですか?") myCri = InputBox("検索する日付を入力しなさい") With Sh2 .Range("A1").AutoFilter Field:=3, Criteria1:=myCri myRow = .Range("A" & Rows.Count).End(xlUp).Row Sh3.Range("A:E").ClearContents .Range("A1:E" & myRow).Copy Sh3.Range("A1") .Range("A1").AutoFilter End With Worksheets("Sheet2").Activate ActiveSheet.Range("A1").Select End Sub
Visual c++ で質問です。 現在、MFCアプリでストップウォッチ機能を作成しています。 ボタンは3つでStart、Stop、Reset エディタが１つで作成しようと思っています。 Startボタンを押下時GetTickCountで回してたんですけど回してるとStopボタンが押せなく止まれません。 それでマルチスレッドを使用を考えたのですがマルチスレッドの作成方法がわからないのです。 Start→マルチスレッドでGetTickCountを回す Stop→GetTickCountを止めてエディタに出力 みたいな感じにするにはどうすればよいでしょうか。
超初心者です。 簡単なＳＱＬさえわからない状況です。Select 部門コード、部門名、担当者名 from 部門マスタ where 部門コード = ‘10’ 担当者名は担当者マスタの担当者名より取得したいのですが どう記述すればいいのでしょうか。 担当者コードで紐付けて、担当者マスタに存在しない場合は 担当者名は空白としたいです。 単一行の選択でデータベースはＯｒａｃｌｅです。
VBでの質問です。 VS2013を使用しています。 あるサーバーにあるプログラムの修正をいているのですが、 修正した後ビルドしてアプリケーションのファイルを作成しました。サーバーに乗っているプログラムを修正後のプログラムに差し替えようと思うのですが、 （.exe）のファイルだけ差し替えたらうまく起動しませんでした。 （.exe）のファイルだけではダメなのでしょうか？ 他の（.pdb）(.vshost)など「bin￥Debug」の中にいろいろ別のファイルも作成されされてますが、他のファイルも差し替えなければいけないのでしょうか？ 詳しい方教えてください。。
VB（visual basic）の質問です。 VBを興味本位で勉強し始めたのですが、”1から100までの和を求めて出力せよ。”という問題に苦戦しています。いったい何を使えば解けるのでしょうか？解答お願いします。
①VBEを起動して、[データ2-3.xlsx]プロジェクトに標準モジュールを挿入して、「注文月の並べ替え」の名前でマクロ（プロシージャ）を作成してください。②「備品」シート（以下省略）のセル「G8」をキーにして、セル「A9」からG「54」の表全体を並べ替えるステートメントを次の条件で作成してください。 【作成条件】 ・前回の並べ替え条件が残らないように条件データを一度クリアにする ・「注文月」を「昇順」で並べ替える ・並べ替えを行うセル範囲はセル「A8」を基準に「CurrentRegion」プロパティでアクティブセル領域を取得する ・先頭行をデータの見出しとして使用する ③作成したマクロは「注文月の並べ替え」フォームボタンに登録し、ボタンからマクロを実行してください。 ④名前を「書式の置換」で新たにマクロ（プロシージャ）を作成し、セル「B2」に入力されている備品名と一致するデータを表（A9：A54）から検索し、一致するセルを「太字」に置換するステートメントを作成してください。 ⑤④で作成したマクロは「書式の置換」フォームボタンに登録し、ボタンからマクロを実行してください。 ⑥名前を「業者の抽出」で新たにマクロ（プロシージャ）を作成し、オートフィルタ機能でセル「F2」に入力された業者名を抽出するマクロを作成してください。 ⑦⑥で作成したマクロは「業者の抽出」フォームボタンに登録し、ボタンからマクロを実行してください。 ⑧「解答2-3.xlsm」と名前を付けて、マクロ有効ブックとして保存してください。
今さらながらVB6を仕事で使うことになったため、勉強しています。まずはVisual Studioでサンプルファイルを見ているのですが、 Modulesの中にある.basファイルはどういう順番で実行されるのでしょうか。 初歩的な質問で申し訳ありませんが、ご教授頂けますでしょうか。
マクロ初心者です。 リンクを除くデスクトップ上のファイルをメッセージボックスに表示するマクロを作成しています。 Dim Path As String Path = "c:¥Users¥ユーザー名¥Desktop¥*.*&quot; And Path <> "*.lnk" myFile = Dir(Path) Do While myFile <> "" myFileList = myFileList & Chr(13) & myFile myFile = Dir() Loop MsgBox myFileList するとメッセージボックスには何も表示されません。 And Path <> "*.lnk"を消すとリンクファイルを含んだ全てのファイル名が表示されます。 できれば、ファイル名をユーザーフォームのチェックボックスに表示して、チェックがついたものを削除するところまで教えていただけるとありがたいです。 よろしくお願いします。
excelのVBAでWindowlessVideoをtrueに設定したいのですが、記述の仕方がわかりません。 どなたか教えて頂けないでしょうか？ VBAでカメラ撮影をしようとプログラムを書いていますが、古いノートでは上手く動くのですが新しいタブレットでは、画面が黒くなり、 恐らくこれだと思うのですが、記述の仕方がわかりません。 よろしくお願い致します。
エクセルの並べ替えについて質問です。 下記のようなデータが並んでいます。並び替えで【最優先されるキー】を【教科】の列、【次に優先されるキー】を【評価】として 並び替えたいのですが、【番号】が同じものが複数行ある場合は並び替えの際に 離れないように(上下の関係のまま)することは可能でしょうか。 なお、同じ番号の行が複数行ある場合は、 最上段にある行で判断して並び替えを行いたいと思っております。 関数や並び替え機能、ＶＢＡ等どのような方法でも結構です。 よろしくお願い致します。 【元のデータ】 番号 名前 教科 評価 1 相澤 国語 Ａ 2 伊東 算数 Ａ 2 伊東 国語 Ｂ 3 上田 理科 Ｃ 4 江村 国語 Ｂ 4 江村 理科 Ａ 5 小川 算数 Ｂ 【並び替え後のデータ】 番号 名前 教科 評価 1 相澤 国語 Ａ 4 江村 国語 Ｂ 4 江村 理科 Ａ・・・※ 2 伊東 算数 Ａ 2 伊東 国語 Ｂ・・・※ 5 小川 算数 Ｂ 3 上田 理科 Ｃ ※は同一の番号で最上段ではないので、並び替えの対象にはなっていません。 ※上記の表の場合は国語→算数→理科の順で並んでいます。 ※教科や評価の行で並び替えをしたいので、最優先されるキーを番号にすることは出来ません。 分かりにくい質問で申し訳ございませんが、 何卒よろしくお願い致します。
Vbaにて H.Activate H.Cells.Select Selection.Copy H2.Activate H2.Cells.Select Selection.Paste Hというシートを同じブック内のH2にコピーしたいので上のようなコードを実行しました。しかし、コピーまでは実行され、H2のシート全選択までされているのですが、貼り付けがされません。なぜでしょうか
VBAで下記の記述を教えてください。AA列に文字が入っている場合処理を中断し、空欄の場合は、次のマクロに進むという記述を教えてください。
下記の記述を教えてください。VBA 現在m列に数式が六行目から1000行まで入っていますが、保護しているのですが、なんらかの原因で数式が崩れる事を想定して、再度、マクロで数式をセルに反映し直す記述は可能でしょうか？ 可能であれば、記述方法を教えてください。
ExcelVBAでセルのカラースケールの色を取得するにはどうすればいいでしょうか。 Range("A1").Interior.ColorIndex では、だめでした。(セルの背景色ではないためか)
エクセル2010【ＶＢＡ】ピボットテーブルの行変更（列は変わらないのですが、日々、行数は変わります）について ピボットテーブルの作成のＶＢＡ化で悩んでいます。Ｓｈｅｅｔ1のＢ1に「区分」項目があり、Ｉ1に「金額」項目があります。それぞれ2行目から値が入っています。 列としてはＲ列まであります。 Ａ列は空です。 したい事は ①Ｂ列を基準に上から下に向かって最下行を取得し、データ範囲 ②作表はＢ列の区分、データの個数、金額、全体に対する金額の構成割合 ③同じシートＣ列を基準に最下行を取得し、Ｃ列の最下行から3行より作表 です。 色々と調べてみたのですが、全くわからないので投稿させてもらいました。 宜しくお願い致します。 以下はマクロの記録です。 Sub Macro2() ' ' Macro2 Macro ' ' ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _ "Sheet1!R1C2:R12395C18", Version:=xlPivotTableVersion14).CreatePivotTable _ TableDestination:="Sheet1!R12398C3", TableName:="ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2", _ DefaultVersion:=xlPivotTableVersion14 Sheets("Sheet1").Select Cells(12398, 3).Select With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("区分") .Orientation = xlRowField .Position = 1 End With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").AddDataField ActiveSheet.PivotTables( _ "ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("税抜金額"), "合計 / 税抜金額", xlSum ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").AddDataField ActiveSheet.PivotTables( _ "ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("税抜金額"), "合計 / 税抜金額2", xlSum ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").AddDataField ActiveSheet.PivotTables( _ "ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("税抜金額"), "合計 / 税抜金額3", xlSum With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("合計 / 税抜金額") .Caption = "データの個数 / 税抜金額" .Function = xlCount End With With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("合計 / 税抜金額2") .NumberFormat = "#,##0" End With With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("合計 / 税抜金額3") .Calculation = xlPercentOfTotal .NumberFormat = "0.00%" End With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").TableStyle2 = "PivotStyleMedium8" End Sub
OutlookVBAをパスワード付でエクスポート・インポートすることは可能でしょうか？OutlookVBAをエクスポートして配布する予定です。 ソースコードをいじれないようにパスワード付で配布したいのですが、パスワード付の配布は可能でしょうか？ また、パスワード付だと問題ありますか？ 例えばインポートする側がパスワードを要求されるので、パスワード設定は無意味・・・とか 知識がないので教えてください。 宜しくお願い致します。 カテの選択ミスでしたらすみません。
VBAで質問です＞＜ ランダム・ウォーク (酔っぱらい歩き問題) ある人が数直線上を1分間に1mずつ移動するとする。左右どちらに移動するかは完全にランダムであり、 その場にとどまることはなく1分後にかならず左右のどちらかに移動するものとする。 60分後、最初にいた位置からどれだけ離れたところにいるかシミュレーションせよ。 100回のシミュレーションを行い、最初の位置からどれだけ離れたところにいるか平均を求めよ。 という問題を課題で出されましたがググってもよくわかりません＞＜ ソースコードと解説をお願いします＾＾
VB2013について質問です 残業システム的なものを作ってるのですが 例 Ａ社員→リストで残業時間選択→加算されそのまま記憶 ↑切り替わってもお互いの数値は別に記憶 ↓ Ｂ社員→リストで残業時間選択→加算されそのまま記憶 今日の残業時間は記憶させる ↓ 昨日の記憶された数値が表示される そこからスタート 変数を用意して数値を記憶させてるんですが Ｂ社員に切り替わるとき 初期化できないとか 不具合が多いです 保存もテキスト プロパティをいじるみたいな回答もあったので やってみたんですが できるはできるけど違うような？？ 教えてくださいよろしくお願い致します。
VisioのVBAについての質問です。Excelに名前と数が書かれているのですが、VisioでExcelのセルから名前と数を読み込んで、 VBAのマクロで名前が一致するステンシルを、図面に数だけ出す動作を行いたいと考えております。 マクロをどのように書くとExcelから読み込めて、上手く数の分だけステンシルを出すことができるか 教えていただけないでしょうか。ご回答よろしくお願いいたします。
VBAについてお教えください。 A列に様々な文字列が格納されているとします。 A列の特定の文字列から始まるセルを検索し、一致したセルの隣（B列）の値を別シートのA列に順次コピーしていく、 また、A列の他の特定の文字列から始まるセルを検索し、一致したセルの隣（B列）の値を別シートのB列に順次コピー、他の特定の文字列と一致したセルの隣（B列）を別シートのC列に順次コピーしていく、、、 といったようなマクロをお教えいただけますでしょうか？
エクセルからPDFの変換方法について こちらの知恵袋でみつけた、エクセルからPDFに変換する方法を活用させていただいているのですが、保存先をダイアログを表示させて保存する方法に変更したいのですが、教えて頂けないでしょうか。 Sub Sample() With Range("A1") If .Value <> "" Then If InStr(.Value, "\") > 0 Or _ InStr(.Value, "/") > 0 Or _ InStr(.Value, ":") > 0 Or _ InStr(.Value, "*") > 0 Or _ InStr(.Value, "?") > 0 Or _ InStr(.Value, """") > 0 Or _ InStr(.Value, "<") > 0 Or _ InStr(.Value, ">") > 0 Or _ InStr(.Value, "|") > 0 Then MsgBox "セルA1にファイル名に使えない文字(\/:*?" & """" & "<>|)が含まれています。", vbExclamation Else ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _ Filename:="C:\Users\ユーザー名\Desktop\" & .Value & ".pdf" '引数Filenameには保存したい場所を指定してください（このコードではデスクトップに保存しています）。 End If Else MsgBox "セルA1にファイル名が入力されていません。", vbExclamation End If End With End Sub 「Filename:="C:\Users\ユーザー名\Desktop\" & .Value & ".pdf"」を変更すればいいのでしょうが、どうしてもエラーがでます。 ご教授よろしくお願い致します。
先日した質問で追加の質問です。 先日の質問は以下を参照してください。http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1216194004... Option Explicit Sub CSV書出し() Dim FileN As String FileN = ActiveWorkbook.Path & "\" & Format(Now, "yyyymmddhhMM") & ".csv" ActiveWorkbook.SaveAs Filename:=FileN, FileFormat:=xlCSV ActiveWorkbook.Close Savechanges:=False MsgBox "CSVファイルで書き出しました。", vbInformation End Sub 上記のマクロを実行すると Option Explicitの上に以下の構文が勝手に追加され２回目に動かすときにエラーになります。 Sub CSV書出し() Dim FileN As String なぜこの構文が勝手に追加されるのでしょうか？ どうすれば出ないように出来ますか？
エクセルで以下のことをやりたいです。 添付画像も参考にしていただければ幸いです。 会議の出席状況が入ったCSVファイルがあります。CSVファイルは会議ごとに生成され、A列に所属番号、B列に名前、C列に出席情報（数値）が入っています。 それを集計ファイルというエクセルファイルに読み込ませて出席状況の集約をさせたいです。 集約ファイルには所属番号と名前が入っており、この順番は不動なのでCSVファイル、集約ファイルともにA列とB列に入っている項目はまったく同じです。 そこで、CSVファイルを日付順に読み込ませ、1行目（項目行）に日付、2行目以降に出席状況（名前の行）を入れていきたいのです。 所属番号と名前はもともと集約ファイルに入力されているので、読み込ませる項目は日付と出席状況のみです。 説明が分かりづらくて申し訳ありません。 随時補足させていただきます。
VBAの数字で困っています。 お世話になります、勉強しながらプログラムを記述しているVBA並びにプログラム初心者です。base.Cells(2, 28)のセルに8556805823という数字を入れています。 しかし、 Dim Number As Single Number = base.Cells(2, 28).Value checkSheet.Cells(3, 1).Value = Number と記述すると、 checkSheet.Cells(3, 1).Value のセルの表示が 8556805632と変わって表示されてしまいます。 試しに、 Number = 8556805632 と記述しようとすると Number = 8556805632# となってしまいます。 プログラムの他の部分でもNumberの数字を修正するような記述はしていません。 質問がわかりづらくて申し訳ありませんが、 どうかご教授お願い致します。
マクロ ～を含むものをフィルターにかける。田中一郎 田中二郎 村上三郎 木村四郎 とある時に Sub 検索() Dim myName As String myName = Range("A2").Value If myName = "" Then MsgBox "A2に入力してください" Else Range("A6").AutoFilter Field:=1, Criteria1:=myName End If End Sub このようなマクロを作成しました。 ここで、A2に田中と入力してマクロでフィルターをかけて 田中一郎 田中二郎 のように表示をしたいのですが どこをどう修正すれば良いでしょうか？
vbaでbatファイルをきちんと実行させる方法をお教え下さい。空のテキストファイルをbatファイルと同じフォルダに作成する命令を書き込んだbatファイルをデスクトップに置き、 （batファイルの記述は『テキストファイルを作るURL > テキストファイル名.txt 』） そのbatファイルを実行する命令をDドライブに格納してあるエクセルVBAに書き、実行させました。 しかし、batファイルを直接クリックすればテキストファイルは出来ますが、 VBAを実行させても、少しコマンドプロンプトの画面が出るだけでファイルを作成してくれません。 どうすればファイルを作成してくれるようになるでしょうか？ batファイルを実行する記述は以下です。 Sub batファイル実行() Dim batFileName As String batFileName = バッチファイル名フルパス Dim ShellObject As Object Set ShellObject = CreateObject("WScript.Shell") ShellObject.Run batFileName, 1, True End Sub 何卒御教示のほどよろしくお願い致します。
VB.netでJIS X 0208の文字をチェックするロジックを教えて下さい。 VCだと以下のサイトの内容になるものと思われます。http://hensumei.com/archives/2438 VCのスキルが無い為、VBで同様のロジックを探しています。
エクセル 関数での処理について質問をさせてください。 下記のようにシート1にデータベースエリアがあり、シート2に集計表があります。シート1のデータに従いシート2に関数で値を入れているのですが、どうしても 稼働班数が思ったように入力できません。作業シートを作ったりすれば出来るのですが 出来れば、関数の入力だけで処理をしたいです。 稼働班数とはいわゆる一意の値になります。 稼働報告の日付を取得して所属ごとに何人稼動しているかを 入れたいのです。 よろしくお願いいたします。
Excelについて質問させて頂きます。VLOOKUPの関数のことなのですが、 ABCフォルダ -Aフォルダ -ブック１ -Bフォルダ -ブック２ というフォルダを作ってあります。 ブック２にVLOOKの関数を使用していて 参照範囲はブック１です。 １つのパソコンで使う場合は、特に問題もありません。 他のパソコンでABCフォルダフォルダをコピーして使用する時 「このブックには更新できないリンクがある」と表示されます。 続行で、使えることは使えるのですが、毎回続行を選択するのが面倒です。 表示させない方法はありますでしょうか？ また、この場合は、VLOOKUPをVBAで組んでフォルダをパスしたほうがいいのでしょうか？
VBAのオートメーションエラーについて お世話になります、VBA初心者なのですが勉強しながらプログラムを作っています。作ったプログラムを実行すると 「Microsoft Visual Basic 実行時エラー'-2147221080(800401a8)' オートメーション エラーです。」 とメッセージボックスが表示され、そのなかの「デバッグ」をクリックすると 「Microsoft Visual Basic for Applications メモリが不足しています。」 というメッセージボックスが表示されます。 OKをクリックすると、 下記コードの中の mno = readSheet.Cells(a, 5).Value の背景色が黄色になっています。 コードは Sub NO() Workbooks.Open Filename:=ThisWorkbook.Path & "\..\..\..\見積書.xlsm" Dim dat As Single Dim mno As Single Dim writeSheet As Worksheet ' 自分自身の書き出し先シート Set writeSheet = ThisWorkbook.Worksheets(1) ' Sheet1 を参照 Dim readBook As Workbook ' 相手ブック Set readBook = Workbooks("見積書.xlsm") ' 相手ブックを参照 Dim readSheet As Worksheet ' 相手シート Set readSheet = readBook.Worksheets("見積書") ' 相手シートを参照 dat = writeSheet.Cells(2, 28).Value Endrow = readSheet.Range("A" & Rows.Count).End(xlUp).Row For a = 4 To Endrow mno = readSheet.Cells(a, 5).Value 'dat = writeSheet.Cells(2, 28).Value 'writeSheet.Cells(1, 3).Value = mno 'writeSheet.Cells(1, 4).Value = dat If mno = dat Then writeSheet.Unprotect writeSheet.Cells(1, 1).Value = readSheet.Cells(a, 1).Value ActiveWorkbook.Close writeSheet.Protect End If Next a End Sub 実行時エラーの実行時エラー'-2147221080(800401a8)'で検索してみたのですが、どこに原因があるかわからず困り果てております。 どなたかご教授お願いいたします。
VBAで教えてください。 下記コードで、うまく実行できたのですが、 元のシートをこの後削除したい場合、どのようなコードが足されるのでしょうか？最終行に activesheet.delete でも、消えてくれません。 copyをcutに変えてもダメでした。 Dim wb As Workbook, flg As Boolean Const myPath As String = "C:\終了物件台帳.xlsm" flg = False On Error Resume Next Set wb = Workbooks("終了物件台帳.xlsm") If wb Is Nothing Then Set wb = Workbooks.Open(myPath) flg = True End If On Error GoTo 0 ThisWorkbook.ActiveSheet.Copy After:=wb.Sheets(wb.Sheets.Count) If flg Then wb.Close True
excel2003 VBA を使用しています。 以下のようにコードを作成した場合の該当エリア内のセルを判断する場合は どのようにすればいいですか。Dim Ws as worksheet set Ws=workbooks("AAA").sheets("BBB") Ws.Range("B3:E27").ClearContents ・・・① とした場合、セルB3には数字１，２，３、・・・が入ります。 初期化の場合は、上記①としますが、最初は手動入力で、セルをDeleteキーを 押すか、入力待ちにしてBack spaceキーで数字を消すかします。 （担当者のやり方で方法は変わります。） 最初の判断で、 If Ws.Cellls(3,2).value="" then ・・・② If IsNyumeric(Ws.Cells(3,2).Value)=False then ・・・③ If VarType(Ws.Cells(3,2).Value)=vbString then ・・・④ 上記②～④で試したのですが、いづれもすり抜けてしまいます。 Cells(3,2).Value に数字が入っているか、いないかで処理を変えたいのですが、 その判断をどのようにすればいいでしょうか？ 宜しくお願いいたします。
エクセルＶＢＡについて質問です。 フォームのコマンドボタンに関する質問です！ Ｃ列を「判定」列として、「〇」が入力されている行のＢ列のみ、フォームのコマンドボタンに表示させたいと思います。画像例では、Ｃ２、Ｃ３，Ｃ４、Ｃ５、Ｃ６に「〇」が入力されていて、Ｂ２Ｂ３（内容が同じ場合は、一つのみ）、Ｂ４、Ｂ５、Ｂ６の「都道府県」名をフォームのボタンにそれぞれ表示させています。ボタンの数は、「〇」が入力されている分だけ表示させたいです。（内容が同じ場合は、一つのみ表示） Ｃ列「〇」とＢ列「都道府県」をオートフィルタさせ、マクロの記録でおおかた、コードは分かると思うのですが、フォームのコマンドボタンを必要な都道府県のみ表示させる方法がわかりません。。。 ご教授お願いいたします＞＜
VisualBasicのプログラムで、 ① メニューバーのボタン（ここではbutton1とします）を押す ② フォームの中にある画像が表示され3枚の画像が3秒ごとに切り替えられ続ける③ メニューバーの別のボタン（例えばbutton2）を押す ④ ②と同じ場所に別の画像が表示され2枚の画像が3秒ごとに切り替えられ続ける というものを組み込みたいと思っています。 TimerとDo Loopを使用して処理を繰り返させてみたりはしたのですが、button1を選択すると処理が完全に止まったりしてうまくいきません。 そこで①~④の処理を行う方法をご教授いただきたいと思います。 （できるだけVBがいいのですが、もしVBで実行が難しいようでしたらJAVAを除くC言語等のほかの言語でも構いません。） 参考までに自分が作成したコードです。 （Loop関係は外しましたがどうもうまく画像が変わりません。） Dim sec As Integer Private Sub button1_Click(sender As Object, e As EventArgs) Handles button1.Click sec = 0 Timer.Enabled = True haikei.Image = Image.FromFile("picture¥001.png") End Sub Private Sub Timer_Timer() sec = sec + 1 If sec = 3 Then haikei.Image = Image.FromFile("picture¥101.png") Else End If If sec = 6 Then haikei.Image = Image.FromFile("picture¥201.png") Else End If End Sub Private Sub button2_Click(sender As Object, e As EventArgs) Handles button2.Click sec = 0 Timer.Enabled = True haikei.Image = Image.FromFile("picture¥002.png") End Sub Private Sub Timer_Timer() sec = sec + 1 If sec = 3 Then haikei.Image = Image.FromFile("picture¥102.png") Else End If End Sub VBの理解が進んでない者ですがよろしくお願いします。
ｅｘｃｅｌについて教えてください。ＤＶＤ・ＣＤ通販サイト等のそれぞれの作品にある品番をセルに入力することで、そのサイトから作品名やアルバム名・アーティストその他情報をｅｘｃｅｌに自動で反映させることってできるのでしょうか？ あるのであればどのようにするのでしょうか？ 方法や学ぶべき内容とかでも構いませんので教えてください。
ＳＩ(システムインテグレーター)になるには、どういう勉強から始めれば良いのでしょうか？超初心者です。
エクセルでユーザーフォームを作っているのですが、 テキストボックスをコンボボックスに変換することってできますか？Accessにある「コントロールの種類変更」というのは、エクセルにはないのでしょうか？
エクセル関数マクロに詳しい方、ご教授をお願いします。 a列３：11に品名入力、d列に品名マスターがある。b列3:11にそれぞれの数量入力すると、d列の品名マスターにa列に入力した品名と数量がe列に数量が反映される表です。 e列には、関数設定がある。 各品名の合計を最大で２５個にして容器に収納したいです。 その容器には、最大で２５個しか入りません。 混収納は、可能です。 例えば リンゴ「２５個」で１容器 バナナが５０個なので、「２５個」「２５個」で２容器 トマト「７個」イチゴ「７個」ナシ「１個」で１容器 下記 図のように、マクロ実行で出来ないでしょうか？ 教えてください。 マクロ入門者です。 よろしくお願いします。 c列は、作成されてますが（容器に種類が記入されます）、列として考えてください。 左表から容器収納指示（右表）にしたいです。 右表は、マクロ実行で表示されるようです。 端数がでたら、それも１として収納します。
エクセルのマクロについて質問です。Sheet1には、 Ａ１セルから 名称＿＿＿判断項目＿＿＿担当者 あああ＿＿abで始まり＿＿＿山田 あああ＿＿45で終わり＿＿＿小川 あああ＿＿e6が中に＿＿＿＿田中 という一覧表があります。 Sheet2には、 Ａ１セルから 名称＿＿＿テキスト＿＿＿担当者 あああ＿＿abc123＿＿＿＿？？？ あああ＿＿dbc145＿＿＿＿？？？ あああ＿＿abe623＿＿＿＿？？？ というように、名称とテキストが入力されたら、担当者の名前を一覧表から返すマクロを作ろうとしています。 ここで質問です。 変数とワイルドカード（Like演算子）の組み合わせがわかりません。 ワイルドカードは名称が同じものがあれば、テキストの文字列から、判断項目で判断する、ということです。 （今回は説明のために簡素化していますが、たとえば、名称は「あああ」「いいい」「ううう」のようにたくさんあり、その都度判断項目で判断し、担当者を返す） マクロわかる方、よろしくお願いします。
ExcelVBA ボタンによる行挿入のやりかた 御世話になっております。ExcelVBAで複数の位置に複数のボタンで行を挿入するものを作っているのですが、 "実行時エラー'424'：オブジェクトが必要です"とエラーが出てしまい進みません。 色々調べてみたのですが、どこに不具合があるのか分からず困っております。 コードを載せるのでどの部分が間違っているのか教えて下さい。 ■やりたい事 複数のボタンでそれぞれ特定の位置に行を挿入したい。 ボタンAを押すと押した回数だけAの下に行挿入し、ボタンCを押すと同じく押した回数だけCの下に行を挿入する。 このボタンを計9個作りたい。 ex)Aのボタンを1回、Cのボタンを2回、Eのボタンを1回クリックした場合 A A←この位置へ挿入 B C C←この位置へ挿入 C←この位置へ挿入 D E E←この位置へ挿入 ■現状 A及びCのボタンは動作するが、それ以降(E・F等)のボタンを押すと実行時エラーとなってしまう。 ■コード Dim a_add As Long, c_add As Long, e_add As Long,... Dim c_line As Long, e_line As Long, f_line As Long,... Sub a_add() Range(cells(31,1),Cells(31,21)).select Selection.EntireRow.Insert a_add = a_add + 1 End Sub Sub c_add() c_line = 37+a_add Range(cells(c_line,1),Cells(c_line,21)).select Selection.EntireRow.Insert c_add = c_add + 1 End Sub Sub e_add() e_line = 43 + a_add + c_add Range(cells(e_line,1),Cells(e_line,21)).select Selection.EntireRow.Insert e_add = e_add + 1 End Sub 以下同じように○_lineにa_add+・・・+○_addを入れて 何行挿入されたかを数えて挿入位置を変えています。 よろしくお願いします。
VS Communty 2015のツールチップ。 Visual Studio Communty 2015 のIDE上のアイコン等のツールチップが全く表示されません。何のアイコンなのかクリックするまで分からずツライです。 オプション等を探したのですが設定項目が見つかりません。
VB.NET スプレッドシートのコマンドボタン型セルに画像を表示(非表示)させる フォームにテキストボックスとスプレッドシートがあり、テキストボックスに"a"と入力されている状態でスプレッドシート上のコマンドボタンを押すと、そのコマンドボタンの上に画像が表示される。 また"a"以外のテキストが入力されている場合にコマンドボタンを押すと、画像が非表示になるようなプログラムがあります。 テキストボックスに"a"と入力しいくつかボタンを押し画像を表示させた後、テキストを"b"に変え1か所ボタンを押すとそのボタン上の画像が非表示になるのですが、フォーカスが移動したりマウスポインタが乗っただけでも画像がすべて消えてしまいます。 その後再度テキストを"a"に変えボタンを押すとそのボタン上の画像が表示されるのですが、フォーカス移動等の際に別のボタンの画像も表示されてしまいます。 ボタンを押した行のインデックスが取れればいけそうなのですが、ActiveRowIndexでインデックスを取得してもうまくいきません。 押した(行の)ボタンのみプログラムが実行される方法を教えてください。 SPREAD for Windows Forms 8.0J を使用しています。 よろしくお願いします。
vbaでフォルダの場所を指定する方法 最近エクセルのvbaが非常に重宝しています。そこで、マクロが入ったエクセルをドロップボックスの中に入れ、他のパソコンからでも起動できるようにしようと思ったのですが、 ドロップボックスのパスがパソコンのユーザーネームなどによって少し変わってしまいます。 そこで、「ドロップボックス内の、aaa123というディレクトリをしたいしたい」といった場合、どのように表記するのがよさそうでしょうか？ 詳しい方いらっしゃいましたら教えて頂けますと幸いです。
もしもA列が1もしくは2の場合その行を削除というマクロはどのようなコードを書けばよろしいでしょうか。
ExcelVBA 8桁数字日付のデータチェック お世話になってます。 初歩的な質問かもしれませんがすみません。入力データチェックをvbaで作成しているのですが、タイトルのことでお聞きしたいです。 【前提】 作成したExcelデータに、ボタンを押してチェックを行っています。 このExcelの日付は8桁数字（yyyymmdd）で入力し、 現在はその数字を変数bに入れて未入力か、8桁か、数字かのチェックを行っています。 これに前月の日付（2016年8月の場合は20160801より前の日付）はエラーで返すというチェックを追加したいです。 ただし、当月上旬までは前月の日付で作成します。 この為、「作成する日が当月の5日までは前月日付OK、6日以降は前月日付をエラーで返す」ということにしたいです。 他のチェックがvbaなので、できればvbaでやりたいのですが上手くいきません。 宜しくお願い致します。
マクロ初心者です。参考書をみながら自動記録でマクロをやってみたのですがつまってしまいました。 詳しく分かる方教えてください。シートは12シートあり12品番（1シート １品番）でシート名には品番がはいります。 シート名はセルＡ1に表示されるようにＡ1には関数が入っています。 マクロ内容はお店の売り上げがＪ列に入っていてＳＵＭＩＦで参照？しているのでそのまま並び替えると 値がくるってしまうのでＪ6～Ｊ75（店舗数）をコピーして値貼り付けをしＡ6～ＡＰ75までのデータを並びかえるものです。シート名には最初1～12までの番号が入っており品番に変わります。 シート名1でマクロを組んでみましたがシート名を変えるとエラーで動きません。 またシート名2～12は1をコピーしましたがシート2で動かすと1に戻ってしまいます。 自動記録したマクロです。分かるように教えてください。よろしくお願いします。 Sub 売上() ' ' 売上 Macro ' ' Sheets("1").Select Range("J6:J75").Select Selection.Copy ActiveWindow.ScrollRow = 73 ActiveWindow.ScrollRow = 72 ActiveWindow.ScrollRow = 71 ActiveWindow.ScrollRow = 70 ActiveWindow.ScrollRow = 69 ActiveWindow.ScrollRow = 68 ActiveWindow.ScrollRow = 67 ActiveWindow.ScrollRow = 65 ActiveWindow.ScrollRow = 63 ActiveWindow.ScrollRow = 61 ActiveWindow.ScrollRow = 58 ActiveWindow.ScrollRow = 56 ActiveWindow.ScrollRow = 54 ActiveWindow.ScrollRow = 52 ActiveWindow.ScrollRow = 50 ActiveWindow.ScrollRow = 46 ActiveWindow.ScrollRow = 44 ActiveWindow.ScrollRow = 41 ActiveWindow.ScrollRow = 39 ActiveWindow.ScrollRow = 36 ActiveWindow.ScrollRow = 33 ActiveWindow.ScrollRow = 31 ActiveWindow.ScrollRow = 29 ActiveWindow.ScrollRow = 28 ActiveWindow.ScrollRow = 25 ActiveWindow.ScrollRow = 23 ActiveWindow.ScrollRow = 22 ActiveWindow.ScrollRow = 21 ActiveWindow.ScrollRow = 19 ActiveWindow.ScrollRow = 18 ActiveWindow.ScrollRow = 17 ActiveWindow.ScrollRow = 16 ActiveWindow.ScrollRow = 15 ActiveWindow.ScrollRow = 13 ActiveWindow.ScrollRow = 11 ActiveWindow.ScrollRow = 10 ActiveWindow.ScrollRow = 9 ActiveWindow.ScrollRow = 8 ActiveWindow.ScrollRow = 7 ActiveWindow.ScrollRow = 6 Range("J6").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Application.CutCopyMode = False Range("A6:AP75").Select ActiveWorkbook.Worksheets("1").Sort.SortFields.Clear ActiveWorkbook.Worksheets("1").Sort.SortFields.Add Key:=Range("J6:J75" _ ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal With ActiveWorkbook.Worksheets("1").Sort .SetRange Range("A5:AP75") .Header = xlYes .MatchCase = False .Orientation = xlTopToBottom .SortMethod = xlPinYin .Apply End With ActiveWindow.ScrollRow = 69 ActiveWindow.ScrollRow = 68 ActiveWindow.ScrollRow = 67 ActiveWindow.ScrollRow = 66 ActiveWindow.ScrollRow = 64 ActiveWindow.ScrollRow = 63 ActiveWindow.ScrollRow = 62 ActiveWindow.ScrollRow = 61 ActiveWindow.ScrollRow = 60 ActiveWindow.ScrollRow = 58 ActiveWindow.ScrollRow = 57 ActiveWindow.ScrollRow = 56 ActiveWindow.ScrollRow = 55 ActiveWindow.ScrollRow = 53 ActiveWindow.ScrollRow = 51 ActiveWindow.ScrollRow = 49 ActiveWindow.ScrollRow = 48 ActiveWindow.ScrollRow = 46 ActiveWindow.ScrollRow = 44 ActiveWindow.ScrollRow = 43 ActiveWindow.ScrollRow = 41 ActiveWindow.ScrollRow = 39 ActiveWindow.ScrollRow = 37 ActiveWindow.ScrollRow = 35 ActiveWindow.ScrollRow = 34 ActiveWindow.ScrollRow = 32 ActiveWindow.ScrollRow = 30 ActiveWindow.ScrollRow = 29 ActiveWindow.ScrollRow = 28 ActiveWindow.ScrollRow = 27 ActiveWindow.ScrollRow = 25 ActiveWindow.ScrollRow = 24 ActiveWindow.ScrollRow = 23 ActiveWindow.ScrollRow = 22 ActiveWindow.ScrollRow = 21 ActiveWindow.ScrollRow = 20 ActiveWindow.ScrollRow = 19 ActiveWindow.ScrollRow = 18 ActiveWindow.ScrollRow = 17 ActiveWindow.ScrollRow = 16 ActiveWindow.ScrollRow = 15 ActiveWindow.
エクセルのＶＢＡについて質問です。 ■エクセルのＡ列に画像名が入っています。Ａ 1画像名 2うさぎ 3ねこ 4くま ・ ・ ・ ■あるフォルダ内にたくさんの画像ファイルが保存されています。 （うさぎ.tif ねこ.tif くま.tif いぬ.tif ・・・・・） ＶＢＡを使用して画像名が入っているエクセルのＢ列に Ａ列に入っている画像名と同じ名前の画像を表示したいと思っていますが 可能でしょうか。 ＊Ａ列の画像名は毎回変更されます。 ＊行数（画像名の数）も数十件～数百件と毎回異なります。 ＊画像の大きさは200×200ピクセル～300×300ピクセル程度で画像によりサイズは異なりますが、 エクセルへの表示は60×60ピクセル程度を希望しております。 可能でしたら表示する際に小さく表示したいと思っております。 よろしくお願い致します。
マクロコードのチェックをお願いします。Private Sub cmdYomi_Click() Dim Ret As Long Dim strPhonetic As String If TextBox1.Value = "" Then Exit Sub strPhonetic = Application.GetPhonetic(TextBox1.Value) Do Ret MsgBox(strPhonetic & vbCrLf & vbCrLf & "確定しますか？", vbYesNoCancel) If Ret = vbYes Then TextBox3.Value = StrConv(strPhonetic, vbNarrow) ElseIf Ret = vbNo Then strPhonetic = Application.GetPhonetic() If strPhonetic = "" Then MsgBox "次の候補はありません" Exit Do End If End If Loop While Ret = vbNo End Sub このコードは文字の読みの候補を表示するようなものなのですが、 実行するとRetがエラーとでます。 どのように修正すればよいでしょうか？
VBAでsheet2で下記メッセージボックスを作りたいのですが 、A列の2行目よりデータがあれば 'データは4件です' なければ'データは0件です'と表示させたいです。 A列 B列 りんご 10円 みかん 10円 めろん 30円 ぶどう 20円
マクロでの質問です 同一ブックで元データのA1（文字）と提出データのA列、元データのA7（数値）と提出データのD列が一致した時に一覧シートに表示をしたいのですが元データのA1が"機械"の場合、 提出データの一致するのは 機械 SET と機械+セル内改行+SETとなっています ws = Sheet("元データ") ws1 = Sheet("提出データ") If ws.Cells(1, 1) & "SET" = ws2.Cells(j, 1) And ws.Cells(7, 1) = ws2.Cells(j, 4) Then では一致しません とのような書き方をすればいいのでしょうか
CSVファイルを加工して（不要な列を削除する）、新たなCSVファイルを作成するVBAの製造をしたいです。 VBAに触れたことがないので、簡単に作りたいのでアドバイスいただきたいです。よろしくお願いします。 VBA実行前に、何列目を削除するか選んでCSVを生成するのが理想です。 ちなみに、元のCSVの列数は５６です。
カカトークで、メッセージを送信した後に出る黄色1という数字は何を表しているのでしょうか？（カテがわからないので違うかもしれません…）
excel vbaについて 連立２元１次方程式の解を求めるプログラムを作成せよ。 という問題なのですが、さっぱり分かりません。 行列式を用いるやり方以外で教えて頂けると幸いです。
Vbaにて、 Set FoundCell1 = Z.Columns("B").Find(What:=DateValue(target_date), After:=Cells(2, 2), LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchByte:=False)というB列の日付の検索のコードを書いたのですが、target_date=2016/06/02 の時、うまく検出できて、target_date=2016/06/12 の時、nothingが返されます。target_dateは両方Date型です。 どなたか理由がわかる方、対処法のアドバイスお願いします
特定キーワードをファイル名に含むファイルのみ全て閉じるようにしたいです。 どうすればよいでしょうか？Sub test() Dim wb As Workbook For Each wb In Workbooks MsgBox wb.Name Next End Sub この先の特定キーワードを含むファイルのみ閉じるコードが分かりません。 よろしくお願いいたします。
ACCESSからEXCELへDOCMD.SPREADSHEETでエクスポートする時のシート名に ついての質問です。 a1というシート名でエクスポートを したいのですが、 先頭にアンダーバーが勝手に入ってしまいます。 今はエクスポート後にシート名を 変える処理をして対応しています。 何故こういった処理が入るのかと良い対処 方法があれば教えて下さい。宜しくお願い致します。
実行時に生成・配置されたコントロール（ラベル）に対して操作したいです。（VB） VisualBasicを勉強中です。 VisualStudio2013を使用しています。〇x〇マス状に配置したコントロール（今回はラベル）のうちの、特定のラベル対して、上下両隣のラベルのテキスト内容を判定して、テキスト内容を書き換えるという命令を書きたいのです。 たとえばこんな感じです。↓ □□□□□□■ □□□□□□□ □■■□□□◆ □□□□□□□ ラベルのコントロールをプログラムの作成段階で配置していれば、コントロール名を配列にして（？）、それぞれのマス（ラベル）に対して順番に判定していくということができると思います。 ただし、今回はプログラムを実行後に、「〇x〇」の部分を使用者にテキストボックスから入力させてそれをもとにマスを作成するようにしたいのです。任意のサイズになります。 プログラム作成中には、実行後に何個のコントロールが配置されることになるのか不明です。 多分、大事なことは下記のことと思っています。 １、プログラム実行時に作られたコントロールの名前？を取得すること ２、その名前のコントロールが配置された座標？（どのマスのラベルなのか）がわかること どのようにすればよいのか教えてください。 よろしくお願いします。
Excel (2013)使用で Find メゾットを使用したデータ検索値の行の特定列の値を表示する方法についてお願いします。A列に通し番号、Ｂ列に顧客名、Ｃ列にメイン営業所名、Ｄ列に期限、E列にサブ１営業所、Ｆ列に期限、Ｇ列にサブ２営業所、Ｈ列に期限が表記してあるリストがあります。 このリストから営業所名を検索して営業名と期限とＢ列の顧客名を表示したいと思います。 営業所名と期限は表示出来たのですが検索結果の行にあるＢ列の顧客名を表示する方法がわかりません。ご教示お願い致します。 入力フォームを使用しています。 最終的にはSHEET2ではなくリストボックスに表示したいです。 Private Sub CommandButton1_Click() Worksheets("Sheet2").Activate Cells.Clear Sheets("Sheet1").Select Dim FoundCell As Range, FirstCell As Range Dim firstAddress As Variant Set FoundCell = Cells.Find(TextBox1, LookIn:=xlValues) If TextBox1 = "" Then MsgBox "データを入力してください！" Exit Sub End If If FoundCell Is Nothing Then MsgBox "見つかりません" Exit Sub Else Set FirstCell = FoundCell ここを変えたい！ → （FoundCell）.Copy Sheets("Sheet2").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0) FoundCell.Resize(1, 2).Copy Sheets("Sheet2").Cells(Rows.Count, 1).End(xlUp).Offset(0, 1) End If Do Set FoundCell = Cells.FindNext(FoundCell) If FoundCell.Address = FirstCell.Address Then Exit Do Else ここを変えたい！ → （ FoundCell） .Copy Sheets("Sheet2").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0) FoundCell.Resize(1, 2).Copy Sheets("Sheet2").Cells(Rows.Count, 1).End(xlUp).Offset(0, 1) End If Loop Sheets("Sheet2").Select End Sub
VBで平滑化フィルタを作っているのですが、自分で作ってみたところうまくいきません。 どう訂正すればよいでしょうか？Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click Dim bmpa As Bitmap = PictureBox1.Image Dim bmpb As Bitmap = New Bitmap(PictureBox1.Width, PictureBox1.Height) Dim iroa, irob As Color Dim i, j, k, l, m, n, sumR, sumG, sumB As Integer For i = 0 To PictureBox1.Width - 1 k = i - 1 m = i + 1 For j = 0 To PictureBox1.Height - 1 l = j - 1 n = j + 1 For k = k To m For l = k To n If k < 0 Or l < 0 Then ElseIf k > PictureBox1.Width Or l > PictureBox1.Height Then Else iroa = bmpa.GetPixel(k, l) sumR = sumR + (Val(iroa.R)) / 9 sumG = (Val(iroa.G)) / 9 + sumG sumB = (Val(iroa.B)) / 9 + sumB End If Next Next irob = Color.FromArgb(sumR, sumG, sumB) bmpb.SetPixel(i, j, irob) Next Next PictureBox2.Image = bmpb End Sub
前回は、丁寧なご回答誠にありがとうございました。 回答期限が過ぎてしまいましたので、再び質問させて頂きたいと思います。 もし、お時間があればご回答して頂けたら幸いです。早速のご回答、誠にありがとうございます。 作っていただいたマクロの前提に 「A列に、参照先の"ファイル名の一部が含まれている"場合」ということを付け加えることは出来ますか。 A1にtest1.html A2にtest2.html A3にtest3.html と入っていた場合、フォルダー C:\A\配下に test1abcabc.html test2abcbbb.html test3abaaaa.html と一部が含まれている場合リンク付される 非常にややこしく、何度もお手数をお掛けしていますが 何卒よろしくお願いいたします
エクセル2010 コンボボックス マクロ、VBAの書き方について教えてください。倉庫A-1、A-2、A-3、A-4、A-5、A-6、A-7、 倉庫B-1、B-2、B-3、B-4、B-5、B-6、B-7、 倉庫C-1、C-2、C-3、C-4、C-5、C-6、C-7、 倉庫D-1、D-2、D-3、D-4、D-5、D-6、D-7、 倉庫E-1、E-2、E-3、E-4、E-5、E-6、E-7、 倉庫F-1、F-2、F-3、F-4、F-5、F-6、F-7、 があるとします。 シート2のU2：V5を コンボボックスを使って、倉庫A-1を選択したら、 倉庫AのシートAZ11：BA14に値で貼り付け シート2のU9：V12を コンボボックスを使って、倉庫A-2を選択したら、 倉庫AのシートAZ18：BA21に値で貼り付け シート2のU16：V19を コンボボックスを使って、倉庫B-3を選択したら、 倉庫BのシートAZ25：BA28に値で貼り付け と言ったような事は可能でしょうか？
ＬＡＮ上の他パソコンのソフトを操作する vba よくお店や病院にある、番号発券機ならびに液晶掲示板をエクセルVBAとPOWERPOINTを使って作ろうと思っています。そこで、1台目の発券機用PCは「来客ボタン」をvbaフォームで作成し、LANで接続させた2台目の液晶掲示板用PCには「来客人数ならびに呼び出し番号」をpowerpointでフルスクリーン表示させたいと思っております。 ですが、発券機用PCからLANで接続させた液晶掲示板用PCにあるpowerpointに、発券データ（件数）等vbaで転送？操作？するのは可能でしょうか？ よく、ＨＰを検索しても「外部アプリを操作する」と出ますが、すべて自ＰＣ内の事で他ＰＣの事までは見当たりません。 また、いつもその場にいるわけじゃないので遠隔操作などの手段は使えません。 直接powerpointを操作できなくても、ＵＷＳＣのようなソフトや、他の操作方法がありましたら教えていただけますでしょうか？ また、すこしvbaをかじったくらい（少し読める？)の素人な為、言語は申し訳ないですがvbaしかわかりません。 もっと私にも簡単にわかる他の方法があったり、仕組みを変えるなどのアドバイスがあればよろしくお願いいたします。
VS2015 VC++について教えて頂きたく。 只今、フォームアプリにてOpenCVを使ったのアプリを作っています。 BMPを読み込み、CSVに輝度データを書き込む処理をしています。コンソールアプリでビルドした際は正常動作しましたが、 フォームアプリではコンパイルが通りません。 ofs << gray << "\t"; と ofs << endl; の部分をコメントアウトすると通るので、この部分が原因と思うのですが。 他の書き込み方法あるいは、コンパイルを通す方法などの解決方法があれば教えて下さい。 当方は、c++の勉強を最近したばかりの初心者です。 画像処理に興味があり、駆け出し中です。 どうかご教示頂きたく。 下記プログラムです。 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー #include "MAKECSV.h" // クラス Cmakecsvの定義ヘッダ #include <opencv2/opencv.hpp> // インクルードファイル指定 #include <opencv2/opencv_lib.hpp> // 静的リンクライブラリの指定 #include<iostream> //入出力ライブラリ #include<fstream> //iostreamのファイル入出力をサポート using namespace System; using namespace System::Windows::Forms; using namespace std; using namespace cv; // 名前空間の指定 void Cmakecsv::makecsv() { MessageBox::Show("makecsv()を実行"); Mat img = imread("test.bmp", 1); // 画像の読み込み if (img.data == NULL) MessageBox::Show("img.data == NULL"); int length_X = img.cols; int length_Y = img.rows; ofstream ofs("Test.csv"); //ファイル出力ストリーム for (size_t j = 0; j < length_Y; j++) { for (size_t i = 0; i < length_X; i++) { cv::Vec3b bgr = img.at<cv::Vec3b>(j, i); int b = bgr[0]; int g = bgr[1]; int r = bgr[2]; double gray = (double)(b + g + r) / 3; ofs << gray << "\t"; } ofs << endl; } } ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー
VBAでデスクトップアイコンについての質問です。 フリーソフトではよくある、アイコン位置の保存、復元機能を 作ろうとしています。http://okwave.jp/qa/q5525027.html こちらに位置を取得する方法が記載はあるのですが インデックス番号で指定するようになっているので使えません。 ファイル名もしくはアイコン名を取得して位置の取得や変更を する方法はありませんでしょうか？
EXCEL VBA初心者です。 練習で以下のコードを書いてみたのですが、上手く行かないので どなたかご教授お願いします。【コードの内容】 A列（Tokyo と Osaka） B列（Shinagawa と Tosabori） がランダムで入力されている表があります。 ”Tokyo” と ”Shinagawa” だけをフィルタリングして、 値をクリアします。 残った”Osaka” と ”Tosabori”をフィルタリングした状態で、 可視セルをコピーしてクリップボードに格納します。 表の全値をクリアしてから、クリップボードにの中身を 貼り付けます。 ★結果は何故か表ではなく TRUE の文字が表示されて しまいます。 ************************************************** Sub test1() Worksheets("Sheet1").Activate Range("A1").CurrentRegion.Select Selection.AutoFilter Selection.AutoFilter Field:=1, Criteria1:="Tokyo" Selection.AutoFilter Field:=2, Criteria1:="Shinagawa" Selection.Offset(1, 0).Select Selection.Resize(Selection.Rows.Count - 1).Select Selection.EntireRow.ClearContents Selection.AutoFilter Range("A1").CurrentRegion.Select Selection.AutoFilter Selection.AutoFilter Field:=1, Criteria1:="<>" Dim CB1 As Variant Dim CB2 As Variant Dim CB As New DataObject CB1 = Range("A1").CurrentRegion.SpecialCells(xlCellTypeVisible).Copy With CB .SetText CB1 .PutInClipboard End With With Range("A1") .CurrentRegion.Select Selection.EntireRow.ClearContents Selection.AutoFilter End With With CB .GetFromClipboard CB2 = .GetText End With Range("A1").Select ActiveSheet.Paste Application.CutCopyMode = False End Sub **************************************************
エクセルＶＢＡで次のことをしたいのですが詰まってしまっています。 かなりの初心者なのですがやりたい事が複雑で困っています。 ①銀行のＨＰからある数値を取得。「りそな銀行 外国為替公示相場」 http://www.resonabank.co.jp/kojin/market/spotrate.html 箇所はＵＳドルの右の仲値です。 ②それをBOOKを開いたと同時にＩＥを立ち上げて セルに張り付け。 ③毎日行うので次の日開いた時には昨日のセルの下に貼り付け。 翌々日、またその下に貼り付け。 コレを毎日繰り返しグラフに反映したい。 以下、私が初心者なりに頑張って書いたのですが的外れな感じがしているので ご教授頂ければ幸いです。 -------------------------------------------------------- Sub sample2() Dim i As Long Dim j As Long Dim objITEM As Object Dim objIE As New InternetExplorer objIE.Visible = False objIE.navigate "http://www.resonabank.co.jp/kojin/market/spotrate.html" Call untilReady(objIE) Range("A1").CurrentRegion.Offset(1, 0).ClearContents i = 2 j = 1 For Each objITEM In objIE.document.getElementsByTagName("td") Cells(i, j) = objITEM.innerText j = j + 1 If j > 10 Then j = 1 i = i + 1 End If Next objIE.Quit Set objITEM = Nothing Set objIE = Nothing End Sub Sub untilReady(objIE As Object, Optional ByVal WaitTime As Integer = 10) Dim starttime As Date starttime = Now() Do While objIE.Busy = True Or objIE.readyState <> READYSTATE_COMPLETE DoEvents If Now() > DateAdd("S", WaitTime, starttime) Then Exit Do End If Loop Sheets(1).Range("C2").Copy Sheets(2).Range("A1") End Sub
Datatableに取り込んだエクセルファイルの中身全てをString型に変換したい。Datatableにエクセルファイルの中身を取り込む処理を書いたのですが、列に文字列と数値型が混在している場合、数値型の値しか取り込まれないで困っております。 解決手段としては、エクセルファイルを読み込むときに数字項目であろうが文字列型に変換してDatatableに書き込む方法だと考えておりますが、select シート名で取り込んだエクセルファイルの中身を文字列に変換してDatatableに書き込むことは可能なのでしょうか。 以下、イメージ ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー 取り込み元エクセルファイル ◎Col_AAA｜Col_BBB｜◎Col_CCC ーーーーーーーーーーーーーーーーーー 1111｜ 2222｜ CCA ーーーーーーーーーーーーーーーーーー AAA ｜ 2223｜ CCB ーーーーーーーーーーーーーーーーーー 1121｜ 2224 ｜ CCC ーーーーーーーーーーーーーーーーーー 理想の出力状態 ◎Col_AAA｜Col_BBB｜◎Col_CCC ーーーーーーーーーーーーーーーーーー 1111｜ 2222｜ CCA AAA ｜ 2223｜ CCB 1121｜ 2224 ｜ CCC 実際の出力状態 ◎Col_AAA｜Col_BBB｜◎Col_CCC ーーーーーーーーーーーーーーーーーー 1111｜ 2222｜ CCA [空白]｜ 2223｜ CCB 1121｜ 2224 ｜ CCC 以下、ソースファイル ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー Try 'Excelのコネクションを接続を設定し、開始する Dim eCommand As OleDbDataAdapter Dim eConnection As OleDbConnection eConnection = New System.Data.OleDb.OleDbConnection( _ "provider=Microsoft.ACE.OLEDB.12.0; " & _ "data source=" & filePath & "; " & _ "Extended Properties=Excel 12.0") eCommand = New System.Data.OleDb.OleDbDataAdapter( _ "select * from [" & シート名 "$]", eConnection) 'データテーブルに書き込む dTableInport = New DataTable eCommand.Fill(dTableInport) 'Excelコネクションの接続を終了する eConnection.Close() Catch ex As Exception MessageBox.Show("エクセルファイル呼出の際にエラーが発生しました。", _ "Excelファイル呼出エラー", _ MessageBoxButtons.OK, _ MessageBoxIcon.Error) End Try ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー 大変お手数をおかけいたしますが、ご教授いただければ、幸いです。
ACCESS VBAで年数計算をしたいのですがdatediffで、小数点まで計算する方法はないでしょうか また、年数の計算で、?datediff("yyyy","2000/1/1","2000/12/31") とすると、ちょうど1年と計算したいのですが 0になってしまいます ?datediff("yyyy","2000/1/1","2001/1/1") であれば、1年と1日なので 1.0027397260274年(こんなに小数点は細かくなくていいですが)としたいのですが、 1としか出てきません 何かアクセスの関数でいい関数はないでしょうか
Googleスプレッドシートに関してです。Sheet1からSheet2に特定の文字列（例えば、みかん）を含む複数のデータを抽出させたいのですが、 =query('Sheet1'!A2:AG, "select * where B='みかん'") とSheet2に入力し、Sheet1のB列に'みかん'と打っても、Sheet2に反映されません。 何か間違っているのでしょうか？ 教えてくださればありがたいです…。
VBプログラムのCD配布について VB.NET初心者です。よろしくお願いいたします。VB.NET2012でプログラムを開発し、 CDにEXEファイルを焼いて配布し、 配布先でCDから直接起動できるようなシステムを考えています。 VISTA以降であれば.NET Frameworkがインストールされているはずなので、標準のコントロールであればEXE単体で動くと思うのですが、いかがでしょうか。 また帳票は、 iTextSharpやiTextNet等のpdf出力コントロールを使えば、 システムインストール作業なしで、動作しますでしょうか。 よろしくお願いいたします。
お世話になっています。マクロでのオートフィルについて質問です。 ひとつのセルに『aaa.bbbb.eee.abc0528.eee38』 と文字が入っています。 『aaa.bbbb.eee.abc0529.eee39』 のようにオートフィルすることは可能でしょうか？ A列にこの文字列があるので、B列の最終行と同じ行までオートフィルしたいです。 よろしくお願いします。
マクロ初心者です。 A列に顧客の番号が入ってあります。 C列に顧客の購入商品のコードが入っています。 A列 B列 C 1011 5944 1011 59371011 5938 1022 5937 1023 5938 . . . . . . d1セルに特定の商品コードを入力して その商品を購入した顧客番号列は色付けしたいのです。 (たとえば5938の場合はa4セルだけでなくa2a3セルも色付けしたい) これが20000行くらいまで続いています。このようなとき、どのようなマクロを書けばいいのでしょうか。 簡単なのかもしれませんが、さっぱりわかりません。よろしくお願いいたします
エクセルVBAでハイパーリンクからChoromeで指定ページを立ち上げる際、 完全にWebページが立ち上がってから処理(Call 処理とします)したいと思います。 ビジー状態待機を行いたいです。A1にハイパーリンク設定済みのデータが入力しております。 現在はだましだましでウェブページ立ち上げのときに3秒待ってから Call 処理 を行っております。 たまにウェブページが立ち上がるのに3秒以上かかる時にエラーが起きてしまいます。 これを完全にページが立ち上がってから Call 処理をしたいです。 以下現在のコードです。 Sub ハイパーリンクページ立ち上げ実行() Range("A1").Select Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True Application.Wait Now + TimeValue("00:00:03") Call 処理 End どのように修正すればいいか教えていただけるとありがたいです。 ちなみに ハイパーリンク設定済みのセルをクリックすると Chorome で立ち上がるように設定済みです。
Excel 2010を利用しています。Sub AAAA() Dim strURL As String strURL = InputBox("URLを指定", "URL入力", "http://www.yahoo.co.jp/") Dim objIE As Object Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True objIE.Navigate = strURL While objIE.readyState <> 4 Or objIE.Busy = True DoEvents Wend objIE.ExecWB 17, 0 objIE.ExecWB 12, 0 Sheets("住所").Select ActiveSheet.Range("A1").Select ActiveSheet.PasteSpecial Format:="Unicode テキスト" objIE.Quit Set objIE = Nothing End Sub InputBoxにURLを入力して、表示されたIEのページを全選択、コピー、貼り付けしたいのです。 -- Dim strURL As String strURL = InputBox("URLを指定", "http://www.yahoo.co.jp/") objIE.Navigate = strURL このメゾットはサポートしていませんとなります。 この部分をどのように改善するのか、ご教示お願いします。
Excel2010を利用しています。Dim objIE As Object Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True objIE.Navigate "http://news.yahoo.co.jp/" While objIE.readyState <> 4 Or objIE.Busy = True DoEvents Wend objIE.ExecWB 17, 0 objIE.ExecWB 12, 0 Sheets("住所").Select Range("A1").Select ActiveSheet.PasteSpecial Format:="Unicode テキスト" objIE.Quit Set objIE = Nothing このコードを利用すると、アプリケーション定義、またはオブジェクト定義エラー エラー 400 となります。 どこがだめなのか、ご教示しただけないでしょうか？
エクセルのVBAでの質問です。 下記のような物を書いたのですが、現在ではセルが変更されたら実行されようになっています。それを、10秒毎に繰り返し実行したいのですがやり方がわかりません。自分なりに調べてやってみたのですがオブジェクトがありません等のエラーが出てしまいダメでした。具体的な文を書いてもらえると助かります。お願いします。 Private Sub Worksheet_Change(ByVal Target As Range) Select Case Target.Address(0, 0) Case "A1" ActiveSheet.Shapes("図形１").Select Case "A2" ActiveSheet.Shapes("図形２").Select Case Else Exit Sub End Select Select Case Target.Value Case Is >= 150 Selection.ShapeRange.Fill.ForeColor.SchemeColor = 8 Case Is >= 100 Selection.ShapeRange.Fill.ForeColor.SchemeColor = 12 Case Is >= 50 Selection.ShapeRange.Fill.ForeColor.SchemeColor = 10 End Select Target.Select End Sub
EXCEL VBAで、例えばA1セルにAと入っていたらA2セルにはB、Bと入っていたらCといったように、アルファベットを一つ増やす？にはどういったコードを使えばいいのでしょう？
Visual Studioについて質問です。 あるツールを使うために設定が必要なのですが、どこに書き込めばいいのでしょうか？ <add key="AuthType" value="省略"> <!--説明？--> また、記入したら次に「build and go （CTRL+F5）」と説明に書かれていたのですが、反応がありません。どのようにすれば良いでしょうか？初歩的な質問ですが、よろしくお願いします。
エクセルのマクロを使って以下のことがしたいです。 sheet1のA列に以下のリストがあります。____A列 01_さんまイワシ 02_玉ねぎ大根 03_牛肉豚肉 04_鯛 05_ほうれん草キャベツ 06_レンコン sheet2にA列に以下のリストがあります。 ___A列 01_さんま 02_イワシ 03_鯛 04_ほうれん草 05_キャベツ 06_牛肉 07_鶏肉 08_豚肉 09_レンコン 10_玉ねぎ マクロ実行後、以下のようにsheet2のA列の文字列を含むセルをsheet1のB列以降に表示させたいです。 ___A列_________________B列_________C列 01_さんまイワシ________さんま______イワシ 02_玉ねぎ大根__________玉ねぎ 03_牛肉豚肉____________牛肉________豚肉 04_鯛__________________鯛_ 05_ほうれん草キャベツ__ほうれん草_キャベツ 06_レンコン____________レンコン 教えてください。 よろしくお願いいたします。
エクセル（VBA)でフォルダー配下のすべてのファイル名を一覧で表示したいのですがどのようなプログラムにしたらよいか教えてください。単一フォルダー配下の一覧は作成することができましたが、配下フォルダーまでを対象とした場合どのようにしたらよいかわかりません。 あと、「見出しを付ける」にフォルダ名も追加したいです。 Sub MakeFileList() Target = InputBox("ディレクトリ名を入力", "ディレクトリの指定", "C:\Windows") Set FS = CreateObject("Scripting.FileSystemObject") Set Fol = FS.GetFolder(Target) Set Fil = Fol.Files ThisWorkbook.Sheets("Sheet1").UsedRange.Delete '見出しを付ける ThisWorkbook.Sheets(1).Range("B2") = "ファイル名" ThisWorkbook.Sheets(1).Range("C2") = "ファイル種別" ThisWorkbook.Sheets(1).Range("D2") = "最終更新日" ThisWorkbook.Sheets(1).Range("E2") = "説明" ThisWorkbook.Sheets(1).Range("B2:E2").Interior.Color = RGB(0, 0, 0) ThisWorkbook.Sheets(1).Range("B2:E2").Font.Color = RGB(255, 255, 255) ThisWorkbook.Sheets(1).Range("B2:Es2").HorizontalAlignment = xlCenter i = 3 For Each Fx In Fil 'ファイル名 sFile = Fx.Name 'ファイル名の書き出し ThisWorkbook.Sheets(1).Cells(i, 2) = sFile 'ファイル種別 sFType = Fx.Type '最終更新日時の書き出し ThisWorkbook.Sheets(1).Cells(i, 3) = sFType '最終更新日 sLMod = Fx.DateLastModified ThisWorkbook.Sheets(1).Cells(i, 4) = sLMod i = i + 1 Next End Sub よろしくお願いします。
ExcelのVBAのソート、行の並べ替えについてご教授願います。 1234…と行があります。 これが、11122233344455…と縦に並んでいます。 これを、12345123451234…とVBAで行を並べ替えたいのですが、どうすればいいでしょうか。 ・複数ではない場合、例えば一つのみとか、全てが同じ数ではない場合も可能でしょうか。例1112222344 また、念のためですが、VBAではなく、関数では無理ですよね。よろしくお願いします。
vb2008にてクエリビルダを使用して日付型の検索を行うにはどうしたら良いのでしょうか？フィルタ項目にネットで検索してBETWEENとかクエリに書き込んでみたものの、書き方が悪いのか上手くいきません。 to_date関数が必要とか有効な日付型に変換できませんとかエラーが出てしまいます。 やりたいことは、データグリッドビューをDateTimePickerなどを使い検索抽出したいです。 また、同じように期間検索もしてみたいです。 テキスト検索の様にパラメーター等の設定などが必要なのでしょうか？ 初心者なので解りやすく、ご説明いただけると嬉しいです。 助けて下さい。よろしくお願いいたします。
＊精神障害者２級36歳でphotoshopとか使った仕事やりたいのですが。。。僕は重度の双極性のある非定型鬱病、精神障害者手帳2級なのですが、 父親が全く理解がなくて、それでもって言葉とネグレクトのDVされ続けて来ました。 物心付く前の子供の頃からいつもいつも父親に愛されようとして、キャッチボールをたまにしたりして良い関係（ラポール）が築けたと思うと、数週間後には癇癪を起こして当たられ、夫婦ゲンカしてたので また気まずい雰囲気になってしまい、「僕はせっかく愛されたと思ったのに裏切られた」と解釈して それが思春期まで続き、「もう、あの父親には何を行動してもダメな人だ」と思い父親との接触は避けてき続けました。 それで こないだ「税金払ってないで病気で情けないよ！！（怒）お前と一緒にいると気分が悪くなるよ！！早く就職しろよ！！（怒）」 と言われて僕が一緒にいると父親の気分が悪くなるということで、僕の存在意義はなくなり、体調的にまだ不安定ですけど 何でもいいから働いてやる！！ と思いました。 また服毒自殺をしようかと悩んだりもしました。でも薬じゃ死ねないことが何回もやってみてわかったので、いざという時には首吊りをと決心してます。 ・なお、私は、腰が酷く悪くギターも弾けなくなってしまった位、作業所のテーブル拭きをする位で腰が痛くなる状態です。 ・また、体力が虚弱体質で著しくないです。 ・高校くらいから人間関係と学業がダメになり多分ストレスで記憶障害になってきまして、昨日作った、晩御飯なんだったのか思い出せません。 ・なので"煮ても焼いても仕事ができない人間”なのようなのです。コンビニも松屋も経理の仕事も清掃の仕事も全部クビになりました。 そこで、唯一、僕の長所として感性がいい、中学の頃から今までほとんど楽器やってました。オールジャンルでクラブ系からクラシックのマニアックな現代音楽も理解できます。 なので、体はダメでも感性が長所になる仕事にバイトでしかですが、就こうとひらめきました。 まず付きたい職場は、作業所で例えば、こんな会社です。 https://www.hellowork.go.jp/servicef/139520.do?screenId=139520&acti... なお自分が言ってる作業所は時給150円です。昼飯、節約でたべません。 web系の仕事がよく存じ上げないのですが、 なんというか僕がやりたいのは写真を撮ったり、加工したりwebデザインをしたりすることです。 １．そのためには、やはりPhotoshopとIllustratorの資格か何か必要なのでしょうか？ ２．この歳で障害者雇用のバイトでも雇ってくれますでしょうか？ 3.web関係の仕事で残業がキツイと聞きますが 殆ど無いという話を知人に聞いたのですが、実際の所、会社は何割くらいの確率で酷い残業（１時間異常）ありますでしょうか？体力が甚だないので、また長時間イスに座っていることが腰にくるのか不安です。 4.長時間イスに座っていて腰が痛くなるか不安です。とりあえず作業所で座り仕事４時間半は大丈夫ですが家に帰ってからネットをやってると腰が痛くなってく時があります。 この質問の4項目の内、どれかでもわかるお方がおられましたら 本当にご教授お願い致します。助けてください。
A1セルからJ1セルに特定の文字を出力する方法とかないでしょうか。 例えば 商品番号 商品名 値段 備考………… ↑ こんな感じでA1〜J1セルに記入したいです。 VBAでつくりたいです。 マクロの記録だとコードが長すぎました。 超ど素人なので知恵をお借りしたいです、、
以下のB列とD列で"1"と"みかん"が入力されといる行の削除をしたいのですが、どのような作り方をすればよいでしょうか？ A列 B列 C列 D列 場所 品名 値段 コード 東京 みかん 10円 3 名古屋 りんご 20円 1 大阪 りんご 20円 4 熊本 ぶどう 10円 1
エクセルで次のようなことをしたいです。 出席表というブックがあり、同じフォルダにタイトルが日付(例：20160729)のCSVファイルがたくさんあります。A1には会議の日付が2016/07/29というふうに入っており、A２には会議名（全角）が入っています。 B列以降、１列目には会議の出席者の名前（すべてのCSVファイル共通）、２列目には出席状況（出席ならば１、欠席ならば２、途中参加（中抜け）は３）が半角数字で入っています。 このCSVファイルを出席表というブックのシート１に読み込ませ出席状況の一覧を作り、集計をさせたいです。 なお、集計はシート２で行うのでシート１は出席状況の数字がずらっと並ぶようにしたいです。 出席表ファイルのA列にはすでに名前が入っており、B列以降に読み込ませたCSVの出席状況の数字を日付順に読み込ませて行きたいのです。 （例）フォルダの中に20160720.20160721,20160723というファイルがあった場合 B列に７月２０日のファイルを、C列に７月２１日のファイルを、D列に７月２３日のファイルをという感じです。 なお、CSVファイルにはB列にしか出席状況は入っていません。 A列２～５１が名前、B列２～５１が出席状況の数字（１～３）が入っています。 これはすべてのCSV共通です。 さらに、例えば後から７月２２日のファイルがフォルダに追加された場合、D列を７月２２日、E列を７月２３日にというふうに読み込ませる段階でしたいのです。 シート１の読み込み部分のマクロをどのように作ればいいか教えていただければ幸いです。 説明に分かりづらい部分があるかと思いますので、随時補足して行きます。
Vba にて、5秒間隔で一ヶ月間取得したデータを1日ごとに別のブックで保存したいため、マクロを組もうと思います。そこである列に日付が格納されているため、その列内を上から対象日を検索して、まず1番始めの行番号を取得し、次にブックの最下部から検索して、対象日の1番下の行番号を取得して、コピーする範囲を選択しようと思います。 この部分はどのように書けばいいでしょうか。 また、これ以外に画期的な範囲の定め方があればその考え方をご教授いただけませんでしょうか
Vba において、A列を上から順に検索していって、目的の数値が格納してあるセルが見つかったら、そのセルの行番号のみを変数に格納したいのですが、find文を使って書いているのですが、うまくいきません。どなたかおしえてください。
Vbaにて、次のコードでZで指定したシートからHで指定したシートにコピーして貼り付けようと思います。Z.Range(Cells(FoundCell1.Row, 1), Cells(FoundCell2.Row, 116)).Copy H.Range(Cells(3, 1), Cells(3 + (FoundCell2 - FoundCell1), 116)).Paste しかし、コピーまではうまくできているのですが、貼り付けが実行されません。なぜでしょうか？
VB6.0のChangeイベントについてお教えください。フォームが表示された空のテキストボックス（AdvMaskEd）の内容が変更または打鍵、 されたら処理を開始して、打鍵された内容がある条件に合わなかった時にエラーを表示 するというような処理を実現したいです。 Changeイベントが一番妥当だと思うのですが、 Private Sub テキスト名_Change() End Sub 上記の様に書いてブレークポイントを指定した状態で、 対象の空のテキストボックスに数字を入力しても、 見に行かずスルーされて値が確定してしまします。 試しに他のイベント（Click等）を試してみたのですが、 これは正常に見に行きました。 なぜかChangeだけうまくいかないのですが、 何か考えられる原因はございますでしょうか。 宜しくお願い致します。
エクセル2013でＶＢＡを使ってＱＲコードの作成 他のツールを使わずにBarcode controlだけを使って ＱＲコード作成する方法を教えてください。マクロの記録を使って作成しようとしましたが うまいこといきませんでした。 例えばＡ列に並んでいる数字の横のＢ列にＱＲコードを作成する方法 教えてください。 質問内容から分かると思いますが ＶＢＡ初心者ですので易しい説明でお願いします。
こんにちは。VBA で、A2セルと、A5セルから下に文字が入っているところまでを選択して、セルの中身をデリートするという式を教えていただけませんでしょうか。 説明が下手で申し訳ございませんがどうぞよろしくお願いいたします。
Twitterのデータ（エクセルデータ）を分析したいと考えております。データはA、B、C、D、E列に入っており、１行目はその列のデータの名前を表しています。また、データは３万行あります。ここから質問なのですが、D列にツイートが入っているのですが、そのツイートの中からある単語を含む行だけを抽出し、別のシートまたは、別のファイルに書き出すコードを教えていただきたいです。単語の例としては、楽しい、悲しい、うれしい、不安など感情を表す単語を考えています。 また、指定する単語が２００種類あるのですが、VBAで200回抽出する作業を自動化するコードも教えていただけないでしょうか？ 単語はテキストファイルにまとめてあります。 以上、よろしくお願いいたします。
Excel課題のC33、D33、E33、のセルの入力の式が分かりません。分かる方いましたらお願いします！
ハイパーリンクに関するVBA についてどなたかお知恵をお貸しいただけませんでしょうか。A2セルに入力されたアドレスをあらかじめマクロを登録したボタンを押すとメール作成画面にリンクするという、VBA を作成できませんでしょうか。 ちなみにA2セルに入力されているアドレスは、別のセルから参照してきた結果を表示させているので、 通常のエクセルのハイパーリンク機能では対応できないのです。。 どなたかお知恵をお貸しいただけると幸いです。 どうぞよろしくお願いいたします。
【VBA】別のブックへシートをコピーする方法について教えてください ThisWorkbookのA1～A10に開きたいブックのアドレスが入力されています。1 ブックを開いて 2 リストという名前のシートを削除 3 ThisWorkbookのリストというシートを開いたブックにコピー 4 ブックを保存して閉じ、以下1からA10のブックまで繰り返し 上記の動作をさせたいのですが、A1からA10までを繰り返し処理する方法が わかりません。初歩的な事で大変申し訳ありませんが 教えていただけませんでしょうか。 宜しくお願いします。 Sub シート() Dim bk As Workbook Set bk = Workbooks.Open(Filename:="C:\Book1.xls", ReadOnly:=False, IgnoreReadOnlyRecommended:=True) Application.DisplayAlerts = False bk.Worksheets("リスト").Delete ThisWorkbook.Worksheets("リスト").Copy _ After:=bk.Sheets(bk.Sheets.Count) bk.Save bk.Close Application.DisplayAlerts = True End Sub
VB6のコマンドとVisual Studio 2015のVBのコマンドの対応を教えてください。
エクセルのＡ１に 福田 福助 住所 〒0010073 香川県 高松市 香西6-25-5 というデータが入っています。これを 〒0010073 香川県 高松市 香西6-25-5 福田 福助さま と変換するマクロはありますでしょうか？ よろしくお願いします。
エクセルマクロ VBA について質問です。 シート名で、指定した完全一致する名前の場合に、 決められたセルに各特定の文字を入力したいです。 以下内容です。複数のエクセルファイルがあり 保有するシート名はそれぞれ異なります。 A-A、A-B、A-Cの3種類の文字を含むシートがあり、 シート名にA-Aの場合は、AY1セルに「1」と入力。 シート名にA-Bの場合は、AY1セルに「2」と入力。 シート名にA-Cの場合は、AY1セルに「3」と入力。 又、ファイルによっては「A-1」以外にも、 「Z」とゆう全く別の名前のシートを 複数保有している場合もありますが その場合は、シート名が完全一致するシート以外は、何も実行させたくないです。 具体的にどのように書いたらよいでしょうか。 宜しくお願いします。
オートメーションエラーです。（実行時エラー'2147221080(800401a8)':） このエラーの解決方法を教えてください コマンドプロントで「regsvr32 C:\Windows\System32\MSCOMCTL.OCX」と入力しましたが特に変化ありません。 下記はエラーが出たコードの一部です。 Set wb(0) = Workbooks.Open(Filename:=PName & FName1, ReadOnly:=True) Set wb(1) = Workbooks.Open(Filename:=PName & FName2, ReadOnly:=True) Set wb(2) = Workbooks.Open(Filename:=PName & FName3, ReadOnly:=True) Set wb(3) = Workbooks.Open(Filename:=PName & FName4, ReadOnly:=True) For i = 0 To 3 For Each sht In wb(0).Worksheets cp wb(i), sht.Name, TextBox1.Text, i Next sht Next i ＞ For Each sht In wb(0).Worksheets F8で一行ずつ動かしてみましたが、毎回この部分でエラーが出ます。 どうしたらよいのでしょうか。お助け下さい。
初めて質問させていただきます。VBA初心者のためどなたかお知恵をお貸しいただけませんでしょうか。 エクセルでA5セルから順にアドレスを貼り付けたら、カンマで連結させてA2セルに表示させる というVBA の式を教えていただけませんでしょうか。 ちなみに、A5から貼り付けるアドレスは、その時々で貼り付ける量が違います。 A5〜A10までだったり、A5〜A15だったり。 貼り付けてからマクロを指定したボタンをクリックしたらA2セルに連結表示させるVBA が知りたいです。 知識不足のため説明が下手で申し訳ございません。 よろしくお願いいたします。
エクセルで教えてください。 売上一覧を作成しています。 コンボボックスで会社名を指定したとき、 自動的にで売上が0の商品を表示しないというマクロを教えていただけませんでしょうか。もしくは、コンボボックスで会社名を指定したとき、 自動的にフィルターの再適用でもかまいません。 よろしくお願いいたします。
二つのフォルダ内ファイルを比較して、不一致のファイル名だけを表示させることは可能でしょうか。例えば… FolderA内のファイル 20160629-0001.jpg 20160629-0002.jpg 20160629-0003.jpg FolderB内のファイル 20160629-0001.jpg 20160629-0002.jpg 20160629-0003.png だったとして、同名の「20160629-0001.jpg」を除いた、不一致ファイル名だけを表示させたいです。 VBScriptは現在勉強中でほぼ初心者です。 詳しい方お願いします。
エクセルのマクロで毎日違うファイルにコピペをしようとしてマクロを組もうと思ってます。 例えば今日ならA0628.xlsx 明日ならA0629.xlsxというように毎日ファイル名が違います。コピーをする元のファイル名は同じなので、コピー先のファイル名が毎日違います。 ワイルドカードを使ったりして色々調べたけど分かりません。 どなたか助けてください。
エクセルのマクロについて質問です。添付画像のように、二つのエクセルのファイルがあり、 奥のファイルのＡ１の日付、Ａ３～Ａ１１の数字と 手前のファイルのＡ２～Ａ１２の日付、Ｂ２～Ｂ１２の数字を比べて、 両方一致するデータがあった場合に 奥のファイルの一致する数字の横のＢ，Ｃ列へ、 手前のファイルの一致する数字の横のＣ，Ｄ列のデータを出力するにはどのようにすればいいでしょうか？ 説明分かりづらくてすみません。 簡単に言うと日付と数字が両方一致する横のデータを同じように出力したいです。
初めまして。excel Vba初心者です。 ActiveXコントロール、コンボボックスで分からない事があるのですが、 データを選んだ後、コマンドボックスを押したら指定したシートのセルをコピーするにはどうすれば良いですか？ コンボボックス選択欄(シート1) セット 単品 ※コマンドボックスもシート1にあります。 データの置き場所 セット(シート2)A2:A8 単品(シート3)A2:A8 張り付け先はシート1のA2:A8 です。 ご回答の程、宜しくお願い致します。
VBA 実行時エラー1004アプリケーション定義及びオブジェクト定義エラーが発生して処理ができません。どなたかわかる方ご教示ください。A、Bシートです Aシート 12A(ケースNO） ブランド /サイズ /型式 /123 /124/ 125/・/・/・50列くらい 4. ・B4 ・/C4・/・ D4 /・個数 5 .・A社・/ 14.5 / ・AS12/・ 5/・ 0/ ・4/・ 6 6 .・B社・/ 21.3/・ KK15/ ・3 /・3/ ・0/ ・0 Bシートにコピー A B C D E ケースNO ブランド サイズ 型式 個数 1 123 A社 14.5 AS12 5 2 123 B社 21.3 KK15 3 3 124 B社 21.3 KK15 3 ・ ・ コード ' 最初にセル三か所（ケースNO、個数、”ブランド・サイズ・型式”）同時にシートBにコピーするためにいろいろやったのですが上手くいかず、三回に分けコピーすることにしました。そこで、最初に「ブランド・サイズ・型式」をシートBにコピーこれは問題なくコピーされましたのでこのコードを下記のように一部修正して個数とケースNoを順次コピーさせようとしましたら個数のコードで実行時エラー1004アプリケーション・・・が発生いろいろやってみましたが解決できませんのでどなたかご教示よろしくお願いいたします。 Sub テスト（） Dim ShA, ShB As Worksheet Dim LastR, LastR2, LastR3, LastC, LastC2 As Long Dim i, j As Integer Set ShA = ThisWorkbook.Worksheets("A") Set ShB = ThisWorkbook.Worksheets("B") ShA.Select LastR = Cells(Rows.Count, 3).End(xlUp).Row LastC = Cells(4, Columns.Count).End(xlToLeft).Column ShA.Select For j = 5 To LastC For i = 5 To LastR If ShA.Cells(i, j).Value > 0 Then ' ActiveSheet.Range(cells(i,j)).Copy ’ここで実行時エラー ShB.Select LastR2 = Cells(Rows.Count, 2).End(xlUp).Row LastR3 = LastR2 + 1 Range("E" & LastR3).PasteSpecial xlPasteValues ShA.Select End If Next Next Set ShA = Nothing Set ShB = Nothing Application.CutCopyMode = False End Sub
エクセルのマクロについて質問なんですが、 添付画像の奥のファイルをファイル名”ファイル１” シート名”シート１”手前のファイルをファイル名”ファイル２”シート名”シート２”と、奥のファイルのＡ１の日付と手前のファイルのＢ２～Ｈ２の日付を比較し一致した場合に、 、奥のファイルのＡ３～Ａ７、Ｉ３～Ｉ７の数値と手前のファイルのＡ３～Ａ９の数値を比較し 一致するものがあれば、 手前のファイルの一致した日付の列・数値の行のセル（添付画像の場合G3～G6）を 奥のファイルの一致した数値の５つ隣のセル（添付画像の場合Ｆ6,7、Ｎ3,4）に出力するには どのようなプログラムになるでしょうか？
データのシート間の移動に関して質問があります。 営業部の案件全体の受注のデータ管理をしています。システムの更新に伴い一時的にエクセルファイルで管理することになりました。2つのシートで構成し、一つが営業推進といい、営業中の案件のシート、もう一つが受注した案件一覧のシートです。 営業推進には進捗段階をプルダウン式で選択できるようにしてあり、受注を選択したら自動的に受注のシートに移動できるようにしたいのです。 何か方法は無いでしょうか。
Excelマクロについて質問です。 ゴミ箱を空にするボタンを作成したいのですが、どのようなコードを書けばいいでしょうか？ ご教授お願いします。
VBを勉強中です。接続文字列のところで教科書に以下のコードの記述がありました。 cmd.CommandText ＝ "SELECT * FROM orders WHERE MemberID ＝ ' " + TextBox1.Text + " ' " とあるのですが、 ' " + TextBox1.Text + " ' の部分が不明です。シングルクォートでくくる理由はsqlの文法上の理由だとわかるのですが、ダブルクォートでくくっている理由と、+で文字列結合を行っている理由が全くわかりません。ご教示いただけますでしょうが。 よろしくお願いします。
Aのセルが2のときだけ検索したいです。以下の削除データ抽出のさいに 主キーがなく、かつAのセルが2のときだけ検索したいときはどのようなコードをプラスしたらいいでしょうか。（ちなみに除外したいのはＡのセルが1と9の時です） 下の教えていただいたコードを使いたいです。 よろしくお願い致します。 抽出したデータにフラグをたてたいBが主キーです。 前日と当日で比べて1.削除されてるもの、2.追加・変更されてるものと分けて、さらに2の中で追加なのか変更なのか... #知恵袋_ http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1216186518...
ｴｸｾﾙvbaで質問があります。 ｲﾝﾌﾟｯﾄboxで入力した文字を新規で作成したﾌｫﾙﾀﾞ名としたいのですが どうしてもうまいこといきません。どなたかご指導宜しくお願いします。下記が自分で考えたものです。 Sub sample() Dim l As String l = InputBox("氏名", "新人追加", "") MkDir "C:\Users\TOYOJI\前のPCﾃﾞｰﾀ\&l" ChDir "C:\Users\TOYOJI\前のPCﾃﾞｰﾀ\&l" End Sub
VBAにてC列、H列、I列に含まれる数式をｺﾋﾟｰし、値の貼付を行い、最終、品目MAS、価格MASｼｰﾄを消去するﾏｸﾛを作成したいです。 H列、I列はｾﾙの結合がされています。現状、以下の構文になりますが、 IF構文を使うと、連続した命令が出せなく、このような場合、どうすれば連続した命令が出せるのか ご教授いただけますでしょうか？ 何卒宜しくお願い致します。 Application.DisplayAlerts = False ActiveSheet.Unprotect Dim ws As Worksheet Dim LastrngH As Range Dim LastrngI As Range Set LastrngH = Range("H" & Rows.Count).End(xlUp) For Each ws In Worksheets If ws.Name <> "品目MAS" And ws.Name <> "価格MAS" Then ws.Range("C10").Select ws.Range(Selection, Selection.End(xlDown)).Select Selection.Copy ws.Range("C10").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Range("H10:H" & LastrngH.Row).Select Selection.Copy Range("H10").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Range("I10:I" & LastrngI.Row).Select Selection.Copy Range("I10").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False End If Next Worksheets("品目MAS").Delete Worksheets("価格MAS").Delete Application.DisplayAlerts = True
vbsに詳しい方教えて下さい。 vbs勉強中です。 以下のHTMLのonclickの部分を自動でクリックしたいのですが、どのようにすれば良いのでしょうか？宜しくお願い致します。 <TABLE nowrap> <TD valign=top nowrap> <TABLE class="tab_abc_list" border="0" cellpadding="0" cellspacing="0" nowrap> <TR class="tr_abc_list" bgcolor="#FFFFFF" id="abclist_cell_0" value="off" onClick = "sendabcList('1-2-3')"; onMouseOver="changeColorOver('0');" onMouseOut="changeColorOut('0');"> <TD class="td_abc_list_no" id="number_cell_0" nowrap> 1-2-3 </TD> <TD class="td_abc_list_rate" id="abc_cell_0" nowrap> 99.8 </TD> </TR>
エクセルVBAでループ処理したいです。 A列にハイパーリンク設定済みのURLが複数記載しております。現在 Range("A1").Select Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True Call 処理 という処理を行うと A1をクリックして指定URLページを立ち上げる処理をしているのですが、A1セルしかできないためこれをA列の最終行まで連続して処理したいと思っております。 １回目の Call 処理が終わったら A2セルのハイパーリンクをクリックして同様の Call 処理を行って A列の最終行まで処理し続けたいです。 上記コードをどのように修正すればよろしいでしょうか？
VBAのOntimeで翌日に動作させたいのですが、うまくいきません。 アドバイスお願い致します。 数分おきに動作するプログラムを作成しています。下記のコードがそのもので、予約時刻が同じ日の場合は上手く動作しています。 しかし、予約が翌日になると時刻が来ても動作せず止まってしまいます。 A1に予約時刻を表示しているつもりで、その表示自体は希望の時刻になっています。 ただその時刻になっても動作が始まらないです。 自分なりにはかなり調べたのですがどうしても解決できず、詳しい方のアドバイスを頂きたいです。 よろしくお願いします。 OS:Windows10 Excel ver.:2016 ++++++++++++++++++++++++++++++ Sub Test() If DateValue(Date) + TimeValue(Now + TimeValue("00:03:00")) < Now Then ResTime = DateValue(Date + 1) + TimeValue(Now + TimeValue("00:03:00")) Else ResTime = DateValue(Date) + TimeValue(Now + TimeValue("00:03:00")) End If Cells(2, 1) = Now Cells(1, 1) = ResTime Application.OnTime ResTime, "Test", TimeValue("00:01:00") Cells(3, 1) = "" End Sub '↓キャンセルの為だけ Sub TimerCancel() If Cells(3, 1) <> "Cancel" Then ResTime = Cells(1, 1) Application.OnTime ResTime, "Test", TimeValue("00:03:00"), False Cells(3, 1) = "Cancel" End If End Sub ++++++++++++++++++++++++++++++
エクセルのVBAで、あるセルのLockプロパティをFalseにして、シートをプロテクトし、サブルーチンを終了します。 すると、アンロックしたセルは、文字は書けますが、背景色の変更などはグレイアウトして不可能になってしまいます。 VBAで、背景色を変えようとしてもエラーになります。 VBAで、操作ボタン周辺部分だけロックし、それいがいの部分の色を変える処理を書こうと思っているのですが、アンロックしたセルの背景色を変えようとするとエラーになって困っています。 背景色の変更も含めてアンロックする方法はないのでしょうか？ お詳しい方、よろしくお願いします。
ACCESS2010で表計算形式のフォームを作ったときに、 下に検索窓が自動的に出来ますが その検索窓の動作を変えることは出来ますか？デフォルトだと、一文字入力するたびにどんどんカーソルが移動してしまいますが ある程度文字列を入力して、エンターか何かを押すまでは検索は始まらないようにしたり、 特定のカラムだけを検索対象にしたりしたいです 添付の画像の検索窓のことなのですが・・・ せっかくついている物だし、上手いこと使いたいのですがいじる方法がわからないです
エクセルマクロについて、すでにあるものに機能追加したいので、コード修正が必要ですが、私がマクロに詳しくないため、個人指導してくれるところはないでしょうか。大阪、京都で探しています。知っている人ならば、2、3時間くらいでできる作業だとは思うのですが、元のコード読むのも一苦労でして。何分、時間がなく、この土日でできればと思うのですが。
VBAについて質問です。検索するユーザーフォームを作っているのですが 例えば コンボボックスから 名前を選択して 検索(コマンドボタン4)したときに 検索結果を表示するための リストボックスに 以下のように表示したいのですが そのコードを教えていただけませんか。 番号 日付 住所 時間 名前 検索するシートはsheet2 検索したい名前(コンボボックス1) 検索ボタン(コマンドボタン4) 表示したい(リストボックス1) 番号 A3〜34 日付 B3〜34 住所 J3〜34 時間 K-R3〜34 名前 W-AD3〜37 です。どうぞよろしくお願いします。 たっぷり500枚です。
ウィンドウズ１０で Visual Basic ６ランタイがインストールできなかった方http://www.vector.co.jp/download/file/winnt/util/fh621346.html ↑これだと１０対応のソフトではないのにすんなりインストールできて VB6ランタイムで動かしていたソフトがサクサク動きました なぜ？ウィンドウズ１０対応のVB６ランタイムは インストーラーが割り込みしたり インストールが止まったりで インストールできないのに このバージョンだとすんなりいきました。 ウィンドウズのバージョン違いでも動くって普通なんでしょうか？
Javascriptを利用して、クリックされた画像を拡大表示するWebページあります。現在拡大表示された画像が何であるか、HTMLソース等により判別することは可能でしょうか。例として、以下のサイトでは、小さい画像が複数ならべられており、クリックされた画像が下の枠に拡大表示される仕組みです。 http://www.d3.dion.ne.jp/~tiyoko01/java/gazou/sample8.html 最終的なゴールは、VBAにより、選択されている画像を抽出したいのですが、まずは選択された画像を把握する方法を是非お教えいただければと思います。
VB.NETでのXMLデータについての処理についての質問です。 以下のような文字列(string型)があり、xmlDoc.LoadXmlにてXMLデータとして読み込みます。---------------------------------------------------------- <?xml version="1.0" encoding="UTF-8"?> <ResultSet totalResultsAvailable="2" totalResultsReturned="2" firstResultPosition="1" ok="2" ng="0"> <Result><ItemCode>001</ItemCode><SubCode></SubCode><Quantity>0</Quantity></Result><Result><ItemCode>002</ItemCode><SubCode></SubCode><Quantity>0</Quantity></Result></ResultSet> ----------------------------------------------------------- すると、<ResultSet>の値の読み取りができません。 <ResultSet>の”totalResultsAvailable”や”totalResultsReturned”の値が取得を行いたいのです。 何かそれができる方法があるのでしょうか？ ご教授願います。 ※文字列の改行もないので、System.IO.StringReaderでも取得はできませんでした。
エクセルのVBAで助けて欲しいです。 値を入力したセルの行全体にロックを掛けることができないです。 また、チェックボックス自体にはロックを掛けることはできないのですか？申し訳ないのですがご教授のほどよろしくお願い致します。
エクセルVBAでハイパーリンクを作りたいです。 A列に文字列のURLが複数入力しているとします。 これをD列にハイパーリンク設定済みのURLとして登録したいです。ただし、関数ので =HYPERLINK(A1) のように入れないようにしたいです。 セルには関数ではなく文字として入力済みで、リンクが設定してある状態にしたいです。 どのようなコードを入力すればいいかわかる方教えてください。 よろしくお願いします。
アクセス2013に関する質問です。 テーブルに作成されたDBから特定のデータを抜き出す為の検索システムを 作っています。いつもはフォームから検索条件をテキストボックスに入力し、クエリーを通して 検索するのですが、 今回レポートにテキストボックスを作ってレポートを見ながら検索できるように したいと思っているのですが、テキストボックスに検索値を入力し、更新しようと ENTERを押せば直ぐに消えてしまいます。 クエリにも反映していないようです。 レポートでテキストボックスを作成するのは、フォームで作成するのと違うのでしょうか？ どの様にすればレポートから検索値を入力し、クエリーに反映させることが出来るのでしょうか？ 誠に恐れ入りますが、ご教示頂きたくお願い致します。
先にｺﾝﾎﾞﾎﾞｯｸｽに読んだ値を再度読まないようにするには。 '[1] DGV1使用済みｾﾙから読込んで, DGV2へ新しくCboxとして格納されるﾌﾟﾛｸﾞﾗﾑです。ﾎﾞﾀﾝを押したとき先にCboxに追加した値を、 再度読まないようにしたいんですが どのようにすればいいでしょうか。 Public Class Form1 'ﾎﾞﾀﾝが押されたら Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click 'ｾﾙの内容を取得 Dim list As New List(Of String) With DataGridView1 For r As Integer = 0 To .RowCount - 1 For c As Integer = 0 To .ColumnCount - 1 Dim Cell As DataGridViewCell = .Item(c, r) If Not Cell Is Nothing Then If Not String.IsNullOrEmpty(Cell.Value) Then list.Add(Cell.Value) End If End If Next Next End With 'ｺﾝﾎﾞﾎﾞｯｸｽに追加 DataGridView2.Columns.Add(New DataGridViewComboBoxColumn() With { .DataSource = list, .DataPropertyName = "CodeAfter", .HeaderText = "ｺｰﾄﾞ変更" }) End Sub End Class
マクロ 配列数式 について教えてください。 エクセル2010を利用しております。 下記のものをマクロに組み入れています。 DN20セルに下記の関数（配列数式）を展開し 答えを出します。次に DN21に 同じように関数を展開して 答えを求めますが 本来ならN20がN２１に変わる行列番号が N２２に。 DN22には B24になってしまいます。 対策方法ご存じでしょうか。 宜しくお願いいたします。 Sub marumaru() With Worksheets("表").Range("DN20:DN2000 ") .Formula = _ "=MAX(IF($N$20:$N$2000=N20,$L$20:$L$2000))" .FormulaArray = .Formula End With End Sub
ACCESSのフォームのテキストボックスに IMEを使用不可にしたら、テンキーのNumLockまで解除されるようになりました NumLock解除されないように、なんとかならないのでしょうか
VBAでの100万行以上のデータ（ＣＳＶファイル）の取り込み当方，ＶＢＡ初心者です．現在，ＣＳＶファイルのデータをＶＢＡにて処理しているのですが，104万行以上のデータ（300万以上のデータもあり）をＶＢＡにて処理することで，100万1行目のデータから別の列に配置したいです． 例(AからC列の100万1行以下をDからF列に続きから表示したい) A列 ____B列 _C列 _D列 ____E列 _F列 1______ 10.1 0.1 1000001 10.1 0.7 2 ______10.2 0.2 1000002 10.3 0.4 3 ______10.1 0.4 1000003 10.8 0.5 . . . 1000000 10.1 0.3 2000000 10.1 0.2 Keyenceのデータ取り込みテクニックなども参考にしましたが，これは別シートのデータを移す形にになっており，私の求める処理ではありません． ＥＸＣＥＬ2016使用 どなたか，ご教授願います．
Visual Studio 2005で作成したEXEファイルの配布をしたいです。初心者なのですがVisual Studio 2005で今まであったシステムを修正し EXEファイルを作り、使用しているPCに配布し実行することはわかっていますが どう行う、作るかわかりません。 教えてください。EXEファイルの作り方からお願いします。
エクセル2010/2013で、元データのリストに入力した内容から指定する行数、セルを別の伝票形式のシートに転記したいのですが、思うようにいきません。お助け下さい。 作成したい内容： ①vlookup等で、複数の商品マスタ(別bookのシート、エクセル)を参照して 元データに入力。品番と仕入先コードにより適切な参照データを検索。商品名と値段を、商品マスタから元データに表示。 (各マスタは、数千のデータを持っています。)その他、注番や希望納期など必要な項目を元データに入力。(元データは、一年間の注文データとして蓄積。納期管理などに使用する。) ②別のシート(元データと同じbook又は異なるbook)の注文伝票に同注文番号の品番、商品名、単価、数量、希望納期など必要事項をコマンドボタンなどで転記したいです。 転記した注文伝票は、PDFにします。 こちらはマクロ、関数も初心者です。 元データの参照も、なかなかうまくいきません。 宜しくお願いします。
vbaで外部アプリケーションを操作しようと勉強しています。ハンドルを取得してSendMessageで操作できることまでわかりました。 vba Excelから立ち上がっているメモ帳のタイトルバー下にある、「ファイル」「ヘルプ」などのボタンはどう押したらいいのでしょう？ ハンドルもクラス名も同じで、どうやって、選別すればいいのでしょう？ 電卓はボタンのクラスがButtonで同じであっても、ハンドルは1つ1つ違いました。windows7 Office2010です。また、これは親ウィンドウで、これは子ウィンドウと知るにはどうしたらよいでしょうか？FindWindow,FindwindowEx使用するとき、親ー子の関係性がわからないと、使えず、ハンドル0でないのが出るのを当てずっぽでやってます。
EXCEL VBAで複数のワークシートを選択し、ファイル名をセルから引用してPDF形式で保存するプログラムを作成し、PDF形式で保存はできたのですが、そのファイルを開こうとすると下記メッセージが表示され開くことができません。 『ファイル名のドキュメントを開くときにエラーが発生しました：Error[Operating system]:プロセスはファイルにアクセスできません。別のプロセスが使用中です。』 また、EXCELのファイルを閉じて、PDFファイルを開くと下記エラーメッセージが表示されてしまいます。 『ファイル名のドキュメントを開くときにエラーが発生しました：Error[PDF Structure 40]:Invalid file format 注意：ソースのフォーマットはPDFではありません。』 下記にプログラムを記載しております。 どの記述が問題があり、PDFファイルが開けないのか原因が分かりません。 VBAも素人レベルで、ネット上で情報を拾ってプログラミングを組んでおります。 ご教示のほど、何卒よろしくお願いいたします。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Sub PDFファイル保存() ' ' PDFファイル保存 Macro ' 'ワークシート一括選択 Sheets(Array("見積", "明細", "追加見積", "追加見積もり 明細")).Select Sheets("見積").Activate Dim fname As String '名前を付けて保存ダイアログ fname = Application.GetSaveAsFilename( _ Title:="保存先を選べ！" _ , InitialFileName:="" & Range("B10").Text & "様_御見積もり(" & Range("T18").Text & "_" & Range("C18").Text & "KW)" _ , filefilter:="PDF形式だよ,*.pdf,すべてのファイル,*.*") If fname = "False" Then 'キャンセルの場合 Exit Sub Else 'ブックを保存する ActiveWorkbook.SaveAs fileName:=fname End If Sheets("入力フォーム").Select ActiveWindow.SmallScroll Down:=-6 Sheets("入力フォーム").Select Range("A18").Select Sheets("入力フォーム").Select ActiveWindow.SmallScroll Down:=-12 Range("A2").Select End Sub ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
VBAにてB1を基準にして入力データーの下端をI4を基準とした入力データーの右端にコピーするときのコード内容をアドバイス下さい。自分なりにやってはみたんですが、エラーにはならないんですが、思った通りになりませんでした。
VBAでコンパイルエラーが出てしまいます。どこが悪いのかさっぱり分かりません。どなたかご教示お願いします。 Windows(" & Range("A1").Value & "yyyymm販売.xls").Activate よろしくお願いします。
エクセルVBA と uwsc を連携してループ処理したいです。 エクセルのA列にはURL。 C列には値段が入力しております。 エクセルファイルが開いている状態です。uwscも立ち上がっている状態で あらかじめ動作記録している『サンプル.uws』ファイルがあるとします。 エクセルファイルがアクティブの状態とします。 この状態で下記作業を自動で行いたいです。 1 エクセルのC列の値段を Ctrl + C でコピー。 2 エクセルのA列のURLページを立ち上げる。 3 ページが立ち上がるのを待機。 4 ページが立ち上がったら、uwscのあらかじめ動作記録しておいた『サンプル.uws』を実行する。 5 1でコピーしたデータを上記uwscで移動したweb上の指定位置にカーソルがあるとして、 Ctrl + v で指定位置にデータを貼り付け。 6 ブラウザを閉じる。 上記1～6の作業を行ったら エクセルで一個下のデータを同様の処理をしてループして、 最後のデータまで処理したいです。 VBAコードわかる方いましたら教えてください。
エクセルのマクロについて教えて下さい。 「請求書ｘｘ」というファイルにマクロで書き込みを行った後、ｘｘにマクロファイルのA1に入っている数字を入れて名前をつけて保存したいです。具体的にはA1に０７と入っていたら「請求書０７」というファイル名にしたいのですが、どうしたらいいでしょうか？ よろしくお願い致します。
教えてください。下記の処理をVBAでしたいのです。 同じシート内のK列の値がマイナスの場合のみコピーし、M列同行に貼り付ける その際に符号を+にしたい。 またその際にM列に既に値がある場合はペーストしない これをK列の値がなくなる行まで繰り返したいです。
ExcelVBAのRefEdit RefEditコントロールについて質問です。ユーザーフォームでRefEditをいくつか用意してsheetを選択をしてセルの位置を設定するような手法を取ろうとしたのですが、RefEditの3っつ目を選択しようとした場合ユーザーフォームが消えてしまいます。。。 RefEditコントロールの問題なのか、おそらくコードの問題ではないと思います。 変な挙動を起こしエクセルが強制終了してしまうので。。。 RefEditは3っつ以上選択できないのでしょうか？
マクロについて質問です。 複数あるエクセルシートのA列にランダムに数字が70行まで入っています。空白のセルを除いて数字（数字の個数もA列であるが場所もランダム）を上に詰めたいのですが どのように作ればよいでしょうか
macro初心者です。どなたか修正方法をご教示いただけませんでしょうか？同一フォルダー内にBOOKが100～200あります。 セルの任意の値をBOOK名にして変更保存したいです。 ホルダー内のBOOKに対して同一の作業をすることが多いので、 まずmacro2でLOOPするmacroを作成してあります。（M3値で条件分岐のIfあり） そこでmacro1を実行します。（こちらは問題なく動きます。） Macro1は任意のセル値をファイル名にしBOOK名を変更して保存するところまではできたのですが TESTファイルに入っている元ファイルを削除するにはどうすれば良いのでしょうか？ いろいろやってみたのですが、上手く変更できないのでどなたかよろしくお願い申し上げます。 Sub macro1() Dim fileName As String Dim n As Variant Dim WB As Workbook 'ブック Set WB = ActiveWorkbook Application.DisplayAlerts = False '確認メッセージ省略 Application.ScreenUpdating = False '高速化 If Range("M1") = "" Then n = "超過" Else n = Range("M1") End If fileName = "【" & Range("M3") & "】" & Range("C3") & "【" & n & "】" 'ファイル名作成 ActiveWorkbook.SaveAs "c:\TEST2\" & fileName '指定フォルダに保存 Application.DisplayAlerts = True '警告許可(上で警告禁止した場合は警告許可に戻す) Kill "c:\TEST\" & WB ActiveWindow.Close End Sub Sub Macro2() Application.DisplayAlerts = False '確認メッセージ省略 Dim fol As String Dim f As String Dim WB As Workbook fol = "C:\TEST" ' フォルダの指定 f = Dir(fol & "\*.xls*") 'フォルダ内の指定拡張子のファイル名取得 Do While f <> "" 'フォルダに～指定拡張子のファイルが～ある限り～♪ Set WB = Workbooks.Open(fol & "\" & f) 'ブックを開く If Range("M3").Value = 201606 Then 'M3値で条件分岐 Call macro1 WB.Close End If f = Dir() Loop Set WB = Nothing '変数の解放 End Sub
お世話になります。 証明書をSystem.Net.WebRequestを使用して、post送信する必要があります。※実はYahooショッピングのストア注文APIの証明書なんですが・・・ X509Certificate2を使用して、証明書ファイル(バイト型へ変換)とパスワードを読み込み、それをリクエストするだけだと思うのですが、なかなかうまくいきません。 証明書ファイルは、crtファイル/keyファイルをもらい受け、おそらくそれらをPKCS12ファイル形式にして、.p12または.pfxファイルにする必要があります。 証明書の処理に関しては、windowsベースでのopensslコマンドを使用してファイルを出力しました。(testKey.p12) 調べてもちょっと中身の濃い話題にたどり着いてしまい時間がかかっております。 なんとかご教授願います。 --以下注文APIのコード-- ※仕様は公開されているので、ほぼそのまま記述します。 Dim x509 As New X509Certificate2 x509 = New X509Certificate2(ReadFileAsBytes(@証明書Path - 'testKey.p12'), _ @パスワード, _ X509KeyStorageFlags.MachineKeySet) '文字コードを指定する Dim enc As System.Text.Encoding = _ System.Text.Encoding.GetEncoding("utf-8") 'POST送信する文字列を作成 Dim postData As String = _ GetRequestXMLData_OrderList(@IsSeen, @開始日時,@ 終了日時, "1,2", @ストアアカウント) 'バイト型配列に変換 Dim postDataBytes As Byte() = _ System.Text.Encoding.ASCII.GetBytes(postData) 'WebRequestの作成 Dim req As System.Net.WebRequest = _ System.Net.WebRequest.Create("https://circus.shopping.yahooapis.jp/ShoppingWebService/V1/orderLis...") 'ヘッダ指定 req.Headers.Add("Authorization: Bearer " & @アクセストークン) 'メソッドにPOSTを指定 req.Method = "POST" 'ContentTypeを"application/x-www-form-urlencoded"にする req.ContentType = "application/x-www-form-urlencoded" 'POST送信するデータの長さを指定 req.ContentLength = postDataBytes.Length 'データをPOST送信するためのStreamを取得 Dim reqStream As System.IO.Stream = req.GetRequestStream() '送信するデータを書き込む reqStream.Write(postDataBytes, 0, postDataBytes.Length) reqStream.Close() 'サーバーからの応答を受信するためのWebResponseを取得 Dim res As System.Net.WebResponse = req.GetResponse() -- 以下省略--
エクセル VBAで知恵袋下記コードをご教授頂き、 やりたかった処理ができました。さらに質問があるのですが、このコードに 日付があるセルの日付以下だったら処理をして 日付より大きければ処理をしないというコードを 追加したいのですがうまくいきません。 どこにどのようなコードを追加すればよいでしょうか？ また、罫線を引くことを省きたいのですが、どの部分を 省けばよいのでしょうか？ よろしくお願いします。 Sub 一例() Dim sh As Worksheet, rng As Range Dim i As Long, ii As Long, j As Long j = 1 With Worksheets Set sh = .Add(after:=.Item(.Count)) sh.Cells(1).Resize(, 4).Value = Split("日付,内容,担当,金額", ",") With .Item("Sheet1").Cells(1).CurrentRegion For Each rng In .Offset(1, 1).Resize(.Rows.Count - 1, .Columns.Count - 1) With rng If .Value = "リンゴ" Or .Value = "ミカン" Then i = 1 - .Column ii = 1 - .Row j = j + 1 .Offset(ii).Copy sh.Cells(j, 1) .Offset(, i).Copy sh.Cells(j, 3) .Copy sh.Cells(j, 5) End If End With Next rng End With End With With sh.Cells(1).CurrentRegion .Borders.LineStyle = True With .Offset(1).Resize(.Rows.Count - 1) .Columns(2).Value = "果物" .Columns(4).Value = 1000 End With End With End Sub
エクセル VBAで質問です。 マクロが何とかかける程度のスキルですが、より良いコードで書けるように勉強中です。 下記コードに関して、同じ処理をする場合のスッキリしたコードを教えてください。よろしくお願いします。 Sub DATA() Worksheets("Sheet2").Activate Worksheets("Sheet2").Range(Cells(1, 1), Cells(20000, 5)).Clear Application.StatusBar = "処理実行中．．．．" Dim h As Integer Dim i As Integer Dim j As Integer i = 5 h = Cells(Rows.Count, 2).End(xlUp).Row + 1 Do Until Sheets("Sheet1").Cells(i, 3) = "" Sheets("Sheet1").Cells(i, 14).Copy Sheets("Sheet2").Cells(h, 2) Sheets("Sheet2").Cells(h, 3) = "AAAA" Sheets("Sheet1").Cells(i, 13).Copy Sheets("Sheet2").Cells(h, 4) Sheets("Sheet1").Cells(i, 12).Copy Sheets("Sheet2").Cells(h, 5) i = i + 1 h = h + 1 Loop EndSub
ExcelVBA 初心者です。 質問させていただきます。ABCフォルダというがあり、そのフォルダの中に Masterフォルダ フォルダA フォルダB フォルダC と４つのフォルダがあります。 Masterフォルダには,名簿というブックがあり、一覧というSheetがあります。 フォルダAの集計表に,UserFormがあり UserFormにはボタンとリストボックスがあり下記のコードをいれています。 リストボックスをダブルクリックすると入力される形にもしてあります。 A９：A１７をダブルクリックするとUserFormが表示されるようにもしてます。 コード１---------------------------------------------------------------------------- Private Sub CommandButton1_Click() Application.ScreenUpdating = False Dim lastRow As Long Dim myData, myData2(), myno Dim i As Long, cn As Long With Workbooks("名簿.xlsm").Worksheets("一覧") myData = .Range(.Cells(9, 1), .Cells(Rows.Count, 3).End(xlUp)).Value lastRow = .Cells(Rows.Count, 1).End(xlUp).Row End With ReDim myData2(1 To lastRow, 1 To 3) For i = LBound(myData) To UBound(myData) If myData(i, 2) Like "*" & TextBox1.Value & "*" Then cn = cn + 1 myData2(cn, 1) = myData(i, 1) myData2(cn, 2) = myData(i, 2) myData2(cn, 3) = myData(i, 3) End If Next i If cn = 0 Then MsgBox "検索結果は見つかりませんでした・・・" Else End If TextBox1.SetFocus With ListBox1 .ColumnCount = 3 .ColumnWidths = "20;200;200" .List = myData2 End With Application.ScreenUpdating = True End Sub コード２---------------------------------------------------------------------------- Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) If Not Intersect(Target, Range("A9:A17")) Is Nothing Then Dim back As Workbook Set back = ActiveWorkbook Dim mypath As String mypath = ThisWorkbook.Path Workbooks.Open Filename:=mypath & "￥名簿.xlsm" back.Activate UserForm1.Show Cancel = True End If End Sub ---------------------------------------------------------------------------- で、ここからが本題なのですが、フォルダA内であれば上記のコードで問題なく実行できるのですが、 しかし、Masterフォルダに名簿ブックを入れると実行できません。 質問１,コード１の With Workbooks("名簿.xlsm").Worksheets("一覧") この部分で,Masterフォルダを指定したい 質問２コード２の mypath = ThisWorkbook.Path Workbooks.Open Filename:=mypath & "￥名簿.xlsm" 絶対パスでそのフォルダまで行くようになってるのですが、１つ戻してMasterフォルダの中の ブックを指定したい と,Masterフォルダの中にあるブックを他のブックでも共有させたいのですが、 やりかたがわかりません。 質問が下手で、申し訳ございませんがどうかよろしくお願いします。
エクセルVBAで質問です。すでに開いている特定のワークブックをアクティブにしたいのですが Windows("chiebukuro0721.csv").Activate としたいのですが 0721は日付なので毎日変わります。 これをWindows("chiebukuro” & "*" & ".csv")とワイルドカードを使ってやってみましたがエラーになります。 なにかいい方法ありませんか
エクセルVBA エクセルで「テスト」「1番」「2番」「3番」・・・と続くワークシート名があり「テスト」以外の「○番」というワークシートを一度に削除するプログラムを過去に知人に作成してもらいました。ところがある時から突然、選択したワークシート例えば1番のみしか消えなくなりました。プログラムをいじった記憶もありません。何が変わったのかわかりません。ご指導お願いします。 Sub ワークシート削除() Dim myWS As Worksheet For Each myWS In Worksheets If myWS.Name Like "*番" Then If ActiveSheet.Name Like "*番" Then myWS.Select (False) Else myWS.Select End If End If Next If Not ActiveSheet.Name Like "*番" Then Exit Sub End If Application.DisplayAlerts = False ActiveWindow.SelectedSheets.Delete Application.DisplayAlerts = True End Sub
【（Excel）VBAによる処理】 時間によってセルの着色範囲を変更したいです。 ※書式の表示形式は、時刻の○時○分にしてあります。A1のセルに10時00分 C1のセルに10時40分 と入力してあった場合、 経過した時間をE1のセルに =C1-A1 の数式を入れて、0時40分 を表示しています。 次に その差分 40分をセルA4:B4に着色させたいのです。 ファイルによっては、A1とA3セルに別時間が入り、差分も1時間だったり2時間だったりと変動するので、IF文を使って処理しようと思っていますが、うまくいきません。 Dim eTime As Single eTime = Range("E1").Value If TimeValue("0:20:00") > eTime >= TimeValue("0:00:00") Then Range("A4").Select With Selection.Interior .Pattern = xlSolid .PatternColorIndex = xlAutomatic .Color = 255 .TintAndShade = 0 .PatternTintAndShade = 0 End With End If If TimeValue("0:40:00") > eTime >= TimeValue("0:00:00") Then Range("A4:B4").Select With Selection.Interior .Pattern = xlSolid .PatternColorIndex = xlAutomatic .Color = 255 .TintAndShade = 0 .PatternTintAndShade = 0 End With End If ・ ・ ・ 初心者なので、とんでもなく勘違いした書き方をしてるのかもしれません。 よろしくお願いいたします。
エラーを修正していくうちに、めちゃくちゃになりました実績記入シートに書かれた品番ごとに、生産管理シートで計算しています。 実績記入シートのO列以降に品番とその重量を転記したいのですが、エラーしてしまいます。 どなたかアドバイスいただけませんでしょうか。 Private Sub ToggleButton1_Click() Dim myRange As Range Dim Worksheets As Worksheet Dim Target As Worksheet Set Target = ActiveSheet Target.Name = "実績記入シート" Set Workbook = Worksheet("生産量計算シート") Set myRange = Cells(Rows.Count, 1).End(xlUp).Offset(1, 0) If Range("B3").Value = "X207" Or Range("B3").Value = "X980" Or Range("B3").Value = "X981" Or Range("B3").Value = "X982" Or Range("B3").Value = "X983" Then myRange.Offset(2, 15) = Worksheets("生産量計算シート").Cells("A2").Value myRange.Offset(2, 16) = Worksheets("生産量計算シート").Cells("D2").Value Else If Range("B3").Value = "222" Then myRange.Offset(2, 17).Value = Worksheets("生産量計算シート").Cells("A2").Value myRange.Offset(2, 18).Value = Worksheets("生産量計算シート").Cells("D2").Value Else If Range("B3").Value = "210" Or Range("B3").Value = "211" Or Range("B3").Value = "212" Or Range("B3").Value = "213" Or Range("B3").Value = "216" Or Range("B3").Value = "217" Or Range("B3").Value = "218" Or Range("B3").Value = "219" Or Range("B3").Value = "220" Or Range("B3").Value = "220" Or Range("B3").Value = "223" Or Range("B3").Value = "224" Or Range("B3").Value = "300" Or Range("B3").Value = "301" Or Range("B3").Value = "400" Or Range("B3").Value = "450" Or Range("B3").Value = "501" Or Range("B3").Value = "502" Or Range("B3").Value = "504" Or Range("B3").Value = "505" Or Range("B3").Value = "506" Or Range("B3").Value = "507" Or Range("B3").Value = _ "508" Or Range("B3").Value = "509" Or Range("B3").Value = "510" Or Range("B3").Value = "525" Or Range("B3").Value = "526" Or Range("B3").Value = "536" Or Range("B3").Value = "537" Or Range("B3").Value = "539" Or Range("B3").Value = "546" Or Range("B3").Value = "551" Or Range("B3").Value = "552" Or Range("B3").Value = "553" Or Range("B3").Value = "561" Or Range("B3").Value = "562" Or Range("B3").Value = "564" Or Range("B3").Value = "566" Or Range("B3").Value = "570" Or Range("B3").Value = "572" Or Range("B3").Value = "573" Or Range("B3").Value = _ "574" Or Range("B3").Value = "575" Or Range("B3").Value = "576" Or Range("B3").Value = "577" Or Range("B3").Value = "579" Or Range("B3").Value = "629" Or Range("B3").Value = "786" Or Range("B3").Value = "910" Or Range("B3").Value = "911" Or Range("B3").Value = "912" Or Range("B3").Value = "913" Or Range("B3").Value = "914" Or Range("B3").Value = "915" Or Range("B3").Value = "916" Or Range("B3").Value = "924" Or Range("B3").Value = "925" Or Range("B3").Value = "926" Or Range("B3").Value = "927" Or Range("B3").Value = "930" Or Range("B3").Value = "931" Or Range("B3").Value = "932" Or Range("B3").Value = "S403" Or Range("B3").Value = "S405" Or Range("B3").Value = "S407" Or Range("B3").Value = "S408" Or Range("B3").Value = "309" Or Range("B3").Value = "310" Or Range("B3").Value = "311" Or Range("B3").Value = _ "312" Or Range("B3").Value = "314" Or Range("B3").Value = "315" Or Range("B3").Value = "316" Or Range("B3").Value = "317" Or Range("B3").Value = "318" Or Range("B3").Value = "319" Or Range("B3").Value = "320" Or Range("B3").Value = "321" Or Range("B3").Value = "322" Or Range("B3").Value = "323" Or Range("B3").Value = "324" Or Range("B3").Value = "325" Or Range("B3").Value = "326" Or Range("B3").Value = "327" Or Range("B3").Value = "328" Or Range("B3").Value = "329" Or Range("B3").Value = "330" Or Range("B3").Value = "331" Or Range("B3").Value = "332" Or Range("B3").Value = "333" Or Range("B3").Value = "334" Or Range("B3").Value = "335" Then myRange.Offset(2, 19).Value = Worksheets("生産量計算シート").Cells("A2").Value myRange.Offset(2, 20).Value = Worksheets("生産量計算シート").Cells("D2").Value Else 〜 途中省略〜 Else End If End If End If End If End If End If End If End Sub
VBA 日付型で入力されているものを、文字列YYYY/MM/DDに変更する方法 セルにはシリアル値（41126）、日付型（2012/8/5）、文字列（2012/08/05）混在して入力されてます、それを全て文字列YYYY/MM/DDに変更する方法を教えて下さい。 変更する範囲は、選択している範囲です。 単純に文字列YYYY/MM/DDにする方法はかったのですが、混在してる時がうまくいきませんでした、どうか教えて下さい。
削除データ（シート）のBセル2行目以降に出力された11桁の数字を既存の除外リスト(シート)の最終行に分けて追加したい削除データ A B ---------------------- 1 12345678910 2 98765432101 ↓ 除外リスト A B … … 111 22222222 123 45678910 987 65432101 このようにしたいです テストデータの最終行に IF(削除データ!B2<>"",MID(削除データ!B2,1,3) IF(削除データ!B2<>"",MID(削除データ!B2,4,8) と入れてマクロの記録でやってみたのですが、 除外リストの件数が変わった時に対応できませんでした。 何回も質問して申し訳ないです。よろしくお願い致します。
初心者です。 ドロップボックスで、違うパソコンでも表示させるにはどうしたらいいですか？フォルダAに、エクセルBとフォルダCをいれてます。 フォルダCは画像を保管している場所です。 エクセルBで 画像を貼り付けたいセルを選ぶ ↓ フォルダCで画像を選ぶ ↓ 選択したセルの大きさにあわせて画像を挿入 をマクロでしています。 いままで、自分のパソコンだけでしていたときは問題なかったのですが、 複数のパソコンですることになったところ、自分以外のパソコンでは画像が表示されません。 相対パスというのがあるらしいということも調べましたが、 マクロ自体、四苦八苦してここまできたので、精一杯です。 どこをどう変えればいいのか分かりません。 どうしたら違うパソコンでも表示できますか？ マクロを貼り付けます。いただきものですが、すみません。 Sub 選択セルに合わせて() Dim myFileName As String If TypeName(Selection) <> "Range" Then MsgBox "セルを選択して実行して下さい。" Exit Sub End If myFileName = Application.GetOpenFilename( _ FileFilter:="画像 ,*.jpg; *.gif; *.bmp", MultiSelect:=False) If myFileName <> "False" Then With ActiveSheet.Pictures.Insert(myFileName) .Left = Selection.Left .Top = Selection.Top .Width = Selection.Width .Height = Selection.Height End With End If End Sub
「ボタン」を押すと、一括で出勤時間を記号で変換したいです。 VBAでは、どのようなソースコードの記載が必要でしょうか、 助言の程お願い致します。 只今、VBA勉強中です。時間帯はこちらの記号を使用します。 お手数ですが、添付ファイルも参照下さい。 0:00～07:00 ● 07:00～10:30 ○ 10:31～15:30 △ 15:31～23:59 ● 有給 □ 公休 ■
関数で質問させてください。 最終行の値を取得できません。セルP11に、列”L"の最終値を入れたいのですが、 =INDEX(T:T,COUNTA(T:T)) で読み込んでくれません。試しにいろいろやった所、数式が入っていると（または数式で取得した数字）ダメなようなのです。 列”L"にはこの式が入っています。=IFERROR(IF(L15+K16=L15,"",L15+K16),"") このような数式が入っていた場合の、最終値の取得の仕方を教えてください。 VBAでもよいです。 よろしくお願いいたします。
VBAに関する質問です。当方、プログラミングは初心者ですが、よろしくお願いいたします。 内容としては、フィルターでできるレベルですが、VBAでの回答を希望します。VBAで条件をすべて満たす行を抽出して、別のシート（シートよりはユーザーフォーム）に表示させたいです。 具体的には、ツイートのデータベースから条件を指定し（項目は、id、name、nickname、date、tweetとなっており、今後20項目まで増える可能性があります。）、それらに該当する行を抽出し、該当するデータを表示させたいです（ユーザーフォームに表示できたら最高です）。その際、１データにつき１シートor画面（100人該当なら100シート)で、結果を出したいです。 イメージとしては、 入力フォーム id、name、 nickname、 date、 tweet aaa 2016/0719 イチロー 野球 3000本 上記を満たす行をデータベースより抽出したいです。（tweet欄はイチロー 野球 3000本という単語がすべて含まれるツイートを探したいという意味です。） 結果出力のイメージとしては、 入力条件 id、name、 nickname、 date、 tweet aaa 2016/0719 イチロー 野球 3000本 出力結果 id、name、nickname、date、 tweet 34 aaa abcd 2016/0719 本日、野球選手のイチローが3000本達成！ 1560 aaa hijk 2016/0719 野球選手のイチローが3000本達成した模様 上記結果を各行ごとに別のシート（別のウィンドウ）に表示させたいです（この場合では２ウィンドウ）。 現在の進捗状況といたしましては、 シート１ データベース シート２ 入力条件 として、シート２に検索したい単語を入力し、別のシートに表示させるという段階までなんとかいけました（非常にアナログです笑）。 上のほうで述べた仕様には程遠いため、質問を投稿しております。 大きな課題点としては、 ①現段階では、条件検索の指定した単語を含むツイートがある行を抽出することはできるが、ほかの条件も同時に満たす検索をできない。（idやdate、nameなども同時に指定したい。） ②仮に結果が100件あったとして、それがすべてシート３に表示される。 （100件あるなら、100シートにそれぞれ表示させたい ③シート２に条件を入力し、実行することで結果を得ているが、シートではなくユーザーフォーム画面に入力し、結果もそのような画面で得たい。（そもそもこれは可能なのでしょうか？） 非常に長くなりましたが、以上、よろしくお願いいたします。 （わかる部分だけでもご回答いただければ幸いです。） 以下に、現段階でのコードを示します。 -------------------------------------------------------------------------------------------------------- Const SHEET1 As String = "sheet1" 'ツイートDB Const SHEET2 As String = "sheet2" '条件シート Const SHEET3 As String = "sheet3" '結果シート Const COL_TW As Integer = 5 'ツイートのある列 Const INT_EM As Integer = 5 '条件項目列数 Sub tweet() Dim Endrow As Long Dim Editrow As Long Dim EmName As String Dim ws As Worksheet EndrowTw = Worksheets(SHEET1).Cells(Rows.Count, COL_TW).End(xlUp).Row Editrow = 1 For m = 1 To INT_EM EmName = Worksheets(SHEET2).Cells(1, m).Value endrowEm = Worksheets(SHEET2).Cells(Rows.Count, m).End(xlUp).Row For Each ws In Worksheets If ws.Name = EmName Then Application.DisplayAlerts = False Worksheets(EmName).Delete Application.DisplayAlerts = True End If Next ws Set ws = Worksheets.Add() ws.Name = EmName For i = 2 To EndrowTw For k = 2 To endrowEm If InStr(StrConv(Worksheets(SHEET1).Cells(i, COL_TW).Value, vbWide), StrConv(Worksheets(SHEET2).Cells(k, m).Value, vbWide)) Then Worksheets(SHEET1).Select Worksheets(SHEET1).Rows(i).Select Worksheets(EmName).Rows(Editrow).Value = Selection.Value Editrow = Editrow + 1 Exit For End If Next k Next i Editrow = 1 Next m End Sub
BASIC言語についで質問です 数を10個入力し、その合計の平均以上の値を表示せよ という課題をやっているのですが後半の平均以上の値のみを 表示させる方法がわかりませんどこが間違っているでしょうか、教えてください。
ExcelのIF関数で、以下のような設定がしたいです。 チェックボックスをA1のセルと連動させて、 A1のセルにTRUE、FALSEが表示されるようにしました。そこから、 A1のセルがTRUE のとき、 ①A2のセルが「32400」以上のとき、A3のセルに「648」 ②A2のセルが「10800」以上のとき、A3のセルに「432」 ③A2のセルが「10800」以下のとき、A3のセルに「324」 A1がFALSEのときは、 A2のセルに値があっても、A3のセルは空白。 このようにするには、どのような方法がありますでしょうか？ ①②③のIFは以下のように分岐できましたが、 そこに何を組み合わせればいいのかわかりません。 =IF(A2>=32400,648,IF(A2>=10800,432,324)) ご教授宜しくお願い致します。
マクロの高速化について 指定したフォルダに入っているブック(すべて同じ形式)の指定したセルの値を抜き出し、 集計シートへその値を貼り付けるマクロを作りました。ただ、かなり時間がかかります。およそ400～600くらいのブックから値を抜き出すのですが、 最初はサクサク動いていても、だんだん遅くなっていきます。 無駄なコードや、改善点をアドバイスお願いします！ win7 Excel2007もしくは2010です。 ---------------------------- Option Explicit Sub 集計() Dim fol As String 'フォルダ名 Dim f As String 'ファイル名 Dim wb As Workbook 'ワークブック Dim Totalwb As Workbook '集計のワークブック Dim rc As Integer 'yesnoの返り値 Dim varDate As Variant Set Totalwb = ActiveWorkbook Call フォルダの指定(fol) If fol = "" Then Exit Sub End If rc = MsgBox(fol & "でよろしいですか？", vbOKCancel) If rc = 2 Then Exit Sub End If '---------------------------------------------------------------------- Application.ScreenUpdating = False f = Dir(fol & "\*.xls") 'フォルダ内の指定拡張子のファイル名取得 Do While f <> "" 'フォルダに指定拡張子のファイルがある限り Set wb = Workbooks.Open(fol & "\" & f) 'ブックを開く '■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ '開いたブックに対する処理 '■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ With wb.Sheets("成績表") varDate = Array(.Range("A4").Value, .Range("L4").Value, .Range("F4").Value, .Range("S2").Value _ , .Range("P6").Value, .Range("AG6").Value _ , .Range("P18").Value, .Range("AG18").Value _ , .Range("P30").Value, .Range("AG30").Value _ , .Range("P42").Value, .Range("AG42").Value _ , .Range("P54").Value, .Range("AG54").Value) wb.Close End With With Totalwb.Sheets("集計") .Activate .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate .Range(ActiveCell, ActiveCell.Offset(0, 13)).Select Selection.Value = varDate End With varDate = "" '変数の解放 '■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ f = Dir() Loop Set wb = Nothing '変数の解放 Application.ScreenUpdating = True '------------------------------------------------------------------------- MsgBox ("終わりました") End Sub Private Sub フォルダの指定(fol As String) With Application.FileDialog(msoFileDialogFolderPicker) If .Show = True Then fol = .SelectedItems(1) End If End With End Sub
BASIC言語についてどうプログラミングすればよいのかわからないので教えてください。数を何回か入力し、それらの数の最大、最小、平均を求めるプログラムを作りなさい ※ただし０が入力されたら終了とする という問題で参考書にはDIMやWhileを使い10回計算したあとの平均等 回数が決められているものしかなく0が入力されるまで という回数が決まっていないものが載っていません なのでなにで合計したものを割ればいいのかわからないです どうプログラミングすればよいでしょうか 自分が使っている動作確認ソフトは99Basicです
どなたかこのプログラムを作成していただけませんか？(T ^ T)ステップ1〜ステップ3までお願いできませんか？ まったく分からないのでよろしくお願いいたしますm(_ _)m
ExcelVBAマクロについて確認させてください。下記のようにGetOpenFilename関数により、ライブラリファイルの内容を変数mojiに読み込ませ、mojiの内容の修正まではできました。 その後、そのmojiの内容を元のライブラリファイルがあった場所に別名のライブラリファイル名で新たに保存して元のライブラリファイルは削除するプログラムを作成したいのですが、方法をご教授いただけますでしょうか。 'フルパスも含めたファイル名をbufに代入 buf = Application.GetOpenFilename(FileFilter:="ライブラリファイル,*.lib", Title:="ファイルの指定") If buf <> "False" Then With CreateObject("Scripting.FileSystemObject").GetFile(buf).OpenAsTextStream moji = .ReadAll （ここで文字列mojiの内容の修正） .Close End With Else Exit Sub End If
VBAはExcelのバージョンによって動作スピードがそれぞれ違います。 Excel2010のほうが軽くてサクサク速いでした。 Excel2013でやるともっさり感があって遅く感じます。私だけでしょうか？ もしExcel2013での動作スピード改善策がありましたら教えていただけると嬉しいです。
VBAによるIE操作についての質問です。まずやりたいこととして、IEでヤフーを開き、検索窓にてラブライブと打ち込み検索を行い、公式のラブライブのページをクリックし、公式ページを開きたいです。今の現状としてヤフーを開き打ち込みKン作までは行えたのですが、公式ページのリンクをクリックする動作がわからないためご教授いただきたく質問させていただきました。途中までの内容を添付いたします。ご回答よろしくお願いいたします。 Sub sample() Dim objIE As Object Set objIE = CreateObject("InternetExplorer.Application") objIE.navigate "http://www.yahoo.co.jp/" objIE.Visible = True Do Until objIE.Busy = False And objIE.readyState = 4: Loop With objIE.document .getElementById("srchtxt").Value = "ラブライブ" .getElementById("srchbtn").Click End With Set objIE = Nothing End Sub
vba超初心者です チェックボックスのチェックが入ってない場合は以下のメッセージを表示し チェックが入っている場合は、その項目の印刷を実行したいのですが？ 実行すると（CheckBox7までなら実行可能ですが） CheckBox8でコンパイルエラー メソドまたはデータメンバーが見つかりません のメッセージで実行不可です。解決策を教えて頂けないでしょうか？ 宜しくお願いいたします。 Private Sub CommandButton1_Click() If UserForm1.CheckBox1.Value = True Then ElseIf UserForm1.CheckBox2.Value = True Then ElseIf UserForm1.CheckBox3.Value = True Then ElseIf UserForm1.CheckBox4.Value = True Then ElseIf UserForm1.CheckBox5.Value = True Then ElseIf UserForm1.CheckBox6.Value = True Then ElseIf UserForm1.CheckBox7.Value = True Then ElseIf UserForm1.CheckBox8.Value = True Then ElseIf UserForm1.CheckBox9.Value = True Then ElseIf UserForm1.CheckBox10.Value = True Then ElseIf UserForm1.CheckBox11.Value = True Then ElseIf UserForm1.CheckBox12.Value = True Then ElseIf UserForm1.CheckBox13.Value = True Then ElseIf UserForm1.CheckBox14.Value = True Then Else MsgBox "どの印刷項目も選択されていません", vbCritical End If If CheckBox1.Value = True Then Sheets("報告書").Select ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveSheet.EnableSelection = xlUnlockedCells ActiveSheet.PageSetup.PrintArea = "$B$2:$AA$42" ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _ IgnorePrintAreas:=False End If 以下１４項目続く
ExcelのVBAで、SUMで合計を計算する際にCellsで指定するセルを変数を用いて表したいのですが、 例えば、添付の画像のような表で、その月までの累計売上を以下のようにDo While文を用いて Dim i As Integer i = 3 Do While i < 9 Cells(i, 3) = "=SUM(Cells(3,2),Cells(i,2))" i = i + 1 Loop と表記しても、認識できない文字列と出てうまく機能しません。 どう書き換えたらいいのでしょうか？
エクセルのVBAに関する質問です。 下記のコードは、ブックXの特定条件に合致するデータを ブックYへコピーする操作を実現しています。Sub Sample4() Dim Wb As Workbook, Sh As Worksheet Dim MySh As Object Dim i As Long, j j = 7 '←ここで開始行指定（これは7行目開始） For Each Wb In Workbooks If Wb.Name <> ThisWorkbook.Name Then Set MySh = ThisWorkbook.Worksheets("Sheet22") For Each Sh In Wb.Worksheets If Sh.Name <> "Sheet1" Then With Sh For i = 2 To .Cells(Rows.Count, 1).End(xlUp).Row If .Cells(i, 1).Value = "誤記" Then 'ペースト先ブックの操作 '2列目～6列目のセルデータをペースト MySh.Cells(j, 2) = .Cells(i, 2) MySh.Cells(j, 3) = .Cells(i, 3) MySh.Cells(j, 4) = .Cells(i, 4) MySh.Cells(j, 5) = .Cells(i, 5) MySh.Cells(j, 6) = .Cells(i, 6) '1行おきにペーストする j = j + 1 End If Next End With End If Next End If Next End Sub 現状ですと、抽出条件やコピーしたいセルの条件を変更する場合に 直接エディターを開いてコード修正する必要があり、 保守性が少し低いと感じています。 例として、下記の部分ですが、 抽出条件を"誤記"から"完了"に変更したいといった場合、 コードをいじるのではなく、ブックYの任意セルに入力された 条件(”完了")を参照して、動作するようにしたいです。 If .Cells(i, 1).Value = "誤記" Then どうか、ご教授ください。
ExcelでのVBAの質問です。今、仕事で使用する機器の仕様書をつくるにあたって、 使用する機器の仕様を各サイトから引っ張ってきて、自社フォーマットのエクセルに書きうつして一つのブックにしてカタログのようにしています。 使用する機器は取引先によって変わってきますが必要とされる機器は型式の差ぐらいで大体同じですが、使い回しできない仕様を探す際に時間がかかってしまいます。 そこで、VBAのユーザーフォームを使って ①テキストボックスに入っているパスのフォルダ内からファイル名を取得する(コマンドボタンを仕様） ②取得したファイル名はリストボックスに反映する。 ③取得したファイル名から必要な機器のファイルを選び、そのファイルに入っているシートを 機器仕様書としてまとめるExcelファイルに挿入する。 ※機器のファイルは型式別であらかじめ作成しておく。 このような感じで作りたいのですが、テキストボックスを使用しないで、 Dim myPath myPath = "C:\test\" のようにしてそのtestフォルダ内のファイル名一覧が取得できるとこまでは できたのですが、テキストボックスに個々で選べるようにしたいです。 VBAは初心者に毛が１mm生えたくらいでしかできませんが、 アドバイス宜しくお願い致します。
AutoCADってどんな方法で開発できますか？ AutoLispのほか、どんなものがあるでしょうか？
エクセルVBAからWordBasicを使用する方法を探しております。 下記、コードを入力するのですが、エラーになってしまいます。※エラー内容 オブジェクト変数またはWithブロック変数が設定されていません。 どなたか知りませんでしょうか？ Sub test() Dim obj As Word.Application obj.WordBasic.Open Name:="C:\Users\hako\Desktop" End Sub
Exel VBAについての質問です 統計分析のコードを書いたのですが、入力範囲のプロンプトに数字の範囲を指定してもアプリケーション定義のエラーと表示されます。何が原因でしょうか？Ｓｕｂ a() Sheets("統計分析").Select Set MyDat = Application.InputBox(prompt:="入力データ範囲", Type:=8) c = MyDat.Column Cells(23, c).Activate With Application.WorksheetFunction ActiveCell.Offset(0, 0) = .Count(MyDat) ActiveCell.Offset(1, 0) = .Sum(MyDat) ActiveCell.Offset(2, 0) = .Max(MyDat) ActiveCell.Offset(3, 0) = .Min(MyDat) ActiveCell.Offset(4, 0) = .Average(MyDat) ActiveCell.Offset(5, 0) = .Median(MyDat) ActiveCell.Offset(6, 0) = .Var(MyDat) ActiveCell.Offset(7, 0) = .StDev(MyDat) ActiveCell.Offset(8, 0) = .Skew(MyDat) ActiveCell.Offset(9, 0) = .Kurt(MyDat) End With End Sub
Exel VBAで集計表を作成したいのですが、このコードではワークシート"合計"しか作成されず、三か月合計の売り上げが反映されません。どこを修正すべきでしょうか？Sub 複数シートへの同時入力() Sheets(Array("Sheet1", "Sheet2", "Sheet3")).Select Sheets("Sheet1").Activate Cells.Select Selection.Clear Range("A1").Activate ActiveCell = "今月分の売り上げ" Range("A3").Activate ActiveCell = "商品名" Range("B3").Activate ActiveCell = "単価" Range("C3").Activate ActiveCell = "数量" Range("D3").Activate ActiveCell = "金額" Range("A4").Activate ActiveCell = "コーヒー" Range("A5").Activate ActiveCell = "紅茶" Range("A6").Activate ActiveCell = "ケーキ" Range("A7").Activate ActiveCell = "Aランチ" Range("A8").Activate ActiveCell = "Bランチ" Range("B4").Activate: ActiveCell = 280 Range("B5").Activate: ActiveCell = 300 Range("B6").Activate: ActiveCell = 250 Range("B7").Activate: ActiveCell = 650 Range("B8").Activate: ActiveCell = 600 Range("C4").Activate: ActiveCell = 50 Range("C5").Activate: ActiveCell = 30 Range("C6").Activate: ActiveCell = 40 Range("C7").Activate: ActiveCell = 60 Range("C8").Activate: ActiveCell = 80 Range("D4:D8").Select Selection.Formula = "=B4*C4" Range("D9").Activate ActiveCell.Formula = "=SUM(D4:D8)" Range("A1").Activate Sheets("sheet1").Select End Sub Sub 集計表の作成() Dim mm As Variant, sht_name As Variant For mm = 1 To 3 sht_name = "Sheet" & mm Sheets(sht_name).Select Range("A1") = mm & "月分の売り上げ" Next mm '新しいワークシート追加 Set newWS = Worksheets.Add(before:=Sheets("Sheet1")) newWS.Name = "合計" Range("A1") = "3ヶ月合計の売り上げ" Range("A3") = "商品名" Range("B3") = "単価" Range("C3") = "数量" Range("D3") = "金額" Range("A4") = "コーヒー" Range("A5") = "紅茶" Range("A6") = "ケーキ" Range("A7") = "Aランチ" Range("A8") = "Bランチ" Range("B4") = "280" Range("B5") = "300" Range("B6") = "250" Range("B7") = "650" Range("B8") = "600" Range("C4:C8").Formula = "=SUM(Sheet1:Sheet3!C4)" Range("C4:C8").Formula = "=B4*C4" Range("D9").Formula = "=SUM(D4:D8)" End Sub
MS-ACCESS の VBA で、RecordSet を FindFirst, FindNext で検索するとき、検索条件に使用しているフィールドの値が途中で変わってしまった場合、検索がうまくいかない場合があります。 status=0 で検索して、処理が済んだレコードを、status=1 に変えるような場合で、status がIndex の一つになっているような場合です。 この場合、最初の状態を保持しておいて、FindNext が動作するようにする記述を教えて下さい。 よろしくお願いします。
VBA初心者です。 AV列の最下行に数式が入っています。 これをひとつ下にオートフィルする記述を教えてください。 以下だとうまくいきません。 どうかご教授ください。-------------------------------------------------------------- Sub テスト() With Range("AV" & Rows.Count).End(xlUp).Value .AutoFill Destination:=.Resize(1), Type:=xlFillDefault End With End Sub
Excel、VBAで罫線を引きたいです。パート２ 先ほど大変素晴らしいマクロを組んでいただいたのですが、 説明不足がありました。。。申し訳ありません。 左図を右図にしたいです。１．Aの二重線をB、C列に伸ばす（B、C列に拘らず行全てでも大丈夫です） ２．B、C列は二重線以外の罫線はそのまま どのようにマクロを組んだらよろしいでしょうか？ よろしくお願いいたします。
下記のような『親フォルダ』－『サブフォルダ』－『エクセル』という構成があり、 『エクセル』を呼び出し→加工→プリントアウト→閉じる。という処理をサブフォルダの分だけアクセスのVBAで自動でしたいと考えております。 条件を付けて繰り返し処理という形になるのかもしれませんが、 いろいろと調べてもうまくいききません。 後述するVBAのわからない部分をご教授いただきたく宜しくお願い申し上げます。 【親フォルダ】 処理フォルダ | | 【サブフォルダ】 【対象ファイル】 |---AB-C1-001000-------AB-C1-001000.xlsx |---AB-C1-001002-------AB-C1-001002.xlsx |---AB-C1-001003-------AB-C1-001003.xlsx |---AB-C1-001006-------AB-C1-001006.xlsx |---AB-C1-001007-------AB-C1-001007.xlsx |---AB-C1-001009-------AB-C1-001009.xlsx |---AB-C1-001010-------AB-C1-001010.xlsx |---AB-C1-001011-------AB-C1-001011.xlsx Private Sub 処理開始BT_Click() ''''''＿＿＿わからない部分＿＿＿＿ 親フォルダ→サブフォルダ→サブフォルダと同じ名前のエクセルファイルを呼び出す。 サブフォルダに『AB-C1-*****』という規則性はあるが必ず下の桁が並んでいるわけでなく、 飛ぶこともある。 サブフォルダとエクセルの名前は同一だが、処理の度に違う。 つまり \親フォルダ(固定)\AB-C1-****\AB-C1-****.xlsx このサブフォルダ内のエクセルを呼び出して下のような処理を行ってプリントアウトして、 上書きしないで閉じます。 これを存在するサブフォルダの分だけ自動で処理を行いたい。 ''''''＿＿＿実際に行いたい処理(完成している部分)＿＿＿＿ 'エクセルをA4に収まる加工したり、 'エクセルのファイル名を取得してそのファイル名をセルに 'バーコードで表示させたりする 'そしてプリントアウト 'エクセルを上書きしないで閉じる ''''''＿＿＿ここまでは出来ている＿＿＿＿ End Sub
VBで保存してあるメモ帳を開く方法 visual studio初心者です 経路検索？の簡易版のようなものを作成しています。 画像（個人情報のため駅名は隠します）のように○○駅から観光地に向かう場合の経路なのですが radiobuttanを選択して、それぞれ最速、最安、最楽の手段をメモ帳を起動して表示しようと思っています。 >Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click > Dim eki As String > If RadioButton1.Checked = True Then > > eki = "渋谷" > Call Shell("NOTEPAD C:\.shibuya_soku.txt", vbNormalFocus) > End If とりあえずネットで検索していろいろ試したのですが、メモ帳のフォルダが見つからないとでます。 メモ帳はプログラムのフォルダと同じです。 ほんとによくわからないまま作成しているので、無駄の多いプログラムかもしれませんが、とりあえず保存してあるメモ帳を起動する方法を教えてほしいです。 ちなみに、メモ帳の名前は (shibuya_soku.txt) です お願いします
http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1316085394...以前教えていただいた、上記添付のURLですが、以前は、三つのセル内の数字を一つのセルに結合して、転記するVBAを教えてもらいましたが、これを流用して、今度は1対1で転記するプログラムに流用しようと編集しましたがうまくいきませんでした。 指示文書にコメントをいただけないでしょうか？ よろしくお願いします。 Option Explicit Sub Sample() Dim st1 As Worksheet Dim st2 As Worksheet Dim r1 As Long, r2 As Long Set st1 = Worksheets("Sheet1") Set st2 = Worksheets("Sheet2") r2 = IIf(st2.Range("D6").Value = "", 6, st2.Range("D" & Rows.Count).End(xlUp).Row + 1) r1 = 2 Do While st1.Range("M" & r1).Value <> "" Or st1.Range("N" & r1).Value <> "" Or st1.Range("O" & r1).Value <> "" st2.Range("D" & r2).Value = st1.Range("M" & r1).Value & st1.Range("N" & r1).Value & st1.Range("O" & r1).Value r2 = r2 + 1 r1 = r1 + 1 Loop End Sub
kiku30246様 VBAについてhttp://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1116137482... 以前質問させていただいた内容で一部修正したい点がありまして、相談です。 前回の相談 kiku30246様 mシートE列に文字があるかどうかの確認をし、H列に回避するのは良かったのですが、E列.F列.G列の内容が全く同じ内容の場合は、H列に回避せず、緑にも塗らない処理が必要ですという事で、追加をお願いし、新たに修正したコードで成功していましたが、同じく、HIJの列も同様に、内容が同じであればK列に回避せす緑にも塗らない処理を追加したい場合はどのように変更すればよいでしょうか？ 以前補足でいただきましたコードは下記です。 With .Offset(, 1 - .Column).Range(CRNGS) Do While (rf.Value <> "") If (rf.Column = Range("E1").Column) Then For i = 1 To .Areas.Count If (rf.Offset(, i - 1).Value <> .Areas(i).Value) Then Exit For End If Next If (i > .Areas.Count) Then Exit Do End If Set rf = rf.Offset(, 3) iC = CCR2 Loop If (rf.Value = "") Then For i = 1 To .Areas.Count rf.Offset(, i - 1).Value = .Areas(i).Value Next End If End With
ExcelVBAについての質問です。 このコードをDo~LOOPステートメントを使った反復型に書き換えたいのですがどうすればいいでしょうか？Sub 星() Dim i As Integer, n As Integer n=10 For i=1 To n Debug.print Format(i,"00")&String(i,"*") Next i End Sub
Excel、VBAで罫線を引きたいです。 A行に合わせ、赤線のような線を引きたいのですが、 どのようにマクロを組んだらよろしいでしょうか？
VBA オートフィルについて Excel VBAにて 「選択している行の一つ上の行のE列および、J列のデータを一つ下にオートフィルさせる」 という記述がわかりません。以下の動作をさせたいです。 ①データを検索する ②検索にヒットしたデータがある行の下に行を挿入 ③挿入した行に別シートからデータを転記 ④挿入した行のひとつ上の行（＝検索にヒットしたデータがある行）の E列および、J列のデータを、挿入した行（一つ下のセル）にオートフィル（数式の貼付） ③までは、うまくいったのですが、 ④だけうまくいきません。 どのような記述にしたらいいのでしょうか。 図は、③直後の状態です。 E6には数式が入っており、E6の数式をE7にオートフィルさせるイメージです。 ※図はあくまでイメージです どうかご教授ください。 よろしくお願いします。
Excel2013で別シートのdataを集計したい 年間の販売の収入と支出を入力したシートがあり、 それを別シートの収入・支出リストへ集計したい。良き方法をご教授いただきたく、何卒よろしくお願いします。
Activateしてるにも関わらずselect メソッドが失敗しましたと警告が出てくる件について お世話になっております。先程、原因不明のエラーに遭遇しまして、アクティブ化してるにも関わらず下記文でselectメゾットが失敗しましたと表示されるのです With ThisWorkbook.ActiveSheet 'book1です Workbooks("book2.xlsx").Activate Range("B2").Select ネットで調べても、このエラーはアクティブ化してないものを指定すると出てくるとしか見つからず困っております。 どなたかお分かりになる方がいましたらお教えください
エクセルのVBAで2つご教授をお願い致します。 ①下記のコードはh列に"完了"と打ち込むとメールが送信されるというコードなのですが、動作しません、動作する様ご教授お願い致します。②h列のx行に"完了"が打ち込まれた時、a列のx行からセルの値を取得する方法をご教授お願い致します。 Option Explicit Private Sub Worksheet_Change(ByVal Target As Range) Dim hani As Range Set hani = Range("H:H") If Target.hani = "完了" Then Call MAKE_MAIL_ITEM_TEST_NG Exit Sub End If End Sub Private Sub MAKE_MAIL_ITEM_TEST_NG() Const olMailItem = 0 Dim ol As Object Dim mi As Object Set ol = CreateObject("Outlook.Application") Set mi = ol.CreateItem(olMailItem) 'mi.display '表示する場合 mi.To = "xxxxxxxxxxx@yahoo.co.jp" 'To mi.Subject = "完了" '件名 mi.Body = "完了" & vbCrLf _ & Now() & "作成" mi.Send 'メール送信 Set mi = Nothing Set ol = Nothing End Sub
制御文字を含むQRコードをACCESSに読み込む方法はないでしょうか？これまでは制御文字が含まれていないQRコードをリーダーで読み取り、フォームのテキスト入力エリアに吐き出していました。 しかし、制御文字を含むコード（しかも各データの文字数は可変で、制御文字が区切り文字になっているため、制御文字の読み取りが必須になっている）を扱う必要が出てきました。 フォーム部品への吐き出しの他、ACCESS（およびVBA）で制御文字を読み取る方法を教えていただけると助かります。
Excelハイパーリンクについて 2行目がタイトル行で、3行目からデータが入っています。 B3に「=HYPERLINK("X:\納品書00001.pdf",1)」という関数を入れました。しかしオートフィルを使うと、上記の関数がコピーされるだけでした。 これをB4に「=HYPERLINK("X:\納品書00002.pdf",2)」...と710行（今後増える）まで適用したいのですが、この関数をどのように変更すれば良いでしょうか。 不十分な情報等あれば補足いたしますので、お知らせいただけますと幸いです。 どうぞよろしくお願いいたします。
vbaでie制御して、株価のさまざまな情報を取り込んでいます。 たとえばローソク足のチャートがあり、そこにカーソルを移動するとそのローソク足の値が出てくるようなサイトの場合、その出てくる値(時間と4本値が出てきます)を取り出すことは可能なのでしょうか？ そういったことが勉強できる本があれば教えていただきたいです。 よろしくお願いします。
VSTO(VS2012)で作成したoffice系アドインのCOMアドイン追加について。VSTOで作成したアドインを、各種officeソフトからCOMアドインとして 追加したいのですが、有効なアドインではありません、と弾かれてしまいます。 プロジェクトのビルドの際に、何か設定を行わなければならないのでしょうか。 MSDNを見ると、そもそも無理なのかな？とも思ったのですが、 希望を捨てきれず質問させていただきました。 よろしくお願いします。
VBAの質問です。For i = 0 To 10 For j = 0 To 10 Cells(30 + i, 2 + j).Value = Cells(2 + i, 2 + j).Value Next Next と構文を作りました。 これだとB30～K30に数値入力、次にB31～K31に・・・ という入力になりますが、これを B30～K30に入力 C31～L31に入力 D32～M32に・・・ のように処理が進む毎に右へ１つずれるようにしたいのですが、どのように修正すればよろしいでしょうか？
現在visualstudio2010にてある計算を行い、その計算結果をモータへ送信するプログラムの作成を行っております。送信の際にシリアル通信を用いようと考えているのですが、肝心なシリアル通信についての方法が分かりません。 ネットで調べてみたところフォーム(？)でシリアル通信が出来るとの記述があったのですが、それを計算を行っているプログラム内に組み込むことは可能なのでしょうか？ visualstudioに関してはほぼ初心者なので、どなたか回答宜しくお願い致します。
VBAに関する質問です。当方、プログラミングは初心者ですが、よろしくお願いいたします。 内容としては、フィルターでできるレベルですが、VBAでの回答を希望します。VBAで条件をすべて満たす行を抽出して、別のシート（シートよりはユーザーフォーム）に表示させたいです。 具体的には、ツイートのデータベースから条件を指定し（項目は、id、name、nickname、date、tweetとなっており、今後20項目まで増える可能性があります。）、それらに該当する行を抽出し、該当するデータを表示させたいです（ユーザーフォームに表示できたら最高です）。その際、１データにつき１シートor画面（100人該当なら100シート)で、結果を出したいです。 イメージとしては、 入力フォーム id、name、 nickname、 date、 tweet aaa 2016/0719 イチロー 野球 3000本 上記を満たす行をデータベースより抽出したいです。（tweet欄はイチロー 野球 3000本という単語がすべて含まれるツイートを探したいという意味です。） 結果出力のイメージとしては、 入力条件 id、name、 nickname、 date、 tweet aaa 2016/0719 イチロー 野球 3000本 出力結果 id、name、nickname、date、 tweet 34 aaa abcd 2016/0719 本日、野球選手のイチローが3000本達成！ 1560 aaa hijk 2016/0719 野球選手のイチローが3000本達成した模様 上記結果を各行ごとに別のシート（別のウィンドウ）に表示させたいです（この場合では２ウィンドウ）。 現在の進捗状況といたしましては、 シート１ データベース シート２ 入力条件 として、シート２に検索したい単語を入力し、別のシートに表示させるという段階までなんとかいけました（非常にアナログです笑）。 上のほうで述べた仕様には程遠いため、質問を投稿しております。 大きな課題点としては、 ①現段階では、条件検索の指定した単語を含むツイートがある行を抽出することはできるが、ほかの条件も同時に満たす検索をできない。（idやdate、nameなども同時に指定したい。） ②仮に結果が100件あったとして、それがすべてシート３に表示される。 （100件あるなら、100シートにそれぞれ表示させたい ③シート２に条件を入力し、実行することで結果を得ているが、シートではなくユーザーフォーム画面に入力し、結果もそのような画面で得たい。（そもそもこれは可能なのでしょうか？） 非常に長くなりましたが、以上、よろしくお願いいたします。 （わかる部分だけでもご回答いただければ幸いです。） 以下に、現段階でのコードを示します。 -------------------------------------------------------------------------------------------------------- Const SHEET1 As String = "sheet1" 'ツイートDB Const SHEET2 As String = "sheet2" '条件シート Const SHEET3 As String = "sheet3" '結果シート Const COL_TW As Integer = 5 'ツイートのある列 Const INT_EM As Integer = 5 '条件項目列数 Sub tweet() Dim Endrow As Long Dim Editrow As Long Dim EmName As String Dim ws As Worksheet EndrowTw = Worksheets(SHEET1).Cells(Rows.Count, COL_TW).End(xlUp).Row Editrow = 1 For m = 1 To INT_EM EmName = Worksheets(SHEET2).Cells(1, m).Value endrowEm = Worksheets(SHEET2).Cells(Rows.Count, m).End(xlUp).Row For Each ws In Worksheets If ws.Name = EmName Then Application.DisplayAlerts = False Worksheets(EmName).Delete Application.DisplayAlerts = True End If Next ws Set ws = Worksheets.Add() ws.Name = EmName For i = 2 To EndrowTw For k = 2 To endrowEm If InStr(StrConv(Worksheets(SHEET1).Cells(i, COL_TW).Value, vbWide), StrConv(Worksheets(SHEET2).Cells(k, m).Value, vbWide)) Then Worksheets(SHEET1).Select Worksheets(SHEET1).Rows(i).Select Worksheets(EmName).Rows(Editrow).Value = Selection.Value Editrow = Editrow + 1 Exit For End If Next k Next i Editrow = 1 Next m End Sub
2013マクロについてです。L3が空白でなければ今まで通りのコードを、空白なら警告表示をしたいのですがIFを入れてから Sheets("###").Select の行が黄色表示になります。 訂正をお願いしますm(_ _)m Sub A1データ転送() ' ' If Range("L3") = "" Then MsgBox "担当名を入力してください！" Else Sheets("###").Select Rows("2:2").Select Selection.Copy Sheets("売上").Select Range("A1").Select Selection.End(xlDown).Select Selection.End(xlDown).Select Selection.End(xlUp).Select ActiveCell.Offset(1, 0).Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Sheets("伝票入力").Select Range("T2:AA5,L4:P5,C8:V11,H13:I69,Q13:R69,Z13:AA69").Select Selection.ClearContents Range("A1").Select MsgBox "転送完了" End If End Sub
Visual Studio(VB)についての質問です。テキストボックスに打込んだ文字数を認識する、というプログラムを作っているのですが、「ちゃ」「ちょっ」などの拗音を一文字として処理することに手間取っています。 例：「さかな」⇒３文字 「しゃけ」⇒２文字 どうすれば特定の文字を１文字として処理させることができるのでしょうか。 回答よろしくお願いいたします。
アクセスＶＢＡでレコードを更新したいのですが。。。 テーブル01の項目01の最大値を取得して、 テーブル02の項目01に【テーブル01の項目01の最大値 + 1の値】をいれたいのです。 また項目02も同様の処理をしたいと思ってます。 またテーブル02の項目03の最終行まで、処理したいです。 初心者の為、ご指導よろしくお願いします。 □現在【テーブル01内容】 項目01 項目02 1 2 2 3 3 4 4 5 . . . . . . . . 15248 15249 ■現在【テーブル02内容】 項目01 項目02 項目03 空白 空白 ＡＡＡ 空白 空白 ＢＢＢ 空白 空白 ＣＣＣ 空白 空白 ＤＤＤ ★★★★したいこと【テーブル02】★★★★ 項目01 項目02 項目03 15249 15250 ＡＡＡ 15250 15251 ＡＡＡ 15251 15252 ＡＡＡ 15252 15253 ＡＡＡ 15253 15254 ＡＡＡ 15254 15255 ＡＡＡ 15255 15256 ＡＡＡ
a.sql、b.sql、c.sqlと、複数のSQLスクリプトファイルがあります。これを、一つの接続でVBAから連続実行するには、具体的にどう記述すればいいでしょうか。
Excel VBAのforについてお願いいたします。 下記のコードで要素の値をシートへ横一列で取得したいのですが、 最後の要素だけががたくさん並べらてしまいます。理想では ABCDEFGHIJK ですが実行結果では KKKKKKKKKKK となってしまいます。 下記のコードを修正していただきたいです。 詳しい方ご教示いただけないでしょうか？ よろしくお願いいたします。 For i = 2 To 10 For K = 6 To 20 For j = -1 To 20 Worksheets("○●").Cells(i, K + 1).Value = _ objIE.document.getElementsByClassName("○○")(j + 1).outerText Next j Next K Next i
VBA初心者です。 Excelのブックが2つ開いています。 アクティブブック（Book1）は未保存の状態です。 もうひとつは，既存のファイル（DATA1）でシートが10枚ほどあります。（Sheet1，Sheet2...） アクティブではないブックのシート名をアクティブブックのセル（A2）に貼り付けたいのですが，方法がわかりません。 既存ファイルのシート名（Sheet1）をアクティブブックの1枚目，Sheet2を2枚目...の同じセルに貼り付けたいです。 コードはこんな感じです。 Sub test() Dim i As Long Dim mySheetCnt As Long Dim mySheetName As String mySheetCnt = ThisWorkbook.Sheets.Count For i = 1 To mySheetCnt mySheetname = Sheets(i).Name Sheets("Sheet1").cells(2, 1).Value = mySheetName Next i End Sub このコードだと，アクティブブックのシート名が貼り付けられてしまいます。 アクティブではないブック（DATA1）のシート名を取得する方法をご教示ください。
下記の例を教えて下さい。VBA エクセル2013 C列の各セルの値がマイナスの場合は、E列にプラスにして貼り付ける。（同行） ただし、E列の同行にすでに値が入っている場合はその行は貼り付けしないという条件でマクロを作成したいのですが、まだ、記録レベルですので、教えて下さい。VBA
エクセルＶＢＡのリストボックスについて。 ●ColumnCountプロパティが「２」のリストボックスで、１列目に数値を入れます。２列目は空欄です。 ●２列目が空欄であれば、処理を行う。こんなコードを書いています。 しかし、どうしても２列目が空欄、もしくはNull値であることを判断できません。 ------------------ Dim i As Long Dim listCnt As Long If TextBox1.Text <> "" Then ListBox1.AddItem TextBox1.Text TextBox1.Text = "" TextBox1.SetFocus End If listCnt = ListBox1.ListCount For i = 0 To listCnt - 1 ①If ListBox1.List(i, 1) = "" Or ListBox1.List(i, 1) = Null Then ・ ・ 【処理】 ・ ・ End If ② Debug.Print "ListBox1.List(" & i&; ", 1)"; ListBox1.List(i, 1) next i ------------------ 以上、コードの抜粋ですが、②のところでは、Nullが示されました。 ですので、①のあと、【処理】に進んでくれると思うのですが、どうしても②へ抜けてしまいます。 ①条件式の、「Or」から後半は、 ListBox1.List(i, 1) = "Null" Then とも書いてみましたが、うまくいきません。 どこを勘違いしているのでしょう。 お助け下さい…。
VBAで下記の処理がしたいのですが、まだどう組めば良いのかわかりません。教えていただけないでしょうか？ Dドライブにあるhoというtxtファイルをエクセルのhoシートに取込、hoシートが無ければ追加、あれば、ho2のシートを作成しカンマ、タブで区切り取込し、その後、A列を起点に同じ数字があれば、列ごと削除し、行を詰める。 複数回取込ため、シート名は2..3..4と、取込した際にシートがあれば増えて行く仕組みで追加したい。
VBAで下記の事がしたく、教えて下さい。1・hoシートのＡ2より文字が入力されている所までコピーし、kシートのB6セルへ貼り付ける 2.hoシートのE2より文字が入力されている所までコピーし、kシートのC6セルへ貼り付ける 3.hoシートのAD2より文字が入力されている所までコピーし、kシートのF6セルへ貼り付ける 4.hoシートのAC2より文字が入力されている所までコピーし、kシートのG6セルへ貼り付ける を作りたいんですな、下記のコードではうまくいきません。 根本的に書方が違うと思うのですが、 ご教授をお願いします。 Sub 転記() Dim st1 As Worksheet Set st1 = Worksheets("ho") Sheets("ho").Select st1.Range("A2", Cells(Rows.Count, 1).End(xlUp)).Copy Sheets("k").Select Range("B6").Select ActiveSheet.Paste Sheets("ho").Select st1.Range("E2", Cells(Rows.Count, 1).End(xlUp)).Copy Sheets("k").Select Range("C6").Select ActiveSheet.Paste Sheets("ho ").Select st1.Range("AD2", Cells(Rows.Count, 1).End(xlUp)).Copy Sheets("k").Select Range("F6").Select ActiveSheet.Paste Sheets("ho").Select st1.Range("AC2", Cells(Rows.Count, 1).End(xlUp)).Copy Sheets("k").Select Range("G6").Select ActiveSheet.Paste End Sub
エクセル関数マクロに詳しい方、ご教授をお願いします。 a列３：11に品名入力、d列に品名マスターがある。b列3:11にそれぞれの数量入力すると、d列の品名マスターにa列に入力した品名と数量がe列に数量が反映される表です。 e列には、関数設定がある。 各品名の合計を最大で２５個にして容器に収納したいです。 その容器には、最大で２５個しか入りません。 混収納は、可能です。 例えば リンゴ「２５個」で１容器 バナナが５０個なので、「２５個」「２５個」で２容器 トマト「７個」イチゴ「７個」ナシ「１個」で１容器 下記 図のように、マクロ実行で出来ないでしょうか？ 教えてください。 マクロ入門者です。 よろしくお願いします。 c列は、作成されてますが（容器に種類が記入されます）、列として考えてください。 左表から容器収納指示（右表）にしたいです。 右表は、マクロ実行で表示されるようです。 端数がでたら、それも１として収納します。
Excel VBAの内容で質問させて頂きます。 あるサイトでストップウォッチ機能のプログラムを見つけて実行させていたのですが、実行中にセルに文字入力をするとカウンターの表示が止まってしまいます。文字を入力をしてもカウンターが止まらずに動き続ける(時間計測表示が更新される)ようにするためには、どうすればよろしいでしょうか？ 構文は下記の通りです。 -------------------------------------------------------------------- Private blnStop As Boolean Private blnStart As Boolean Sub StopWatch() Dim dblTimer As Double If blnStart = True Then blnStop = True Exit Sub End If blnStart = True blnStop = False dblTimer = Timer Do Until blnStop = True Cells(1, 1) = Int((Timer - dblTimer) * 100) / 100 DoEvents Loop blnStart = False blnStop = False End Sub -------------------------------------------------------------------- 何卒、ご教授の程よろしくお願い致します。
Excel2010での複数のCHANGEイベントを実行したいのですが、方法がわかりません。現在下記のような状態になっているのですが、 Private Sub Worksheet_Change(ByVal Target As Range) If Target.Count > 1 Then Exit Sub If Intersect(Target, Range("E5:E14")) Is Nothing Then Exit Sub If Target.Value = "AC" Then Range("Q" & Target.Row).Value = "【社名の明記必須。不明の場合は不明と明記。】" ElseIf Target.Value = "PC" Then Range("Q" & Target.Row).Value = "【どの製品がPCにあたるのか明記必須】" Else Range("Q" & Target.Row).Value = "" End If End Sub これと同時に、 ■C5：C14のセルがプルダウンになっており、そこで「No」と選択されたら、 MsgBox "アプリケーションは入力必須です" が起動、No以外のものが選択された時は何も起きないようにしたいです。 ご教示よろしくお願いいたします。
エクセルVBAで以下のことができないか教えて下さい。 Sheet1に以下のリストがあります。__B列_____C列_____D列 1_いわし___さんま____さけ 2_たまねぎ 3_リンゴ___メロン 4_牛肉 5_ガム_____あめ 6_チョコ VBA実行後、Sheet2に対して以下のリストが作成される。 __A列 1_いわし 2_たまねぎ 3_リンゴ 4_牛肉 5_ガム 6_チョコ 但し、1、3、5行目には入力規則リストが設定されてA1セルの”いわし”をクリックするとドロップダウンリストで”いわし”、”さんま”、”さけ”が選択できるようにしたいです。 その他、2、4、6行目は他に選択リストがない為、入力規則リスト設定されないようにしたいです。 入力規則が設定されたセルにはセルの書式設定で黄色く色付けしたいです。 すいませんが、ご教示お願い致します。
LaTeXについての質問です。 数式の中で改行を行うにはどうしたらいいのでしょうか？普通に\\をつかっても改行が行われていませんでした。
エクセルのVBAについて。 下の画像の1列目の10桁の数値の頭6桁を抽出し、抽出した数値が同じ範囲の平均値をVBAで算出したいです。 VBA初心者なのでわかりやすく教えて頂きたいです。
計画一覧を作成したい。 製品毎に毎日どれだけ加工したらいいか計画を組むVBAを作りたいです。 まず画像IとSの列に1週間の計画を入れます。そして製品毎に日々どれだけ加工したらいいかをVBAで計算させます。 (ここで、平均値ではダメで1箱の数量をベースにした数字が入るようにします。) 計算させる際、12行目と20行目に日毎の合計が入っていますが、 ここの数字がバラつきが少なくなるようにプログラムを組みたいです。 どなたかわかる方、ご教授ください。 (もしVBAで無理そうでしたらゴールシークやソルバーなどでのアイデアでも構いません。) よろしくお願い致します。
Excel VBAの構文に関する質問です。 以下のことを実行したいと考えています。・B2～V2に整理番号、A15～A35に左と同様の整理番号 ・B3～V3に数値（空白有） ① B3の数値を、シート2（特殊な計算をするためのシートで複雑すぎて切分け不可）のA2へ貼り付けし、するとシート2のU4～U33に値が出るため、これをシート1のB15～V15に貼り付ける ② ①をV列まで行う（C3の結果は16行へ、D4の結果は17行へ・・・V3の結果は35行へ） VBAを勉強し始めていたので今まで時間が掛かっていた作業を時間を掛けて効率化しようと考えておりましたが、予定外に急遽このプログラムが必要になってしまったため質問をさせていただきたいと思います。（自分で作らないと身にならないのは理解しておりますが緊急のためご理解願います・・・）
2シート間で削除されているもの、追加されているもの、変更されているものを知りたいsheet1 注文番号 注文品 顧客名 111 めがね aaa 222 靴 bbb 333 洋服 ccc 444 バッグ ddd sheet1 注文番号 注文品 顧客名 111 めがね aaa 222 靴 bbb 333 洋服 fff 555 ペン eee 注文番号からそれぞれA1セル、B1セル、C1セルです。 sheet1が前日、sheet2が当日とします。 当日で前日と比べて削除されているもの、追加されているもの、変更されているものが分かる関数、マクロを知りたいです。 ここでは 444 バッグ ddd 555 ペン eee 333 洋服 fff ですがこれが何万件もあると目視で確認するのはキツイです、、、 =EXACT(Sheet1!A1,Sheet2!A1) で削除されたものから調べようと思ったのですが これでは削除と追加と変更が全てでてきてしまうことに気づきました… 主キーが注文番号ですのでそこを使ってできないかといろいろ調べたのですがなかなかうまくいきません。 よろしければ無知な自分に教えていただけないでしょうか。 よろしくお願いします。
アクセス2013について質問です。 撮影した写真にIDを付けて「\123.456.78.90\MainMenu\QA検査結果記録システム\QA検査画像」フォルダにjpegで保存しています。※ＩＰアドレスはダミーです。 「詳細検索フォーム」の「詳細画像」テキストボックスにそのIDを入力すれば「詳細画像検索表示」フォームに写真を表示できるようにしたいと思っています。 そこで「詳細画像検索表示」フォームに「詳細画像検索イメージ」名のイメージを作成してそのコードビルダーから Private Sub Form_Current() Me!詳細画像検索イメージ.Picture = "\\192.168.85.46\MainMenu\QA検査結果記録システム\QA検査画像" & [詳細検索フォーム]![詳細画像ID] & ".JPG" End Sub ※”/”は実際には”￥”で表示されています。 要は画像までのパスと入力したID番号及び拡張子を１つに結合すればフルパスになり、 そのフルパスを「詳細画像検索イメージ」に代入できれば目当てのIDの画像が表示されるのではないかと考えましたが上手く行きません。 どこが間違っているのでしょうか?? いつもいつもわからないことばかりですみません。 どなたかご教示頂けませんでしょうか？
マクロで集計表Ａ表とＢ表にある小計及び合計欄に数式の埋め込み方法を何方かご教授を、お願いいたします。 合計のＳｕｍＩｆが全く動かない状態で、どこが悪いのかが分かりません。表の構成は下記のとおりです。 ①小計、合計の位置は可変になります。 ② sidx = 33はデータの最初の行になります。 ③ Ａ表は小計、合計はＹ列に書いています。Ｂ表はＡＩ列にあります。Ａ列Ｙ３３以降に小計は何箇所にも ありますＢ表も同様です。 ④ Ａ表の小計（Ｓｕｍ）式は連続した７列になる。（ＡＡ，ＡＢ，AC，AD，AE，AF，AGの7列）、Ｂ表は（ＡＫ，ＡＬ，ＡＭ，ＡＮ，ＡＯ，ＡＰ，ＡＱ）の7列 ➄ 合計（ＳｕｍＩｆ）式の挿入列は上記と同じ。 Ａ表の小計はまがりながら出来ている状況と思います。 Sub Samp1() Dim r As Long, j As Long, sidx As Long Application.ScreenUpdating = False '画面の制御静止 sidx = 33 'Sum関数の加算最初の行をsidxとする For r = 33 To Cells(Rows.Count, 25).End(xlUp).Row If Cells(r, 25) = "小 計" Then For j = 27 To 33 Cells(r, j).Formula = "=sum(" & Cells(sidx, j).Address & ":" & Cells(r - 1, j).Address & ")" Next sidx = r + 1 End If Next If Cells(sidx, 25) = "合 計" Then For j = 27 To 33 Cells(sidx, j).Formula = "=SUMIF( Range(.Cells(sidx, 25), .Cells(sidx-1, sidx)) ,""小 計"",Range(.Cells(33, j),Cells(sidx-1, j))" Next End If End Sub
VBSのRegExpで "\b(\d(月|日))" と "\b(\d月|\d日)" の違いはなんですか？下のは日付の月日が１桁だったり２桁だったりばらばらなのを2桁に統一するコードです。 別の質問をしたとき "\b(\d(月|日))"は"\b(\d月|\d日)" の方がいいと言われて試しに実行してみたのですが違いがわかりませんでした。RegExpについては初心者です。 Dim re Set re = New RegExp re.Pattern = "\b(\d(月|日))" ' "\b(\d月|\d日)" だとどう違う？ re.Global = True MsgBox re.Replace("2016年7月01日、2016年07月1日、2016年10月25日", "0$1") Set re = Nothing
前回 excel VBAについて質問させていただいた際にリクエストした方に返信ができませんでしたので 改めて再度質問させていただきます。 コンボボックスからリストボックスに ある表を表示させたいのですが、 エラー380 Listプロパティの値が無効です と出ます Private sub ボタン1 Listbox1.clear dim c as range, fa as string, r as long, i as integer with worksheets("sheet2") set c = .range("W:AD").find(combobox1.text, look at:=xlpart) if not c is nothing then fa = c.address do r = c.row Listbox1.additem .Range("A" & r).value i = Listbox1.Listcount = 1 Listbox1.List(i, 1) = .range("B" & r).text Listbox1.List(i, 2) = .range("C" & r).text Listbox1.List(i, 3) = .range("D" & r).text Listbox1.List(i, 4) = .range("E" & r).text Listbox1.List(i, 5) = .range("K" & r).text Listbox1.List(i, 6) = .range("L" & r).text Listbox1.List(i, 7) = .range("M" & r).text Listbox1.List(i, 8) = .range("N" & r).text Listbox1.List(i, 9) = .range("O" & r).text Listbox1.List(i, 10) = .range("P" & r).text Listbox1.List(i, 11) = .range("Q" & r).text Listbox1.List(i, 12) = .range("R" & r).text Listbox1.List(i, 13) = .range("S" & r).text Listbox1.List(i, 14) = .range("T" & r).text Listbox1.List(i, 15) = combobox1.text set c = .Range("W:AD").findnext(c) if c is nothing then exit do loop while c.address <> fa end if end with end sub 上記コードで エラー380 Listプロパティの値が無効 や プロパティの配列のインデックスが無効 と出ます どこの部分が間違っているのでしょうか。 ご教授いただけると幸いです
マクロ初心者です。 まだ勉強を始めたばかりで、人の作った簡単なマクロを少し直すことができる程度だったのですが、急に一から全て作らなくてならなくなりました。緊急で、一から勉強している時間が全くないので一部だけでもどうか助けて下さい。 作成したいのはAファイルです。（毎回「資料07月」のように、その月をファイル名に入れたい） シートは海外と国内の二つ。フォーマットがあり、それを使って新しいファイルを毎月作りたい。 B,C,Dファイルから指定列にデータを持って来たい。 データの数は数十行。 毎回行数は変わりますが、データの最後に総計行を入れたいです。 AファイルのA1のタイトルにはプルダウンで選択した数字をいれ、A5以下にもデータがある分だけ（総計行まで）プルダウンで選んだ数字を入れたいです。 ・B→Aファイル BファイルBシートのD列からAファイルの国内シートのH列へ BファイルBシートの総計（毎回列が動く）からAファイル国内シートのK列へ ※ Aファイルのデータには間に空白行がいくつもありますが、この空白行はもってきたくないです。 ・C→Aファイル Cファイルのシート名に「C」を含むシートのC列から、Aファイルの海外シートH列へ O列からK列へ ※ こちらも空白行は無視で。 ・D→Aファイル 国内シートに先ほど持ってきたH列のナンバーをキーに、DファイルDシートからそれぞれの項目を転記。 AH→AHのように・・・ ・D→Aファイル 海外シートに先ほど持ってきたH列のナンバーをキーに、DファイルDシートからそれぞれの項目を転記。 ※ただし、国内と違いOP列のみナンバーのハイフンの後が★でなかったらQR列に、★だったらOP列に入れる。 雑ですみませんが、こんな感じです。 よろしくお願い致します。
VBAでセルを削除した場合ですが、下のセルが上に寄ってくると思います。 右のセルを左に寄せるにはどうしたらいいですか？
Excel 2010 を利用してます。Dim j As Single For j = 10 To 1000 Cells(i, 5).NumberFormatLocal = "#0.0 " Select Case True Case (Cells(j, 5) > 0 And Cells(j, 5) < 180) Cells(j, 5).Interior.Color = RGB(0, 0, 255) Cells(j, 5).Font.Color = RGB(255, 255, 255) Case (Cells(j, 5) >= 180 And Cells(j, 5) < 350) Cells(j, 5).Interior.Color = RGB(255, 0, 0) Cells(j, 5).Font.Color = RGB(255, 255, 255) Case Cells(j, 5) >= 350 And Cells(j, 5) <= 1000 Cells(j, 5).Interior.Color = RGB(255, 0, 255) Cells(j, 5).Font.Color = RGB(255, 255, 255) End Select Next 上記コードについてですが、 セルの値が65であれば、セルを青で塗りつぶし、文字が白くなるとおもうのですが、セルの値が、65で、反応する場合と、反応しない場合があるのです。 VBA以外で、条件式を設定すると、全てのセルが正しく反応するのですが、なぜ、VBAのときに反応しないのが、わかりません。詳しい方、ご教示お願いできないでしょうか？
エクセルマクロで質問です。 表を行で上から順番に処理をしていき、終わったら次の列の処理を するコードの書き方がよくわかりません。画像のような表があります Do Until Sheets("AAA").Cells(i, 1) = "" If Sheets("AAA").Cells(3, 2) >= Sheets("BBB").Cells(4, 2) And Sheets("AAA").Cells(3, 2) <= Sheets("BBB").Cells(5, 2) And Sheets("AAA").Cells(i, 2) Like "*みかん*" Or Sheets("AAA").Cells(i, 2) Like "*りんご*" Then Sheets("AAA").Cells(3, 2).Copy Sheets("CCC").Cells(h, 2) Sheets("CCC").Cells(h, 3) = "果物" Sheets("AAA").Cells(i, 1).Copy Sheets("CCC").Cells(h, 4) Sheets("データベース").Cells(h, 5) = 1000 i = i + 1 h = h + 1 Else i = i + 1 End If Loop 1行目を上のやり方で読んでみかんとリンゴを含むデータだけ別シートに選択して追加しています。 2行目はCellsの行を3にして繰り返せば、処理はできますが、実際には日付は1月分あるので やたら長いコードになってしまいます。FOR～NEXTを使えばよい様な気がしますが、うまくいきません。当方マクロは初心者です。 ご教授をお願いします。 よろしくお願います。
VB2015において、文字列からある文字を抽出したいです。具体的には、 Color [A=255,R=50,G=100,B=200] という文字列から、 50 100 200 という文字を抽出し、それぞれを異なるラベルに表示したいです。 「○文字目から△文字抽出する」というものは見つけましたが、この数字部分は一桁から三桁まで変わるため、それができません。 どなたかご教授よろしくお願いします。
エクセルマクロについて質問させて下さい。 ある行、B10からAW10までの間に複数の直線を引いたとします。空白のセルがいくつもあるんですが、直線から直線までの距離が一番長いセル範囲を調べて書き出すことは可能でしょうか 画像ではAF10からAN10の9個が一番長い空白のセル範囲になります。 それを調べて書き出すコードをわかる方いらっしゃいましたらお願いします。
アクセス2013のクエリ式について質問です。「検査表」テーブルを元に作った 「詳細検索」クエリで、 「詳細検索」フォームのテキストボックスやコンボボックスに入力した内容で 「検査表」テーブルから検索するシステムを作っています。 ①「詳細検索」フォームの「詳細開封不良内容」コンボボックスで選択した内容が ②「開封不良内容」フィールドもしくは「開封不良内容２」フィールドのどちらかに 有れば 検索結果として出力したいのですが、 式に [Forms]![詳細検索フォーム]![詳細開封不良内容]=[開封不良内容] Or [開封不良内容2] と入力しても上手く行きません。 どの様にすれば良いのでしょうか？ どなたかご教示頂けませんでしょうか？ どうぞよろしくお願い致します。
VBA初心者なので教えて下さいm(_ _)m For〜NxetとOn Error Gotoについて質問です。 エクセルのセル、A列に数字、C列に文字が入っています。 sub test()で作っていくとしてinputboxで「番号を入力して下さい。」を出します。A列にある数字が打たれたら右にあるC列にある文字がでるようにしたいです。 間違えてinputbox内に文字が打たれてしまった場合はエラーメッセージ「数字を入力して下さい。」を出して、またinputboxの「番号を入力して下さい。」とループになるように作りたいです。 基本的なことかもしれませんがよろしくお願いします！
マクロを実行したら画像の表示が出ます。表示を出ないようにしたいのですが、どのようにすればいいですか
ワークシートのイベントモジュールでこのプログラムを実行すると失敗します。 エラー番号は”1004” アプリケーション定義またはオブジェクト定義のエラーです。 となります。イベントモジュールでは複数のセルを選択できないのでしょうか？ 因みに単一のセルのセレクトなら問題なくできました。 Private Sub Worksheet_Change(ByVal Target As Range) Worksheets(1).Activate Worksheets(1).Range(Cells(288, 11), Cells(311, 11)).Select End Sub
三菱製の三次元ＣＡＤ／ＣＡＭは使い勝手はいいですか？ 今、三次元ＣＡＤ／ＣＡＭを探しています。 誰か詳しい方教えてくれませんか？
エクセル(EXCEL) VBAについて教えてください。 EXCEL2010を使っています。 教えて頂きたいのは、配列についてです。例えば、Sheet1 の Range(Cells(1,1),Cells(2,2) を 配列で、DataRangeという変数に格納します。 次に、Sheet1 の Range(Cells(5,5),Cells(6,6)) を 配列で、DataRangeに格納します。 これを3次元で格納したいのですが、どう記述すればよいでしょうか？ イメージとしては、前者は、DataRange( , , 0) 、後者は、DataRange( , , 1) を 考えています。 よろしくお願いいたします。
EXCEL関数で、3桁の数字8通りの組合わせを表示する方法を教えていただけますでしょうか？（条件） １）1セル内に、3桁の数字を表示 ２）数字の範囲は1,2,3,4,5,6の計6種類 ３）3桁の内、先頭の1桁目は固定 ４）3桁の内、ある数字は2桁目か3桁目のどちらかに必ず入る ５）3桁の内、残りの数字は上記３）４）以外の数字でかつ、2桁目か3桁目に入る ６）3桁を構成する数字がダブる（同じセル内に2回以上現れる）ことはない （例） ・先頭1桁目（固定）がいつも「1」だとする ・2桁目か3桁目に必ず「4」が入るとする ・この場合の8通り（3桁）の組み合わせ 142、143、145、146、124、134、154、164 たとえば実際には、B1セルに以下のような数字（2桁）が入っています 14 このB1セルの2桁の数字を参照して、 先頭の「1」は固定とみなし、 2桁目の「4」は必ず2桁目か3桁目に現れるとみなして、 3桁の数字を、C1セルからJ1セルまでに8個表示します。 （結果） 142 | 143 | 145 | 146 | 124 | 134 | 154 | 164 ※1セル内に3桁ずつ表示 これをEXCEL VBAではなく、EXCEL関数で実現できないでしょうか？ どうぞご教示お願いいたします。
ExcelVBAについて質問です。引数の意味や使い方がわかりません。 subのあとの()中にあるやつです。 そもそもどのような時に使うのでしょうか？ callで呼び出すのと同じでプログラムをすっきりみせたり、 使い回しをしたりする為でしょうか？
エクセルをコピーして貼り付けすると「実行時エラー'1004'一度に変換できるのは１列だけです。範囲には複数の行を選択できますが、列は１列しか選択できません。１列だけのセル範囲を選択し、再度実行してください。」と表示されます。その後のコードがこのようになっているのですが何が原因でしょうか
Excelマクロについての質問です。2003では使えた下記マクロが2007以降では使えなくなってしまいました。どこが悪いのかご指南して頂けないでしょうか。よろしくお願い致します。Dim pathname As String pathname = ThisWorkbook.Path Dim kjA As String Dim kjB As String Sheets("ファイルリスト").Select On Error Resume Next Range("K11:L11").Select Kill pathname & "\" & ActiveCell.Value Range("K12:L12").Select Kill pathname & "\" & ActiveCell.Value Range("K13:L13").Select Kill pathname & "\" & ActiveCell.Value Range("K14:L14").Select Kill pathname & "\" & ActiveCell.Value Range("K16:L16").Select Kill pathname & "\" & ActiveCell.Value Range("K17:L17").Select Kill pathname & "\" & ActiveCell.Value Range("K18:L18").Select Kill pathname & "\" & ActiveCell.Value Range("K19:L19").Select Kill pathname & "\" & ActiveCell.Value Range("K20:L20").Select Kill pathname & "\" & ActiveCell.Value Range("K21:L21").Select Kill pathname & "\" & ActiveCell.Value Range("K22:L22").Select Kill pathname & "\" & ActiveCell.Value Range("K23:L23").Select Kill pathname & "\" & ActiveCell.Value ' Sheets("ファイルリスト").Select kjA = Range("B1").Value kjB = Range("D1").Value Range("B4:B65536").Select Selection.ClearContents Range("B4").Select ' Set fs = Application.FileSearch With fs .LookIn = pathname & "\" .Filename = kjA & "." & kjB If .Execute > 0 Then MsgBox .FoundFiles.Count & " 個の" & .Filename & "ファイルが見つかりました。" For i = 1 To .FoundFiles.Count ActiveCell.Value = .FoundFiles(i) ActiveCell.Offset(1, 0).Range("A1").Select Next i Else MsgBox .Filename & "ファイルは見つかりませんでした。" End If End With ' Range("B4").Select End Sub
エクセルで表を作っています。商品の寸法: 23.0124 X 18.9992 X 8.9916 センチメートル 商品重量: 0.4082 キログラムこの文字列から商品寸法の23.0124 X 18.9992 X 8.9916の３辺の合計寸法を抜き出して計算したいですが他の方のマクロを拝見してやってみましたが全ての数値が合計されたり全て表示されたりで全く上手くいきませんでした。23.0124 X 18.9992 X 8.9916を抜き出して計算出来る詳しい方いらしたらよろしくお願いします。
VBAの配列について すいません、初心者です。 多次元配列を行いたいのですがうまくいきません。かなり初歩的な質問だと思いますが どなたかご教授お願いします Dim MemberA() As String ReDim MemberA(2) MemberA(1) = "morita" MemberA(2) = "yamada" MemberA(3) = "kato" Dim MemberB() As String ReDim MemberB(2) MemberB(1) = "hamada" MemberB(2) = "matsumoto" MemberB(3) = "kato" Dim MemberC() As String ReDim MemberC(2, 2) MemberC(1, 1) = MemberA(2) MemberC(2, 2) = MemberB(2) MsgBox MemberC(1, 1) ’← morita と表示させたい
visual studio初心者です（;￣O￣）授業の課題で、マウスをクリックするとカーソルに無数の円が集まり離すと散るというプログラムをしなくてはならないのですが、1度クリックすると離しても円が散らないようになってしまいました。 何をどこに書き足せば、マウスを離したとき円が離れていきますか？？ 回答よろしくお願いしますm(_ _)m
エクセルのマクロについて教えてください。 ある表でA3からZ3まで入力されたもので最終行が定まっていない表が複数シート(これも100シート程で定まっていません)あります。(A列には必ず入力がありますが、Z列は入力があるときとないときがあります) F列が空白のもの以外でオートフィルターをかけ、その空白範囲を水色に色付けしたいです。(A2からZ2が見出しになっているのでそこにオートフィルターをかけています) 自分でマクロを組んでみたのですが、すべてのシートにフィルターはかけれたのですが、最終セルの取得方法がわからず、空白範囲に色付けできませんでした。 マクロで組む必要があるので、どなたかマクロのコードをご教授ください。
エクスプローラのフォルダーオプションの［表示］タブにある設定をVb.Netから変更したいと考えております。 以下のコードで試みました。My.Computer.Registry.SetValue( _ "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced", "AutoCheckSelect", 1) すると、なぜかこれがエクスプローラに反映されません。レジストリエディタで「AutoCheckSelect」を見てみると値は「1」に変わっています。 また次のコード My.Computer.Registry.SetValue( _ "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\CabinetState", "FullPath", 1) では、同様にレジストリエディタの「FullPath」の値は変わっていて更に、エクスプローラ上のツール→フォルダーオプション→表示の詳細設定の中にある「タイトルバーにファイルのパス名を表示する」にチェックマークが入っているにもかかわらず、タイトルバーにパス名は表示されません。 変更した設定値をVBを使って反映させる方法を教示願います。
Excelの最終列の値の取得について Excel2010を利用しています。名前 日時1 日時2 日時3 日時4 最後の日 A 6/5 6/9B 7/1 7/10 7/15 C 2/1 D 3/5 3/6 日時は文字列です。 最後の日に 日付を表示したいのです。 A⇒6/9 B⇒7/15 C⇒2/1 D⇒3/6 Dim a As String Dim i As Long For i = 2 To 700 a = Cells(i, Columns.Count).End(xltoRighet).EntireColumn Cells(i, 14) = a Next アプリケーション定義または、オブジェクトの定義エラーです。となります。 どのようにコードを記載するのかご教示お願いします。
エクセル関数マクロに詳しい方、ご教授をお願いします。 a列３：11に品名入力、d列に品名マスターがある。b列3:11にそれぞれの数量入力すると、d列の品名マスターにa列に入力した品名と数量がe列に数量が反映される表です。 e列には、関数設定がある。 各品名の合計を最大で２５個にして容器に収納したいです。 その容器には、最大で２５個しか入りません。 混収納は、可能です。 例えば リンゴ「２５個」で１容器 バナナが５０個なので、「２５個」「２５個」で２容器 トマト「７個」イチゴ「７個」ナシ「１個」で１容器 下記 図のように、マクロ実行で出来ないでしょうか？ 教えてください。 マクロ入門者です。 よろしくお願いします。
Excel VBA初心者です。 質問させていただきます。画像を挿入するマクロを現在下記のコードで実行しているのですが、 パソコンを変えたり、メールで送ると 「リンクされたイメージを表示できません」 と出てきます。 自分のパソコンではしっかり実行できるので、リンクに問題があるのかと思うのですが、 どのようにすればいいのかがわかりません。 どのパソコンでも見れるようにするには、画像ファイルを一緒に送る以外 どうすればいいでしょうか？ Sub 画像挿入() Dim Path As String, WSH As Variant, File As String Set WSH = CreateObject("WScript.Shell") Path = WSH.SpecialFolders("Desktop") & "\" ChDir Path Range("D8:Q28").Select File = Application.GetOpenFilename( _ FileFilter:="画像 ,*.jpg; *.gif; *.bmp", MultiSelect:=False) If File <> "False" Then With ActiveSheet.Pictures.Insert(File) .Left = Selection.Left .Top = Selection.Top .ShapeRange.LockAspectRatio = False .Width = Application.CentimetersToPoints(13.34) .Height = Application.CentimetersToPoints(10) .ShapeRange.ZOrder msoSendToBack End With End If End Sub
VBScriptのRegExpで、7月01日とか07月1日とか月日の桁がばらばらなのを07月01日というふうに２桁に統一したいです。下のXXXの部分をどういうふうにすればいいですか？他にも変えるところはありますか？ Dim re Set re = New RegExp re.Pattern = "\b(\d(月|日))" re.Global = True MsgBox re.Replace("2016年7月01日、2016年07月1日", XXX) Set re = Nothing
複数のセルを一度に選択して、その中身を一度にクリアするマクロのコードをご教示下さい。自分で作ったマクロ Dim i, o As Variant For i = 8 To 548 Step 15 For o = 17 To 557 Step 15 Range(Cells(i, "H"), Cells(o, "BH")).ClearContents Next Next では、ワンブロックを選択して、そこをクリアしてまた次のワンブロックを...と非効率で 長時間かかってしまいます。 愚直にRange("H8:BH17,H23:BH32"........).ClearContentsとすれば解決できますが もっとシンプルに記述できないのでしょうか？ 選択するブロックは等間隔に配置されています。
VBA初心者なので教えて下さいm(_ _)m For〜Nxetについて質問です。 a=inputbox(”数字を入力して下さい”) にしてaに8を入れた場合にFor〜Nxetを使用して1+2+3+4+5+6+7+8をするプログラムを作り、答え36と出るようにしたいのですがどのようにしたらよろしいでしょうか？ 基本的なことかもしれませんがよろしくお願いします！
エクセルでの順列の出し方について。 C、G、Bという三つの単語を並べて、全ての並べ方を確認したいです。①4文字使うもの、5文字使うもの、6文字使うもの、7文字使うもの、8文字使うものをそれぞれ出したいです。 ②CCGのように、同じ文字が続けて重なるのを取り除きたいのです。CGCGCBのように、同じ数字を複数回使うのは大丈夫です。 ③特に8文字のものなど、400近くなる長いリストになるとはおもうのですが、全てがリストになって見える形になっていてほしいです。 エクセルも順列も全くの初心者なので、手順などを細かく教えていただけると嬉しいです。 必ずしもエクセルである必要はなく、例えば簡単に出せるウェブサイトなどでも大丈夫です。
昨日に引き続きで、申し訳ありません。またエクセルマクロで行き詰まってしまい、お知恵を拝借させていただけると助かります。 指定したフォルダ内のエクセルファイルを調べて、Sheet2N1のセル内容と、ThisWorkBookのSheet2N1セルの内容が同じものがあるかないかで処理を分けたいと思い、以下のマクロを組んだのですが、エラーになってしまいます。 Sub テスト() Dim objFSO As Object Dim SavedF As Object Set objFSO = CreateObject("Scripting.FileSystemObject") For Each SavedF In objFSO.GetFolder("C:¥Test¥").Files If SavedF.Range("Sheet2!N1").Value = ThisWorkBook.Range("Sheet2!N1").Value Then MsgBox "同じ記録のファイルが既にあります。",vbOKOnly Else strSaveName = "C:¥Test¥" & ThisWorkBook.Range("Sheet2!N1").Value ThisWorkBook.SaveAs strSaveName End If End Sub 最初のifの所で、実行時エラー438 オブジェクトは、このプロパティまたはメソッドをサポートしていません。 とエラーになり、私なりにFileで検索したのにBookと同じに扱うからダメなのかもと思ったのですが、どうすればいいのかが、わからず。。。。 検索したファイルを、Bookとして開けば操作できることはわかってるのですが、事情があり開かないで判定させたいのです。 よろしくお願いします。
こんにちは。 いつもお世話になっております。マクロにてhtmlファイルの一部を書き換えたいと思っていまして、 ①txtデータに変換後、 ②Replaceメソッドにて変換 ③再度htmlファイルに戻す というマクロを書きました。 置換はうまくいくのですが、一連の作業後にメモ帳で確認すると、文章の一部にダブルクオテーションがたくさんついてしまいます。。 txtに変換するのが問題なのかと思い、csvでも試してみたのですが、ダブルクオテーションの代わりにセミコロンが２つ続く箇所が発生してしまい状況は変わらず。。 なんとかならないものでしょうか。。？ あるいはわたしの書いたマクロがおかしいのでしょうか。 Sub 文字列変更() Dim myPath As String 'フォルダ名用の変数 Dim myFile As String 'ファイル名用の変数 Dim i As Long Dim j As Long Dim k As Long myPath = ThisWorkbook.Path & "￥1310￥" myFile = Dir(myPath & "*.txt") For i = 1 To 100 'フォルダの中のファイルの上限 Workbooks.Open myPath & myFile Set sheet = ActiveSheet For j = 1 To 1500 For k = 1 To 10 If Cells(j, k).Value Like "*" & "http://www43.tok2.com/abcde/" & "*" Then Cells(j, k).Value = Replace(Cells(j, k).Value, "http://www43.tok2.com/abcde/", "../../") End If Next k Next j Application.DisplayAlerts = False Workbooks(myFile).Close SaveChanges:=True myFile = Dir If myFile = "" Then Exit For Next i End Sub
エクセルの文章をコピーしてペーストを簡略化したいです。コピーしたものをペーストする際にマクロボタンを作成してクリックしたら「カンマやタブなどの区切り文字によってフィールドごとに区切られたデータ」でA１に貼り付けを出来るようにしたいです。 どのようなコードになるかお教えください。
VBA FileSystemObject検索の高速化 Excelマクロ（VBA）初心者です。試行錯誤してみましたが、うまくいかないため、助けてください。シート上の選択したセルのファイル名を含むファイルをデータベースから探して、開くというマクロを作成しました。 （インターネット上の情報を参考にしました。http://officetanaka.net/excel/vba/tips/tips36.htm 等） しかし、検索場所のフォルダ数300、総ファイル数28,000 程度あるため、マクロの処理に40秒程度かかってしまいます。 ファイル名を変更して一日に何度も検索するため、ロスが大きく困っています。 マクロを高速化する方法はないでしょうか？ ちなみに、ファイル名、フォルダ構造を変更することは難しいです。 勝手をいい申し訳ありませんが、初心者のため、できるだけ具体的に教えていただけると助かります… Sub ファイル名の一部からファイルを開く方法部分一致() Dim keyword As String keyword = Selection Debug.Print Time Call FileSearch("\\hoge\hoge\", keyword & "*") End Sub Sub FileSearch(Path As String, Target As String) Dim FSO As Object, Folder As Variant, File As Variant Set FSO = CreateObject("Scripting.FileSystemObject") For Each Folder In FSO.GetFolder(Path).SubFolders Call FileSearch(Folder.Path, Target) Next Folder For Each File In FSO.GetFolder(Path).Files If File.Name Like Target Then Shell ("explorer.exe " & File.Path) End If Next File End Sub
別データ（ブック）を対比して重複したセルの横に印をつけるVBA構文について当方、VBAについて入門書の数ページしか読了できていない者なのですが、急遽、業務でVBAを使わなければならない場面が生じており、構文のご教示いただきたく投稿致しました。 行いたい作業は、以下の例のようなことで、例１のようにtest1.xlsxとtest2.xlsxが存在しており、A列のデータを対比して、例２のように、test1.xlsxのA列の左隣の空白のセル（列の挿入は手動で行います）に印（○）を入力をするというものです。 対比が必要なデータが多数存在することから、効率を向上のためにVBAを用いたいと考えています。 なお、test1.xlsxとtest2.xlsxについては、NAS上で管理しており、私以外の者も使用することがあることから、作業はNAS上で行いたいものです。 ●例１ 【test1.xlsx】 A 1 あ 2 い 3 う 4 え 5 お 【test２.xlsx】 A 1 か 2 き 3 う 4 け 5 お ↓ test1を開いた状態でVBAを実行し、例２のようにしたい。 ●例２ 【test1.xlsx】 A B 1 あ 2 い 3 ○ う 4 え 5 ○ お
Microsoft Visual Studio 2015 を使用しています。形を崩さずに動かせるよう、チェックボックスをグループ化させたいのですが、そのような機能はあるのでしょうか。 またあるのであれば、仕方を教えて下さい。 回答よろしくお願いします。
こんにちは。 いつもお世話になっております。 vbaの文字列の置換について教えていただきたく投稿しました。◎やりたいこと http://www43.tok2.com/abcde/という文字列を含むセルが点在しています。 それぞれのセルについて、 http://www43.tok2.com/abcde/ を ../../ という文字列に変換したいです。 ◎試したこと、問題点 いろいろ試してみたのですが、置換したい文字列の前後がなくなってしまいます。 ◎お聞きしたいこと 初心者ですみません。 下のマクロを書いてみたのですが、ご指導をお願いします。 Sub aaa() Dim myPath As String 'フォルダ名用の変数 Dim myFile As String 'ファイル名用の変数 Dim i As Long Dim j As Long Dim k As Long myPath = ThisWorkbook.Path & "\1604\" myFile = Dir(myPath & "*.csv") For i = 1 To 100 'フォルダの中のファイルの上限 Workbooks.Open myPath & myFile Set sheet = ActiveSheet For j = 1 To 100 For k = 1 To 100 '100行100列の範囲で下記の処理をしたい If Cells(j, k).Value = "*" & "http://www43.tok2.com/abcde/" & "*" Then Cells(j, k).Value = "*" & "../../" & "*" End If Next k Next j myFile = Dir If myFile = "" Then Exit For Next i End Sub よろしくお願いします！
プログラム経験が浅いのですが、今VB5でプログラムをしています。教えてほしい事項はコマンドボタンをクリックしてボタンを押した状態でイベントが発生して 同じコマンドボタンをクリックからボタンは離すとイベントが発生するような二つの処理を することは可能ですか
スプレッドシートで↓のようなことがしたいです。A1：123（入力） ↓ [Enter] A1： A2：123（結果） ↓ A1：456（入力） A2：123 A3： ↓ [Enter] A1： A2：456（結果） A3：123 という一番上のセルだけに入力でエンター押したら下にずれてまたそこに入力するみたいなことがしたいです。 リンクを押してツールからスクリプトエディタを選んでもらうと、いけます。お願いします。 https://docs.google.com/spreadsheets/d/1YCQnCBd_Ujt_J_MqdFI-MyjLLos... エクセルだとこれでできるみたいです。 入力するセルが A1 の場合です。 シートタブの右クリックメニューにある"コードの表示"から開くウィンドウに以下を記述し、そのウィンドウを閉じます。 Private Sub Worksheet_Change(ByVal Target As Range) If Target.Address(0, 0) <> "A1" Then Exit Sub Target.EntireRow.Insert Range("A1").Activate End Sub おねがいします。
型が一致しませんと出てきてしまいます y = 4 y2 = 4 Set bookname = ThisWorkbookSet sheetname = ActiveSheet Workbooks("book2.xlsx").Activate If Range(Cells(y2, 1), Cells(y2, 22)) = Workbooks(bookname).Sheets(sheetname).Range(Cells(y, 1), Cells(y, 22)) Then MsgBox ("ok") End If と記述してbook1（マクロが登録されているbook）とbook2の指定した範囲が等しいかどうか調べようとしたのですが、型が一致しませんと返されてします どこをどう修正したらよろしいのでしょうか お分かりになる方がいましたら、よろしくお願いいたします
エクセルの入力作業で、sheet1のA列に店番を入力したイベントにより、sheet2のデータベースをもとに、同じ行のＢ列に支店名を自動的に入力するようにしたいです。関数ではあらかじめsheet1のＢ列にVLOOKUPを入力し、支店名の値を得ることはわかりますが、VBAで処理するにはどのように書けばよろしいでしょうか？ sheet1 以下のようにA列に入力するたびにＢに支店名がはいるようにする。 A Ｂ 1 店番 支店名 2 1 (ここに支店名を自動的に入力する) 3 4 ・ ・ sheet2のデータベースは以下の通りです。 A Ｂ 1 店番 支店名 2 1 ◯△ 3 2 ☆○ 4 3 $$$ ・ ・ VBAについて、初心者です。 よろしくご指導お願いします。
VBA 空の数値型配列を作りたい。' Dim arrVAR() As Variant arrVAR = Array() '※ ReDim Preserve arrVAR(UBound(arrVAR) + 1) arrVAR(UBound(arrVAR)) = 1 配列変数が、Long型またはInteger型の場合の ※の部分を教えていただきたいです。 検索してみて http://www.blackcat.xyz/article.php/ProgFAQ-Xls_EmptyQueue こちらを見つけたのですが、 arrLNG(UBound(arrLNG)) = 1 でエラーになりました（インデックスが有効範囲でない） よろしくお願いします。
アクセスで教えて下さい。 メインフォームA、B サブフォームC コンボボックスD,E サブフォームCでコンボボックスD,Eが連動するように作成し、メインフォームAに組み込みました。 同様にメインフォームBにサブフォームCを組み込んだらパラメーターの要求をされてしまい、手詰まりになっています。 １つのサブフォームを2つのメインで使用しコンボボックスの連動を上手くする方法はありますでしょうか？
VBAで簡素ですが、難易度が高すぎてコーディングができません。ユーザー定義変数 Type recInfo strTitle As String intRow As Integer strLine As String End Type Dim myMusic() As recinfo 仮に下記のように変数が格納されていたときに （strLineはすべて空白） myMusic()→.strTitle .intRow myMusic(0) A 6 myMusic(1) A 7 myMusic(2) A 8 myMusic(3) B 11 myMusic(4) B 12 myMusic(5) C 16 myMusic(6) C 19 myMusic(7) C 23 myMusic(8) C 24 myMusic(9) C 25 下記のように各strTitleの最初のstrLineにintRowが加工されたものが格納されるようにコーディングしたいのですが、難しすぎて実装できません。 myMusic(0) .strLine=6〜8 myMusic(3) .strLine=11,12 myMusic(5) .strLine=16,19,23〜25 すみませんが、コードを教えていただけないでしょうか。 strTitleは同一のものは必ず連続している前提で「AAABABB」みたいのようにはなりません。 intRowは必ず小さい順になっている前提です。strTitleが前のものより小さくなることはないです。 intRowの加工の規則は不連続の数字の場合は「,」で区切る。連続した3つ以上の数字の場合は間の数字を「〜」で省略。連続した２つの数字の場合は,「,」でも、「〜」でも区切っても大丈夫です。 すみませんが、よろしくお願いいたします。
入力済みのｾﾙだけ選択してﾃﾞｰﾀ追加するには? DGV1の(0,0)から抽出して、DGV2のCBoxに格納するｺｰﾄﾞです。これを「DGV1の入力済みのｾﾙだけを抽出するように」したいのですが どのようにやればいいでしょう? Public Class Form1 'ﾎﾞﾀﾝが押されたら Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click 'ｾﾙの内容を取得 Dim list As New List(Of String) list.Add(Me.DataGridView1(0, 0).Value) 'ｺﾝﾎﾞﾎﾞｯｸｽに追加 DataGridView2.Columns.Add(New DataGridViewComboBoxColumn() With { .DataSource = list, .DataPropertyName = "CodeAfter", .HeaderText = "コード変更" }) End Sub End Class
エクセルマクロを使ってクリップボードを処理する質問です。 まったくの素人ですが、必要があってマクロの勉強を始めましたがうまくいきません。やりたいことの内容は、特定のセルの内容をコピーし、別のブックの特定のセルに貼り付けるというものです。別のブックはオープン時にマクロを実行したいと考えています。 素人ながら知恵袋などを参考に次のようなマクロを作ってみましたがうまくいきません。 （エラー内容は、”1004 クラスのpasteメソッドが失敗しました”というものです。） ●コピー側マクロ sub clipcopy() range("a1").copy end sub ●貼り付け側マクロ sub workbook_open() activesheet.paste destination:=range("a1") end sub 以上です。 よろしくお願いします。
EXCEL VBA初心者です。 Worksheet_SelectionChangeを使って ”B7”のセルの値が書き換わったら”I7”にその時間を入れるという コードを作成しました。この処理をB7 B11 B15と繰り返したいので、 セルの値を変数にしたのですが、動きません。 セルの指定方法がいけないのでしょうか？ ループの仕方が悪いのでしょうか？ Private Sub Worksheet_SelectionChange(ByVal Target As Range) Dim i As Byte Dim j As Byte Application.EnableEvents = False j = 7 For i = 1 To 50 If Target.Address() = Cells(j, 2) Then Cells(j, 6) = Now Cells(j, 7) = Time End If Next Application.EnableEvents = True End Sub
コイン500枚です！！ VBAに詳しい方お願いします。 画像のように、6桁の数字が15個、縦に並んでいます。画像のような数字を、条件を満たしつつ、ランダムに生成するコードを教えてください。条件１：０～９の数字を各９回ずつ出現させる 条件２：６桁の数字の中に、同じ数字は出現しない 失敗例） 602,324 条件３：縦に同じ数字が隣り合わない 失敗例） 602,415 532,981 条件４：縦に同じ数字が出現するのは３回まで 失敗例） xxx,4xx 省略 xxx,4xx 省略 xxx,4xx 省略 xxx,4xx 条件５：縦に０～９までの数字が最低１回は出現する 条件６：６桁の数字を生成したいので、先頭に０があるような数字は生成しない 失敗例） 052,469 これら、６つの条件を満たしつつ、マクロを実行するたびに、ランダムに数字を生成するVBAのコードを教えてください。詳しい解説もつけていただけますと、非常に助かります。 よろしくお願いします。
エクセルのVBAマクロで現在開いている別ブック( 物件確定集計表.xlsx)をアクティブにしたかったのですが Workbooks("物件確定集計表.xlsx").Activateと記述したらエラーが返ってきてしまいました。 原因を調べても分からず途方に暮れています どなたかわかる方がいらっしゃいましたら、ご教示お願いいいたします
access2013で下記のログインプログラムを作成し、フォームから入力してもパスワードが間違っています。と出てしまいます。間違えなくパスワードは合っているのですが、何故でしょうか？ Private Sub コマンド0_Click() Dim Res If IsNull(Me.txtID) Then MsgBox "IDを入力してください" Me.txtID.SetFocus Exit Sub End If If IsNull(Me.txtpass) Then MsgBox "パスワードを入力してください" Me.txtpass.SetFocus Exit Sub End If Res = DLookup("ID", "T社員コード", "ID='" & Me.txtID & "'") If IsNull(Res) Then MsgBox "該当するIDはありません。正しいIDを入力してください。" Me.txtID.SetFocus Exit Sub End If If Res = Me.txtpass Then DoCmd.OpenForm "Fメニュー" '----ID,pass合致でフォームを開く。 DoCmd.Close acForm, "Fログイン画面" Else MsgBox "パスワードが異なります。", vbOKOnly + vbCritical Me.txtpass.SetFocus End If End Sub 宜しくお願いします。
excelマクロに詳しい方教えてください。 下記写真のようなデータがあり、 A列に種類、B列に１～番号が振ってあります。これを、 ①B列の数字が欠番のところに赤い罫線 ②B列の数字が重複のところ２行の外枠に赤い罫線 を付けたいです。 自分なりに調べて ' 外枠太罫線赤を引く With Range("B8:E9") .BorderAround Weight:=xlMedium, LineStyle:=xlContinuous, Color:=RGB(255, 0, 0) End With ' 下太罫線赤を引く With Range("B4:E4") .Borders(xlEdgeBottom).Weight = xlMedium .Borders(xlEdgeBottom).LineStyle = xlContinuous .Borders(xlEdgeBottom).Color = RGB(255, 0, 0) End With までは分かったのですが、欠番・重複の判断を どのように表記したらいいかが分かりません。 なお、A列の種類ごととなりますので、継ぎ目には 赤い罫線を入れないようなマクロがありがたいです。 可能でしょうか？？ お詳しい方、よろしくお願い致します。
画像を表示するマクロについて 初心者です。Private Sub botan1_Click() ActiveSheet.Shapes.Range(Array("ああああ")).Visible = True ①上記のような・・シンプルなコードの（サイズや位置など指定しない？） ボタンをクリックすると画像を表示するコード教えてください。 画像はActiveXコントロールで オブジェクト名 ImageC です。 それと・・ ② Forms.ComboBox. で プルダウン（A,B,C,D）▼から Cを選択するとImageCの画像が表示としたいのです。 こちらは全く分かりません。コードと プロパティでなにかいじるものがあればそれも一緒に教えて下さい。 よろしくお願いいたします。。
vba findについて 下記のプログラムを実行すると '過去全再生回数のみが実行されており、'登録者数と'視聴回数は実行されない状態となっています。宣言も項目ごとに変更しているのですが、何が問題なのでしょうか・・・。ご教示お願い致します。 '過去全再生回数 Dim c As Range Dim FirstAdd As String Const MYTXT1 As String = "回" 'xlWhole完全一致 xlPart一部一致 Set c = ActiveSheet.Columns("A:A").Find( _ What:=MYTXT1, _ LookIn:=xlValues, _ LookAt:=xlWhole, _ MatchCase:=False) If Not c Is Nothing Then FirstAdd = c.Address Do ActiveSheet.Cells(i, 4).Value = c.Offset(-1, 0).Value Set c = ActiveSheet.Columns("A:A").FindNext(c) If c.Address = FirstAdd Then Exit Sub Loop Until c Is Nothing End If '登録者数 Dim d As Range Const MYTXT2 As String = "回" 'xlWhole完全一致 xlPart一部一致 Set d = ActiveSheet.Columns("A:A").Find( _ What:=MYTXT2, _ LookIn:=xlValues, _ LookAt:=xlWhole, _ MatchCase:=False) If Not d Is Nothing Then FirstAdd2 = d.Address Do ActiveSheet.Cells(i, 5).Value = d.Offset(1, 0).Value Set d = ActiveSheet.Columns("A:A").FindNext(d) If d.Address = FirstAdd2 Then Exit Sub Loop Until d Is Nothing End If '視聴回数 Dim e As Range Const MYTXT3 As String = "視聴回数" 'xlWhole完全一致 xlPart一部一致 Set e = ActiveSheet.Columns("A:A").Find( _ What:=MYTXT3, _ LookIn:=xlValues, _ LookAt:=xlWhole, _ MatchCase:=False) If Not e Is Nothing Then FirstAdd3 = e.Address Do ActiveSheet.Cells(i, 6).Value = Round(e.Offset(1, 0).Value / 28, 0) Set e = ActiveSheet.Columns("A:A").FindNext(e) If e.Address = FirstAdd3 Then Exit Sub Loop Until e Is Nothing End If
エクセル VBAにいて B列のデータを「B2」と同じ値の場所にコピーする方法をVBAで処理したいのですがよい方法を教えて下さい。添付の写真の場合、「B2」の値が2なので、同じ2である「E2」のあるE列にコピーしたいです。 また、「B2」の値を3に変えればF列に、「B2」が5ならばH列にコピーできるような方法を教えて下さい。 ネットで調べて、Find_Rangeが使えると思ったのですが、なかなかうまくできません。 よろしくお願いします。
初心者です。ネットで見よう見まねで作ってみましたが、うまくいきません。すみませんが、コードを書いていただけないでしょうか？やりたいこと ExcelのA列に「ポスト」とある行を拾います。 http://sys.web-burger.com/zip/?zipcode=113-0023&zipaddress=2-1 というURLで、ExcelのB列とC列をそれぞれ、 http://sys.web-burger.com/zip/?zipcode=(ExcelのB列）&zipaddress=(ExcelのC列） といれたURLをつくります。 そのURLへいって、English枠のデータをコピーし、ExcelのD列に貼り付けます。 これを繰り返したいです。 つくってみたもの Sub test() Dim ie As Object Dim lastRow As Long Dim r As Long ' Set ie = CreateObject("InternetExplorer.Application") 'ie ie.Visible = True lastRow = Range("A" & Rows.Count).End(xlUp).Row For r = 1 To lastRow ie.navigate "http://sys.web-burger.com/zip/?zipcode=" & Range("B" & r)& "&zipaddress=" & Range("C" & r).Value ←調べてもどう書けばいいのか分かりませんでした。 Do While ie.Busy Or (ie.readyState <> 4): DoEvents: Loop If ie.document.getElementsByClassName("table").Length >= 5 Then Range("D" & r).Value = ie.document.getElementsByClassName("table")(4).innerText End If Next ie.Quit End Sub
vb.netでDataTableを作成しているデータベースプログラミング初心者です。形状1は（x,y,z）の座標点が150個、形状2は同じく座標点が230個、という感じで数十個の形状があります。これらをDataTableにうまく格納するにはどうすればいいのでしょうか？x,y,zをフィールドとすると、形状と形状のレコード上の継ぎ目がわからなくなってしまい、かと言って形状個数分のTableを作ってしまうのも、なんとなくスマートでないような。このようなケースを通常どのように扱うのかを教えてください。
マクロ初心者です。よろしくお願いします。 同じブックでsheet2のＡ2からＥ2をコピーして、sheet1のＡ4からＥ4に貼り付けます。次にsheet2のＡ3からＥ3をコピーして、sheet1のＡ5からＥ5に貼り付けます。次に........とコピー貼り付けを繰り返して、sheet2のＡ行の１列目が空白になったら処理終了のマクロを作成しました Dim 行 As Integer 行 = 2 Do Until Worksheets("Sheet2").Cells(行, 1).Value = "" Worksheets("Sheet2").Range(Worksheets("Sheet2").Cells(行, 1), Worksheets("Sheet2").Cells(行, 5)).Copy Worksheets("Sheet1").Range(Worksheets("Sheet1").Cells(行 + 2, 1), Worksheets("Sheet1").Cells(行 + 2, 5)).PasteSpecial Paste:=xlPasteValues 行 = 行 + 1 Loop ここからなのですが、次にまた新しいデータをコピー貼り付けをするときに、 例えばsheet1の”Ａ4からＥ4”～”Ａ13からＥ13”までが前のデータだとして、次のコピー貼り付けを"Ａ14からE14"からはじめたいとしたい場合どのように組むのでしょうか？ その際sheet2のデータは前回のデータは消去して新しいデータを同じセルからに貼っています。データの量は毎回違います。 Cells(Rows.Count, 1).End(xlUp) ↑これを組み込むと思うのですが。難しくてさっぱりです。 どなたかお助けください。
vbaでパソコンを自動化することに関しての質問です。 とある、情報収集ツール（.jarファイル）があります。 これの起動から、csvシート吐き出しまでを自動化したいと思っています。しかし、MS製品ではないのでどのような方法で扱うべきか、ちょっとわからずにいます。 １．情報収集ツールを起動する（.jarファイルをダブルクリック） ２．キーワードをツールに入力、そして「探索」ボタンを押す ３．24時間程度放置すると、ある程度情報が集まっているので、ツール上の「出力」ボタンを押す、 ４．「出力」を押すと、ファイルの保存場所を聞かれるので、任意の場所に保存 ５．情報収集ツールを終了 という工程を自動化したいのですが、これってVBAからでもできることでしょうか？ VBAでなくとも、他のやり方でも大丈夫なので、良いやり方をご存知の方いらっしゃれば、ご教授頂けますと幸いです。
VBAのユーザー定義型について。 以下のコードでどうやってもコンパイルエラーがでます。 １．モジュール１で、ユーザー定義型AAAを宣言。 ２．モジュール２で、AAA型の配列に値を格納。３．モジュール２で、その配列を引数としてサブルーチン（モジュール３）呼び出す。 どこでミスをしているのでしょう？ ひょっとして、ユーザー定義型を配列にしたものは、引数として渡せないのでしょうか。 ■モジュール１ Type AAA day As Date num As Single End Type -------------- ■モジュール２ Sub Test1() Dim t1(10) As AAA Dim m As Integer For m = 0 To 10 t1(m).day = 2016/7/8 t1(m).num = 1111 Next Call Test2(hoge) End Sub -------------- ■モジュール３ Sub Test2(t2() As AAA) Range("A1:J7") = WorksheetFunction.Transpose(t2) End Sub
MACでOPEN COBOLを使っています。 変数の定義のやり方がよくわからなく、次のソースコードでエラーが出てしまします。 どなたかよろしくお願いいたします。IDENTIFICATION DIVISION. PROGRAM-ID. SAMPLE01-1. ENVIRONMENT DIVISION. DATA DIVISION. FILE SECTION. WORKING-STORAGE SECTION. 01 W-NUM PIC 9(05). PROCEDURE DIVISION. DISPLAY '私の学籍番号はこれです。よろしくね' MOVE 9 TO W-NUM DISPLAY '合計は' W-NUM 'です。' STOP RUN. エラー内容 Error: syntax error, unexpected "end of file"
VBAについて教えてください。 ある特定フォルダ内にある複数のファイルの、特定の名前「入力」のシートからデータを別ファイルに転記していく作業を行います。その際に、更新できないリンクが含まれていますというようなメッセージが何度も出てくるのでその度に継続を選択しているのですがこの作業を下記のマクロではどこにどう記載するものでしょうか？ まったくの初心者でネットで調べても自分の持っているコードにどう当てはめるべきかがわからないため、ご教授願います。 また、下記だと一つ一つ転記元となるファイル（約100個）を開いてはデータを取得するためなのかだいぶ時間がかかってしまいますがもっと簡単ではやい方法はあるのでしょうか？ 転記元ファイル →すべて同じシート名「入力」の("A48:I48")のデータ 転記先ファイル →複数シートあるうちの「Title」シート、マクロはこのシート上のボタンに登録 Sub sumple() Const FolderPath As String = "C:\Users\~" Dim objFSO As Object Dim objBook As Object Dim lngRow As Long Dim motosheet As Worksheet '画面のちらつき制御設定 Application.ScreenUpdating = False 'FileSystemObjectを変数にセット Set objFSO = CreateObject("Scripting.FileSystemObject") 'フォルダ内のファイル全て繰り返し処理 For Each objBook In objFSO.GetFolder(FolderPath).Files '貼り付け行(最終行+1)取得 lngRow = ThisWorkbook.Sheets("Title").Range("A" & Rows.Count).End(xlUp).Row + 1 'ファイルを開く Workbooks.Open objBook.Path 'コピー後ファイルを閉じる Set moto = Worksheets("入力") moto.Activate moto.Range("A48:I48").Copy ThisWorkbook.Sheets("Title").Rows(lngRow).PasteSpecial Paste:=xlPasteValues Application.DisplayAlerts = False ActiveWorkbook.Close Application.DisplayAlerts = True Next 'オブジェクト変数解放 Set objFSO = Nothing '画面のちらつき制御解除 Application.ScreenUpdating = True End Sub 以上、素人がネットから拾ってきたコードを四苦八苦して修正したコードのためわかりずらいかと思いますが、宜しくお願い致します。
VB2005で作成したプログラムの多重起動について教えてください。 例えば、VB2005でA.exeを作ります。そのA.exeを別のディレクトリにコピーしファイル名をA-1.exeに変更しました。A.exe自体は二重起動させたくないのですが、A-1.exeは起動したいのですが、うまくいきません。 ネットで調べたところ、多重起動を防ぐのは、簡単なものから難しそうなものまで多数方法があるようでした。全て試したわけではありませんが、どの方法も A.exeを起動しますが、A-1.exeは二重起動と判断され起動しませんでした。 VB6の時は、App.PrevInstanceでチェックできていたようなのですが、、、 いい方法や参考になるURLでも構いませんのでご存じであれば教えてください。 よろしくお願いいたします。
エクセルマクロについての質問です。以下のマクロを実行するとコンパイルエラーが出て、 「elseに対応するifがありません」と出てしまいます。 私としては、ちゃんとifあるのに。。。って思うのですが、どこが間違っているのでしょう？ お知恵を拝借させていただけると幸いです。 Sub テスト() Dim ret As Integer Dim bud As String Dim strSaveName As String Dim a As Long ret = MsgBox("上書き保存しますか？いいえの場合は、Inputboxが開きます",vbYesNo) If ret = vbNo Then labelret1: Do Until buf <> "" And a = 0 buf = Application.Inputbox("ファイル名の後ろにつける言葉を指定してください。") a = InStr(buf,"/") If buf = "" Then MsgBox "何か入力してください。",vbOKOnly ElseIf a > 0 Then MsgBox "保存に使えない文字がはいっています。",vbExclamation End If Loop If buf = "False" Then Exit Sub End If strSaveName = "C:¥Test¥" & Range("Sheet2!N1") & ".xlsm" If Dir(strSaveName) <> "" Then MsgBox "すでに同じ名前のファイルがあるためほぞんできません。",vbOKOnly buf = "" GoTo labelret1 Else ThisWorkBook.SaveAs strSaveName ThisWorkBook.close Exit Sub End If Else 'ここが青くなりエラーになる ThisWorkBook.SaveAs strSaveName ThisWorkBook.close Exit Sub End If End Sub ※すーっごくながいマクロの一部を取り出しています。
ListObject.AutoFilterの件数取得について ListObject.AutoFilterで絞込みを行った後の件数はどのように取得したらよいでしょうか？ListObjects("テーブル1").Range.AutoFilter Field:=2, Criteria1:="あいうえお" という設定でデータの絞込みを行っています。 絞りこまれた件数が「2」であった場合は「2件です」、「0」であった場合、「0件です」と表示させたいのですが、オートフィルタ後の件数取得がうまくできず、思っている処理を行うことができません。 （テーブルの最終行は取得できるのですが…） AutoFlilterのみでの運用を試みましたが、フィルタ解除がうまくいかないため、ListOfjectを使用するしかないのかなと思っています。 お知恵がある方がいらっしゃいましたら、力をお貸しいただきたいです。 よろしくお願いいたします。 (環境：Excel2016、Win7）
エクセルＶＢＡ（マクロ）がわかる方教えて下さい。 質問内容は株情報を表示させたい。私が用いたフォーマットは http://kabubegin.web.fc2.com/kabu050.html で利用しました。 追加で「配当利回り（会社予想）」を表示させるようにしたいです。 具体的にはエクセルの15列目に利回りを表示させていく。 プログラムの知識はＣ言語（学校教育）のみで1行ずつゆっくり見ればなんとなくやっていることが わかったりわからなかったりと微妙なところなので、簡単なプログラムを書いていただければうれしいです。 一応できなかったプログラムがこちらです。 '【配当利回り】 取得 strText = "" If InStr(1, .responseText, ">配当利回り（会社予想）<", vbTextCompare) > 0 Then strText = GetValue(.responseText, ">配当利回り（会社予想）<") If IsNumeric(strText) = False Then strText = "---" End If End If Cells(wRow, 15) = strText Cells(wRow, 15).NumberFormat = "#,##0.00"
ﾃﾞｰﾀｸﾞﾘｯﾄﾞﾋﾞｭｰのｾﾙから取得し、ｺﾝﾎﾞﾎﾞｯｸｽに表示させたい。下記ｺｰﾄﾞを実行すると、 Complex DataBinding は IList または IListSource のどちらかを データソースとして受け入れます。とｴﾗｰが出ました。 どこがおかしいのでしょうか。 Public Class Form1 'ﾎﾞﾀﾝが押されたら Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click 'ｾﾙの内容を取得 Dim Data As String Data = Me.DataGridView1(0, 0).Value 'ｺﾝﾎﾞﾎﾞｯｸｽに追加 DataGridView1.Columns.Add(New DataGridViewComboBoxColumn() With { .DataSource = Data, .DataPropertyName = "CodeAfter", .HeaderText = "コード変更" }) End Sub End Class
同名ファイル以外を「txt」か「log」ファイルに出力したい。 VB初心者です。複数のフォルダ内にある、同じファイル名以外を取得し、 「txt」もしくは「log」ファイルに出力するにはどうしたらよいのでしょうか。 たとえば「A」「B」「C」三つのフォルダがあったとして 「A」フォルダに 0713-001.png 0713-002.png 「B」フォルダに 0713-001.png 0713-012.png 「C」フォルダに 0713-001.png 0714-002.png 共通のファイル名を除いた、 0713-002.png 0713-012.png 0714-002.png 以上のファイル名を「txt」もしくは「log」ファイルに出力する。 この場合のコード例を教えて下さい。
ExcelVBA 初心者です。 質問させてください。Sheet1のセルB2にSheet2（マスタ)のNoを入れると B4：K40までのところにVLOOKで参照させたデータが入る形にしてあります。 そこで、 マスタのNoを最初から空白になるまでをSheet1のセルB2に順に入力するようにしたいです。 （印刷するのが目的です） 例）B2に１入力→印刷 B2に２入力→印刷 といった感じで、作業を繰り返しさせたいのですが、 どうすればいいでしょうか？
C#のバージョン移行方法についてお聞きします。この度、業務の一環で 以前、別の方が作ったVisual C# 2010で開発したデスクトップアプリを Visual C# 2013（VS Express 2013 for Desktop）で修正することになりました。 そこで、プロジェクトを開こうとしたところ 「このプロジェクトは、Visual Studio の現在のエディションと互換性はありません」 と報告されてしまいます。 正しく開くには、どう対処すればよろしいでしょうか。 良い方法がございましたら、お願いします。
VB.NET ビルドしたEXEが起動しません 質問失礼します。 VB.NETにて作成し、ビルド→Debugフォルダ→app.exeとなりました（なります）。Debugフォルダ内で「app.exe」を実行すると、起動します。 ・・・が、その「app.exe」をデスクトップや別の場所にコピーすると起動しません。 いったい何が原因なのでしょうか？起動するにはどうしたらよいのでしょうか？ コピー後の「app.exe」をダブルクリック(ENTER)すると、一瞬砂時計こそはでますが、無反応です。 タスクマネージャも見ましたが、起動している様子は見られません。 ＊ IDE(開発画面)での動作は問題ありません。 ＊ 「app.exe」のファイルサイズも4Mほどです。 どうかよろしくお願いいたします。
VBAにて結合したｾﾙの最終行を求める式を作ったのですが、上手くいきません。 Range("H10")から最終行を求めたいです。 現状の式は以下となります。Dim Lastrng As Range Set Lastrng = Range("H" & Rows.Count).End(xlUp).Offset(1, 0) Range("H10:Lastrng").Select お手数ですが、ご協力のほどお願い致します
outlook2010での質問です。outlook2010でVBAを使用して送信前確認ダイアログを表示し、件名、宛先、添付ファイルを確認できるようにし、送信ボタンを押して指定秒数後に送信実行するようにしました。 さらに添付ファイルが全てパスワード設定されているか確認するマクロを組みたいと思います。 どのようにすればいいでしょうか？ 添付ファイルの種類は、圧縮ファイル、エクセル、ワード、PDFを想定しています。 送信前確認ダイアログは下記サイトを参照して作成しました。 http://peiyorin.cocolog-nifty.com/blog/2011/10/outlook-vba-ae5.html
エクセルVBAで重複値の最後の行の下に行を挿入できないでしょうか？ A列 1行目,AAAAAA 2行目,AAAAAA 3行目,AAAAAA 4行目,BBB 5行目,BBB 6行目,CCCCC 7行目,CCCCC 8行目,CCCCC9行目,DDD 10行目,DDD . . . . . . . . . 10000行 以上のようなテーブルがあり、重複した値が上から並んでおります。 4行目(重複値の最後の行の下)に行を挿入、一つ上の値をいれたいと思ってます。 6行目(重複値の最後の行の下)に行を挿入、一つ上の値をいれたいと思ってます。 9行目(重複値の最後の行の下)に行を挿入、一つ上の値をいれたいと思ってます。 10行目(重複値の最後の行の下)に行を挿入、一つ上の値をいれたいと思ってます。 どなたかVBAでの解決方法があればがありましたら教えていただけないでしょうか？ 初心者ですが、よろしくお願いします。
PCに接続されているUSBデバイスのデバイスインターフェース情報一覧をvb.net(2005)で取得したいのですが、以下の各種APIを使用して取得する方法を教えてください。構造体への受け渡しがよくわからず、困っています。 SetupDiGetClassesDevs() SetupDiEnumDeviceInterfaces() SetupDiGetDeviceInterfaceDetail() サンプルコードを交えつつ御教示いただければと思います。 以上、よろしくお願いいたします。
この度は、このような神対応本当に感謝いたします。 疑問点及び画像を添付いたします。・集計結果を書き出す列が５つ連続しているので、５列一気に･･･の処理になる可能性大 ＊集計結果の書き出しは一気処理で十分です。 ・Sheet1 / Sheet2 の関連ある列情報、始り行と最終行（リミットあり？） ＊ Ｓｈｅｅｔ１ はB２から始り行になりＳｈｅｅｔ２ はＡ２から始り、最終行のリミットはＳｈｅｅｔ１/Sheet2 ともリミットなしです。 ・Sheet3 の始り行と最終行（リミットあり？） ＊Ｓｈｅｅｔ３はＳｈｅｅｔ１／Ｓｈｅｅｔ２のデータ集計Ｓｈｅｅｔですので、Ａ表はＤ１１，Ｂ表はＬ１１からデータの開始行で最終行はリミット無しと考えています。ただ、Ａ表・Ｂ表のデータ行数は必ずしも同一ではありません。セットする商品コードの数の違いから行数に違いが出る場合があります。 ・前回の日付のありなしが発送判別？ ＊日付による判別です。先に示した日付関係のコードは合っていましたでしょうか。 ・発送日計個数 は今回新しい処理？商品コードは無視？ ＊発送日計個数は、前回頂いたIf (IsDate(vD(i, 1))) Thenの応用で作成し前から必要なデータでした。 ・各シートのイメージ（画像）を張り付けてもらえませんか？ ＊画像はＳheet１，２，３の１枚でＪＰＥＧです。よろしくお願いいたします。 最初から画像貼付しようかなあと思ったのですが・・、結果手間を掛けさせてしまい申し訳ありません。 ＊ファイルの設計の段階からそこまで出来るかが、私自身疑問以上雲の上の話でしたので結果、後出しジャンケン的になり申し訳ありません。
エクセル マクロで教えてください。 sheet1のA1 に sheet2のA1＋B2 になるようにするにはどのように式を入れたらよいですか？
エクセル VBAで教えてください。 useformの中のtextboxに入力した文字が、並べ替えに反応してくれません。 一覧があり、その登録にuserformを作りました。その中でtextboxに文字を入れて、エクセルの一覧に飛ばすのですが、 そのあと、並べ替えをしても、頭文字を読み込んでくれません。 一番最後の空白行に入力されたまま、動かない感じです。 どういったことが原因でしょうか？
エクセルVBA フォーム内で、条件に応じたテキストボックスフォーカスについて。 VBAまだ始めたばかりで色々勉強中ですが調べても中々出てこないので質問する事にしました。テキストボックスは６個あり、tabindexで順番通りにフォーカスしています。 最後の（textbox6）の時だけ条件があります。 入力された値が、 条件１の場合はそのまま（textbox6）にまたフォーカスしたい 条件２の場合はenter同様（textbox1）先頭に戻したい お詳しい方々の知恵・アドバイスをお願いします。
エクセルでマクロのボタンを作って以下のことを作業出来るようにしたいです。①シート１のC3から下の列にあるカタカナで入力されているデータをシート２のB4とC4にスペースを区切ってアイウエオ順でC5C6と下に並び替えをする ②並び替えをしたシート１の行のデータをシート１のB列のデータをD列に、M列をE列に移す ③シート２のデータが56行目以降になったら、シート２のB列はL4列に、C列はM4列に、D列はN4列に、E列はO4列から下に並び替えるようにする 以上よろしくお願いします
VisualBasicのプログラムコードについて英語、国語、数学な３科目の点数を入力し、１科目でも50点未満があれば失格、３科目とも50点以上で平均点が70点以上であれば合格、そうでなければ不 合格と判定する 次のフォームの設定にしたがって、プログラムを作成しなさい。３科目の点数変数としてEnglish、Japanese、mathematicsを平均点の変数としてaverageを用いなさい。 という問題が出題されたのですが自分のプログラムコードの何が間違っているのかがわかりません。 皆様の知恵をお借りしたくて質問させていただきました 回答よろしくお願いします
バッチについて質問です。 バッチが置いてあるフォルダ内でバッチを実行した際に、 日付のフォルダが作られる、というものを作りたいです。1回目は「20160712」という名で作成され、 2回目以降は「20160712_2」「20160712_3」…というようにしたいです。 とりあえず「20160712_0」「20160712_1」「20160712_2」… というように作られるものは出来たのですが、 最初を「20160712」からスタートすることができません。 現状のコードについては以下に記載いたします。 お知恵をお貸し頂けますと幸いです。 -------------------------------------------------- set ymdtmp=%DATE:/=% set yyyymmdd=%DATE:/=% set n=0 :LOOP IF EXIST %yyyymmdd%_%n% ( set /a n=n+1 goto LOOP ) md %yyyymmdd%_%n%
図のようなファイルがあり、Ａ１がactiveになっています。 この時、2,3,4を範囲選択して行削除をしたいのですが、activecellとoffsetを駆使して削除するにはどうしたらいいですか？よろしくお願いします。
VBA IE操作 buttonクリックについて 下記ソースのログインボタンを押したいのですが、「https://accounts.google.com/ServiceLogin?uilel=3&hl=ja&pass...」 のＵＲＬは変わる場合があり、「.Navigate "https・・・」では実行できませんでした。 ほかの方法でクリックする方法があればご教示お願いいたします。 <div class="signin-container "><button class="yt-uix-button yt-uix-button-size-default yt-uix-button-primary" type="button" onclick=";window.location.href=this.getAttribute(&#39;href&#39;);return false;" role="link" href="https://accounts.google.com/ServiceLogin?uilel=3&hl=ja&pass..."><span class="yt-uix-button-content">ログイン</span></button></div></div>
証明書(.crt)ファイルと秘密鍵(.key)ファイルを持っており、それを指定のAPIにPOSTリクエストする必要があります。APIのリクエストには、 ・証明書と秘密鍵を結合したPKCS12ファイル ・ファイルを作成したときに設定したパスワード が必要なようです。 .NETにおいてこれらを実現することは可能でしょうか？ X509というキーワードがよく出てくるのですが、いまいち理解できません。 また、参考になるようなサイトやサンプルコードがあればと思います。 よろしくお願いいたします。
エクセルVBAで質問です。シートの特定のセルの値がNGと表記してた場合、印刷できないようにしたのですが、ブック印刷で複数シートを印刷しようとした場合、1シートでもNGなら印刷できないようにしたいです。 条件 ①シート数は決まってません。 ※5シートの時もあれば50シートの場合もあります。 ②印刷するシートのどれか1つでもNGがあれば全数印刷できない。 下記はいまのところThisworkbookに貼り付けてます。 Private Sub Workbook_BeforePrint(Cancel As Boolean) If ActiveSheet.Range("B5").Value = "NG" Then MsgBox "NG判定があるので印刷できません。再度確認してください！", vbCritical Cancel = True End If End Sub 出来ればNGシートが何シート目か表示出来れば嬉しいです。 まだまだ勉強不足だと痛感していますが、知恵を貸してください。よろしくお願いします。
図のようなエクセルがあり、Ａ１：Ｂ3の範囲の情報をボタン一発で、 Ａ５セルにまとめるマクロはありますでしょうか？A1:A3は下にどんどん移動していくので、名前にカーソルを合わせてactiveにして、 activecell.value なんとかで、処理を使用と思っています。 すると、offsetが多すぎてわけがわからなくなりました。 よろしくお願いします。
ユーザーホームのオプションボタン1にチェックボタンを入れた時にsheet1のB1の当日曜日にvチェックをいれるにはどのようなマクロコードになるのでしょうか？どなたかわかるかたご教授ください。宜しくお願い致します
ExcelのVBAの話です。 乱数で0か1を作るにはどうすればいいのでしょうか。
以下をVBAで挑戦していますが、うまく書けません。教えて下さい。 ある、csvファイルをダイヤログBOXを出し、（デスクトップにある、ファイルは頭6文字以外は日付などで変動する）ファイルを選択し、取込、シート名を追加（hsというシート名）し、Ａ2から取込んだマクロは作れましたが、キャンセルした時に、エラーが出てしまうのと、再度取込した際に、既にシート名があるため、エラーがでるんですが、IFでまだ書けません。 教えて下さい。 デスクトップのcsvファイルを取込するため、ダイヤログでキャンセルした時にエラーがでず、処理を中断するようにしたいのど、hoというシートを追加し、Ａ2から取込なんですが、もし、シートが既にある場合は、Ａ列の空白を探して、空白から続きで、下に追加していく仕組みをつくりたいです。 よろしくお願いします。
ExcelのVBAに詳しい方、教えて下さい ②「店舗別売上実績」シート（以降省略）の表全体の体裁（書式）を変更するステートメントを次の条件で作成してください。【作成条件】 ・セル「A2」を基準に「CurrentRegion」プロパティで「アクティブセル領域」を参照する ・Withステートメントを使用し、参照したオブジェクトに対する書式設定を簡潔に記述する （※以下はWithステートメント内のオブジェクトに対する処理 ） ・「Borders」プロパティで表の内側（横）に「点線」の罫線を設定する ・「BorderAround」メソッドで表の外側を「太線（実線）」の罫線を設定する ・参照範囲内の行の高さを「25」ポイントに設定する ・参照範囲内の列の幅を「10」ポイントに設定する ③表の2行目（A2：I2）の見出し行の体裁（書式）を変更するステートメントを次の条件で作成してください。 【作成条件】 ・セル「A2」を基準に「End」プロパティで右の終端セルまでを見出し範囲として参照する ・Withステートメントを使用し、参照したオブジェクトに対する処理を簡潔に記述する （※以下はWithステートメント内のオブジェクトに対する処理 ） ・フォントのスタイルを「太字」にする ・「ColorIndex」プロパティのインデックス番号「16」で参照セル範囲の塗りつぶしを行う ・文字の配置をセルの中央（縦横）にする ・「Borders」プロパティで見出しの下側に「二本線」の罫線を設定する ④作成したマクロ（プロシージャ）を実行してください。 私が作成したのは以下の通りです。 Sub 表のスタイル() Range("A2").CurrentRegion.Borders (xlInsideHorizontal) With Range("A2").LineStyle .LineStyle = xlDot .bordersaround LineStyle.xlThick .EntireRow.RowHeight = 25 .ColumnWidth = 10 End With Range("A2").End (xlToRight) With Range("A2") .Font.Bold = True .Interior.ColorIndex = 16 .HorizontalAlignment = xlCenter .LineStyle = xlDouble End With End Sub
htmlソースの保存・解析について プログラミング初心者です。連番のhtmlソースの文字列の存在有無をチェックするために とりあえずテキストファイルとして保存するプログラムをVBAにて FireFoxを通してShellで起動させています SendKeyしか使えないため、waitでは連続処理に失敗が多発してしまいます。 FireFoxの理由はIE11にすると、view-sourse:URLページを直接表示できたないためです。 Sub A() Total = xxx Shell "C:\Program Files Firefox\firefox.exe view-source:http://www.A/xxxxx/" waitTime = Now + TimeValue("0:00:04") Application.Wait waitTime SendKeys "^(s)" waitTime3 = Now + TimeValue("0:00:02") Application.Wait waitTime3 SendKeys Total & ".txt" waitTime5 = Now + TimeValue("0:00:02") Application.Wait waitTime5 SendKeys "{Enter}" waitTime6 = Now + TimeValue("0:00:01") Application.Wait waitTime6 For c = 1 To xxxx SendKeys "^(l){BS}" waitTime8 = Now + TimeValue("0:00:02") Application.Wait waitTime8 b = Total - c Key = "view-source:http://www.A/xxxxx/" SendKeys Key waitTime9 = Now + TimeValue("0:00:02") Application.Wait waitTime9 SendKeys "{Enter}" waitTime = Now + TimeValue("0:00:03") Application.Wait waitTime SendKeys "^(s)" waitTime3 = Now + TimeValue("0:00:02") Application.Wait waitTime3 SendKeys b & ".txt" waitTime5 = Now + TimeValue("0:00:02") Application.Wait waitTime5 SendKeys "{Enter}" waitTime6 = Now + TimeValue("0:00:02") Application.Wait waitTime6 Next c waitTime10 = Now + TimeValue("0:00:01") Application.Wait waitTime10 SendKeys "^(w)" End Sub 改善のヒントがあったら、ご教授お願いします。
プログラムのコードをスムーズに正しく読む方法を教えてください。新卒Webプログラマですが、コードや外部設計書を正しく読むことができないため、内部設計書でいつも躓いています。せめて改修前のコードだけでも正しく理解したいです。コードをスムーズに正しく読むコツを教えてください。
Excel2013でスクロールができなくなるバグ マウスホイールや、カーソルキー、右のスクロールバーを動かしても画面が同じ場所から動かなくなることがあります。マクロで、行のHiddenのTrue、Falseの切り替えを行うイベントプロシージャを持っているシートでそうなります。 Excelを立ち上げ直してもこの状態が継続します。 他のシートでは問題なくスクロールできます。 どのようにすれば直るでしょうか。
VBA初心者です。Excel2010です。3つのワークブックからそれぞれP9のセルの値を取得し、統合用のワークブックのセルに記入したいです。以下のMacroを走らせても「Subまたはfunctionが定義されていな い」とコンパイルエラーが出ます。幾つかミスしていると思うので、上記のことができる正しいコードを教えてくださると光栄です。なお、二つ目のプロシージャで実行しています。 Sub OpenWorkbook() Workbooks.Open Filename:="C:\Users\Mat\Dr6-1.csv" Workbooks.Open Filename:="C:\Users\Mat\Dr6-2.csv" Workbooks.Open Filename:="C:\Users\Mat\Dr6-3.csv"" End Sub －－－－－－ Sub GetTest() Dim r1 As Double Dim r2 As Double Dim r3 As Double r1 = Workbook("Dr6-1.csv").Worksheets("Sheet1").Range("P9").Value r2 = Workbook("Dr6-2.csv").Worksheets("Sheet1").Range("P9").Value r3 = Workbook("Dr6-3.csv").Worksheets("Sheet1").Range("P9").Value Workbook("Exp25.xlsm").Worksheets("a").Range("E54").Value = r1 Workbook("Exp25.xlsm").Worksheets("a").Range("E55").Value = r2 Workbook("Exp25.xlsm").Worksheets("a").Range("E56").Value = r3 End Sub
エクセルで特定のセルをダブルクリックしたとき、画像を貼り付けるマクロを作成したく、ネットで探しながら作ったのですが、貼り付ける画像を選択せずにキャンセルするとエラーでエクセルが強制終了してしまいます。画像を選択した場合はエラーは発生せず、キャンセルしたときのみ発生してしまいます。 どのように修整すれば改善できますでしょうか。 また、原因は何かわかりますでしょうか。 下記がその内容です。 Option Explicit Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) Dim myPic As Variant Dim myShp As Shape, Shp As Shape Dim myRange1 As Range, myRange2 As Range Dim myRange3 As Range, myRange4 As Range Dim myRange5 As Range, myRange6 As Range Dim myRange7 As Range, myRange8 As Range Dim myRange9 As Range, myRange10 As Range Dim myRange11 As Range, myRange12 As Range Dim myRange13 As Range, myRange14 As Range Dim myRange15 As Range, myRange16 As Range Dim myRange As Range Set myRange1 = Range("B11:B20"): Set myRange2 = Range("B22:B31") Set myRange3 = Range("B33:B42"): Set myRange4 = Range("B44:B53") Set myRange5 = Range("B56:B65"): Set myRange6 = Range("B67:B76") Set myRange7 = Range("B78:B87"): Set myRange8 = Range("B89:B98") Set myRange9 = Range("B100:B109"): Set myRange10 = Range("M11:M20") Set myRange11 = Range("M22:M31"): Set myRange12 = Range("M33:M42") Set myRange13 = Range("M44:M53"): Set myRange14 = Range("M56:M65") Set myRange15 = Range("M67:M76"): Set myRange16 = Range("M78:M87") Set myRange = Union(myRange1, myRange2, myRange3, myRange4, myRange5, myRange6, myRange7, myRange8, myRange9, myRange10, myRange11, myRange12, myRange13, myRange14, myRange15, myRange16) If Intersect(Target, myRange) Is Nothing Then Exit Sub myPic = Application.GetOpenFilename("画像ファイル,*.jpg;*.jpeg;*.mpeg;*.mpg;*.png") If VarType(myPic) = vbBoolean Then Exit Sub Application.ScreenUpdating = False If Not Intersect(Target, myRange1) Is Nothing Then myRange1.Select ElseIf Not Intersect(Target, myRange2) Is Nothing Then myRange2.Select ElseIf Not Intersect(Target, myRange3) Is Nothing Then myRange3.Select ElseIf Not Intersect(Target, myRange4) Is Nothing Then myRange4.Select ElseIf Not Intersect(Target, myRange5) Is Nothing Then myRange5.Select ElseIf Not Intersect(Target, myRange6) Is Nothing Then myRange6.Select ElseIf Not Intersect(Target, myRange7) Is Nothing Then myRange7.Select ElseIf Not Intersect(Target, myRange8) Is Nothing Then myRange8.Select ElseIf Not Intersect(Target, myRange9) Is Nothing Then myRange9.Select ElseIf Not Intersect(Target, myRange10) Is Nothing Then myRange10.Select ElseIf Not Intersect(Target, myRange11) Is Nothing Then myRange11.Select ElseIf Not Intersect(Target, myRange12) Is Nothing Then myRange12.Select ElseIf Not Intersect(Target, myRange13) Is Nothing Then myRange13.Select ElseIf Not Intersect(Target, myRange14) Is Nothing Then myRange14.Select ElseIf Not Intersect(Target, myRange15) Is Nothing Then myRange15.Select ElseIf Not Intersect(Target, myRange16) Is Nothing Then myRange16.Select End If For Each myShp In Me.Shapes If myShp.Name = "画像" & Selection.Address Then myShp.Delete End If Next Set Shp = Me.Shapes.AddPicture(Filename:=myPic, _ LinkToFile:=False, _ SaveWithDocument:=True, _ Left:=Selection.Left, _ Top:=Selection.Top, _ Width:=0, _ Height:=0) With Shp .ScaleHeight 1!, msoTrue .ScaleWidth 1!, msoTrue .LockAspectRatio = msoFalse .Top = Selection.Top .Left = Selection.Left .Height = Selection.Height .Width = Selection.Width .Rotation = 0 .Name = "画像" & Selection.Address End With Set Shp = Nothing: Set myRange = Nothing Set myRange1 = Nothing: Set myRange2 = Nothing Set myRange3 = Nothing: Set myRange4 = Nothing Set myRange5 = Nothing: Set myRange6 = Nothing Set myRange7 = Nothing: Set myRange8 = Nothing Set myRange9 = Nothing: Set myRange10 = Nothing Set myRange11 = Nothing: Set myRange12 = Nothing Set myRange13 = Nothing: Set myRange14 = Nothing Set myRange15 = Nothing: Set myRange16 = Nothing Application.ScreenUpdating = True Cancel = True End Sub
[word VBA]findメソッドで見つけた付近の削除方法 findメソッドにより「&」を見つけて削除する方法は以下のようにすればできます。Dim fRng As Range Set fRng = ActiveDocument.Range(Start:=0, End:=0) With fRng .Find.Text = "&" .Find.Execute .Delete しかし「&」の近くのスペースを削除したい場合はどうしたらいいですか？ 以下のように&と1の間のスペースを削除する方法はありますか？ & 1 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ &1
マクロ変数 longとbyte の処理速度は、そんなに変わりますか？Windows10 エクセル2013で、マクロを使っています。 変数を宣言するとき、データ量によって「byte」「Integer」などありますが、私は小さな数値であっても、 面倒なので「long」を使ってしまいますが、処理速度ってそんなに違いますか？ 日付など、小数点など、めんどくさい時は全部「Variant」にしてしまいますが、 これも、処理が遅いか…と言われれば、そうは思わないのです。 試しに、byte と long で実験したのですが、特に遅いような感じはしません。 windowsXPとかだったら、違いがわかるのでしょうか？ マクロの内容によるのでしょうか？
マクロ初心者です Dim 行 As Integer 行 = 2 Do Until Worksheets("Sheet2").Cells(行, 1).Value = ""Worksheets("Sheet2").Range(Cells(行, 1), Cells(行, 5)).Copy Destination:=Worksheets("Sheet1").Range(Cells(行 + 2, 1), Cells(行 + 2, 5)) 行 = 行 + 1 Loop 同じブックでsheet2のＡ2からＥ2をコピーして、sheet1のＡ4からＥ4に貼り付けます。次にsheet2のＡ3からＥ3をコピーして、sheet1のＡ5からＥ5に貼り付けます。次に........とコピー貼り付けを繰り返して、sheet2のＡ行の１列目が空白になったら処理終了のマクロをつくりたいのですがうまくいきません。 なにが駄目なのでしょうか？
VisualBasic2008ExpressEditionで作られたプログラムを書き換え中です。以下のメッセージがでて止まっています MATH,ユーザー定義関数，または集計"Math.Floor"のいずれかがみつかりません。または名前があいまいです 止まっている場所は Dim sql As String =GetYsDatailSql(whereClause,Ychkym) Dim adapter As New Sql DataAdapter(Sql,MySettings.YiDbConection String) adapter.Fill(table) <<ここ GetYsDatailSqlから戻ってくるSqlの内容は以下の通りです SELECT Date , Kokyaku . Name As kokyakuName , Hin.Name As HinName , Hin.Kakaku As Hinkakaku,Irisu , kosu, SizeTate , SizeYoko , CASE WHEN ROUND(SizeTate * SizeYoko/128,0)=0 THEN 1 ELSE ROUND(SizeTate * SizeYoko/128,0) END AS Tanisu , Math.Floor(Tanisu / 100 * Hinkakaku + 0.5 ) * maisu As Kingaku FLOM Kokyaku INNER JOIN (Hin INNER JOIN Ysd ON Hin.ID = Ysd.HinId) WHERE Ysd.month="201608" 枚数単位の単価を四捨五入したくて Math.Floor(Tanisu / 100 * Hinkakaku + 0.5 ) * maisu といれたのですが、どうもうまくいきません。 ※上記の部分をHinkakaku*Irisuとすると問題なく動きますので もし指摘場所以外にエラー起こす内容がある場合は、おそらく内容を打った時の 打刻ミスです。 四捨五入をきちんと通すにはどうすればいいでしょうか。
すいません、突然のリクエスト失礼します。ご教授頂きましたコードを以下のようにしてみたのですが ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ Sub sample() Dim objIE As Object 'ＩＥオブジェクト参照用 Set sh = CreateObject("Shell.Application") For Each w In sh.Windows If (TypeName(w.Document) = "HTMLDocument") Then Set ie = w End If Next '見つけたIEウインドウから、新しいタブを開く ie.Navigate2 "about:blank", &H800 '目印(about:blank)を付けたタブを探します For Each w In sh.Windows If (w.LocationURL = "about:blank") Then Set objIE = w Exit For End If Next '新しいタブで、URLへ接続 objIE.Navigate "URL" 'データせっとできたので、 'ボタンを押してみる objIE.Document.getElementsByName("export")(0).Click End Sub ～～～～～～～～～～～～～～～～～～～～～～～～～～～～ If (TypeName(w.Document) = "HTMLDocument") Then の所で実行時エラー2147467259(80004005) Documentメゾットは失敗しました。IWEbBrowser2オブジェクト と出ます。 挿入する箇所が違うのでしょうか？ もしよろしければご回答いただけると非常に嬉しいです<m(__)m>
エクセル マクロ エクセルファイルを別名で保存し、指定したフォルダに保存したのですが、初心者ですので詳しい方お願いします。エクセルシートにマクロの実行ボタンを作る 当然ながらこれはできます。 ここからは全くできません。 １.実行ボタンを押すと、 ２.アクティブのシート、セルA6の日付（平成〇〇年〇月〇日）を取得 ３.アクティブのシートのみをマクロ無効にして別名で保存 ４.ファイル名は２で取得した日付yyyymmdd形式のファイル名で保存 （仮にファイル名「20160401」の場合は添付図のような形で保存したいです） ５.フォルダ場所は「D:￥yyyy￥mm￥」 ６.5.のフォルダがない場合はフォルダをyyyyフォルダを「D:￥」の位置、mmフォルダを「D:￥yyyy￥」位置に生成 解りにくくてすいませんがよろしくお願いします。 したいのですが
excel VBA 2003 を使用しています。行が可変で、列が２～２０のデータを1行づつ下方向にずらしたい のですが、cut destination を使うと罫線がcutしたところが消えて しまいます。 罫線を残したままセルの値のみずらしたいのですが、 どういう関数を使えばいいでしょうか。 以下はcutを使用した場合です。 Set Ws = ThisWorkbook.Sheets("リスト") for j=30 to 2 step -1 Ws.Activate Ws.Range(Cells(j, 2), Cells(j, 20)).Cut Destination:=Ws.Cells(j + 1, 2) next j
VisualStudio2015のタイマーコントロールが、ツールボックスに表示されません。 すみません、何方か表示させる方法を教えてください。宜しくお願いします。
教えて下さい。現在エクセルでマクロを組み作成していますが、作成したファイルを次月に前月の内容をクリアする仕組みは作成できましたが、クリアする前にファイルを複製し、デスクトップに保存する仕組みを作りたいと考えていますが、そのような仕組みは可能でしょうか？ 因みに、クリアボタンを押すとＡ1のセルと北海道というファイル名で名保存される仕組みで、その後に私の作成した、クリアするマクロを続けて実行する予定です。 このようなVBAは可能なのでしょうか？ 教えて下さい。
グラフのデータ範囲を自動拡張するvbaのコードに関する質問です。sub extendaData1() Dim sh As Worksheet Dim lastRow As Long Dim startRow As Long Dim rng1 As Range Dim rng2 As Range Set sh worksheets("sheet1") With sh lastRow = .Cells(.Rows.Count, "CE").End(xlUp).Row startRow = .Columns("CE").Find("0").Row Set rng1 = .Range(.Cells(startRow, "CD"), .Cells(lastRow, "CD")) Set rng2 = .Range(.Cells(startRow, "CE"), .CElls(lastRow, "CE")) .ChartObjects("graph1").Chart.SeriesCollection("graph1").Fomula = "SERIES(<" & _ Range(rng1).Addless(External:=True) & "," & _ Range(rng2).Addless(External:=True) & "," & _ 1 & ")" End With End Sub --------------------------------------------------------------------------- sub extendaData2() Dim sh As Worksheet Dim lastRow As Long Dim startRow As Long Dim rng As Range Set sh worksheets("sheet1") With sh lastRow = .Cells(.Rows.Count, "CE").End(xlUp).Row startRow = .Columns("CE").Find("0").Row Set rng = .Range(.Cells(startRow, "CD"), .Cells(lastRow, "CE")) .ChartObjects("graph1").Chart.SetSourceData Source:= .Range(rng) End With End Sub 以上、2通りのパターンで実行してみましたが、 「実行時エラー'1004' アプリケーション定義またはオブジェクト定義のエラーです。」 と表示されデータ範囲が拡張されません。 ググってみたのですがどうしても改善されないので、どなたかご教授いただけると幸いです。 よろしくお願いいたします。
ある複数のデータをひたすらコピペして１つのデータにまとめる作業をしています。結構な数のファイルがあるため、VBAで出来れば簡単なのではと思っていますが、ほぼ初心者に近いので上手く組み合わせられずエラーばかりなので教えてください。 画像の１のような形式のデータが、各人で１シートあります。 それが課ごとに複数ファイルに分かれています。 これを１課から順に１つのシートにコピペしていって画像の２のようなデータに集約しています。 項目の数は全てのシートで同じです(列数は同じ)。 しかし、入っているデータの多さは違います(行数はバラバラ)。 この作業をVBAで自動化出来ないでしょうか。 実際はかなりの人数がいるのでコピペだけで数時間かかっています。 複数のシートを１つのシートにまとめるVBAは理解出来るのですが、ファイルも分かれているものをまとめるものが見つかりません。 あと、社員番号と氏名が別枠にあるので、単純にデータ範囲だけをコピペしてしまうと誰のデータか分からなくなってしまうため左側に社員番号と氏名の項目を増やしています。 行数がランダムなのでどうすればVBAでこの項目も満たせるのか分かっていません。 ファイル名は１課２課…と課の名前になっていて、各課のファイルのシート名は社員番号になっています。 環境はMicrosoftOffice2010です。よろしくお願いします。
上書きボタンに関するVBAを教えてください＞＜ シート A列：日付 B列：商品番号 C列：ステータス D列：＝E列＆F列＆G列 E列：注文番号1 F列：注文番号2G列：注文番号3 H列：補足番号用（時々番号が振られるためフォームに入れ込んでいない） I列：商品名称 J列：備考 上記のようなデータベースを作成中で、 入力用のフォームを作成しております。 ※D列には数式が入っており、またH列は頻繁に発生しないため、 フォームに入れ込んでおりません。 新規作成と、（フォームを）閉じるボタンについては以下のVBAにて 作動しているのですが、上書きボタンのVBAが分からず、手動で手直し 状態です…。 また、フォームを使わずに手動入力した後、別の注文についてフォームを使って 入力したところ、手動入力の行に上書きされてしまいます… （フォームで入力した最後の行が一番下の段と認識している模様・・） ★お知恵を拝借したいのは下記内容です★ ①入力済みのセルを選択し、ワークシート上のフォーム起動ボタンを押したら 入力済み情報がフォームに転記されてフォームが開くので、修正情報を追記、 もしくは修正して上書きボタンを押したら、元の列に新情報が上書き（更新） されるしくみとしたい。 ②やむを得ず他シートから注文情報をコピーしたり、手動入力で打ち込むことも あるため、常に一番下の段にフォームで入力した内容がフォームから転記される ようにしたい。 VBAを習ったこともなく、 作成も初めてなので超初心者にもわかりやすく教えていただければ幸甚です・・ よろしくお願いいたします。
【VBA】ある値を対象行の1行前と2行前に値を貼り付けする方法がよくわかりません。 やりたいことは以下になります。エクセル：2013 ＜マクロ走らせる前＞ B列 C列 1行目 空白 2行目 空白 3行目 5555 001 ・ ・ ・ 8行目 空白 9行目 空白 10行目 5678 001 ＜マクロ走らせた後＞ 1行目 5555 2行目 5555 3行目 5555 001 ・ ・ ・ 8行目 5678 9行目 5678 10行目 5678 001 C列に001がある場合は、1行前と2行前に001と同じ行にある、B列の値を貼り付けるというものです。 ちなみに、規則的に3行おきとかではなく、不規則です。 自分でやったのですが、固定すればうまくできるのですが、変数だとなぜかうまくいきません。 ご教示の程よろしくお願いします。
*Listﾎﾞｯｸｽにﾃﾞｰﾀを出力* Excelﾌﾞｯｸ(R)の値を別ﾌﾞｯｸ(Y)の ﾕｰｻﾞｰﾌｫｰﾑ1のListﾎﾞｯｸｽに出力したい。Excelﾌﾞｯｸ(R) B列(B13,B17,B21・・・4つ飛ばしずつ) C列(C13,C17,C21・・・4つ飛ばしずつ) これを(Y)Listﾎﾞｯｸｽに列毎に縦1列に表示させたいです。 ↓Listﾎﾞｯｸｽの表示↓ B13 C13 B17 C17 B21 C21 : : (R)のﾃﾞｰﾀ数は都度上下します。 トリガは(Y)のｺﾏﾝﾄﾞﾎﾞﾀﾝ1を押したときにします。 どのようにすればいいでしょうか。
VBAでC列のセル値が 空白（””）ならばマクロブックのシート２をコピーして保存し， 空白でなければマクロブックのシート３をコピーして保存する。というようなことを考えているのですが，どのようなコードになりますでしょうか？ ご教示お願いします。 データの入力状態は添付画像のようになっております。 C列は全て空白セルとなっていますが，これから入力されていき， 空白セルと何かが入力されたセルに分かれます。 保存場所は以下のようなコードで作成したフォルダにしたいと考えています。 以下のコードはhttp://hamachan4.exblog.jp/10612140/を参照しました。 For i = 2 To Range("A" & Rows.Count).End(xlUp).Row mydir = "C:\Users\user\Desktop\test\" & Cells(i, 1).Value If Dir(mydir, vbDirectory) = vbNullString Then MkDir mydir Next i MsgBox "完了しました" （例） KENの新規ブックであれば営業1部という名前のフォルダに。 JUNの新規ブックであれば営業2部という名前のフォルダに。
関数について 添付ファイルのSheet1のような表があり、1行目に数字の「1」が入った曜日だけの各項目の合計数値を、Sheet2のC3からC8に入れたいです。毎回、「1」は複数あり位置は変わります。また、Sheet2の部門コードの順番も毎回変わります。関数で解決することは可能でしょうか？
autocadのコマンドマクロについて質問します。 1.0ｍ間隔で線上に直径10ｃｍの円を表示するマクロを教えてください。直径10ｃｍの円はｋ160というブロック名とします。毎回、作成→点→メジャー→・・・・・・・・・と入力していましたが、入力が多すぎてまいってしまいました。よろしくお願いします
マクロVBAについての質問です。 「指定するフォルダの中にあるエクセルファイルを一つずつ開いて作業する。を繰り返す」をするというマクロをくんでいました。ですが、実際依頼を受けてみると、フォルダの中に複数のフォルダがあり、その中のエクセルファイルを開いて作業をするという内容でした。 今現在、『フォルダの中のエクセルを開いて作業する。を繰り返す』というマクロは組んだのですが、このマクロの中に何かを追加して、『フォルダの中のフォルダを開いてその中のエクセルファイルを～』というマクロに変更する事は可能でしょうか？？ 可能であれば、どこに何を追加、すればよいか教えて下さい。 お願い致します。 ↓現在、組んであるマクロ Sub Macro2() ' ' Macro2 Macro ' Dim buf As String Dim Path As String Dim Path2 As String Dim Name As String Dim BookName As String Application.ScreenUpdating = False Path = ThisWorkbook.Worksheets("sheet1").Range("A1").Value 'A1のセルに指定するフォルダのパスがかかれています。 buf = Dir(Path & "\*.xls") 'ここで、フォルダの中のフォルダにあるエクセルを指定したいです。 Do While buf <> "" 【ここに、エクセルの作業】 buf = Dir() Loop Application.ScreenUpdating = True ' End Sub わかりにくくて申し訳ありません。 お願い致します。
エクセルでVBAを使用していたのですがマクロを実行するとエクセルが停止するようになりました。エクセルは2013でOSはwindows10を入れており、これまでは特に問題なく使用できていたのですが、突然上記のような状態になりました。VBAのからユーザーフォームでの実行をすれば特に問題なく動作します。また、ファイルを開いたときに表示されていた「マクロを有効にしますか？」といった内容の警告文もでなくなりました。どのファイルも同じ状況なのでエクセルの設定の問題かと思うのですが、知識に乏しいのでよくわかりません。 どなたか、知恵を貸していただけないでしょうか。
VBAのコードを整えるショートカットキーを教えて下さい。全体を選択してTabを押したら、空白が出来ただけでした。
別表シートに存在する値のときに判定するにはどのようなVBAを組めばよいでしょうか。ソフト：Excel 2013 別表シート（A列）に以下のシートがあるとします。 A列 あいう いいい ううう けけけ 別のシート（作業シート）でB列のような判定をしたいのですが、 どのようにすればよいでしょうか。単純にVlookupにして、 後、値の貼り付けで関数を取り除くでもいいですが、、、文字が含まれるときに 判定するようなVBAを組みたいです。 A列 B列 あいう123 あり けけけ123 あり さしす555 なし けけけ666 あり えのき888 なし ご教示の程よろしくお願いします
エクセルでASINの一覧表があるのですが 自動で物レートでASINを元にページhttp://mnrate.com/item/aid/4394101557の中古出品者数と平均ランキングのデータをコピーし貼り付ける方法を教えて下さい。 全選択コピーしてエクセルに貼り付け必要なデータを切り取ってデータ収集しています。
Excel VBAについて。ユーザーフォームをつくっています。が、 先日保存方法を誤りコードが全部消えてしまいました。 どうか前回のように取り戻せるようご協力します。コードも控えておらず やり方を忘れてしまいました。 ユーザーフォームTextbox1 の値を セルのA3に 登録ボタンで反映したい、 その後 入力を終えます。 次回入力するときは その下の段に入力させたいのです それをAの34まで ユーザーフォーム Combobox1の値を セルのF3に 登録ボタンで反映して 入力を終えます。 次回入力するときは その次の段に入力させたいのです それをFの34まで 以上、このようにしたいので コードを教えていただけないでしょうか。 よろしくお願いします。
VBで、ボタンを押すと3秒からカウントダウンが始まるというのをしたいんですがどのようなプログラムからできるんでしょうか……？
いつもお世話になっております。http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1216140343... にて質問させていただいた続きになるのですが、 上記の質問から多少の変更があったのですがコンボボックスで項目を選びその項目のデータをリストボックスに表示させるというところができました、そしてそれをtextbox2.へ表示させているのですが、そのtextbox2の内容を変更して、コマンドボタンで更新をするとセル・リストボックスの内容をtextBox2の内容に変更できるようにしたいのですがどのようにしたらよいでしょう？ 色々て試したのですが、セルの位置がどうしてもずれてしまいます。 表示させるためのコードはこうなっています。 Private Index As Variant Dim c As Variant Dim r As Long Private Sub ComboBox2_Change() Dim c As Variant, r As Long If ComboBox2.ListIndex = -1 Then Exit Sub With ListBox1 .Clear c = Application.Match(ComboBox2.Text, Rows(1), 0) If IsNumeric(c) Then For r = 2 To Cells(Rows.Count, c).End(xlUp).row .AddItem Cells(r, c).Value Next End If End With End Sub Dim Targetrow As Integer Targetrow = ListBox1.ListIndex TextBox2.Text = ListBox1.List(Targetrow, 0)
Visual Basicにおいて、PictureBoxにレイヤーを掛けることはできますか？VBでお絵かきアプリを作っています。 PictureBox内でペンの色を混ぜ合わせることができるようなプログラムを作りたいのですが、PictureBoxの背景色とペンで書いた色を区別したいです。 そのために背景色の上にレイヤーを掛けて、新しいレイヤー上に色を塗りたいのですが、VBでそれは可能でしょうか。
エクセルVBAで、二つのシート（AとBとします。）を比較するツールをつくりたいです。 列の種類と数は同じですが、キーとなる列の行数はA、BおなじものもあればAのみまたはBのみにあるものもあります。2つのシートをの特定列をキーとし、キーが一致すれば特定列を比較し同じなら何もしない。違うならそのキーを抽出。また、A,Bそれぞれにしか存在しないキーを抽出し、３つのテキストファイルに書き込むツールとしたいです。前提は、A、Bそれぞれキーの昇順に並んでいます。サンプルとなるコードなどありましたらお願いします。
VB2012での特定文字列の位置(バイト位置) 下記のような、コードがあった場合 iには3と入りますが、バイト位置で i=5になるようにコードを書き換えるにはどうすればいいでしょうか？宜しく御願い致します。 Dim str as String Dim i As Long str = ”あいa12う3” i= str .IndexOf("a")
Excelで特定の文字をセルに入力した場合、別のシートの指定のセルに指定した文字を入力できるVBAの書き方を教えてください。現在「承認前」という名前のシートのC8からC57セルにプルダウンで10個程度の選択肢があり、 その中で「AC」か「PC」というプルダウンが選択された場合、 「承認後」という名前のシートのD8からD57セルに、 「AC」の時は「確認要」、 「PC」の時は「確認不要」という文字が入力されるような仕組みにしたいです。 関数は表示させたくないのでVBAにて…。 「承認前」C8が「AC」の時、「承認後」D8に「確認要」、 「承認前」C9が「PC」の時、「承認後」D9に「確認不要」といった感じです。 ACとPC以外のプルダウン選択の時はなにも起きないようにしたいです。 こんな便利なVBAありますでしょうか…。 理解に乏しいため、表現に不足がありましたら補足いたしますのでご指摘ください。 ご教示よろしくお願いいたします。
VBA 開始日・終了日から稼働日付を算出するにはどのようにマクロを記載したら良いでしょうか？下記のようなデータがあります。 （データ量は毎日変動します。） A列 B列 C列 項目 開始日 終了日 データ１ 2016/7/11 2016/7/15 データ2 2016/7/19 2016/7/19 データ3 2016/7/20 2016/7/21 D列に開始日・終了日の稼働日を全て表示させるにはどのようにマクロを記載したら良いでしょうか？ 最終的には、D列に下記のような稼働日を表示したいです。 D列 稼働日 2016/7/11 2016/7/12 2016/7/13 2016/7/14 2016/7/15 2016/7/19 2016/7/20 2016/7/21 情報が不足していたらすみません。 宜しくお願い致します。
A列のアルファベットの付いている文字列だけB列に移動するマクロを教えてくれませんか？”～”には適当に数字が入っている。 A列 りんご A～ みかん C～ ばなな A～ にんじん Z～ ・ ・ ・ ・ これを、 A列 B列 りんご A～ みかん C～ ばなな A～ にんじん Z～ ・ ・ ・ ・ としたいのです。よろしくお願いします。
Private Sub UB_Click() ' ' ボタン１_Click Macro ' ' Sheets("A").ActivateActiveSheet.Shapes.Range(Array("ボタンA")).Visible = True というコード？と一緒に sheetsBのE12に文字を記入するマクロをくみたいのですが 指定したセルからずれてしまいます。 なぜでしょうか。 また同時にマクロを行えるコードを教えてください。
Visual Studio(VB)についての質問です。textbox1のテキストが平仮名かどうかを認識するため、IsHiraganaを用いて文字の範囲を定義したのですが、カタカナ文字を認識することはできませんでした。どうすればカタカナ文字まで認識することができるのでしょうか。以下はプログラムの内容です。 Public Shared Function IsHiragana(ByVal c As Char) As Boolean Return (ChrW(&H3041) <= c AndAlso c <= ChrW(&H309F)) _ OrElse c = ChrW(&H30FC) OrElse c = ChrW(&H30A0) End Function どうか、添削をよろしくお願いします。
VBAで複数項目の合計を出したい 「名前」と「店1」「店2」...という項目名からなる表があります。 「名前」には商品名が入っており、「店1」「店2」には数字が入っています。元データ B C D E 名前 店1 店2 店3 なし 1 6 8 なし 1 4 1 みかん 1 5 4 りんご 40 0 4 なし 50 25 4 りんご 50 60 11 みかん 100 10 40 りんご 100 60 50 りんご 100 60 4 りんご 100 60 50 名前は重複しているものが結構あります。上記の表を下記のようにまとめたいです。 合計データ H I J K 名前 店1 店2 店3 なし 52 35 13 みかん 101 15 44 りんご 390 240 119 dictionaryオブジェクトを使ってサイトのコピペですが下記のようにコードを組んでみました。 Private Sub CommandButton1_Click() Dim myDic As Object, myKey, myItem Dim myVal Dim i As Long Set myDic = CreateObject("Scripting.Dictionary") myVal = Range("B4", Range("B" & Rows.Count).End(xlUp)).Resize(, 4).Value For i = 1 To UBound(myVal, 1) If Not myVal(i, 1) = Empty Then If Not myDic.exists(myVal(i, 1)) Then myDic.Add myVal(i, 1), myVal(i, 2) Else myDic(myVal(i, 1)) = myDic(myVal(i, 1)) + myVal(i, 2) End If End If Next myKey = myDic.keys ’書き出し myItem = myDic.items For i = 0 To UBound(myKey) Cells(i + 4, 8).Value = myKey(i) Cells(i + 4, 9).Value = myItem(i) Next Set myDic = Nothing End Sub これだと（当たり前ですが）店1の合計数は出してくれるのですが、店2からあとの合計が出ません。 myDic.Add myVal(i, 1), myVal(i, 2) の2をFor next の変数に置き換えたりしたのですが それだと全部の数字が合計されてしまいます。 店1店2の項目の行は100個近くあるので、For next を使って記述できればいいなと思ったのですがどこにForを置けばいいのか分かりません。 ご教授いただければと幸いです。
シート名の頭文字を判定し、ユーザーフォームのリストボックスの内容を可変的に表示させる方法 Excel2010を使用しています。Bookには「リスト」シートのほか、シート「あ1」～「あ30」、「い1」～「い30」、「う1」～「う30」、「え1」～「え30」、「お1」～「お30」、とシート名を付けた150以上のシートがあり、各シートに同じユーザーフォームを表示させるボタンを配置しています。 このユーザーフォームには「リストボックス」や「OK」、「キャンセル」などのボタンを配置していますが、このリストボックス内に表示させる内容を「あ」系列であればリストシートに用意したリスト範囲をリストボックスに表示させ、例えば↓↓↓↓ With ListBox1 .ColumnCount = 1 .RowSource = "リスト!A2:A20" .ColumnHeads = False End With 同じく、 「い」系列であれば .RowSource = "リスト!B2:B20"、 「う」系列であれば .RowSource = "リスト!C2:C20"、 「え」系列であれば .RowSource = "リスト!D2:D20"、 「お」系列であれば .RowSource = "リスト!E2:E20"、 の内容をリストボックスに表示させたいと考えております。 シート名の頭文字を取得、判定し、ユーザーフォームのリストボックスの内容を可変的に表示させる方法をご教示いただけないでしょうか。
VB2013にて質問です タイマーを使ってある時間になったら動作するようにしたいのですが どうもわかりません 一定間隔でのタイマーメソッドは使えますが Ｉｆ文でどうすればいいのか？ＩＦじゃないかも試行錯誤してもうまく動作しません ★やりたいこと 例 午前 9：15になったら Textbox1に指定文字が出る 午前 12：15でアプリケーションが Ａｐｌｉｃａｔｉｏｎ．Ｅｘｉｔで閉じる 午後 14：00で Textbox2に指定文字が出る 午後 17：15で アプリケーションが Ａｐｌｉｃａｔｉｏｎ．Ｅｘｉｔで閉じる という感じで 時間指定にてプログラムを動かすにはどうしたらいいでしょうか？ プログラム自体は 朝自分で起動し そのあとは昼に自分で起動する 後は常時つけっぱなしです ご教授よろしくお願いいたします。
エクセルのマクロについての質問です。 データが1行目から入っている表があります。その表の2行目、4行目、6行目・・・と1行おきに、 C列～P列までのデータをコピーしてその行のQ列～AD列に貼り付けたいです。 データの量は変わります。 C列以外は途中にデータの空白セルが存在します。 ご教示お願いできないでしょうか？ 何卒、宜しくお願い致します。
以前ご回答いただきありがとうございました。私の説明が悪く、簡潔に書きすぎてしまったので、もしお時間があるときがありましたら、 下記VBAコードをご教授頂けたら、とても嬉しいです☆ ①worksheet”請求書”のD列にある名前と同じ名前をworksheet”現場”の中にある、シート名から 探して、そのシートにD列の左３つ（A列）から右５つ（I列）をコピーして、取得したシート名の空欄の行を取得して貼り付ける ②D列にはたくさんの現場名があり、すべてのシートに上記の様に貼り付けていきたいです・・・。 私の能力ではどうにもならず、ネットの検索や参考書などで探しても、ダメでした。 お力添えいただければ、幸いです。
VBA IE操作 テキスト反映について 下記ソースの場合、どのようにすれば入力に反映させることができるのでしょうか。下記でやってみたところ、「オブジェクトはこのプロパティまたはメソッドをサポートしていません」とエラーになっています・・・。 .document.GetElementsByName("Email").Value = "アドレス@gmail.com" <label class="hidden-label" for="Email"> メールアドレスを入力してください</label> <input id="Email" name="Email" placeholder="メールアドレスを入力してください" type="email" value="" spellcheck="false" >
「指定したﾌｧｲﾙのｴｸｾﾙﾌｧｲﾙを次々に開きｼｰﾄ上にｸﾞﾗﾌを描く」に挑戦中です。 ﾏｸﾛ初心者です。Sub グラフ描くマクロ() Dim wbName Dim suji As Long wbName = Dir("ﾌｫﾙﾀﾞのｱﾄﾞﾚｽ\*.xlsx") Do Until wbName = "" With Workbooks.Open("ﾌｫﾙﾀﾞのｱﾄﾞﾚｽ\" & wbName) With .Worksheets(1) suji = ThisWorkbook.Worksheets(1).Range("AO140").Value .ChartObjects.Add 10, 20, 480, 300 .ChartObjects(1).Chart.ChartType = xlLine .ChartObjects(1).Chart.SetSourceData Source:=ThisWorkbook.Worksheets(1).Range("AO4").Resize(suji, 3) With .ChartObjects(1).Chart If .HasLegend = True Then .HasLegend = False `凡例は消したい End With ActiveWindow.Zoom = 80 ’ｻｲｽﾞ変更 End With .Save .Close False End With wbName = Dir Loop End Sub ﾈｯﾄ上のｺｰﾄﾞをﾂｷﾞﾊｷﾞして何とかﾌｫﾙﾀﾞ内のﾃﾞｰﾀを次々に開いてｸﾞﾗﾌを描くことは出来たのですが このｺｰﾄﾞですと1番目のﾌｧｲﾙから取得した同じﾃﾞｰﾀのｸﾞﾗﾌがすべてのﾌｧｲﾙに貼られてしまいます。 当然のことながら各々のｼｰﾄから取得したﾃﾞｰﾀをｸﾞﾗﾌにしたいと思います。 suji = ThisWorkbook.Worksheets(1).Range("AO140").Value .ChartObjects.Add 10, 20, 480, 300 .ChartObjects(1).Chart.ChartType = xlLine .ChartObjects(1).Chart.SetSourceData Source:=ThisWorkbook.Worksheets(1).Range("AO4").Resize(suji, 3) ↑ﾃﾞｰﾀは縦の数がｼｰﾄごとに微妙に変化するのでAO140に個数をCountで数えてあります。 横の数はいつも3行で、始点はAO4で固定です。 更に、これに加えてもう一つの折れ線ｸﾞﾗﾌをすぐ下の位置に表示させたいです。 こちらのデータの場所は Range("AR4"),Resize(suji2,3) Suji2 = Range("AR140").value です 同じｺｰﾄﾞを範囲だけ変えて二つ並べて書くと 下のｸﾞﾗﾌが何故か真っ白になってしまいます。 どなたかわかる方いらっしゃいましたら教えて下さい。 宜しくお願いします。
お疲れ様です。 事務処理業務をしているものです。 その中で、以下の様な作業をマクロを使って実施したい為、ご教示願います。 エクセルのA1に寿司の文字が入力されており、この文字が含まれるフォルダをCドライブ以下から検索して開きたい。 現在勉強中でまだまだ不明点ばかりなので、何卒お知恵をお貸しください。
VB .net プログラミングで教えてください。 下記の通りテーブルAの列があります。ＤＢへ更新作業するのに一旦、クラスへ入れてから更新かけようと思うのですが、どのように書けばよいのでしょうか？テーブルA CODE : 社員コード NAME : 社員名 列3 ...列4...と .... 以降続く
VBA初心者です。 excelのVBAでの質問なのですがinputしたファイルをoutputする際に、縦書きに変えたいのですがプログラムの書き方が分かりません。 わかる方教えてくだいさい。よろしくお願いします。
VBAの検索コードを編集したいと考えています。 以下のコードはCTRL+Fの検索が行われるのですが コード中に書いたように編集したいと考えております。Sub array_test() Dim intF As Integer Dim varShar As Variant varShar = Array(1, 2, 3) ↑この部分は左から3つ分のシートを shiftを押しながら選択となっているのですが、 4つ目以降のシートから対応させたいです。 また5枚目、6枚目と増やしていっても自動対応できるようにしたいです。 なお4つ目のシート名は1、5つ目のシート名は2、のようにナンバリングします。 intF = 0 For Each Var In varShar If intF = 0 Then Sheets(Var).Select intF = 1 Else Sheets(Var).Select False End If Next Var Worksheets(1).Range("A1").Select SendKeys "^c" SendKeys "^f" SendKeys "^v" SendKeys "{Enter}" End Sub ご教示お願いいたします。
エクセルVBAで質問があります。2つのデータを照らし合わせるVBAです。古いデータ チーム名 評価 A ーーーー2 B ------------1 C ------------1 新データ チーム名 評価 A ------------1 B ------------2 C ------------3 D ------------4 E ------------1 上記のデータがあります（－－－は無視してください）古いデータの評価を更新して新しいデータで増えたチームを古いデータの一番下に書き込むVBAはどのように書いたらよいのでしょうか？古いデータにある評価を更新するVBAはかけたのですが（for 文で新しいデータにあるチームを一つ一つ古いデータのチームと照らし合わせ同チームが見つかれば新データの評価をチーム名の隣のセルに書く）。増えたチーム名とその評価を古いデータの一番下に書き込むVBAはどう書いていいのかわかりません。評価の更新VBAの次に新たにfor 文を書き、古いデータにないチームあればチーム名と評価を空欄に書き込むというVBAでいいと思うのですが、いかがでしょうか？初心者なものでこんなことでつまずいています。教えていただければ幸いです。
On Error Resume Next Dim oupnainpt , v1,v2,vpath,apv1 = WScript.ScriptFullNamev2 = WScript.ScriptName vpath = left(v1,len(v1) - len(v2)) Dim fime Dim wnw Set wnw = WScript.CreateObject("WScript.Network") '-事前処理----------- Dim wnwa Set wnwa = WScript.CreateObject("WScript.Network") Dim younames Dim youname younames = " { ユーザーの名前 = " & wnwa.UserName & " }" youname = wnwa.UserName younametoo = " ユーザーの権限 = local administrator.です" Set objNetwork = CreateObject("Wscript.Network") strComputer = objNetwork.ComputerName strUser = youname Set objGroup = GetObject("WinNT://" & strComputer & "/Administrators") For Each objUser in objGroup.Members If objUser.Name = strUser Then Dim younametoo younametoo = "local administrator.です" End If Next fime = "起動:" & Now() & " (正常に起動しました) " & younames & younametoo '------------------- Dim objFS ' FileSystemObject Dim strFolder ' フォルダ名 strFolder = "log" Set objFS = WScript.CreateObject("Scripting.FileSystemObject") If Err.Number = 0 Then If objFS.FolderExists(strFolder) = True Then Else objFS.CreateFolder(strFolder) If Err.Number = 0 Then Else End If End If Else WScript.Echo "エラー: " & Err.Description End If Set objFSO = Nothing Dim fso Set fso = CreateObject("Scripting.FileSystemObject") ' 読み込みの指定 Dim inputFile inputFile = fime Set objFso = CreateObject("Scripting.FileSystemObject") Set objFile = objFso.OpenTextFile(vpath & "log\start " & now() & " .log ", 2, True) If Err.Number > 0 Then Else objFile.WriteLine "" & fime End If objFile.Close Set objFile = Nothing Set objFso = Nothing これはいつPCが起動したか記録するvbsです ですがなぜかlog( start " & now() & " .log 74行目)が作成できずにいます あと前回記録も残し改行してlogファイルに記録したいのですがそれもできていません だれか教えてください
VB.NETで、USBポートに接続されたiPhoneのデバイス名とファームウェアのバージョンを取得し、フォーム上に表示する処理を書きたいのですがどのようなアプローチをすればよいでしょうか？お手数ですが、なるべく簡単な表現で説明いただければと思います。高校生がいじっている程度なので現場でやっておられる皆さんには到底及びません。
strDelFile = FName Set objFSO = WScript.CreateObject("Scripting.FileSystemObject")If Err.Number = 0 Then objFSO.DeleteFile strDelFile, True If Err.Number = 0 Then msgbox FName&"を削除、完了しました" ElseIf IsEmpty(FName) then objFSO.DeleteFile strDelFile, True の部分でエラーが発生したとき、メッセージを表示するにはどうすればいいですか？
エクセルVBAで、セルの左上につく緑色の▼（エラー）を消したいです。 既に作成されていエクセルファイル上で、数値が文字列として保存されている、とのエラーマークが出ているセルがあります。文字列で良し、としたいので、手動では、対象のセル範囲を選択し、先頭のセルで、エラーを無視する、をクリックして範囲全体のエラーマークを消しています。 これがVBAで自動化できないでしょうか？ （同様のエラーが出ているセルを自動複数選択し（連続していない可能性あり）、エラーを無視する が実行できればベストです。自動選択が無理であれば後半だけでも） 宜しくお願いします！
エクセルのVLOOKUP関数のようにDataGridViewのcolum1を入力するとcolum2が変更されるような方法は無いのでしょうか？初心者でリスト入力で一つずつ入力しているのですが、上手い方法を教えてください。 お願いします。
VBAに詳しい方お願いします！ 私はVBA初心者です！ 先日、Excel上でテーブル２つをIDをキーにして結合し、新しいテーブルを作成する方法について質問を行いました。この条件に加えまして、仮に役職が複数あって、 その役職ごとに新しく行を追加したい場合、どの様にすればよいのでしょうか？ また、役職がない場合は行そのものが追加されない、ということも出来るようにしたいです。 使用しているのはExcel2010です。 テーブル1 ID 氏名 Pass kotoko1 市崎 123456 kotoko2 新崎 234567 kotoko3 三崎 345678 kotoko4 志崎 910456 テーブル2 ID 役職 kotoko1 市長 kotoko2 , kotoko3 部長代理, 課長 kotoko4 , 目標のテーブル3 ID 氏名 Pass 役職 kotoko1 市崎 123456 市長 kotoko3 三崎 345678 部長代理 kotoko3 三崎 345678 課長 よろしくお願いいたします。
LaTeXでコンパイル時にエラーがでます。! Missing \endcsname inserted. <to be read again> \protect L.13 \newlabel{fig:\cite {3}}{{4}{3}} ? とでます。 l.13のところを見てみますと \begin{document} ここがL.13 \maketitle こんな感じで何が原因かわからないです。 途中まではうまくコンパイルできていたのですが\citeを使ったところからエラーを吐き出しました。 試しに\citeを全部消してみたのですが結果は変わらずでした。 どうしたらいいでしょうか・・・。 なるべく早いご回答お待ちしてます。
エクセルVBA初心者です。ユーザーフォームを使いデータの入力をしていますが スピンボタンにフォーカスが移ったときに、誤ってキーボードの「↑」ボタンを 押すことがあり、以前の入力済みのデータに移ってしまうことがあります。 スポンボタン操作は、画面上だけで良いので、何か良い知恵があれば ご教示ください。
excelのユーザーフォームに、シート上に置いた画像を選択的に表示する方法についてご教示ください。一時的にbookと同じパスに画像をファイルとして保存して、それを読み込んだ後にファイルを削除する方法をやりたいと考えています。画像はシート上に複数存在し、ユーザーフォーム上の特定のTEXTBOXの値に対応した画像のみ表示させたいのです。 例えば、Sheets("画像")の上に、pict0～pict10までの画像があります。 ユーザーフォームの某Textboxの値が0なら、フォームを開いた時にpict0を読み込む。値が1ならpict1を読み込む。 といった具合です。 そして、Textboxの値が変化したら画像も変化させたいです。 この様なことは可能でしょうか。
テーブル内の文字列“山田太郎”を”山○太○”に変換したい。 お世話になります。Accessのテーブル内の情報を、顧客情報管理の関係で 例えば“山田太郎”というデータを “山○太○”に変換したいと思っています。 ちなみにそのデータは “患者マスター”という名前のテーブルの “氏名”というフィールドのデータになります。 文字列でなく数値データである場合も教えて頂けると 助かります。 どうぞよろしくお願いいたします。 Access2016、Windows8.1で使用しております。
エクセルVBAで教えてください。 １．Sheet1に数値を入力します。 （手動） ２．計算開始のボタンを押します。（手動） ３．VBAにより、Sheet2にSheet1を参照する式が自動で入力されていきます。 例えば、Sheet1のA1に「１」、A2に「２」という値が入っていたとして、VBAによりSheet2のA1に=SUM(Sheet1!A1,Sheet1!A2)を入力する。（これによりSheet2のA1には3が表示されますが、値の合計でなく、あらかじめ用意した式が入っていくイメージです）これをB2、B3、B4、～・・・と、ひたすら繰り返します。 ４．３の転記による計算結果の合計が0になった時点で３の処理をとめます。 詳しい方、 よろしくお願いします。
Excelの質問です COUNT関数を使って数を数えたいのですが 範囲の中で空白のセルと、特定の文字が含まれているセルはカウントしないようにしたいです。初歩的な質問ですが、よろしくお願い致します
vbaで図形をアクティブにする方法を教えてください。 あるシートに必ず一つ図形があるとします。その図形をアクティブにしたいのですが名前は図1かもしれないし図50かもしれません 名前のわからない図形をアクティブにする方法はありますか？
EXCELファィルをマクロを使用してPDFにするにはどうすれば良いですか? 2通りの方法が知りたいです。 1.印刷範囲を指定しているシートをPDFに変換。名前はシート名を自動でつけたいです。2.ファイル全体のシートを一括でPDFに変換。名前はファイル名を自動でつけたいです。 よろしくお願いします。
エクセルVBAで教えてください。 １．Sheet1の１行目には1980年以降毎年の年度が記入されており、その下には５行目まで数値が入力されている表があります。２．ユーザーフォームを作成し、ドロップダウンリストで表示されている年度（例えば1980年～2016年までの年度があるとすれば、それをドロップダウンリストをから選択する。このときドロップダウンリストは元になった表に表示されているなかから選択。例えば1990年～を選択した場合、終わりは1991～2016の中からしか選択できないようにできるとありがたいです。） ３．ＶＢＡによりSheet1の選択された範囲の1行目～５行目までの積み上げ棒グラフが自動で生成される（仮に1990年～2000年を選択したとすると、この間の積み上げ棒グラフが生成されるイメージ。） というVBAを組みたいと考えています。 このとき、要素の間隔は0に。 グラフの枠線はなし。 各行ごとにグラフの色を変える。 グラフタイトルはユーザーフォームに入力したタイトル。 判例は右上にグラフと重ねて表示 という処理を併せて実施したいです。 どなたか詳しい方、教えてください。
Excel vbaについての質問です。 特定の列に例えばaの文字(aだけやjadなどの文字がある。)が入っている時にその行を色付けする構文を教えてください。
エクセル超初心者で恐縮ですが、VBAについての質問です。 あるリストをオートフィルターで順番に自動で抽出して、印刷したいです。毎回、リストの項目を一つ一つチェックしては印刷しているのですが、これを一括で行えるようにしたいのです。 例えば ○Ａ Ｂ Ｃ Ｄ Ｅ 1 2 3 4 5 ↑の様なリストがあるとしてＢ列をフィルターで抽出、印刷しようとしたのですが Sub フィルタ印刷() Dim Sh As Worksheet Dim Rng As Range Set Sh = Worksheets("Sheet1") If Sh.FilterMode Then Sh.Range("A1").AutoFilter With Sh.Range("B1", Sh.Cells(Rows.Count, 4).End(xlUp)) .AdvancedFilter Action:=xlFilterCopy, _ CopyToRange:=Sh.Range("Z1"), Unique:=True For Each Rng In Sh.Range("Z2", Sh.Cells(Rows.Count, 26).End(xlUp)) If Rng.Value <> "" Then .AutoFilter Field:=1, Criteria1:=Rng.Value Sh.PrintOut Preview:=True End If Next End With If Sh.FilterMode Then Sh.Range("A1").AutoFilter Sh.Range("Z:Z").ClearContents MsgBox "印刷完了", vbInformation Set Sh = Nothing End Sub これだと同じページが複数枚印刷されてしまいます。 一枚ずつ印刷したいです。 出来れば↑を改変して利用したいのですが、分られる方おられましたらお力添えお願い致します。
ExcelのVBAについての質問です。sheet2のA列にある名簿をsheet1のA列の２行目から順番に４回ずつコピペするマクロを組みたいのですが、繰り返し処理の理解が不十分であるため、上手く作成することができません。 どのようなコードを書けば良いのか、ご教示いただければ助かります。 大変お手数でありますが、よろしくお願いします。 こんな感じです。 【sheet2】 今岡 赤星 金本 ： ： ↓コピペ 【sheet1】 今岡 今岡 今岡 赤星 赤星 赤星 金本 金本 金本 ： ：
VB.netのテキストボックスに入力された値がyyyy/MM/dd形式か否かを判断する方法はありますでしょうか？ isdateで日付型に変換できるか否かで判別したいのですが、isdateだと、yyyy/M/dもtrueとなってしまうので、困っています。 理想は、yyyy/M/dだと、メッセージボックスで警告をだし、yyyy/MM/ddのみ、先に進める、という処理をしたいです。 判別法があれば、お願いします。
エクセル関数マクロに詳しい方、ご教授をお願いします。 a列３：11に品名入力、d列に品名マスターがある。b列3:11にそれぞれの数量入力すると、d列の品名マスターにa列に入力した品名と数量がe列に数量が反映される表です。 e列には、関数設定がある。 下記 例のようにマクロ、または、関数で、出来るようにしたいです。 「２５」を最大にしてマクロ、関数でどのように、設定したらよいか 教えてください。 マクロ、関数は、入門者なので、よろしくお願いします。
Excel vbaについて質問です。いろいろプルダウンについて調べたのですが解決できず、ご教授していただくと助かります。sheet1からsheet10まであって それぞれ名前がついています。 たとえばsheet1は山田 sheet2は渡辺……… プルダウンリストを作ってリストから山田や渡辺を選択します。 そこから山田を選択したら山田のsheetに 切り替わるというものを作リたいのですが 何かいい方法はありますでしょうか？
先ほど、このページを見ました。 ●Office 2016で“ヤツ”を召喚してみた。http://www.ka-net.org/blog/?p=5492 自己責任で同じことをOffice2010でやってみたいと思いました。 ですが、このページは、あまりやり方が書いてないので、質問しました。 VBAコードは、何とか調べて、出来ましたが、リボンXMLの方が分かりません。 どなたが知っている方、教えてくれませんか？
エクセル2013を使用しております。 ファイル①のシートA と、ファイル②のシートB があります。 3行で１つの品物の管理をしており、1行目は入庫、2行目は出庫、3行目は在庫となります。お互い同じ様式を使用しており、A列にはコード№が入っております。 ※A10 から3行単位でコード№が入力されている。 (例) A10のコード＝123 A13のコード＝456 A16のコード・・・・ そこで実行したいマクロは、ファイル①のシートA A列のコード№と、ファイル②のシートB A列のコード№が一致した場合、ファイル①シートA 「AK列」の在庫数を ファイル②のシートB 「E列」の在庫数へ転記がしたく。 ※添付画像参照 知恵を拝借させて下さい。宜しくお願い致します。
VBA IE操作 ボタンクリックについて 下記ソースのログアウトを実行したいと考えています。下記「現在のプログラム」で実行できる場合もあるのですが、開いたページの表示が変わる場合があり、 実行できない場合があります。どのようにすれば「a」タグではない方法で「ログアウト」を実行することができるのでしょうか。 ご教示お願い致します。 現在のプログラム With myIE If .Document.all.tags("a").Item(6) > 0 Then End With ソース元 <a href="/logout" class="yt-uix-button yt-masthead-picker-button yt-uix-sessionlink yt-uix-button-default yt-uix-button-size-default" data-sessionlink="ei=kDd_V4_gIM-H-QXX1LPIAg"><span class="yt-uix-button-content">ログアウト</span></a>
ExcelVBA での質問です。 お世話になっております。ExcelVBAでの質問なんですが ただ今Excelからoutlookを操作してメールを送ったりフォルダを振り分けたりしております。 outlookにはパスワードがかけてあるのでExcelから操作するたびにパスワードを入力しなければいけません。 なのでExcelVBAのコード内にパスワードを記入しておいて、ExcelVBAからの操作の場合はパスワードが自動で入力されるようにすることは可能ですか？ Accessへの場合ではできたのですが、outlookのコードはネット上にも少なく困っております。 よろしければサンプルコード等をいただけると助かります。
エクセルVBAについての質問です。当方超初心者です。 フォルダAの中に、エクセルファイルB（中のシート名”C”）とフォルダDがあります。シートCのE3からE11セルには、フォルダD内に入っているファイルの名前がフルネームで入ってます。VBAを使って、シートCの3行目から11行目の名前に対応するファイルをフォルダDから開きたいと思って以下のようなコードを書きました。 Dim f As Worksheet, i As long Set f = Sheets("C") for i = 3 to 11 Workbooks.Open ThisWorkbook.Path & "￥D" & f.Cells(i, 5) next しかしこれを実行しようとすると、読み取り専用または暗号化されていてアクセスできないとなります。 どうか無知なわたくし目に正しいコード、ないし解決を教えてくださいm(__)m
VBA での質問です。 お世話になっております。 ExcelVBAでの質問です。 セルD1からS1までに各項目が設定されています。ユーザフォーム上にコンボボックスを2つ配置してあり、 コンボボックス1にはその項目一覧から選択できるようにしてあります。 項目を選択した場合その項目下のデータをコンボボックス2のリストに表示させたいのですがどのようにしたらよいでしょうか？ いろいろ試したのですが見当違いの結果になってしまい困ってしまっています。 よろしくお願いいたします。
エクセルVBAについての質問です。★質問1★ 1つのブック内に下記の複数シートが左から存在します。 (例) 練習1-1 練習1-2 練習2-1 練習2-2 練習2-3 練習3-1 このシート名の前から3番目の文字が変わったタイミングで、別ブックにわけるにはどうすれば良いでしょうか？ブック名は、前から1〜3文字目です(例:練習1のブック内に、練習1-1、練習1-2のシートを作成する) ★質問2★ 質問1のシート名が、シート分割したい順になっていない場合も、同様に前から1〜3文字目ごとのシート分割はできるのでしょうか？ (例) 練習3-1 練習1-2 練習2-1 練習1-1 練習2-2 練習2-3 これを、練習1ブック内に、左から練習1-1、1-2のシートを作成。 練習2ブック内に、左から練習2-1、2-2、2-3のシートを作成。 練習3ブック内に、3-1のシートを作成。 以上、恐れ入りますがVBAに詳しい方、ご回答お願いいたします。
Excel VBAを勉強中の初心者です 本読んで勉強してますが中々覚えきれません。 なにとぞお手柔らかにお願いいたします。 さてお力を拝借したい内容ですが、 ユーザーフォームのテキストボックスに 打ち込んだ内容を転記するコードを 教えていただけないでしょうか？ ①テキストボックスには日付「2016/7/7」という形式で入力してあります。 ②その日付を「管理表」シートのセル「A3」へ転記させます 使用しているPCのOSはwin7 officeは2010です→これは特に関係ないかもしれませんが念の為記載しておきます。
関数もしくはマクロで、複数の検索条件で、データを呼び出し貼り付けることは可能でしょうか？関数(C2=IFERROR(VLOOKUP($A6,シート１!$B:$C,2,FALSE),""))でデータを呼び出そうとしたのですが、元データは毎月変わり、他の月も関数を入れたら同じ数字が反映されてしまうことに先ほど気づき…(´Д` ) ●シート１：元データ A列―B列―C列 1行目-2016/5←月ごとに変わる） 2行目-会社名―顧客№―数量 ●シート２：5行や10行ごとにある、”数量”のある列にシート１のC列(数量)からデータ を呼び出したい。B列の項目は”数量”以外の項目があります。 A列―B列―C列―D列… 1行-顧客№―space―2016/5―2016/6―2016/7… 2行-顧客№―数量－ 3行-顧客№―支払額- 4行-顧客№―請求額- シート2で、 ”顧客№”を探す。 その顧客の中で、”数量”の行を探す。 該当月を探す。 シート１の数量の値を貼り付ける。 何卒ご助力をお願い致します。
エクセル2007 特定のブックだけステータスバーなどを非表示にしたい オプションの詳細設定などで数式バーなどを非表示にするとエクセルで開く全ファイルが非表示になってしまいます。特定のブックだけツールバーをはじめすべてのステータスバー等を非表示にする方法はありませんでしょうか。 ひとつのマクロを実行するだけのブックなので、アプリっぽく見せる為です。
全角の中点「・」の文字コードはJIS8でしょうか。 ラベルプリンタで印刷するコードを書いているのですが、プリンタの仕様には以下の記述がありました。伝送コード系：JIS8、漢字はシフトJIS ただし、漢字は第１水準、第2水準のみ 外字の使用は不可 いろいろサイト見回ったのですが、「・」が上記で使用できる文字なのかはっきりわかるところまで調べきれませんでした。
エクセルにて、条件付き書式でこのような式を入力しました。=ISBLANK(RC2) = False 列番号2は日付列で、「該当行の日付が入力されている場合のみ、セルの色を変更する」といったものです。 しかし、日付は結合されている場合もあり、その場合「RC2」の値は未入力になってしまっています。 ユーザー定義関数を作成し、以下の様に変更してみると、今度は常にTrueを返し、日付が未入力の場合でも色が変更されている状態になってしまいました。 <条件付き書式> =ISBLANK(DATEGET(RC2)) = False <ユーザー定義関数> Public Function DATEGET(ByVal rg As Range) As String DATEGET = rg.MergeArea(1,1).Value End Function どうすれば解決するでしょうか？？ どうすれば解決するでしょうか？
マクロ初心者です。B列に貼り付けると同じ行の他の列に顧客情報がでてきて、B列から消すと消えるようにしたいです。少し簡略化して書いていますが、このようなマクロを書くと無限ループになってしまいます。アドバイスをください。宜しくお願いします。 Sub Worksheet_change(Byval target As Range) Dim i As Long For i = 8 to 500 If Cells(i,2) <> "" Then Cells(i,3).Value = "123" Else Rows(i).Delete End if Next i End Sub
Excelのマクロを使って、選択したデータ行を、自動で別シートに移動して、削除したい と考えています。具体的には、Excelでデータが入力されている行の先頭に「1」を入力してマクロボタンを押すと、 その行をコピーしてから、別のシートに行き、その別シートのデータ最下行に貼り付けた後、 元のシートに戻り、先頭に「1」を入力した行を削除するというExcelのマクロをご教示頂けますでしょうか？ 具体的には、ExcelでTodoシートを作成しています。 TodoシートのSheet名は「Sheet1」とします。 セルA2：「フラグ入力欄」 セルB2：「やること」 セルC2：「締切日」 セルD2：「備考」 という項目名を入れており、その下にやるべきことを書いています。 シート名「Finish」にも同じ項目があります。 セルA2：「フラグ入力欄」 セルB2：「やること」 セルC2：「締切日」 セルD2：「備考」 例えば、もし「Sheet1」のB3からD10まで、何らかのデータが入力されて A4とA7に１というフラグを入力してからマクロを実行すると 1と入力した行をコピーして、シート名「Finish」のA3から上から順に貼付けを行い、 最後にSheet名「Sheet1」に戻って、A4とA7の行を削除するというマクロがあれば 効率化ができると考えております。 ※今まで手作業でやっていました。 自分で作成できれば良いのですが、まだ勉強中の未熟者であるため、 ぜひとも上記が実現できるマクロご教示頂ければ幸いです。 どうぞよろしくお願い致します。
VB2008のソケット通信 下記のようにサーバ及びクライアント側があり サーバ側で取得したＤＢ結果(複数件)をクライアント側へ渡したい。 できれば、配列等で渡す方法はありませんでしょうか？ご教授のほど御願い致します。 '********************************************** '******* ＜サーバ側プログラム＞ *************** '********************************************** ' 商品マスター表からレコード読込 Using dr As SqlDataReader = cmd.ExecuteReader() While dr.Read() ★★★★ = Cstr(dr("商品コード")) ★★★★ = Cstr(dr("商品名称")) ★★★★ = Cint(dr("販売単価")) End While : 'クライアントへ送信データ設定 ★ここでサーバのＤＢ結果をどのように渡せばいいのか？ (データ件数は複数件あり) Dim buffer() As Byte = System.Text.Encoding.GetEncoding("shift-jis").GetBytes("★★★★") stream.Write(buffer, 0, buffer.Length) '********************************************** '******* ＜クライアント側プログラム＞ ********* '********************************************** 'サーバからのデータ受取り Dim data(100) As Byte Dim len As Integer = stream.Read(data, 0, data.Length) ★ここでサーバのＤＢ結果をどのように受取りそして取り出せばいいのか？ (データ件数は複数件あり) Dim str As String = System.Text.Encoding.GetEncoding("shift-jis").GetString(data, 0, len)
図のようなエクセルがあり、ボタン一発で、Ａ１とＡ２の内容をＢ１に入力するためのマクロを考えています。手作業だとＡＬＴ＋エンターで改行する必要がありますが、これをマクロでやるにはどのようにすればいいですか？ よろしくお願いします。
Sub 対象〇のみ転記() With Sheets("売上管理表") .Range("A1").CurrentRegion.ClearContents.Range("A1:Ｄ1").Value = Array("区分", "案件名", "契約金額", "成約日") Sheets("見込管理表").Activate n = 2 For i = 4 To Cells(Rows.Count, 1).End(xlUp).Row If Cells(i, 1).Value = "〇" Then Cells(i, 1).Resize(, 4).Copy .Cells(n, 1) n = n + 1 End If Next End With End Sub 写真のような仕上がりになるはずです 投稿画像
初めまして。 他の方の質問を見ていて、的確な説明をしていらしたのでリクエストしました。 VBSで拡張子を変更したいのですがどうしたらいいか分かりません。Windows ローカルで動作する、VBS ファイル内で使われるスクリプトに関する質問です。 「C:\Data」というフォルダの直下に 「aa001.png」、「aa002.txt」、「aa003.jpg」 というファイルがあった場合に、拡張子が「.jpg」のファイルだけを拡張子「.tif」に変換。 実行前：「aa001.png」、「aa002.txt」、「aa003.jpg」 実行後：「aa001.png」、「aa002.txt」、「aa003.tif」 最終的にこうなるようにしたいです。 可能であれば、ご教示ください。
ExcelのVBAで、iが1～30のWEBサイト(http://○○○.com/×××/i)から titleを取得するために下記のコードを書きました。いちおう動くには動くのですが、 ある程度進んだところで失敗します。 「インデックスが有効範囲にありません」 デバッグをクリックすると★の行がマーキングされます。 毎回停止する場所(i)が異なりお手上げ状態です。 コードの修正箇所、回避方法をご存知の方、力をお貸し下さい。 宜しくお願い致します。 ------------------------------- Dim ie_obj As Object Dim url As String Dim title As Variant Dim gyou As Integer gyou = 1 Cells(gyou, 1).Activate For i = 1 To 30 Set ie_obj = CreateObject("internetexplorer.application") url = "http://○○○.com/×××/" & i ie_obj.navigate url Do While ie_obj.Busy = True Or ie_obj.readyState < READYSTATE_COMPLETE DoEvents Loop title = Split(ie_obj.document.title, "-") Selection.Value = title(0) ★ ie_obj.Quit Set ie_obj = Nothing gyou = gyou + 1 Cells(gyou, 1).Activate Next i ------------------------------- 補足①（HTMLソースコード内のtitle部分） <title>●●●&nbsp;-&nbsp;■■■ - ▲▲▲</title> ●●●が得たい値です。 補足②（動作環境） Excel 2003
VBAのマクロで、ツールの参照設定にあるライブラリをすべて参照可能にすると、実行速度が極端におちたり、何かしらのデメリットはあるでしょうか。単純に、初期設定ですべて参照可能にしておいてくれれば、マクロの内容に関わらず、「余計な設定の手間が必要ないのにな」と、素人考えで思ってしまいました…。
ハイパーリンクに設定しているURLを指定したセルへ出力する方法もしくは、ctrl+Cなどでクリップボードに一発コピーする方法はありますか？VBAなどわからないのですが、何か便利な方法あれば教えてください。
VBA IE操作について 下記プログラムでボタンを押しています。 ボタンが存在しない場合エラーになってしまうのですが、どのようなIF文にすればよいのでしょうか。 ご教示お願い致します。.Document.all.tags("input").Item(5).Click 下記の場合、.Documentの部分で参照が不正または不完全です。とエラーとなっています・・・。 If .Document.all.tags("input").Item(5) > 0 Then
下記のVBAの処理を教えて下さい。mシートA3列から数字が入力されているところまでをkシートB6列から数字が入力されているところまでを探し一致すれば、mシートの該当の行のE.F.G.H.I.K.Lをコピーし Kシートの該当行のH.Y.J.R.S.T.Uに貼り付ける。 mシートの数字Ａ列の数字がKシートのB列に一致せず、かつ、mシートの同業のE列のセルを参照し、文字が入っていれば同セルに黄色でマーキングする。 E列に文字が入っていなければマーキング しない。 こんな条件でVBAを書く事は可能でしょうか？
ﾏｸﾛ初心者で以下の構文を作成したいのですが、どうしたらよいか教えてください。〇行から〇行までを非表示にするのは、Rows("〇：〇").Hidden=Trueは分かるのですが 〇行から「A1ｾﾙの値」行までを非表示にするにはどのような構文になるのでしょうか？
【エクセル】UserForm上での直接検索設定をしたい 現在のコードだと「検索」コマンドボタンを押すとinputboxが表示されそこに番号を入力して検索 ⇒UserForm上に表示となりますが、 テキストボックスTextNumberに番号を入力して「検索ボタン」を押すと検索・表示される形に変更したいのですが コードをどのように修正するとよいでしょうか？ よろしくお願いします。 Private Sub CommandButton24_Click() Dim SerchKey As String Dim SerchArea As Range '検索語入力 SearchKey = Application.InputBox( _ Prompt:="物件No.を入力して下さい", Type:=2) If SearchKey = "" Or SearchKey = "False" Then Exit Sub End If '検索範囲 Set SearchArea = Sheets("顧客基本情報").Range("A:A") '検索処理(引数：LookAt に xlWhole で完全一致 Set FoundCell = SearchArea.Find( _ What:=SearchKey, _ SearchOrder:=xlByRows, _ LookAt:=xlWhole, _ MatchCase:=False) '物件No.が無い場合の処理 If FoundCell Is Nothing Then MsgBox "該当するデータはありません", vbCritical GoTo ExitHandler End If '見つかった場合の処理 With FoundCell Me.TextNumber.Value = .Value Me.TextName.Value = .Offset(0, 1).Value Me.TextBukken.Value = .Offset(0, 2).Value Me.TextYachin.Value = .Offset(0, 3).Value Me.TextPostNumber.Value = .Offset(0, 4).Value Me.TextAddress1.Value = .Offset(0, 5).Value Me.TextAddress2.Value = .Offset(0, 6).Value Me.TextBank.Value = .Offset(0, 7).Value Me.TextBranch.Value = .Offset(0, 8).Value Me.TextType.Value = .Offset(0, 9).Value Me.TextKouzaNumber.Value = .Offset(0, 10).Value Me.TextKanaName.Value = .Offset(0, 11).Value End With ExitHandler: Set SearchArea = Nothing Exit Sub End Sub
エクセルで、シート1のデータとシート2のデータを参照し、シート１に有り、シート２に無いデータをシート２の最後行に付け加えるマクロを考えているのですが、うまくいきません。 教えてください。シート１ あ い う シート２ あ え お この場合のマクロ実施後は シート２ あ え お い う としたいのですが・・・。 宜しくお願い致します。
【追加】VB2008 のソケット通信 最終的には、 １．クライアントからサーバへ問いかけ ２．サーバからクライアントへ回答 としたいのですが 下記のように設定したのですが接続済みの呼び出し先が一定の時間を過ぎても 正しく応答しなかったため、接続できませんでした。 または接続済みのホストが応答しなかったため、 確立された接続は失敗しました。 192.168.1.10 とエラーになります。 クライアント側及びサーバ側のどちらも 接続してもいいよみたいなコードが必要なのでしょうか？ 必要とすればどのように記載すれば宜しいでしょうか？ ご教授お願い致します。 ★クライアント側PC (IP:192.168.1.101) Public Class Form1 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click Dim client As New TcpClient() Try ' TCP/IP接続を行う client.Connect("192.168.1.10", 1001) ← ★クライアント側ではサーバのIP指定 ' ストリームを取得する Dim stream As NetworkStream = client.GetStream() : End Sub End Class ★サーバ側PC (IP:192.168.1.10) Public Class Form1 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click Dim client As New TcpClient() Try ' TCP/IP接続を行う client.Connect("192.168.1.101", 1001) ← ★サーバ側ではクライアントのIP指定 ' ストリームを取得する Dim stream As NetworkStream = client.GetStream() : End Sub End Class
VB.NET リソースファイルの書き出しリソース（wav）ファイルを書き出す、ということをしたいのですが、どうしたら良いでしょうか？ 書き出し方もSaveFileDialog等は使わず、特定の場所で書き出し、一時ファイルを使わない、シンプルな方法を希望しています。 色々調べましたが、方法がわからず質問させていただきます。 どうか詳しく教えていただけます様お願い致します。
VBAで、たとえば、Range("A1")にある文字と、同じシート名を他のブックのシート名から取得したいのですが、どのようなコードになりますか？ よろしくお願いいたします。
次のような Excel VBA のプログラム（マクロ）が組める方、力を貸して下さい！ 当方、ExcelVBAを少しかじった程度の者です。書類作成の効率化を図るために、次のような条件でハイパーリンクを目的としたマクロを組み込みたいのですが、知識が追い付かず、どうしても上手く組めません。 ・あるセルに特定の文字列（図の場合HL）を入力すると、そのあるセルに対応する行タイトル（図の場合数字）＆列タイトル（図の場合アルファベット）をもとに所定のフォルダに格納されているファイル（PDF）を紐図ける。 ・この際、紐図けられるファイルのアドレスは、≪"Cドライブ:¥Users¥アカウント¥Desktop¥書類格納フォルダ¥行タイトル名フォルダ¥列タイトル名フォルダ¥〇〇.pdf"≫となり、行タイトル列タイトルそれぞれに対応する。※PDFデータそのものは手動で所定のフォルダに格納する。 端的に言うと、文字を入力したときに縦軸横軸タイトルに対応するファイルが見つかればリンクさせるというプログラムの構築が狙いです。 なかなか思ったようなプログラムが書けず焦燥しています。VBAに自信のある方やプログラミングが大好きな方、どなたか知恵を貸していただけませんか？
EXCEL（2013）のVBAがさっぱりわかりません。明るい方ぜひ教えてください。 肉牛の管理表を作っています。データ更新用のフォームを作りたいのです。（イメージは年賀状印刷ソフトの住所録の軽い版のような感じです） sheet1には A列に 牛の個体番号 001～・・・・ B列に 牛の現在の状態 "飼育中"、"出荷済"、の２つの選択肢 C列に 牛を荷した場合その出荷日 20XX/□/△（任意の日付入力） があります sheet2にVBAのフォーム作り、 Sheet1の牛を出荷する場合、その牛の個体番号をテキストボックス１に入力し、コマンドボタンをクリックすると、その牛の現在の状態がコンボボックスに"飼育中"と表示される。 続いてその牛の現在の状態をコンボボックスのリストから選んで"出荷済"にする 続いてテキストボックス２に出荷年月日を入力する 最後にコマンドボタンをクリックすることでsheet1にこの変更作業が反映される。 このようにするには、どのようにコードを記述等をすればよいでしょうか？？？ 私、相当あほなので、サルに教える感じでなのとぞよろしくお願いします。
Access2013（32bit版）のレポートにおいて、 レコードソースがA、 このレコードソース中のデータが a 01 b 02 なのに、出力物が a 01 a 02となってしまいます。 動作環境はWindows7（32bit版）です。 PDFで出力したときは a 01 b 02 で出てきたのに、XPSやプリンター出力したとき 上記のような事象になりました。 なにが悪いのでしょうか。
マクロについて教えて下さい。Aシート A列：東京、大阪、福岡、福岡 B列：１、２、３、４ Bシート A列：東京、大阪、福岡 各シートのA列が一致した場合、BシートのB列にAシートのB列を転記。 但し、AシートのA列が重複(例：福岡)している場合は、C列に転記。 転記後、 Bシート A列：東京、大阪、福岡 B列：B列：１、２、３ C列：B列：空白、空白、４ 皆様のお力をお貸し下さい。
ExcelのVBA（繰り返し）について質問です。 A列に2000行入力されているとして、B列に001~999まで採番したらまた001から採番するという繰り返し文にするには どのようにすればよいでしょうか。単純に001から999までの1回パターンはわかるのですが、2回目以降にどういう式を組めばいいのかわからなくなってしまいました。 ＜イメージ＞ A列 B列 ああああ 001 ああああ 002 ↓ ああああ 999 ああああ 001 ああああ 002 ↓ ああああ 999 ああああ 001 ああああ 002 以上、よろしくお願いします。
エクセルのVBAに関する質問です。 外部データの取り込み(ActiveSheet.QueryTables.Add)を使ってカンマ区切りのデータを読み込むマクロを使用しています。 複数人が普通に使用できているのですが、1人だけカンマ区切りで開くときにドット(".")でも区切られています。 VBAの中身を確認しましたがOtherはFalseでした。 その個人の設定か何かだと思うのですが、他人のPCゆえになかなか弄るわけにもいかず困っています。 ちなみにIMEなど関係あるのでしょうか？ その他に何も案が浮かばず悩んでいます。
VBA初心者です。 以下コードで指定したセルに変更があった場合 Ｐ、Ｑ、Ｒ列に入力されている データを移動させたいです。6行あって繰り返し処理でまとめたのですが 1行目しか動かず、2行目以降はなにも起きません・・・。 なぜでしょうか・・・？ 原因が分からず困っています。 宜しくお願いします。 Private Sub Worksheet_Change(ByVal Target As Range) Dim N As Long For N = 12 To 17 If Intersect(Target, Sheets("伝票").Range("D" & N)) Is Nothing Then Exit Sub Else Range("F" & N) = Range("P" & N) Range("F" & N + 1) = Range("Q" & N) Range("F" & N + 2) = Range("R" & N) End If Next End Sub
エクセル2007で複数語の検索ワードで検索したい。 画像のようなシートが東京、大阪、アメリカ・・・とシート数で10シートあります。この全シート（ブック）内のワード検索を行いたいと考えています。 マクロでもVBAもいいのですが、開いているブック内を検索ワードを１個または ２個以上４個まで複数ワードで検索しヒットしたところにセルを移動したいです。 検索ワード１個の場合はマクロの検索ダイアログで可能だったのを確認したのですが、 ２個以上の複数ワードで検索をしたく思います。 例えば検索ワード「山川」「果物」のふたつのキーワードで検索すると sheet大阪 B3の山川かD3果物またはsheet大阪の3行目が選択されるようにしたい。 可能でしょうか？ もしVBAの場合はユーザーフォームを作成しテキストボックスを４つ、コマンドボタンを １つを準備することはできます。 よろしくお願いします。
毎日、作業ファイルを日付を付けて別フォルダに保存したいと考えています。 Sample.xls をSample0701.xls として、保存して元ファイルは削除したいのです。0701は、ファイルのC3のセルにあるのですが、どのようにすれば、 毎日（翌日はsample0702）、違った名前で保存できるようになるでしょうか？ "Sub Sample() FileCopy "C:\Work\Sample.xls", "C:\Work\保存分\Sample0701.xls" Kill ""C:\Work\Sample.xls" End Sub" VBAはコピペで何とか作業しているレベルです。
web上の画面をコピーして、EXCELに貼り付け、 入力フォームの値を取得する方法を教えて下さい。 デザインモードにして選択すると、コントロール1 コントロール2・・・・・となっています。この中にあるテキストを出力したいです。 コントロール1内の文字列=A1に コントロール2内の文字列=A2に ・ ・ ・ という順番でセル内に文字列を抽出できるような方法が知りたいです。 色々と調べて、以下をVBAで試しましたが、200項目のうちの10項目くらいしか 抽出出来ません。。。 ーーー Sub コントロールの値取得() i = 1 Dim Obj As OLEObject For Each Obj In ActiveSheet.OLEObjects myTarget = "Control " & i If Left(Obj.Name, Len(myTarget)) = myTarget Then Cells(i, 1) = Obj.Object.Value i = i + 1 End If Next Obj End Sub ーーーーー 非常に困ってまして。。何かよい方法があれば教えて下さい。
エクセルで、例えばセル「203号室 山本太郎」「304号室 田中花子」と入力して、そのセル自体の表示を「203山」「304田」とする方法はありますか？入力したセルの隣の隣のセルに省略した文字列を表示させるなら、LEFT関数やMID関数を使ってどうとでもなるのですが・・・・・
【HTA】プログレスバーを表示したい（他のSubプロシージャでも利用したい）【VBS】 お世話になります。 HTAにて、プログレスバーを表示したいと思っています。-------------------------今やっていること '===============--IE======================== Set objIE = CreateObject("InternetExplorer.Application") objIE.Width = 400 objIE.Height = 120 objIE.AddressBar = False objIE.MenuBar = False objIE.ToolBar = False objIE.Resizable = False objIE.Visible = True objIE.Navigate "about:blank" objIE.Left = 0 objIE.Top = 0 objIE.Document.Write "<html>" & vbcrlf objIE.Document.Write "<head>" & vbcrlf objIE.Document.Write "<title>更新進捗</title>" & vbcrlf objIE.Document.Write "</head>" & vbcrlf objIE.Document.Write "<body>" & vbcrlf objIE.Document.Write "<br>" & vbcrlf objIE.Document.Write "</body>" & vbcrlf objIE.Document.Write "</html>" & vbcrlf '================================================== objIE.Document.Body.InnerText = COUNT & "/" & MAXDATA & vbcrlf & String(COUNT, "■") & String(MAXDATA-COUNT, "□")'プログレスバー進捗率 上記のように利用してきました。 ただ、他のプロシージャでも使いたい場合 わざわざこの行数増えるのが見づらくなってきました。 １．他のプロシージャに置き換える(?)ことはできますか Function IECREATE() End Function 上記のようにやって Set IEOBJECT=IECREATE() のように可能かどうか。 2.上記のようにできる場合、IEOBJECT.Document.Body.InnerText で追記可能なのか 3.もし、ユーザーがIEを途中で消していたとしても オブジェクトを起動して作り直せる （エラー回避） 4.他に良い方法がありますか? 以上、よろしくお願いいたします。
閲覧頂きありがとうございます。ExcelVbaの事で下記コードの範囲をF列~S列,AA列~AN列をダブルクリックした時のみ有効となる様にしたいのですがお分かりになられる方いっしゃったら教えて頂けませんか。 よろしくお願いします。 Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Excel.Range, Cancel As Boolean) myF = Application.GetOpenFilename _ ("jpg bmp tif png gif,*.jpg;*.bmp;*.tif;*.png;*.gif", , "画像の選択", , False) If myF = False Then Exit Sub End If End Sub
【至急！】 OS：Windows10 64bit NCVをダウンロードして「Visual Studio 2015 の Visual C++ vc₋redist.x86.exe 」 ↑をダウンロードしようとすると、 画像の様なウィンドウが出てインストールボタンが表示されません。 解決策を、御教示ください m(__)m
Excel VBA シート間の転記について VBAを使用し、 「入力」シートに入力されている最下行のF列のデータを、「データ」シートの、アクティブセルのある行の、B列に転記（コピー）したいです。 どのような記述になるのでしょうか。 どうかご教授ください。
前回以下のようなマクロを教えて頂いたのですが、 詳細を教えて頂けないでしょうか。① ② ① ② ... あ ok え 空 ... い 空 お ok ... う ok か 空 ... ※「あ」、「う」、「お」が赤字、太文字となります。 以下のマクロです。 Sub Macro1() C = Cells(1, Columns.Count).End(xlToLeft).Column L = Range("A" & Rows.Count).End(xlUp).Row For J = 1 To C Step 2 For I = 2 To L If Cells(I, J + 1) = "ok" Then Cells(I, J).Select Selection.Font.ColorIndex = 3 Selection.Font.Bold = True End If Next Next End Sub 検証は出来たのですが、該当するセルを移動（右下の方に）したら 上記のマクロが起動しなくなってしまいました。 上記のマクロに手を加えて行いたいと思っています。 宜しくお願い致します。
Ａ１のセルに吉田と入っています。 これをカットしてＡ２のセルにペースト。 さらに「さま」を追加して、 Ａ２に吉田さま と撃ちこむマクロはありますでしょうか？当方で考えたのですが、Ａ１をアクティブにした後 ActiveCell.Cut ActiveCell.Offset(0, 1).Activate ActiveSheet.Paste ActiveCell.Value = Evaluate("activecell"" 様""") これで試してみたのですが、結果はvalueと出てしまいました。 よろしくお願いします。
VBAのコレクションについて コレクションを二次元配列のような形で構成していくことはできるのでしょうか。Dim col As Collection Set col = New Collection col(0,0) = 番号 col(1,0) = 名前 col(2,0) = 住所 col(0,1) = 1001 col(1,1) = 鈴木 col(2,1) = 東京 col(0,2) = 1002 col(1,2) = 山田 col(2,2) = 大阪 col(0,3) = 1003 col(1,3) = 佐藤 col(2,3) = 愛知 ↑こんな風に、型の違う多次元配列のように使いたいのですが、この形で要素を追加するコードの書き方はありますか。 もしくは、型の違う要素を同じ配列に入れるような手法はないものでしょうか。 セルやコントロールのリストから、コレクションへ一括で取り込むやり方は色々見かけるのですが、要素を個別で取り込む手法はなかなか見当たりません。 まだまだ勉強中なのですが、最終的にはHTMLの以下のような型の違う要素を、大量に配列かコレクションに取り込み、エクセルのシートに貼り付け一括ではりつけたいのです。 <table> <tr><td>1001</td> td>鈴木</td> <td>東京</td></tr> <tr><td>1002</td> td>山田</td> <td>大阪</td></tr> <tr><td>1003</td> td>佐藤</td> <td>愛知</td></tr> </table> ↑<th>の要素は除いてます。 とりあえず、<td>の要素を<tr>の単位でまとめてコレクションか配列に入れられないか模索しています。 いろいろやり方はあるのでしょうが、どなたか良い知恵をお貸し下さい。
Excel VBAについて以前質問した者です。 前回は素晴らしいコードをご教示いただいたのですが、更に改良を加えようとして行き詰っています。【前回】 ・[システム更新データ]シートのデータを[期限管理]シートに反映したい ・両シートの特定の項目に対して、一致すれば更新、異なれば新規で[期限管理]に追加 ・両シートの項目は並び順が一定ではない 前回は、最初にArray関数で項目名を配列に格納していただきましたが、実際の運用ではこちらの項目が頻繁に増えるため、新たに[項目]シートを増やして必要な項目名のみを記載し、そこから項目名を取得する形にしたいのです。 【希望】 特定の項目をVBA直接入力ではなく[項目]シートのセルから取得したい 初心者の私が付け焼刃で下記のようにコードを書いてみても、「インデックスが有効範囲にありません」とエラーになります。 誠に恐縮ですが、どうかよろしくご教示のほどお願い申し上げます。 Option Explicit Sub Sample() Dim colNames As Variant, colName As Variant Dim LastCol As Long Dim myRange As Variant Dim sh1 As Worksheet, sh2 As Worksheet, sh3 As Worksheet Dim i As Variant, c1 As Long, c2 As Long Dim colList1 As Object, colList2 As Object Dim updList As Object, newList As Object Dim r1 As Long, r2 As Long, exists As Boolean Dim kys() As Variant, ky As Variant '対象のシートを決定する Set sh1 = Worksheets("システム更新データ") Set sh2 = Worksheets("期限管理") Set sh3 = Worksheets("項目") ''項目シートの列にある項目を取得 With sh3 '最終列番号の取得 LastCol = .Cells(1, Columns.Count).End(xlToLeft).Column '項目の抽出 Dim ii For ii = 1 To LastCol - 1 myRange = myRange & """" & .Cells(1, ii).Value & """" & "," Next ii 'Array関数に入れるための書式 myRange = myRange & """" & .Cells(1, LastCol).Value & """" End With colNames = Array(myRange) '期限管理シートの管理番号・タイプ・受注日の列番号を取得する Set colList1 = CreateObject("Scripting.Dictionary") Set colList2 = CreateObject("Scripting.Dictionary") For Each colName In colNames c1 = 0 c2 = 0 On Error Resume Next c1 = WorksheetFunction.Match(colName, sh1.Rows(1), 0) c2 = WorksheetFunction.Match(colName, sh2.Rows(1), 0) On Error GoTo 0 colList1.Add colName, num2xlcol(c1) colList2.Add colName, num2xlcol(c2) Next '更新の場合にコピーする列の対応リストを作る Set updList = CreateObject("Scripting.Dictionary") For Each i In Array(4, 5, 6) 'MG確認日, 発注日", CL報告日 updList.Add colList1(colNames(i)), colList2(colNames(i)) Next '新規の場合にコピーする列の対応リストを作る Set newList = CreateObject("Scripting.Dictionary") For i = LBound(colNames) To UBound(colNames) newList.Add colList1(colNames(i)), colList2(colNames(i)) Next 'システム更新データシートの２行目から最終行を対象とする For r1 = 2 To sh1.Range("A" & sh1.Rows.Count).End(xlUp).Row exists = False For r2 = 2 To sh2.Range("A" & sh2.Rows.Count).End(xlUp).Row '期限管理シートから管理番号・タイプ・受注日が一致する行を検索する If sh1.Range(colList1(colNames(1)) & r1).Value = sh2.Range(colList2(colNames(1)) & r2).Value And _ sh1.Range(colList1(colNames(2)) & r1).Value = sh2.Range(colList2(colNames(2)) & r2).Value And _ sh1.Range(colList1(colNames(3)) & r1).Value = sh2.Range(colList2(colNames(3)) & r2).Value Then '一致する行が見つかったらMG確認日・発注日・CL報告日を期限管理シートにコピーする kys = updList.Keys For Each ky In kys sh1.Range(ky & r1).Copy sh2.Range(updList(ky) & r2) Next exists = True Exit For End If Next r2 If Not exists Then '一致する行が見つからなかったら期限管理シートの最下行の下にIDからCL報告日までをコピーする kys = newList.Keys For Each ky In kys sh1.Range(ky & r1).Copy sh2.Range(newList(ky) & r2) Next End If Next r1 End Sub （続きあり）
VB2008 のソケット通信について 下記クライアント側及びサーバ側のソースがあります。クライアント側(IP:192.168.1.101、ポート：1001) サーバ側(IP:192.168.1.10、ポート：1001) をそれぞれ接続したい設定としますと client.Connect("localhost", 80) をどのように記載すればいいでしょうか？ ★クライアント側 Public Class Form1 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click Dim client As New TcpClient() Try ' TCP/IP接続を行う client.Connect("localhost", 80) ' ストリームを取得する Dim stream As NetworkStream = client.GetStream() Dim buffer() As Byte = System.Text.Encoding.ASCII.GetBytes( "GET /start.htm HTTP/1.0" + ControlChars.CrLf + ControlChars.CrLf) stream.Write(buffer, 0, buffer.Length) ' 正常に送信できた場合 TextBox1.Text = "正常に送信できました" client.Close() Catch ex As Exception ' 接続できなかった場合 TextBox1.Text = ex.Message End Try End Sub End Class ★サーバ側 Public Class Form1 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click Dim client As New TcpClient() Try ' TCP/IP接続を行う client.Connect("localhost", 80) ' ストリームを取得する Dim stream As NetworkStream = client.GetStream() Dim buffer() As Byte = System.Text.Encoding.ASCII.GetBytes( "GET /start.htm HTTP/1.0" + ControlChars.CrLf + ControlChars.CrLf) stream.Write(buffer, 0, buffer.Length) Dim data(1000) As Byte stream.Read(data, 0, data.Length) ' 正常に受信できた場合 TextBox1.Text = System.Text.Encoding.ASCII.GetString(data) client.Close() Catch ex As Exception ' 接続できなかった場合 TextBox1.Text = ex.Message End Try End Sub End Class
SendMessageでMicrosoft Officeをスクロール SendMessageでwordなどのMicrosoft Officeをスクロールさせることはできますか？ウィンドウハンドル取得してやってはいるのですがどうもうまくいきません。 分かる方お願いします。
Microsoft ビジュアルベーシックの使い方で困っています。 c++を利用しようとしたのですが前回までは#includeと打てば青色になっていたのに黒いままになってしまいます。 また、他の関数もどうように黒いままですし改行すると自動でインデント字下げしてくれません。 解決策を教えてください。
エクセルのマクロで特定のセルを参照したいのですが、方法が分かりません。 方法を教えてください。 同じブックの中にシートが２つあります。 1つ目が、参照元。 2つ目が、参照先。になります。 この参照元のA14に入力されている内容を、参照先のB5へ常に反映させたいです。 関数を使用して、同じ事が出来るのは知っておりますが、参照先のB5の情報を編集する場合があり、 関数だと具合が良くない為、マクロでの設定を行いたいです。 よろしくお願いいたします。
VBAについて If Range(～) >= "2015/07/01" Then の年月日部分をセルの値からとってきたいのですがうまくいきません。 なんと入力すればよいのでしょうか。例えばA2に2015/07/01と入力した場合は、 If Range(～) >= "Range("A2")" Then ではないのでしょうか。
同じネットワーク上のPCからファイルを抜き出し集め、修正して再度元に戻す お疲れ様です。同じネットワーク上のPCからiniファイルを集めて一覧表示し 修正して元の場所に戻す…ということをしたいと思っています。 この場合、どのような手法が良いのでしょうか。 ＜気になること＞ ・WindowsXP,Windows7 そのうちWindows10もできる。 ・上記のようにバージョンが違うため、フォルダ構成が違う ・ファイルがあるとは限らない（無い場合もある） ・そのファイルが修正中（使用中）の可能性もある ・iniファイルキーの一部分だけを確認・編集する ＜以前＞ HTA(VBS)で直接ファイルを1行ずつ読み取り、Replaceで書き換えていました。 ＜今後＞ 上記を全て網羅できるようなものを作りたい。 自動的に修正して、確認画面を出すように変更したい。 １つのPC(自PC）に同名ファイルをたくさん集める必要がある （たぶん、IPごとにフォルダを作成してそこにファイルを突っ込むとかになりそう） HTA(VBS)で作っていたものをそのまま利用したほうが良いでしょうか。 それとも言語を変えたほうが良いでしょうか。 安定動作、不具合無しが理想です。 アドバイスお願いします。
あるサイトからファイルをダウンロードすると、下記が表示されます。 「実行時エラー'91': オブジェクト変数またはWithブロック変数が設定されていません。」 マクロ実行時のエラーでしょうか？ officeのサイトを見てもいまいちわかりません。 https://msdn.microsoft.com/ja-jp/library/office/gg264837(v=office.1... このファイルを開いてエラー無く利用するにはどうやればいいでしょうか？
マクロを教えて下さい。 一行目に全く同じ項目のシート（Sheet1)が数十枚あります。 一枚に入力されている情報は10000行程度。この複数枚のシートをすべて一枚のシートにまとめるマクロを教えて下さい。 まとめたときのシートの順番は問いません。 よろしくお願いします。
VBAでhttp通信をおこなって、HTMLを取得したいと思っています。 ホームページを参考に、下記のコードを実行したところ、一部のHTMLしか取得できませんでした。欲しかったのは全てのHTMLのコードだったのですが、どのようにすればHTMLのコードを取得する事ができるでしょうか？ Dim http As Object Set http = CreateObject("MSXML2.XMLHTTP") http.Open "GET", "http://www.yahoo.co.jp/", False http.Send ' ダウンロード待ち Do While http.readyState <> 4 Loop ' 結果出力 Debug.Print http.responseText Set http = Nothing InternetExplorerオブジェクトを作って、ブラウザをコントロールしてHTMLを取得する事ができるのはわかるのですが、XMLHttpRequest を使って全てのHTMLを取得する事はできるのでしょうか？ よろしくお願い致します。
C#で、指定の秒数だけ処理を繰り返したい C#でn秒間、ある処理を繰り返し実行したいです。 なんらかの処理の後、1秒間Sleepして、n秒になるまで処理を繰り返す動作を求めています。以下のコードでとりあえずは意図した動作にはなったのですが、 もう少しC#らしく書く方法がないか気になりますAsync/Awaitなどを使った非同期処理に出来るのでは？と思うのですが、うまい処理が思いつきません。 private static void Repeat(int second) { var sw = Stopwatch.StartNew(); while (sw.ElapsedTicks / Stopwatch.Frequency < second) { なんらかの処理(); System.Threading.Thread.Sleep( 1000); } } また、この処理の終了を待って、画面側で処理をしたいので、 なんらかの処理が重くなったり、Sleep時間を少し長くすると、画面がフリーズしたようになります。 そうならないようにしたいのです。 アドバイスをよろしくお願いします。
エクセルの一定の列のセルに入力した数字が隣のセルに反映させる様にしたいです。 たとえば、「10」と入力すると隣のセルに「10」、 さらに「5」と入力すると「15」、「3」→「18」となる様に。反復計算では複数の入力されている数字が一気に反映されますが、 数字入力→ Enter→ 加算数字 というように入力した数字のみがEnterキーを押す事で反映されるという様な。 マクロ使用で可能かと思うのですが、うまくいきません。 どうぞよろしくお願い致します<m(__)m>
下記マクロについて質問があります。再計算が終了したらシートを印刷するマクロを作っています。再計算が正しく終わっているとDo while 以降の条件式が満たされるため下記のような書き方にしております。 質問は以下です。 ①条件式が満たされるまで再計算するようにしているのですが、ファイルが重いためかいつまでたっても再計算がなされず（ただし、エクセルウィンドウの右下に”再計算xx%”と断続的に出ています）、loopの先にいきません。マクロからエスケイプすると再計算が始まります。これはファイルが重いことによるものなのでしょうか？また、その場合、マクロを一回停止し、条件式が満たされればマクロが再開されるという書き方は可能でしょうか。 ②Application.Calculate はブック全体に効果があるという認識はただしいでしょうか？ さ Sub OutPut() Application.Calculate Do While Workbooks("xxxxx.xlsm").Sheets("xxxx").Range("xx").Text = "#VALUE!" And Workbooks("aaaaa.xlsm").Sheets("aaaa").Range("aa").Text <> Workbooks("xxxxx.xlsm").Sheets("xxxx").Range("yy").Text Application.Calculate Loop Sheets(”bb”).printout End Sub
BASIC言語についてご教授願います 授業の課題でBASICを用いて 数を「何回か」入力し、その数の合計を求めるプログラムを作りなさい *但し、０が入力されたら終了となるという問題がでたのですが「何回か」と０が入力されたら終了 というところがわかりません。 ifやwhileを使ってみたのですが根本的に考え方が間違っていると思うので どうすればよいのか教えてください
VB.NETでイメージのJpegセーブを行う場合、 Encoder.Qualityで100（Long）を指定することで Jpeg量子化係数オール1のファイルができますが、調べて見るとサブサンプリングは4：2：0で Cb・Crは水平・垂直共に間引かれています。 何らかのEncoderParameter指定で サブサンプリング4：4：4（間引き無し）のJpegセーブは できませんか？ （VisualStudioExpress2013 / Win7環境です）
テーブル内の文字列“山田太郎”を”山○太○”に変換したい。その2 kiku30246さん お返事が遅くなり申し訳ありません。ご指示の通り、クエリで実行してみたのですが、 添付画像の通り、式に未定義関数があります、 とのエラーメッセージが出てしまいました。 申し訳ありませんが対応策をご教授頂けましたら幸いです。 どうぞよろしくお願いいたします。 pm_edr2xfgrさん ご丁寧にご教授下しまして誠にありがとうございます。 ご指示の方法で大分できました!! 大分といいますのは、 住所録などもある関係で、 氏名の5文字くらいまででなく、 できれば文字列数12文字くらいまで 対応できる構文を作製頂けないでしょうか。 作製頂いた構文を利用して自力で以下のものを 作製してみましたが、添付画像のようにうまくいきませんでした。 SELECT 患者マスター.氏名, IIf(Len([フリガナ])=1,"#",Mid([フリガナ],1,1) & "#" & IIf(Len([フリガナ])>2,Mid([フリガナ],3,1) & IIf(Len([フリガナ])>3,"#" & Mid([フリガナ],5,Len([フリガナ]) ) & IIf(Len([フリガナ])>4,"#" & Mid([フリガナ],7,Len([フリガナ]) ),""), ""), "")) AS t FROM 患者マスター; 申し訳ありませんがどうぞよろしくお願い致します。
【Excel VBA】コードを教えて下さい 仕事で製品の入出庫数とその使用期限の履歴をExcel管理したいと思っていますがコードがまだ理解不足のため教えて下さい。以下のような基本動作を考えております。 ■入庫＆現在庫 ①ユーザーフォームのコマンドボタン1を押すとフォームで入力したデータ(品名:ｺﾝﾎﾞﾎﾞｯｸｽ・期限日付：ﾃｷｽﾄﾎﾞｯｸｽ)をフォームで指定した数の分だけ（1～多くて300～500とか）のレコードでSheet1（入庫・現在庫ｼｰﾄ）に一気に登録。 ■出庫履歴 ②コマンドボタン2を押すと、入力した項目に該当するデータ（入庫と同じ）を、Sheet1に登録されたレコードから指定した数の分だけ削除して（VbOKCancelから)Sheet2（出庫履歴）のデータベースに削除した数の分だけレコードを登録。 ※品目と期限のデータチェックしてからの削除したいとおもっています。（該当データがなければメッセージを表示） ※また、各製品登録されているレコード以上の数が削除されないようにしたいです。 ※Sheet1の削除されたデータがあった行は上方向に詰めていって歯抜けにならないようにしたいです。 追記1：レコードが製品1ヶというふうに考えています。 追記2：できれば、それぞれのボタンを押すと1押しにつき登録したデータに簡単な追番をつけれれば…と思います（重複データだらけになるため） 何卒、ご教授ください。
Excel VBAについて チェックﾎﾞｯｸｽにて ☑りんご □バナナ ☑メロン のとき セルA1に『りんご,メロン』と表示させたいときにはそれぞれの場合によって定義しなければいけないのでしょうか。
VBAについてボタンをクリックすると、各シートに情報が入力されるようにしたいのですが、以下の文面でご理解いただける方で、知恵をお貸しくださる方、是非VBAのコードを教えていただけないでしょうか。 Sheet1のB4:B73 には縦にそれぞれ1-70までの数字が入っており、 D列からI列で一つ(仮にグループ①とする)、 J列からO列で一つ(仮にグループ②とする)、 P列からU列で一つ(仮にグループ③とする)として情報が入力されて行きます。 そのうち、 G列とH列、M列とN列、S列とT列に日付が入っており、 I列、O列、U列には氏名が入っています。 そして他のシートには、1-5 , 6-10 , 11-15 ,,,,,,65-70 という名前のシートがあります。 その各シートのH3, W3, AL3, BA3, BP3には、それぞれ 例えばsheet1-5 には1,2,3,4,5 sheet6-10には6,7,8,9,10という具合に入力されています。 そして、sheet名 1-5ですと、 1(D:R), 2(S:AG), 3(AH:AV), 4(AW:BK), 5(BL:BZ) がそれぞれ縦にグループとなっており、 1だとD5が氏名、D6が日付、L6も日付となっていて、その下にずっと入力されて行くようにしたいと思っています。 Sheet1のD列からI列、J列からO列、P列からU列の情報を、各シートに保存したいのですが、動作としては以下の通りです。 ① B4の1→グループ①、グループ②、グループ③ B5の2→グループ①、グループ② B6の3→グループ①、 が入力されているとする。 ② ボタンをクリックする ③ 結果 B4の1→グループ③ B5の2→グループ② B6の3→グループ① となり、一番右のグループが一番左にずれる。 グループ①しかない場合は現状維持 その際、 B4の1のグループ①の情報はsheet1-5のD5に氏名、D6にG列の日付、L6にH列の日付が入力され、グループ②の情報はD7に氏名、D8にM列の日付、L8にN列の日付が入力される。という具合に、B列の1-70までの通番の情報が各シートに自動的に入力される。 このような動作を実現したいと思っています。 実現不可能でしたら、その事も教えていただければと思います。 是非、皆さまのお力をお貸しください。 よろしくお願いいたします。
Access2010を利用してgoogleで地図表示をさせています。ＯｓがWindowsXpからWindows7(６４ビット）に変更になり地図表示ができなくなりました。内容としては、 Private Sub ルート表示_Click() ShowRoute ([自宅住所1]) End Sub Private Sub 地図表示_Click() ShowMap ([自宅住所1]) End Sub Private Function EncodeURL(ByVal sWord As String) As String With CreateObject("ScriptControl") .Language = "JScript" EncodeURL = .CodeObject.encodeURIComponent(sWord) End With End Function 'MAP表示関数 Public Function ShowMap(Address) If Address <> "" Then FollowHyperlink "http://maps.google.co.jp/maps?f=q&hl=ja&q=" & EncodeURL(Address) End If End Function 'ルート表示関数 Public Function ShowRoute(Address) Dim MyAddress As String If Address <> "" Then MyAddress = EncodeURL(DLookup("住所", "自社情報")) FollowHyperlink "http://maps.google.co.jp/maps?hl=ja&dirflg=d&saddr=" _ & MyAddress & "&daddr=" & EncodeURL(Address) End If End Function クリックすると 実行時エラー429 アクティブコンポーネントはオブジェクトを作成できません。 と表示されるようになりこれ以降前へ進めません。 どなたかご教授願います。
エクセルについて急ぎお願いしますこの論理演算(?)の式はどのように表せば良いのですか？(if関数を使うのは分かるのですが、作り方が分かりません) A:点数>=80 B:80>点数>=70 C:70>点数>=60 D:60>点数 一つのセル内での式の作り方について、詳しい方教えてくださいm(__)m
Excel VBAの質問なんですが、 for〜nextステートメントを使って次の計算をしなさいという問題でうまく計算結果がでません 。 わかる方回答お願いします。所得税＝課税対象額 ×税率−控除額 課税対象額 1,000〜3,299,000 税率10% 控除額0 3,300,000〜8,999,000 税率20% 控除額 330,000 9,000,000〜17,999,000 税率30% 控除額1,230,000 18,000,000以上 税率37% 控除額2,490,000 A B C 1氏名 課税対象額 税額 2佐伯浩一 8,953,000 1,460,600 3長島秀樹 4佐藤純一 というのが与えられています。 Sub ' Dim Kazei As String, Zei As String For n = 2 To 5 Kazei = Range("B" & n).Value Select Case Kazei Case 1000 To 3299000 Zei = Kazei * 0.1 Case 3300000 To 8999000 Zei = Kazei * 0.2 - 330000 Case 9000000 To 17999000 Zei = Kazei * 0.3 - 1230000 Case elese Zei = Kazei * 0.37 - 2490000 End Select Range("C" & n).Value = Zei Next End Sub
EXCEL VBAでdo~loopとexit doを使って計算しなさい。という問題があり、 一応やってみましたが動きません…。 わかる方回答お願いします。ケーキ名 単価 数量 金額 ショートケーキ 450 15 アップルパイ 400 3 マロングラッセ 420 25 チーズケーキ 320 8 モンブラン 410 18 ティラミス 370 5 Dim tanka As String, suryou As String, kingaku As String Range("A1").Select Do tanka = ActiveCell.Offset(0, 1).Value suryou = ActiveCell.Offset(0, 2).Value kingaku = (tanka * suryou) * 1.05 ActiveCell.Offset(0, 3).Value = kingaku ActiveCell.Offset(0, 1).Activate If ActiveCell.Value = "" Then Exit Do End If Loop End Sub
vbsの構文教えて下さい。こんにちは、VBスクリプトを初めて作っていますが、 ネット調べても判らないため、下記1, 2を行うにはどのような構文を作ればよいでしょうか。 ※3,に関しては 「Set objMail =CreateObject("CDO.Message")」で添付ファイル付けてメール送信はできました。 1, システム(PC)から今日の日付を「YYYYMMDD」で読み込む。 2, C:\TEST\ に格納されているファイルから 今日の日付が付いたファイルを探す。 ※ファイル名形式・・・「***_20160701.xlsx」 3, 1,〜2,で合致しているファイルを添付ファイルとしてメール送信する。 合致するファイルが無ければメール送信しないで終了。 宜しくお願い致します。
ユーザーフォーム内のテキストボックスの書式設定について。 エクセルマクロ初心者です。userform1内のtextbox1に"あああ"の文字が含まれている場合、textbox1の背景を赤色に textbox1に書かれた文字列のバイト数が500以上の場合、背景を青色に 両方の条件が重複する場合は赤色にしたいと考えております。 TextBox1_Change() にマクロの記述を行いたいと思っているのですが、どのような記述になるかご教授いただけますでしょうか。 何卒よろしくお願い申し上げます。
BASIC言語について質問です BASIC言語を用いて右図のような図を作りたいのですが 自分でやってみた結果（左図)無限ループになってしまいます。どうすれば右図のような結果になるでしょうか、教えてください
BASIC言語についての質問です。学校の授業でBASIC言語を用いて年号クイズを5問作り 正解ならば正解を、不正解なら答えを表示し 最後に正解数とそれに応じた点数を表示せよ という課題なのですがとりあえず1問だけ作ってみたところ 正解しても正解数が加算されず点数も増えません どこか間違っているところがあれば教えてください。。。
エクセル2013のマクロについて VBA仕事で業務システムから書き出したCSV（ファイル名その日の日付）を、エクセル2013で開き、マクロを使用し必要な情報や並びにソートする等をしている業務があります。 そこでソートの部分だけマクロでエラーが出てしまい、そこだけ手動でデータの並び替えをしています。 原因は使用するファイル名（日付）が毎日変わるからです。 ちなみにマクロはエクセルにパターンを記録させる方法で組んでいます。 例えば本日マクロを記録して翌日から利用するとファイル名相違でエラーとなります。 記述例は下記となります。 ---ここから--- Cells.Select ActiveWorkbook.Worksheets("07052016").Sort.SortFields.Clear ActiveWorkbook.Worksheets("07052016").Sort.SortFields.Add Key:= _ Range("C1:C15"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _ xlSortNormal With ActiveWorkbook.Worksheets("07052016").Sort .SetRange Range("A1:T15") .Header = xlGuess .MatchCase = False .Orientation = xlTopToBottom .SortMethod = xlPinYin .Apply End With ---ここまで--- 上記の07052016の場所を、現在表記のワークシート名に変更する記述はありますでしょうか？ ワークシート「07052016」に対する命令ではなく現在表記のワークシート名という意味です。 別の方法でも構いませんのでご存じな方、何卒よろしくお願い致します。
Visual Studio(VB)についての質問です。「ピクチャフォルダに『test』という名前の画像があるとき、ボタンを押すとpicturebox1にそれが表示される」というプログラムを作りたいのですが、うまくいかず困っています。 以下は自分で組んでみたプログラムです。 Private sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click If Not FromFile(System.IO.Path.Combine(System.Environment.GetFolderPath(Environment.SpecialFolder.MyPictures), "test.jpeg") Is Nothing then PictureBox1.Image=System.Drawing.Image FromFile(System.IO.Path.Combine(System.Environment.GetFolderPath(Environment.SpecialFolder.MyPictures), "test.jpeg") End If また、できれば、『test』という画像が形式を問わず(test.png、test.gifなど)表示される方法も教えていただければ幸いです。 添削をよろしくお願いいたします。
ActiveCellが変更されたイベントを検知するには？ ワークシート上で複数のセルを選択した状態でTabキーを押すと、Selectionは変わらずにActiveCellだけが変わりますが、この『ActiveCellが変わった』というイベントを検知することは可能なのでしょうか？
ExcelVBAの質問です。 TextBox1に検索ワード入力してボタンをクリックするとシート内で検索させるようなコードを書いているのですがこれにAnd検索機能をつけることはできますか。
エクセル(2007を使用しております。)のマクロ、もしくは関数の件で教えて頂きたい事が有ります。教えて頂きたい事が2つありますが、まだもう1つの方の考えが纏っていないので、纏り次第質問をさせて頂きます。 現在１つのエクセルブックの中に、3つのシートが有ります。 シートA シートB シートC このシートAのA10の内容(画像名と同じ）によって、 シートBのA１：F2(セルを結合させております。)までに配置した画像を自動で変わるようにしたいです。 シートBのA１：F2に配置した画像は、シートCのA2、A3、A4に１つずつ配置した画像を、内容によって切り替え、引き出したいです。 シートCのA2の画像は、「英語クラス」という名称。 同じくA3の画像は、「ドイツ語クラス」という名称。 同じくA4の画像は、「スペイン語クラス」という名称。 以上の様な状況になりますが、画像の切り替えの設定方法を教えてください。 言葉が上手く纏らず、分かり難いかと思いますが、何卒よろしくお願いいたします。
VBAの繰り返し処理について はじめまして。 先日、エクセルで自動入力できる当番表を作成しました。 VBAの構文は以下のとおりとなっています。Sub Macro1() ' ' Macro1 Macro ' Range("C3") = "=if(OR(B3=""土"",B3=""日""),"""",VLOOKUP(Sheet2!B33,L:M,2,FALSE))" Range("D3") = "=if(OR(B3=""土"",B3=""日""),"""",VLOOKUP(Sheet2!C33,L:M,2,FALSE))" Range("E3") = "=if(OR(B3=""土"",B3=""日""),"""",VLOOKUP(Sheet2!D33,L:M,2,FALSE))" Range("F3") = "=if(OR(B3=""土"",B3=""日""),"""",if(C3="""","""",C3))" Range("G3") = "=if(OR(B3=""土"",B3=""日""),"""",if(D3="""","""",D3))" Range("H3") = "=if(OR(B3=""土"",B3=""日""),"""",VLOOKUP(Sheet2!F33,N:O,2,FALSE))" Range("I3") = "=if(OR(B3=""土"",B3=""日""),"""",VLOOKUP(Sheet2!G33,N:O,2,FALSE))" Range("J3") = "=if(OR(B3=""土"",B3=""日""),"""",VLOOKUP(Sheet2!H33,N:O,2,FALSE))" Range("C4") = "=if(OR(B4=""土"",B4=""日""),"""",VLOOKUP(Sheet2!B34,L:M,2,FALSE))" Range("D4") = "=if(OR(B4=""土"",B4=""日""),"""",VLOOKUP(Sheet2!C34,L:M,2,FALSE))" Range("E4") = "=if(OR(B4=""土"",B4=""日""),"""",VLOOKUP(Sheet2!D34,L:M,2,FALSE))" Range("F4") = "=if(OR(B4=""土"",B4=""日""),"""",if(C4="""","""",C4))" Range("G4") = "=if(OR(B4=""土"",B4=""日""),"""",if(D4="""","""",D4))" Range("H4") = "=if(OR(B4=""土"",B4=""日""),"""",VLOOKUP(Sheet2!I33,N:O,2,FALSE))" Range("I4") = "=if(OR(B4=""土"",B4=""日""),"""",VLOOKUP(Sheet2!J33,N:O,2,FALSE))" Range("J4") = "=if(OR(B4=""土"",B4=""日""),"""",VLOOKUP(Sheet2!K33,N:O,2,FALSE))" ' End Sub この構文を、C5以降同じ法則で繰り返せる方法はないでしょうか？ C5は Range("C5") = "=if(OR(B5=""土"",B5=""日""),"""",VLOOKUP(Sheet2!B35,L:M,2,FALSE))" H5は Range("H5") = "=if(OR(B5=""土"",B5=""日""),"""",VLOOKUP(Sheet2!F34,N:O,2,FALSE))" H6は Range("H6") = "=if(OR(B6=""土"",B6=""日""),"""",VLOOKUP(Sheet2!I34,N:O,2,FALSE))" となるようにしたいです。 ご教示のほど、よろしくお願いいたします。
visual studio2015をインストールし、C++のプロジェクトを作成したいと思い、調べたんですが、 ファイル→新規作成→プロジェクト→C++→Win32 コンソール アプリケーションという手順だとわかりました。 しかし、私がインストールした無料版visual studio2015では、Win32 コンソール アプリケーションが見当たりませんでした。どのように追加できるのでしょうか？
初めて質問をさせていただきます。 現在選択したセル内にある、ハイパーリンクを開くVBAを作成いたしました。しかし、現在のVBAだと1つのサイト分しか開くことができず、VBAを使用したいサイトが複数ある為、サイト毎にVBAを作成する必要があると気づき修正をしたのですがうまくできません。 現在のVBAと作成したい条件を下記に記載いたします。 色々なサイトを渡り歩き作ったVBAコードなので、これ以上がうまくいきません・・・どうかお知恵を貸していただけませんでしょうか。 よろしくお願いいたします。 【現在】 VBAコードに入力したURLとA列に入力した値を合わせてサイトを開いている 【修正したいこと】 セルD１に入力したURL一部とA列に入力した値をあわせてURLを作成しサイトを開きたい 【現在のコード】 Sub 選択範囲をブラウザで開く() '================================================================================ ' A列(1)のデータを元に、B列(2)にハイパーリンクを挿入し、選択範囲のURLを一括で開く '================================================================================ ' 1. キーワードがA列(1)に入っていることが前提のコード ' 2. B列(2)にハイパーリンクが挿入される ' 3. 選択範囲を上から順にブラウザで開く Dim i As Long For i = Selection(1).Row To Selection(Selection.Count).Row ActiveSheet.Hyperlinks.Add(Anchor:=Cells(i, 2), _ Address:="ここにURLの一部を入れています" & Cells(i, 1), _ TextToDisplay:="Link").Follow Next End Sub
VBAについてお教えください。 A列に様々な文字列が格納されているとします。 A列の特定の文字列から始まるセルを検索し、一致したセルの隣（B列）の値を別シートのA列に順次コピーしていく、 また、A列の他の特定の文字列から始まるセルを検索し、一致したセルの隣（B列）の値を別シートのB列に順次コピーしていく、 といったようなマクロをお教えいただけますでしょうか？ お手数ですがよろしくお願いいたします。
エクセルＶＢＡの処理について ListBoxの１行に「ＡＡＡＡ ＢＢＢ ＣＣＣ」というデータが入っています このデータのＢＢＢのみ変数に取得したい場合は どうすればいいのでしょうか？よろしくお願いします
excel VBAを用いて、wordに画像を挿入する方法を教えてください。 下記のコードのように「pictures.insert」を使って画像を挿入しようとしていますがうまくいきません。Dドライブ内にある「文書２.docx」を開いて、そのファイルに画像を挿入しようとしてます。 おそらく最後の行がおかしいんでしょうが、「pictures.insert」の使い方がわかりません。 どう修正したらよろしいでしょうか？ Sub test() Dim wdApp As New Word.Application Dim wdDoc As Word.Document With wdApp .Visible = True 'wdApp.Documents.Open "D:￥文書2.docx" Set wdDoc = .Documents.Open(ThisWorkbook.Path & "￥文書2.docx") End With Application.Document.Pictures.Insert ("D:\image1.jpeg") End Sub
エクセルVBAで質問です。 ユーザーフォムでフォントサイズを▲コマンドボタンを押したら大きくなっていく ▼コマンドボタンを押したら小さくなっていく。このようなコードはどのようにすれば良いのでしょうか。 マクロの記録だと Selection.Font.Size = 12 といった指定の大きさになってしまいます。 どうかお助けください。
Private Sub CommandButton1_Click() Dim i As Long i = 10 '10が奇数か偶数かを判定しますIf Cells(10, 10).Value(i Mod 2) = 0 Then (10,12)i&"偶数" Else (10,12)i& "奇数です" End If End Sub このプログラミングのどこが間違っているかわかりません。
（続）Excel VBA - Do until~Loop 歯抜けの日付列を追加前回、横軸／抜けている日付列を追加して連続する日付にする以下マクロについて、Offsetが機能せず、Elseが抜けていたことをご教示いただきました。 で、一度は動いたと思ったのですが、日を改めて実行してみると、Exit Subの部分で［型が一致しない］エラーが出るようになってしまいました。（Option Explicitで以下の通り、文字列を定義しています） Dim date1 As Date Dim date2 As Date Dim i As Integer Loopのため、おそらくOffset（, 1）が空白の場合はExit Subを設定する必要があるのはわかるのですが、これも何がだめなのかわからない状態です。Helpお願いします。 ＜イメージ＞ 2016/7/1 2016/7/2 2016/7/5 Product1 Product2 Product3 ↓ 2016/7/1 2016/7/2 2016/7/3 2016/7/4 2016/7/5 Product1 Product2 Product3 ＜マクロ内容＞ Sub 列挿入() Do Until ActiveCell.Offset(, 1).Value = "" date1 = ActiveCell.Value date2 = ActiveCell.Offset(, 1).Value '型が一致しない------------------ If date2 = "" Then Exit Sub ’-------------------------------------- If date2 - date1 > 1 Then ActiveCell.Offset(, 1).Activate For i = 1 To date2 - date1 - 1 ActiveCell.EntireColumn.Insert ActiveCell.Value = ActiveCell.Offset(, -1) + 1 ActiveCell.Offset(, 1).Activate Next '前回教わった箇所--------------------- Else ActiveCell.Offset(, 1).Activate '-------------------------------------------- End If Loop End sub （参：http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1016116172...）
VisualBasicのプログラムコードについて 英語、国語、数学な３科目の点数を入力し、１科目でも50点未満があれば失格、３科目とも50点以上で平均点が70点以上であれば合格、そうでなければ不合格と判定する 次のフォームの設定にしたがって、プログラムを作成しなさい。３科目の点数変数としてEnglish、Japanese、mathematicsを平均点の変数としてaverageを用いなさい。 という問題を出題されたのですが全くわかりません どなたかの知恵をお借りしたくて質問させていただきました。 解答よろしくお願いします。
【HTA】テーブルの内容をボタン操作で増やしたり減らしたりしたい【VBS】 環境：WindowsXP, Windows7 32bit, Windows7 64bitテーブルを動的操作できたらな、と思っています。 JavaScriptでない理由としては、「使い慣れていないから」ということと 「他のプログラムは流用するためVBSで統一したほうが良いこと」です <span id=TableArea></span> このTableAreaの中に、テーブルを作成します。 「データ取得」ボタンを押したら、TABLEが作成されます。（ここは出来てます。） 追加<input type="textbox" name="AddData" value="" style="WIDTH: 50px; HEIGHT: 40px; font-size:40px;"></input><input type="button" value="行追加" onClick="InsertRow()" style="background-color:#ffffff;border-color:#ff6868;border-width:2px" style="WIDTH: 50px; HEIGHT: 40px"/></br> テキストボックスにデータを入力して「行追加」ボタンを押したら TABLEの最終行にデータを追加したいです。 また、右側のボタンで行削除も行いたいです。 DQ="""" TABLEAREADATA=TableArea.innerhtml TABLEAREADATA= TABLEAREADATA & "<table id=" & DQ & "TABLEDATA" & DQ & " cellpadding=" & DQ & "0" & DQ & " border=1 style=" & DQ & "font-size:20px;" & DQ & ">" TABLEAREADATA= TABLEAREADATA & "<tr><td align=" & DQ & "center" & DQ & ">No</td>" TABLEAREADATA= TABLEAREADATA & "<td align=" & DQ & "center" & DQ & ">DATA</td>" TABLEAREADATA= TABLEAREADATA & "<td align=" & DQ & "center" & DQ & ">削除</td></tr>" このようにTABLEAREADATAに全て書き込み、反映させます。 最後</table>で閉じてしまうため、行追加ができません。 そして、行削除の方法も良く分かりません。（行番号の取得は出来ます） 1. テーブル 行追加の方法 2. テーブル 行削除の方法 上記の参考サイト、参考ソース等ありましたら お願いいたしますorz
DataGridViewのｺﾝﾎﾞﾎﾞｯｸｽに値を追加したい。 Form1のDataGridView1のｺﾝﾎﾞﾎﾞｯｸｽに 値を追加したいです。追加ﾃﾞｰﾀは3つ"AAA","BBB","CCC"です。 どのようにすればいいでしょうか。
VBA初心者です。オブジェクト変数またはWithブロックが設定されていません。とエラーがでます。 ご教示下さい。 Public Sub Test8() Dim result As Long result = MsgBox("Do you have a mind to check security?", vbYesNo + vbExclamation, "caution") If result = vbYes Then MsgBox "ok" Else Dim bb As Workbook Set bb = ActiveWorkbook bb.Close End If End Sub
VB6→VB2012へのマイグレーションについて 弊社で過去に別プログラマによってVB6で作成されたソースコードがあるのですが、 今度VB2012へコンバートしてみようという事になりました。VB2008を使ったアップデートモジュールでは、あまりにもエラーが多いので、 手作業にてコンバートをする事になりました。 ところが１つのフォームに計算結果を収めるために 100以上のテキストボックスが配置されています。 VB6のテキストボックスを.NETのテキストボックスに簡単に変換できないでしょうか。 例えばVB6のfrmファイルをエディタで開き、 テキストボックスの部分を、 .NETのテキストボックス様式に置換し、 .NETのVBファイルにコピペする事で、 テキストボックスの移植など、できませんでしょうか。 出来れば有償のツール／サービスを利用したくないので、 このような経験のある方は、お教えいただければ、幸いです。
Excel VBAの質問なんですが、 for〜nextステートメントを使って次の計算をしなさいという問題でfor〜nextの使い方がよくわからないのですが… わかる方お願いします。 所得税＝課税対象額×税率−控除額 課税対象額 1,000〜3,299,000 税率10% 控除額0 3,300,000〜8,999,000 税率20% 控除額 330,000 9,000,000〜17,999,000 税率30% 控除額1,230,000 18,000,000以上 税率37% 控除額2,490,000 A B C 1氏名 課税対象額 税額 2佐伯浩一 8,953,000 1,460,600 3長島秀樹 4佐藤純一 というのが与えられています。 ここまではわかるのですが、 ここからfor〜nextを入れるというのがわかりません。 dim kazei as long,zei as long kazei = range(″b2″).value select case kazei case 1000 to 3299000 zei = kazei×0.1 case 3300000 to 8999000 zei = kazei ×0.2-330000 case 9000000 to 17999000 zei = kazei×0.3-1230000 case else zei = kazei×0.37-2490000 end select range(″c2″).value = zei
excel VBA初心者です。 計算式で算出したデータの値だけを残して共有フォルダに別名保存したいと考えています。2行目の.Copyを.Valueに変えてみたのですが、エラーとなってしまい、行き詰ってしまいました。 どなたかお知恵をお貸しください！ ----------------------------- Sub 見積り書() Worksheets("見積もり").Range("A2:T40").Copy With Workbooks.Add ActiveSheet.Paste Application.DisplayAlerts = False '同じ名前があった時上書き ActiveWorkbook.SaveAs Filename:= _ "D:\FilePath\" & Format(Now, "yyyy-mmdd-hhmmss") & ".xlsx" Application.DisplayAlerts = True .Close False '閉じる End With End Sub -----------------------------
vs2012でのdllデバッグ方法について質問です。デバッグ中に参照dllのステップ実行を行う為、参照dllのpdbファイルをコピーしてデバッグしております。 最近までvs2005を使用しており、上記方法にてステップオーバー(F10)できていたのですが、vs2012で同じことを行ってもステップオーバーせずステップアウトしてしまいます。 ちなみにステップイン(F11)はdll内の、デバッグはできており、ブレークポイントも効きます。 なにか解決できる方法ご存知の方、ご教授願います。
VB2013 プログラム初心者です ２つ質問です Ｅｘｃｅｌ2010のセルの値を指定して テキストボックス1に出力したいのですが いまいちわかりません エクセルの読み込みはStreamReaderでできましたが・・・ これだと全部の文字になってしまいます レンジなど試しましたが いまいちわかりません どうすればいいのでしょうか？ 教えてください 現在のコード --------------------------------------------------- Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click 'エクセルを読み込み Dim Reader As New IO.StreamReader("C:\kanri\aaa.csv") TextBox2.Text = Reader.ReadToEnd Reader.Close() End Sub ---------------------------------------------------- あと、デスクトップに指定フォルダを置き その中のエクセルを読み取りたいのですが ("C:\kanri\aaa.csv") これだと Ｃドライブの中にある ＣＳＶで読み取れます ("C:「？？？」\kanri\aaa.csv") デスクトップにあるフォルダを参照して コードを入力しましたが なぜか、できません ご教授ください。
エクセルについての質問です。【Sheet1】 A B C 1名前 果物 個数 2山田 みかん 2 3山田 りんご 1 4鈴木 りんご 3 5佐藤 みかん 5 6佐藤 りんご 1 7佐藤 すいか 2 8田中 すいか 6 9森田 みかん 10 【sheet2】 A B C 1名前 住所 発注日 2山田 大阪府 7月1日 3田中 三重県 7月10日 4森田 奈良県 7月5日 【Sheet3】 A B C 1名前 果物 個数 2山田 みかん 2 3山田 りんご 1 4田中 すいか 6 5森田 みかん 10 上記のように【Sheet1】と【sheet2】にそれぞれデータが入っています。 【Sheet1】と【sheet2】のA列の名前は共通の項目となります。【Sheet3】に【sheet2】のA列にいる人の【Sheet1】データのみ反映することはできますでしょうか。 方法は関数でもVBAでも結構です。 質問が分かりづらく申し訳ございませんが、 よろしくお願い致します。
asp.net .net framework 3.5 でvbを使ってwebサービスを作っています。つくっているウェブサービスはvbアプリ（デスクトップアプリケーション）から使います。ウェブサービスを誰でも使えると困ると思い、IISの基本認証にSSLを組み合わせるという方法をやろうとしました。ｖｂアプリではsoapサービスオブジェクトのcredentialプロパティでユーザー名とパスワードを設定しウェブサービスを使おうと思っていました。ユーザー名とパスワードは文字列でコードに直接書きました。 しかし、この方法では一つ問題があります。逆コンパイルするとユーザー名とパスワードがまるわかりになってしまいます。 ではどうしたらよいかというところで何もわかりません。 別のファイルにユーザー名とパスワードを保存しておき、ウェブサービスを使い際に、そのファイルから読み込み、資格情報を設定するという方法はより安全でしょうか？それとも、基本認証を使わない、まったく別の方法はあるでしょうか？ なにかご意見を頂けると幸いです。
ExcelVBAを使って「c:\abc.accdb（NewDB）」から「c:\abc.mdb（OldDB）」に自動変換できるコードを書きました。「ConvertAccessProject NewDB, OldDB, acFileFormatAccess2000」 NewDBのデータベースはパスワードがかかっていると自動変換できませんでした。 パスワードがかかっているNewDBからパスワードなしのOldDBに自動変換できる方法を探しています。 目的はテーブルの中身をコピー（上書き更新）したいです。リンクテーブル＆クエリでやりたいと思ったのですが、ファイル形式がちがっていてダメみたいなエラーメッセージが出てきてつまずいています。 もし可能でしたらその方法も教えていただけると幸いです。
エクセルのVBAについて、特定のデータを除外する記述をお教え頂きたいです。今、 ・「(i,5)のデータが空白の場合」 ・「(i,5)のデータが9:00より大きい場合」 という2つの条件が満たされたとき、ファイル名aにある「.cells(i,1)」のデータをシート名bの「.Cells(cnt, 1)」に入力するというマクロを作成しました。 以下がその記述です。 **************************************** Sub マクロ名a() Call (マクロ名b) Dim i, cnt With Worksheets("シート名a") cnt = 9 For i = 2 To 32 If .Cells(i, 5) <> "" Then If .Cells(i, 5) > TimeSerial(9, 0, 0) Then Worksheets("シート名b").Cells(cnt, 1) = .Cells(i, 1) cnt = cnt + 1 End If End If Next End With Application.Run "ファイル名a.xlsmマクロ名c" End Sub **************************************** そこに新しく、(i,2)に列を挿入し曜日を入力するマクロを追加しました。 ここからが質問となるのですが、「土日を除く」という条件を上のマクロに追加する場合、どのような記述をすればよいのでしょうか？ IF文等を使えばいいのかとも思いましたが、初心者なので～を除く場合、といったような記述の仕方がわかりません(しかも土・日の2つ)。 どうかご教授頂ければと思います。 宜しくお願い致します。
Excel VBAにてNumeric関数とReplace関数を用いて文字列を判定したい。 対象のシートからセル・図形内の全テキストを抽出するコードを作成しました。ここで、「10/11/12」など任意の数字と" / "が含まれる文字列に当たっとき、 Replace関数にて" / "を""に変換し、101112とした上に、 Numeric関数で判定を行えばIsNumericはTrueを返すと思うのですが 思うように動きません。True判定になればその文字列はスキップして 次の文字列の判定に移ると思うのですが、スキップが行われず リストに「10/11/12」等と、そのまま表示されてしまいます。 どなたか原因がわかる方がおられましたらご教授願います。 ------------------------------------------------------------------------------ Sub リスト化() Dim ws As Worksheet Dim RowCnt As Integer Dim ColCnt As Integer Dim cnt, cnt2 As Long Dim a, ab, ac As Variant Dim y As Integer Dim x As Integer Dim z As Integer Dim shp, Gshp, xTxt As Variant Dim SplitCnt As Long Dim str As String Dim ad As String z = 5 For Each ws In Worksheets With ws If .Name Like "P##" Then RowCnt = .Cells.SpecialCells(xlLastCell).Row ColCnt = .Cells.SpecialCells(xlLastCell).Column For y = 1 To RowCnt For x = 1 To ColCnt If .Cells(y, x) <> "" Then a = .Cells(y, x) ab = Trim(a) ad = ab ad = Replace(ad, "/", "") If IsNumeric(ad) = False Then ac = Split(ab, vbLf) For SplitCnt = 0 To UBound(ac) cnt = WorksheetFunction.CountIf(Sheets("翻訳作業").Range(Cells(5, 2), Cells(z, 2)), ac(SplitCnt)) If cnt = 0 Then str = ac(SplitCnt) If Find(str) = False Then Sheets("翻訳作業").Cells(z, 2) = ac(SplitCnt) z = z + 1 Else End If Else End If Next SplitCnt Else End If Else End If Next x Next y For Each Gshp In .Shapes If Gshp.Type = msoGroup Then Gshp.Ungroup Else End If Next Gshp For Each shp In .Shapes If shp.TextFrame2.HasText Then xTxt = shp.TextFrame2.TextRange.Characters.text If xTxt <> "" Then ab = Trim(xTxt) ad = ab ad = Replace(ad, "/", "") If IsNumeric(ad) = False Then ac = Split(ab, vbLf) For SplitCnt = 0 To UBound(ac) cnt = WorksheetFunction.CountIf(Sheets("翻訳作業").Range(Cells(5, 2), cells(z, 2)), ac(SplitCnt)) If cnt = 0 Then str = ac(SplitCnt) If Find(str) = False Then Sheets("翻訳作業").Cells(z, 2) = ac(SplitCnt) z = z + 1 Else End If Else End If Next SplitCnt Else End If Else End If Else End If Next shp Else End If End With Next ws End Sub
visual stdio 2005で【ホストサービスの無効化】を行いたいのですが、その項目が見当たりません。 調べてみたのですが、プロジェクトのプロパティのデバックタブにあるとの記事を見つけました。 しかし、私のvisual stdio 2005で、プロジェクトのプロパティをクリックすると、記事で紹介されているようなプロパティの[タブ]は表示されず、新しいウインドウでプロパティ画面が出てきます。 お手数をお掛けしますが、上記の状況でして、【ホストサービスの無効化】が行えないため、ウインドウの場合はどこにあるのか、もしくはタブで開く方法などがある場合は教えてください
マクロで、最新の日付を反映させたいです。 sheet1 A列：東京、福岡、福岡と各セルに入力されている。B列：2016/6/20、2016/7/20、2016/8/20 sheet2 A列：東京、福岡と各セルに入力されている。 B列：空白 sheet1のA列とsheet2のA列が一致した場合、sheet1のB列をsheet2のB列に反映 但し、sheet1のA列で重複(例：福岡)している場合、の日付が新しい日付を反映 【反映後】 sheet2 A列：東京、福岡 B列：2016/6/20、2016/8/20 皆様のお力をお貸しください。
エクセルVBAについての質問です。A10からS（行数未定）である表の Q列のセルに”行挿入”という文字列の値が入っている行の上に2行挿入するというマクロを動かしたいですが、時間がかかってしまい、高速化できないかと考えております。 Q列の値は”行挿入”もしくは空白です。 空白以外の値をとることも可能です。 高速化に関して、ご指導いただけないでしょうか。 よろしくお願いいたします。 Cells(Rows.Count, "Q").End(xlUp).Offset(1, 0).Value = "EofINSERT" Dim RowInsert As Integer Range("Q9").Select Do Until ActiveCell.Value = "EofINSERT" Select Case ActiveCell.Value Case Is = "行挿入" RowInsert = ActiveCell.row Range(Cells(RowInsert, 1), Cells(RowInsert + 1, 20)).Insert Shift:=xlDown ActiveCell.Offset(3, 0).Select Case Else ActiveCell.Offset(1, 0).Select End Select Loop ActiveCell.Value = "" Rows("9:10").Select Selection.Delete Shift:=xlUp
エクセルのListViewコントロールで「上へ移動」「下へ移動」ボタンを付けたい。そのプログラムを探しています。なかなかみつからない。。ソース教えていただけるとありがたいです＞＜
エクセルvbaで直線の図形を変数で定義したいのですが変数宣言の仕方が分かりません
表を整理するマクロについて。 マクロ初心者です。 エクセル2013使用中です。 表形式で保存されている情報を見やすく整理したいと考えております。現在Sheet1には表が記載されています。条件としては下記の通りとなっています。 ・表は品名ごとに作成されています。 ・表の左上は必ず品名の文字となっております。 ・表の数は未定で、シートの一番右下まで検索したいです。 ・表と表の上下の間は1行空いてます。 ・表と表の左右の間は1列空いてます。 ・各品名の表の高さ(行数)は未確定です。 ・各品名の表の長さ(列数)は3列で固定されております。 ・表検索の優先はまず縦方向(行方向)に検索、次に横方向に検索したいです。 ・Sheet2には1行目に見出しのみ記述されています。 ・各表の上から3×3マスは下記の構成となります 品名 ※文字列1※ 空白 色 ※文字列2※ 空白 産地 サイズ 数量 ※文字列※の箇所の内容以外はすべての表が固定でこの形です。 上記の条件で作成された表がいくつかあるSheet1が下記の画像となります。 【マクロ起動前sheet1】 http://www.fastpic.jp/images.php?file=8208391489.jpg これを1行目に見出しだけ記載されているSheet2に必要情報を抜き出して転記したいと考えております。 具体的には Sheet2のA列は、【表の品名の文字の一つ右のセルに記載されている文字列】と各行の産地とサイズをつなげた文字列 Sheet2のB列は、それに該当する数量 を記載したいと考えています。 画像の場合、まず最初の表がA2からC8で構成される表であり、この表の品名の横の文字はりんごの為 りんご+各行の産地ならびに産地をつないだ文字列となります。 Sheet2は A B 1 りんご青森S 5 2 りんご青森M 5 3 りんご青森L 5 4 りんご北海道S 5 ： ： ： となります。 この作業を全表に対して行いSheet2の転記を完了させた画像が下記となります。 【マクロ起動後sheet2】 http://www.fastpic.jp/images.php?file=1196682757.jpg マクロ起動後のsheet1は起動前と同じ状態で大丈夫です。 このような動作を行えるマクロの記述をご教授いただけますでしょうか。 説明が拙く本当に申し訳ございません。 一括処理できるマクロが便利なのですが、関数等でもこの処理を行えるまたは、一部処理ができるような方法があれば教えていただけると本当に助かります。
VBA(vesion6)について質問です。とあるサイトの画像のURLが一定の間隔になっており、それをFormat関数等を用いながら大量に取り込みたいためプログラミングを組んでいるのですが、簡単なレクチャーは受けたのですが、仕組みがいまいち理解できてないためなかなかうまくいきません。（ユーザ定義型が定義されていませんと出ます） そこで、①どのようにすれば画像を一括で取り込めるか ②全体のコードのチェック をしてほしいです。 コード Private Sub Command1_Click() Dim b() As Byte Dim tm As Date Dim pic As jpgPicture Set pic = New jpgPicture tm = "2001/10/31 18:00:00" tugi: b() = Inet1.OpenURL"①") Open "C:\Users\○○○\Documents\△△△\" + Format(tm, "yyyymmddhh") + "_□□□.png" For Binary Access Write As #10 Put #10, , b() Close #10 nexttime: tm = DateAdd("h", ①A, tm) If Format(tm, "hh") = "①B" Then GoTo nexttime: If tm > Now Then End GoTo tugi: End ①のURLはこのような感じ http://××××/1280x960/200110/2001103118.jpg で、後ろの二つが2001年10月、2001年10月31日18時ということを指しています。 この二つはyy,mmなどを用いる場合どのように表記すれば良いのでしょうか。 また、次の画像として①A＝6時間後の2001年11月1日03時のデータを取り込みたいのですが、月や年が替わる場合の表記の仕方もわかりません。こちらもどのように表記すれば良いのでしょうか。
エクセルのデータの一覧からマクロを使い 別シートに転記して印刷をしたいのですが うまくマクロが組めません 教えていただけないでしょうか？１．名簿シート A1 所属ＮＯ B1 所属 Ｃ１ 社員ＮＯ Ｄ１ 氏名 Ｅ１ 過去手当 Ｆ１ ６月手当 Ｇ１ 7月手当 Ｈ１ 合計 データは２行目から１０行目 ２．明細シート Ｂ1 所属ＮＯ Ｃ１所属 Ｂ２ 氏名 Ｂ３ 社員NO Ⅾ７ 過去手当 Ｄ８ ６月手当 Ⅾ10 ７月手当 Ｄ13 合計 Ｂ18 所属ＮＯ Ｃ18 所属 Ｂ19 氏名 Ｂ20 社員NO Ⅾ24 過去手当 Ｄ25 ６月手当 Ⅾ27 ７月手当 Ｄ31 合計 Ｂ36 所属ＮＯ Ｃ36 所属 Ｂ37 氏名 Ｂ38 社員NO Ⅾ42 過去手当 Ｄ43 ６月手当 Ⅾ45 ７月手当 Ｄ48 合計 に転記したいです アドバイスお願いいたします
VBAにて特定シート以外の全シートに罫線（下に太線）を引きたいです。 罫線を引く条件はｾﾙA25からA列で空白でないｾﾙの最終行、そこから213列までとなります。現状、下記構文で行ってますが、上手くいきません。 ※1sheetしか線を引かない お手数ですが、知恵をお貸し願います。 何卒宜しくお願い致します。 Dim wbS as workbook Set wbS=workbook("貼付先") Dim ws as worksheet For each wbS.worksheets If wbS.worksheets name <> "特定シート①” and wbS.worksheets name <> "特定シート②” Then Range("A25" & Rows.Count).End(xlUp).Resize(, 213).Select '罫線（太線）を引く Selection.Borders(xlDiagonalDown).LineStyle = xlNone Selection.Borders(xlDiagonalUp).LineStyle = xlNone With Selection.Borders(xlEdgeLeft) .LineStyle = xlContinuous .ColorIndex = 0 .TintAndShade = 0 .Weight = xlThin End With With Selection.Borders(xlEdgeTop) .LineStyle = xlContinuous .ColorIndex = 0 .TintAndShade = 0 .Weight = xlHairline End With W ith Selection.Borders(xlEdgeBottom) .LineStyle = xlContinuous .ColorIndex = 0 .TintAndShade = 0 .Weight = xlMedium End With With Selection.Borders(xlEdgeRight) .LineStyle = xlContinuous .ColorIndex = 0 .TintAndShade = 0 .Weight = xlMedium End With Selection.Borders(xlInsideHorizontal).LineStyle = xlNone End if Next
macro初心者です。 BOOKの統合に関してご質問です。 同一ホルダー内にBOOKが100個～200個あります。このデータを1個のシートに集約するmacroを作成しておりますが エラーがでてしまい上手に動かないのでどなたかご存じの方よろしくお願い申し上げます。 Sheetは3個からなっており一番左のシートのみ集約。 （真ん中と右端は無視） A列は空白 B7～R7がタイトル行 B8からデータが始まります。 データは非常に空白が多く、最終行はD列の社員番号が入力されてる列で判断します。 貼り付け先は B8より順次。 できれば値と書式を保持したまま貼り付けしたいです。 Macro1でデータを順次貼り付けするmacroを作成。 Macro2でmacro1を順次実行するmacroを作成しました。 Sub Macro1() Dim n As Variant Dim Z As Variant Dim t As Variant n = Cells(Rows.Count, "D").End(xlUp).Row 'D列の最終 Range("B1").Resize(n, 4).Select Selection.Copy ThisWorkbook.Activate t = Cells(Rows.Count, "D").End(xlUp).Row + 1 Range("B" & t).Select ActiveSheet.Paste End Sub ＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊ Sub Macro2() Dim fol As String Dim f As String Dim wb As Workbook fol = "C:\TEST" ' フォルダの指定 f = Dir(fol & "\*.xls*") 'フォルダ内の指定拡張子のファイル名取得 Do While f <> "" 'フォルダに～指定拡張子のファイルが～ある限り～ Set wb = Workbook.Open(fol & "\" & f) 'ブックを開く MsgBox wb.Worksheets(1).CRange("A1").Value '開いたブックに対する処理 Call Macro1() wb.Close f = Dir() Loop Set wb = Nothing '変数の解放 End Sub ＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊ Set wb = Workbook.Open(fol & "\" & f) 'ブックを開く の箇所で「実行時エラー’424’ オブジェクトが必要です」とのメッセージが出てしまいます。 以上です。どなたか修正方法をご教授ください。 PS.こちらはできればでいいのですが、貼り付けしたい元データのM3セルに 201604～201703までをプルダウンで選択できるようにしてあるのですが 今月は2016の6月分だけを集約し、他の月はスルーというように月ごとに 集約の月を選択できるようになると月ごとにホルダー分けする手間が省けて 便利なのですが、余裕があれば、こちらもよろしくお願い申し上げます。
ExcelのVBAで深視力検査器みたいなのを作れますか？ 父が、作りたいらしいです。
【HTA】Span内のTABLEデータの取得【VBS】 <span id=TableArea><table id=TABLEALLDATA cellpadding="0" border=1 style="font-size:20px;">" <span id=gyou1><TD>1</TD><TD></TD><TD></TD> <span id=gyou5><TD>5</TD><TD></TD><TD></TD> <span id=gyou3><TD>3</TD><TD></TD><TD></TD> <span id=gyou4><TD>4</TD><TD></TD><TD></TD> </table> </span> 以下のような形でHTAで、SPAN ID TableArea内の内容を変更しています。 MOTODATA=TableArea.innerhtml TableArea.innerhtml=MOTODATA & "<span id=gyou1><TD>1</TD><TD></TD><TD></TD>" 表の増減、変更等可能になったのですが 表の中身を取り出す方法が分からなくなりました。 TEST=Document.all.getelementById("TableArea") ALLDATA=TEST.getelementById("TABLEALLDATA") Msgbox ALLDATA.Rows(1).cells(1).innerHTML これでOKかとおもったら表示できませんでした。 どうやってTABLE内のデータを取得できますか？ 取得したいのは、1列目。 <TD>1</TD> の数値の部分です。 後々、このテーブル内のデータも編集したいと思っています。 やり方を教えて下さい。 http://matome.naver.jp/odai/2144177955961632701 上記を参考に TABLEDATA = document.getelementById("TABLEALLDATA") Msgbox TABLEDATA.Rows(0).cells(0).innerHTML とやってみましたが、それもダメでした。 以上、よろしくお願いいたします。
VBAでエクセルのリストボックスにデータを追加する方法について。 すでに値の入っているリストボックスがあります。 １ ２ ３ ４ ５ また、配列で次のようなものがあります。Arr（５）＝６，７，８ … ９９９９９９８，９９９９９９９ このときリストボックスに配列Arrを一括で貼り付けたいのですが、 Listbox1.List = Arr.Value では、すでに入っている１～５の値が上書きされ、６～９９９９９９９になってしまいます。 VBAにはAddRangeのようなメソッドはないでしょうか。 なければ、ループでAdditemする以外に、良い方法はないでしょうか。
VB2013について質問です ＶＢ2013内のデーター （テキストボックスに数値）をまとめて エクセルへ出力ボタンで エクセルへ転記させるところまでできましたが保存指定で、できません 名前を本日の日付にし Book.SaveAs(Format(Now, "yyyyMMdd")) これもできました しかし、自動で保存し ＋保存先の指定がしたいのですが ＳａｖｅＦile Dialogなど試したんですが・・ セーブされ たとえば ＶＢ2013内でデータ管理 ↓ エクセルボタンでエクセルへ転記 ↓ 同時に保存（名前は本日日付） ↓ デスクトップの￥管理フォルダ￥本日日付 にあるようにしたいんです 今は、 ライブラリのドキュメントに保存されてしまいます ご教授ください よろしくお願いいたします。
VBA .Borders(xlEdgeBottom).LineStyle について 下記左図のようにC5セルはセルの書式設定の罫線下は無い状態となっています。しかし、If (.Borders(xlEdgeBottom).LineStyle = xlNone) Then と条件設定としても罫線下は有るとして判定されてしまいます・・・。 確かに、「 ActiveCell.Borders(xlEdgeBottom).LineStyle = xlNone」を実行すると右図のように薄く既存の線が表示されています。 If (.Borders(xlEdgeBottom).LineStyle = xlNone) Thenをどのように変更すれば罫線のみを判定してC5セルは無しとして実行させることができるのでしょうか？ご教示お願い致します。 下記プログラム全体式です。EXCEL2010。 Public Sub Samp2() Dim i As Long, j As Long, k As Long, n As Long Const CBATU As String = "×" Application.ScreenUpdating = False i = 4 ' 所属コードの行 Do While (1) With Cells(i, "C") Cells(i, "C").Select If (.Borders(xlEdgeBottom).LineStyle = xlNone) Then If (.Value = "") Then Exit Do Else j = -1 k = 0 n = 0 While (n < 2) If (.Offset(k, 2).Value = CBATU) Then If (j < 0) Then j = k k = k + 1 Else .Offset(j, 1).Value = _ .Offset(k, 1).Value & " 他" .Offset(j, 3).Value = _ .Offset(j, 3).Value _ + .Offset(k, 3).Value .Offset(k).EntireRow.Delete End If Else k = k + 1 End If If (n > 0) Then n = n + 1 ElseIf (.Offset(k).Borders(xlEdgeBottom).LineStyle <> xlNone) Then n = 1 End If Wend i = i + k End If Else i = i + 1 End If End With Loop Application.ScreenUpdating = True End Sub
VB.NETのプログラミングマナーやコツ、高速化やデザインパターンなど、プログラマー向けの意識向上を書いた記事を教えてください。
VBAにて下記ﾏｸﾛを作成したのですが、 ２点、問題点があります。①貼付先の"新規"sheetが消えない ②貼付先の不要行を削除したいのですが、上手くいかない やりたい事は貼付元より特定シートを除いた可変するシートを 貼付先へコピーしたいです。 その際、貼付元の特定シート数以外をｶｳﾝﾄし、そのシート数分だけ、 貼付先の新規シートをコピーし、値の貼付を繰り返すのですが、 新規シートが余ってしまう為、余ったシートを削除する構文を考えた のですが、上手くいきません。 また、貼付先の特定シート以外の不要行を削除したいのですが、 これも上手くいきません。条件はA25～1000間で空白セルがあるなら、 削除としたいです。 現状のﾏｸﾛは以下になります。 皆様、お手数ですが、お知恵をお貸しください。 何卒宜しくお願い致します。 Sub test() '高速化(非表示OFF,自動計算OFF) Application.EnableEvents = False Application.ScreenUpdating = False Application.Calculation = xlCalculationManual Application.DisplayAlerts = False Dim i As Long, k As Long Dim wbM As Workbook, wbS As Workbook Dim shM As Worksheet, shS As Worksheet Set wbM = Workbooks("貼付元.xlsm") Set wbS = Workbooks("貼付先.xlsm") Set shM = wbM.Worksheets("特定シート") Set shS = wbS.Worksheets("特定シート") '貼付先の特定シート以外、削除 Dim ws As Worksheet For Each ws In wbS.Worksheets If ws.Name <> "特定シート" And ws.Name <> "新規" Then ws.Delete End If Next '貼付元の特定シート（"特定シート①","特定シート②","特定シート③"）以外をカウント Dim j As Integer j = wbM.Worksheets.Count - 3 'シート名が"Sheet*"以外なら貼付先に貼付元のシート数分だけシートをコピー If wbM.Sheets(j).Name <> "Sheet*" Then Do Until wbS.Worksheets.Count = j wbS.Sheets("新規").Copy After:=wbS.Worksheets("特定シート") Loop End If '貼付元の特定シートより3つ目のシートで"必要"以外なら貼付元→先へ値の貼付 For i = shM.Index + 2 To wbM.Sheets.Count If wbM.Sheets(i).Range("O6").Value = "必要" Then wbM.Sheets(i).Cells.Copy wbS.Sheets(shS.Index + 1 + k).Range("A1").PasteSpecial Paste:=xlPasteValues wbS.Sheets(shS.Index + 1 + k).Name = wbM.Sheets(i).Name k = k + 1 End If Next i ----------------ここから先が問題シート----------------------------------------- '新規シートをコピーした際、余った新規*シートを削除 Dim h As Worksheet For Each h In wbS.Worksheets If wbS.Worksheets(h).Name Like "新規" & "*(*" Then wbS.Worksheets(h).Delete End If Next h '貼付先のA25～1000の間で不要行があれば、削除 Dim wss As Worksheet For Each wss In wbS.Worksheets If wss.Name <> "特定シート" And wss.Name <> "新規" Then Range("A25:A" & Range("A1000").End(xlUp).Row).SpecialCells(xlCellTypeBlanks).EntireRow.Delete End If Next wss ------------------------------------------------------------------------------ '高速化(非表示OFF,自動計算OFF) Application.EnableEvents = True Application.ScreenUpdating = True Application.Calculation = xlCalculationAutomatic Application.DisplayAlerts = True End Sub
VBAに関する問題です。 Private Sub CommandButton1_Click() Dim i i = Application.Match(TextBox1.Value, Columns(1), 0) If IsError(i) Then MsgBox "検索できません" TextBox2.Value = "" Else TextBox2.Value = Cells(i, 2).Text End If End Sub これをこのシートではなく、 "C:¥users¥desktop¥book1.xlsx"のシート2を参照したいです。 どこの部分を変えればよろしいでしょうか？ よろしくお願いいたします！
package csvJunit; public class CommissionResponse { String name; public String getName() { return name; } public void setName(String name) { this.name = name;} public String getSex() { return sex; } public void setSex(String sex) { this.sex = sex; } public String[] getGwArr() { return gwArr; } public void setGwArr(String[] gwArr) { this.gwArr = gwArr; } String sex; String [] gwArr; }
ニュートン法による非線形方程式の解の計算です。 f(x)=x^3-3^2+9x-8 初期値が10、 vbaで残差の絶対値が10＾－6まで計算するとき、do loop while文の中に入る式はどうなりますか？ f(x)=x^3-3x^2+9x-8 dfdx(x)=3x^2-6x+9 ←f(x)' k=0 do ............loop while
package csvJunit; import java.io.BufferedReader; import java.io.File; import java.io.FileInputStream; import java.io.FileReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.HashMap; import java.util.Map; import java.util.Set; import java.util.StringTokenizer; import javax.swing.text.html.HTMLDocument.Iterator; import junit.framework.TestCase; import org.junit.After; import org.junit.AfterClass; import org.junit.Before; import org.junit.BeforeClass; import org.junit.runner.JUnitCore; public class testJunit001 extends TestCase{ @BeforeClass public static void setUpBeforeClass() throws Exception { } @AfterClass public static void tearDownAfterClass() throws Exception { } @Before public void setUp() throws Exception { } @After public void tearDown() throws Exception { } public void testCsvJunit() { // サーバからの結果gwResponseList ArrayList<CommissionResponse> responseList = new ArrayList<CommissionResponse>(); CommissionResponse cr001 = new CommissionResponse(); String[] stringArray001 = { "c1Msg001", "c1Msg002", "c1Msg003" }; String[] stringArray002 = { "c2Msg001", "c2Msg002", "c2Msg003" }; String[] stringArray003 = { "c3Msg001", "c3Msg002", "c3Msg003" }; cr001.gwArr = stringArray001; responseList.add(cr001); cr001 = new CommissionResponse(); cr001.gwArr = stringArray002; responseList.add(cr001); cr001 = new CommissionResponse(); cr001.gwArr = stringArray003; responseList.add(cr001); for (int i = 0; i < responseList.size(); i++) { CommissionResponse cr002 = responseList.get(i); String[] stringArray = cr002.gwArr; for (int j = 0; j < stringArray.length; j++) { System.out.println(stringArray[j]); } } // CSVから読み取り結果gwCsvExpectedList HashMap<String,ArrayList<String>> map = new HashMap<String,ArrayList<String>>(); try { //ファイルを読み込む FileReader fr = new FileReader("e:\\test.csv"); BufferedReader br = new BufferedReader(fr); //読み込んだファイルを１行ずつ処理する String line; StringTokenizer token; while ((line = br.readLine()) != null) { String[] strArr = line.split(","); if(map.get(strArr[0]) != null){ map.get(strArr[0]).add(strArr[1]); }else{ ArrayList<String> tmpList = new ArrayList<String>(); tmpList.add(strArr[1]); map.put(strArr[0], tmpList); } //区切り文字","で分割する // token = new StringTokenizer(line, ","); // // //分割した文字を画面出力する // while (token.hasMoreTokens()) { // System.out.println(token.nextToken()); // } // System.out.println("**********"); } //終了処理 br.close(); } catch (IOException ex) { //例外発生時処理 ex.printStackTrace(); } ArrayList<String> caseNoList = new ArrayList<String>(); for (Map.Entry<String, ArrayList<String>> mapEntry : map.entrySet()) { String caseNo = mapEntry.getKey(); // キーを取得 caseNoList.add(caseNo); } String s = ""; for (int i = 0; i <caseNoList.size(); i++ ){ ArrayList<String> rerustList = map.get(caseNoList.get(i)); CommissionResponse response = responseList.get(i); String[] msgList = response.getGwArr(); for(int m = 0; m < msgList.length; m++){ } if(rerustList.size() != msgList.length ){ System.out.println(" ケース番号: "+ caseNoList.get(i)); System.out.println(" NG、メッセージ個数不一致 " ); System.out.println(" 予想結果： "+ rerustList); System.out.println(" 実出力結果： "); System.out.println( msgList); return; } for(int j = 0; j < msgList.length; j++){ if(!rerustList.get(j).equals(msgList[j])){ System.out.println(" NG、メッセージ不一致 ：[" + (j + 1) + "]個目" ); System.out.println(" 予想結果： "+ rerustList.get(j)); System.out.println(" 実出力結果： " + msgList[j]); } assertEquals(msgList[j],rerustList.get(j)); // String str = msgList[j]; // if(!rerustList.contains(str)){ // System.out.println(" NG、メッセージ不一致 ：[" + j + "]個目" ); // System.out.println(" 予想結果： "+ rerustList); // System.out.println(" 実出力結果： " + msgList[j]); // assertEquals(true, false); // } } } } // 比較gwResponseListとgwCsvExpectedList }
vbaについての質問です url = "http://info.finance.yahoo.co.jp/search/?query=" & codeSet html = CreateObject("MSXML2.XMLHTTP") html.Open "GET", url, False html.Send とするとアクセスが拒否されます codeは銘柄コードです 他の変数の説明は省略します なぜでしょうか 解決策も教えてください
VB.netです。フォームの右クリックメニューで、文字の左側にあるグレーの部分を表示させないためにはContextMenuStripの「ShowImageMargin」を Falseにするということで、知恵袋で教えていただいたのですが、同じように２段目のメニュー（サブメニューと言ったらよろしいでしょうか）でもそれを消したいのです。 プロパティを見てみてのですがそれらしいものが見つかりません。 ２段目のグレー表示を消す方法を教えてください。
VB2010の質問です。Private Sub PictureBox1_MouseDown(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles PictureBox1.MouseDown End Sub 上記の ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs ではマウスの座標、左右のボタン確認とかの情報が得られますが、 その他にはどんな情報があるのでしょうか？ また、その情報の取り込み方法などを教えて下さい。 マイクロソフトのサイト以外でこれらを詳しく説明している サイトがあれば教えて下さい。
題「64bit版Excel VBA における配列変数のメモリ内容が知りたい」※長文 ※ Windows 7(64bit)／Excel 32bit 以下、32bit Excel VBAたとえば Dim b(0) As Integer と宣言すると要素数１個の配列が用意されます。 このときの配列変数 b そのもののメモリ内容を調べてみたわけなんですが…。 64bit だとどんな内容になっているんだ？と思ったんです。 ＊ まず必要なAPIの宣言。（64bit版は省略） モジュール「Win32API」 Public Declare Sub CopyMemory Lib "Kernel32" Alias "RtlMoveMemory" (ByVal Destination As Long, ByVal Source As Long, ByVal Length As Long) Public Declare Function LocalSize Lib "Kernel32" (ByVal hMem As Long) As Long Public Declare Function VarPtrArray Lib "msvbvm60.dll" Alias "VarPtr" (Var() As Any) As Long ＊ メモリダンプ関数を用意。 モジュール「Module1」 Private Function DumpToString(pMem() As Byte) As String Dim i As Long Dim str As String str = "" For i = 0 To UBound(pMem) str = str & IIf(i > 0, " ", "") & Right("00" & Hex(pMem(i)), 2) Next i DumpToString = str End Function ＊ ここからやりたいこと。………長いです。すいません（汗 モジュール「Module1」 テキトーに Sub プロシージャ Test を作ります。 Public Sub Test() ２つの変数 a、b(0) を用意。 他、作業に必要な変数なども用意。 Dim a As Integer '// 変数 Dim b(0) As Integer '// 静的配列 Dim a_ptr As Long '// 変数 a のメモリ番地 Dim b_ptr As Long '// 配列変数 b そのもののメモリ番地 Dim b_ele_ptr As Long '// 配列の要素に割り当てられているメモリ番地 Dim mem(31) As Byte '// メモリダンプ用 とりあえず、２つの変数に何か値を入れてみます。 a = 1 b(0) = 2 当然、それぞれに割り当てられているメモリに値が格納されるだけです。 ここで、各々のメモリ番地を取得してみます。 a_ptr = VarPtr(a) '// 配列変数 b そのもののメモリ番地 Call Win32API.CopyMemory(VarPtr(b_ptr), ByVal Win32API.VarPtrArray(b), 4) b_ele_ptr = VarPtr(b(0)) '// メモリ番地を確認 Debug.Print "address of a =[0x" & Right("00000000" & Hex(a_ptr), 8) & "]" Debug.Print "address of b =[0x" & Right("00000000" & Hex(b_ptr), 8) & "]" Debug.Print "address of b(0) =[0x" & Right("00000000" & Hex(b_ele_ptr), 8) & "]" 実行すると address of a =[0x0032EF96] address of b =[0x0032EF7C] address of b(0) =[0x125437A0] などと表示されます。 配列の要素に割り当てられているメモリ量は Debug.Print "memory size of elements = " & Win32API.LocalSize(b_ele_ptr) & " byte" とすれば memory size of elements = 2 byte と表示されると思います。Integer １個分ですから当然２バイトです。 さて、ここからが本題です。 配列変数 b そのもののメモリ内容がどうなっているのか表示してみます。 ' 配列変数 b そのもののメモリ内容を表示 Call Win32API.CopyMemory(VarPtr(mem(0)), ByVal b_ptr, 32) Debug.Print "memory of b =[" & DumpToString(mem) & "]" 配列変数そのものに確保されるバイト数が不明なため、とりあえず 32 バイトとしました。 memory of b =[01 00 92 00 02 00 00 00 00 00 00 00 A0 37 54 12 01 00 00 00 00 00 00 00 00 00 01 00 11 00 00 00] 3 バイト目の値は、静的配列 = 0x92、動的配列 = 0x80 となるようです。 13～16 バイトの 4 バイト（*1）は配列の要素の先頭アドレスだと予想されます。 17 バイト目の 0x01 は要素の個数となるようです。 これを見る限り配列変数には 24 バイトほど確保されている感じです。 それでですね、(*1)の 4 バイト部分についてですが、64 bit Excel だとどうなるのだろうか。もし 64bit 版をお持ちの方がいらっしゃったら教えていただきたいのです。 多分 memory of b =[01 00 92 00 02 00 00 00 00 00 00 00 A0 37 54 12 00 00 00 00 01 00 00 00 00 00 01 00 11 00 00 00] 13 ～20 バイトにアドレスが入り、直後に要素の個数が入ると思うのですが…。 …ん？配列の個数？二次元 ( Dim b(2, 3) ) だとどうなるんだ？と思ったものの、それはまた今度…。 ちなみに、(*1)の４バイトを a_ptr に書き換えたところ、値が共有されました。当然と言えば当然か。 Call Win32API.CopyMemory(ByVal b_ptr + 12, VarPtr(a_ptr), 4) b(0) = 99 Debug.Print "a =" & a '// a =99 となる Debug.Print "b(0) = " & b(0) '// ちゃんと元に戻そうね Call Win32API.CopyMemory(ByVal b_ptr + 12, VarPtr(b_ele_ptr), 4) End Sub '// Testプロシージャの終端 なんだか、配列変数がポインタ変数のように見えてきたような気がするがExcelが壊れてしまいそうだなぁ…。 ※もし実行する場合は自己責任で（汗
http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1215951458...をした者です自分で参考にして作りまし たが、どうしてもエラーになる箇所あります。 Sub u() Dim 市場 As String, 商品 As String Dim 最終行3 As Long Dim 検索 As Range Dim 地域 As Variant Dim 地域範囲 As Range Dim 最終行2 As Long Dim 商品範囲 As Range Dim 全体範囲 As Range Dim answer As Double Dim 商品検索結果 As Variant Dim 地域検索結果 As Variant 最終行 = Worksheets("Sheet2").Cells(Rows.Count, 1).End(xlUp).Row For i = 2 To 最終行 市場 = Worksheets("Sheet2").Cells(i, 2) 商品 = Worksheets("Sheet2").Cells(i, 3) 最終行3 = Worksheets("市場").Range("A" & Rows.Count).End(xlUp).Row Set 検索 = Worksheets("市場").Range("A1:B" & 最終行3) On Error Resume Next 地域 = Application.WorksheetFunction.VLookup(市場, 検索, 2, False) On Error GoTo 0 If VarType(地域) <> vbEmpty Then With Worksheets("値段") Set 地域範囲 = .Range("B1:E1") 最終行2 = .Range("A" & .Rows.Count).End(xlUp).Row Set 商品範囲 = .Range("A1:A" & 最終行2) Set 全体範囲 = .Range("A1:E" & 最終行2) End With With Application.WorksheetFunction On Error Resume Next 商品検索結果 = .Match(商品, 商品範囲, 0) 地域検索結果 = .Match(地域, 地域範囲, 0) On Error GoTo 0 If VarType(商品検索結果) <> vbEmpty And VarType(地域検索結果) <> vbEmpty Then ココ⇒ answer = .Index(全体範囲, 商品検索結果, 地域検索結果) End If End With End If Worksheets("Sheet2").Cells(i, 9) = answer Next i End Sub エラーメッセージは、型が一致しません 多忙中、よろしくお願いします。
Excel(2013)です。シート2 T1(結合セル)をコピーして、 シート6 B2に値のみ貼り付けるマクロを教えてください。 セルの結合は変更できません。
エクセルのVBAの入門サイトを教えてください。 JavaScriptやＣ＃,VB.NET、PHPなどは少しわかる程度です。エクセルのVBAは全くわかりませんので最初から学習したいと思います、ですのでご多忙中申し訳ありませんが、エクセルのVBAの入門サイトを教えていただければ幸いです。 よろしくお願いします。
VBAに詳しい方お願いします！ 私はVBA初心者です！Excel上でテーブル２つをIDをキーにして結合し、新しいテーブルを作成する、 ということを行いたいと考えていますが、方法がわかりません…。 使用しているのはExcel2010です。 テーブル1 ID 氏名 Pass kotoko1 市崎 123456 kotoko2 新崎 234567 kotoko3 三崎 345678 kotoko4 志崎 910456 テーブル2 ID 役職 kotoko1 市長 kotoko3 課長 目標のテーブル3 ID 氏名 Pass 役職 kotoko1 市崎 123456 市長 kotoko2 新崎 234567 kotoko3 三崎 345678 kotoko4 志崎 910456 何卒、よろしくお願いします！！
ExcelのVBAで質問がございます。閉じている別ブックの検索方法についてです。 現在開いているファイルのセルA1の値（例:AAA）が別ブックのシート1にあるかどうかを検索し、存在している場合はそのセルの場所を返す方法がわからず悩んでいます。 また検索して結果が存在していてもヒットしたセルのとなりに◯が入力されていた場合はスルーするような事は出来るのでしょうか。
エクセルに関してお教えください。 デスクトップに「Book1」と「Book2」があります。「Book1」の「A1」セルには ='C:\Users\user\Desktop\[Book2.xlsx]Sheet1'!$B$2 と入力しました。 「Book2」の「A1」セルに入力した値を 「Book1」の「A1」セルに入れたいのですが、 このままですとうまく作動します。 ここからが問題の部分なのですが、どうしても 「Book2」は「Book3」とか「あああブック」などと 都度、ファイル名を変更しないといけないのです。 そうすると「Book1」の「A1」セルは 元「Book2」の「A1」セルの値を取得してくれません。 この場合の対処法をどのようにすればよいのか、 どなたかお教えください。 よろしくお願いいたします。
エクセルからアクセスのテーブルにデータを追加するVBAの記述を教えてください。 Excel VBA超初心者です。ご指導をお願いします。エクセルのSheet1にデータ（商品コード・商品名・商品区分・単価）があります。 このSheet1の全データをアクセルのテーブル「M＿商品」へ追加したいです。 （アクセスの「M＿商品」テーブルにデータを蓄積したい） 例： エクセルの（Sheet1）…データファイル A B Ｃ D 1 商品コード 商品名 商品区分 単価 2 BR-01 OKZエール ビール 2000 3 BR-02 OKZラガー ビール 3000 4 NS-01 三河桜 日本酒 1500・・ ・ ・ アクセスのテーブル（「M＿商品」）…書き出し先 フィールド：「商品コード」「 商品名」「 商品区分」「 単価」 以下のようにVBAで記述しました。 Sub データ追加() Dim con As New ADODB.Connection Dim rs As New ADODB.Recordset Dim conStr As String conStr = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Users\WHITE\Desktop\注文管理.accdb" con.Open ConnectionString:=conStr rs.Open Source:="M_商品", ActiveConnection:=con, _ CursorType:=adOpenKeyset, LockType:=adLockOptimistic With rs .AddNew .Fields("商品コード").Value = Range("A1").Value .Fields("商品名").Value = Range("B1").Value .Fields("商品区分").Value = Range("C1").Value .Fields("単価").Value = Range("D1").Value .Update End With rs.Close con.Close End Sub 上のマクロでは、最初の一行目のデータしかアクセルファイルに追加されません。 全エクセルデータをアクセスファイルの「M_商品」テーブルに追加するにはどのように直せばいいのでしょうか？（エクセルデータの一行目は項目名なので、二行目以降ののデータをすべて書き出したいです） 教えていただけましたら、大変助かります。よろしくお願いいたします。
アクセス テキストファイルのインポートについて 下記のコードで任意のテキストファイルをT1にインポートしようとすると テキストファイルの数字（0123）の0が消えてしまいます。0を消さずにインポートするにはどのようにすればいいでしょうか。 ご回答宜しくお願い致します。 Private Sub コマンド0_Click() Dim fDialog As Object Dim Rst As DAO.Recordset Dim file As String Set fDialog = Application.FileDialog(3) fDialog.InitialFileName = "指定のパス" fDialog.Show file = fDialog.SelectedItems(1) DoCmd.TransferText acImportDelim, , "T1", file End Sub
エクセルで、2435という数字の2だけを赤くするにはどうしたらいいでしょうか。 2を選択して赤にしても、すぐ黒に戻ってしまいます。 使えるメソッドなどがあったら教えてください。
Excel VBA 条件に合う行をカウントしたい。 下のようなデータをレンタル先ごと、シリーズごとにカウントしたいです。レンタル先 商品番号 製造月 田中 1422 2014/5 田中 1414 2014/5 田中 1436 2014/9 田中 1411 2014/9 松本 1315 2013/9 白井 1212 2012/7 白井 1242 2012/7 レンタル先ごとにカウント 田中 4 松本 1 白井 2 シリーズごとにカウント（商品番号の前2桁+製造年月が同じ物） 14 2014/5 2 14 2014/9 2 13 2013/9 1 12 2012/7 2 今のところ、下記のコードでレンタル先ごとの集計をしてみたのですが、50行までのデータしかカウントされません。実際は161行まであります。 VBAの知識がほとんどないため、ネットで調べた物を組み合わせて作ったため、でたらめなものになっているかもしれません。 因みに、データ行の開始は7行目からで、カウントしたいレンタル先のデータは１列目にあります。 Dim i As Long, cnt As Long, tate As Long, yoko As Long tate = ActiveCell.Row yoko = ActiveCell.Column + 1 For i = 7 To Cells(Rows.Count, 1).End(xlUp).Row If i = ActiveCell Then cnt = cnt + 1 i = i + 1 Next Cells(tate, yoko) = cnt End Sub どこが悪くて50行目までしかカウントされないのか教えて頂けないでしょうか？
asp でsqlserverに接続しようとして巧くいかず質問させて頂きました。 (デバック環境では巧く接続できましたが) iisにのせたら接続できません。 aspx.vbで以下の様なコードを書いておりますDim n As String = "" Dim bl As Boolean bl = False Dim connectionstring As String connectionstring = ConfigurationManager.ConnectionStrings("DefaultConnection").ConnectionString Try Using con As New SqlConnection Using sqlcmd As New SqlCommand con.ConnectionString = connectionstring con.Open() sqlcmd.Connection = con sqlcmd.CommandText = "SELECT * FROM " & GetGlobalResourceObject("Resource", "persondata") & " WHERE 識別ＮＯ = '" & CStr(Me.TextBox1.Text) & "' AND パスワード = '" & CStr(Me.TextBox2.Text) & "';" n = sqlcmd.ExecuteScalar() con.Close() con.Dispose() bl = True End Using End Using Catch ex As Exception Console.WriteLine("接続が失敗しました") End Try If bl = True And (Not n Is Nothing) Then Response.Redirect(GetGlobalResourceObject("Resource", "Insert")) End If End Sub ・sqlcmd.CommandTextで指定しているSQL文のresourceはデータベース名.スキーマ名.テーブル名としています。 web.configでconnectionstringは以下の様に設定しています。 <add name="DefaultConnection" connectionString="Data Source=***.***.***.***\OWNER-PC\SQLEXPRESS,1433;Initial Catalog=糖尿;Integrated Security=True" providerName="System.Data.SqlClient"/> ***は3ケタの数字でＩＰを設定していて、ローカル環境から変えて設定したつもりですが、この辺が巧く行っているかが解りません。（フリーのＤＮＳを登録してあり,ＷＥＢでDNSのＩＰを確認して、そのＩＰを使いました） ＳＱＬSERVERの構成マネージャーでSQLEXPRESSのプロトコル、TCP/IPのプロパティのＩＰアドレスのIP４のアドレスはweb.configで使用しているIPと同じで、IPALLのTCPポートは1433にしてあります。 ファイアウォールは開けてあります。 解る方に教えて頂けると助かります。 よろしくお願いいたします。
powershell バージョンは2以上です(２と４を使用) ディレクトリに以下のファイル一覧があり、 1_A.txt 2_A.txt 3_A.txt 4_A.txt5_A.txt ... 9_A.txt 10_A.txt その他のファイル群 ファイルのn_A.txt ※nは連番 で不定期に作成していて、10を超えない場合もあります。 ファイル名でソートするとファイルが10を超えると 9_A.TXTが最後になってしまいます。 n_A.txt の最終ファイル取得するにはどのようにソートすれば良いでしょうか？ ※パワーシェルで回答をお願い致します。その他の言語は対象外です。 またフォーマット(桁数を0xにする)等の回答はご遠慮ください。
Excelについて質問です。いろいろ検索したのですが解決しませんでした。 500人くらいの社員名簿があるとして、 A1からA500くらいまで名前が入っています どこかに、『選択してください』のプルダウンリストをつくり入力規制から名前を選択できるようにします。 そこで選択した人の名前の行まで飛んでいくというか その人の行を表示したいのです。 プルダウンで鈴木さんを選択したら 鈴木さんのデータが、表示されている行まで アクティブセルが、移動する。 そのような方法はありますでしょうか？ ご教授お願いいたします。
Ｅｘｃｅｌ マクロ マクロには、ＶＢＡしか無いのですか。 他にありますか。
お世話になります。 やりたいのは、Excel2013上で自動で実行されるマクロです。 環境： Sheet1=表、Sheet2=ウェブからのデータをA1に貼り付けて別セルに整形（TRIM、JIS関数） やりたいこと：Sheet2にウェブからのデータを貼り付けた際、別セルで整形したデータをコピーし、Sheet1の表の一番下のセルに値のみを貼り付け コレをマクロで自動でやりたいのですが、うまくいきません。 Sheet1の表で一番下のセルを選ぶあたりで、Rangeのエラーが出てしまいます。 マクロ詳しい方、ご教授お願いしますm(__)m
monthview controlを使ってユーザーフォームの日付を入れようと考えています。日付は初期値に今日の日付を表示させて、日付を入れるtextboxの隣にボタンを設置し クリックすると別のユーザーフォームよりmonthviewでカレンダーを表示させて日付を入れるようにしたいのですが、うまくいきませんでした。 Private Sub カレンダー_DateClick(ByVal DateClicked As Date) 日付.Value = カレンダー.Value End Sub ご教授お願いします win7 Excel2010です。
エクセルで納品書発行のためのデータを作成していて、自動で伝票番号を付けたいと思っています。取引先毎に付番するだけであればｉｆ関数でできたのですが、１枚の納品書は４行までという指定があり、困っています。Ｂ列は入力されていて、Ａ列2行目に任意の数字を入力すれば3行目以下に数字が反映されて以下のようになるようにしたいのですが、どなたかお教えいただけないでしょうか？ よろしくお願いいたします。
Excel VBA - Do until~Loop 歯抜けの日付列を追加 横軸に日付があり、抜けている日付列を追加して連続する日付にする以下マクロを作ったのですが、思うとおりに動きません。どうもOffsetが機能していない様なのですが、どこがだめなのでしょうか。ご教示ください。 ＜イメージ＞ 2016/7/1 2016/7/2 2016/7/5 Product1 Product2 Product3 ↓ 2016/7/1 2016/7/2 2016/7/3 2016/7/4 2016/7/5 Product1 Product2 Product3 ＜マクロ内容＞ Sub 列挿入() Do Until ActiveCell.Offset(, 1).Value = "" date1 = ActiveCell.Value date2 = ActiveCell.Offset(, 1).Value If date2 = "" Then Exit Sub If date2 - date1 > 1 Then ActiveCell.Offset(, 1).Activate For i = 1 To date2 - date1 - 1 ActiveCell.EntireColumn.Insert ActiveCell.Value = ActiveCell.Offset(, -1) + 1 ActiveCell.Offset(, 1).Activate Next End If Loop End sub よろしくお願いします。
VB6→VB2008への変更について（KeyDownイベント） フォーム上にテキストボックス「txtBarCode」があり そのバーコードにフォーカス状態でバーコードスキャナが読まれたときの処理です。 VB6はこれで出来ていたのですが、 VB2008.netでこの処理と同じようにしたいのですが コードの書き方を教えて頂けないでしょうか？ 宜しく御願い致します。 Private Sub txtBarCode_KeyDown(KeyCode As Integer, Shift As Integer) If KeyCode <> &HD Then Exit Sub End If If IsNull(txtBarCode.Text) = True Or txtBarCode.Text = "" Then Exit Sub End If If Len(txtBarCode.Text) <> 20 Then Exit Sub End If : End Sub
vbaの配列結合についての質問です。下記の2次元配列(list)を行ごとに結合させて、カンマ区切りでセルに出力させたいのですが、どうすれば良いのかわかりません。 1次元配列を結合する場合は、Join関数で対応できると思うのですが、2次元配列は結合できないのでしょうか？ Sub 配列結合の仕方() Dim list(2, 2) As String list(0,0) = "あ" list(0,1) = "い" list(0,2) = "う" list(1,0) = "か" list(1,1) = "き" list(1,2) = "く" list(2,0) = "さ" list(2,1) = "し" list(2,2) = "す" ↓ ↓ A1 = "あ,い,う" A2= "か,き,く" A3= "さ,し,す" End Sub
エクセルオートフィルターの繰り返しのＶＢＡのマクロについて教えてください｜ Ａ ｜ Ｂ ｜ Ｃ ｜ Ｄ ｜ Ｅ ｜ 1 ｜ Ｍ 月 回数 人数 数字 ２ ｜ 1 １月 ４ ２ 45 ３ ｜ １ ３月 ６ ７ 80 ４ ｜ １ ６月 ４ ３ 70 ５ ｜ １ ２月 8 ９ 56 ６ ｜ １ ７月 ５ ７ 77 ７ ｜ 空白 8 ｜ ２ １０月 ５ １０ 88 ９ ｜ ２ １１月 ４ １２ 55 １０｜ ２ ８月 ３ ５ 72 １１ 空白 １２｜ ３ ４月 ５ ７ 99 ． ． ． ． ． ． このような表なんですが、空白の所でオートフィルターを設定し（データがあるところまで）E列 の所で、降順の場合と昇順の場合のオートフィルターのマクロを教えて頂きたいのです。 １回１回オートフィルターを設定するのではなく、マクロでやりたいです。 初めて投稿するので至らない所がありましたらごめんなさい。 宜しくお願いします。
どなたか教えてください。以下のコードは「新規ファイル」というBookに 「見積書(ニトリ(産廃))」というシートを挿入するものとして 作成しましたが、これを「新規ファイル」でなく 「アクティブブック」に挿入するには、どのように訂正したら ようのでしょうか？ よろしくお願いします。 Sub 産廃用見積書呼出() Workbooks.Open (ThisWorkbook.Path & "\" & "見積書.xlsm") Worksheets("見積書(ニトリ(産廃))").Copy _ After:=Workbooks("新規ファイル.xlsm").Sheets(Workbooks("新規ファイル.xlsm").Sheets.Count) Workbooks("見積書.xlsm").Close SaveChanges:=False End Sub
エクセル、VBA初心者です。Worksheets("1日:31日").Range("A2").Select Selection.ClearContents 1日から31日までの全てのシートのA2のセルの文字を消すマクロを作りたいです。 上記のコードを実行すると、 実行時エラー '9':インデックスが有効範囲にありません。というエラーが出てしまいます。 ご教示下さい。
VB6とSPREADについて form1に設置したSPREADの値をform2で使用したいのですが、どのようにすればいいでしょうか。 ご回答よろしくお願いします。
エクセルのマクロについて教えて下さい。以下のページの右クリックでチェックにするコードをまるごとコピーして実行しようとしてもEnd subが必要ですと出ます。どうしたら良いか教えて下さい。http://pc.nikkeibp.co.jp/article/technique/20100823/1027039/ コードは以下です ' 右クリックされたら起動するEnd Sub Private Sub Worksheet_BeforeRightClick(ByVal target As Range, Cancel As Boolean) ' 複数セルを選択している場合は終了 If Selection.Cells.Count <> 1 Then End ' 列によって動作を変える Select Case target.Column ' 1列目の場合 Case 1 c = target.Text ' ●ならブランクにする If c = "●" Then Selection.Value = "" ' ●以外なら●にする Else Selection.Value = "●" End If ' 右クリックメニューの抑制 Cancel = True End Select End Sub
VBAで別フォームでの登録内容を他フォームに反映 VBA超初心者です。教えてください。 【現状】 メインフォーム（A）に『新規』というコマンドボタンがあります。クリックすると別フォーム(B)が表示されそこで情報登録 ができるというものです。 Bのフォームでテキストボックスに情報入力後、『登録』を押したタイミングでその内容がエクセルシート及びAに作成してあるリストボックスに反映されるようにしたいのですがうまくできません。 Bに記載しているコード↓Dim n As Long n = Cells(1000, 2).End(xlUp).Row 1 Cells(n, 2).Value = TextBox1.Value Cells(n, 3).Value = TextBox2.Value Cells(n, 4).Value = TextBox3.Value DoCmd = DoCmd.Close DoCmdForms!A!B!.Form.Requery MsgBox "Ok", 64, "登録しました" シートには反映されていますがAの方への反映はコンパイルエラーが続きます。 変数を指定したり色々試してはいるのですが・・・書き方自体が間違っているのかなと思います。どのようにコードを記載すれば反映されるのでしょう？教えてください シートには反映されていますがAの方への反映はコンパイルエラーが続きます。 変数を指定したり色々試してはいるのですが・・・書き方自体が間違っているのかなと思います。どのようにコードを記載すれば反映されるのでしょう？教えてください
アドバンスソフトウェアで販売しているExcelCreatorとVBReportは何が違うのでしょうか？説明を見ても理解できません。簡単に教えてください。
エクセル2013を使用しています。H2Oと記入して、２を範囲選択した後に、右クリック→セルの書式設定で下付きを選択したら、フォントサイズは1～409の間で行ってくださいとエラーメッセージが出てできません。 どうしたらできますか？ VBAでやっても構わないのでよろしくお願いします。
VB始めたばかりで、壁に当たっており質問させていただきました。 現在下記の処理があります。sbdSQL.Append(" AND BI.ADDRESS IN ('11','12','13') ") これをデータベースから引っ張ってくるように改修したいのです。 下記テーブルを用意しました。 テーブル DBDATA DBDATA_KBN 1000 DBDATA_NAIYOU 11,12,13 １．データベースから抜き出す処理。 If strNo = "1" Then SQL.Append(",(SELECT " & vbNewLine) SQL.Append(" SUBSTRB(DBDATA_NAIYOU,1,8) AS AA_CODE " & vbNewLine) SQL.Append(" FROM " & vbNewLine) SQL.Append(" DBDATA " & vbNewLine) SQL.Append(" WHERE " & vbNewLine) SQL.Append(" DBDATA_KBN='1000' " & vbNewLine) SQL.Append(") DBDATA_1000 " & vbNewLine) End If ２．１で取得したデータを入れ込みたいのですが、下記if文の方法自体出来るものでしょうか？ また、他の方法があれば教えていただきたいです。 SQL.Append("WHERE " & vbNewLine) → 今回の質問とは直接関係ない処理です。 If strNo = "1" Then SQL.Append(" BI.ADDRESS IN (DBDATA_1000.AA_CODE) ") End If
ポリモーフィズムの目的を一言でまとめると何ですか?また、ポリモーフィズムの本質とは何でしょう(・・?教えてください。
エクセルのマクロについて教えて下さい。以下のページの右クリックでチェックにするコードをまるごとコピーして実行できるようになりましたが、複数の列でチェックできるようにしたいですどうすればいいですか？http://pc.nikkeibp.co.jp/article/technique/20100823/1027039/ コードは以下です。 ' 右クリックされたら起動する Private Sub Worksheet_BeforeRightClick(ByVal target As Range, Cancel As Boolean) ' 複数セルを選択している場合は終了 If Selection.Cells.Count <> 1 Then End ' 列によって動作を変える Select Case target.Column ' 1列目の場合 Case 1 c = target.Text ' ●ならブランクにする If c = "●" Then Selection.Value = "" ' ●以外なら●にする Else Selection.Value = "●" End If ' 右クリックメニューの抑制 Cancel = True End Select End Sub
vbaについて3点質問があります。 変数の説明は割愛します。1点目 InStr(html.responseText, "" data-ylk="slk:history;pos:0">時系列</a></li>") = 0 2点目 Workbooks.Add Dim b As Object Set b = ActiveWorkbook.Worksheet(1) をエラーしないようにするには？ 3点目 新しく作ったファイルをアクティブを使わないで操作する方法
エクセルのVBAについて質問です。Sheet1のI8からO26とI29からP48までをドロップダウンのリスト設定をし、Sheet2に設定している各項目を入力出来るようにしたのですが、IからPまでのセル幅が狭く（セルを広げられない）ドロップダウンリストの幅も狭い為に項目の頭数文字しか表示されないので、VBAを使ってドロップダウンリストの幅を広げようと思いました。 そこでネットにて調べた結果、以下のコードに辿り着きました。 Private Sub Worksheet_SelectionChange(ByVal Target As Range) Dim s As Shape Dim BtnWidth As Single With ActiveCell Select Case .Address(False, False) Case "I8", "P26" If .Validation.Type = xlValidateList Then Set s = ActiveSheet.Shapes("Drop Down 16") BtnWidth = s.Width - .Width s.Width = 120 s.Left = .Left + .Width - s.Width + BtnWidth Set s = Nothing SendKeys "%{down}" End If End Select End With End Sub しかし上記コードだとセル単体の指定は出来るのですが、希望としている範囲指定が出来ません。 自分なりに調べてはみたのですが、どうしても範囲を指定することが出来ずにお手上げ状態となっています。 そこでVBAにお詳しい方のお力を借りたいと思い、質問させていただきました。 どなたか分かる方がいらっしゃいましたら、ご教授のほど宜しくお願い致します。 ※エクセルは2010です。
エクセル関数マクロに詳しい方、ご教授をお願いします。 a列３：11に品名入力、d列に品名マスターがある。b列3:11にそれぞれの数量入力すると、d列の品名マスターにa列に入力した品名と数量がe列に数量が反映される表です。 e列には、関数設定がある。 そこで、グループ分けをしたいです。 例えは、リンゴ「２５」で１グループ バナナ「２５」、「２５」で２グループ トマト「７」イチゴ「７」ナシ「１」で３グループ ミカン「９」デコポン「４」で４グループ 尚、グループは、任意です。 「２５」を最大にしてマクロ、関数でどのように、設定したらよいか 教えてください。 マクロ、関数は、入門者なので、よろしくお願いします。
エクセル関数マクロに詳しい方、ご教授をお願いします。 a列３：11に品名入力、d列に品名マスターがある。b列3:11にそれぞれの数量入力すると、d列の品名マスターにa列に入力した品名と数量がe列に数量が反映される表です。 e列には、関数設定がある。 そこで、グループ分けをしたいです。 例えは、リンゴ「２５」で１グループ バナナ「２５」、「２５」で２グループ トマト「７」イチゴ「７」ナシ「１」で３グループ ミカン「９」デコポン「４」で４グループ 尚、グループは、任意です。 「２５」を最大にしてマクロ、関数でどのように、設定したらよいか 教えてください。 マクロ、関数は、入門者なので、よろしくお願いします。
C#、VB、JavaScriptのフレームワークの大半は.NET Frameworkですか？
VBのプログラミングで教えていただきたいです。DB(oracle)に下記を登録しています テーブル DBADD CODE 100 KUBUN 120 DATA 11,12 プログラム内のSQL文のwhereのところに，下記のように記載していますが、 SQL.Append(" AND ADDRESS IN (SELECT DATA FROM DBADD WHERE DBADD_CODE='100' AND DBADD_KUBUN='120' )") うまく取得できません。 DBのDATAを「11」だけにすると、うまくいくのですが、「11,12」だと駄目です。 プログラムの書き方がいけないのか、そもそも方法が間違っているのか検討がつきません。 この方法でいけるか又は他に方法があるかお願いいたします。
Visual BasicのColordialogにおいて、選んだ色のRGB値を取得するにはどのようにプログラムを書けばよいのでしょうか？PictureBox上で色を混ぜるために、RGB値が必要です。
Microsoft .NET Framework 4.6.2の正式版ってもうリリースされていますか？また、NET Framework 4.6.2 Previewをインストールしていても、NET Framework 4.6.2 正式版をインストールすることはできますか？（アンインストール＆インストールでもいいのですが、OS再インストールなどにならないか心配しています） 以上、よろしくお願いいたします。
【HTA】ファイル読み込み、以前のデータが保持されてしまう【VBS】 ファイルを読み込み、その内容をテーブル表示しています。 ファイルは部分抽出しています。【コマンド】特定文字列を含む行のみ抽出【FINDSTR】 http://mochi-ha.hatenablog.com/entry/2016/06/24/163411 これを参考に、抽出しています。 ざっくり書くとこんな感じです。 'スクリプト名を含まないフルパスを編集する strScriptPath = Replace(window.location & "" , "file:///","") strScriptPath = Replace(strScriptPath,"/","\") strScriptPath = Replace(strScriptPath,"%20"," ") Set FS = CreateObject("Scripting.FileSystemObject")'ファイル存在するかを確認 If FS.FileExists(strScriptPath & "\data\Database.csv")=True then 'ファイルがある場合は Set Shell = CreateObject("WScript.Shell") Shell.Run("""" & strScriptPath & "\data\data.bat" & """" & " " & FolderName) FolPath=strScriptPath & "\data\data.csv" Set FS = CreateObject("Scripting.FileSystemObject")'ファイル存在するかを確認 Set fp = FS.OpenTextFile(FolPath) '============-ファイル読み込み Do Until fp.AtEndOfStream buf=fp.ReadLINE 'addDataにデータ入力 TableArea.innerHtml=addData'内容に対して表作成 Loop Set FS = Nothing 'オブジェクトの破棄 Set fp = Nothing 'オブジェクトの破棄 End if 問題なくdata.csvファイルは出来ているのですが 1回目 フィルター項目無し 2回目 フィルター項目無し たとえば、 DD1,DDD,DDD,DDD,DDD DD2,DDD,DDD,DDD,DDD DD3,DDD,DDD,DDD,DDD DD5,DDD,DDD,DDD,DDD 上記のようなDatabase.csvになっていた場合 ＜正常動作＞ DD4は無いので、引っかからない →表が表示されずに、「抽出項目を変更してください」と出る。 DD5を入力した場合、引っかかる →表が表示される ＜異常動作＞ DD4は無いので、引っかからない →表が表示されずに、「抽出項目を変更してください」と出る。 DD5を入力した場合、引っかからない →表が表示されずに、「抽出項目を変更してください」と出る。 もう一度DD5と入力して、実行 →表が表示される 表が表示された後に、 DD4と入力した場合に、表が表示されてしまいます。 ※ ボタンを押したら表を全て作り変える仕組みのため、おかしいです。 Data.csvがきちんと出ていないのかと思い 表が作成されてしまったときにData.csvを見ましたが何もデータはありませんでした。 バッファというか、何か記憶してしまっているのでしょうか? まっさらな状態にするにはどうしたら良いでしょうか。 2回実行すれば、表示されますが 1回目のときに表が表示されずに、「抽出項目を変更してください」と出たりするので とても使いにくいです。 ちなみに、FolderNameというのはテキストボックスに入っていた値で、 ボタンを押したら上記ソースが実行される仕組みです。（部分略してますが） 以上、よろしくお願いいたします。
シート内でA列の内容に重複がある場合はセルに色を付けるマクロを作ったのですが、 色を付けながら、メッセージボックスでエラー数を表示させるにはどうしたらよいでしょ うか？ また、なぜか重複していないデータに色がつくのが一つだけでるのですが、考えられる原 因はなんでしょうか？ ●シート内容● Ａ列－Ｂ列－Ｃ列 452169Ｒ0001－顧客名－売上 425222P0019－顧客名－売上 ・ ・ ・ ちなみに、色がついたデータは、”425222P0019”という値一つのみでした。（本来なら色がつくのは2つ以上であるべきなのに） 同じような数字でも重複しているのは二つついたのに、なぜこの数字だけ…という疑問です。 変数は VariantやLong で試してみたのですが結果は同じでした。 またこのマクロは時間がちょっとかかりました。（今回は200行程度だったのに、5秒くらいかかりました） お手数おかけしますがよろしくお願いします ●マクロ↓ Option Explicit Sub 重複チェック() '重複チェック Macro Dim RetRange As Range Dim i As Variant Range("A2").Select Range(Selection, Selection.End(xlDown)).Select For i = 1 To Cells(1, 1).End(xlDown) Set RetRange = Selection.Find(What:=Cells(i, 1).Value, _ after:=ActiveCell, LookIn:=xlFormulas, _ LookAt:=xlPart, SearchOrder:=xlByRows, _ SearchDirection:=xlNext) If Not RetRange Is Nothing Then If RetRange.Address <> Cells(i, 1).Address Then RetRange.Interior.ColorIndex = 6 Cells(i, 1).Interior.ColorIndex = 6 End If End If Next End Sub
Excel VBA初心者です。 質問させてください。現在C列をD列にコピー B列をC列にコピー A列をB列にコピー A列をクリア としているのですが、下記のコードで約３０秒ほどかかります。 Sub test() Application.ScreenUpdating = False Application.Calculation = xlManual Range("C:C").Select Selection.Copy Range("D:D").Select ActiveSheet.Paste Range(”B:B”).Select Application.CutCopyMode = False Selection.Copy Range("C:C").Select ActiveSheet.Paste Range("A:A").Select Application.CutCopyMode = False Selection.Copy Range("B:B").Select ActiveSheet.Paste Range("A:A").Select Application.CutCopyMode = False Selection.ClearContents Application.Calculation = xlAutomatic Application.ScreenUpdating = True End Sub セレクトやコピー、ペーストを多様しているのが、遅いと思ってるのですが、 どうすれば速くなりますか？ シートの関数は、VLOOKUPが５列の５００行程度しか入っていません。
VBAでエクセルのコピペを”値と元の書式”を指定して貼り付けしたいと思います。Sheet1からSheet２にコピペをするのですが、Sheet２の貼り付け位置は現在値があるとことの次の行としたいので、以下の通りコードを組んでみましたがうまくいきません。 どなたか方法をお教えいただけないでしょうか。 Sub 台帳へコピー() Worksheets("Sheet1").Select Range("A2:AE21").Select Range(Selection, Selection.End(xlToRight)).Select Range(Selection, Selection.End(xlDown)).Select Selection.Copy Sheets("Sheet2").Select Range("A1").Select Selection.End(xlDown).Offset(1, 0).Select Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats End Sub
エクセルでA列の入力行を取得するマクロで相談です。 下記のマクロではうまくいかないのですが、 どこが間違っていますか？Private Sub Workbook_Open() With Worksheets("Sheet1") .Activate 'A列の入力行を取得する .Cells(Rows.Count, 1).End(xlUp).Offset(1).Select End With End Sub
VBAの実行エラーついて教えてください。 マクロの実行が出来るBook（α）があります。 Sheet1には表があり、マクロを実行すると完璧な動作をします。しかし、Book（β）にあるSheet1の表に対してマクロを実行する為、 Book（α）を起動したまま、Book（β）で実行しても マクロコード中の途中部分が実行されず、エラーとなってしまいます。 しかし、Book（β）の表をコピーして、Book（α）に貼り付けると 動作します。 何が悪いのかこの情報だけで診断できますか？ コード自体が非常に長いので、問題となっている部分のみ貼り付けます。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Set st1 = Worksheets("Sheet1") For i = 2 To ThisWorkbook.Worksheets.Count r1 = st1.Range("B" & st1.Rows.Count).End(xlUp).Row + 1 Set st = Worksheets(i) R = st.Range("F" & st.Rows.Count).End(xlUp).Row st1.Range("A" & r1).Value = st.Range("F" & R).Value st1.Range("B" & r1).Value = st.Range("I" & R).Value st1.Range("B" & r1).NumberFormatLocal = "\#,##0;\-#,##0" Next i Sheets("Sheet1").Activate '==========A列のセルが空白でない行のC列に数式を入れる Dim xFormula As String, rng As Range Const cFormula1 As String = "=SUM(@@)" Const cFormula2 As String = "=@1/@2" ★★★With Columns(1).SpecialCells(xlCellTypeConstants)★★★★←ここでエラーとなります。 Set rng = .Cells(.Count).Offset(2, 1) rng.NumberFormatLocal = "\#,##0;\-#,##0" rng.Formula = Replace(cFormula1, "@@", .Offset(, 1).Address(False, False)) xFormula = Replace(cFormula2, "@2", rng.Address) xFormula = Replace(xFormula, "@1", .Cells(1).Offset(, 1).Address(False, False)) .Offset(, 2).Formula = xFormula .Offset(, 2).NumberFormatLocal = "0.00%" End With 宜しくお願いします。
Windows 10 でフォルダが勝手に作られます。 エクセルのVBAをやってると、ブックを保存してあるフォルダにフォルダがいつのまにかできています。 エクセルは古い 2003 です。VBAのちょっと複雑なマクロを組んでいるときに、知らないうちにフォルダができています。 文字化けした名前だったり、英文字1文字だったり、名前が無いように見えたりします。 これは一体何なのでしょう？ご存知の方、おられますか？ 解決方法はあるでしょうか？
VBA 御教授ください。 エクセルの”データ”ｼｰﾄに （A列）製品品番 （B列）製品名 （Ｄ列）売上金額 （E列）支払金額と 1万件ほどﾃﾞｰﾀが入っています。毎回システムに打ち込む際に、金額の確認をします。エクセルの検索を利用していますが、 検索画面を出して、打ち込んで検索し 売上金額仕入れ金額があっているが確認するか、コピーして貼り付けで入力します。 毎回エクセルにもどって（エクセルを最前画面にして）検索かけて金額確認・またはコピーして再度システムの画面にも戻って・・・と。 これをvbaでやりたい。 エクセルを開くと、テキストボックスが出てきて、入力するとそのテキストボックスに売上金額・支払金額が表示されるようにしたい。 検索画面は、最前面に出せませんか？ 検索するワードは、製品品番および製品名です。 なんとかよろしくお願いいたします。
VB.NETのパネル切り替えについて あるフォームから、別フォームの特定のコントロールだけ表示させる(見た目がそれっぽければよいです)ことは可能でしょうか？ やりたいことは以下の通りです。 フォーム1に配置されたラジオボタンによっね、フォーム1に配置されたパネルを切り替えたいです。 選択肢は5パターンほどあるので、切り替えのパネル部分は別フォーム(フォーム2〜フォーム6)を用意しています。※フォーム1に5パターン分のパネルを作成するとごちゃごちゃするのでそれはやりたくない。 ラジオボタンの選択により、各フォームに作成したパネルを呼ぶということがしたいです。
プロシージャ
エクセルVBAで特定の文字列までループをする お世話になります。VBA初心者です。 例えばですが、下記の様に商品毎に、売上げた社員名とその個数のデータがあるとします。 A ｜ B ｜C リンゴ 名前 売上個数 田中 10 吉田 20 佐藤 15 合計 45 みかん 名前 売上個数 伊藤 25 加藤 5 合計 30 … 空白を開けず連続で続くデータです。 「リンゴ」なら「リンゴ」の売上個数だけ、「みかん」なら「みかん」の売上個数だけをループして別シートに合計を出したいのですが、行数がまちまちなうえ空白もないのでうまくいきません。 必ず「合計」と書かれたセルが存在するので、そのセルを基準にしようかと思ったのですがこれもまたうまくいきません。 使用する上記データは全支店の売上数を自動で記録するので一番正しく、できればこのデータを使用したいと思っています。 わかり難いかと思われますが、できればご教授願います。
現在Windows8.1でffftpを使っていますが5つあるアカウントの内１つがエラーとなり接続できなくなってしまいました。設定などいろいろ変更してみたのですがやはりつながりません。現状下記のようなエラーが出ているのですが、もし解決方法があれば教えていただけないでしょうか。 よろしくお願いします・・・。 copyright (C) 2011-2013 FFFTP Project (Hiromichi Matsushima, Suguru Kawamoto, IWAMOTO Kouichi, vitamin0x, unarist, Asami, fortran90, tomo1192, Yuji Tanaka, Moriguchi Hirokazu). デフォルトのマスターパスワードが使われます. マルウェアの攻撃を防ぐため，固有のマスターパスワードを設定することをおすすめ します OpenSSLが読み込まれました. ---------------------------- FTP over Explicit SSL/TLS (FTPES)を使用します. ホスト www.i-b-e.net を探しています. (TCP/IPv4) ホスト www.i-b-e.net を探しています. (TCP/IPv6) ホスト www.i-b-e.net が見つかりません. (TCP/IPv6) ホスト www.i-b-e.net (202.181.97.23 (21)) に接続しています. (TCP/IPv4) 接続しました. (TCP/IPv4) 220 ProFTPD 1.3.5a Server (SAKURA Internet FTP Server) [::ffff:202.181.97.23] >AUTH TLS 234 AUTH TLS successful >PBSZ 0 200 PBSZ 0 successful >PROT P 200 Protection set to Private >USER i-b-enet 331 Password required for i-b-enet >PASS [xxxxxx] 230 User i-b-enet logged in >FEAT 211-Features: MDTM SSCN TVFS MFMT SIZE PROT CCC PBSZ AUTH TLS MFF modify;UNIX.group;UNIX.mode; REST STREAM MLST modify*;perm*;size*;type*;unique*;UNIX.group*;UNIX.mode*;UNIX.owner*; EPRT EPSV 211 End >TYPE A 200 Type set to A >PASV 227 Entering Passive Mode (202,181,97,23,238,235). ダウンロードのためにホスト 202.181.97.23 (61163) に接続しています. (TCP/IPv4) 接続できません. (TCP/IPv4) ファイル一覧の取得を中止しました. >CWD www 250 CWD command successful >XPWD 257 "/home/i-b-enet/www" is the current directory >TYPE A 200 Type set to A >PASV 227 Entering Passive Mode (202,181,97,23,220,93). ダウンロードのためにホスト 202.181.97.23 (56413) に接続しています. (TCP/IPv4) 接続できません. (TCP/IPv4) ファイル一覧の取得を中止しました. ファイル一覧の取得に失敗しました. >TYPE A 200 Type set to A >PASV 227 Entering Passive Mode (202,181,97,23,235,91). ダウンロードのためにホスト 202.181.97.23 (60251) に接続しています. (TCP/IPv4) 接続できません. (TCP/IPv4) ファイル一覧の取得を中止しました.
VBAで質問です エクセルを使ってワードファイルのパスワードを一括で解除しようと思うのですが、 任意.password = ""と記述しても、変更前のパスワードのままで解除されません。どう入力すれば解除できるか教えていただけないでしょうか
エクセルで、A列に企業ホームページのURLがあり、B列に企業名を入れていくという作業をしているのですが、いちいちA列からリンクを開いて中身を確認してB列に入力するのが大変で、何か簡略化する方法はありますでしょうか？データが6000個以上ありますので手作業はめげそうです。 マクロはある程度なら分かるのですが、このようなケースでどう使うのかが分からなくて、詳しい方、教えて頂けると助かります。 よろしくお願い致しますm(_ _)m
仕事で 1.CADソフトのスクリーンショットを撮る 2.パワーポイントに貼り付ける 3.トリミングし、適当な大きさに合わせる 4.CADソフトに戻り、数値の測定をする 5.パワーポイントに入力する の繰り返し作業をしています。 何か、簡単に出来る方法はないでしょうか？ 全く良い案が思い浮かびません。 ちなみにソフトはcreoというものを使用しています。 Microsoftのマクロは少し触れます。
VBA 御教授ください。 エクセルの”データ”ｼｰﾄに （A列）製品品番 （B列）製品名 （Ｄ列）売上金額 （E列）支払金額と 1万件ほどﾃﾞｰﾀが入っています。毎回システムに打ち込む際に、金額の確認をします。エクセルの検索を利用していますが、 検索画面を出して、打ち込んで検索し 売上金額仕入れ金額があっているが確認するか、コピーして貼り付けで入力します。 毎回エクセルにもどって（エクセルを最前画面にして）検索かけて金額確認・またはコピーして再度システムの画面にも戻って・・・と。 これをvbaでやりたい。 エクセルを開くと、テキストボックスが出てきて、入力するとそのテキストボックスに売上金額・支払金額が表示されるようにしたい。 検索画面は、最前面に出せませんか？ 検索するワードは、製品品番および製品名です。 なんとかよろしくお願いいたします。
Visual Studio2015 でopenCVを使用したファイルを作成しようとしています。ですが出力場所をReleaseに指定してビルドしても、そのProjectフォルダ内の2つのReleaseフォルダを確認してもexeファイルがなく、上の階層のReleaseフォルダには[opencv_world310.dll]というファイルがあるだけでした。ビルドはソリューション、プロジェクトのどちらも行いました。なぜexeが作成されないのでしょうか？
C#のボタンが押されたときのイベント処理について。 C#初心者ですが、現在Windows_Formアプリにて簡単なゲーム作成を行っています。ゲームの内容は、コインの裏表をボタンで選択し、相手との組み合わせによって点数が変わるというものです。 表ボタン(open_button)か裏ボタン(back_button)が押されたら、相手との組み合わせを判断し、ポイントを計算させたい(calc_point)のですが、 いずれかのボタンが押されたらメソッドを呼び出す、というやり方がわかりません。 イベントやデリゲートについて深く理解していないので、その点についても合わせて解説していただけないでしょうか。
VBA初心者です。すいません あるエクセルファイルからCSVファイルを出力したいと考えております。 そのエクセルファイルから⑥通りのCSVファイルを出したいです。CSVファイルの名前の最後には以下を表す①、②、、、、⑥をいれたいです。 ①Aプランで○○日（当日マイナス１日） ②Aプランで○○日（当日） ③Bプランで▲▲日（当日マイナス１日） ④Bプランで▲▲日（当日） ⑤Cプランで□□日（当日マイナス１日） ⑥Cプランで□□日（当日） ※A列にプラン名（A～C）がB列に日付（当日または当日マイナス１日（前日））が 出てくるエクセルファイルとなっています。 上記を作成するには、 フィルターを利用して⑥パターンをつくると思っています。 そして、 fileformat:=xlcsv と format（"yyyy-mm-dd・・・ などを使っていくのではとなんとなくわかりますが、いまいち コード文などがわかりません。 お手数ですが、ヒントでも結構なので教えていただけると助かります。
Excelで作った自作の請求書で、発行時に都度入力する顧客情報を、同時に別ファイルのシートに追加保存したい。 請求書は、テンプレート形式で保存しています。次に請求書を発行する時に、 入力規則を使って、保存された名簿を使いたいと思っています。 同じファイルで、別シートに保存する方法は見つけましたが、 同じファイルに保存すると、自分の場合は、次回の利用が出来ません。 別シートの方法を応用して、何とか試してみましたが、 うまくいきませんでしたので、教えていただけますと助かります。 すみませんが、よろしくお願いします。 同じファイルの別シートに保存するマクロ↓ Dim mygyo As Integer, kijitsu As Variant, koumoku As String, tanka As Variant, kosuu As Variant, kingaku As Variant Sheets("Sheet2").Select mygyo = Cells(1, 6) + 1 Sheets("Sheet1").Select kijitsu = Cells(3, 1) koumoku = Cells(3, 2) tanka = Cells(3, 3) kosuu = Cells(3, 4) kingaku = Cells(3, 5) Sheets("Sheet2").Select Cells(mygyo, 1) = kijitsu Cells(mygyo, 2) = koumoku Cells(mygyo, 3) = tanka Cells(mygyo, 4) = kosuu Cells(mygyo, 5) = kingaku Cells(1, 6) = mygyo Sheets("Sheet1").Select End Sub
指定したセル内を1ずつ増やして、空白の時は増やさない(なにもしない) 途中まではわかったんですが空白の処理がわかりません。 どなたかご指導下さい。Sub 翌月処理() Range("C4：C35").Value = Evaluate("C4:C35+1") Range("A1").Select End Sub
excelの図形サイズ選択について、やり方がわかる方がいましたら教えてください。 図形のサイズをプルダウン方式みたいに変更する方法ありますでしょうか？添付した様に、４つのサイズの矢印が存在します。下の様な固定箇所にその４サイズの中から選んで表示できる様にしたいのですが、何か良い方法はありませんでしょうか？ プルダウンでなくても、指定のセルに「Ａ」と打ち込んだら1番小さい矢印が表示されるというのでも大丈夫です。 よろしくお願いいたします。
Excelで条件付き書式のマクロを作ろうと思います。あるセルを選択して、一つ下のセルと数値又は文字が一緒であれば選択セルの文字を青に 数値又は文字が違えば選択セルの文字を赤にするという条件付き書式にしたいのですが、 なかなかうまくいきません よろしくお願いいたします。
エクセルのIF関数について教えてください。 ※A1で文言を選択したら、Ｂ１で空白か、日付を表示する様にIF関数を設定しています。①Ｃ1で今日の日付を入力 ② Ｄ１でＢ１の日付がＣ１の日付を超えたら、「●」を表示、超えていないなら「空白」、 Ｂ１が「空白」ならＤ１も「空白」にしたいのですが、どのように設定したらよいでしょうか？
アクセス2013のデータ検索方法について質問です。 フォームのコンボボックスで選択した項目を検索キーとして、 クエリで抽出する仕組みを作りたいのですが、上手く行きません。具体的に言うと ①”検索フォーム”名フォームの ②”検索工場名”コンボボックスのリストから特定の工場を選択し、 ②”詳細検索”クエリで”検査表”テーブルの”工場名"フィールドの中から当該工場を抽出するため ③クエリの最後のフィールドで 式1: IIf(IsNull([Forms]![検索フォーム]![検索工場名]),True,[工場名]=[Forms]![検索フォーム]![検索工場名]) とSQLコードを入力しております。 他の検索項目も有る為、他の項目が空欄でもエラーが出ないように上記の式を作りました。 どこが問題なのでしょうか？ また、どう修正すれば良いのでしょうか？ 以前同様の仕組みをテキストボックスに直接文字入力をて検索する仕組みを作った時は 上手く行ったのですが・・・
ブックを開かずに、フォルダ内にある複数ブックのブック名と特定セルの値を抽出したいですフォルダ内には50個ほどエクセルブック（.xlsm）があり、中身のシート名・フォーマットは全て同じですが、すべてブック名は違います。 ブックを開くことなく、ブック名と特定のシートの特定のセルにある値を、全て1枚の表にまとめることは可能でしょうか？ フォルダがある場所：マイドキュメント フォルダ名："勤務表"フォルダの中の"部署別" 参照したいブック名 :ブックによって異なる "部署別A.xlsm 部署別B.xlsm"など 参照したいシート名： "集計用" 参照したいセル： "Q200～T200" と "P200～P250" データをまとめたいブック名："勤務表まとめ.xlsm" データをまとめる時の形は下記のような形にしたいです （A列） （B列） （C列） （D列）（E列） (F列～BC列) ブック名 ファイル１のQ200の値 ファイル１のR200の値 ファイル１のS200の値 ファイル１のT200の値 ファイル１のP200の値～ファイル１のP250の値 ・ ・ ・ VBAは初心者です。できればコードをそのまま拝借したいです。 他に似たような質問がありまたが、私の手に負えませんでした。 お知恵を貸してください。何卒よろしくお願いします。
VB6で実現可能か教えて欲しいです。 Visual Basic 6.0を用いて、基板を加熱させながら電圧をかけることで、温度変化した時の温度と電流をExcelに出力したいと考えています。 電圧、電流計、温度計はGPIBで接続しています。 20℃から120℃まで約100点を測定したいと思っています。 計画としては forで回してifで温度計の温度が希望の時に電流の値をExcelに書き込むといった物にしようとしています。 C言語をやったことがあるだけでVB6は勉強中なので、間違えがあったらすみません 宜しくお願い致します。
ExcelVBAにて、SQL→ユーザーフォームのリストボックスへの表示が異常に遅い。現在、SQL→二次元配列→リストボックスという流れで表示してますが 10フィールド、1000件程度の表示にも20秒程度要してしまってます。 Debugで時間を確認すると、二次元配列に格納する箇所でその20秒程度 かかってしまっているようです。 コードは以下の通りです。 ↓ ========================== '配列動的定義 ReDim myData(AdoRs.Fields.Count - 1, AdoRs.RecordCount - 1) '二次元配列に格納 Do Until AdoRs.EOF For i2 = 0 To (AdoRs.Fields.Count - 1) myData(i2, i) = AdoRs(i2) Next i2 i = i + 1 AdoRs.MoveNext Loop '配列→リストボックス With F_見積一覧.lst_見積一覧 .ColumnCount = AdoRs.Fields.Count '列数 .ColumnWidths = "75,20,150,210,150,50,100,40,40,40" .Column() = myData End With ========================== ちなみに、データベースはSQL Server 2014 Expressで、 SQLOLEDBを使用して接続しています。 二次元配列への格納の高速化か、 SQLの結果を、直接リストボックスにセットできれば良いなと思っておりますが、良いやり方がわかりません。 どなたか、ご教示いただけないでしょうか？ よろしくお願いいたします。
時間がオーバーしてしまいそうだったので新しく作らせていただきました。 今のところこんな感じになっています。v1 = Right(URL, 21) '200110/2001103118.jpg yy = DateValue(Left(v1, 4) & "年" & Mid(v1, 5, 2) & "月01日") mm = DateValue(Mid(v1, 8, 4) & "年" & Mid(v1, 12, 2) & "月" & Mid(v1, 14, 2) & "日") + TimeValue(Mid(v1, 16, 2) & "時01分") b() = Inet1.OpenURL("http://***/" + "yy" + "/" + "mm" + ".jpg", icByteArray) ちなみに９月と０９月の話がありましたがURLは一桁月なら0○月の表記だったので、桁の増減はないです。
エクセルのVBAでどうすれば良いか困っています。 配列にリストを取り込んだ後の拾い出す方法です。 リストにはNOが振られていて昇順にソートされています。また、リストは繋がりを持っていて、親となる場所のNOを持っており、親を重複して持つことがあります。(NO.8と10、15がNO.5を親とするなど) このような配列で任意のNOを指定した時に、その後につながってくるNOを全て拾い出すようなアルゴリズムが分かりません。分岐した先が上手く拾えません。 誰か助けてください。
Oracleエラーのエラー内容の取得方法について Visual Basic/Visual Studio をはじめて3ヶ月目の初心者です。現在、Excelにて作ったテーブルのデータを VBを介してOracleデータベースへ取り込むプログラムを作っております。 取り込む際にエラーが発生（正しい日付型ではない等）しましたら、Oracleのエラー内容を取得したいと思っておりますが、取得する方法について調べ方が悪いのかわかりませんが、構文ややり方が出てこずに困っております。 どのようにすれば取得を行うことができるのでしょうか。 なお、Oracleへの接続はODP.NETを用いて行っております。
エクセルVBAについて質問です。シート1のセル1AにプルダウンをA〜Eまで設定します。 処理1 プルダウンでCを選択した場合 シート2の5〜10行を非表示にし、15〜20行を表示させたいです。 処理2 プルダウンでC以外を選択した場合 シート2の5〜10行を表示にし、15〜20行を非表示にさせたいです。 上記の命令をどう書けばいいかわかりません。 どなたかお教えいただきたいです。 よろしくお願い致します。m(_ _)m
VB.NETにてdatatableのデータの一部を別のdatatableに移す手順につきまして 何度も何度も、申し訳ございません。すでにデータが設定されているdatatableの一部の行を別のdatatableに移す記述を行っている最中なのですが、VB.NETで一部の記述のみを移す記述例等が見つからずに困っております。 型につきましてはすでに作っておりますので、後はデータを写すのみとなっております。 お手数ですが、教唆いただければと思います。 （イメージ）移動元テーブル ←移動させる絡む項目には、頭に"◎"がついている。 ◎COL_AAA｜COL_BBB｜COL_CCC｜◎COL_DDD ------------------------------------------------------------------------ あああああ ｜いいいいい｜ううううう ｜えええええ （イメージ）移動先テーブル（型作成済み） COL_AAA｜COL_DDD｜ あああああ｜えええええ｜
エクセルのマクロについて質問です。 決まった作業を記録したいと思っています。その作業は、 指定したセルがB2の場合、B2からG2を黄色で塗りつぶす A1を黄色で塗りつぶす というような作業です。 指定するセルは変わります。 指定したセルと同行の複数のセルと前行の1セルを塗りつぶす という作業をしたいです。 この場合マクロを作成する事は可能でしょうか？
Excel2013にて、プルダウンで表示される項目とは別の値をセルに入力 Excel2013にて、プルダウンを使用してセルに項目を入力させようとしているのですが、例えば「1：愛知」「2：岐阜」「3：三重」というリストを用意して、プルダウンの選択肢に表示させて、 「1：愛知」を選択した場合は、そのセルに「1」を入力というようにすることは可能でしょうか？ VBAを使用する方法でも可です。ご教授頂きたいです。 添付の画像をご覧ください「①」には外部からすでにデータが読み込まれている状態で E～G列のリストも「①」の結果によって候補の県をVBAにて出力させております。 今回の場合はこのエクセルを使用する人が県名の選択肢に何があるかいまいち把握できておらず プルダウンから候補選ぶという想定です。 「③」は現状、「②」に数字を入れるとDBに接続して情報を持ってくるつくりです。
エクセルのグラフ(チャート)の再表示を早くする方法について質問させていただきます。エクセルでシートのデータを使って複数のグラフを作成してある状態から、VBAでデータを再計算した時に、グラフが再表示されるまで、感覚で0.5秒ほど間があるのを、もっと早くできないでしょうか？ VBAでは、はじめに画面のアップデートは止めています。ほとんどのセルは計算式は入っていません。計算そのものは瞬間的に終わっていて、計算終了後、画面のアップデートをオンにしています。その後、間が空いてグラフが再表示されます。 画面のアップデートを止めなくても結果は変わりませんでした。 シート内のデータは20列100行程度の数値です。 グラフは折れ線グラフで、グラフ化しているデータいろいろですが、ひとつのグラフは5列30行程を対象にしています。 VBAでこのデータのほぼすべてを再計算して書き込み直します。そこまでは早いのですが、グラフが書き変わるのに一瞬時間がかかっているのを、早くしたいのです。 よろしくお願いします。
Excel VBAで質問させてください。大量のPDFを一つのフォルダに入れて、まとめて印刷するプログラムを 見つけたので、コピペさせていただいたのですが、 **の部分でデバックになってしまいます。 たぶん、acrobat reader ではなく、acrobatをダウンロードしていないとダメなプログラムだと思うのですが、 acrobat readerで作動するプログラムはどのようになりますか？ よろしくお願いいたします。 Private Sub CommandButton1_Click() Dim strPath As String Dim strFileName As String Dim pdffiles() As String Dim intcount As Integer strPath = "C:\Documents and Settings\isa\デスクトップ\PDF print\" strFileName = Dir(strPath) Do Until Len(strFileName) = 0 If Right(strFileName, 3) = "pdf" Then ReDim Preserve pdffiles(intcount) pdffiles(intcount) = strFileName intcount = intcount + 1 End If strFileName = Dir() Loop Dim AcroExchApp As Object Dim AcroExchPDDoc As Object Dim AcroExchAvDoc As Object Dim buf As Long **Set AcroExchApp = CreateObject("AcroExch.APP") Set AcroExchPDDoc = CreateObject("AcroExch.PDDoc") Set AcroExchAvDoc = CreateObject("AcroExch.AVDoc") buf = AcroExchApp.Show Dim i As Integer For i = 0 To UBound(pdffiles) buf = AcroExchAvDoc.Open(strPath & pdffiles(i), "") Set AcroExchPDDoc = AcroExchAvDoc.GetPDDoc() Dim numPage As Long numPage = AcroExchPDDoc.GetNumPages buf = AcroExchAvDoc.PrintPages(0, numPage - 1, 2, 0, 0) If buf <> -1 Then MsgBox ("印刷に失敗しました。ファイルが開かれていない可能性があります") Exit Sub End If buf = AcroExchAvDoc.Close(False) Next buf = AcroExchApp.Exit Set AcroExchApp = Nothing Set AcroExchPDDoc = Nothing Set AcroExchAvDoc = Nothing End Sub
【セル（または文字）を任意の色で表示させる方法について】 ある作業を管理する目的で、 エクセルで管理表のようなものを作りたいと思っています。エクセルのセルの、 「A列の１行目」には、今日の日付（6/25）を入力したとします。 その右の「B列の１行目」には、１週間後の日付（7/2）を入力したとします。 さらに「C列」には、その１週間後の日付（7/9）を入力したとします。 当日以降になった時に、そのセルを 任意の色（例えば、赤色）で、表示させることは出来るのでしょうか？ 例えば、７月２日になった時に、 「B列の１行目」のセルを自動で 赤色表示させることは出来るのでしょうか？ セルの色を変えられないのであれば、 文字の色（日付）を赤色で表示させる方法でも構いません。 ちなみに、「B列」と「C列」には、すでに下記の計算式が入っております。 B列 … =A1+7 C列 … =B1+7 よろしくお願いいたします。
EXCEL2007でマクロを作成していますが、エラー？が出て困っております。 UserForm1(show=VBModeless)内のCommandButton1を押してUserForm2を呼出して作業させ、Unloadするとなぜか呼出元のUserForm1までUnloadしてしまいます。 これはどういう現象なのでしょうか？ （何度も確認しましたが、UserForm1をUnloadさせるコードは入っていません。）
「恋するハッカソン」というブラウザゲームで詰まっています。 簡単に言うと特定動作をするコードを書くとアイテムをゲット出来るアイドル育成ゲームです。与えられた問題は以下ですが、コードはVB(.net)で組んでいます。（私はExcelVBAでコードをある程度組めますが他はググってなんとかなる程度で、この回答も自分でググッて組みました。が、提出前動作確認での動作はおそらく正しく動き、何パターンか入力項目をいじって出力させて希望通りの出力をするところまではいったのですが、本解答5回チャレンジの最終だけ失敗し、クリアできません。 (入力項目・出力の確認ができないのでどこをどう間違って止まっているのかわからないのも質問した理由となります。タイムは0.05、0.05、0.05、0.14、3.00(秒)のこの最後で引っかかるので大きなデータを入力されていることが原因だとは思います。) ゲームの性質上コードまるまるをこちらで掲載してチェックしてもらうことは避けたいのですが…何とかならないでしょうか。 ■問題■ 所属事務所の看板を作ることになったあなたは、看板に文字列を表示するため、各文字の印刷された小看板を別々に発注して組み合わせることにしました。しかし、発注後に表示する文字列に変更があり、小看板を再発注することになりました。 あなたは再発注する小看板の数を減らすため、共通する文字の小看板を再利用することを考えました。 例えば 文字列が "paiza" から "pizza" へと変更された場合、共通する a, i, p, z の 4 文字の小看板を再利用することで再発注数を 1 つに減らすことができます。 入力として変更前後の文字列の長さおよび文字列自身が与えられます。 この再利用方法で再発注しなければならない最小の小看板の数を出力してください。 ■入力される値 入力は標準入力にて以下のフォーマットで与えられます。 n m s t 1行目に変更前の文字列の長さ n と 変更後の文字列の長さ m が半角スペース区切りで与えられます。 2行目に変更前の文字列 s が与えられます。 3行目に変更後の文字列 t が与えられます。 入力は合計で 3行 となり、 最終行の末尾に改行が1つ入ります。 ■条件 すべてのテストケースにおいて、以下の条件をみたします。 n, m は整数 1 ≦ n, m ≦ 100000 (sの長さ) = n, (tの長さ) = m s, t は半角英字小文字のみで構成される文字列 ■期待する出力 再発注しなければならない最小の小看板の数を整数で出力してください。 最後は改行し、余計な文字、空行を含んではいけません。 ■入力例１ 入力 5 5 pizza paiza 出力 1 ■入力例２ 入力 3 5 ant maven 出力 3 ～～～～～～～～～～～～～～～～ 提出前動作確認では 入力部分を拾うと 5 5 pizza paiza で 私の解答はconsole.writeline( s3.length & vbcrlf)が最終的な出力部分となり、変数s3は"a"一文字で解答１これは正解を取ります。 入力部分を例２の通りとして出力のs3には"mve"のlengthで3が出力され正解と思います。 私のコードの流れは dim s1 as string = console.readline()'第一入力（各文字列長） dim s2 as string = console.readline()'第二入力（変更前文字列） dim s3 as string = console.readline()'第三入力（変更後文字列）をそれぞれ拾い ＜文字列長をスペース区切りで配列化して変更前文字列長を変数ｎに格納＞ ＜forループ変数 i = １ to ｎ＞ ＜If 変更前文字列i番目が変更後文字列にある場合＞ ＜変更後文字列から対象文字列をremove＞これがs3変数に格納されています。 ＜end if next i＞ console.writeline( s3.length & vbcrlf)’解答出力 ループ変数にintegerを使っていてlongに変更しましたが結果は変わりませんでした。 長文で乱雑ですが気づいたところなどありましたらご教示ください。
シート（入力画面）にエラーがあると別シート（印刷画面）に移動できないマクロを組みたいのですが、お知恵をお貸しください。ファイルを開くとデフォルト表示するマクロ（下記参照）を組み込んでおり、前回の入力内容が残った状態で表示されるので、シート移動の際に再度エラーチェックかけたいと考えています。 ※１ Ｃ３５＝”利用する”場合はＤ３６に必要情報を入力させる仕様 ” 利用しない”場合は入力不要と入力規則でエラー表示 Private Sub Workbook_Open() Worksheets("入力画面").Range("C35").Value = "利用しない" 'デフォルト表示 End Sub 入力内容をクリアしてファイルを閉じることも考えたのですが、”利用する”人の為に前回の入力情報は保持したいと思い、悩んでおります。
既存のマクロがあり、A列に列追加をしそこに、セルとセル文字を足した値を各行追記させたいと思いアレンジをしました。 しかし、A列の数式バーには ”=CONCATENATE(顧客一覧!'I12'&;A:A)” と入力されて、 表示は”0”… どう直したら反映されますでしょうか？お手数おかけしますがよろしくお願いします。 ちなみに、 ”顧客一覧”シートのセル”I12”(例:2016/6) ＋ ”集計結果”シートC列(例:1A1234) ＝”集計結果”シートのA列（例:425221A1234）※年月が文字化した数字とC列の値が合わさった状態にさせたいです。 ******* Sub Macro2() 'エリア+P番号の値を返す Dim ws As Worksheet Set ws = Sheets("集計結果") Dim myRow As Long Dim myRow2 As Long Sheets("集計結果").Select myRow = Cells(Rows.Count,"A").End(xlUp).Row Range(Range("B2"), Range("B" &myRow)).Formula = _ "=IF(COUNTIF(顧客一覧!B:G,A2),VLOOKUP(A2,顧客一覧!B:G,6,FALSE),"""")" '●↓今回追加したところ↓● Columns("A").Insert myRow2 = Cells(Rows.Count, "B").End(xlUp).Row Range(Range("A2"), Range("A" & myRow2)).Formula = "=CONCATENATE(顧客一覧!I12＆C)" End Sub
授業でVisual Stadio2013を使って、 Visual Basicでクイズを作ろうとしているのですが、 Excelファイルの読み込み方がわかりません。VB初心者で、何もわからない状態でやっているので、 わかりやすいホームページや、皆様が作られたプログラムなど、 あれば教えてください。 お願いします。 現在、以下のページを参考にしています。 http://www.atmarkit.co.jp/fdotnet/dotnettips/487csvparser/csvparser...
Ｇ6に印刷開始No H6に終了Noを記載して 印刷ボタンを押すと他シートにデータを貼り付けて 印刷するマクロを組みました。 このボタン周りがセンスがなくて微妙になってしまいました。ボタンのなかにＶＢＡでＮｏの記入を含めるなどいい方法はないでしょうか。 宜しくお願いします。
指定した1つのCSVﾌｧｲﾙから指定の文字が含まれたの列のﾃﾞｰﾀのみ取り込みたいです。 ｴｸｾﾙﾏｸﾛ初心者です。よろしくお願いします。下記の条件でCSVﾌｧｲﾙからｴｸｾﾙｼｰﾄに取り込みたいです・・・ ①別フォルダに複数のCSVﾌｧｲﾙがある。 ②取り込む場所は別のExcelファイルの空のシートである。 ③取り込みたいﾃﾞｰﾀは指定の文字の含まれた列のすべてのデータである。 →表の一番上に文字がありその下に数値が並んでいる。列のアルファベットではなく文字で列を指定し、その列のデータを全て取り込みたい。 ④取り込んだﾃﾞｰﾀはｴｸｾﾙｼｰﾄにA列(指定文字含む列①）、B列（指定文字含む列②）と順に並べる。 よろしくお願い致します。
アクセス2013の画像検索に関する質問です。 画像検索をした結果、画像が無い場合にエラーが起こらないようにしたいのですが 方法が解りません。現在フォームのテキストに入力した情報（商品の品番）を 商品の画像が保存されているファイルのパス名とクエリで結合させて フォーム上に画像を映し出す仕組みを作っています。 ①”SP412"とテキストAに入力。 テーブルに”C￥画像￥”と”.ｊｐｇ”の文字列を保存して、クエリで結合してフルパスを 作成しています。（c￥画像￥SP412.ｊｐｇ） ②但し画像が無い商品も多く、毎回エラー(実行時エラー）が表示されます。 画像が無い場合、画像が表示されない（もしくは”画像無し”の表示が出れば更にうれしいです。） ようにするにはどの様にすればよろしいでしょうか？ 誠に恐れ入りますがお教え頂ければうれしいです。
EMF4 リヤーキャリパーシリンダー機構
Visual Shot 3.0 （IBM）という画像管理ソフトを探しています。ウインドウズ98などの時代のものなのですが、無料で入手する方法は無いでしょうか。
エクセルのVBAについての質問です。 今回の目的として、Aのファイルに複数の同フォーマットのファイル（ファイルB～と定義します）からある範囲のセルのデータを転記するものです。1.ファイルBは発注書であり、およそ5行程の入力欄がありますが、全行に記入されているとは限らないので空欄の分は無視したい（ファイルAに転記される時、途中の空白を無くしたい）。 2.対象となるファイルAは、ファイルBの属性（約100属性）あるので、その属性分作成する必要があるので、理想的な物は属性分フォルダとファイルAを作成し、そのフォルダに属性ごとのファイルBを格納し、ファイルAに転記できるものが良い。 3.できれば、ファイルの記入日時順に転記したい。 4.ファイルAの行が、足りなくなる恐れがあるので足りなくなった分は自動的に追加したい。 5.月ごとにデータを纏めるので、出来れば翌月分も簡単に流用したい。 当方、エクセル初心者でプログラミングの経験も皆無です。解説サイト等閲覧しましたが理解できませんでした。 誠に申し訳御座いませんが、どなたか御教示いただけましたら幸いです。 私の説明では分かり辛いと思いますので、イメージを図にしたものを添付いたします。 何卒、宜しくお願い致します。
エクセルのチェックボックスを下記コードで作成し成功しました！(載せてくれた方本当にありがとうございます！) 実際に作業を行っていたら、チェックボックスを一括オン オフ出来るチェックボックスが必要なことが判明し.いまかなり困ってます！ 下記コードをアレンジして、一番上のチェックボックスをチェックすると全部がオン、もう一度チェックすると、全部がオフできるととても嬉しいです！ どなたかお力を貸してください！ '--------------ここから貼り付ける-------------------- Sub Check作成() Dim myChk As Object Dim i As Long Dim Sakuseisuu As Long Dim StartCell As Range '現在のブックのアクティブシートに作るにはこの下のWorkbooks.Addを消して下さい。 Workbooks.Add '--------↓ここを変更--------- Sakuseisuu = 20 'チェックボックスの作成数 Set StartCell = Range("B5") 'スタートする位置 '--------↑ここを変更--------- For i = 0 To Sakuseisuu - 1 With StartCell.Offset(i) Set myChk = ActiveSheet.OLEObjects.Add(ClassType:="Forms.CheckBox.1", Link:=False, _ DisplayAsIcon:=False, _ Left:=.Left, Top:=.Top, _ Width:=.Width, Height:=.Height) End With With myChk .LinkedCell = StartCell.Offset(i, 1).Address .Object.Caption = "" '空白にするのは何でだったかなー？ .Object.Value = False End With Next End Sub '--------------ここまで貼り付ける--------------------
エクセルVBAとアクセスデータベースを連携させています SQLで取得したレコードをコンボボックスにリスト表示させる方法を質問して回答をいただき無事リスト表示させることができました。しかし、表示されたリストから項目を選択することが出来ずにいます。 ネットでいくつかの例を検索したのですが自分の症状にマッチするものを発見できずにいます。 解決方法をご存知の方がいらっしゃれば教えていただけないでしょうか？ コンボボックスはシート上にActiveXコントロールのものを挿入しています。 使用しているコードは以下のものです。 Private Sub ComboBox1_DropButtonClick() Dim DBpath As String 'ファイル名 Dim adoCn As Object 'ADOコネクションオブジェクト Dim adoRs As Object 'ADOレコードセットオブジェクト Dim strSQL As String 'SQL文 DBpath = ThisWorkbook.Path & "\miyageDB.accdb" Set adoCn = CreateObject("ADODB.Connection") 'ADOコネクションオブジェクトを作成 Set adoRs = CreateObject("ADODB.Recordset") 'ADOレコードセットオブジェクトを作成 adoCn.Open "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & DBpath & ";" '業者名一覧取得 strSQL = "Select Distinct 業者名 From M_syouhin Order By 業者名 Asc" '読込の場合---------------------------------------------- adoRs.Open strSQL, adoCn 'SQLを実行して対象をRecordSetへ ComboBox1.Clear While Not adoRs.EOF With ComboBox1 .AddItem adoRs.Fields(0).Value End With adoRs.movenext Wend adoRs.Close 'レコードセットのクローズ adoCn.Close 'コネクションのクローズ Set adoRs = Nothing 'オブジェクトの破棄 Set adoCn = Nothing End Sub
VBAについてお教えください。タブを削除したいと思っています。単純にタブのみを削除したいんであれば、Replace関数を使ってタブを削除できる事はわかります。str = vbTab & "abc" & vbTab str = Replace(str, vbTab, "") これを、先頭のvbTabのみ、または末尾のvbTabのみを削除するには何か良い方法がございますでしょうか？よろしくお願いします。
とある方がVisual Studio (C#)でつくられていたシステムを その方のPCから自分のPCにコピーして持ってきて ひとまず動かしてみようとしたのですが開始を押してから「FileNotFoundExceptionはハンドルされませんでした。」 という題名でエラーが出てしまいましてその内容は 「型 'System.IO.FileNotFoundException' のハンドルされていない 例外がSystem.Drawing.dll で発生しました」 と 「追加情報:C:\Users\(その方のPCのアカウント名)\ Desktop\rogozukei\yonnkaku.png」 と書いてありましたのでアドバイスに沿って その方のPCアカウント名の所を自分のアカウント名にしたら 上手く起動したのですがそこから先に進もうとするとまたしても 「FileNotFoundExceptionはハンドルされませんでした。」 という題名でエラーが出てしまいましてその内容は 「型 'System.IO.FileNotFoundException' のハンドルされていない 例外がSystem.Drawing.dll で発生しました」 でエラーになってしまったのですが今度は 「追加情報:GDI+ で汎用エラーが発生しました。」 とありました。 この問題に対して考えられる対処法は何かありますか？ 宜しくお願いします。
Excel VBAで、2つのセルが同じ内容なら一つにまとめる、というのはどのようにすれば良いでしょうか？ 1 1 あ 1 1 い 1 2 う 1 3 え 11 お 1 2 か 1 3 き なら別のセルに 1 1 あ い お 1 2 う か 1 3 え き と表示させたいです。 よろしくお願い致します。
VBAに関する質問です。良きアドバイスをお待ちしております。 【質問要旨】 入力欄をつくるにあたり、実行すると（ｉ，ｊ）のスペースをつくります。 １）入力データはいくつありますか？（ｉ，ｊ）を入力する。 ２）以下のようなスペースをつくります。 A2,A3,A4,A5・・・Aj 1 2 3 ・ ・ i ２）スペースができた段階で 実行を一時中断して各セルにデータを入力します。 ３）全セルに入力した段階で「計算を実行」する。 ２）、３）にどのようなコマンドを作成すればよいのか困っています。 非常に初歩的な質問ですが、よろしくお願いします。
windows apiの画像の表示について質問です。exeファイル内に画像データ同梱させたいのですがうまくいきません。こちら<http://www-higashi.ist.osaka-u.ac.jp/~k-maeda/vcpp/sec4-2bmpresourc...>のサイトを参考に、bitmapの表示を試みたのですがウインドウは白いままで画像が表示されませんでした。リソースではなく実行ファイルと同じフォルダに画像を置く方法での表示はできたのですが...。使用環境はwindows10、コンパイラはborlandです。
EXCELでVBAが組まれているファイルがあります。 これを他のVBAを組んだファイルからシートの値を入力していくことはかのうですか？ 取引先が組んだVBAを触ることなく作業を自動化したいと思っています。 アドバイスをお願いいたします。
VBAによる、セルへの連番入力方法について、御教授願えないでしょうか…。意図してる動作は、下記になります。 エクセルシートのA列に、連番が入力されてます。そこで、途中に行を挿入し、挿入行のA列に、連番最終番号の次の番号を自動で入力したいと考えております。 申し訳ありませんが、どなたか御教授願えないでしょうか…。
よく、「ソースが仕様書だ」という話を聞きますが、バグや開発者の勘違いが作りこまれていた場合、どうやって修正すればよいでしょうか？
VBAマクロ初心者です。ユーザーフォームを使用し下記条件でマクロを作成するにはどのようにしたらよいでしょうか。 「日付」、「商品ID」、「数量」のコントロールに入力された内容が、「売上台帳」シートの最終行のひとつ下の行にデータが入力されるイベントプロシージャを次の条件で作成してください。 【作成条件】 ・プロシージャは「入力」コマンドボタンのクリック時のイベントとして作成する ・入力した「日付」の値はA列の最終行のひとつ下に入力する ・入力した「日付」が日付形式でない場合は、"日付は「2015/12/10」のように入力してください。"と メッセージを表示してマクロを中断させる。 ・選択した「商品ID」リストの値はB列の最終行のひとつ下に入力する ・「商品ID」リストが未選択の場合は、"入力する商品リストを選択してください。"とメッセージを表示してマクロを中断させる。 ・C列の最終行のひとつ下に、「商品ID」リストボックスの値とJ列の商品IDと一致する「商品名」を入力する ・D列の最終行のひとつ下に、「商品ID」リストボックスの値とJ列の商品IDと一致する「単価」を入力する ・「数量」に入力した値はE列の最終行のひとつ下に入力する ・「数量」が数値ではない場合は、"数量は「数値」を入力してください。"とメッセージを表示してマクロを中断させる。 ※一部テキスト対象外（数値の判断はIsNumeric関数を使用します。この関数で対象値が数値であるかを検査します。） 記述例）If IsNumeric(●●.Value) = False Then ・F列の最終行のひとつ下に、同じ入力行の「単価」と「数量」の積（単価×数量）を表示する ・その他繰り返し処理のステートメントや条件判断に使用するIf及びSelect Caseステートメントの組み合わせは自由とします。 ・「閉じる」コマンドボタンには、クリック時にユーザフォームを閉じるイベントを作成する ②標準モジュールを挿入して、「入力フォームを開く」名で次のマクロ（プロシージャ）を作成してください。 ・作成したユーザーフォームを表示する
Visual Basicでお絵かきができるアプリケーションを作っています。SAIなどの機能にあるような、アナログなどで水彩を使ったときに筆で色を混ぜ合わせるようなことができる機能をつけたいのですが、どのようなプログラムを作ればよいのか見当もつきません。 どなたかアドバイスをよろしくお願いします。
【Access2010】 クリック時にエラー お世話になっております。 初歩的なものだとは思いますが調べてもわからなかったので質問させて頂きます。Access2010でフォーム上にコマンドボタン("sample")を設置し、 別のフォーム("登録")を開きたいです。 その為、下記のようにコードを記述しました。 Private Sub cmd_sample_Click() On Error GoTo Errors DoCmd.OpenForm "登録" DoCmd.Close acForm, Me.Name Exit Sub Errors: Call VbErrorMsgBox("cmd_Sample_Click") End Sub 上記で問題なく動いていたのですが、他のコードを編集してる際に突然開けなくなってしまいました。 開こうとすると 「実行時エラー'2473' イベントプロパティに指定した式On Menuでエラーが発生しました。 プロシージャの宣言が、イベントまたはプロシージャの定義と一致していません 」 とエラーメッセージが表示されます。 特別こちらの記述を変更した覚えはないのですが… コマンドボタンプロパティの"クリック時"のイベントプロシージャでコードを再記述してみたり、 一度新規データベース作成→元のアクセスをインポートしてみたりなどしたのですが直りません。 どうか宜しくお願い致します。
エクセルマクロの質問です。 エクセルのブックＡに入力フォーム的なシートを作成し、数個のセルにデータを入力します。そのデータを、同じシート内に作成した登録ボタンを押すことでブックＢに転記しようと考えています。 手順としては、 １、Ａを開き、入力シート内の所定のセルへデータを入力し、ボタンを押下。 ２、Ｂが開き、受付情報シートのＢ列２行目から横方向に転記（次回以降は同列３、４・・・行目）。 ３、Ｂを保存し、閉じる。 ４、Ａのシートに入力したデータを削除し、保存し、閉じる。 ア、ブックA名→受付記録票。シート名→入力。 イ、ブックB名→受付記録情報。シート名→受付情報。 以下が私の作成したものです。ボタンを押下してもBが開くところまでしかいきません。。。 Sub 登録_終了() Dim wb As Workbook Dim GYOU As Long wb = ThisWorkbook Workbooks.Open Filename:="C:\Users\5802087\Desktop\受付フォルダ\受付記録情報.xlsx" GYOU = Sheets("受付情報").Range("B65536").End(xlUp).Offset(1, 0).Row Sheets("受付情報").Cells(GYOU, 2).Value = wb.Sheets("入力").Range("D3").Value Sheets("受付情報").Cells(GYOU, 3).Value = wb.Sheets("入力").Range("D5").Value Sheets("受付情報").Cells(GYOU, 4).Value = wb.Sheets("入力").Range("E5").Value Sheets("受付情報").Cells(GYOU, 5).Value = wb.Sheets("入力").Range("F5").Value Sheets("受付情報").Cells(GYOU, 6).Value = wb.Sheets("入力").Range("D7").Value Sheets("受付情報").Cells(GYOU, 7).Value = wb.Sheets("入力").Range("E7").Value Sheets("受付情報").Cells(GYOU, 8).Value = wb.Sheets("入力").Range("F7").Value Sheets("受付情報").Cells(GYOU, 9).Value = wb.Sheets("入力").Range("I7").Value Sheets("受付情報").Cells(GYOU, 10).Value = wb.Sheets("入力").Range("D9").Value Sheets("受付情報").Cells(GYOU, 11).Value = wb.Sheets("入力").Range("I9").Value Sheets("受付情報").Cells(GYOU, 12).Value = wb.Sheets("入力").Range("D11").Value Sheets("受付情報").Cells(GYOU, 13).Value = wb.Sheets("入力").Range("I11").Value Sheets("受付情報").Cells(GYOU, 14).Value = wb.Sheets("入力").Range("D13").Value Sheets("受付情報").Cells(GYOU, 15).Value = wb.Sheets("入力").Range("I13").Value Sheets("受付情報").Cells(GYOU, 16).Value = wb.Sheets("入力").Range("D15").Value Sheets("受付情報").Cells(GYOU, 17).Value = wb.Sheets("入力").Range("I3").Value .Close SaveChanges:=True wb.Activate Range("D3,I3,D5,F5,D7,F7,D9,I9,D11,I11,D13,I13,D15").Select Range("I3").Activate Selection.ClearContents Range("D3").Select .Close SaveChanges:=True End Sub ご教示のほど、よろしくお願いいたします。 その他、ブックBは1か月単位で他のブック（C→8月受付記録情報。D→9月受付記録情報。・・・）とシートではなくブックを変えていく予定です。そのため、ブック名が変わっても転記できるマクロがあれば併せてご教示くださいますよう重ねtお願いいたします。
代入できない理由を教えてください。以下のマクロでブックAの入力シートから、ブックBの受付情報シートへ特定のセルのデータ（数字、文字のみ）を転記したいのですが、できません（同一ブック内で別シートにはできました）。 引数が不正などというエラーメッセージが出て、ブックBが開いた状態で止まります。 なお、ブックは同じフォルダ内に入れ、同一ブックを使い続けます。 Sub 登録_削除() Dim wb1 As Workbook , wb2 As Workbook , ws As Worksheet Dim GYOU As Long Set wb1 = ThisWorkbook Set ws = wb1.Worksheets("入力") Application.ScreenUpdating = False Set wb2 = Workbooks.Open(ThisWorkbook.Path & "\受付記録情報.xlsx" & Filename) With wb2.Sheets("受付情報") GYOU = .Cells(Rows.Count, 2).End(xlUp).Row .Cells("GYOU , 2").Value = ws.Cells("3 , 4").Value .Cells("GYOU , 3").Value = ws.Cells("5 , 4").Value .Cells("GYOU , 4").Value = ws.Cells("5 , 5").Value .Cells("GYOU , 5").Value = ws.Cells("5 , 6").Value .Cells("GYOU , 6").Value = ws.Cells("7 , 4").Value .Cells("GYOU , 7").Value = ws.Cells("7 , 5").Value .Cells("GYOU , 8").Value = ws.Cells("7 , 6").Value .Cells("GYOU , 9").Value = ws.Cells("7 , 9").Value .Cells("GYOU , 10").Value = ws.Cells("9 , 4").Value .Cells("GYOU , 11").Value = ws.Cells("9 , 9").Value .Cells("GYOU , 12").Value = ws.Cells("11 , 4").Value .Cells("GYOU , 13").Value = ws.Cells("11 , 9").Value .Cells("GYOU , 14").Value = ws.Cells("13 , 4").Value .Cells("GYOU , 15").Value = ws.Cells("13 , 9").Value .Cells("GYOU , 16").Value = ws.Cells("15 , 4").Value .Cells("GYOU , 17").Value = ws.Cells("3 , 9").Value End With .Close SaveChanges:=True Application.ScreenUpdating = True wb1.Activate Range("D3,I3,D5,F5,D7,F7,D9,I9,D11,I11,D13,I13,D15").Select Range("I3").Activate Selection.ClearContents Range("D3").Select wb1.Close SaveChanges:=True End Sub
チェックボックスにチェックが入っていたらチェックを外したい FormのTreeviewにチェックボックスが複数あります チェックボックスについているチェックをボタンを押して外したく思います VB.NETで行いたいのですが、ご教授下さい
VBAでループでIPアドレスを記入する方法を教えてください。●「IP一覧」シート ※O～Xまで記載済み O P Q R S T U V W X 1行目 各タイトル名 2行目 10～19 24～24 192～254 32～32 27 10.152.12.200 3行目 10～19 23～23 192～254 64～64 27 10.152.12.200 ... 15行目 10～10 21～21 19～19 32～32 27 10.152.12.200 O列：第1オクテット開始アドレス P列：第1オクテット終了アドレス Q列：第2オクテット開始アドレス R列：第2オクテット終了アドレス S列：第3オクテット開始アドレス T列：第3オクテット終了アドレス U列：第4オクテット開始アドレス V列：第4オクテット終了アドレス W列：プリフィックス値(サブネットマスク) X列：デフォルトゲートウェイ ●「ルーティング設定」シート ※A～Fまで、上記を参照してVBAで自動記入したい A B C D E F 1行目 10 24 36 0 24 10.152.12.200 A列：第1オクテット B列：第2オクテット C列：第3オクテット D列：第4オクテット E列：プリフィックス値(サブネットマスク) F列：デフォルトゲートウェイ
マクロでのオートフィルについて教えて下さい。 ひとつのセルに数字のデータが二つある場合両方数字が加算されるようにするにはどのようにすれば良いでしょうか？ 例えばセルA1に『AB0528.BD388』とあった場合、A2に『AB0529.BD389』……ってなるようにしたいです。 よろしくお願いします。
VBにてExcelファイルの中身をOracleへinsertするプログラムを作成しております。insertする際に、Oracleエラー(number型に varchar2型の値を入れてしまう等)が発生したら、 主キー項目・エラーが存在する項目名・入力値・エラー内容をエラー結果log(Excelファイル)に出力をしたいと思っております。 なお、エラーが発生した際には該当行を無視して次の行にいくようにしようと思っております。 insertを行う部分のロジックは完成いたしましたが、エラーが発生する行の動きについて、 「OracleException」を見つけ、それを使い書き出そうと思いました。 その際、OracleExceptionへは飛ぶのですが、datatableの次の行をNextで呼び出す方法がわからずに苦労しております。 お手数ですが、ご教授いただければと思います。 以下、出力イメージとなります。 ---------------------------------イメージ-------------------------------------------------------------- Table_TEST.xlsx（入力を行うxlsxファイル) AAA【型：number(5,1)】 | BBB(【型：number(5)】 Key | CCC【型：varchaw2(15)】 -------------------------------------------------------------------------------------------------------- 15 | 5 | AAS 15 | 4 | CCC 5641555 | 88888 | SSS ←エラーが発生するもの 12 | 99 | DDD 44 | 11 | QQQ A | 0 | TTT ←エラーが発生するもの 実行を行った結果 エラー結果log BBB | エラーが存在する項目名 | 入力値 | エラー内容 -------------------------------------------------------------------------------------------------------- 88888 | AAA | 5641555 | この列に許容される指定精度より大きな値です 0 | AAA | A | 数値が無効です Table_TESTテーブル（エラーが無い項目を書き込み） AAA【型：number(5,1)】 | BBB(【型：number(5)】 Key | CCC【型：varchaw2(15)】 -------------------------------------------------------------------------------------------------------- 15 | 5 | AAS 15 | 4 | CCC 12 | 99 | DDD 44 | 11 | QQQ ここまで ------------------------------------------------------------------------------------------------------------------------------ 以下、ソース Public Sub dataInsert(ByVal dtb As DataTable) Dim errCount As Integer = 0 Dim oCmd As New OracleCommand Dim oDadap As New OracleDataAdapter Dim oTran As OracleTransaction = oConnection.BeginTransaction Try For id As Integer = 0 To dtb .Rows.Count - 1 Dim sbSQL As New System.Text.StringBuilder sbSQL.AppendLine("insert into テーブル名 values (") For ic As Integer = 0 To dtb .Columns.Count - 1 If (intcountc = 0) Then sbSQL.AppendLine("'" & dtb .Rows(id).Item(ic) & "'") Else sbSQL.AppendLine(",'" & dtb .Rows(id).Item(ic) & "'") End If Next sbSQL.AppendLine(")") (insert） sbSQL = Nothing Next '実行でエラーがなかったため、コミットを実行 oTran.Commit() Catch ex As OracleException ※この部分に、次のNextへ飛ばす方法を記述したい Catch ex As Exception ～以下、省略～. よろしくお願いいたします。
Visual Studioを使って簡単なゲームを作りたいと思っています。 いま私が考えているのはボタンを押すと時間が進んで、8秒ピッタリで止めればクリアという簡単なゲームです。テキストボックスを用意してボタンを押すとテキストボックスのなかに秒数がカウントされ、ボタンを押して「テキストボックス=8秒」となったら「クリア」と表示する。という風に頭の中ではイメージできるのですがプログラム言語がわからないので手が止まってしまいます。 どなたか私に知恵をお貸しください。
VBAについて質問です。会社の業務が少しでも楽になればと思い、ネットサーフィンでつぎはぎのようにユーザーフォームを 作成し、動いたのですが、シートの列を増やしたら動かなくなりました 検索したり、色々考えたりしたのですがどうしてもわからないので質問させていただきました。 Private Sub 入力_Click() Dim fm As Range Dim monthcolum As Long Set fm = Range("A3:R3").Find(textbox1.Value, LookAt:=xlWhole) If fm Is Nothing Then MsgBox "月が正しくありません" Exit Sub Else monthcolum = Range("A3:R3").Find(textbox1.Value, LookAt:=xlWhole).Column ～ setからfindの終わりまでの行について、デバックが出るのですが、範囲が有効ではありません。や 参照が不正です。などその都度変わります。 textbox1に入った数値(月)に完全一致するセルを探して列番号を取得するまでの処理です rangeの範囲をC3:N3からA3:R3に変えたところ、他は触ってないのに動かなくなりました。 見辛い、見苦しい、もっと省略できる等あると思いますがお手柔らかにご教授願います。
シート１のＡ９から下に向かって、１～３１までの数字が順番に入力されています。 休日シートのＡ１から下に向かって、１～３１の数字が入力されています。「シート１のＡ列の数字を、休日シートのＡ列から検索し、 該当セルの右隣のセルが空白でなければ、 シート１の該当行に色を付ける」 という処理をしたいのですが、１のところだけ色がつきません。 また、休日シートの１０の右隣に文字を入れると、 シート１の、１と１０に色がついてしまいます。 どのようにコードを書き変えたら直るでしょうか。 Sub test() Dim i As Long, n As Long, dayoff As Object n = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row Cells.Interior.ColorIndex = 0 For i = 9 To n Set dayoff = Worksheets("休日").Range("A:A").Find(what:=Cells(i, 1)) If Not dayoff Is Nothing Then If dayoff.Offset(0, 1).Value <> "" Then Cells(i, 1).Resize(1, 14).Interior.Color = RGB(192, 192, 192) End If End If Next End Sub
access2016 VBAについて質問です。 ３つのテキストボックスのどれかひとつに値が入った時にボタンを使用可能にしたいのですが、 元となるイベントプロシージャが分かりません。このように書いて、↓ If Me!txt1.Value = Null And Me!txt2.Value = Null And Me!txt3.Value = Null Then Me!btn1.Enabled = False Else Me!btn1.Enabled = True End If フォームの開くとき、読み込み時等に入れてみたのですが上手くいかず… ちなみに、ボタンの設定は初めからFalse、テキストボックスには別のボタンを押すと入力されるようにしています。 よろしくお願いします。
ExcelVBAを使用して、グラフを作成したいと思っています。sheet2のセルに出力されている値を使用してグラフを作成したいのですが、以下の方法で作成すると 項目軸が勝手に１から設定されてしまいます。 項目軸の設定を、セルに入力された値を参照するにはどのようにすれば良いでしょうか？ もしくは、1からでなく0からにする方法はないでしょうか？ どなたかご存知の方、よろしくお願い致します。 k = 0 kVal = k + 4 kLastVal = 4 + kMax With ActiveSheet.ChartObjects.Add(50, 50, 300, 200).Chart .HasTitle = True .ChartType = xlLineMarkers .SetSourceData Source:=Sheets("sheet2").Range(Sheets("sheet2").Cells(168, kVal), Sheets("sheet2").Cells(168, kLastVal)) .Location Where:=xlLocationAsObject, Name:="sheet4" End With
マクロについて質問です。 文字の一部のみを、別ブッグに記入されてるセルの値に変えることは可能でしょうか？ 例えば『あなたのクラスはY0567です』のY0567の部分をセルに記入されてる値に変える感じです。
ruta_aj0104さん たびたび申し訳ありません。 B列には計算式が入っておりまして、そこには別シートから参照している計算式が入っています。このB列の計算式のみのセル（数字が入っていない）を無視したいのですが、頂いた以下のコードでそれに対応するコードに置き換える事は出来ますでしょうか？ With .Range(.Cells(2, 2), .Cells(Rows.Count, 2).End(xlUp)) よろしくお願いします。
VBA初心者です。なぜ Public Sub Test6() Dim result As Long result = MsgBox "You do not have a mind to do it?", vbYesNo + vbExclamation, "caution" If vbYes Then MsgBox "Current Form is closed...." Dim bb As Workbook Set bb = ActiveWorkbook bb.Close Else MsgBox "ok" End If End Sub --------------------------------- なぜLongは長整数型なのに、今回Longを使うのでしょうか。 Msgboxは文字ではないのでしょうか。 Dim result As Long result = MsgBox "You do not have a mind to do it?", vbYesNo + vbExclamation, "caution"
VBA初心者です。メッセージボックスを作成しています。 A、B、Cのボタン3つを作って選択出来る様にしたいです。 以下のコードが間違っています。 ご教示下さい。 __________________________________ Public Sub Test7() Dim result2 As Long MsgBox "What should you confirm in leaving desk?, ["A"], ["B"], ["C"] + vbExclamation, "caution" End Sub __________________________________
RitchTextBox のアンドウ機能を無効化させたいのですが、RitchTextboxオブジェクトで .UndoLimit = 0 の例がMicrosoft MSDNにも掲載されているのですが、Visual studio 2013 Community .Net 4.5 (windows7 32bit )では無いようです。 継承してオーバーライドしなくてはいけないのでしょうか？ 質問の趣旨は Ctrl +Z を無効化するというのではなく、Undo機能によってテキストの書き換えに従ってメモリ使用量が結構な勢いで増え続け、Formをusingで抜けてもメモリの解放ができない.Netの問題に対処したいからです。 よろしくお願いします。
Vbaに関するも問題です。(自分は初心者) どなたでも構いませんので、ご教授願います。 Sheet3に商品表があります、以下の通り。 商品名(A1) 価格(B1) 産地(C1) りんご(A2) 100(B2) インド(C2) みかん(A3) 50(B3) カナダ(C3) ばなな(A4) 75(B4) ロシア(C4) UserFormにはボタン1(検索) テキストボックス1(商品名)、 テキストボックス2(価格)があります、 画像の通り。 結果としてやりたいのは、 商品名のテキストボックス1に商品名いれて、 検索ボタンを押すと価格のテキストボックス2に 価格が自動的に表示されることです。 こういうことは可能なんでしょうか？ もし可能であれば、教えて頂きたいです。 よろしくお願いいたします。
ExcelVBA 初心者です。 UserFormを開いて,TextBoxに文字を入力しボタンを押すとリストボックスに 検索結果が表示される。 現在は、同じブックでないと表示されません。他のブックから参照させたい場合は、 下記のコードの上から6行目のSheet１を変えるのですか？ 例えば、 A「フォルダ」→C「ブック」 B「フォルダ」→D「ブック」 Bの中にDブックがあり、Aの中にあるCブックを参照させたいのですが、 どうすればいいでしょうか？ Private Sub CommandButton1_Click() Application.ScreenUpdating = False Dim lastRow As Long Dim myData, myData2(), myno Dim i As Long, cn As Long With Sheet1 myData = .Range(.Cells(3, 1), .Cells(Rows.Count, 3).End(xlUp)).Value lastRow = .Cells(Rows.Count, 1).End(xlUp).Row End With ReDim myData2(1 To lastRow, 1 To 3) For i = LBound(myData) To UBound(myData) If myData(i, 3) Like "*" & TextBox1.Value & "*" Then cn = cn + 1 myData2(cn, 1) = myData(i, 1) myData2(cn, 2) = myData(i, 2) myData2(cn, 3) = myData(i, 3) End If Next i If cn = 0 Then MsgBox "検索結果は見つかりませんでした・・・" Else End If TextBox1.SetFocus With ListBox1 .ColumnCount = 3 .ColumnWidths = "20;80;100" .List = myData2 End With Application.ScreenUpdating = True End Sub
マクロで、複数のCSVを結合について 複数のCSVファイルを読み込み、特定のシートに結合させたいです。１個目のファイルを読み込み後、その最終行の1行したから2個目を読み込みし結合 ※読み込みは、ファイルの中身になります。 皆様のお力をお貸しください。
マクロで、複数CSVを一括で取り込み方法について教えて下さい。色々調べた結果、以下のコードに行き着いたのですが、 各CSVファイルの2行目～最終行までを取り込むようにしたいのですが、変更点がわかりません。 また、他に良いコードがありましたらご教授願います。 皆様のお力をお貸し下さい。 Sub putCsv() Dim csvFile As Variant Dim fIdx As Integer Dim dCell As String csvFile = Application.GetOpenFilename(FileFilter:="ＣＳＶファイル,*.csv", MultiSelect:=True) If Range("A65536").End(xlUp).Row = 1 Then dCell = "A1" Else dCell = "A" & CStr(Range("A65536").End(xlUp).Row + 1) End If For fIdx = 1 To UBound(csvFile) With ActiveSheet.QueryTables.Add(Connection:="TEXT;" & csvFile(fIdx), Destination:=Range(dCell)) .TextFileCommaDelimiter = True .Refresh BackgroundQuery:=False End With dCell = "A" & CStr(Range("A65536").End(xlUp).Row + 1) Next End Sub
Excel VBA初心者です。 顧客情報のデータベースの集計作業と、 内訳表の出力をVBAを用いて記述したいと 思っているのですが、どのようにしたらよいでしょうか。データベースはエクセル操作に不慣れな複数人が使用するため、 可能な限り細かい操作を減らしてボタン一つにしたいため VBAを用いたいと思っています。 今、ワークブックには２つのシートがあり シート１は集計用のフォームで、 シート２はデータベースになっています。 ＜シート１＞ ※シート１は、A２に期間の始期をB２に期間終期を入力し、 「集計」ボタンを押すと、C２にその期間の合計件数をD2に合計金額を 出力させたいと思っています。 A B C D １ 期間始期 期間終期 合計件数 合計金額 ２ （入力） （入力） （出力） （出力） ＜シート２＞ ※シート２は、A行に識別番号があり、 B列に発注した商品、C列に備考、D列に請求金額、 E列に請求日があります。 A B C D E １ 識別番号 発注商品 備考 請求金額 請求日 ２ ・ ・ ・ ・ ・ ３ ・ ・ ・ ・ ・ やりたいことは、 ①指定した日付（請求日）の期間で（例えば2016/6/1～2016/6/14）、 「集計」ボタンを押すと その件数の合計と金額の合計を シート１の所定の位置（C２とD２）に出す。 ②指定した日付（請求日）の期間で（例えば2016/6/1～2016/6/14）、 「内訳表作成」ボタンを押すと、シート２上にあるその期間の請求日のデータ （識別番号、発注商品、請求金額、請求日）が ”内訳表”というタイトルで、一覧表になってプリントアウトされる。 ただし、この時プリントアウトする表には、 シート２のデータベース上のC列備考を除いたものとなるようにしたい。 また、可能であれば、内訳表のどこかに件数合計と金額の合計も 記載したい。 ②については、 できるのかどうかもよく分かりません…。 このように内訳表をプリントアウトするには、 そもそもワークブックに内訳表フォーマットのシートを あらかじめ作成しておく必要があるのでしょうか。 ご教授よろしくお願い致します。
入力.xlsのユーザーフォームから同じフォルダ内にある平成aa年1月～12月.xlsに入力したいんですけどどうしたらいいですか？ 平成aa年1月～12月.xlsにはメイン、1日～31日までシートがあります。 1日～31日までのシートには項目が1～9まで入力箇所があります。 入力.xlsのユーザーフォームには 平成□年□月 項目1 □ ～ 項目9 □ (登録) みたいな感じであります。 ユーザーフォームから平成□年□月.xlsの1日のシートを開いて入力して保存する事は可能ですか？ またどのようにしたらできますか？
エクセルのVBAについての質問です。標準モジュールに書かれているマクロによって"sheet1"のコードウィンドウに Private Sub test() MsgBox "sample TEST" End Sub というコードを入力させたいと考えています。 どういうプログラムを書けばいいのか、そもそも可能なのかを教えていただけると助かります。 よろしくお願いします。
以下のＶＢＡに加筆したいと思っています。---------------------------------------- If Not IsEmpty(Worksheets("P紙発行指示").Range(生産数位置).Value) And _ Not Worksheets("品マスタ").Cells(wGYO, 5) = 0 Then 画面_生産数 = Worksheets("P紙発行指示").Range(生産数位置).Value P当りケース数 = Worksheets("品マスタ").Cells(wGYO, 5).Value Worksheets("P紙発行指示").Range(P数位置).Value _ = Application.RoundUp(画面_生産数 / P当りケース数, 0) Else Range(P数位置).Value = "0" End If ---------------------------------------------- シートの"P紙発行指示"のP数位置に入る数字に、画面生産数÷ P当りケース数に「＋２」したいと思っています。 「 = Application.RoundUp(画面_生産数 / P当りケース数＋２, 0)」 「 = Application.RoundUp(画面_生産数 / P当りケース数, 0)＋２」 とかやってみましたが、なにも変わりませんでした。 ご教示お願いします。
excel vbaについて質問です。A.xlsmとB.xlsmの指定した2つの場所に書かれている内容が同じなら、 B.xlsmのセルCに書いてある内容をつなげてセルDに表示したいのですが... 例 A.xlsm B.xlsm a | a a | a | 1 |123 a | a a | a | 2 a | a a | a | 3 b | b b | b | 4 |45 b | b b | b | 5 ずっと考えていても全くわからなかったので、ご教授いただけたら嬉しいです。。。 よろしくお願いいたします。
Visual basic 2008 express edition を 使用しており、これであるプロジェクトを作成し、 その中でフォームを作成しました。 フォーム内に、例えば、Label1,Label2,Label3, というNameのコントロールがあるとし、 これらのtextプロパティを、他の変数で指定して変更したいと思っています。 例えば、a = Label1 としたとき、 a.textで出来ないかと思ったら無理でした。 おそらく、Controlsとか使わないといけない ものかなと思っています。 色々調べてはみたのですが、なかなか良い方法が 見つかっていません。 VB初心者でよくわかっておらずすみませんが、 アドバイスお願いします。
複数のエクセルブックを一つのブック内に横方向になるようにまとめたいのですが、そのようなことはできるのでしょうか。たとえばファイル1、ファイル2...の、各ファイルのA1:A10をマクロを使って縦方向に追加していく方法はわかったのですが、各ファイルの列をファイルごとに横方向に並べることはできるのでしょうか。 よろしくお願いします。
Access VBA アクセスからアクセスを閉じるＶＢＡを教えてください。 aaa.mdbとbbb.mdbを同時に開いているとします。bbb.mdbのフォームを読み込むと、aaa.mdbを閉じるＶＢＡを組むことは可能でしょうか。 ご教授宜しくお願い致します。
複数のブックから任意のセルの値を抽出するマクロについて 他の質問を見てどうにか自分で組んでみようと思ったのですが、挫折したためご教授ください。 複数のブックがあり、ブック内には「調査票(1)」、調査票(2)...」というシートが複数あります。(調査票以外のシートもあり、これは抽出の対象外としたい) 調査票シートのA1セルとファイル名、シート名を別のブックに抽出をしたいのですが、VBAに詳しい方に教えていただければと思っています。よろしくお願いします。
VBAの質問です。---------------------一部抜粋--------------------- Sub testIE() Dim objIE As InternetExplorer Set objIE = CreateObject("Internetexplorer.Application") objIE.Visible = True objIE.navigate "http://XXXXXX/" Do While objIE.Busy = True Or objIE.readyState < READYSTATE_COMPLETE DoEvents Loop objIE.Document.getElementById("XXX").innerText ---------------------抜粋終わり--------------------- で、別々のパソコンで上記コードを実行してすると片方では成功し片方ではgetElement部分で 下記エラーが出ます。 vba 実行時エラー -2147467259(80004005)': ＞'document' メソッドは失敗しました 'IWebBrowser2' オブジェクト IEとEXCELのバージョンはどちらも一緒なのですが、どうして結果差が出るのかわかりません。 お手数ですが教えて下さい。
マクロを使って表を抽出して4列に並べる方法を教えてください マクロ初心者です。 画像のように同じシートにある複数の表から抽出して4列に並べるマクロをご教授ください。一応、自分なりにマクロを書いてみたのですが、1列に並べることしか出来なくて困ってます・・・ Sub AlignDataTo1Col() Dim lngRow As Long Dim lngCol As Long Dim strData As String Dim varData As Variant Dim lngLop As Long Dim rngOutPut As Range For lngCol = Selection(1).Column To Selection(Selection.Count).Column For lngRow = Selection(1).Row To Selection(Selection.Count).Row If Not IsEmpty(Cells(lngRow, lngCol).Value) Then strData = strData & vbTab & Cells(lngRow, lngCol).Value End If Next lngRow Next lngCol varData = Split(strData, vbTab) On Error Resume Next Set rngOutPut = Application.InputBox(Prompt:="出力先セルを指定してください。", Type:=8) For lngLop = 1 To UBound(varData) rngOutPut.Offset(lngLop - 1, 3).Value = varData(lngLop) Next End Sub
ExcelVBAについて教えてください。 ブレークポイントでストップ後継続実行するのと、普通に実行するのでは何が違うでしょうか。私のマクロ実行にて後者では表示がバッファ化されてチェンジイベントが即時に反映表示 されません。 前者では常に反映されます。 Win95の頃に作ったマクロですが、Win８からこの現象が出るようになりました。 ご指南いただけますと助かります。
マクロの種類の中に、ＶＢＡ、Ｊａｖａ 等があるのですか。 他に何種類あるのですか。 マクロとプログラミングとは別物ですか。
hageoyaji_2016さん 先日、VBAマクロの件で質問させていただいたsfngm6512です。 先日の件は無事解決しました。 ありがとうござました(^^)。あと、 因みになんですが、DBsheetのA列(PJ_No)は「=」で別のbookの値を参照していますが、そのままテキストボックス1に値を入力しても結果が出ませんでした。関数が入ってるセルの値は検索できないんでしょうか？
VB.NETはオブジェクト指向プログラミング言語でしょうか？＞(少なくとも)1つのオブジェクト指向プログラミング言語でコードを書く という記事を読んで挑戦しようと考えています。 引用元ではC++, Java®, Python®が例にあがっています。
【 VBAマクロについて教えてください 】 こんばんわ、現在とあるマクロを組みたいのですが、つまずいてしまい困っています。 宜しくお願いします。目的はユーザーフォームを利用して、プロジェクトNoを入力すると顧客名等の情報がテキストボックス2～19に表示される様にしたいと思っています。 ユーザーフォームは作成済で、以下の様なマクロを本を見ながら作成してみました。 ですが、DBsheetのA列に入力済のNoを入力しても『該当する案件がありません』とMsgが返ってきます。 何処がどう悪いのか教えて頂ければ幸いです。 【ユーザーフォーム】 ・テキストボックス1 = プロジェクトNo(ここは入力します) ・テキストボックス2 = 顧客名 を表示したい ・テキストボックス3 = ユニット名 を表示したい ・テキストボックス4 = 内容 を表示したい ・ ↓ ・テキストボックス19 = 備考 を表示したい 【DBsheet】 ・A列 = Pj_No. が入力されています ・H列 = 顧客名 が入力されています ・I列 = ユニット名 が入力されています ・J列 = 内容 が入力されています ・H列 = 顧客名 が入力されています ・ ↓ ・V列 = 備考 が入力されています Private Sub CommandButton1_Click() Dim myno As Integer Dim mylastrange As Range, mykekka As Range If TextBox1.Value = "" Then MsgBox "プロジェクトNo.を入力してください。" TextBox1.SetFocus Exit Sub Else myno = TextBox1.Value End If Set mylastrange = Worksheets("DB").Range("A1").End(xlDown) Set mykekka = Worksheets("DB").Range(Range("A2"), mylastrange). _ Find(what:=myno, lookat:=xlWhole) If mykekka Is Nothing Then MsgBox "該当する案件がありません" TextBox1.Value = "" TextBox2.Value = "" TextBox3.Value = "" TextBox4.Value = "" TextBox5.Value = "" TextBox6.Value = "" TextBox7.Value = "" TextBox8.Value = "" TextBox9.Value = "" TextBox10.Value = "" TextBox11.Value = "" TextBox12.Value = "" TextBox13.Value = "" TextBox14.Value = "" TextBox15.Value = "" TextBox16.Value = "" TextBox17.Value = "" TextBox18.Value = "" TextBox19.Value = "" TextBox1.SetFocus Else TextBox2.Value = Cells(mykekka.Row, 2).Value TextBox3.Value = Cells(mykekka.Row, 3).Value TextBox4.Value = Cells(mykekka.Row, 4).Value TextBox5.Value = Cells(mykekka.Row, 5).Value TextBox6.Value = Cells(mykekka.Row, 6).Value TextBox7.Value = Cells(mykekka.Row, 7).Value TextBox8.Value = Cells(mykekka.Row, 8).Value TextBox9.Value = Cells(mykekka.Row, 9).Value TextBox10.Value = Cells(mykekka.Row, 10).Value TextBox11.Value = Cells(mykekka.Row, 11).Value TextBox12.Value = Cells(mykekka.Row, 12).Value TextBox13.Value = Cells(mykekka.Row, 13).Value TextBox14.Value = Cells(mykekka.Row, 14).Value TextBox15.Value = Cells(mykekka.Row, 15).Value TextBox16.Value = Cells(mykekka.Row, 16).Value TextBox17.Value = Cells(mykekka.Row, 17).Value TextBox18.Value = Cells(mykekka.Row, 18).Value TextBox19.Value = Cells(mykekka.Row, 19).Value End If End Sub 以上の内容でご理解いただけるか分かりませんが、まだまだ勉強中の身でありますので、 分かり易く教えて頂ければ幸いです。 宜しくお願い致します。
ｃ++プログラミング初心者です。 画像表示のプログラムを作ろうとしています。 が、画像を表示させるにはどうすればいのでしょうか？ 関数などがあるのでしょうか？一応、構造体、配列など基礎的なことは学校で勉強済みです。 出来れば、OpenCVは使いたくないと思っています。 可能でしたら、サンプルコードなども載せて頂けると嬉しいです。 環境はvisual studio2013で、画像ファイルの形式はbmpです。 よろしくお願いします。
【VBA】シートの移動ではなく、別のファイルのシートにどんどんデータを追加していくマクロを作りたいですが、ご教示をお願いしたい次第です。 重複データがあれば削除、A列を基準に並び変えも合わせてできれば助かります。 （最初はシート自体をコピーするマクロを作ったのですが、コピー元のシートが日々変わることがわかり、データ追加が出来るマクロを知りたいと思った次第です） お手数おかけしますがどうぞよろしくお願いします。 ファイルA：集計結果シート（その他のシートも含まれています） （場所：\\10.1.177.33\本部\各担当）固定 集計結果シート内容 A列ーB列ーC列 名称ー番号ーデータ ファイルB：集計結果シートを読み込むファイル。 (場所：\\10.1.177.33\支店\各担当）
どんなパソコンでも実行できるプログラムを組みたい（Windows OS問わず） ＜実行したい内容＞ 同じネットワーク上のPCからiniファイルを持ってきたり、書き込んだりする。＜現在作ったプログラム＞ HTA（VBS） IE11ではVBScriptは保証されないと見かけました。 インストール不要で、どのパソコンからも実行できるプログラムを組みたいのですが HTA以外になにかありますでしょうか。 USB等で持ち運びでき、WindowsのOS問わずに使えるのが理想です。 UWSCかなぁ…?
エクセル2013 VBA Ｃ列10行目から下に数えて50行以上貼り付けがあった場合、 ”50行を超え○行になっています ”とメッセージが出るようにするにはPrivate Sub Worksheet_Change(ByVal Target As Range) If ActiveCell.Column = 3 Then L = Range("C" & Rows.Count).End(xlUp).Row If L > 50 Then MsgBox "行数が 50行を超え " & L & "行になっています。" End If End Ifと教えて頂いたのですが 質問文が不足していました。（20行に変更しました） Ｃ10～貼り付けた行数が20行を過ぎたら20行を過ぎ、●行ですにしたかったのです。 どのような式に変わるでしょうか。 End Sub
ＶＢＡでの条件検索について 以下の様なエクセルデータがあるとして、［Ａ］列の値が"人"であれば［Ｃ］列に［Ｂ］列の値を返すというコードを教えて下さい。多数のファイルが存在し、ＶＢＡで処理したいと考えています。 それぞれのファイルで行数が増減するので困っています。 よろしくお願いします。 ［Ａ］ ［Ｂ］ ［Ｃ］ －－－－－－－－－－－－－ ［１］｜花 ｜１ ｜ ［２］｜人 ｜１ ｜ ［３］｜犬 ｜２ ｜ ［４］｜人 ｜１ ｜
VBAにて最終行の指定した範囲に罫線（太線）を引きたいです。 最終行はA列には必ず、情報が入るので、A列から参照した最終行でそこからHA列までを 範囲としたいです。Range("A5").End(xlDown).EntireRow.select だと、全行選択した為、 Range("A5:HA5").End(xlDown).select としましたが、ダメでした。 ﾏｸﾛ初心者の為、皆様の知恵を貸して頂ければ、助かります。 何卒宜しくお願い致します。
Ｅｘｃｅｌマクロの回帰分析について Ｅｘｃｅｌ2013 （データ） Ｂ2：Ｌ32 回帰分析をマクロでしたく下記のマクロを組みました。 Dim R1 As String, R2 As String, R3 As StringR1 = "$B$2:$B$32" R2 = "$C$2:$L$32" R3 = "$N$2" Debug.Print R1 Debug.Print R2 Debug.Print R3 Application.Run "ATPVBAEN.XLAM!Regress", ActiveSheet.Range(R1), _ ActiveSheet.Range(R2), False, True, , ActiveSheet.Range(R3) _ , False, False, False, False, , False データが増える（下行に追加）ごとに範囲を参照し指定さしたいのですがうまくできません。説明が下手で申し訳ありません。何か良い方法はありますでしょうか。よろしくお願いします。
下記エクセルのマクロについて教え下さい。 下記のマクロで黄色のセルを数えることはできました。加えて、Gの列に、黄色のセル内に入ってる数字を全て合計するマクロを下記マクロに組み込みたいのですが、どのようなマクロを作ればよいのでしょうか？ マクロについて無知なので、教えて頂きたいです。 Dim xRow As Range, xCnt As Long, i As Long With Range("A1:F5") For Each xRow In .Rows xCnt = 0 With xRow For i = 1 To .Columns.Count - 1 If .Cells(i).Interior.Color = vbYellow Then xCnt = xCnt + 1 End If Next i .Cells(i).Value = Format(xCnt, "###") End With Next xRow End With End Sub
Vbaで下のようなコードを書いたのですが、worksheet…の行でエラーが出ます。しかし、何が悪いのかがわかりません。 教えてください Sub a() MaxRow = Range("A65536").End(xlUp).Row MaxCol = Range("IV1").End(xlToLeft).Column ' IV1=256列 For I = 1 To 9 If Cells(4, I * 4) = "" Then GoTo 10 num = 14 * (I - 1) Worksheets("Sheet1").Range("Cells(1,4+num):Cells(MaxRow,4+num)").Copy Worksheets("Sheet2").Range("Cells(1,MaxCol+2+num):Cells(MaxRow,MaxCol+2+num)") Worksheets("Sheet1").Range("Cells(1,7+num):Cells(MaxRow,7+num)").Copy Worksheets("Sheet2").Range("cells(1,MaxCol+3+num):cells(MaxRow,MaxCol+3+num)") Worksheets("Sheet1").Range("Cells(1,12+num):Cells(MaxRow,15+num)").Copy Worksheets("Sheet2").Range("cells(1,MaxCol+4+num):cells(MaxRow,MaxCol+7+num)") Next I 10 End Sub
nagato_blue_noah様 突然の指名申し訳ありません。vb.netにおいての回答を数多くやられていて、誠に勝手ではありますが nagato_blue_noah様を指名をさせて頂きました。 回答を頂けますと助かります。 TreeviewにCドライブのフォルダ一覧を表示させております。 ルートから全てのフォルダの左横にチェックボックスがあります。 ボタン2をクリックして、チェックボックスにチェックが入っているものを textbox1に表示されているパス名にコピーを行なうプログラムを作成しています。 Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click Dim text As String Dim node As TreeNode text = "" For Each node In TreeView1.Nodes(0).Nodes If node.Checked Then text += node.Text & vbCrLf Else If IsChecked(node) Then text += node.Text & vbCrLf End If End If Next 'チェックボックスにチェックなし If text.Length = 0 Then MessageBox.Show("コピー不可", "警告") Return End If 'チェックボックスにチェックあり If MessageBox.Show("コピーしますか？", "質問", MessageBoxButtons.YesNo, MessageBoxIcon.Information, MessageBoxDefaultButton.Button2) = Windows.Forms.DialogResult.Yes Then Dim FolderFullPath As String Dim folderName As String Try 'チェックボックスにチェックありフォルダをTEXTBOX1のパス名にコピー For i As Integer = 0 To TreeView1.Text.Length 'TREEVIEWのチェックボックスで選択されているフォルダを取得… FolderFullPath = "C:\" + TreeView1.Text.Length folderName = System.IO.Path.GetFileName(FolderFullPath) My.Computer.FileSystem.CopyDirectory(FolderFullPath, Me.TextBox1.Text & "\" & folderName, True) Next MessageBox.Show("コピー終", "通知") 'コピー不可なら Catch ex As Exception MessageBox.Show(ex.Message, "Error",MessageBoxButtons.OK,MessageBoxIcon.Error) MessageBox.Show("コピー×", "通知") End Try '「いいえ」なら ElseIf Windows.Forms.DialogResult.No Then MessageBox.Show("コピーしません", "通知") End If End Sub 上記のコードを実行しますと、string "C:\"から型’DOUBLE’への変換は無効です。 と表示されてしまいます。 ⇒上記メッセージにある「OK」ボタンをクリックしますと、 コピー× と表示されます。 どのようにしたら、エラーメッセージが表示される事無く、コピーを行う事が出来ますでしょうか？ 最後まで読んで下さり、ありがとうございました ご教授下さい。
Excel VBA初心者です。 質問させていただきます。 現在、画像を挿入するボタンを作成しているのですが、 指定した場所に挿入するところまではできました。しかし、サイズが画像によってバラバラです。 サイズを指定したコードを入れたいのですが、どのようにすればいいのかわかりません。 現在のコードを載せます。 Sub 画像挿入() Dim File As String Range("D8").Select File = Application.GetOpenFilename( _ FileFilter:="画像 ,*.jpg; *.gif; *.bmp", MultiSelect:=False) If File <> "False" Then With ActiveSheet.Pictures.Insert(File) .Left = Selection.Left .Top = Selection.Top .Width = Selection.Width .Height = Selection.Height End With End If End Sub 高さが10、幅が13.34としたいです。
見よう見まねで作った下記マクロが”実行時エラー9 インデックスが有効範囲にありま せん。” デバッッグが Worksheets("売上データ読込").Select が黄色 になります。 開いているファイルの中でマクロを実行させると、そのファイルの中の"集計結果シート” のデータをコピーし、別ファイルの”売上データ読込シート”の最終行空白(セル)にデー タを貼り付けていく。内容を作ったつもりでしたが… お手数おかけしますがご教示の程お願いします。 Sub データコピー() ' データコピー Macro Sheets("集計結果").Activate Range("A2").Select Range(Selection, Selection.End(xlToRight)).Select Range(Selection, Selection.End(xlDown)).Select Application.CutCopyMode = False Dim ws As Worksheet Workbooks.Open "\\10.0.177.13\本部\各担当\売上データ\全支店売上データ-20160301.xls*", Password:="abcd@" ThisWorkbook.Activate Set ws = Sheets("売上データ読込").Select ws.Range("B2").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _ SkipBlanks:=False, Transpose:=False Application.CutCopyMode = False End Sub
VBA初心者です。Public Sub Test6() MsgBox "You do not have a mind to do it?", vbYesNo + vbExclamation, "caution" If vbYes Then MsgBox "Current Form is closed...." Dim bb As Workbook Set bb = ActiveWorkbook bb.Close Else MsgBox "ok" End If End Sub オブジェクト変数またはWithブロック変数が設定されていません。 となります。 ご教示下さい。
access2016について質問です。 コントロールウィザードを使ってチェックボックスを３つ作り、 初めは３つともチェックを入れない設定にしました。フォームビューで確認してみると、３つのチェックボックスに灰色の四角が入った状態になっているのですが、これは３つともチェックされていることなのですか？ というのも、チェックを入れるとボタンに名前が入るようにプログラミングしたいのですが、 フォーカス取得後のイベントプロシージャに Private Sub Ctl1号機_GotFocus() Me!btn設定1.Caption = "設定" End Sub と書いたところ、実行するとチェックの中が四角のままでボタンにすでに記入されてしまいました。 直すべきところ等ありましたら教えてください。 よろしくお願いします。
ACCESS2010を利用しています。 WEB上の入力フォームで、郵便番号と電話番号を入力すると、 下記URLのいずれかへたどり着きます。WEB上の情報をACCESSのフォームへ自動で取込たいのです。 ①のURLがない場合は、②のURLからというように、 郵便番号、住所、電話番号をACCESSのフォームへ自動で取込たいのです。 ①URL:https://bb-application.ZZZZ.XXXXXXXX.com/*******/house?checkpoint=o... ②URL:https://bb-application.ZZZZ.XXXXXX.com/********/house ↓ WEBのソース抜粋 <!--JS off の場合--> <div id="address-box"> <div class="formBox ResultBox"> <ul class="clearfix"> <li class="ResArea"> <div class="fs16"> <p>〒XXX-YYYY</p> <p>東京都●●３丁目</p> <p class="Icontel">03-****-1111</p> </div> </li> <li class="IconArea"> <img src="../images/icon_home.png" width="100%"> </li></ul> <p>〒XXX-YYYY</p> <p>東京都●●３丁目</p> <p class="Icontel">03-****-1111</p> を F_入力 の、 <p>〒XXX-YYYY</p>⇒ Me.[郵便番号」 <p>東京都●●区３丁目</p>⇒Me.[住所] <p class="Icontel">03-****-1111</p>⇒Me.[電話番号] 自動で入力したいのです。 WEBで調べたのですが、全然HITしないので困っています。 丸投げなんですが、ご教示いただけないでしょうか？
プロシージャイベントのエラーについて質問です。Windows7 Excel2010です。 以下のコードを実行すると、そのセルの名前のシートにジャンプします。ここまでは良いのですが、このシートは保護がかかっているので、 見た目が空欄になっているダブルクリックしてしまった場合はMsgBoxのエラーメッセージが表示された後に、 「変更しようとしているセルまたはグラフは保護されているため、読み取り専用となっています。 」が表示され、なおかつそのセルに入っている数式の参照先にジャンプしてしまいます。 「変更しようと～」を表示させず、不要なジャンプを避けるにはどういったコードを追加すればよいでしょうか？ よろしくお願い致します。 Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) If Not Application.Intersect(Target, Range("I2:I41,L2:L41,O2:O41,R2:R41")) Is Nothing Then On Error GoTo myError Sheets(ActiveCell.Value).Select Else End If Exit Sub myError: MsgBox "そのシートは使ってません｡ " End Sub
エクセルvbaについての質問です。average関数についてなのですが、 vbaの記録でaverage関数を書いて記録してみたところ Range("I5").Select ActiveCell.FormulaR1C1 = "=AVERAGE(R[-1]C[-3]:R[4]C[-3])" という風になるのですが、 "=AVERAGE(R[-1]C[-3]:R[4]C[-3])" の部分がよくわかりません。 特に R[-1]C[-3]:R[4]C[-3] ここの部分なのですが、R C とは何なのか [ ] 内の規則性やその意味がわからないので詳しく教えてほしいです。 調べてみましたが説明にあたるものがなかったので質問します。 見難くて申し訳ないですが、よろしくお願いします。
いつもお世話になっております。 VBAについて教えてください。 エクセルバージョンは2007です。 下記のようにマクロ処理を行いたい場合、どのようなVBAを組めばよいのでしょうか？お忙しいところ、恐縮ですがご教授いただければ幸いです。 よろしくお願い致します。 ■行いたい処理 デスクトップにある「Change」というフォルダ内にあるxlsファイル名を条件指定して一括変換 下記に例を載せます （例） ・りんご80→80円 ・みかん100→100円 ・なし120→120円 ※上記のような項目が20項目ぐらいあり、フォルダ内に必ずすべてのファイルがあるわけではないので ない項目はスルーするようにしたいです。
Excelのマクロについて教えてください。 1行目に項目が入っており、2行目からはデータとなります。 項目数がA～CZまであります。部署ごとや機種、金額、時期などで必要な項目が違っており、その都度手で並び替え要らない列を削除しており、これを自動化できないかとマクロを調べています。 データの抜粋については、調べてみてできたのですが、必要な項目を選択して、並び替えを行い、それ以外の項目を削除するということは可能でしょうか？ Sheet① 基データ Sheet② 抽出条件欄 Sheet③ 抽出条件を下に抜粋したデータ 現在、ここまでのマクロはできました。 Sheet④ 必要項目の並べ替える順番 必要項目の順番を決めるSheet④を用意して、Sheet③の項目列の順番を変更し、Sheet④に載っていない項目を削除したい。 Sheet③ 抽出データ A | B | C | D | E ~ CZ 1 | 2 | 3 | 4 | 5 ~ 104 あ｜か｜さ｜た｜な ~ ん Sheet④ 必要項目 A D C CZ Sheet③ 結果 結果 A | D | C | CZ 1 | 4 | 3 | 104 あ｜た｜さ｜ん また、必要な項目列が条件の都度違うので、名前の定義などで残る列数を可変にすることは可能でしょうか？ 並べ替え=Sheet④!$A$1:INDEX($E:$E,COUNTA($A:$A)) Sheet④のA列に縦に項目名を入れていけば、項目名の範囲はこれで可変にできるかなと考えたのですが。
Visual Studioを各pcにインストールして各自が１アプリケーションを分担して 開発を行う予定です。（visual basic） 最終的に各自が開発した分を統合した１アプリケーションを 完成させます。 各個人が開発した分を１つに統合させる方法をご教授下さい。 ａ氏 form1 ｂ氏 form２ c氏 form３ ⇒ アプリケーションa form1、form２、form3
教えてください。 毎月、300～400ファイルの処理をしなくてはならず困っています。 テキストファイルをUTF-8で読み込み、エクセルに書き出したいです。テキストファイルはすべて1行から25行の形式で、 そのうち、エクセルに必要な行は、テキストを開いた後4行目と9行目だけを次々に書き込んでいきたいです。 テキストファイルはデスクトップのmonthly フォルダにその月分を入れます。 いろいろ調べて下記コードで試したところ、UTFが指定できずに文字化けしてしまうのと 区切られてしまうので、そのままに取り込みたいです。 そして、可能なら、4行目、9行目の抽出ができたらと思います。 どなたかご教授の程よろしくお願いします。 参考に動作してみたコードは下記です。 Public Sub a_Test() Dim TextLine, MyPath, MyName, prow, dat, i Dim ch As Boolean 'フラグ用 ★ Dim txt As Object 'フォルダーの指定 MyPath = "C:\Users\12345\Desktop\monthly\" MyName = Dir(MyPath & "*.txt", vbNormal) ' 最初のファイル名を返します。 prow = 2 ' 1行目（開始行） Do While MyName <> "" ' ループを開始します。 Open MyPath & MyName For Input As #1 ' ファイルを開きます。 ch = False 'ファイルを開いた直後はフラグを立てない ★ Do While Not EOF(1) ' ファイルの終端までループを繰り返します。 Line Input #1, TextLine ' 行を変数に読み込みます。 ' フラグが立っているなら今までの処理を行なう ★ If ch = True Then '★ 'スペース区切りで分割、配列に保存 dat = Split(Trim(TextLine), " ") ' 開かれているシートに記録する。 For i = 0 To UBound(dat) '1の場所は貼付け列 ActiveSheet.Cells(prow, i + 1) = dat(i) Next prow = prow + 1 ' 次の記録位置へ進める End If ' ★ ' １回目の読み込みが終わったらフラグを立てる ★ ch = True ' ★ Loop Close #1 MyName = Dir ' 次のフアイル名を返します。 Loop End Sub
最近、VBAを勉強しているのですが、下記の文は一体、どのような動きをしているのでしょうか。ーーーーここからーーーーー Dim RS As ADODB.Recordset Dim A() As Object Dim SQL As String Dim Cnt As Integer SQL = SELECT * FROM MSTTable Set RS = New ADODB.Recordset RS.Open SQL, Cn, adOpenStatic, adLockOptimistic ReDim A(RS.Fields.Count - 1) For Cnt = 0 To RS.Fields.Count - 1 Set F(Cnt) = RS.Fields(Cnt) Next Cnt ーーーーここまでーーーーー
メールを受信するExcelマクロを作っています。 BASP21を利用していますが、スマートホンから送ったメールを受信すると文字化けしてしまうのです。 今はできるだけシンプル(下記)に書いています。このマクロを実行すると添付のようになってしまいます。 B列はパソコン(Becky)から送信したメール、C列はスマートホンから送信したメールです。 多分、文字コードの変換をすればいいのだろうと思っているのですが、やり方がわかりません。 BASP21のkconvを使えばいいのかなと思ったのですが、使い方がよくわからず... どなたか教えてください。 ------ Dim bobj, ar, retv Dim Server As String, User As String, Pass As String Dim Command As String, Folder As String, Para As String Dim i As Long, cnt As Long On Error Resume Next Set bobj = CreateObject("basp21") 'BASP21オブジェクト Server = "pop.mail.yahoo.co.jp" 'POP3サーバー User = "xxxxxxx" 'アカウント名 Pass = "xxxxxxx" 'パスワード Command = "SAVEALL" 'コマンド Folder = ThisWorkbook.Path & "\mail" '保存するフォルダ ar = bobj.RcvMail(Server, User, Pass, Command, Folder) If IsArray(ar) Then For i = 0 To UBound(ar) Para = "from:subject:" retv = bobj.ReadMail(ar(i), Para, Folder) If Not IsArray(retv) Then Cells(2, i + 2) = "受信失敗" Set bobj = Nothing Exit Sub Else Cells(2, i + 2) = Mid(retv(0), 7) 'From Cells(4, i + 2) = Mid(retv(1), 10) 'Subject Cells(6, i + 2) = Mid(retv(2), 7) 'Body End If Next Else MsgBox "新着メールはありません", vbInformation End If Set bobj = Nothing -------
【VBA】ある行（２列）又はCell範囲をコピーして、特定のCellに含まれる文字があれば、コピーした行をその上に挿入するというのをやりたいのですが、 うまくいきません。 どうすればよいでしょうか。・・・ご教示の程よろしくお願いします。 使用ソフト：Excel 2013 ───────────────────────── Sub テスト() Dim i As Long i = 1 Do While Worksheets("作業シート").Range("B" & i) <> "" If Cells(i, 10) = "001" Then     Sheets("見出し").Select     Range("A6:AM7").Select     Application.CutCopyMode = False     Selection.Copy   Cells(i, 10).Select   Selection.Insert Shift:=xlUp i = i + 1  End If i = i + 1 Loop End Sub ─────────────────────────
エラーが出ないようにするにはどこを直した方がいいですか? /* ランダム文字列を生成する*/ char *generate_random_string(int length) {static char buffer[101]; /* 配列の定義*/ int a1 = 0,a2 = 0,r; /* 変数の定義*/ char ch,*p; if (length > 100) return NULL; /* エラー*/ a1 = 0;for (ch='a';ch<='z';a1++,ch++){} for (ch='A';ch<='Z';a1++,ch++){} p = malloc(a1);a1 = 0; for (ch='a';ch<='z';a1++,ch++) p[a1] = ch; for (ch='A';ch<='Z';a1++,ch++) p[a1] = ch; memset(buffer,'\0',101); for (a2=0;a2<length;a2++){r = rand() % a1;buffer[a2] = p[r];} free(p); return buffer; /* 返す*/ }
Excel2013を使っています。① 「シート1」の値のみをコピーして貼り付け Sub 貼付け（） With WorkSheet（”Sheet1”）.UsedRange .Value = .Value End With End Sub を教えていただいて使っております。 これを続けて ② ダイアログボックスを表示して、名前をつけて（デスクトップに.Xslmで）保存し、 ③ 「シート1」を保存せずに（式をそのまま残す）終了する。 という流れのマクロを組みたいのですがうまくいきません。 どなたかご教授願います。 マクロは超初心者です、よろしくお願いいたします。
access2016について質問です。 コマンドボタンの名前(表記)を消したいのですが、 Me!bottom1.Caption=Null としてもエラーになってしまいます。名前を消す方法を教えてください。 よろしくお願いします。
エクセルのマクロについて教えてください。 あるブックの中に多数のシートがあります。 そのブックの中の全シートにおいて下記の設定をマクロでしたいと思っています。 3行目以下最終行まで行の高さを34.75にする。 Y列にまばらに文字が入力されているので、その行の高さが34.75以上になるものは行の高さを自動調整する。 どなたかマクロを組んでいただけませんか？ よろしくお願いします。
Accessのフォームで棚札の部分だけエラーになります。エラー要因を教えてください。 Private Sub cmdSelect_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)'------------------------------------------ ' 選択ボタンクリック（マウスアップ） '------------------------------------------ If ReturnForm = "入庫" Then [Forms]![f入庫]![txt商品コード] = Me.コード Form_f入庫.GetSyouhin ReturnForm = "" ElseIf ReturnForm = "出庫" Then [Forms]![f出庫]![txt商品コード] = Me.コード Form_f出庫.GetSyouhin ReturnForm = "" ElseIf ReturnForm = "棚札" Then [Forms]![棚札]![txt商品コード] = Me.コード Form_棚札.GetSyouhin ReturnForm = "" ElseIf ReturnForm = "棚卸" Then [Forms]![f棚卸_入力]![txt商品コード] = Me.コード Form_f棚卸_入力.GetSyouhin ReturnForm = "" Else End If DoCmd.Close End Sub
VBA初心者です。セルA1に[が含まれていたら「文字が正しくありません」というメッセージボックスを表示したいのですが、このとき If Cells(1, 1).Value Like "*[*" Then MsgBox "この文字は正しくありません", vbOKOnly + vbExclamation Exit Sub End If と書くと「パターン文字列が不正です」というエラーメッセージが表示されます。[の前に~をつけたり試しましたがだめでした。ご教授ください。よろしくお願いします。
現在、VB勉強中をしており、DataTableにOracleDataBaseから取得した項目を、 格納したいと思っております。OracleDataBaseから取得した項目について、コンボボックスへ格納することはできるのですが、DataTableに正しく格納されておらず、困っております。 正しく格納されるためには、どの部分を修正すべきなのでしょうか。 お手数ですが、お力を貸していただければと思います。 以下、ソースとなります。 ------------------------------------------------------------------------------------------------------------------ Private Function AA_TABLE_DATA(ByRef dTableAA As DataTable) As Boolean Dim comO As New OracleCommand 'Oracleコマンド Dim datR As OracleDataReader = Nothing 'データリーダー Dim sbSql As New System.Text.StringBuilder 'SQL文 Try 'データベースの設定やSQLの結果を仲介する機能を持ったオブジェクトを代入 comO = oConnection.CreateCommand 'パラメータの指定方法を名前指定に設定 comO .BindByName = True 'パラメーターの初期化 comO .Parameters.Clear() 'カラムを取得する sbSql .AppendLine("Select AA_AA") sbSql .AppendLine(" From AA_Table") sbSql .AppendLine(" Order by AA_SI") 'SQL変換 comO.CommandText = sbSql.ToString 'DBから取得する datR = comO.ExecuteReader() 'カラムを取得できた場合 If datR.HasRows = True Then 'データテーブルに取得したカラムを格納する Do While datR.Read ①：dTableAA .Load(datR) ←このﾊﾟﾀｰﾝだとｴﾗｰになる ②：dTableAA = datR.GetSchemaTable ←このﾊﾟﾀｰﾝだと正しく取得できない(Rowsは一致しているが、Columnsが一致しない←Columnsは固定で21をとってくる) Loop 'カラムを取得できなかった場合 ElseIf datR.HasRows = False Then 'Falseを返す。 Return False End If Catch ex As Exception 'エラーが発生した際、Falseを返す。 Return False End Try '正常に終了したため、Trueを返す。 Return True End Function
VBA初心者です。 エクセル ユーザーフォームでの質問です。 sheet上、VLOOKUP関数で導かれた値があります。これはエクセルファイルと同じフォルダー内の画像ファイル のパス名（またはファイル名）となっています。 フォーム上のテキストボックスに、検索値を入れると sheetでの関数計算がされるところまではできています。 この値から、ユーザーフォームのイメージコントロールへ反映させ 画像を表示するようにすることは可能でしょうか？ プロパティ内でのパス指定では、切り替えができず無理なようでした。 わかる方がいればご教示ください。 よろしくお願いします。
VBAで以下の処理を書きたいのですが、わかりません。シート1のm2.n2.o2をコピーし、 シート2のD6にまとめて表示できるように貼り付け。 これを最終行まで続けたいです。 因みに、次の行はシート1のm3.n3.o3をコピーし、シート2のD7に貼り付けです。 最終行はばらばらです。 よろしくお願いします。
ExcelのVBAにおいて、 A5の背景色をG5～AI5につけたい場合のやり方がわからず、ご教授願いたいです。
VBAでセル値と一致するフォルダを作成し，そこに保存するには… ご覧いただきまして，ありがとうございます。 画像のような値の入力された状態のエクセルブックがあります。以下のようなことを実行するには，どのようなコードになりますでしょうか？ ①A列にある，営業1部，営業2部……という名前のフォルダを作成する。 ②B列にある，KEN，JUN，TARO……という名前のエクセルブックを新規で作成し，①で作成したフォルダ内に保存する。保存する場合には，KENならば営業1部，JUNならば営業２部というように，それぞれのA列のセル値に一致するフォルダに保存する。 よろしくお願いいたします。
エクセルのVBAについて質問です。 在庫管理表を作成しています。A ＿＿＿＿＿＿B＿＿＿C にんじん＿＿＿冷凍＿＿ キャベツ＿＿＿生＿＿＿90001 ピーマン＿＿＿冷凍＿＿ にんじん＿＿＿生＿＿＿90002 にんじん＿＿＿生＿＿＿90002 キャベツ ＿＿＿生＿＿＿90001 空白 ＿＿＿＿＿＿＿＿空白 Aに同様の品が複数存在し、なおかつBが「生」であった場合、Cにグループナンバーを9000１番から連番で振って行きたいと思います。表は6行目から始まります。 キャベツ(生)はグループ90001、にんじん(生)はグループ90002、単品しか在庫が無い場合はCは空白、といった具合です。 VBAにて記述を行う場合はどのように書けば良いでしょうか？
VBA 初心者です。Access VBAについて教えてください。 Accessのフォームにボタンを設置し、そこから外部accdbの 選択クエリを実行するように設定しました。下記コードで選択クエリの実行はできるのですが、 フォームを設定している側のウィンドの後ろに 実行した選択クエリ側のウィンドが隠れてしまいます。 選択クエリ側の画面を前面表示するには、どうしたらよいですか？ 宜しくお願い致します。 Private Sub コマンド1_Click() Dim App As Access.Application Dim AppNm As Variant Set App = CreateObject("Access.Application") AppNm = "外部ファイルのパス名" DoCmd.SetWarnings False App.OpenCurrentDatabase (AppNm) App.DoCmd.OpenQuery "クエリ名" App.UserControl = True DoCmd.SetWarnings True End Sub
Visual Studio(VB)についての質問です。 「Form2のpicturebox1に画像が表示されていないとき」をif構文で表現したいのですが、うまくいかずに困っています。以下は自分で考えたプログラムです。 ・If Form2.PictureBox1.image = Nothing Then ・If Form2.PictureBox1 Is Nothing Then どちらもエラーが出てしまいました。 また、「Form2のTextBox1に”あ”と書かれたとき」を、同じようにif構文で表現するときは、 If Form2.TextBox1.text Like "[あ]" Ｔhen でよいのでしょうか。 どうか、添削をよろしくお願いいたします。
VBA初心者です。A3からA33まで1から31数字があり、B3からB33まで日月火水木金土とあります。 Dim sName As String sName = Cells(3,1) & "(" & Cells(3,2) & ")" Sheets(7).Name = sName Dim sName1 As String sName = Cells(4,1) & "(" & Cells(4,2) & ")" Sheets(8).Name = sName1 Dim sName2 As String sName = Cells(5,1) & "(" & Cells(5,2) & ")" Sheets(9).Name = sName2 ...etc とどんどん書いてしまっています。 7から37番目までのシート名を1(日)etcとしていきたいです。 同じ表現を繰り返してしまっているので、短い表現でコードを書きたいです。 ご教示下さい。
ﾕｰｻﾞｰﾌｫｰﾑ1でﾃｷｽﾄﾎﾞｯｸｽ1~5に 入力した値をListﾎﾞｯｸｽに表示させたい。例えば textbox1=A,textbox2=B,textbox3=C・・・ と入力されたら、 A B C D E のように順に横方向一列に表示させるようにしたいです。 どのようにすればいいですか。
エクセルVBAでマクロ有効シートをコピーして新しいブックを作るマクロを組みました。一見コピーが上手く行った様に見えるのですが、コピー後のシートで「コンパイルエラー」となってしまいます。 VBAでマクロ有効シートをコピーする事は出来るのでしょうか？
既に開いているIEより画像(jpg)をVBAによりダウンロードする方法についてお教えください。 取得ターゲットとしているHTMLの画像ソースはは以下の通りです。「http://sample.jpg」に画像があるので、この画像をダウンロードしたいのです。 <div class="abcde"> <img src="http://sample.jpg" width="240px" height="180px" class="abcde" /> そこで、以下のようなVBAを作成したのですが、画像を取得できる場合もあればできない場合もあり、全く原因がわからない状態ですので、ぜひ原因や解決方法をご教示いただければと思います。 Sub sample() Dim objIE As InternetExplorer Dim objShell As Object, objWin As Object 'Shellオブジェクトを作成する Set objShell = CreateObject("Shell.Application") For Each objWin In objShell.Windows 'Shellオブジェクトを作成する Set objShell = CreateObject("Shell.Application") If objWin.Name = "Internet Explorer" Then 'InternetExplorerオブジェクトをセット Set objIE = objWin '画像URL取得 imgURL = objIE.document.images(25).src '画像ファイル名 fileName = Mid(imgURL, InStrRev(imgURL, "/") + 1) '画像保存先(+画像ファイル名） savePath = ActiveWorkbook.Path & "\image\" & fileName 'キャッシュクリア cacheDel = DeleteUrlCacheEntry(imgURL) '画像ダウンロード result = URLDownloadToFile(0, imgURL, savePath, 0, 0) Exit For End If Next End Sub
エクセルのVBAについて質問です A B あ 1 あ 2 い 3 う 4 空白 以上のように、A列に文字が記載されていた場合、空白行に到達するまでB列に連番をふっていくようVBAにて記述を行いたいと思います。 どのような式を書けば良いでしょうか？
VBAやマクロなどを利用してMS Access2016で作成したファイルをAccess2013で開いたり修正したりしても大丈夫でしょうか？○○○○○.accdb のファイル形式です。 修正というのはデータの新規追加、修正も含めVBAのプログラム修正などもです。 ちょっと試してみましたらAccess2016で開いて見た方で参照設定に自動でExcel16が入ってしまっていてAccess2013で開いた時に1回エラーがでました。その参照設定を切ったらうまく動いていますが不安です。 そもそも参照設定でExcelを指定しなくてはいけないときはどんなときなのでしょうか？ 色々な環境で開いたりしなくてはいけないのですが、ライセンスの関係上2016と2013が共存してしまっています。 ご教授いただければありがたいです。宜しくお願いします。
エクセルの色分けについて教えてください。 おせわになります。 エクセル２０１３の環境です。 Ｃ列 と Ｄ列に、数字が入力されています。各行ごとに、 Ｃ列の値 ＞ Ｄ列の値 であれば、Ｃ列の文字を青に、 Ｃ列の値 ＜ Ｄ列の値 であれば、Ｄ列の文字を赤に、 したいです。 同じシート上で、上記の様な色分けを、もう数列作りたいです。 （Ｇ列とＨ列、Ｋ列とＬ列も同様に） 色分け設定を、任意の列に貼り付ける方法も、合わせて教えて頂きたいです。 ベストアンサーのお礼を、コイン２５０枚でお願いします。 よろしくお願い致します！！
excelマクロの写真挿入を複数挿入したい。 お世話になります。下記のコードがあり、アクティブセルの列を抽出して、 その列の４行目～２２行目（結合セルのD4～I22等）に、 セルサイズに合わせて、画像挿入できるようにしてあります。 が、添付写真のように横にスライドして、複数写真を 貼り付けようとすると、新たに貼り付けられるのですが、 前に貼り付けた写真を削除してしまいます。 そこで、前に貼り付けた写真をそのまま残し、 新たに写真を貼り付けていくようにしたいのですが、 可能でしょうか？ 削除に関するDeleteの項目を削除してみたのですが、 サイズが変わったりして、うまく行きませんでした。 お詳しい方、よろしくお願い致します。 Private Sub CommandButton1_Click() On Error GoTo haru ActiveSheet.Shapes("pic1").Select Selection.Delete haru: 'セル範囲 Set scel = Range(Cells(4, ActiveCell.Column), Cells(22, ActiveCell.Column)) scel.Select x = ActiveCell.Column y = ActiveCell.Row x2 = Selection.Width y2 = Selection.Height fname = Application.GetOpenFilename _ ("画像ファイル,*.gif;*.jpg;*.bmp", 1, "画像ファイルを指定して下さい") If fname = False Then Application.ScreenUpdating = True fname = ActiveWorkbook.Path & "\no_photo.jpg" With ActiveSheet.Pictures.Insert(Filename:=fname) .CopyPicture .Delete End With ActiveSheet.Paste Selection.Name = "pic1" Set 画像 = ActiveSheet.Shapes("pic1") With 画像 ' .LockAspectRatio = False .LockAspectRatio = True '比率変換 .Placement = xlFreeFloating .ScaleHeight 1, True .ScaleWidth 1, True .Left = Cells(y, x).Left .Top = Cells(y, x).Top .Width = x2 .Height = y2 End With Exit Sub End If Application.ScreenUpdating = True With ActiveSheet.Pictures.Insert(Filename:=fname) .CopyPicture .Delete End With ActiveSheet.Paste Selection.Name = "pic1" Set 画像 = ActiveSheet.Shapes("pic1") With 画像 ' .LockAspectRatio = False .LockAspectRatio = True '比率変換 .Placement = xlFreeFloating .ScaleHeight 1, True .ScaleWidth 1, True .Left = Cells(y, x).Left .Top = Cells(y, x).Top .Width = x2 .Height = y2 End With End Sub
ExcelVBAのコンボボックスの連動について質問させて下さい。 コンボボックスを4つ作り、それぞれ段階を経て連動させたいと思っているのですが、知識不足で、どうすればいいのかわかりません。コンボボックスに表示させるデータは、Sheet1のデータからピボットテーブルで抽出？したものです（つまりSheet2）。画像はピボットテーブルのサンプルです。ピボットテーブルにしたのは、Sheet1へ入力するデータの種類がこれからも増えるので、「データの更新」を使えたら便利だなあと思ったからです。 ComboBox1に「1」を入れた時、ComboBox2には「イ」と「ロ」のみを表示させ、続くComboBox3には、「あ」、「い」、「う」を表示し、ComboBox4には、「あ」の時には「a」のみを、「い」の時には「b」のみを、「う」の時には「c」のみを表示させたいんです。 Change()を使えばいいらしいことはわかったのですが、色々とサンプルコードを真似てみても、うまく行きません。 できれば、コードの書き方を教えて下さい。 状況説明が下手ですみません。
有償のメール送受信コンポーネントを探しています。BASP21というフリーのコンポーネントを使用して、Excelからメールの送受信を行う事はできます。非常に便利なコンポーネントで愛用していました。ただ、会社で使う案件があり、フリーのコンポーネントは使用できません。Excel/Access/VBなどで利用できる有償のメール送受信コンポーネントを探しているのですが、見つかりません。 グレープシティのSecure iNetSuite for .NETが使えるかと思ったのですが、Excel/Accessからは利用できないみたいです。 何かオススメの有償のメール送信コンポーネントがありましたら、ご紹介お願い致します。
下記のようにファイルの再計算が完了したらmsgboxを出すというマクロを作っているのですが、Do while の条件式である Workbooks("xxxxx.xlsm").Sheets("xxxx")〜.Sheets("xxxx").Range("yy").Value のところで”型が一致しません”というエラーが出ます。当該箇所はファイルがちゃんと再計算されているのであれば、みたされる条件であり、再計算が終わっていることをたしかめる条件式として使っています。（外部リンクを含む重いファイルで何度か再計算がおこなわれないと数値が不完全になるためCalculateイベントプロシージャーは避けました） 変数などはなにも使っておらず、ブック名からシート名にいたるまで実際の名前を直接うっているため、型が一致しないと言われている意味がわかりません。どこがおかしいのかご教示いただけませんでしょうか。よろしくお願いいたします。 Sub OutPut() Application.Calculate Do While Workbooks("xxxxx.xlsm").Sheets("xxxx").Range("xx").Value = "#VALUE!" And Workbooks("aaaaa.xlsm").Sheets("aaaa").Range("aa").Value <> Workbooks("xxxxx.xlsm").Sheets("xxxx").Range("yy").Value Application.Calculate Loop MsgBox "終了" End Sub
Excel VBAです。 L列に何か入力されたら、N列の背景の色を無くすイベントを発生させたいのですが 上手くいきません。よろしくお願いします。 Private Sub Worksheet_Change(ByVal TargetAs Range) Dim SSH As Worksheet Dim R As Range, tr As Range Set SSH = Sheets("Start") Set tr = SSH.Range("N13:N10000") On Error GoTo er: Application.EnableEvents = False For Each R In Target If Not Intersect(R, RirekiSH.Range("L13:L10000")) Is Nothing Then R.Offset(0, 2).Interior.ColorIndex = xlNone End If myNext: Next R Application.EnableEvents = True Exit Sub er: R.Offset(0, 2).Interior.ColorIndex = xlNone Resume myNext End Sub
Visual Basic 神経衰弱について 今プログラミングの授業でVisual Basicを使って、 ゲームを作る取り組みをしています。私は神経衰弱にし、制限時間内に全てのカード(20枚くらい)を取るゲームを作りたいと考えています。 しかし、私はプログラミングが苦手で全く何をすればいいのか分かりません。 どなたか教えていただけませんか...； 宜しくお願い致します。
visual studio2015でちゃんと合っているはずなのに沢山のエラーがでてきますそういう場合どうすればいいですか？ 拡張とかって関係あるのですか？
いつもお世話になっております。 VBAについて教えてください。 下記に状況と行いたいことを記載しております。 お忙しいところきょうしゅくですが、ぜひご教授ください。以上、よろしくお願い致します。 ■状況 ・ファイル名、sample1～sample10.xlsがデスクトップのsample_allというフォルダの中にあります。 ・各エクセルファイルはシートが1つでa～L列まで1行目にデータ名（a～Lと記入されている）、2行目以降にデータが入っています。 ・別のエクセルファイルでシート名をsample1～sample10まであり、sample1～sample5までは１行目のa～c列にa列から"a" "f" "L"と記載されている。 ・sample6～sample10までは１行目のa～d列にa" "f" "L" ”d"と記載されている。 ・excel verは2007です。 ■行いたい処理 ・別excelでマクロ実行し、各シートごとに処理を行い、シート名とファイル名（拡張子以外）が同じファイルを参照して処理を行う ・a～c or d列までの1行目に記載されている文字と同じ文字を各sample*の1行目で検索し同じものを別excelの2行目以降に貼り付け ・それを各シートで処理を行う
VBAについての分かりやすい本を探しています。どういうのがいいですか？初心者です。
エクセルVBAで空白以外があったら特定のセルにコピーするマクロ 以下のようなマクロをボタンで作りたいのですがどうすればいいでしょうか？K列に文字が入っていたらその文字をコピーし、F列に[値として貼り付け] (K列が空白の場合は行わない) ↓ F列に既に何か文字があればG列に[値として貼り付け] ↓ G列に既に何か文字があればH列に[値として貼り付け] ↓ H列に既に何か文字があればI列に[値として貼り付け] シートは全て同じSheet1内です。 ようするに空白があればFに入れたくて空白でなかったらG、ということです。 毎日3000行ほどあって手作業じゃきついのでマクロでどうすればいいでしょうか？
EXCELのVBAで教えていただけたらと思います。 EXCEL2010にて一つのシート(A～Ｊ列)が100行あります。シート 案内表 35行コピーして貼り付け シート 案内表2 36行目から35行分貼り付け シート 案内表3 71行目から35行分貼り付け ・ ・ ・ ・ という感じで、最終行まで処理を行いのですが 構文の書き方がわかりません。。。。 教えていただけませんでしょうか。
Excel VBAのコードのまとめ方についてお願いいたします。現在マクロの同じ命令文をコピーしてシート名を変えて複数実行させているのですが、 これらをまとめたいのですが、 例となるコードをいただければ幸いですが、 何と検索すれば手がかりになるページいけるでしょうか？ 詳しい方ご教示いただけないでしょうか？ よろしくお願いいたします。 使用コード Columns("H:H").Select ActiveWorkbook.Worksheets("sheet1").Sort.SortFields.Clear ActiveWorkbook.Worksheets("sheet1").Sort.SortFields.Add Key:=Range("H1"), _ SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal With ActiveWorkbook.Worksheets("sheet1").Sort .SetRange Range("A1:AN997") .Header = xlNo .MatchCase = False .Orientation = xlTopToBottom .SortMethod = xlPinYin .Apply End With
Excel vbaについて質問です。何回やってもうまく動きません。 A列(名前) B列 (9:00) C列(10:00) : : : とこのように、A1に名前 B1に時間C1に時間が あってB1よりもC1の時間が大きいと名前のA1の 背景色を変えるというマクロを試しているのですか 、うまく動きません。 全部で1500行あります。 今回は条件付き書式とかではなく vbaでやりたいのですが 単純に B1 <C1だと時間はくらべられないのでしょうか？ 本当に初心者ですいません。 どなたかご教授お願いします。
プログラミングのことで教えてください。(Visual Basic .Net) Windowsアプリケーションの開発で変数名やコーディングのことについてですが、例えばあるテーブル(列数が20前後)にInsertするとき皆さんはどういう風にInsert処理されるのでしょうか。コントロールボックスやデータグリッドからの値をInsertするときは一旦、どんな変数名をつけて行うのか知りたいのです。 例えば、 ①テーブルの列名と同じ変数に一旦、代入して、それをInsertする。 ②テーブル名と同じ構造体を作成し、SET関数も記述して構造体名のメンバを使い、Insertする。 など・・・。 なるべく綺麗なコーディングで実用的な方法を知りたいのです。変数名の付け方とか苦手なので困っています。よろしくお願いします。
EXCEL VBAでデータ最終行の１行下に入力する方法は？①A列に『果物』を手入力します。（りんご、みかん、すいか等） ②B列は出荷日を『月の一番最初の日』のみ『CTRL＋れ』でパソコン上の日付（DATE）を入力します。 ③C列は『曜日』をTEXT関数で表示させます。 ④D列は産地をA列とF列：G列のデータをVLOOKUPで一致させるとします。 画面どおり、6月21日（火）のデータが９行目まで入力されていますが、 9行目以降は翌日以降のデータが入る形式です。 以下をVBAで作成する方法をご教授お願いします。 A列のみ果物名を入力したら、B列（パソコン上の日付）、C列（B列の曜日）、D列（果物の産地）をF列：G列のVLOOKUPでヒットさせる。 尚、弊社は土日が休日なので6月24日（金）の次の日の日付は6月27日（月）が来るようにしたいです。 理想は、翌月の最初の出荷日、例えば来る7月の１日は金曜なのでB列2行目にパソコン上の 日付を持ってきて、7月1日のA列に入力された果物名が5行だったとすれば、その５行分すべて A列からD列のデータが入るようにしたいです。 お教え願います。
先日セル内に「翌土曜日」の日付を挿入するマクロを こちらでご教授いただきましたが、今回はその日付を シートのタブ名にも使いたいと思い、以下のような マクロを組みました。しかし、日付が 2016/6/25 の ように / を含んでいるのでタブには使用できないのか うまく表示できません（マクロ自体おかしいのか？） たしか ・ は使えると思いますので 2016・6・25 もしくは 6月25日 と表示させるマクロを ご教授願えませんでしょうか。 あるボタン（下の例ならテストという名のボタン）を クリックするとこれらの動作が行えるようにしたいと 思っています。 よろしくお願いいたします。 ----------------------------------------------- Sub テスト() Call fun1 Call fun2 End Sub Sub fun1() Sheet2.Copy Before:=Sheet9 ActiveSheet.Range("A1").Value = Int(Now()) + (8 - Weekday(Now(), vbSaturday)) End Sub Sub fun2() ActiveSheet.Name = Range("A1").Value End Sub
VBA ワークシートチェンジイベントで、空白時は処理しない。 エクセル2007です。 http://sp.okwave.jp/qa/q4670496.html 似たような質問をみつけ、実施しましたが、このコードは一つのセルを消す場合にしか対応しておらず、複数のセルを消す場合、型が一致しません。のエラーが出てしまいます。 （バックスペース、デリートどちらを入れてもイベントを発生させたくありません。） 複数の場合でも処理しないコードを教えてください。 セルには数字、文字のどちらとも入力します。 '--------------------------------------------------- Private Sub Worksheet_Change(ByVal Target As Range) If Target.Value = "" Then Exit Sub ーー通常処理ーー End Sub '---------------------------------------------------
vbaでのマクロの質問です。初心者なので当然と思われることを聞いているかも知れず申し訳ないですが、仕事上必要で質問させていただきます。 同じ行にある列同士の足し算(D8=F8+G8、D9=F9+G9...)をあるところからあるところまで繰り返す(8から18まで)。 このようなマクロを組むときにはどのようにすれば良いでしょうか。 Private Sub push2() Dim i As Integer For i = 9 to 18 Range("G&i") = Range("D&i") + Range("F&i" ) Next End Sub これではエラーが出てしまいます。 現在は家でテストとしてリブレオフィスでvbaを使っていますが、月曜日にはExcel2003で実行したいと考えています。 よろしければ御教示お願いします！
あらかじめ、クリックしたら丸の記号が出るようにしてあります。 さらに、これを丸がついているところの行と同じ平仮名（あいうえお）が自動で、横にカンマでリストで出てくるようにしていきたいのです。この方法を教えていただきたいです。
複数のエクセルファイルから同じセルのデータを抜き出す方法を教えてください。 VBA初心者です。 仕事上でたくさんのファイルから一気にデータを抜き出したいです。本やネットを見ながらやってみたのですが、なかなかうまくいかず困っています。 同じフォルダの中に300ほどのエクセルファイルがあります すべてに同じ名前のシートが3つずつあり、Sheet1以外は非表示になっています。 新しいブックに300のエクセルファイルから A列にファイル名を B列に”売上”という名前のシートのE1セルにある数値を抜き出したいです どなたか教えていただけないでしょうか。 宜しくお願い致します。
私がしたいことは、Amazon から〔親カテゴリー〕/〔子カテゴリー〕/〔孫カテゴリー〕/〔ひ孫カテゴリー〕•••までの検索カテゴリー項目だけをExcelシートに抽出したいです。 例) ベビー・おもちゃ・ホビー/おもちゃ/プラモデル・模型/飛行機・ヘリコプター 商品名までは必要なく、商品検索結果で100件未満になるまでのカテゴリー名のみを抽出しデータをまとめたいと思っています。 こういったことはVBAを駆使して可能でしょうか？ 私はプログラミングはまったくわかりません。 どなたか分かる方がいらっしゃればお答えいただけますでしょうか？ よろしくお願いします。
Visual Studioについての質問です。授業で「基礎からきちんと知りたい人のVisual Basicプログラミング入門」 という本を使って予習して、授業に望まないといけないのですが、 P.25にあるコンソールアプリケーションのページに書いてあることがわかりません。 具体的には、 「開発者コマンドプロント for VS2015」でコンソールアプリケーションをコンパイルする、 と書いてあるのですが、 そもそも初心者なのでコンパイルという言葉などがわかりません。 記述式は、 Module Module1 Sub main() Console.WriteLine("こんにちは！") End Sub End module です。 これをテキストファイルに保存してコンパイルしろと書いてあるのですが… 正直、どういう作業をすればいいのかわかりません。 どうすればコンパイルできるのか、 具体的な流れを初心者にもわかりやすく説明していただけると助かります。 よろしくお願いします。
Excelのマクロに詳しい方、ご教授頂きたいです。作業の進捗状況を書き込む表でマクロを使用しているのですが、着手や完了の遅延をセルに表示したいと思っています。 以下、条件です。 ・着手遅延している場合、Pセルに遅延日数を表示。 ・L列は着手予定日、R列は作業段階を書き込むセル。「未着手」の場合に遅延日数を計算。 ・表の一番下、「Exit」の表記までループさせる。 現在書き込んでいる内容が以下です。 読みにくいのと、初心者なので色々あるかと思いますが… Sub Test () Dim 行 As Long Dim D As Variant Dim Today Today = Now D = Application.WorksheetFunction.NetworkDays(Range("L" & 行).Today) Do If Range("L" & 行) <>"" And _ Range("L" & 行) < Today And _ Range("R" & 行).Value = "未着手" Then Range("P" & 行) = D Else Range("P" & 行) = "" End If 行 = 行+1 If Range("P" & 行).Value="Exit" Then Exit Do Loop End Sub これだと「D = Application.Worksheet…」の部分と、If文のところでエラーが出てしまいます。 どなたか詳しい方、アドバイスをお願い致します。
どなたかわかる方、ご教授願います。 ＶＢＡを使用して、勤務表を作成したいと思います。 1 日勤勤務回数を均等に指定する。２ 勤務の種類は、Ａ・Ｂ・Ｃ・Ｄ 3 平日はＡが２人、Ｂが３人、Ｃが２人、Ｄが1人。 4 土曜は、Ａが２人、Ｂが1人、Ｃが1人、Ｄが1人。日曜日は休み。 5 Ｄの勤務は、上から1番目か2番目の従業員を指定するようにする。 6 連続6日勤務にならないように指定していく。 7 従業員数は、１１名。 対応できる方がいらっしゃるのなら、ご教授願いたいです。
エクセルで２つのＷＥＢページの好きな部分を比較して表示させたい マクロが全く分からないのですが、 Workbookに下記コードで作ったのですがＷＥＢページ上の好きなところだけを表示させて ２つのページを同時に表示させたいです。 各行、どんなことをしているのかも教えて頂けると嬉しいです。 Private Sub Workbook_Open() Dim Sh As Worksheet Const ShName = "CM_Page" Const URL = "http://www.google.co.jp/" Dim WebB As Object If TypeName(Evaluate(ShName & "!A1")) = "Range" Then Set Sh = Sheets(ShName) Else Set Sh = Worksheets.Add Sh.Name = ShName End If Sh.Move Before:=Sheets(1) Sheets(2).Activate If Sh.OLEObjects.Count > 0 Then Sh.OLEObjects("WebBrowser1").Visible = True Sh.OLEObjects("WebBrowser1").Object.Navigate URL Else Sh.Cells.Delete Set WebB = Sh.OLEObjects.Add(ClassType:="Shell.Chrome", Link:=False, _ DisplayAsIcon:=False, Left:=Sh.Range("AA1").Left, Top:=15, Width:=800, Height:=600) WebB.ShapeRange.LockAspectRatio = msoTrue WebB.ShapeRange.Width = 800 WebB.Visible = True WebB.Object.Navigate URL End If Sheets(1).Activate Set WebB = Nothing Set Sh = Nothing End Sub
PC環境がWin7⇒Win10に変わった事により、エクセルに設定していた以下のマクロがエラーになり困っております。あるデータベースから情報を引っ張ってくるという内容なのですが、 DBにアクセスができず デバックすると 以下の部分で引っかかっています ＞myCat.CREATE "Provider=Microsoft.Jet.OLEDB.4.0;" & "Data Source=" & myFile & ";Jet OLEDB:Engine Type=5;" 大変お手数ですが、どなたかご教示をいただけないでしょうか。 なにとぞよろしくお願いいたしますm(__)m -------------------------------------------------------------------------------------------------------------------- Sub SQLDB作成() Dim myCon As Object, myRS As Object, myCat As Object Dim myTbl As Object, myIdx As Object Set myCat = CreateObject("ADOX.Catalog") Dim myFile As String myFile = "C:\db2000.mdb" If Dir("C:\db2000.mdb") <> "" Then Kill myFile myCat.CREATE "Provider=Microsoft.Jet.OLEDB.4.0;" & "Data Source=" & myFile & ";Jet OLEDB:Engine Type=5;" Set myTbl = CreateObject("ADOX.Table") myTbl.Name = "商品マスタ"
excelVBAで因数分解的な計算。 ある数Xを入力すると、X=10×a+9×b+8×c+7×d+6×e+5×f+4×gの形になる、abcdefgを導き出すにはどうすればよいでしょうか？入力する数値Xは常に偶数で、10以上です。 求める結果は、a、b、c・・・の順に優先で、fやgを使わずに済むならそのほうが良いです。 例えば、 X=100→a=10。 X=98→a=9、b=1。 X=102→a=9、e=2。 X=104→a=9、c=2。 という答えを知りたい。 複数の組み合わせがある場合は、なるべく少ない種類にまとめ、なおかつ極力gを0にする。 このような解答を出すことは可能でしょうか？
エクセル2010です。 関数でできるものかどうかもわからない素人ですが、どなたかわかる方がいたら教えて下さい。 下の左表のように1～3の数字を足して平均を出すと475でした。この時、475を別のシートで作った右表の範囲で見ると Ａランクの450に該当するので左の表の太枠の中には D4にはＡ、Ｅ4には450と表示される、、、、 なんて難しいでしょうか？
データベース追加処理が出来ませんでしたとは何でしょうか？
ｖｂａについての質問します ① マスターシートには、3列のデータあります。管理番号を使って、検索の機能でその行を探して、マスターシートのNｏが書いてあるセルを取得します。②その取得したマスターシートのNｏ検索を掛けて、その結果をリストボックスに、２列表示されます。 その動作が出来ました。 しかし、リストボックスの内容に、同じ内容が追加されました。 私は、初期化の内容で、検索をして、結果を表示して欲しいのですが そのような動きが、出来るコードが教えて下さい。 よろしくお願いします。 NO 日付 品Ｎｏ 品種 1 4月1日 1 あさ 2 4月2日 2 いす 理想的な動き リストボックス あさ １９９２ いす ２０００ ←選択する いう ２００２ うす ２０００ コード Public 行 As Integer Private Sub CommandButton1_Click() Dim 検索 As Long Dim st1 As Worksheet, st2 As Worksheet Dim rng As Range Dim w As Variant Dim r As Long Dim a As Long With Worksheets("入力部") 検索 = TextBox1.Text 行 = .Range("A:A").Find(検索).Row a = .Cells(行, 4) End With With Worksheets("マスターシート") For r = 2 To .Range("A65536").End(xlUp).Row If CStr(.Cells(r, "A").Value) = a Then ListBox1.AddItem .Cells(r, "A").Value ListBox1.List(Me.ListBox1.ListCount - 1, 1) = .Cells(r, "B").Value ListBox1.List(Me.ListBox1.ListCount - 1, 2) = .Cells(r, "C").Value End If Next r End With End Sub Private Sub UserForm_Initialize() Dim lRow As Long Dim myData With Worksheets("マスターシート") lRow = .Range("A" & Rows.Count).End(xlUp).Row myData = .Range(.Cells(2, 1), .Cells(lRow, 3)).Value End With With ListBox1 .ColumnCount = 3 .ColumnWidths = "0;50;50" .List = myData このコートを実行すると リストボックス あさ １９９２ いす ２０００ いう ２００２ うす ２０００ いす ２０００ ←同じ内容が追加します。
エクセルのマクロについて質問です。 sheet1には Ａ列1行目から 【キー】 Ｂ列1行目から 【番号】 があり、キーを入力するとＢ列の番号が自動表示されるマクロを作ろうとしています。. sheet2（元データ）には Ａ列1行目から 【テキスト】 P1Q2 R3S4 R5U4 V7W8 X9Y0 Z1Y0 Ｂ列の1行目から 【キー】 あいうえおabc かきくけこdef かきくけこdef たちつてとjkl なにぬねのmno なにぬねのmno Ｃ列の1行目から 【番号】 1-2-3 4-5-6 7-8-9 10-11-12 13-14-15 16-17-18 があります。 たとえば、Sheet1のＡ列の【キー】にVLOOKUPマクロで、「あいうえおabc」と入力したら、 Ｂ列には「1-2-3」と表示される。 ここで問題があり、 sheet2のＢ列の【キー】でダブっているのがあるので、 Ａ列の【テキスト】の情報からＣ列の【番号】を得ることに困っています。 たとえば、「かきくけこdef」がダブっているので、VLOOKUPでやると、 先の情報の4-5-6しか引っかからないことになります。 なので、【キー】で、「かきくけこdef」のときは、 【テキスト】の中に「3S」が含まれていたら、【番号】は、4-5-6と表示し、 「5U」が含まれていたら、7-8-9と表示する、という方法がわかりません。 普通に関数でやれば良いのでしょうが、日々の作業の効率化を考えたら、 マクロでボタン一つクリックしたら出来ると楽だと思い、質問させていただきました。 また、キーが同じでテキストの一部で判断し、番号を得る、という条件が何十個とあり、 IF関数だとめちゃくちゃ長い数式となってしまいます。 マクロ初心者の私にどうかお力添え、よろしくお願いします。 (windows7使用）
EXCEL2010 ファイル間のセルのコピペを教えてもらったのですが 改めて実行したら、コピー元ワークシート 部分で、エラーになってしまいます。 理由が見つからず、どこがいけないのでしょうか。ファイル名、シート名は見直して、間違っていないのですが Sub Macro510_コピペ1() Dim tbl As Variant Dim i As Long Dim SrcWs As Worksheet Dim DstWs As Worksheet 'コピーする列を対で定義します tbl = Array( _ "F", "B", _ "AF", "C", _ "AS", "D", _ "AY", "E") 'コピー元のワークシート Set SrcWs = Workbooks("CS.xlsx").Worksheets("Sheet1") 'コピー先のワークシート Set DstWs = Workbooks("kyu01.xlsx").Worksheets("sheet1") 'テーブルから２つおきに処理します For i = LBound(tbl) To UBound(tbl) Step 2 'コピー元の列の２行目から最終行までをコピー SrcWs.Range(tbl(i) & "2", SrcWs.Range(tbl(i) & Rows.Count).End(xlUp)).Copy 'コピー先の列の２行目以下に貼り付けます DstWs.Range(tbl(i + 1) & "2").PasteSpecial Paste:=xlPasteValues Application.CutCopyMode = False Next End Sub
エクセルのマクロについて マクロ初心者です。 IF条件についてですが、 A列を2行目から最終行まで検索し、 A列が全て0ならば処理しない。A列に0以外の文字が入力されていれば処理する という条件文はそのような記載になるかご教授いただけますでしょうか。 何卒よろしくお願い申し上げます。
Excel VBA バックアップファイルを別のフォルダに保存 ファイルの保存時にバックアップファイル(*.xlk)を作成するように設定し、下記のように終了しています。Sub 保存して終了() ActiveWorkbook.Save Application.Quit End Sub バックアップファイルが*.xlsmファイルを保存する同じフォルダに保存されてしまいます。 別のフォルダに保存したいのですが、どのようにコードを書けばよいのか教えてください。
VBAのコントロールで使うイベントマクロについて。 イベントマクロなど、ＶＢＡ側で設定されている関数に、新たに変数を設定することはできないでしょうか。
１つのセル内の、特定の箇所だけを削除するには？A列に、下記のような文言を入力しているとします。 １行目 zdfioewhoihwoih/●●芸術館へ依頼するのですが</a> ２行目 qFhqFefheohfihi/●●貨物をレンタルするか。</a> ３行目 hzihefoizihzfhf/●●冷蔵庫と洗濯好機だけ。</a> ・ ・ ・ （１００行分を入力しているとします） 上記の【●●】の箇所から一番右の【</a>】までの 文言だけを削除したいと思っています。 最終的にA列には、下記のように、 英字/の箇所だけが残っている状態にしたいのです。 hzihefoizihzfhf/ hzihefoizihzfhf/ hzihefoizihzfhf/ ・ ・ ・ このような結果を得るには、B列に どのような計算式を入力すればよいのでしょうか？ よろしくお願いいたします。
フォルダ自動作成について （VB.NET）Private Sub Button3_Click(sender As System.Object, e As System.EventArgs) Handles Button3.Click System.IO.Directory.CreateDirectory("TEXTBOX2.Hoge") MessageBox.Show("作成終了") End Sub 上記を実行すると、作成終了とメッセージ表示されますが、 TEXTBOX2のパス名にHogeフォルダが作成されていません。 行ないたい事としては、下記になります TEXTBOX2にパス名（C:\）が表示されていて、 その直下にTESTというフォルダを自動作成したく思います 作成後、メッセージで作成しましたと表示致したく思います 仮に、パス名（C:\）の直下にTESTというフォルダがあれば、 メッセージで存在していますと表示致したく思います パス名ですが、C:\だけではなく、USBメモリなどのドライブレターの表示もあります ご教授下さい
VBA A列に文字がある時にC列に数式を入れたいです。 その他、条件がありまして、 ①Ａ列に文字があった場合、Ｂ列の最下行より2行下にＡ列に文字がある行のみの合計を表示する。②Ａ列に文字があった場合、Ｃ列に①の合計÷Ｂ列の値を表示する。 です。 行数は変わりますが、 図の黄色塗つぶし青線は入れたい数式の例です。 赤線は今回求めいたい結果です。 何卒コードのご教授をお願いします。 下記のコードでは、Ｃ列にＳＵＭ関数は入りますが、他は全くできません。 宜しくお願いします。 For R = 1 To Cells(Rows.Count, "A").End(xlUp).Row If Cells(R, "A").Value <> "" Then Cells(R, "C").Value = "=SUM"
ＥｘｃｅｌのＶＢＡについて質問です。 初心者ですみません…。①№1チェックボックスAにチェックを入れた場合、№1チェックボックスBが選択出来なくなり№1リスト（日付入力用）は表示しない ②№1チェックボックスBにチェックを入れた場合、№1チェックボックスAが選択出来なくなり №1リストが表示される →下記の内容で№1に関してはうまくいっていますが、№1～№100まであります コピペで№100までやれば出来るのですが簡略化出来ないでしょうか？ Private Sub №1チェックA_Click() If №1チェックA.Value = True Then №1チェックB.Enabled = False №1リスト.Visible = False Else №1チェックB.Enabled = True End If End Sub Private Sub №1チェックB_Click() If №1チェックB.Value = True Then №1リスト.Visible = True №1チェックA.Enabled = False Else №1リスト.Visible = False №1リスト = Clear №1チェックA.Enabled = True End If End Sub
VBA初心者の学生です。 今回線形補間のVBAを作成しようとしているのですがどうしてもできなくて、教えていただきたいです。 実験データをX、Y。その実験データXからX'に線形補間で5倍数で抽出。（ただし5.6などは5の倍数と見ず、5.0、10.0のみ抽出）実験データYからY'に線形補間でX’の5倍数の時のYを抽出してほしいです。 よろしくお願いします。 （X） （Y） （X') （Y') 2.8 3 3.5 7 4.2 11 5.6 18 6.6 24 8.4 39 11 78 13 132 14 127 15 143 17 159 18 175 19 191 21 207 22 223 24 239 25 255 26 272 28 288 29 304
エクセル2010です。 ボタンにマクロを登録し、押下することで別シートへデータを転記したいですがうまくいきません。 やりたいことは、1つのブック内に日ごとのシートがあり、そのシートにそれぞれボタンを配置します。データは日によって異なります。 転記したいデータは、A4とB9からｋ9、日によっては、A4とB12からK12、A4とB15からK15・・・と、A4以外はBからKｎ間で行が9から42まで3行おきにあります。 以下のマクロでやると、9行目しか転記されません。Do WhileやForでもやってみましたが、動作すらしません。 どなたかご教示くださいますようよろしくお願いします。 Sub 登録() gyou = Sheets("受付情報").Range("B65536").End(xlUp).Offset(1, 0).Row Sheets("受付情報").Cells(gyou, 2).Value = Range(4,1).Value Sheets("受付情報").Cells(gyou, 3).Value = Range(9,2).Value Sheets("受付情報").Cells(gyou, 4).Value = Range(9,3).Value Sheets("受付情報").Cells(gyou, 5).Value = Range(9,4).Value Sheets("受付情報").Cells(gyou, 6).Value = Range(9,5).Value Sheets("受付情報").Cells(gyou, 7).Value = Range(9,8).Value Sheets("受付情報").Cells(gyou, 8).Value = Range(9,9).Value Sheets("受付情報").Cells(gyou, 9).Value = Range(9,10).Value Sheets("受付情報").Cells(gyou, 10).Value = Range(9,11).Value gyou = Sheets("受付情報").Range("B65536").End(xlUp).Offset(1, 0).Row Sheets("受付情報").Cells(gyou, 2).Value = Range(4,1).Value Sheets("受付情報").Cells(gyou, 3).Value = Range(12,2).Value Sheets("受付情報").Cells(gyou, 4).Value = Range(12,3).Value Sheets("受付情報").Cells(gyou, 5).Value = Range(12,4).Value Sheets("受付情報").Cells(gyou, 6).Value = Range(12,5).Value Sheets("受付情報").Cells(gyou, 7).Value = Range(12,8).Value Sheets("受付情報").Cells(gyou, 8).Value = Range(12,9).Value Sheets("受付情報").Cells(gyou, 9).Value = Range(12,10).Value Sheets("受付情報").Cells(gyou, 10).Value = Range(12,11).Value (以降、行数だけを変更) End Sub
以前にこちらのコードを教えていただきました。 一つ教えてください。 4行目の columns(1),0 は、どのような意味を持ちますか？実際は、A3の2つ隣の数字を読みたかったので、columns(0),2 で入力しなおしたのですが、反応しませんでした。 間違っていますか？ Sub sample() Dim i With Workbooks("Book2.xlsx").Worksheets("Sheet2") i = Application.Match(Range("A3").Value, .Columns(1), 0) If Not IsError(i) Then .Cells(i, 2).Value = Range("B4").Value End If End With End Sub
VBAでフォーム内のLabel文字色を変更したいです。 複数のLabelの色を変更したいので、 下記のようにコードを書きたいのですが、 小生の環境（Office2010ProSP2)ではLabelクラスが読み込めないようです。 Function Red(label As Label) As Label With label .ForeColor = vbRed End With Set Red = label End Function Labelクラスを参照するには、 参照設定でどのライブラリを追加したらよいのでしょうか？
VBA 集計結果印刷前の体裁（表項目）について教えてください。 都内警察署に提出する書類を作成しています。sheet1には A1”連番”□ B1”担当署”□ C1”会社名”□ D1”住所”□□ □□□□←項目名 A2 □□1□□□赤坂署 □□㈱ホンダ □□千代田区霞が関 □□←データ ｜ ｜ 最下行 です。 sheet2にはマクロでつかう警察署と住所の割り当てデータがあります。 実際に警察署に提出する際には、他にも色々な項目（時間やら許可番号やら） を載せて提出しなければなりません。 例えばマクロでsheet1をsheet3にまるまる転記する際、1行目から5行目に対して セルを結合したり、幅を調整したりしながら必要項目を自動で書き込み、6行目以降に sheet1のデータを転記する方法はあるのでしょうか？ ちなみに、sheet1は4列（A～D）を使用していますが、Sheet3は12列を結合しながら 体裁を整えなければならない見込みです。 また、全く違う良い方法はあるものなのでしょうか？ 宜しくお願いします。
Excel VBAについての質問です。 別エクセル(A.xlsm)のAセルとメインエ クセル(B.xlsm)のAセルの文字が同じかど うかを判定し、 合っていれば別エクセル(A.xlsm)のC,D列 をメインエクセル(B.xlsm)のF,G列にコ ピーするのは どのようにコーディングしたら良いでしょうか？ 例 A.xlsm B.xlsm A A 123 123 文字が一致したので A.xlsm B.xlsm C D F G 12 67 12 67 123 89 123 89 難しいとは思いますが、お時間に余裕がございましたらご教授いただけると幸いです...。 よろしくお願い致します。
ＶＢＡについての質問です Sub 星の表示() Dim i As Integer, n As Integer n=10 For i=1 To nDebug.print Format(i,"00")&String(i,"*") Next i End Sub これをDo~LOOP文に書き換えたいのですがどうすればいいでしょうか？
ＶＢＡについての質問です 成績判定のコードを書きたいのですが、行き詰りました ここからどうすればいいですか？Sub 反復型成績判定 Dim X As Variant X=Array(60,82,87,50,56,86,89,76,58,68 Dim hantei As Variant hantei=Array("不可","可","良","優") Dim h As Integer Const N As Integer=10 Dim i As Integer Dim tokuten As Integer For i=1 To N tokuten=X(i-1) 可(60)良(70)優(80)秀(90)の基準です！
Excel VBAの質問です。 現在VBAを勉強に中なのですが、 空白が出るまでコピーをループする処理をどうコーディングすればいいのかわかりません。 例 A B 1 1 2 23 3 4 4 5 6 よろしくお願い致します。
エクセルの関数について、以前回答をいただきましてありがとうございました。http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1216007102... 実際にデータを作成し検証したみたところ、期待通り動作しないケースがございました。 数式のどの部分が誤動作しているのか、私には高度過ぎて理解できなかったので教えていただけないでしょうか。 ■2列目のデータ上に空白が存在している場合【③1列目に完全一致するが、2列目に一致するものがない場合】の動作をしないようです(画像参照) ■中でもCountifの数式の使用方法が通常と違い理解できなかったので、教えていただきたいです ■最終的にはセルの範囲指定ではなくて列名でデータ参照できるようテーブルを使用したいのですが可能でしょうか？ ■【⑤C5:C8の範囲内が全て埋まっていて、なおかつC2の住所がその範囲内にない場合】については空白データは必ず存在するため、想定から外していただいても大丈夫です。 (入力BOXには1・2ともに空白の場合は存在しませんが、実際のデータ上で検索テーブルに2列目が空白の場合が複数存在します(2列目の入力値が一致しないケース)) 説明が下手で申し訳ないですが、ご教授よろしくお願い致します。
ファイル名の前に直上フォルダ名を追記したい 前提条件としてこのような構成になっています。x:\y\1\aaa.mp4 x:\y\2\bbb.mp4 これを下記のようにしたいのです x:\y\1\1aaa.mp4 x:\y\2\2bbb.mp4 これが上記で言うyフォルダ配下に約300フォルダあります。 手動じゃとても捌ききれません。 batファイルなどでまとめて処理できませんでしょうか？
教えてください。 エクセルのシートに入力フォーム的なものを作成し、以下のことをしようと考えています。ブックAのシートにボタンを作成しセルにデータを入力し、ボタンを押すことでそのデータをブックBに転記しブックBを閉じ、ブックAのデータを消去しブックAを閉じる。 以下のマクロを作成したのですが、うまくいきません（ブックBが存在しないというメッセージが出ます）。 どなたかご教示のほどお願いします。 ブックA→受付記録票。シート名→入力 ブックB→受付記録情報。シート名→受付情報 ブックA、B、ともに同じフォルダ内。 Sub 転記後消去() Dim wb1 As Workbook, wb2 As Workbook Dim cpath As String Dim Sh1 As Worksheet, Sh2 As Worksheet Dim lRow As Long Application.ScreenUpdating = False Set wb1 = ThisWorkbook Set Sh1 = wb1.Worksheets("入力") cpath = "C:\Users\0087\Desktop\受付フォルダ" Set wb2 = Workbooks.Open(cpath & "データ.xlsx") '○○は実際の別ブック名を設定 Set Sh2 = wb2.Worksheets("受付情報") lRow = Sh2.Range("B" & Rows.Count).End(xlUp).row wb1.Activate Sh1.Range("D3:F3,D5,E5,F5,D7,E7,F7,D9:E9,I9,D11:E11,I11,D13:F13,I13,D15:I19,I3").copy wb2.Activate Sh2.Range("B" & lRow + 1).PasteSpecial Application.CutCopyMode = False Application.ScreenUpdating = True ActiveWorkbook.Save ActiveWindow.Close wb1.Activate Range("D3:F3,I3,D5,F5,D7,F7,D9:E9,I9,D11:E11,I11,D13:F13,I13,D15:I19").Select Range("I3").Activate Selection.ClearContents Range("D3:F3").Select ActiveWorkbook.Save ActiveWindow.Close End Sub なお、前回質問した際にご教示くださった方々、お礼の返事方法が分からず大変申し訳ありませんでした。
エクセルを使って、シート上での「種類選択」と「数値入力」を元にした図形を描画し、その作成した図形を表示させる方法について教えてください。エクセル2007を利用していますが、エクセルのシート上で、セルに必要な数値を入れて、それを基にして図形を描画して、図形の形状・状態を見える（形の雰囲気が分かる）ようにするためにどうしたらよいか、というのが質問の主訴です。 このエクセルで、数値などの情報をもとに図形を生成し、表示できるような指示を組み込みたいのですが、そのやり方の方法がわかりません。 マクロのプログラムそのもの自体についても分かってはいないレベルではあるのですが、どうにかこの図形作成を実行したいです。 なお、図形の描画に必要とする基礎となるデータとしては、 図形の種類｛物体の形状｝（パネルとか、バーとか、アングルとか、パイプとか、ボックスとか、ボールとか、いろいろ）の選択、 それぞれの図形の形状に沿った、必要なサイズ情報の数値（縦・高さ、横・幅・間口、奥行き、高さ、半径・直径、円周の長さ、球体の表面積、とか色々）の入力 です。 そこからデータを引っ張ってきて、図形を描画・作成したものを表示するようにする風でという目標ですが、どうすればいいでしょうか。 繰り返しになりますが、最終的なゴールとしては、エクセルのセル上の情報をもとに、図形を表示できるようにすることです。 図形の作成と表示は、１個だけ出せればいいというのではなく、百個単位で非常に多くの図形を任意で作成し、その表示を目で見てで確認が出来るという風にしたいです。 もちろん、一度に表示される図形は、１個ずつで大丈夫です。 1対1対応で順番に見られるというように。 一気に出るのではなく、１個ずつ表示できて、行を変えてくと、その行の入力データ情報の内容に合った図形が表示できるようにしたいです。 なお、図形作成の仕様の詳細としては、選択した形状がたとえば「ボックス（箱・直方体）」で、入れた数値が、たとえば高さ１０００ｍｍ／横幅１０００ｍｍ／奥行き４０００ｍｍとすると、図形の表示は、長い箱状の直方体が表示されるように出来るようになっていると、OKです。 表示先は、別のシートでも、別のウインドウでも、とにかく視覚的に見られるようになれば、OKです。 実行するボタンなどを作ってそれを押すと表示とかの仕様でいいのですが、マクロ等詳しくなく、ご教示願いたい次第です。 この問題はどうすれば解決できますでしょうか？ お詳しい方のご協力、宜しくお願い申し上げます。
こんにちわ。 TEMP\TESTフォルダに作成されたファイル全部を、 タイムスタンプ付フォルダを作成して、 そちらに移動するバッチファイルを作っています。フォルダ作成はできるのですが、そのファイルを移動できません。 何が間違っているのでしょうか？ ご教示下さい。 （以下ソース） ～～～～～～～～～～～～～～～～～～～～～ set dateStr=%date:/=% set timeStr=%time::=% set timeStr=%timeStr:.=% set timeStr=%timeStr: =% set DEST="C:\Users\USER01\Desktop\" set SOURCE="C:\temp\test\" set nowdir=%DEST%%dateStr%%timeStr% mkdir %dateStr%%timeStr% %DEST% move %SOURCE%* %nowdir%
エクセルＶＢＡで質問です。 複数ワークシートがあるのですが左から4番目以降のシートを すべて削除させたいのですが、コードのご教授をお願いします。 よろしくお願いします。
アプリケーションの定義及びオブジェクト定義のエラーがでます。原因がいまいち分からないので、どなたか教えていただけないでしょうか。問題の部分ははSet a = Workbooks("H28受注業務.xlsx").Worksheets("業務マスター").Range(Cells(1, 1), .Cells(e, 3))の部分です。Rangeの複数選択がうまくいっていないようです。 E1はＣＯＵＮＴＡで空白で無いセルを習得しています。 Option Explicit Private Sub workbook_open() Dim n As Range Dim a As Variant Dim b As Variant Dim c As Variant Dim d As Variant Dim e Set n = Worksheets("原本").Range("E2") Worksheets("業務マスター").Activate Cells.Select Selection.ClearContents Workbooks.Open Filename:="Z:\【作業明細書】\H28受注業務.xlsx" e = Workbooks("H28受注業務.xlsx").Worksheets("業務マスター").Range("E1").Value Set a = Workbooks("H28受注業務.xlsx").Worksheets("業務マスター").Range(Cells(1, 1), .Cells(10, 3)) Set b = Workbooks("H28作業明細書【" & n & "】.xlsm").Worksheets("業務マスター").Range("a1") Set c = Workbooks("H28受注業務.xlsx").Worksheets("委託元マスター").UsedRange Set d = Workbooks("H28作業明細書【" & n & "】.xlsm").Worksheets("委託元マスター").Range("A1") Application.DisplayAlerts = False a.Copy (b) Application.DisplayAlerts = False c.Copy (d) Set a = Nothing Set c = Nothing Workbooks("H28受注業務.xlsx").Close Worksheets("作業明細個人 " & Month(Date) & "月").Activate End Sub
”実行時エラー1004 アプリケーション定義またはオブジェクト定義のエラーです。 と、下記を実行するとエラーが出て、” ActiveSheet.Name = nameRng”の部分がデバックで黄色くなります。考えられる原因はなんでしょうか？ 今まで使っていたマクロで他の部分をを削除しただけなのですが、それが原因なのでしょうか？（ちなみFor~Next) 何卒、よろしくお願いします。 Dim sumMeasFile As String '売上合計ファイル Dim measFile As String 'ファイル Dim shCount1 As Integer 'ファイルシート数 Dim nameRng As String '会社名 Dim dayRng As Object '日付のセル Dim valRng As Object '計量値のセル ~中略~ '*** 各会社ごとデータ行列入れ替え For j = 1 To shCount1 Worksheets.Add after:=Worksheets(Sheets.Count) ActiveSheet.Name = Workbooks(measFile).Worksheets(j).Name '*** 各データファイルの日付,値のセル設定 With Workbooks(measFile).Worksheets(j) Select Case areaID Case 1 nameRng = .Name Set dayRng = .Range("E3").End(xlToRight) '日付 Set valRng = .Range("E5").SpecialCells(xlLastCell) '値の範囲 Case 2 nameRng = .Name Set dayRng = .Range("E3").End(xlToRight) '日付 Set valRng = .Range("E5").SpecialCells(xlLastCell) '値の範囲 End Select End With '*** シート名とB1を会社名に *** For plantNo = 1 To UBound(plantData, 1) If plantData(plantNo, 13) & plantData(plantNo, 24) = areaID & nameRng Then nameRng = plantData(plantNo, 3) End If Next plantNo ActiveSheet.Name = nameRng ’●ここがエラーになる Range("B1") = nameRng Range("B3:B33") = WorksheetFunction.Transpose(dayRng) Range("C3:AX33") = WorksheetFunction.Transpose(valRng) '*** 合計入力 *** Range("B34") = "月計" Range("C34") = "=sum(C3:C33)" Range("C34").Copy Range("C34:AY34") Range("AY3") = "=sum(C3:AX3)" Range("AY3").Copy Range("AY3:AY33") Range("A1").Activate Next j
エクセルのＶＢＡのListBoxについて。 Dim arr as Variant arr=ListBox1.List として配列にリストボックスの値を入れたときのことです。Option Base 1 を宣言していても、UBound(arr)が要素数よりひとつ小さくなります。 これはこのような仕様なのでしょうか。 できればUBound(arr)が要素数と一致すると助かるのですが…。
【VBA 小数点の数字】VBAでデータコピー＆ペースとをした際、元データと貼り付け後の小数点の桁数がおかしく、その後の計算で誤差がでて困っております。 例） ●元データ： 7.73（表示・数式バーに出ている数字同じ、実際の数字は小数点第二位もしくは第一位まで) ●貼り付け先：表示→7.73 数式バーに表示される数字→7.730000288745 と表示されます。単なるコピペにもかかわらず、元々の数字通りに貼り付けさせるにはど うしたら良いでしょうか？ 下記のマクロの前後に何か追加、修正して、この問題が解消できればありがたいです。（このマクロがあまりに長く、どこに何を手を加えてよいのかわからないため…） どうぞよろしくお願いします。 ********************** Dim i As Integer, j As Integer, k As Integer Dim day2Str As String '月末日文字列 Dim spot(31, 14) As Single ' 価格データ '*** 価格入力 *** For i = 1 To Right(day2Str, 2) * 1 For j = 1 To 14 Cells(i + 100, j + 20) = spot(i, j) Next j Next i
マクロでExcelのデータからcsvに変換する処理を行っています。 A列にのみ不規則にセルの中に複数行記入してあり、その行を分解し出力したいんですが、可能でしょうか？ 隣の列のデータはひとつしかないですが、分解し出力した際には同じ内容を出力したいです。 ぜひお力添えお願いします。
アクセス初心者です。 助けてください＞＜ 画像にあるようなデータの状態から当日までの販売新記録のデータを作りたいです。（商品番号ごとに、日付の日から過去20160105までの間に一番販売数が多い数字を出したいです。） ※実際にはもっと大量のデータがあるのでアクセスでうまくできる方法を探しています＞＜ データ型は 日付：数値型 商品番号：数値型 商品：テキスト型 販売数：数値型 です。 どなたかわかる方、教えてください＞＜ （求めるデータはコレです↓） 日付 当日までの販売数新記録 20160105 10 20160105 9 20160105 11 20160106 9 20160106 12 20160108 10 20160108 11 20160108 16
Visual Studio2008のコンパイルエラーについての質問です。助けてください(´；ω；｀)※ソース、メソット名は伏せ字にしています。 エラー 1 現在、プロジェクトには、XXyyyy の複数のバージョンへの参照、バージョン 0.4.0.10911 への直接的な参照、および (' aaaaaaa.bbbb. XXaaaa. XXaaaaMain ' を経由する) バージョン 0.4.0.20101 への直接的な参照が含まれています。 XXyyy のバージョン 0.4.0.20101 (またはそれ以降)を使用するには、直接的な参照を変更してください。 D:¥aaaa…省略…¥sauce¥XXaaaaMain.vb 37 23 XXyyyy 恥ずかしながら私はVisual Studioを使用したことが殆どなく、どういう手順で操作を行えば解消できるか記載して頂けると非常に助かります…
VBAの画面がこんなになってしまい戻せません。初期の画面に戻すにはどうすればいいでしょうか？
VBAの一部の操作が不要になり削除修正し実行したところ、【コンパイルエラー：Nextに対応するForがありません】と表示"Next i”がブルーになりました（●印がエラー部分です）Forに対してNextはあるはずなので原因が分からず、長くて申し訳ないですが、どうぞよろしくお願いします。 （下記はPrivateSubでDimもあり、長い為省略） ******** For areaID = 1 To 5 If createArea(areaID, 1) = "" Then Else For i = 1 To 2 Select Case i Case 1 buf = Dir(Path & dirName & "A社*" & Mid(day1Str, 3, 4) &”.xls*") File = Path & dirName & buf Case 2 buf = Dir(Path & dirName & "B社*" & Mid(day1Str, 3, 4) &".xls*") File = Path & dirName & buf If buf <> "" Then Workbooks.Add sumMeasFile = ActiveWorkbook.Name Workbooks.Open File shCount1 = Sheets.Count measFile = ActiveWorkbook.Name Workbooks(sumMeasFile).Activate '* 各顧客データ行列入れ替え For j = 1 To shCount1 Worksheets.Add after:=Worksheets(Sheets.Count) ActiveSheet.Name =Workbooks(measFile).Worksheets(j).Name '* 各計量ファイルの日付,値のセル設定 With Workbooks(measFile).Worksheets(j) nameRng =.Name Set dayRng =.Range("E3").End(xlToRight) Set valRng =.Range("E5").SpecialCells(xlLastCell) End With '* シート名とB1を顧客名に For plantNo = 1 To UBound(plantData, 1) If plantData(plantNo, 13) & plantData(plantNo, 24) =areaID & nameRng Then nameRng = plantData(plantNo, 3) End If Next plantNo ActiveSheet.Name = nameRng Range("B1") = nameRng Range("B3:B33") =WorksheetFunction.Transpose(dayRng) Range("C3:AX33") =WorksheetFunction.Transpose(valRng) '* 合計入力 Range("C34") = "=sum(C3:C33)" Range("C34").Copy Range("C34:AY34") Range("A1").Activate Next j Workbooks(measFile).Close savechanges:=False '* シート削除 Application.DisplayAlerts = False Worksheets("Sheet1").Delete Worksheets("Sheet2").Delete Application.DisplayAlerts = True '*合計シート作成 Worksheets.Add after:=Worksheets(Sheets.Count) ActiveSheet.Name = "合計" Range("B3:B34") =Worksheets(1).Range("B3:B34") Range("C2:AY2") =Worksheets(1).Range("C2:AY2") '*一覧作成 row1 = 40 For k = 1 To Sheets.Count - 1 Cells(row1, "B") =Worksheets(k).Range("B1") Cells(row1, "C") =Worksheets(k).Range("AY34") row1 = row1 + 1 Next Range("A1").Activate '*保存 If i = 1 Then Workbooks(sumMeasFile).SaveAs fileName:=Path &Format(areaID, "00") & "A" & Left(day1Str,6)&".xlsx" Else Workbooks(sumMeasFile).SaveAs fileName:=Path &Format(areaID, "00") & "B" & Left(day1Str, 6)&".xlsx" End If ActiveWorkbook.Close End If Next i ’●ここがエラー End If Next areaID End Sub
access2016 VBAの質問です。２つのテキストボックスの数値の大きさを比べて、 テキストボックス１よりテキストボックス２の方が小さい時、 テキストボックス２の数字の色を赤にしたいのですが 以下のようにコードを書いてみましたがうまくいきませんでした。 Private Sub 入力_Click() If Me!txt1.Value > Me!txtL2.Value Then Me!txt2.ForeColor = RGB(255, 0, 0) End If Me!txt2.Requery End Sub 教えていただけると助かります。 よろしくお願いします。
エクセルは2013を使っています。ボタン1を押すと 管理表シートのB、C、E列を本社シートの指定のセルに G6セル～H6セルで指定した行まで、貼り付けては印刷するという マクロを作ろうとしています。 ところが、コピーも貼り付けもできず困っています。 なにが、違っているかご指摘お願いします Sub ボタン1_Click() Worksheets("管理表").Activate Dim ws As Worksheet Set ws = Worksheets("管理表") Dim wa As Worksheet Set wa = Worksheets("本社") Dim i As Integer, s As Integer i = Range("G6") + 4 s = Range("H6") + 4 Do While i = s ws.Cells(i, 5).Copy wa.Cells(22, 7) ws.Cells(i, 2).Copy wa.Cells(19, "D") ws.Cells(i, 3).Copy wa.Cells(10, 2) Worksheets("管理表").PrintOut i = i + 1 Loop End Sub
ﾏﾙﾁﾍﾟｰｼﾞ中のﾃｷｽﾄﾎﾞｯｸｽから 読み込んでﾃｷｽﾄを表示させる。ﾌﾞｯｸA,ﾏﾙﾁﾍﾟｰｼﾞAのﾍﾟｰｼﾞ2の ﾃｷｽﾄﾎﾞｯｸｽ1に入力されているﾃｷｽﾄを ﾌﾞｯｸA,ﾏﾙﾁﾍﾟｰｼﾞAのﾍﾟｰｼﾞ1の ｺﾝﾎﾞﾎﾞｯｸｽ2に表示させたいです。 どのようにすればいいでしょうか。
エクセルVBAについて質問があります。（エクセルのバージョンは2007です。） 画像（上）のようなフォームがあり、購入者（TextBox1)、品物１～４(TextBox2～5)を入力後、登録ボタン(CommandButton1)を押すと画像（下）のエクセル（Sheet１）に保存されます。 フォームで購入者を入力後、呼び出しボタン（CommandButton2）押すと品物1～4が 表示されるようにしたいのですが、方法はありますか？
VBAオートシェイプでの質問です。 選択しているセル（アクティブセル）に図形を挿入させたいのですがうまくいきません。セルの大きさに合わせて丸の図形を挿入させてみましたが Dim myShp As Shape With ActiveSheet.Range("G10:H10") '★ Set myShp = ActiveSheet.Shapes.AddShape _ (Type:=msoShapeFlowchartConnector, Left:=.Left, Top:=.Top, Width:=.Width, Height:=.Height) With myShp .Line.ForeColor.SchemeColor = 0 '黒 .Line.Weight = 1.25 '線の太さ .Fill.ForeColor.RGB = RGB(255, 0, 0) .Fill.Transparency = 1 '透過 End With End With Set myShp = Nothing '★のコードのようにセルの指定でしかできませんでした。 Selection Activecell...色々試しましたが知恵不足です。 ご教示、宜しくお願います。
マクロでエクセルファイルの開き方について教えて下さい。 ワークブックオープンでファイルを開いていますが、読み取り専用で開く用に設定したら 必ず、読み取り専用で開きますか？と聞いてきます。 これを、"はい"とマクロで組んで開く事は可能でしょうか？
ＶＢＡについての質問です Sub 星の表示() Dim i As Integer, n As Integer n=10 For i=1 To nDebug.print Format(i,"00")&String(i,"*") Next i End Sub これをDo~LOOP文に書き換えたいのですがどうすればいいでしょうか？
ＶＢＡについての質問です 成績判定のコードを書きたいのですが、行き詰りました ここからどうすればいいですか？Sub 反復型成績判定 Dim X As Variant X=Array(60,82,87,50,56,86,89,76,58,68 Dim hantei As Variant hantei=Array("不可","可","良","優") Dim h As Integer Const N As Integer=10 Dim i As Integer Dim tokuten As Integer For i=1 To N tokuten=X(i-1)
vb.netで8ビットグレースケールのjpgファイルを作成する方法はありませんでしょうか？ gdiplusを使用すると24ビットになってしまいますのでそれ以外の方法は探しております。
エクセルプロセスが残る。 ローカルエリアネットワーク上のファイルサーバにあるマクロ有効ブックを開くと、ファイルを閉じてもプロセスが残ってしまいます。マクロはセルをコピペする単純なものでsetなどは使用していません。 Sub Macro1() Range("F7:G10").Select Selection.Copy Range("I8").Select ActiveSheet.Paste End Sub 自身のPC上に保存したマクロ有効ブックではプロセスは問題なく終了します。 どうやら「保護ビュー」を聞いてくる状態だとプロセスが残ってしまうようです。 試にセキュリティー設定を変更して「保護ビュー」を聞いてこないように設定するとプロセスは問題なく終了します。 プロセスが残った状態で別のエクセルブック（マクロ無）を開いてVBAエディタを起動するとプロジェクトエディタにマクロ有効ブックが存在していました。 この亡霊ともいえるマクロ有効ブックのシートをダブルクリックしても開かず、モジュールを解放しようとするとエクセル自体が強制終了されてしまいます。（強制終了後は亡霊は消えています） 2013、2016で発生を確認しています。 2010では問題ないようです。 解決方法ありますでしょうか？
プログラム初心者なのですが、ASP.NETを使って開発をしています。今自分のやりたいことは、GridViewを使って内容と更新日という項目を表示させて、 更新日が1週間以内のものに対してのみ「新着」という小さいロゴを表示させようとしています。 そこで下記のコードのようにGridViewの更新項目の下にImageタグを配置して、 VB.NETのコードで、img1.Visible = False このようにimg1というIDを指定してあげても「img1は宣言されていません」というエラーになってしまいます。 もしかすると、GridView内に配置されているコントロールのIDを指定するにはただ単にIDだけの記述ではだめなのでしょうか？ また、どのようにしたら私のやろうとしていることが出来るようになるのか、教えて頂けると大変ありがたいです。 一日かけて調べたのですが、どうしても解決に至らず質問させて頂きました…よろしくお願いします。 <asp:GridView ID="grdKyujinList" runat="server" AutoGenerateColumns="False" CellPadding="5" PageSize="500" GridLines="None" ShowHeader="False"> <Columns> <asp:TemplateField HeaderText="内容"> <ItemTemplate> <asp:Label ID="Label1" runat="server" Text='<%# Eval("CreateDate").ToString.Substring(0, 10)%>'></asp:Label> </ItemTemplate> <HeaderStyle HorizontalAlign="Center" /> <ItemStyle Width="120px" /> </asp:TemplateField> <asp:TemplateField HeaderText="更新日"> <ItemTemplate> <asp:HyperLink ID="HyperLink1" runat="server" Text='<%# Eval("Title") %>' NavigateUrl='<%# "seinenbukai.aspx?id=" & Eval("id")%>'></asp:HyperLink> <asp:Image ID="img1" runat="server" ImageUrl="../images/newIcon02.gif" Visible="True" /> </ItemTemplate> <HeaderStyle HorizontalAlign="Center" /> <ItemStyle Width="400px" /> </asp:TemplateField> </Columns> </asp:GridView>
VBAについての質問です エラーコード表を作成してみたいのですが、イミディエイトウインドウで大量にアプリケーション定義またはオブジェクト定義のエラーです。と表示されます。このエラーのみを取り除くにはどう書き換えればいいでしょうか？ Sub ErrorTable() Dim i As Integer i = 0 For i = 1 To 100 Debug.Print i, Error(i) Next i End Sub ｐ
visual basicについて質問です。My.Computer.FileSystem.WriteAllText()にてtxtファイルを出力したいのですが、 上記では出力先の指定とファイル名の決定を同時に行ってしまうため、「取得したPathに任意の名前でtxtファイルを出力」ということができないので困っています。 後からrenameしようともしたのですが、一度ファイルができてしまった後に上書きできなくなってしまうため、手詰まりとなってしまいました。 何かよい手段はありますか？
VBAでiniファイルの全セクション・キーの値を表示するようなプログラムを作成したいと考えています。どのようにつくるのがよいでしょうか（サンプルプログラムが欲しいです）
VBA勉強中の者です。2つ質問をさせてください。 ①excel VBAでセルA列をセルBに空白が出るまでコピーをしたいのですが、どうすればよろしいでしょうか？例 A B 1 1 2 2 3 3 4 5 ②別エクセル(A.xlsm)のAセルとメインエクセル(B.xlsm)のAセルの文字が同じかどうかを判定し、 合っていれば別エクセル(A.xlsm)のC,D列をメインエクセル(B.xlsm)のF,G列にコピーするのは どのようにしたら良いでしょうか？ 例 A.xlsm B.xlsm A A 123 123 文字が一致したので A.xlsm B.xlsm C D F G 12 67 12 67 123 89 123 89 (できればこちらのコピーする範囲も、空白があるまでコピーするようにしたいです） 厚かましい質問で申し訳ありません。 お時間がございましたらご教授頂ければ幸いです。 以上、よろしくお願いいたします。
エクセルＶＢＡについて質問です。 たとえば、Ａ１～Ｄ５の表の中に、１～３の数字を適当に入力しておきます。 割り当てられる数字が行方向に対して均等になるようにしたいです。この作業を行う場合、どのようにマクロを組めばよろしいのでしょうか。 ご教授願いたいです。 よろしくお願いいたします。 説明がわかりづらく申し訳ございません。
エクセルで、いろいろなデータ（A、B、C、D、E、F等と複数の種類のデータがそれぞれN＝30～40あります）のそれぞれの相関係数（エクセルの近似曲線で線形近似を作ってR-2値を表示させています）を調べています。 じゅうたん爆撃的にAとB、AとC、AとD、AとE、AとFを全部グラフと線形近似を取って調べて、Aとの全てのデータの相関を調べたら次はBとC、BとD、BとE、BとFと調べて、その次はCと〇と調べています。 エクセルで、これら全ての相関を一度に調べてくれるような関数ややり方はあるのでしょうか？ 過去ログを調べましたが出てなかったようですので、質問させて頂きます。 何卒宜しくお願い致します。
エクセルのマクロ機能についてお伺いしたいです。 下記の様な，で区切った文章（２行～4行）を貼り付け機能でエクセルの1列に行毎に移動させることは可能でしょうか。できれば文章を張り付ける度に列を下げて記入できればと思います。 使用する物だけでも教えていただきたいです。 AA,BB,CC DD,EE, FF,GG 下記の様に表にしたいです。 AA BB CC DD EE FF GG よろしくお願いいたします。
vbaについて質問です。 ある、重複したらまとめてくれるリストを作成したいです。 例えば下記のようなリストがあったとします。 A列(商品名) B列(顧客NO) C列(名前) D列(フラグ) 商品ア1234 鈴木 1 商品イ 2345佐藤 1 商品ウ 8543 田中 1 商品ア 9823 加藤 商品エ 5421 石田 商品イ 4235 島田 1 このリストから、まずD列のフラグが立っている行を抽出し、次に、A列の商品名の重複している部分をまとめます。次に、重複したデータのB列C列の顧客NOと顧客名を同じセルに連続して違うシートに記載したいです。 つまり、 商品ア 1234 鈴木 商品イ 2345 佐藤 4235 島田 商品ウ 8543 田中 としたいのですがどすればよろしいでしょうか。 なお、フィルタを使用するのではなく、できるだけ処理が早い方法がいいです。 何卒よろしくお願い致します。
至急！ エクセル VBA 連番 for k 1 to last 処理 next i の中で連番を振る処理をいれたいです。a01から始まり、a99の次はb01になります。最後はz99で、a01に戻ります。 ご教示下さい。
デバイスコンテキストについて質問です。 VBAでデスクトップに適当にいろいろ表示して遊んでます。 文字やら四角など表示できるのはいいんですが、消す方法がありません。Windowsキー＋Ｄキーを2回おして消してる始末です。 描画したものだけを消す方法がありましたら教えて下さい。 描画前の情報を取っておいて再描画などになるのでしょうか？ あまりよくわかっていません。基本方針だけでも構いませんので よろしくお願いします。
同ブックの複数シートから最終行をコピーして他のシートに貼付 宜しくお願いします。 Sheet１があります。B列には科目があり、マクロによって科目毎に新しいシートが追加され、科目ごとにデータが貼付されていきます。そして、最下行の F列にシート名、 I列からK列に縦計 が出ています。 新しく追加された各シートの最下行を、再度、sheet1の任意の場所から下に向かって 転記というか、貼り付けていきたいのです。 宜しくお願いします。
【VBA】 複数シートからの合計行（できれば複数セル指定）を新しいシートに纏める。 どうしても分かりません。宜しくお願いします。 Sheet１があります。B列には科目があり、マクロによって科目毎に新しいシートが追加され、科目ごとに貼付されていきます。そして、最下行の F列にシート名、 I列からK列に縦計 が出ています。 新しく追加された各シートの最終行を、再度、sheet1の任意の場所から下に向かって 転記というか、貼り付けていきたいのです。 直接コードを書いていただけると助かります。 宜しくお願いします。 Sub C__債権集計_科目毎シート展開() Sheets("Sheet1").Activate Dim myDic As Object, myKey Dim myVal, x Dim i As Long, J As Long, k As Long Dim mySh As Worksheet Dim myFlg As Boolean Dim lastRow As Long, lastCol As Long Dim myL As Variant Dim myCnt As Variant Dim sh As Worksheet Dim sno As Integer lastRow = Worksheets("sheet1").Range("B" & Rows.Count).End(xlUp).Row lastCol = Worksheets("sheet1").Cells(1, Columns.Count).End(xlToLeft).Column myVal = Worksheets("sheet1").Range(Cells(2, 1), Cells(lastRow, lastCol)).Value myL = 2 Set myDic = CreateObject("Scripting.Dictionary") For i = 1 To UBound(myVal) If Not myVal(i, myL) = Empty Then If Not myDic.Exists(myVal(i, myL)) Then myDic.Add myVal(i, myL), 1 Else myDic(myVal(i, myL)) = myDic(myVal(i, myL)) + 1 End If End If Next myKey = myDic.Keys For i = 0 To myDic.Count - 1 For Each mySh In Worksheets myFlg = False If mySh.Name = myKey(i) Then myFlg = True mySh.Cells.Delete Exit For End If Next mySh If myFlg = False Then ActiveWorkbook.Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = myKey(i) End If With Worksheets("Sheet1") .Range(.Cells(1, 1), .Cells(1, lastCol)).Copy Worksheets(myKey(i)).Range("A1") End With myCnt = 0 ReDim x(1 To lastRow, 1 To lastCol) For k = 1 To UBound(myVal) If myVal(k, myL) = myKey(i) Then myCnt = myCnt + 1 For J = 1 To lastCol x(myCnt, J) = myVal(k, J) Next J End If Next k Worksheets(myKey(i)).Cells(2, 1).Resize(UBound(x), lastCol).Value = x Erase x With Range("i2").End(xlDown).Offset(2, 0) .Resize(, 3).Formula = "=SUM(" & Range("i2", Range("i" & Rows.Count).End(xlUp)).Address(False, False) & ")" End With n = Cells(Rows.Count, "F").End(xlUp).Row + 2 Range("F" & n).Select For Each sh In Worksheets ActiveCell.FormulaR1C1 = sh.Name Next sh Columns("A:o").EntireColumn.AutoFit Next i ’==========Sheet1へ各シートの最終行を転記というか、コピペしていきたい！！ End Sub
マクロで空白を無視する方法が知りたいです。 下記の（Ｃ4：Ｃ35）のセルに空白があった場合は+1しないで そのままにしたいのですが、どなたかご教授下さい。 超の付く初心者です。*************************************** Sub 翌月処理() Range("C4：C35").Value = Evaluate("C4:C35+1") Range("A1").Select End Sub ***************************************
オンラインゲームをやっているんですがゲームが強制的に落ちた再にIEが自動で開いてきてめんどくさいのでVBで自動終了させたいのですが、変わりにプログラム書いていただけませんか？
【マクロ、エラー】下記マクロを実行したところ、”コンパイルエラー”(参照か不正または不完全） ★印の部分(nameRng=.Name)がブルー色 ●印の部分が黄色（Private Sub sumMeasureValue()）（デバッグ） として表示されました。 以前から使っていたものだったのですが、シートの指定範囲が変わったりしたため、修正はしたのですが、それ以外は複雑すぎてよくわからず、何が原因でどう修正をしたら良く分からず。よろしくお願いします。 下記マクロは、指定のフォルダにある複数のファイルから全シートの数字を新規ファイルにまとめるマクロになっています ****************** ●Private Sub sumMeasureValue() Dim buf As String '*** ワイルドカード用ファイル名 *** Dim File As String '*** A/Bファイル名 *** Dim sumMeasFile As String '*** 売上合計ファイル *** Dim measFile As String '*** ファイル *** Dim shCount1 As Integer '*** ファイルシート数 *** Dim nameRng As String '*** 顧客名 *** Dim dayRng As Object '*** 日付のセル *** Dim valRng As Object '***売上値のセル *** Dim i As Integer Dim plantNo As Integer For areaID = 1 To 9 If createArea(areaID, 1) = "" Then ' 個別作成が空白の場合は何もしない Else For i = 1 To 9 Select Case i Case 1 buf = Dir(Path & dirName & "AVC様*" & areaName(areaID) & "売上値-" & Mid(day1Str, 3, 4) & "*.xls*") File = Path & dirName & buf End Select If buf <> "" Then Workbooks.Add sumMeasFile = ActiveWorkbook.Name Workbooks.Open File shCount1 = Sheets.Count measFile = ActiveWorkbook.Name Select Case areaID Case 1 ★nameRng = .Name Set dayRng = .Range("E3").End(xlToRight) '日付 Set valRng = .Range("B2").SpecialCells(xlLastCell) '売上の範囲指定 End Select （ホントはCase9まで続いています） End With……
エクセルマクロのエラーに関しての質問です。ＯＦＦＩＣＥのOUTLOOKを利用して、PDFデータを添付しメールを作成するマクロを作成したのですが、 添付写真の様なエラーが発生し、メールの作成が止まってしまいます。 マクロを動かしてから、エラーが発生するタイミングは都度違い、 30通作成→エラー発生の場合もあれば、 80通作成→エラー発生の時もあります。 お手数ですがよろしくお願いいたします。 OUTLOOKを起動してからのマクロを下記に記載します。 Dim Y As Integer Dim メール配信先社数 As Integer Dim G As Integer Dim CA As Range Dim メールアドレス() As Variant Dim D As String Dim W As String Dim 取引先コード() As Variant Dim 取引先名() As Variant Dim oApp As Object Dim myNameSpace As Object Dim myFolder As Object Dim objMAIL As Object 'メールのオブジェクト Dim strMOJI As String '本文 Dim 添付資料 As String Dim 本文開始 As String Dim 本文2行目 As String Dim 本文3行目 As String Dim 本文4行目 As String Dim 本文5行目 As String 'outlook 起動 Set oApp = CreateObject("Outlook.Application") メール配信先社数 = Workbooks("MAIL配信マクロ.XLS").Sheets("メイン").Range("E1").Value メールアドレス = Workbooks("MAIL配信マクロ.XLS").Sheets("配信先").Range("C2:C" & メール配信先社数 + 1).Value 取引先名 = Workbooks("MAIL配信マクロ.XLS").Sheets("配信先").Range("B2:B" & メール配信先社数 + 1).Value 取引先コード = Workbooks("MAIL配信マクロ.XLS").Sheets("メイン").Range("D:D").Value 本文開始 = Workbooks("MAIL配信マクロ.XLS").Sheets("メイン").Range("A4").Value 本文2行目 = Workbooks("MAIL配信マクロ.XLS").Sheets("メイン").Range("A5").Value 本文3行目 = Workbooks("MAIL配信マクロ.XLS").Sheets("メイン").Range("A6").Value 本文4行目 = Workbooks("MAIL配信マクロ.XLS").Sheets("メイン").Range("A7").Value 本文5行目 = Workbooks("MAIL配信マクロ.XLS").Sheets("メイン").Range("A8").Value 'メールアイテムの作成 'W = Application.WorksheetFunction.Find(取引先コード(G, 1), Workbooks("MAIL配信マクロ.XLS").Sheets("配信先").Range("A2:A" & メール配信先社数 + 1), 0) G = 1 For Y = 1 To メール配信先社数 ' 完全一致のセルだけ ' ↓ W = Workbooks("MAIL配信マクロ.XLS").Sheets("配信先").Range("A:A").Find(取引先コード(G, 1), LookAt:=xlWhole).Row 添付資料 = CreateObject("WScript.Shell").SpecialFolders.Item("Desktop") & "\対象外PDF\" & 取引先コード(G, 1) & ".pdf" Set objMAIL = oApp.CreateItem(0) 'olMailItem=0 objMAIL.Display '画面表示(Mail入力、編集画面を表示) If Dir(添付資料) <> "" And Workbooks("MAIL配信マクロ.XLS").Sheets("配信先").Range("C" & W) <> "" Then ' And Workbooks("MAIL配信マクロ.XLS").Sheets("配信先").Range("C" & W) <> "" Then 'Workbooks("MAIL配信マクロ.XLS").Sheets("配信先").Range ("C" & W).value = <> "" '宛先・件名・本文 などのデータを代入する objMAIL.To = Workbooks("MAIL配信マクロ.XLS").Sheets("配信先").Range("C" & W) '宛先 ほかに.cc や.Bccも可能です 'objMAIL.CC = "vba@yuuki3.org" '宛先 .cc 'objMAIL.BCC = "vba@yuuki3.org ; oltest@ken3.org" '宛先を複数は ; セミコロンで区切る objMAIL.Subject = "=== " '.Subjectに文字列設定で件名 '取引先名(G, 1) & 本文を作る、(vbCrLfで改行されます) strMOJI = Workbooks("MAIL配信マクロ.XLS").Sheets("配信先").Range("B" & W) & "様" & 取引先コード(G, 1) & vbCrLf _ & " " & vbCrLf _ & 本文開始 & vbCrLf _ & 本文2行目 & vbCrLf _ 'Range("A:A") objMAIL.Body = strMOJI '本文の代入 '添付ファイルを送りたい時は、.Attachments.Add objMAIL.Attachments.Add 添付資料 objMAIL.Display Else 'データを開いて 印刷 閉じる objMAIL.Close 1 ' objMAIL.Display '編集画面のまま止めておきたい時 や テスト中に動作を見たいとき End If G = G + 1 Next Y
AccessでのVBAを用いた値取得について いつもお世話になっております。 初歩的な質問かも知れず、大変恐縮なのですが、 フォームにてコンボボックス（名前：コンボ４）を作り、その値をＶＢＡで変数Xに代入したのですが、 Dim X as variant X=コンボ４.value としてもxに値が入っていないようなのです。 すみませんが、代入方法が分かる方教えて頂けないでしょうか。。
VB6の配列で質問です 以前の担当がVB6のコードで下記の様な記述を度々書いています。MArray = Array(0, 1, 5, 6, 8, 0, 12,3, 1, 8) For I = 0 To S - 1 X = MArray(I) Next I これは、Xに値を取得するだけなら FORでループさせる意味があるのでしょうか。 X = MArray(S-1) で事足りるのではないでしょうか。
Excel 関数 vba vlookup vlookupで複数一致した場合、一致した二番目、三番目 と任意に抽出する位置を選ぶ方法を教えください。 vlookupに拘ってはいないので、その他の関数や、 vbaでも大丈夫です。宜しくお願いします。
マクロ（ＶＢＡ）についてご質問です。 2つのエクセルＡ，Ｂを使用し、Aのエクセルに入力したデータを そのままＢのエクセルに反映されるマクロを作成したいのですが、 うまくいきません。※Aのエクセルはデスクトップに保存されており、 Bのエクセルは共有フォルダに保存されています。 また、エクセルのバージョンは97-2003です。 緊急です。ご指導の程よろしくお願いします。
C#, XML/ XmlReaderを用いて子要素を取得する現在，VS2013, .NET Framework 4.5, c# でMicrosoft Office用のアドインを開発しています．その中で，XMLを利用する場面があるのですが，XMLの読み込みでつまづいています． 【読み込みたいXMLファイル】※タグ名や内容等は改変しています <XMLFile> <lunch> <number>0</number> -<主食>ごはん</主食> -<主菜>肉 - -<名>ハンバーグ</名> -</主菜> </lunch> <lunch> <number>1</number> -<主食>麺</主食> -<主菜>たまご - -<名>卵焼き</名> -</主菜> </lunch> <lunch> <number>2</number> -<主食>ごはん</主食> -<主菜>魚</主菜> </lunch> </XMLFile> 【XMLファイル 終了】 以下が読み込み時のコードになります． ================ XmlReader reader = null; XmlReaderSettings settings = new XmlReaderSettings(); List<string> lunchList = new List<string>(); for (int i=0; i<number.Count; i++) reader.XmlReader.Create(xmlpath, settings) while(reader.Read()) { if (reader.localName.Equals("number")) { if (reader.ReadElementContentAsInt() == (int)num[i]) //指定された番号のみの箇所を取得 { while(reader.Read()) { if (reader.NodeType == XmlNodeType.Element) { //もし<主菜>タグの子要素に<名>があればそれを取得，なければ<主菜>タグ内テキストを取得 if (reader.Name == "主菜") { if(reader.ReadToDecendant("名")) lunchList.Add(reader.ReadString()); } lunchList.Add(reader.ReadString()); reader.Close(); } ......} } =========================================== やりたいことは上記コードのコメント欄に書いてあるようなことなのですが， 取得した番号(これは今回あまり関係のないことだとは思いますが念のため書きました)と 合致した箇所のlunchに関する<主菜>タグ部分のみを取り出したいです． ※もし，取得した番号が1と2の場合，「卵焼き」と「魚」が取れれば問題ありません． しかし現在，<名>タグ内テキストが取得できる箇所とできない箇所があります． (取得できない箇所では取得したテキストはnullではなく空白となっています) XMLファイル自体を確認しましたが，タグの生成やファイル自体がおかしな記述になっているということはありませんでした． if (reader.ReadToDescendant("名"))内の記述を消した場合は，全ての<主菜>タグの中身は問題なく取得できます． なぜタグ内のテキストが取得できる箇所とできない箇所があるのか， <主菜>タグと<名>タグ内のテキストを漏れなく取り出すにはどうしたらいいのかご教授いただけますでしょうか． よろしくお願いします．
VBAで下記のコードを作成しました。 A4から最終行のデータを＿で区切って各内容を6列目と7列目に入力する処理になります。このコードだとA4のデータが空欄又は＿がない場合エラーとなってしまいます。 空欄又は＿が無い行を飛ばして次の行へ進むようにするにはどうしたらよいのでしょうか。 Sub SAMPLE3() Worksheets(1).Range("A4").Select Dim i As Long, tmp As Variant For i = 4 To Cells(Rows.Count, 1).End(xlUp).Row tmp = Split(Cells(i, 1), "_") Cells(i, 7) = tmp(0) Cells(i, 6) = tmp(1) Next i End Sub
チェックボックスに関して 動的なチェックボックスを表示を以下のようなプログラムで実現が出来ました。 ここからが質問ですが、レイアウトが思うように出来ません。レスポンシブな画面を作成したいと思っています。 以下のプログラムで実行すると、２段で表示した場合にチェックボックスのチェックする枠が上行に残ってしまいます。チェックボックスの枠とテキスト部分を一塊として２段目に表示するにはどのようにしたらいいでしょうか。 ---WebForm3.aspx 【START】▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼ <%@ Page Language="C#" AutoEventWireup="true" CodeBehind="WebForm3.aspx.cs" Inherits="smple.WebForm3" %> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml"> <head runat="server"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> <link rel="stylesheet" href="Content/bootstrap.min.css" /> <title></title> </head> <body> <form id="form1" runat="server"> <div> <asp:PlaceHolder ID="PlaceHolder1" runat="server"></asp:PlaceHolder> </div> </form> </body> </html> ---WebForm3.aspx 【END】▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲ ---WebForm3.aspx.cs 【START】▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼ using System; using System.Collections.Generic; using System.Linq; using System.Web; using System.Web.UI; using System.Web.UI.WebControls; namespace smple { public partial class WebForm3 : System.Web.UI.Page { protected void Page_Load(object sender, EventArgs e) { for (int i = 1; i <= 10; i++) { CheckBox cb = new CheckBox(); cb.ID = "chk1_" + i.ToString(); cb.Text = "チェックボックス" + i.ToString(); PlaceHolder1.Controls.Add(cb); } } } } ---WebForm3.aspx.cs 【END】▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲
エクセルのマクロについて質問です。 まだまだ勉強中の素人ですがネット上・マクロの記録などからつなぎ合わせてマクロを何とか組みました。しかし知識不足からどうしてもエラーが出てしまう箇所や、ループ等できず長くなってしまうなど問題が多すぎて対処できません。もしよければどなたか改良などお願いします Sub 集計パターン0() Application.DisplayAlerts = False Dim buf As String, Wb As Workbook Const Target As String = "1番ブック" Target2 = "2番ブック" Target3 = "3番ブック" Target4 = "4番ブック" Target5 = "5番ブック" Target6 = "6番ブック" Target7 = "7番ブック" Target8 = "仮最終合計ブック" Dim i As Integer For i = 1 To 31 Dim sheetname As String sheetname = i & "日" '項目１ Workbooks.Open Target2 Worksheets(sheetname).Select Range("D1:DI400").Select Selection.Copy Workbooks.Open Target Worksheets("仮１").Select Range("A1").Select ActiveSheet.Paste Windows("2番ブック").Activate ActiveWorkbook.Save ActiveWorkbook.Close '項目2 Workbooks.Open Target3 Worksheets(sheetname).Select Range("D1:DI400").Select Selection.Copy Windows("1番ブック").Activate Worksheets("仮２").Select Range("A1").Select ActiveSheet.Paste Windows("2番ブック").Activate ActiveWorkbook.Save ActiveWorkbook.Close ’項目3 Workbooks.Open Target4 Worksheets(sheetname).Select Range("D1:DI400").Select Selection.Copy Windows("1番ブック").Activate Worksheets("仮４").Select Range("A1").Select ActiveSheet.Paste Windows("4番ブック").Activate ActiveWorkbook.Save ActiveWorkbook.Close '項目４ Workbooks.Open Target5 Worksheets(sheetname).Select Range("D1:DI400").Select Selection.Copy Windows("1番ブック").Activate Worksheets("仮5").Select Range("A1").Select ActiveSheet.Paste Windows("5番ブック").Activate ActiveWorkbook.Save ActiveWorkbook.Close ’項目５ Workbooks.Open Target6 Worksheets(sheetname).Select Range("D1:DI400").Select Selection.Copy Windows("1番ブック").Activate Worksheets("仮6").Select Range("A1").Select ActiveSheet.Paste Windows("6番ブック").Activate ActiveWorkbook.Save ActiveWorkbook.Close '項目６ Workbooks.Open Target7 Worksheets(sheetname).Select Range("D1:DI400").Select Selection.Copy Windows("1番ブック").Activate Worksheets("7番ブック").Select Range("A1").Select ActiveSheet.Paste Windows("7番ブック").Activate ActiveWorkbook.Save ActiveWorkbook.Close '項目最後 Windows("1番ブック").Activate Worksheets("仮集計済みシート").Select Cells.Select Selection.Copy 'ここの貼り付けがうまくいかない Workbooks.Open Target8 Worksheets(sheetname).Select Range("A1").Select Selection.PasteSpecial Paste:=xlPasteValues Selection.PasteSpecial Paste:=xlPasteFormats Windows("1番ブック").Activate ActiveWorkbook.Close Next i Msg Box("終了しました") End Sub 1番のブックに2~7番のデータをそれぞれのシートに貼り付け（事前に式を入れてある仮集計済みシートがこれで完成）このできたシートを仮最終合計ブックにコピーする これを31日分繰り返すという流れです。 それぞれのブックは保存場所・名前が割と頻繁に変わるのでとりあえず1番～と仮付けしています 最後の仮集計以外のシートの中身のコピーはデフォルトのペーストで問題なかったのですが、最後の項目のコピーは値と書式のコピーでなくてはならずそれをしようとするとエラーになり、どこが悪いのかさっぱりわかりません；； 長文だらだらと申し訳ありません
エクセルで数字の分だけセルをぬりつぶす方法がわかりません。http://okwave.jp/qa/q7734096.html ↑こちらに書かれているのは数字を打ち込むと、そのすぐ右のセルから 右に向かって数字の分だけ塗りつぶしていく方法です。 ただ今やろうとしていることは、数字を打ち込むとそのすぐ上のセルから 上に向かって塗りつぶしていくための方法です。 よろしくお願いします。
バリアント型の配列を介してセル範囲を別のシートに写したいのですが 同じように見えてできない記述があります。どう考えたらよいのか教えてください。Sub test() Dim buf As Variant Worksheets("src").Select buf = Range(Cells(1, 1), Cells(100, 5)) Worksheets("dest").Cells.Clear '----(1)下はだめ ' Worksheets("dest").Range(Cells(1, 1), Cells(100, 5)) = buf '---(2)下はOK Worksheets("dest").Range("A1:E100") = buf '---(3) 下はOK Worksheets("dest").Select Range(Cells(1, 1), Cells(100, 5)) = buf End Sub
VisualStudioでQtとOpencvを使って画像処理をするプログラムを作っています。ボタンが押された時のシグナルをスロットで検知してopencv等のプログラムに通し、画像の生成等を行いたいのですが、ビルト時のログを見て見ると、シグナルとスロットがうまく接続できていないようです。 調べるだけ調べ、思いつく限りのことは全て試したのですができるようになりません。 GUIはQt Designerを用いて作ったuiファイルをuicコマンドでヘッダーファイルにし、それを使い、実装しています。 デフォルトでプッシュボタンに実装されているclose()などのスロットですと、問題なくコネクトされ、実行できます。 自作したスロットの場合だけ、うまくコネクトされません。 以下ソースコード抜粋 ui_selectwindow.h QObject::connect(selectDirButton, SIGNAL(clicked()), SelectWindow, SLOT(SelectWindow::selectDirectory())); QObject::connect(fileList, SIGNAL(itemClicked(QListWidgetItem*)), SelectWindow, SLOT(SelectWindow::getFullPath(QListWidgetItem*))); selectwindow.h public slots: void selectDirectory(); void getFullPath(QListWidgetItem*); selectwindow.cpp void SelectWindow::selectDirectory(){ //-----------// } void SelectWindow::getFullPath(QListWidgetItem* selectItem) { //-----------// } エラーログ QObject::connect: No such slot QWidget::SelectWindow::selectDirectory() QObject::connect: (sender name: 'selectDirButton') QObject::connect: (receiver name: 'SelectWindow') QObject::connect: No such slot QWidget::SelectWindow::getFullPath(QListWidgetItem*) QObject::connect: (sender name: 'fileList') QObject::connect: (receiver name: 'SelectWindow') 下記に参考になりそうなサイトのURLを載せておきます。 http://www.glamenv-septzen.net/nifty/tips/qt_junkbox/qt_tutorials/t... http://gu-ta.blog.so-net.ne.jp/2010-11-23 自作スロットへのシグナルの接続方法でわかる方、解決策をお願いします。
宜しくお願いします。 エクセルを使って在庫の管理をしたいと思っています。 現在シート1に在庫表があります。 そのシートは A列に商品名（型番） B列に在庫数 を記入した簡単なものです。そのシートの横に日付ごとの販売履歴のシートがあります。 １日ごとにシートを増やしています。 販売履歴シートは1行ごとに 名前、発送先、住所などを記載していってます。 その中でI列に商品名（型番）があるのですが、 ボタンひとつで簡単に（マクロと言われるものでしょうか詳しくないのでわかりませんが） 在庫表の商品名（型番）と連動させて在庫管理をしたいです。 1日に販売した商品を在庫表から減らしていき在庫を毎日管理したいです。 エクセルはMAC2011です。 商品型番をまずしっかり合わせてからですが、どなたかご教授お願いいたします。
マクロ初心者です。 マクロを使って指定した範囲内の0を削除（空欄）にしたいのですが うまくできません。 どなたか、教えてください。他の方の知恵袋をみて試してみたのですができませんでした。 ↓↓↓ A1：C5にある0を削除したい場合 Private Sub CommandButton1_Click() Sub test() Dim c As Range For Each c In Range("A1:C5") If c.Value = 0 Then c.Value = "" Next c End Sub これは間違えているのでしょうか？
マクロについて教えて下さい。 別ファイルから特定の行～最終行までにを転記したいです。A.xls：別ファイル B.xls：アクティブファイル A.xls(sheet1)のA列4行目～A列最終行 ⇒ B.xls(sheet2)のB列3行目以降へ転記 皆様のお力をお貸し下さい。
プログラムに関する質問です。あるクラスのコンストラクタの中で、wfopen-sをあるファイルを読み込み専用で開いているのですが、その後にfetsやfcloseを書きたすと、デバッグする時に『致命的なエラーが検出されたとでます』 普通にファイルを開いて閉じてるだけなのになぜでしょうか？
YahooショッピングAPIをVB.NETにて利用したいのですが・・・ ストア関連のAPI（注文データ取得や在庫更新など)を行いたいのですが、手がかりが全くつかめません。どのような手段でアクセスし、データ取得・更新を行うのでしょうか？ ・WebRequest？ ・RestClient？ ヒントのような単語は持っているのですが、実装できるまでに至っていません。 ご教授願います。 また、参考サイトやサンプル等あればよろしくお願いいたします。
VBA オートフィルタ 抽出条件『以上』で抽出 VBA初心者です。 果物の名前とシリアル番号を指定して、指定したシリアル番号以下のものだけ抽出したいと考えています。Sheet2にはデータがあります。 Sheet1のB1に果物の名前を入力（りんご）、 Sheet1のB2に8桁の数値を入力（20160619) Sheet2のデータには O列に果物名、W列にシリアル番号があります。 上記の指定で 果物 シリアル番号 りんご 20160619 りんご 20160613 りんご 20160620 から、 りんご 20160619 りんご 20160613 だけを抽出したいのですが、抽出できません・。”りんご”の指定で３件抽出された後、日付指定の抽出結果がゼロとなってしまいます。 ちなみに現在のコードは以下の通りです。 Sub Filter() Application.ScreenUpdating = False Sheets("Sheet1").Activate Dim 商品名 As String 商品名 = Sheets("Sheet1").Range("B1").Value MsgBox 商品名 Dim 数値 As String 数値 = Sheets("Sheet1").Range("B2").Value MsgBox 数値 myForm = "00000000" Range("B2").NumberFormatLocal = myForm Sheets("Sheet2").Activate With Worksheets("Sheet2") .Range("A1").AutoFilter _ Field:=23, _ Criteria1:=商品名 .Range("A1").AutoFilter _ Field:=15, _ Criteria1:="<=数値" End With ActiveSheet.AutoFilterMode = False End Sub なお、コードの数値の抽出条件を”数値”ではなく、20160619と実際の数字を入れると、問題なく抽出できます。 分かりにくい説明で申し訳ありませんが、詳しい方、アドバイスいただけると助かります。 よろしくお願い致します。
初めまして、C#を最近学習し始めた者です。 現在、C#を使ってPDFをフォーム上に表示させる処理を入れておりますが、どうすれば自分の意図する結果になるかが分からず困っております。以下は、そのコードです。 namespace Project1 { class Class1 : Form { private Button btn; private TextBox tb1; private TextBox tb2; protected Label lbl1; protected Label lbl2; [STAThread] public static void Main() { Application.Run(new Class1()); } public Class1() { this.Width = 300; // 表示ページ指定用 tb1 = new TextBox(); tb1.Top = 0; tb1.Width = 100; tb1.Parent = this; // PDFのアドレス指定用 tb2 = new TextBox(); tb2.Top = 50; tb2.Multiline = true; tb2.ScrollBars = ScrollBars.Vertical; tb2.Width = 280; tb2.Height = 50; tb2.Parent = this; // Class2で作るForm上のカーソルX座標表示用 lbl1 = new Label(); lbl1.Top = 150; lbl1.Text = "0"; lbl1.Parent = this; // Class2で作るForm上のカーソルY座標表示用 lbl2 = new Label(); lbl2.Top = 150; lbl2.Left = 150; lbl2.Text = "0"; lbl2.Parent = this; btn = new Button(); btn.Top = 200; btn.Parent = this; btn.Click += new EventHandler(btn_Click); } private void btn_Click(object o, EventArgs e) { Class2 c2 = new Class2(tb1, tb2, lbl1, lbl2); } } class Class2 : Class1 { private AxAcroPDF pdf; private Form fm; public Class2(TextBox tb1, TextBox tb2, Label lbl1, Label lbl2) { // 希望① FormのサイズをPDFのサイズに調整したい fm = new Form(); fm.Show(); // 希望② PDFで最初に開くページを指定ページだけ開きたい。（無理そうなら、こちらは事前に1ページのPDFを作ります。) // 希望③ PDFのナビゲーションは不要 pdf = new AxAcroPDF(); pdf.Dock = DockStyle.Fill; pdf.Parent = fm; pdf.LoadFile(@"" + tb2.Text); // 希望④ Class2で作ったForm上のカーソル座標を、Class1のForm上のLabelに表示したい。 fm.MouseMove += new MouseEventHandler(fm_MouseMove); // 希望⑤ Class2で作ったForm上の閉じるボタンを押したときだけ閉じたい。 // 希望⑥ 現在モードレスで開いていますが、本当はモーダルで開きたい。 // ただ、モーダルにすると、イベントが起きないのでモードレスにしています。 fm.FormClosing += new FormClosingEventHandler(fm_Closing); } // イベント未発生。 private void fm_MouseMove(object o, MouseEventArgs e) { lbl1.Text = e.X.ToString(); lbl2.Text = e.Y.ToString(); fm.Text = "X= " + e.X + " y= " + e.Y; } // モーダルだとイベント未発生。 private void fm_Closing(object o, FormClosingEventArgs e) { DialogResult res = MessageBox.Show("Formを閉じますか", "?", MessageBoxButtons.YesNo, MessageBoxIcon.Question); if(res == DialogResult.No) { e.Cancel = true; } else { fm.Dispose(); } } } } 以上です。 希望処理が①～⑥まであり、回答も大変だと思いますが 何卒、よろしくお願いします。
VBAで検索フォームを作成したいです。 まったくの素人です。 顧客情報のリストがあり、そこから一部一致による検索をし、リストボックスに表示させるところまではできています。そのあとですが、リストボックスで選択したものをExcelシート状でも選択したい。横に22列データがあります。さらにフォーム上でも情報を表示したい。 どのようにしたら良いかまったくわかりません。どなたか教えてください。 現状↓ Private Sub CommandButton1_Click() Dim lastrow As Long Dim mydata, mydata2(), myno Dim i As Long, j As Long, cn As Long 'if textbox1.value=""or textbox2.value=""then end With Worksheets("sheet1") mydata = .Range(.Cells(1, 1), .Cells(Rows.Count, 22).End(xlUp)).Value lastrow = .Cells(Rows.Count, 1).End(xlUp).Row End With ReDim mydata2(1 To lastrow, 1 To 9) For i = LBound(mydata) To UBound(mydata) If mydata(i, 8) Like "*" & TextBox1.Value & "*" And mydata(i, 4) Like "*" & TextBox2.Value & "*" Then cn = cn + 1 mydata2(cn, 1) = mydata(i, 4) mydata2(cn, 2) = mydata(i, 8) mydata2(cn, 3) = mydata(i, 9) End If Next i With ListBox1 .ColumnCount = 3 .ColumnWidths = "150;30;30" .List = mydata2 End With End Sub
EXCEL VBAを使ってEXCELに画像を挿入する方法を教えてください。 どんな関数（メソッド）を使えばよろしいでしょうか？
MySQLから取り込んでﾌｫｰﾑに表示させるには。(ExcelVBA) MySQLﾃﾞｰﾀﾍﾞｰｽからﾃﾞｰﾀを取り込んで Excelブックのﾕｰｻﾞｰﾌｫｰﾑ1のｺﾝﾎﾞﾎﾞｯｸｽ1に表示させる。 ｺﾞｰﾙはこれなんですが。 ﾃﾞｰﾀﾍﾞｰｽに接続 Set Cn = Create Object("ADODB. Connection") Cn.Open "dsn=ﾃﾞｰﾀｿｰｽ名;ﾃﾞｰﾀﾍﾞｰｽ,ﾃｰﾌﾞﾙ名;pwd=**" この先が今一わからなくて困っています。 ここからどのように書けばいいのでしょうか。
Excel VBAについて質問です。 現在添付エクセルにて期限管理を行っているのですが、当方VBA初心者のため長くなってしまいます。配列ですっきりさせたいのですが、そこまでの腕がないのでどうかお助けください。 普段は[期限管理]シートで管理していますが[システム更新データ]が頻繁に更新されるのでVBAで新規追加と更新を行っています。 ●VBA内容 ①新規更新データは期限管理シートに追加 ②2つのシートで一致データを更新 ・一致データの判別方法は3項目（ID,管理番号,タイプ） ※A列のIDはランダムで機能していない ------------- Sub 追加_更新() Dim sh1, sh2 As Worksheet 'シート名 Dim d1max, d2max As Long '最終行番号 Dim c2max As Long '最終列番号 Dim ccc As Range '検索用 Dim firstAddress0 As String Dim mm As String Dim col0 As Long 'ID Dim col1 As Long '管理番号 Dim col2 As Long 'タイプ Dim col3 As Long '受注日 Dim col4 As Long 'MG確認日 Dim col5 As Long '発注日 Dim col6 As Long 'CL報告日 'シートの名前をつける Set sh1 = Worksheets("システム更新データ") Set sh2 = Worksheets("期限管理") '--- '①新規案件を追加------------------------------------------ '各シートの最終行番号 d1max = sh1.Cells(sh1.Rows.Count, 1).End(xlUp).Row d2max = sh2.Cells(sh2.Rows.Count, 1).End(xlUp).Row '[期限管理]シートから列番号を取得----------- With sh2.Cells Set ccc = .Find(What:="ID", LookIn:=xlValues, LookAt:=xlWhole) If Not ccc Is Nothing Then firstAddress0 = ccc.Address Do mm = mm & ccc.Address & " , " Set ccc = .FindNext(ccc) Loop While Not ccc Is Nothing And ccc.Address <> firstAddress0 End If End With '取得した列番号を取得 col0 = Range(firstAddress0).Column Set ccc = Nothing '--------------------- ・ ・ ・（以下、全部の項目に対して同じ処理、列番号を取得） '※ここで配列が使えれば・・ Dim R As Long Dim LastRow As Long Dim myCell As Range '[期限管理]シートのAN列にＢ列＋Ｃ列＋Ｄ列を記載 With sh2 For R = 2 To d2max .Cells(R, "AN") = .Cells(R, col1) & .Cells(R, col2) & .Cells(R, col3) Next R End With 'システム更新データのAN列にＢ列＋Ｃ列＋Ｄ列を記載 With sh1 For R = 2 To d1max .Cells(R, "AN") = .Cells(R, "B") & .Cells(R, "C") & .Cells(R, "D") Next R '一致検索、なければ期限管理シートに追加 For R = 2 To d1max Set myCell = sh2.Columns("AN").Find(.Cells(R, "AN"), , xlValues, xlWhole) If myCell Is Nothing Then LastRow = sh2.Cells(sh2.Rows.Count, 1).End(xlUp).Row + 1 sh2.Cells(LastRow, col0) = .Cells(R, 1) sh2.Cells(LastRow, col1) = .Cells(R, 2) sh2.Cells(LastRow, col2) = .Cells(R, 3) sh2.Cells(LastRow, col3) = .Cells(R, 4) sh2.Cells(LastRow, col4) = .Cells(R, 5) sh2.Cells(LastRow, col5) = .Cells(R, 6) sh2.Cells(LastRow, col6) = .Cells(R, 7) sh2.Cells(LastRow, "AN") = .Cells(R, "AN") End If Next R End With Set myCell = Nothing '''②更新------------------------------------------ 'シート1のデータをもとにAN列が一致すれば上書き ' '最終行番号 d1max = sh1.Cells(sh1.Rows.Count, 1).End(xlUp).Row Dim y As Variant Dim cc As Range 'シート２のA1からA列のデータ最終行までのセルを１つずつ取り出す For Each cc In sh2.Range("AN2", sh2.Range("AN" & Rows.Count).End(xlUp)) 'その値でシート１のA列をMach検索 y = Application.Match(cc.Value, sh1.Columns("AN"), 0) If IsNumeric(y) Then '１行分を転記 cc.Offset(0, col4 - 40) = sh1.Cells(y, 5) 'ＭＧ確認日 cc.Offset(0, col5 - 40) = sh1.Cells(y, 6) '発注日 cc.Offset(0, col6 - 40) = sh1.Cells(y, 7) 'ＣＬ報告日 End If Next '追加行を削除 sh1.Columns("AN").Delete xlShiftToLeft sh2.Columns("AN").Delete xlShiftToLeft Set sh1 = Nothing Set sh2 = Nothing End Sub
フォルダー内のパワーポイント（*.ppt）を全て印刷するエクセルVBAを教えてください。"フォルダA"内に印刷したい資料ショートカットをまとめており、 "フォルダA"内のショットカット先のpptを全て印刷するようなコードを教えてください。 よろしくお願いします。
Excelで複数行(可変)にわたるセル内容を連結表示したいのですが、 どのように関数指定すればよいでしょうか。ご教授ください。（添付シート参照） ①C列のグループメンバー名を、D列赤ペイント部分に「名前」「カンマ(,)」付きで表示する ②赤ペイント部分は関数指定する ③グループメンバー数は可変だが、B列に人数指定されている ※古いExcel2007のため関数textjoin等は使用できず
Visual Studioでdatetimepickerを２つ使い、datetimepicker1よりdatetimepicker2の日付が下回ることのないようにする方法はありませんか？また、datetimepicker1の日付がdatetimepicker2を上回ることのないように設定する方法もありませんか？
Excel2013 VBA ／行の高さの自動調整とwebメールの返信について VBA勉強中です。以下のようなVBAを作成したいと思い、お知恵をお借りできれば助かります。 •sheet1はチェックシート •sheet2は文面 →sheet1でチェックした項目が、sheet2のA列3~8行にわたり反映(文面にはダミー文言があり、チェック項目がダミー文言に反映)。 もともと4~7は非表示で、チェックした項目によって、再表示される(チェック項目の数によって、文字量が増える)。 上記のようなシートがあり、下記の設定をしたいと思います。 ①sheet2 3~7行の高さの自動調整 「コードの表示」に以下のコードを入れたのですが、自動調整されませんでした。 どのようにすればいいでしょうか。 (sheet2に直接入力するのではなく、sheet1から反映させているので、うまく動かないのでしょうか??) Sub 高さの自動調整() Range ("3:7").Rows.AutoFit End Sub ②sheet2でできた文面をwebメールで返信 sheet2に設置した「返信ボタン」をクリックすると、sheet2で作成した文面が、予め立ち上げていた受信メールに返信メールとして文面を反映(送信まではしなくてokです)させることはできますでしょうか？ ちなみに、それぞれのsheetにはロック(ロックされていないセル範囲の選択、列の書式設定、行の書式設定、オブジェクトの編集は許可)をかけているのですが、上記①②をする上では問題ないでしようか。 わからにくい説明となりすみません。 どうぞよろしくお願いいたします。
URLのイコールから先の部分って解読可能でしょうか？以下のテキストを含んだURLがあります。（これは架空の文字列です） php?TKN=99568ca8iGidpXqr2vQR3574Mvw これを解読して別ページへ行きたいのですが、方法ありますか？ Base64と言うのに行き当たってデコード（？）してみましたが、 それではダメでした。
VB.NET 「ウェイト処理について」 以前質問した「ウェイト後メッセージ」の応用みたいなことをしたいのです。 Timer(ウェイト処理)内に本処理は入れたくないのです。Q.以下のコードでウェイトをかける処理はどのようにしたらよろしいでしょうか。 ※'コメント部 にウェイトを入れるようにしたい Dim good as integer Dim result_bad as integer Private Sub Button1.Click() RichTextBox1.Text = "チェック開始します" Call CheckACT（） ’ここで1秒ウェイト If good >= 1 Then RichTextBox1.Text = ”問題ありません。" ElseIf good = 0 Then Call BAD_ACTION() EndIf RichTextBox1.Text = ”チェック終了します。” ’ここで1秒ウェイト End Sub Private Sub Check_ACT() ’ここで1秒ウェイト RichTextBox1.Text = "チェック実行中" ～ ～ ～ End Sub Private Sub BAD_ACTION() RichTextBox1.Text = ”問題があるので処理を中断します” resuly_bad = result_bad + 1 Label1.Text = result_bad ～ ～ ～ End Sub 上記コード以降でもすぐウェイト処理を呼び出せるようにしたく、 処理→ウェイトだけ→処理 が望ましいのですが・・・
Access VBAを用いて成果物を作成しないといけません。 明日、7日（火）午前中には何を作成するかを決めます。 しかし、未だに良い案が思い浮かばず。 何を作成すればいいんでしょうか？作成するものはスケジュール等ではなく、データーベースです。 どなたか案をください。 例）ゲームソフト貸出管理（過去に先輩が作成されたもの。）
visual studio 2015 のVBの質問です 初心者なのですが Form1 と Form2 があり、現在、実行するとFoprm1が起動しますこれをForm2を起動するようにしたいのと どうしてもフォームの移動がうまくいきません できれば引数AとBとCを持って行って 戻る時に返したいのですが、引数がなくても フォームの移動ができません ちなみにフォームは移動すると前のフォームは消えるのでしょうか？ Form1 から Form2 に移動して再度、Form1 に戻る時 Form2 を消したいのです
OpenFileDialogで複数のファイル名をListBoxに表示する方法を教えてください。ファイル名のみを表示する方法は http://blog.hiros-dot.net/?p=1157 ここのサイトで分かったのですが、フォルダ名を含めたフルのパス名の表示がしたいのです。。。 よろしくお願いします。
巨人の杉内は、今何してますか？(´・ω・`)
VB2012を使っている初心者プログラマーです。ちょっと、わかんないとこがあり質問させてもらいます。私は今、ピクチャボックス1、2、3の背景を透明化してピクチャボックスが重なっても消えたりしないで後ろのピクチャボックスが表示されるように作っているのですができません。一通り調べてみましたが解決できずです。どなたか教えてくれませんか？？？
CSVファイルで項目にダブルクオーテーションを付与した形で作成しなければいけません。 エクセルファイルから上記条件のCSVに変更する方法はありますか？ちなみに他にも条件があります。 見出し無し、改行コード（ＣＲ／ＬＦ）付与、シフトＪＩＳコード、全項目半角 エクセルからCSV作成するためにマクロを書いています。 もし可能ならマクロに上記条件のプログラムを書くことってできますか？ ご教授のほどよろしくお願いいたします。 マクロ ================================================== Sub CSV作成() Dim myFileName myFileName = Application.GetSaveAsFilename(FileFilter:="CSVファイル (*.csv,*.csv") If TypeName(myFileName) = "Boolean" Then Exit Sub Application.ScreenUpdating = False Range("A2:N73").Copy With Worksheets.Add .Cells(1, 1).PasteSpecial Paste:=xlPasteValues .Move End With With ActiveWorkbook .SaveAs Filename:=myFileName, FileFormat:=xlCSV .Close False End With Application.ScreenUpdating = True End Sub =============================================
①クリップボードにコピーした文字列"ABC"を"ｼｰﾄ1"のセル"A1"に貼り付ける マクロを作成しましたが, ②クリップボードにコピーし忘れて、マクロを実行するとエラーになります。その場合はエラーにならずに、コピー前の状態に戻って、コピーし直したいです。 つまり、①の頭に戻るようにマクロを作成したいです。 少し前から質問して悩んでいる超初心者です。よろしくお願いします。 サンプル Sub 052() Sheets("ｼｰﾄ1").Select Range("A1").Activate ActiveSheet.Paste ←ここでエラー
Access2013で質問です。 データ入力の際、コンボボックスで設定した選択肢が５つあります。 フォームを作成する際に、その選択肢５つをボタンで表示して 入力することはできますでしょうか？？
マクロについて教えてください。 シートごとにファイルを作りたいんですがエラーが出ます。 どこが間違ってますか？ シート1のみ作成されてすぐエラーが出ます。 Sub d() For r = 1 To 5Worksheets(r).Copy Next r EndSub
VBAについて、チェックボックスを使ったデータの移動についての質問です。 画像がエラーの為貼れずに申し訳ないのですが、当方は初心者ですので宜しくお願いします。◇やりたい事 「入力シート」にてチェックボックスにチェックした列の必要部分だけを「移動シート」に移動させていきたい。 ◇シート詳細 B4～Ｈ4 見出し 以下入力データ I列にチェックボックス Ｊ列に判定 チェックを入れた行のB～H部分を切り取って見出しのみの別シートに歯抜けのないよう上から順番に移動させていきたいのです。 なんとか調べながら作成しておりますが、似た所まではたどりついたのですがこれだと行を丸ごとコピーしているだけで必要な部分のみの移動になっておりません。 ぜひご教授お願いします。 Sub Test2() Dim tRow As Long, tCol As String tCol = "J" '判定のある列 With Worksheets("入力シート") For tRow = 5 To .Cells(Rows.Count, tCol).End(xlUp).Row If .Cells(tRow, tCol) Then .Cells(tRow, tCol).EntireRow.Copy _ Worksheets("移動シート").Cells(Rows.Count, tCol).End(xlUp).Offset(1, 0).EntireRow.Cells(1, 1) End If Next tRow End With End Sub
Excel（VBA）を使って特定の範囲のセルに入力されている内容を点対象に移動したいです。具体的に説明しますと dim w as int '列の数 dim h as int '行の数 というふたつの変数があるとき、 例えば、w = 4 , h = 5 の場合 図のsheet1のように文字が入力されていた場合、 図のsheet2のように文字を入力するプログラムを作成したいです。 周りのセルには他の内容が入力されているのでいじらないようにしたいです。 どのようにしていいのかさっぱりわからず困っています。よろしくお願いいたします。
フレン、グラスバレー、翡翠のコード名は？
Excel2016 VBAで文字列の抽出をしたい。現在、VBAを使って「P**」という名前のシート内の全文字列(図形内のテキスト含む)を 「翻訳作業」というシートのB5から下へリストとして抽出するものを作っています。 リスト化するところまではなんとか出来上がったのですが、 さらに除外する文字列を設定し、それに該当するものであれば リストへ反映せず、次の文字列へ移るという事が行いたいと考えています。 --------------------------------------------------------------------- Sub リスト化() Dim ws As Worksheet Dim RowCnt As Integer Dim ColCnt As Integer Dim cnt, cnt2 As Long Dim a, ab, ac As Variant Dim y As Integer Dim x As Integer Dim z As Integer Dim shp, Gshp, xTxt As Variant Dim SplitCnt As Long z = 5 For Each ws In Worksheets With ws If .Name Like "P##" Then RowCnt = .Cells.SpecialCells(xlLastCell).Row ColCnt = .Cells.SpecialCells(xlLastCell).Column For y = 1 To RowCnt For x = 1 To ColCnt If .Cells(y, x) <> "" Then a = .Cells(y, x) ab = Trim(a) If IsNumeric(ab) = False Then ac = Split(ab, vbLf) For SplitCnt = 0 To UBound(ac) cnt = WorksheetFunction.CountIf(Sheets("翻訳作業").Range(Cells(5, 2), Cells(z, 2)), ac(SplitCnt)) If cnt = 0 Then Sheets("翻訳作業").Cells(z, 2) = ac(SplitCnt) z = z + 1 Else End If Next SplitCnt Else End If Else End If Next x Next y For Each Gshp In .Shapes If Gshp.Type = msoGroup Then Gshp.Ungroup Else End If Next Gshp For Each shp In .Shapes If shp.TextFrame2.HasText Then xTxt = shp.TextFrame2.TextRange.Characters.text If xTxt <> "" Then ab = Trim(xTxt) If IsNumeric(ab) = False Then ac = Split(ab, vbLf) For SplitCnt = 0 To UBound(ac) cnt = WorksheetFunction.CountIf(Sheets("翻訳作業").Range(Cells(5, 2), Cells(z, 2)), ac(SplitCnt)) If cnt = 0 Then Sheets("翻訳作業").Cells(z, 2) = ac(SplitCnt) z = z + 1 Else End If Next SplitCnt Else End If Else End If Else End If Next shp Else End If End With Next ws End Sub ------------------------------------------------------------------------- For y , x で囲まれている部分でセルの文字列を判定、出力。 For Each Gshp から下の部分で図形内の文字列を判定、出力させています。 数字のみ、空白のみは除外するようにしているのですが 使い勝手を良くするために「翻訳作業」内のJ5から下に 除外リストを作り、そのリスト内に含まれる文字列であれば 除外して次の文字列の判定をさせたいです。 欲を言えば、除外リストに入力した文字列の隣のセル(K列) で【～から始まる】や【～で終わる】【～を含む】【完全一致】 をドロップダウンリストで選択しておき、それに対応して 除外の判定が出来ればと思っています。 ご教授願います。
Excel vbaについて質問です。今vbaで電卓を作っているのですが Private Sub CommandButton1_Click() tar_t_t = TextBox1.Text tar_t_t_t = TextBox2.Text bt = VarType(TextBox1) btt = VarType(TextBox2) c1 = ComboBox1.Value TextBox3 = Val(tar_t_t) + Val(tar_t_t_t) tar = TextBox3 If (c1 = "+") Then TextBox3 = Val(tar_t_t) + Val(tar_t_t_t) tar = TextBox3 ElseIf (c1 = "-") Then TextBox3 = Val(tar_t_t) - Val(tar_t_t_t) tar = TextBox3 ElseIf (c1 = "*") Then TextBox3 = Val(tar_t_t) * Val(tar_t_t_t) tar = TextBox3 ElseIf (c1 = "/") Then TextBox3 = Val(tar_t_t) / Val(tar_t_t_t) tar = TextBox3 ElseIf (bt = vbString) Then TextBox3 = "#構文エラー" ElseIf (btt = vbString) Then TextBox3 = "#構文エラー" End If End Sub (テキストボックス1,2&コンボボックス1はユーザーフォーム上に既存) これを実行すると、計算は普通にできるのですが、最後から二つのif分 これです「 ElseIf (bt = vbString) Then TextBox3 = "#構文エラー" ElseIf (btt = vbString) Then TextBox3 = "#構文エラー" 」 が判定できずに計算結果に0が出てしまいます。 どうすればよいでしょうか?
ExcelのVBAであいまい検索をしたいのですが、ネットで見つけたお手本を元に作成したいです。 お手本は完全一致検索のためこれをあいまい検索に変更する方法を教えてください。完全なる初心者なので下記のプロシージャをどう書き換えたら良いか教えてください！ 引用もとはhttp://www.atmarkit.co.jp/ait/articles/1404/10/news024.htmlです。 Private Sub 検索実行(検索対象 As String) Dim searchName As String searchName = 検索対象 If searchName = "" Then MsgBox "検索する対象を入力してください。" Else Dim i As Long Dim no As Long For i = 0 To 一覧リストボックス.ListCount - 1 If 一覧リストボックス.List(i) = searchName Then no = i 一覧リストボックス.ListIndex = no End If Next Index = no + 3 Worksheets("個人情報データ").Select Rows(Index).Select Dim 行番号 As Integer 行番号 = ActiveCell.Row IDラベル.Caption = Cells(行番号, 1) 氏名ラベル.Caption = Cells(行番号, 2) 性別ラベル.Caption = Cells(行番号, 3) 生年月日ラベル.Caption = Cells(行番号, 4) 郵便番号ラベル.Caption = Cells(行番号, 5) 住所ラベル.Caption = Cells(行番号, 6) 電話番号ラベル.Caption = Cells(行番号, 7) メールラベル.Caption = Cells(行番号, 8) End If End Sub よろしくお願いします。
VBAでIEからJavaScriptを含むコードを取得したい ・ ・ ・ VBAでWEBスクレイピングを製作中です。WEBサイト上に色情報が載っている箇所があり、HTMLでは色コードが指定されています。 取得したいのは色名なのですが、HTMLコード上には色名は記載されていません。 HTMLコードの下にJavaScriptが出力されており、下記のようになっています。 <div id="color_[色コード]" class="***" style="background-color:#fcb8b8;" onclick="color_select([色コード],[アイテムコード])"></div> <script type="text/javascript"> var colors = new Array(); var label_colors = new Array(); colors[0] = [色コード]; label_colors[色コード] = 'PINK'; var count_colors = 0; </script> 色名はこのスクリプト内の「label_colors」を取得したいのです。 innerHTML、innerText、outerHTML、outerText などでは取得できませんでした。 その他のHTML部分は読み込めているので、画面の情報が取得できていないということはありません。 ちなみに、WEBサイトは1ページ内に複数アイテムがあり、それが何ページもあります。 アイテムの詳細情報はアイテムの画像をクリックするとjQueryで呼び出されます。 システム内では、ページ全体の情報はNavigateで取得し、 その後アイテムのURLをURL.clickで詳細画面を呼び出しています。 解決方法をご存知の方がいらっしゃいましたら、ご教示ください。
印刷ボタンを押さないと印刷できないマクロがうまく実行されません。 皆さんのお知恵を拝借し、下記マクロを作成しましたが、完成度８０％です。 なぜうまく動作しないのかお知恵を貸してください。【やりたいこと】 ①入力不備項目があると印刷できないマクロを印刷ボタンに組み込む。 ②印刷ボタンにマクロを組み込むため、ツールバーから印刷できないようにする。 【動作状況】 ファイルを開いた最初の動作は①②とも正常に作動 ①のマクロを実行した後だと、②が動作しない。 ※「印刷ボタン」を押して入力不備エラーが出た後、ツールバーから印刷できてしまう 【作成したマクロ】 ①標準モジュールに記載 Private Sub 額縁1_Click() Application.EnableEvents = False Dim ws As Worksheet, flag As Boolean If Range("CN155") >= 1 Then MsgBox "未入力項目があります" Exit Sub End If If Range("CN155") = 0 Then Worksheets("印刷画面").PrintOut End If Application.EnableEvents = True End Sub ②ThisWorkbookに記載 Private Sub Workbook_BeforePrint(Cancel As Boolean) MsgBox "印刷ボタンを押して印刷して下さい" Cancel = True End Sub 何卒よろしくお願いいたします。
この表示される検索ボックス内って何ですか？全然わかんないです。どこにもないですし。
マクロについて教えてください フォームから情報を入れて「入力」ボタンを押すとエクセルのシートにデータが繁栄されます。その際に、ｍ列とN列には下記のように Range("B3:k3").Select Selection.Copy Range(Selection, Selection.End(xlDown)).Select Selection.PasteSpecial Paste:=xlFormats Range("m3").Formula = "=IF(OR(H3="""",TYPE(H3)=2),G3*1000,G3*H3)/1000" Range("n3").Formula = "=M3/VLOOKUP(D3,INDIRECT(C3),IF(E3=""付"",2,3),false)" 関数が入力されています。それを下のデータで入力のたびに3行目から4行目とコピーされるように しています。 Range("m3:n3").Select Selection.Copy Dim roco Range("b3").Select Range(Selection, Selection.End(xlDown)).Select roco = Selection.Rows.Count + 2 Range(Cells(3, 13), Cells(roco, 14)).Select Selection.PasteSpecial Paste:=xlFormulas ActiveWindow.SmallScroll Down:=30 Selection.Borders.LineStyle = xlContinuous Columns("b:n").AutoFit ActiveSheet.Protect Range("b2").End(xlDown).Select Selection.Offset(1, 0).Select でここに新たにO列に 関数を入れて下にコピーされるようにしたいのですが。単純に Range("B3:k3").Select Selection.Copy Range(Selection, Selection.End(xlDown)).Select Selection.PasteSpecial Paste:=xlFormats Range("m3").Formula = "=IF(OR(H3="""",TYPE(H3)=2),G3*1000,G3*H3)/1000" Range("n3").Formula = "=M3/VLOOKUP(D3,INDIRECT(C3),IF(E3=""付"",2,3),false)" + Range("o3").Formula = "==VLOOKUP(B3,INDIRECT(C3),4,FALSE)" と入力しても繫栄されません。 M列n列と同様に下にコピーできるようにするにはどうすればよろしいでしょうか ご教授頂ければ幸いです。
Excel VBAの作成する場所について、「標準モジュール」に作成する場合と「ThisWork Book」の「General」のコードの中に作成（添付の図の場所）するのと、どういった違いがあるのでしょうか。違いとメリットデメリットが分かる方、ご教示お願いします。
外部起動のOutlookで自動送受信が動きません VBScriptでOutlook2016を起動しているのですが、自動送受信が動きません。一度手動で送受信を行えば自動送受信が動くようになるのですが、そうしない場合はいくら待っても自動送受信が動きません。 なお、手動でOutlookを起動した場合は普通に自動送受信が動きます。 VBSでの起動方法は「CreateObject("Outlook.Application")」を使用しています。 関係あるかわかりませんが、外部起動の為か通知領域のOutlookアイコンに「Outlookが他のプログラムによって使用されています。･･･」といったメッセージが出ています。 解決に至るOutlookの設定やVBSの記述などはありますか？
エクセル2010共有ブックについての相談です。仕事で共有ブックの表を作成しサーバーに保存、各操作者が（※共有ではない）別のブックのシートで計算された計算結果の表をコピーし、共有ブックの表にマクロボタン（値と元の書式を保持した貼り付けと、貼り付け先の表のセルの書式にフォント等を修正するマクロ）、を使って張り付ける作業を行えるようにしたいのですが、問題が起きています。 問題とは「操作者A」のPCで行った貼り付けはAの画面上では問題なく表示されるのに、「操作者B」の画面上では表示が崩れ、 １）フォント、セルの書式設定がコピー元のままになる。 または、２）フォントは貼り付け先の書式に修正されているが、セルの「中央揃え」が右揃えになっており、また罫線が張り付けた部分だけ削除される。 ３）全ての貼り付けたセルで、操作者Aの貼り付けたセルが他の操作者のPC上ではセルにロックがかかり、シートの保護をかけているためそのセルを編集できなくなる。各操作者が張り付けたセルはそれぞれのPC上ではロックがかかっていないため、「空白のセル又は、自分が張り付けたセルのみ編集できる」状態になっている。 といった問題が解決できません。 仮に操作者A、Bとしましたが互いに同じ問題が起きており共有ブックなのにそれぞれのPC上で違った表示になってしまっています。いったん保存終了して共有ブックを立ち上げなおしても状況が変わりません。 原因かどうか分かりませんが、コピー元の計算結果の表は、計算結果を表示するだけのセルなのでロックがかかっています。また関係ないような気はしますが条件付き書式は使っておりません。 参考までに貼り付けに使っているマクロのコードは以下になります。 Sub 値と書式の貼り付け後時間記入フォント変更とセル色変更() ' ' 値と書式の貼り付け後時間記入フォント変更とセル色変更 Macro ' ' ActiveCell.Previous = Format(Now, "hh:mm") Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _ SkipBlanks:=False, Transpose:=False Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _ xlNone, SkipBlanks:=False, Transpose:=False Selection.Font.Bold = False With Selection.Font .Name = "メイリオ" .Size = 13 .Strikethrough = False .Superscript = False .Subscript = False .OutlineFont = False .Shadow = False .TintAndShade = 0 .ThemeFont = xlThemeFontNone End With Selection.Font.Bold = False With Selection.Interior .Pattern = xlNone .TintAndShade = 0 .PatternTintAndShade = 0 End With End Sub 原因や解決法、または共有機能を使わずに意図した作業を行える方法等をご教示お願いします。
access2016 VBAについて質問です。フォームをまたいでテキストボックスの代入をVBAで行いたいのですが、 (OKボタンを押すと、Fスタートというフォーム画面のテキストボックスに値を代入したい) Private Sub OK_Click() Dim a As Integer Dim b As Integer a = Me.txt1 b = Me.txt2 Forms!Fスタート!txttemp = a Forms!Fスタート!txthum = b End Sub と書いて実行したら”「Fスタート」が見つかりません。”となり、できませんでした。 教えていただけると助かります。 よろしくお願いします。
前回の質問の続きなのですが、自分では解決できないのでお知恵をお貸し下さい。Aのデータには重複しているものは無いのですが（見た目）、Aのデータの範囲に条件付書式で、重複しているデータに色付けしたところ、38個のデータが抽出されました。 しかし、一つとして見た目同じものはないのです。 数字を文字列として扱うとき、たとえば00032と00320は同じになってしまうのでしょうか？ 00032 00035 00040 00320 00510 00830 00880 008E1 008E2 008E6 008E7 05100 05400 07200 07300 09100 09200 32E00 32E01 35E00 40E00 51E01 51E02 540E1 590E3 590E6 59E04 59E07 72E02 73E02 80E00 80E01 80E05 80E06 83E01 88E01 91E02 92E02 これらが重複しているといわれるデータです。どれがどれと重複しているのかさえわかりませんが、お分かりになる方いらっしゃいましたら、教えて下さい。 また、この場合どうすれば重複と見られないのか？方法があれば教えてください。 よろしくお願いします。
Google検索結果のリンクを開く VBAでInternetExplorerのオブジェクトを作成し、 検索結果をAccessのデータとして収集することを考えてます。AccessVBAでADODBの参照設定をしてRecordsetオブジェクト を生成、設定しようとしたら実行時エラーが表示されました。 どう修正すればデータテーブルを開くことができるでしょうか？ ご存知のかた、ご教示ください。 ソースコードは以下の通りです。 '変数宣言 Dim oIE As InternetExplorer, cnt As Integer Dim oIE2 As InternetExplorer Dim url As String, code As String Dim objL As Object, objA As Object Dim RS As New ADODB.Recordset, CN As New ADODB.Connection 'Internet Explorerオブジェクト生成 Set oIE = CreateObject("InternetExplorer.Application") Set oIE2 = CreateObject("InternetExplorer.Application") Set RS = New ADODB.Recordset Set CN = New ADODB.Connection CN = CurrentProject.Connection RS.Open "Yahoo知恵袋", CN, adOpenStatic
vb2005です。 データの読み込みについて質問です。 普段、ｃｓｖをもちいてデータを読込、書き込み、保存、追加保存を行っています。データグリッドができるとかできないとか・・・・ 何か、csvを用いずに読み込み、書き込み、保存、保存、追加保存ができる方法はありますか。 よろしくお願いします。
エクセルVBAでの困りごと 『不要ね。』 </center> </h6> <HR SIZE=3 NOSHADE color=#676767> <!-- <center> <a href=mail_game_af3.php?page=result&PHPSESSID=アクセス毎の変数>結果は?</a> </center> --> <center> <form action="mail_game_af3.php?menu=no&page=result&jingle=15&PHPSESSID=アクセス毎の変数" method="post"><input type="hidden" name="PHPSESSID" value="アクセス毎の変数5" /> <input type=hidden name=command value=1> <input type="submit" name="game_result" value="結果は?" class=s_submit> </form> </center> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tr><td bgcolor=#676767 align=center class=bg_img_battle2 height=50 align=center> <h6> <span style="color:#ffffff;"> <font color=white> 現在、TAB回数で代用しておりますが、添付画像のようなボタンを押したいんです。 押すための記述がうまくいきません。 どなたかご教授お願いします。
Excel VBAからVBScriptを実行して結果をVBAに戻す方法はないですか？VBScriptの実行はできるのですが結果をVBAに戻すことができないです。 Excel VBA Shell "Wscript.exe C:\xxx\x.vbs" MsgBox strResult ’空っぽなんですが本当はVBScriptのstrResultをほしい -------------------------------------- VBScript(x.vbs) strResult="a"&"b"
下記のVBAは アクロバットPRO11でエクセルからリスト通りにA列のデータを自動出力するプログラムですが、A列のデータを上から順番に出力していく際、B列に”ホチキスあり”と表記してある場合は 印刷ドライバを切り替えて出力したいと思っています （ドライバは２種類あり、普通に出力するドライバとホチキス留め設定がしてあるドライバ）。 オンデマンドプリンター制御が分からず、VBAで対処したいのですが、 IF文を使ってドライバの切り替えたり、戻したりするには、下記のプログラムをどのように変更したらよいかどなたかご教示ください。 ちなみに目的は、ホチキス留めなしのデータAを100部出力してから、ホチキス留めありのデータBを100部出力して、A、B、A、Bと手で並び替える動作を省略することです。 Sub printPdf() Dim l As Long Dim oWsh As Object, oEx As Object Dim vFile As Variant Dim myPath As String Dim xPrt As String MsgBox Application.ActivePrinter With Application xPrt = .ActivePrinter .ActivePrinter = "例 ここはデフォルトのプリンタ名" End With 'Application.Dialogs(xlDialogPrinterSetup).Show myPath = ActiveWorkbook.Path Set oWsh = CreateObject("WScript.Shell") For l = 1 To Cells(Rows.Count, 1).End(xlUp).Row If Len(Trim(Cells(l, 1).Value)) > 0 Then Application.Wait Now + TimeValue("00:00:02") Set oEx = oWsh.Exec("CMD /C DIR /B /S " & myPath & "\*" & Trim(Cells(l, 1).Value)) Do While oEx.Status = 0 DoEvents Loop For Each vFile In Split(oEx.StdOut.ReadAll, vbCrLf) If Len(vFile) > 0 And Len(Dir(vFile, vbNormal)) > 0 Then Shell """C:\Program Files(x86)\Adobe\Acrobat 11.0\Acrobat\Acrobat.exe"" /t """ & Trim(vFile) & """" End If Next Set oEx = Nothing End If Next Set oWsh = Nothing End Sub
vb2015を使っています。 印刷について質問します。 フォームの印刷ではなく、タブコントロール内のタブページの内容を 別々に画像保存、印刷を行いたいです。例えば、タブコントロールにタブページが5枚あるとして タブページ１枚目、2枚目 といった感じに別個保存（できれば新規フォルダ内に保存）して、それらを印刷したいです。 どのように記述すれば簡単でしょうか。 ご教授ください。
エクセルのマクロの勉強について。 今まで興味はあったが、使う機会も無く、難しそうで私には無理！と思っていました。 しかし、職場が変わり、マクロを使えるように、と言われました。上司も私がマクロの知識、経験ともゼロだということは、分かっているので徐々にでいいので勉強するように、と。 そこで書店に行き、「よくわかるエクセルマクロ」のような初心者用の本を買い、一通り勉強しました。 しかし、実務では上記の初心者用の本より一歩（それ以上）上の内容が必要だと感じました。 ここで質問ですが、 ①マクロが組めるようにする勉強方法を教えてください。 たとえば、おすすめの参考書などなど。 ②ここで回答（質問に対して具体的なコードを答えている方など）されている方は、どのように勉強されましたか？ あくまでもエクセルのマクロが組めるようになれれば良く、高度なプログラミングを組めるようになりたい（いつかはなりたい、なってみたい笑）わけではありません。 今は独学で本やネットで勉強してますが、やはり専門の学校に通った方がよいのでしょうか？ （ネットだと私が知りたいピンポイントなことがなかなか無かったりすることも。。。） いい年した大人がこんな質問すること自体、お恥ずかしいですが、 みなさんのようになりたいのと、仕事に活かしたいので質問させていただきました。
エクセルのマクロのVLOOKUPについて質問です。 sheet1には Ａ列1行目から キー Ｂ列1行目から 番号 があり、キーを入力したら、番号をsheet2から引っ張ってくる。. sheet2には Ａ列1行目から 一次 あいうえお かきくけこ さしすせそ たちつてと なにぬねの Ｂ列1行目から 二次 abc def ghi jkl mno Ｃ列1行目から（Ａ列とＢ列を繋げた文字列） キー あいうえおabc かきくけこdef さしすせそghi たちつてとjkl なにぬねのmno Ｄ列1行目から 番号 1-2-3 4-5-6 7-8-9 10-11-12 13-14-15 Sub 番号() Dim line As Long Dim line2 As Range Sheets("sheet1").Select line = 2 Set line2 = Worksheets("sheet2").Range("C1:D6") On Error Resume Next Do Until Cells(line, 1) = "" Cells(line, 2) = Application.WorksheetFunction.VLookup(Cells(line, 1), line2, 2, 0) If Err.Number = 0 Then line = line + 1 Loop On Error GoTo 0 Set line2 = Nothing End Sub ここで質問です。 ① 上記コードを作成し、実行するとsheet2の元データが5行だけなので出来ますが、 これが約2万行（sheet1）あり、元データ（sheet2）も約100件ほどあります。 そうするとマクロ実行するとフリーズしてしまいます。 2万行もあるとフリーズするものなんでしょうか？ それとも私のコードが悪いのでしょうか？ ② 番号をVLOOKUPで引っ張ってくると日付表示になってしまいます。 これを元データの番号（文字列）通りにするにはどうしたら良いのでしょうか？ どうか、お力添えよろしくお願いします。 （windows7使用）
複数のエクセルファイルを一つのエクセルファイルにまとめたいのですが，A~D列に数値が入っているファイルが30個程度あり，それらのファイルのB列をファイルごとに列方向にまとめるようにしたいです．A列はどれも同じで，できればA列一つとファイルの個数分のB列を含むファイルを作りたいのですが，VB初心者でうまくできません． 方法のご教授お願いします．
VBAマクロ作成について質問です。 下記条件でマクロ作成しようとするとどのようになるか、ご教示頂けないでしょうか。（条件） シート内のH列（「H4」から「H23」）の「判定」に、G列の「平均点」が60点未満を”不合格”と文字が入力されるマクロ（プロシージャ）を作成してください。 ・マクロは標準モジュールに作成する ・マクロ（プロシージャ）名は「成績」とする。 ・変数「CellGyo」 を長整数型（Long）で宣言する。 ・For...Nextステートメントを使用して、セルの行数を繰り返し処理で取得する ・宣言した変数「CellGyo」 は、For...Nextステートメントのカウンタ変数 として使用する ・For...Nextステートメントに使用する初期値は「4」、最終値は「23」にする ・60点未満を判断する条件分岐にはIfステートメントを使用する 初心者で不明点多く、作成例を教えて頂けたら助かります。 よろしくお願いいたします。
excel2010でVBA勉強中ですが、開発画面をいじってしまい表示が消え元に戻せなくなってしまいました。初期設定に戻すにはどのようにすればいいでしょうか？
excel vba初心者です。変数名は自分で作成していいものでしょうか。
エクセルVBAのディクショナリーの使い方がよくわかりません。アイテムで変数を扱うにはどのようにすればよいのでしょうか。ディクショナリーにアイテムを追加した後、変数の値が変わればディクショナリのアイテムの値も変わると思ったのですが、変わらないみたいです。そもそも使い方がおかしいのでしょうか。 Windows8.1,Excel2013 ------------------------------------------------------------- '参照設定 Microsoft Scripting Runtime Sub test() Dim 変数1 As Long Dim 変数2 As Long 変数1 = 123 変数2 = 456 Dim dic As Scripting.Dictionary Set dic = New Scripting.Dictionary With dic .Add Key:="Key1", Item:=変数1 .Add Key:="Key2", Item:=変数2 End With 'ここでは、123 と 456 となっている。 For i = 0 To dic.Count - 1 Debug.Print dic.Items(i) Next 変数1 = 987 変数2 = 654 'ここでも、123 と 456 となる。ここで 987 と 654 にする方法は？ For i = 0 To dic.Count - 1 Debug.Print dic.Items(i) Next End Sub
VB.NETで質問です。例えばボタンが３つあって、どのボタンでも同じエラーメッセージ（日本語で５０文字ほど）を表示するとする場合、そのメッセージの文字列は、クラス内の変数（または定数）として持った方がいいのでしょうか。それとも、それぞれのTRY文の中にそれぞれ記述した方がいいのでしょうか。 可読性やメンテナンス性は前者の方がいいのでしょうが、メモリの消費や速さの点でどうなのかなと思った次第です。
製造年月日から賞味期限をエクセルで計算して出す方法を教えてください。 例えば、製造年月日が2016.4.1で賞味期限360日間（製造日含む）の場合の計算方法。 詳しく教えてください。
エクセル、マクロの超初心者です。 複数のひとが扱うファイルの為、表示非表示がいつもややこしくなっているのでマクロを作る事になりました。 A列で、「1」と入力されている行は非表示にし、「＊」と入力されている行は表示するような作業を一度にしたい為ネットサーフィンしながら拾いつつマクロを2つ作成しましたが、両方共1度のマクロ実行でそのブックにあるすべてのシート（30近くある）に実行したいと思っていますがどこをどう変えたら良いのかわかりません。 教えて下さると助かります。 Sub macro1 Dim idx As Long Count col As String = "A" Apprication.ScreenUpdating = False For idx = 1 To Range(col & "65536").End(xlUp).Row If Cells(idx, col).Value = "1" Then Rows(idx).Hidden = True End If Next Application.ScreenUpdating = True End Sub --------------------------------------------- Sub macro2 Dim idx As Long Count col As String = "A" Apprication.ScreenUpdating = True For idx = 2 To Range(col & "65536").End(xlUp).Row If Cells(idx, col).Value = "＊" Then Rows(idx).Hidden = False End If Next Application.ScreenUpdating = False End Sub よろしくお願いいたします。
エクセルのマクロでｐｄｆを貼りつける方法を教えてください。 ｐｄｆを選択するとエラーになってしまいます。よろしくお願いします Dim SH As Double Dim SW As Double Dim SL As Double Dim ST As Double Dim PH As Double Dim PW As Double Range("B1:B12").Select With Selection SH = .Height SW = .Width SL = .Left ST = .Top End With If Application.Dialogs(xlDialogInsertPicture).Show = False Then Exit Sub With Selection PH = .Height PW = .Width If PH > PW Then .Height = SH .Width = PW * SH / PH If .Width > SW Then .Height = PH * SW / PW .Width = SW End If Else .Height = PH * SW / PW .Width = SW If .Height > SH Then .Height = SH .Width = PW * SH / PH End If End If .Left = SL + (SW - .Width) / 2 .Top = ST + (SH - .Height) / 2 End With End Sub
ログイン画面を作りたいのですがユーザー名とパスワードLANを作り、テキストボックスにそれぞれ「ユーザー名を入力してください」と背景文字として薄文字でもいいので表示したいのですがいい方法はないですか?また、次回からログインを保持する、みたいな機能をチェックボックスをtrueにすれば実現できるようにしたいのですが、vbはstaticでもプログラムを終了してしまえば保持されないです。何かいい方法はないですか？
WebBrowserクラスを継承したクラスを作成していて、 OnDocumentCompletedメソッドをオーバラーライドしたいのですが、 コンパイルエラーとなります。コンパイル警告/エラー無しで正しく継承する具体的なコーディング内容を教えて下さい。 ■環境 Visual Studio 2012 C++ CLI ■ソース public ref class ClassHTTPAuto : WebBrowser{ virtual void OnDocumentCompleted(WebBrowserDocumentCompletedEventArgs e) override = WebBrowser::OnDocumentCompleted{//★ } }; ■コンパイルエラー内容 ★の箇所 'System::Windows::Forms::WebBrowser::OnDocumentCompleted' : 明示的なオーバーライドの署名に一致するメンバーはありません。 'ClassHTTPAuto::OnDocumentCompleted' : 関数は 'System::Windows::Forms::WebBrowser::OnDocumentCompleted' をオーバーライドしません 'override' : オーバーライド指定子の使用法が不適切です。'ClassHTTPAuto::OnDocumentCompleted' は基本 ref クラス メソッドと一致しません
Excel、マクロについての質問です。 もしも関数でも以下の事ができる場合はマクロでなくても構いません。 なるべく簡単な方法を教えていただけると助かります。シートに存在している表全てのセル結合解除し、図の様にA列の１列のみ、空白セルを交互に削除し、一番右の様な形にしたいと考えております。 左の図はあくまで参考として適当な余白を取ってありますので、正しいセル数は中央の図を回答頂けると助かります。 また、場合によっては、文字の後の空白セル数が４つ続き偶数の様な形になったり、５つ続く奇数のような形するので、交互に取ると先頭の文字もとってしまう可能性はないでしょうか？もし取れてしまう場合は何かいい方法があれば教えて頂けると嬉しいなと考えております。 (この図の他に表があり、そちらと合わせてやりたいことがあるので隣とセル数を合わせたいという考えで空白セルの半端な削除をお願いしております。) 例 あああ 空白 空白 空白 空白 いいい 空白 空白 空白 ううう 空白 空白 空白 空白 空白 ↓ あああ 空白 空白 いいい 空白 ううう 空白 空白 にしたいと考えております。無理なら交互で大丈夫ですが、もしよろしければそちらも教えて頂ければ幸いです。 言葉があまり上手でなく申し訳ありません、回答宜しくお願い致します。
VAR SHARED CK1 AS OBJECT CK1.ATTACH GETDLGITEM ( "CHECK1" )のように OBJECT定義されたチェックボックスが２０個以上あって、チェックをいっせいにクリア（リセット）したいのですが、 CHK1.SETCHECK 0 CHK2.SETCHECK 0 ・・・ CHK20.SETCHECK 0 を、 一括で書くにはどう記述したらいいですか？ FOR I=1 TO 20 ？？？ NEXT
エクセル マクロでの照合の質問です。 同じブックの中にSheet1～Sheet3までのシートがあります。Sheet2とSheet3は商品コードなどのデータがA列2行目から入っています。Sheet2とSheet3の1行目は見出しになります。 データはA列からR列まで入っています。 このSheet3のE列にある商品コードとSheet2のF列にある商品コードを照合して、 一致した場合、Sheet2のその行をSheet1の8行目から順に貼り付けるというマクロを組みたいです。 商品コードが入っているSheet3E列とSheet2F列は連続したデータで、途中に空白はありません。 Sheet1の1行目から7行目までは見出しなどになりますので、8行目以降に貼り付けるようにしたいです。 データ量は変化します。 何卒、ご教示ください。 よろしくお願致します。
突然のリクエスト失礼致します。 昨夜、次の様な質問に回答頂き、有難う御座いました。http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1416060165... 実は、昨夜頂いた回答を応用したいと思い、３時間くらい前から、検索したり、頂いた回答をアチコチいじったりしてみましたが、知識が無いもんで無理でした。 昨夜の質問は、任意選択した範囲をマクロで四捨五入する内容でしたが、今日お願いしたいのは、昨夜頂いた回答のマクロを利用して、決まった範囲に作動する様にして頂きたいのです。 F2~L2の各セルの数字を、小数点第4位を四捨五入して、小数点第3までをF2~L2に表示する様にして頂きたいのです。 目的のセルに、数式を入力して解決する方法だと、毎回四捨五入されるので駄目なんです。 違うセルに結果が入力されるマクロは、表が崩れるので、他のセルは使いたくないんです。 宜しくお願い致します。
エクセルで下記のような表があり、セルB2～B6には 関数が入っていて、横方向1行目に入る数値はデータによって可変となっています。これをマクロでB2～B6の関数を最終列までコピーしたいのですが オートフィルマクロだと、最終行まではやり方が分かるのですが最終列を判別させる方法が どうしても分からないのですが、何かいいやり方はあるでしょうか。 |1|2|3|4|~ A|関数1| B|関数2| C|関数3| D|関数4| E|関数5|
スクロールバーのバーのサイズを変更するのはどのプロパティ設定で出来ますか？visual studio 2015 C#ですが、VBもVCも同じだと思いますが、わかりません。 部品はhScrollBarです。
ExcelVBAについて質問です。 パラメータがいくつかある関数を計算して、 グラフに表示するようなプログラムを作成しました。スクロールバーでパラメータを調整できるようにしたのですが、 その結果が反映されるタイミングが遅くて困っています。 現在は、 「スクロールで値変化⇒マウスを離す⇒グラフに反映」 となっているところを、 「スクロールで値変化と同時にグラフに反映」 という風にしたいのですが、 どのようにすれば良いでしょうか。 プログラムが実行されるタイミングを変えれば良いと思うのですが、 詳しいやり方を教えていただけないでしょうか？ また、解説しているサイト等ありましたら、 教えていただけると嬉しいです。
エクセルに詳しい方教えてください B 取引業者名 C発送日 上記は手入力。 D 担当番号を入力すると 担当者名を検索して表示。印刷ボタンを押すと、BCEの入力項目が Dの番号で割り振ったシートに反映されて印刷というのをマクロで作成致しとおもっています。 上記の内容の中で下記部分でつまずいています。 ①Dで番号を打つときに誰が何番か分からなくなりそうなので、検索窓を作りたい。 ②印刷ボタンをトリガーにしたいのですが、印刷ボタンを表示する方法がわかりません VBAでボタンができたと思うのですが、上手く表示ができません。 宜しくお願い致します。
エクセル印刷マクロの登録をしたいのです 初心者なのでどうかよろしくお願いします エクセルで一つのシートに 8列10行の物を60個作り(ラベルシールになります) それぞれ印刷したいのですが 印刷枚数も全部違います。 こんな設定は出来るのでしょうか？
エクセルの関数で質問です。範囲内を特定の文字列を検索して、有った場合はセルにその文字列を 無かった場合は別な文字列を返す事ができないでしょうか? 例えば、範囲内に ”NG” と言う文字列を探し、一つでも有った場合は セルに”NG”を、無かった場合は”OK”を返す。
【緊急！】エクセルに関する質問です。セルに対象者が平成何年生まれかと何月生まれかの数字が分けて入っている状態のデータが大量にあります。 |年|月| |16|3| |15|5| こういった感じずらっとならんでます。 このデータを平成25年10月時点で対象者が何歳であったかの年齢を表示するデータに一括で書き換えたいのですが何かうまい方法はありますでしょうか。 よろしくお願いします。
excel vbaのIE操作について質問です！今IEを操作して自動でNETから情報を 収集しようと思ってますが google画像検索結果ページのソースコードが 取得できなくて困っています。 目的は google画像検索の結果ページから 100枚の画像を一括でダウンロードしたいです。 ソースコードを見ていけば 画像URLも取得できると思ったのですが 1部分しか取得できません。 chormeでCtrl＋shift＋iで ソースコードを表示できますが それと全く同じ内容をtxtファイルで 保存したいです。 いくつかNETにあるソースコードを 試してみましたが 取得できないように対策されているのか 1部分しか取得できませんでした。 または画像をクリックしてないので そのソースコードが読みこまれていないのか。 よろしくお願いします。 いや、決してエロ画像を取得しようなんて お、思っていませんよ、、、汗
VB.netで帳票を作りたいと思っています。マイクロソフトが提供しているReport機能とグレープシティが販売しているActive Reportではどのくらい機能や使いやすさ、工数が違うのでしょうか？ソフトは今後、パッケージとして長く使っていき、帳票の追加やカスタマイズなどもあるのですが、Active Reportを購入して使用したほうが良いか迷っています。
DXSDK_jun10をインストールしてvisual studio2015でDirectXのプログラムを始めました。ですが、自分でmein.cppで #include <d3dx9.h>のところでエラーが出ています。 インストールする時に欠損したのかと思い試しに友達のベースファイルを実行すると出来ました。 プロパティの設定がどこか間違っているのだと思いますが分からないので教えてください。
bat 処理でtxtファイルを作成する際の質問です。 現在以下のような記述で複数のtxtファイルをまとめて、ある文字列を検索しその文字ごとにtxtファイルを作成しようと考えています。分類してtxtファイルとして保存するところまでは出来ているのですが、文字コードがSJISに変換されているため文字化けしてしまいます。UTF-8で保存したいのですが可能でしょうか？ @ECHO OFF ECHO ========================================================== ECHO データ抽出を開始します。 ECHO ========================================================== PAUSE set PASS1="C:\Users" set PASS2="C:\Users\bunrui" type %PASS1%\*.csv > %PASS1%\ALL.txt ECHO ========================================================== ECHO ALL.txtを作成しました。 ECHO ========================================================== pause find "1" %PASS1%\ALL.txt > %pass2%111.txt ・ ・ ・ find "5" %PASS1%\ALL.txt > %pass2%555.txt pause exit
Windous OS 7、EXCEL 2013 64bit環境でマクロ開発しています。 EXCEL2007 32bitでは正常に動くコードで、2013 64bitではエラーが発生しました。Redim Preserveで初期化した配列flg-cを、配列が初期化されたかどうかを確認するために If Sgn(flg-c) = 0 Then としているコードで「内部エラーが発生しました」とのエラーメッセージが表示されました。 2007-32bitと2013-64bitで、渡した値、型、すべて同じです。 Windows UpdateおよびEXCELの修復も全て行い、 検索もいろいろしましたが、原因が分かりませんでした。 どなたかご存知の方、お知恵を拝借させていただけませんでしょうか。 よろしくお願いします。
vbの課題研究でなにか作成しなければいけません。 どなたかアイデアをください。
C言語についての質問です 二つの数値を入力し、その間の数値をファイルに出力するプログラムを作成したいのですが、このプログラムでは１つの数字しか出力されません。どうすればいいでしょうか？#include <stdio.h> int main(void) { int a; int b; int i; FILE *file; printf("数値1の入力:/n"); scanf("%d",&a); printf("数値2の入力:/n"); scanf("%d",&b); if(a==b) printf("もう一度入力してください/n"); else if(a<b) for(i=a; i<=b; i++) { file = fopen("range.txt","w"); fprintf(file,"%d",i); fclose(file); } else for(i=b; i<=a; i++){ file = fopen("range.txt","w"); fprintf(file,"%d",i); fprintf(file,"%d",i); fclose(file); } printf("出力しました./n"); return 0; }
入力.xlsのユーザーフォームから同じフォルダ内にある平成aa年1月～12月.xlsに入力したいんですけどどうしたらいいですか？平成aa年1月～12月.xlsにはメイン、1日～31日までシートがあります。 1日～31日までのシートには項目が1～9まで入力箇所があります。 入力.xlsのユーザーフォームには 平成□年□月 項目1 □ ～ 項目9 □ (登録) みたいな感じであります。 ユーザーフォームから平成□年□月.xlsの1日のシートを開いて入力して保存する事は可能ですか？ またどのようにしたらできますか？
・項目１から項目9を具体的にどのセルに転記するのかが判らないので暫定的にA1からI1に転記すると仮定しています。・ユーザーフォームの項目１から項目９の入力用のテキストボックスはTextBox1からTextBox9という名前だと仮定しています。 ・ユーザーフォームの年月日のテキストボックスはそれぞれTextBoxYear、TextBoxMonth、TextBoxDayという名前だと仮定しています。 ・CommandButton1で「平成aa年n月.xls」を開きます。 ・CommandButton2でユーザーフォームからシートへ転記します。 ・CommandButton3でシートを上書き保存して閉じます。 Option Explicit Dim bkPath As String Dim bk As Workbook Dim st As Worksheet Dim locations() As String 'ユーザーフォームの初期処理 Private Sub UserForm_Initialize() '現在のフォルダ名を保持しておく bkPath = ThisWorkbook.Path & "\" '項目１から項目９の転記位置を設定する SetLocations '各テキストボックスの初期値を設定する InitControls End Sub '各テキストボックスの初期値を設定する Private Sub InitControls() Dim i As Integer '年月日の初期値を設定する TextBoxYear.Text = Year(Now) - 1988 TextBoxMonth.Text = Month(Now) TextBoxDay.Text = Day(Now) '項目１から項目９をクリアする For i = 1 To 9 Me.Controls("TextBox" & i) = "" Next i TextBoxYear.SetFocus End Sub 'シートを開くボタンがクリックされた時の処理 Private Sub CommandButton1_Click() Dim bkName As String '既にブックが開かれていたら何もしない If Not bk Is Nothing Then Exit Sub 'ブックが存在しなければメッセージを表示する bkName = "平成" & TextBoxYear.Text & "年" & TextBoxMonth.Text & "月" & ".xls" If Dir(bkPath & bkName) = "" Then MsgBox bkName & "が見つかりません。" TextBoxYear.SetFocus Exit Sub End If 'ブックを開く Set bk = Workbooks.Add(bkPath & bkName) '日シートをアクティブにする Set st = Nothing On Error Resume Next Set st = bk.Worksheets(Val(TextBoxDay.Text) & "日") On Error GoTo 0 If st Is Nothing Then Set st = bk.Worksheets("メイン") st.Select '入力ブックをアクティブにする ThisWorkbook.Activate 'ユーザーフォームの項目１にフォーカスを設定する TextBox1.SetFocus End Sub 'シートを閉じるボタンがクリックされた時の処理 Private Sub CommandButton3_Click() Dim result '入力ブックをアクティブにする ThisWorkbook.Activate 'ブックが開かれていなければ何もしない If bk Is Nothing Then Exit Sub '確認メッセージを表示する result = MsgBox("保存してよろしいですか？", vbYesNoCancel Or vbDefaultButton2) If result = vbCancel Then 'キャンセルならブックを閉じずに戻る TextBox1.SetFocus Exit Sub Else Application.DisplayAlerts = False 'Yesならブックを上書き保存する（Noなら保存せずに閉じる） bk.Close (result = vbYes) Application.DisplayAlerts = True End If Set st = Nothing Set bk = Nothing '各テキストボックスの初期値を設定する InitControls End Sub '項目入力ボタンがクリックされた時の処理 Private Sub CommandButton2_Click() Dim i As Integer 'ブックが開かれていなければ何もしない If bk Is Nothing Then Exit Sub 'アクティブなシートが日シートでなければ転記しない Set st = bk.ActiveSheet If st.Name = "メイン" Then Exit Sub '項目１から項目９を転記する For i = 1 To 9 SetValue locations(i - 1), Me.Controls("TextBox" & i) Next i 'メッセージを表示する DoEvents MsgBox "転記しました。" CommandButton3.SetFocus End Sub 'テキストボックスの内容をシートに転記する Private Sub SetValue(cell As String, data As String) On Error Resume Next st.Range(cell).Value = data On Error GoTo 0 End Sub '項目１から項目９の転記位置を設定する Private Sub SetLocations() 'ここでの設定は暫定的です。実際の転記位置に修正して下さい。 locations = Split("A1,B1,C1,D1,E1,F1,G1,H1,I1", ",") End Sub このコードのまま動かすと転記されるのが1行目だけなんですけどどうすれば下の行に転記されますか？ またシート開くときにブックが平成28年1月1.xlsになるのはなぜですか？
ネット銀行でログインするとき、ＩＤやパスワードを入力していますが、入力するところにポインターを合わせ、キーボード等で入力していきますが、それらの動作をプログラムで組み、ブラウザーを立ち上げ、ＩＤとパスワードをプログラムにより自動で入力し、ログインまでできるようにするプログラムを作成することは可能でしょうか？ 例えば、Internet Explorerを立ち上げて、ソニー銀行のホームページを開き、店番号、口座番号、ログインパスワード、等必要な情報を順次入力し、ログインする。といった、プログラムです。
Excelで使うマクロを作って頂けませんか。Sub test() On Error Resume Next Dim rng As Range Set rng = Selection If Err.Number = 0 Then With rng .Value = Evaluate("if(isnumber(" & .Address & _ "),round(" & .Address & ",3),"""")") End With End If End Sub これは、検索して見つけたマクロです。 内容は、四捨五入したセル範囲を、任意で選択した状態でマクロを実行すると「各セルに対して、小数点第4位を四捨五入して、小数点第3までを一発で表示する」そんな内容のマクロです。 上記マクロに付け加えて頂きたい内容が有るんです。 四捨五入する前に、任意選択した各セルの数字を、２で除算してしてから四捨五入したいのです。つまり、四捨五入の前に、÷2の動作を付け加えて頂きたいのです。 宜しくお願い致します。２０１０です。
【Visual C#】クリックすると画像の変わるボタンを作成する方法についてお聞きしたいことがあります。（プログラム中で生成されるインスタンスはForm,Background,Buttonの３つです） フォーム画面(Form1)に描画された背景(Background)の上に、 クリックすると画像の変わるボタン(Button)を作成しようとしています。 まず、Backgroundクラスは以下のように定義されています。 class Background { PictureBox background; public Background(Form1 fm) { background = new Background(); background.Width = 800; background.Height = 600; background.Image = "ファイルパス"; background.Parent = fm; } } 次に、ボタンクラスは以下のように定義されています。 class Button { public Button(PictureBox background) { button = new PictureBox(); button.Width = button.Height = 100; button.Image = Image.FromFile("ファイルパス"); button.Parent = background; button.Click += new EventHandler(button_Clicked); } public void button_Clicked(object sender, EventArgs e) { （※既に生成されているボタン）.Width = button.Height = 100; （※既に生成されているボタン）.Image = Image.FromFile("ボタン押後の画像ファイルパス"); （※既に生成されているボタン）.Parent = （※既に生成されている背景） } } Buttonクラスのイベントハンドラの中身を見て頂ければお分かり頂けると思うのですが、 イベントハンドラに引数として現在生成されているインスタンスを渡す方法が分からず、手が止まっています。 どうしたら良いでしょうか？
マクロ初心者です。 以下の設定をしたいのですが 上手く実行されません。エラー 変数が定義されていません！ となり、マクロ名 消費税計算の所が黄色になります。よろしくお願いいたします。②消費税計算の名前でマクロを作成 ③次の3つの変数を宣言する ・変数名：Teika / データ型：長整数型（Long）Zei ・変数名：Zei / データ型：倍精度浮動小数点数型（Double） ・変数名：ZeiGaku / データ型：倍精度浮動小数点数型（Double） ④変数「Teika」にセルB3の定価の値を、変数「Zei」にはセルB4の消費税の値を代入 ⑤変数「ZeiGaku」に変数「Teika」と「Zei」の積（掛け算式）を代入 ⑥MsgBox関数に変数「Teika」と変数「ZeiGaku」を利用して、次のメッセージを表示 ・メッセージ内容： 定価12000円の消費税は960円です。 （※12000と960の数値は変数を利用し、&演算子で他の文字列と連結して表示させる） ⑦セルB5に「Teika」と「ZeiGaku」を足した値を入力してください。 Sub 消費税計算() 'Dim Teika As Long, Teika = Range("B3").Value 'Dim Zei As Double, Zei = Range("B4").Value 'Dim ZeiGaku As Double, Zeigaku = Range("Teika*Zei").Value MsgBox "定価" & "Teika" & "の消費税は" & "Zeigaku" & "です。 End Sub
エクセル２０１６でマクロを組んでいるのですが、うまくコンパイルできません。 画像のマーカーのところに印がついて、ユーザー定義型は定義されていませんと出てしまいます。ネットなどに記事をみて、ツールから参照設定をいじっていますが なかなかできないので教えてください 現在チェックが入っている項目は Visual Basic For Applications Microsoft Excel 16.0 Object Library Microsoft Scrioting Runtime Microsoft ActiveX Date Objects recordest 2.8 Library
マクロでピボットテーブルを作成する方法について 関連サイトで学ぼうと頑張りましたが、挫折しています。是非ともご指導ください。条件は、 マクロ保存FILE名 ：A.XLSM 元データ ：B.XLSX、sheet1、$E$1:$Z$1000（最終行の変動あり、毎日データが増えていきます。） ピボットテーブル作成 ：C.XLSX、sheet2、A3 例） テーブル設定 行A "店番号" 行B "店名" 列C "パン売上" 列D "菓子売上" 列E "チョコ売上" 列F "合計売上" 最終行に項目ごとの "売上合計" ピボットの項目名を一部、変更する予定をしています。 尚、毎日、累積で集計作成します。 もしも情報が足りない場合は補足します。どうぞお願いします。
すみませんが、Excel2010の環境で、ユーザーフォームを作成しています。 コンボボックスが3つあり、 それぞれ、「区分コンボボックス」「品名コンボボックス」「品目番号コンボボックス」と名前をつけています。 また、別のシートに A列 B列 C列 区分 品名 品目番号 . . . . . . . . . といった表を作っています。 区分コンボボックスで選択した内容で次の品名コンボボックスの内容が変わり、品名コンボボックスで選択した内容で次の品目番号コンボボックスの内容が変わるようにしたいのですが、 記述がわかりません。 大変申し訳ありませんがよろしくお願いします。
シート名に★が含まれるシートを選択し、30％に縮小して印刷をしたいのですが、 1枚目しか指定の縮尺にならないのはナゼでしょうか。 正しいコードをご教授下さい。Private Sub CommandButton1_Click() '*****シート名に★が含まれているシートを選択する***** For Each myWS In Worksheets If myWS.Name Like "*★*" Then If ActiveSheet.Name Like "*★*" Then myWS.Select (False) Else myWS.Select Set w = ActiveSheet w.PageSetup.Zoom = 30 '30%に縮小 End If End If Next '*****選択したシートを印刷する***** ActiveWindow.SelectedSheets.PrintOut End Sub
Microsoft Visual Studio において ソースプログラムの先頭に行番号を表示するにはどうすればいいでしょうか。 ご存知の方、お教えください。 よろしくお願いします。
Excelマクロ シートを一つずつ特定の名前を付けてpdfで保存したい で質問させていただいたd7rnehxkと申します。どうにか目的物を作ることは出来たのですが、同じような処理をするところのコードをどうにかすっきりできないものかと悩んでおります。 コードは以下の通りで 'セルに値があればファイルを作成する の処理をすっきりさせたいです。標準モジュールに書いてます。 Dim tDir As String 'フォルダ作成パス Dim orgName As String '作成するオリジナル名 Dim nDir As String '作成するフォルダ名 Sub MakeFolder() 'このワークブックのパスを取得 tDir = ThisWorkbook.Path 'ファイル名とフォルダ名のもとになる名前 orgName = "D_" & Worksheets("Sheet1").Range("F1").Value & "_" & Worksheets("Sheet1").Range("E1").Value 'tDirに作成するフォルダ名 nDir = tDir & "\" & orgName '既にnDirがあるかどうか確認 If Dir(nDir, vbDirectory) = "" Then 'ない場合は作る MkDir nDir 'PDFファイル作成コードを記述したサブプロシージャを呼び出す Call MakePDF Else 'あるならエラー表示 MsgBox "同じ名前のフォルダがあるので作れません" End If End Sub Sub MakePDF() Dim fName As String '必ず作成するファイル名 'fNameに作成するファイル名 fName = orgName & "_" & Worksheets("Sheet1").Range("B1").Value & "_" & Worksheets("Sheet1").Range("C1").Value & ".pdf" Sheets("Sheet1").ExportAsFixedFormat Type:=xlTypePDF, Filename:= _ nDir & "\" & fName, Quality:=xlQualityStandard, _ IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False 'セルに値があればファイルを作成する If Len(Application.Trim(Worksheets("Sheet1").Range("A2"))) = 0 Then Exit Sub Else Dim fName1 As String '作成するファイル名 'fName1に作成するファイル名 fName1 = orgName & "_" & Worksheets("Sheet1").Range("B2").Value & "_" & Worksheets("Sheet1").Range("C2").Value & ".pdf" Sheets("Sheet2").ExportAsFixedFormat Type:=xlTypePDF, Filename:= _ nDir & "\" & fName1, Quality:=xlQualityStandard, _ IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False End If 'セルに値があればファイルを作成する If Len(Application.Trim(Worksheets("Sheet1").Range("A3"))) = 0 Then Exit Sub Else Dim fName2 As String '作成するファイル名 'fName2に作成するファイル名 fName2 = orgName & "_" & Worksheets("Sheet1").Range("B3").Value & "_" & Worksheets("Sheet1").Range("C3").Value & ".pdf" Sheets("Sheet3").ExportAsFixedFormat Type:=xlTypePDF, Filename:= _ nDir & "\" & fName2, Quality:=xlQualityStandard, _ IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False End If End Sub ---------------------- ブックの記述内容は以下の通り。 Sheet1 > A1 > 1 Sheet1 > A2 > 2 Sheet1 > B1 > 00 Sheet1 > B2 > 01 Sheet1 > C1 > Cover Sheet1 > C2 > ME Sheet1 > E1 > 20160615 Sheet1 > F1 > v1 Sheet2 > A1 > =Sheet1!A1 Sheet3 > A1 > =Sheet1!A2 -------------------------- 前の質問のurl http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1416051695...
該当フォルダがない場合、あたらしく作成するVBA エクセルVBAでCSVを作成して保存しています 現在下記コードを使用していますが 該当のフォルダがない場合エラーになりますbuf = Now dname = dtSt.Cells(2, 2).Value kacd = dtSt.Cells(3, 3).Value csvFile = "\\1.2.2.1\C\D\データ\" & kacd & "\" & dname & "\" & Format(buf, "yyyymmddhhnnss") & ".csv" If csvFile = False Then End Row = tbSt.Cells(Rows.Count, 1).End(xlUp).Row Col = tbSt.Cells(1, Columns.Count).End(xlToLeft).Column ここで、\\1.2.2.1\C\D\データ\内に該当フォルダがない場合、新しいフォルダを作成するエクセルVBAを作成したい のですがどのようなコードにすればよろしいでしょうか？
VBAでもＨＰにおけるJavascriptのようにExcelに動きを加えることは可能でしょうか？
VBA 2段目のユーザーフォーム.Show時のトグルボタン状態指定 Excel 2010でVBAを使ってユーザーフォームをつくっています。コマンドボタン2個（AとB）を備えたユーザーフォーム①と、 トグルボタン2個（aとb）とテキストボックスを2個などを配置したユーザーフォーム②があり、 フォーム①でAまたはBをクリックするといずれも同じフォーム②を呼びます。 フォーム①のコマンドボタンAをクリックすると、フォーム②が呼ばれたときに②に配置したトグルボタンaを選択状態 Value = trueに、さらにBackColor = RGB(0, 255, 255)にし、 フォーム①のコマンドボタンBをクリックすると、フォーム②が呼ばれたときに②に配置したトグルボタンbを選択状態 Value = trueに、同じくBackColor = RGB(0, 255, 255)にしたいと考えています。 こうした状態でフォーム②を呼ぶ方法を教えていただけないでしょうか。 フォーム②でトグルボタンを採用している理由は、視覚的に判断し易くさせるためです。 トグルボタンの操作の方法として、Click イベントでの方法が一般的かと思われますが、わたしの希望する使い方はフォーム②を呼ぶタイミングでトグルボタンの操作をするというものです。 よろしくお願いします。
VBAでA1〜A15に入力された整数の中から最大値をC2に表示させる方法を教えて下さい。if〜 then もし〜ならば GoTo 繰り返し処理 を使います。 よろしくお願いします。
SPREADデザイナー7.0についてVB6とSPREADデザイナ7.0を使って開発をしているのですが、表のソートをボタンで行えるようにしたいんですが、どのようなプログラムを組めばよいのか教えてください。
VBについて、急ぎです(>_<;)OpenFileDialogを使って？選択した画像ファイルを、PictureBoxのImageに設定する方法を教えてください
マクロ初心者です。タイトル行が設定されており、改ページを挿入する場合どのようなコードになるのでしょうか？ 1〜5行目がタイトル行 6〜30行目がデータ 31〜55行目がデータ …以下25行ごとに改ページを挿入したいです。 よろしくお願いします。
オートフィルター マクロ エクセルについて： キーワード（文字例）を含むではなく、何々で「始める」条件で検索したい場合、下記のVBAはどう修正すれば、よいでしょうか？ご存知の方は教えて頂いたら、幸いです。 例えば、BCで検索して、結果はABCではなく、BCDやBCなどのBで始める結果を抽出したい。 Sub 検索() AutoFilterMode = False With Cells(7, 1).CurrentRegion If Range("B1").Value <> "" Then .AutoFilter Field:=2, Criteria1:="*" & Range("B1").Value & "*" End If If Range("B2").Value <> "" Then .AutoFilter Field:=3, Criteria1:="*" & Range("B2").Value & "*" End If If Range("B3").Value <> "" Then .AutoFilter Field:=6, Criteria1:="*" & Range("B3").Value & "*" End If End With End Sub
excel vba勉強中の者です。 2つの同じ内容のセルがあったら、そのとなりのセルを別のセルにまとめて表示させたいのですが、 どのようにすれば良いのかわかりません。Sheet1 A__________B__________C あ_________100_________A あ_________100_________B あ_________100_________C あ_________200_________D あ_________200_________E い_________100_________F い_________100_________G あ_________100_________H あ_________200_________I ならば Sheet2 A__________B__________C あ_________100_________A _______________________B _______________________C _______________________H あ_________200_________D _______________________E _______________________I い_________100_________F _______________________G となるようにしたいです。 ずっと悩んでいるのですが、わからないためご教授頂ければ 幸いです、、よろしくお願いいたします。
すみません、VBScriptで質問です。 複雑なフォルダ構成となっているすべてのフォルダからファイルをひとつのフォルダにまとめるため 以下の手順を実施しました。1.コマンドプロンプトで dir /S /b /A-D > test.txt (再帰的にファイルだけ表示させる) 2.以下のようにvbscriptを組み、1で作成した.txtを、組んだvbscriptと一緒にC:\testディレクトリに配置した。 dst = C:\test 'コピー先ディレクトリ Set objFS = CreateObject("Scripting.FileSystemObject") set objFile = objFS.openTextFile("test.txt", 1, false) ☆ Do until objFile.AtEndofStream src = objFile.ReadLine ’ソース元を一行ずつ読み込み Call objFS.CopyFile(src, dst, false) Loop 以下、オブジェクトの開放は省略 上記を動かしたところ、一部のファイルはコピーされましたが 途中で「ファイルが見つかりません」とエラーが表示され、コピーが中断してしまいました。 具体的には、数字とアルファベットで構成されているファイルは移動できました。 (日本語で書かれたファイル名は移動できなかった) ただ、上記のコードの☆の部分にOn Error Resume nextを入れると ソース元からすべてのファイルをコピーできました。 ・・自分の力では、なぜOn Error Resume nextを入れないと中断するのかわかりません。 どなたかご教示ください。 以上、よろしくお願いいたします。
マクロについて質問です。 どこが間違っていますか？シートごとに名前を付けて保存したいんですがエラーが出ます。 Sub d() For r = 1 To 5 Worksheets(r).Copy With ActiveWorkbook mypath = "d:\" .SaveAs Filename:=mypath & sheetname & ".xlsx" .Close End With Next r End Sub
マッチ関数を使用してシート間でデータの選別と引用をしたいと考えております。 下記の図の左にシート１、右にシート２を想定しています。シート１のD列にランダムに型式の文字列が入っており、H列には数字の文字列が入っております。 シート２のD列にもランダムに型式の文字列が入っております。 この中でシート１D列に一致する型式のみ選定し、その行のI列にシート１H列の数字を転記したいのです。 マッチ関数を使用してマクロを作成しているのですが、D列が一致しないものに関してもなぜかH列に無関係の数字を転記しており、苦戦しております。 また、後学のために教えていただきたいのですがシート１と２において行が完全一致のものだけを選定する際にマッチ関数は使用できるのでしょうか？ 例文等あればぜひ教えていただきたいです。
visual studio 2013の使い方についての質問です。 現在すでに出来上がっているプログラムの中のテキストを変更しようとしています。実際にプログラムを起動したときの表示を変えたいのですが、変え方が分かりません ソースコードは持っています。visual studio 2013でコードの入力されている画面を開くことはできますが、デザイナーでしょうか、実際のフォームの編集ができません。 実際の起動したときのボタンのテキストの変更の仕方を教えてください。 visual studio 2013初心者で使い始めたばかりです。 宜しくお願いします。
VB Numeric Up Downについて formの中にNumeric Up Downを３つ作成し ひとつを月の値 ２つめを日付の１０の位の値 ３つめを日付の １の位の値として月日のデータをつくっています。 １．Numeric Up Downの初期値をその日の日付にしたいのですが そのように設定する方法がわかりませんので教えてください。 ２．Numeric Up Downの値を日付のデータとして利用するにはどのようにすればよいのでしょうか。 質問が多くて恐縮ですが 詳しく説明していただけると幸いです よろしくお願いいたします
複数のformを同時に消す VB初心者です。form０～３があり、form０から Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click 'Form1クラスのインスタンスを作成する Dim f As New Form1() 'Form1を表示する 'ここではモーダルダイアログボックスとして表示する 'オーナーウィンドウにMeを指定する f.ShowDialog(Me) 'フォームが必要なくなったところで、Disposeを呼び出す f.Dispose() End Sub のように１～３までを作成しました。 この際form３のボタンをクリックするとform１～３を消してform０に戻りたいのですが消えません… form３のボタンをクリックするとform１～３を消すプログラムはどのようなものでしょうか 具体的な例を書いていただけると助かります よろしくお願いいたします
マクロ初心者でして、知っている方がいらっしゃったらご教示ください。 【やりたいこと】 A1~A2のファイル名をもとにE1～E2に画像を張る 【質問】 下記の記述だと、「型が一致しません」と出ます。 範囲指定の方法が間違っているでしょうか。 ------ Sub 画像() With ActiveSheet.Pictures.Insert("C:\image\" & Range("A1:A2") & ".png") .Left = Range("E1:E2").Left .Top = Range("E1:E2").Top ' With .ShapeRange .LockAspectRatio = msoTrue If .Width * Range("E1:E2").Height / .Height < Range("E1:E2").Width Then .Height = Range("E1:E2").Height Else .Width = Range("E1:E2").Width End If End With End With End Sub
仕事の効率化(プログラム等) いつも回答して頂き、ありがとうございます。 本日は仕事の業務を効率化出来ないかの、 ご相談の質問となります。 私の会社では、他社から書類を頂き、 それを加工して商品として作成しています。 現在は頂いた書類を文字等はワードへ 細かい料金等はエクセルへ 手打ちで入力しています。 この手打ちの作業が物凄く非効率で、 新しい書類がくるたびに手打ちで入力しています。 そこで本題なのですが、 この手打ち作業を現在の マクロVBAやSCANソフト等で 自動化出来るものなのでしょうか もしこの分野で詳しい方が いらっしゃいましたらご回答お願いします。
VBA初心者です。住所、氏名の重複チェックをしたいです。 ①ダイアログで重複チェックするファイルを選択 ②重複チェックをしたいヘッダーを入力（複数選択をしたい） ③②で選択したヘッダーのセル同士を結合し挿入 ④挿入した列の削除項目入力（空白、ハイフン、アンダーバーなど） ⑤A列をCOUNTIFにて重複チェック ⑥結果をB列に挿入し、重複のあったセルに色をつける 例：②でD列住所のヘッダーとN氏名列の選択した場合 D1【東京都 杉並区】N1【鈴木 太郎】だった場合 ③でD1＆N1を一番右端に挿入しA1は【東京都 杉並区鈴木 太郎】にする ④でA1【東京都杉並区鈴木太郎】にする ⑥結果はCOUNTIFにてでた1or2or...の数字を挿入し1以下外の数字が出たら セルの色を変更にしたいです。 以上をVBAにて行いたいと思ってます。 どなたかご教授お願いいたします。
作った表をスクロールさせたい。 下記の表の項目を50行ほど作成してそれをｽｸﾛｰﾙさせたいのですが、 画面を開いたときに15行を表示させて以降はｽｸﾛｰﾙのような感じにしたいです。(名称から備考までが1行です。) こういうのはどのようにやればいいのでしょうか。 まず、直接50行をﾌｫｰﾑに作成してあとはｽｸﾛｰﾙﾏｸﾛでしょうか。 あるいは他に何かいい方法がありますでしょうか。 よろしくお願いします。
vbaの課題です。難しくて困っています
grepの改行について教えてください
至急。Rについて、csvファイルを読み込めない。 Rmd上ではcsvファイルを読み込むことができるのですが、Knit HTMLをすると以下のエラーが出ます。作業ディレクトリも選択できていると思うのですが、何が問題なのでしょうか。 file(file,"rt") でエラー:コネクションを開くことができません 呼び出し..
Excel VBAのIEでのよその取得についてお願いいたします。 ページ内の指定要素すべてを取得したいです。 下記のコードでは一番最初の要素しか取得できないのですが、 うまくできません。詳しい方ご教示いただけないでしょうか？ できればコードをいただければ幸いです。 よろしくお願いいたします。 objIE.document.getElementsByClassName("○○")(0).outerHTML
VBA 請求書から台帳への自動転記のコードを作ろうと思っています。 いろいろなところに検索をかけましたが、応用が利かず、またこちらでご教授頂けたらと思います。。（添付左）の請求書から、（添付右）の台帳へ自動で転記したいのです。 ①請求書、B1の”4月分"とシート名の”鈴木”を読み取り ②台帳、（隠れてしまっていますが）、シート名”鈴木”の4月の 金額や消費税、合計の欄に転記していきたいです。 よろしくお願いいたします。<m(__)m>
教えてください。 excel VBA初心者なのですが条件に当てはまるものを一つのメッセージボックスに表示したいです。 A列とB列で一セットで、Aに名前、Bに回数 が表示されます(40行ぐらい)その範囲内でB列が1以上の物を抽出して メッセージボックスに 山田 2回 佐藤 3回 . . . 以上 と表示させたいです。 範囲内は行が飛んでたりもします。 分かりにくい説明文ですが、教えてください。
エクセルの関数の質問です。 A列に商品名+商品型番が一緒になって入力されています。 B列には型番のみが入力されていますが、順番はバラバラです。 例えばA1にあいうえお(商品名)+123(型番)と入力されているが、B1には356と入力されており、本来B1セルに入力されるべき123の型番はB35セルに入力されしまっているとします。 C1に改めて正しい型番123を落とし込みたいのですがどのような関数を使えば良いのでしょうか。 説明下手ですみません。 どなたか教えて頂けると助かります。 関数的にはA1の中にB列の中のどれかが含まれていれば、C1セルにB列の中の当てはまるものを入れるという感じだと思うのですが.... わかりません！ 説明分からなかったらすみません！
Excel VBAのforとifについてお願いいたします。 要素の取得後、条件に一致していれ値を返すコードを書いたのですが、 うまく動きません。 下記のコードを修正していただきたいです。詳しい方ご教示いただけないでしょうか？ よろしくお願いいたします。 一致、不一致に関わらず "一致しています。" がセルに入力されてしまいます。 Set 要素数 = objIE.document.getElementsByClassName("○○") For j = 0 To 要素数.Length - 1 フィルター = 要素数(j).outerHTML If フィルター = 知恵袋 Then Cells(1, 1) = "一致しています。" Else Cells(i, 1) = "不一致です。" End If
【至急 VBAのコード添削お願いします】１～６枚目のワークシート上にまばらに入力されている数値を、７枚目のワークシート上に順序良く取り出したい（しかも、入力されているセル内には改行があるので、改行されている数字は別々に取り出したい）と考えています。 【概要】 ・１～６枚目のセルには、数値が入っているセルとそうでないセルがある。 ・数値が入っているセルには複数の数値が入っており、それらは改行で仕切られている。 ・１～６枚目のシート上の入力があるセルのみを選択して、数値を７枚目のシートの特定のセルに移す。 ・移すルールは、言葉で説明しづらいので、コードから読み取っていただければ幸いです。 【問題点】 以下のコードを作りました。変数kがうまく機能せず、kが1～15（または16～31）の間で変化するはずが、いきなりk=32となってしまいます。第32列目には何も入力されていないので、End関数ではるか彼方にActiveCellが飛んで行ってしまいエラーになります。 因みに、第1列から第31列までの第1,2行には項目名が入力されているのでこの列にEnd(xlDown)が適用されれば、cells(3, k)から順々に数値が埋められるはずです。k=32が出てきてしまう理由がよくわからないのですが、ひょっとすると原因として、ワークシート1枚目で空白でないセルがはじめて出てくるのがCells（46, 31）なので、それが関係しているのではないかと考えています。変数kを適正にコントロールする方法を教えていただきたいです。何卒よろしくお願いいたします。 sub テスト () For sn = 1 To 6 'snはシート番号 For i = 1 To 200 'iは行番号 If sn Mod 2 = 1 Then k = 1 If sn Mod 2 = 0 Then k = 16 For j = 1 To 150 'ｊは列番号 If Sheets(sn).Cells(i, j) <> "" Then a = 0 k = k + 1 Do b = InStr(a + 1, Sheets(sn).Cells(i, j), Chr(10)) If b <> 0 Then Sheets(Sheets.Count).Cells(1, k).End(xlDown).Select ActiveCell.Offset(1, 0).Value = Mid(Sheets(sn).Cells(i, j), a + 1, b - a - 1) ElseIf a > 0 And b = 0 Then Sheets(Sheets.Count).Cells(1, k).End(xlDown).Select ActiveCell.Offset(1, 0).Value = Mid(Sheets(sn).Cells(i, j), a + 1) End If a = b Loop Until a = 0 And b = 0 End If Next j Next i Next sn End Sub
数式のコピーについて 下の画像の場合ですが、 B21には、次のような関数があります。=B$1-RANK.AVG($A21,$A17:$A21) C21にも、B21をコピーした同様の関数が入っています。 B20を選択した状態で、次のような命令を実行させました。 Selection.Offset(-4, 0).Resize(5, 2).FormulaR1C1 = Cells(21, 2).Resize(1, 2).FormulaR1C1 すると、21行を同じように返ってきたのは先頭の16行目だけで、 次からの行は行の参照が＋1行、＋2行…と増えてしまいます。 これを、 Selection.Offset(-4, 0).Resize(5, 1)FormulaR1C1 = Cells(21, 2).FormulaR1C1 と1列でやると思ったような結果が返ります。 複数の列を一度に複製する場合、参照の法則を変えないような命令はどうすれば良いでしょうか？ 何卒、御教示の程よろしくお願い致します。
VBAについての質問です。シート1にある3×3の行列A.Bを読み込んだ上でシート2に行列の積の計算結果を書き込みたいのですがうまいこといきません。ヒントになるようなものを教えていただきたいです。どういった文を使うかなどお願いします。
エクセルVBAの記述方法についての質問です。Y = Range("C" & Rows.Count).End(xlUp).Row この記述により、変数Yに、Cケタの「データ入力終端セルの行ナンバー」が入ります。 同様に、ある「行」について、「データ入力終端ケタナンバー」を取得するにはどう記述すればいいのか教えて頂きたいのです。よろしくお願いします。
【VBA】Line inputについて csvファイルを読み込んで、配列に格納したいのですが、やり方がいまいち分かりません。Do Until EOF(FileNum) 'ファイルの最後まで繰り返し Line Input #FileNum, temp(0) ' 1行読込 Line Input temp(0) = Replace(temp(0), vbLf, ",") '改行 Chr(10) 置き換え temp(0) = Replace(temp(0), " ", "") '空白置き換え tmp = Split(temp(0), ",") 'カンマ区切りで配列に格納 temp(1) = UBound(tmp) '配列数 Loop 上記の記述だと、1行ごとに配列数が上書きされてしまいます。 自分がやりたいのは、一つの配列（tmp)にcsvファイルの全行カンマ区切り文字列を 格納したいんです。（1000は超えそうなのですが、そちらは大丈夫なのでしょうか。。 どうかご教示よろしくお願いいたします。
vbscriptですSet Name= CreateObject("Shell.Application").BrowseForFolder(0, "scriptを選択",1,"" & vp & "") で、特定のフォルダーが開かれた場合にのみ実行するscriptを作成するにはどうすればいいですか？
access2016 VBAについて質問です。 指定したレコードのプロパティ内容を変更したいのですが、どのようにしたらよいのでしょうか。例 ボタンを押すと指定したレコードのみ境界線スタイルを変更したい ↓このように書いたら全体で変更はできました。 [氏名].BoderStyle = 2 よろしくお願いいたします。
VB2015 datagridviewについて とても初歩的な質問なのですが… accessなどを使わずにdatagridviewで作った内容を保存することはできないのでしょうか？datagridviewだけで処理したいのですが その場合の保存はどのようにしたらよいのでしょうか。 「datagridview 保存」で調べてみると、 CSV形式、XML形式で保存するには～という内容がほとんどでした。 初心者なのでお手柔らかにお願いします。
Visual Studio(VB)についての質問です。 ボタンを押すと、指定された画像を表示するプログラムを作り、これを実行ファイルへとビルドしました。しかし、このプログラムを別のパソコンへ移して起動した場合、画像ファイルがあるアドレスの名前が若干異なるため、画像を表示することができませんでした。 （例）C:\Users\〇〇〇（パソコンの名前）\Pictures\画像フォルダ\画像.png と指定 別のパソコンの場合 C:\Users\△△△（パソコンの名前）\Pictures\画像フォルダ\画像.png となり、表示されない どのパソコンにプログラムを移しても、指定した画像が開くようにするためには、どのようにアドレスを指定すればよいのでしょうか。 よろしくお願いします。
以下にしめすExcelの画像ですがこの四角の「1」全体を回転するVBAはありますか？よろしければ教えてください ちなみに「1」はこのようなVBAで示しています Sub a() Range("F3").Select ActiveCell.FormulaR1C1 = "1" Selection.AutoFill Destination:=Range("F3:P3"), Type:=xlFillDefault Range("F3:P3").Select Selection.AutoFill Destination:=Range("F3:P13"), Type:=xlFillDefault Range("F3:P13").Select End Sub
高速フーリエについて 質問です。わからなくて困っています。「音声信号で一秒当たり２の１４乗（＝１６３８４）個のサンプリングを行い、２の１０乗（１０２４）個のデータ列を一括してフーリエ変換する場合に、一回の乗算にマイクロプロセッサに要求される演算速度はＤＦＴとＦＦＴとでおおよそどの程度違うか見積もれ。」 これは、どうゆうことすか？お願いします。
セルをコピーし上から順番に貼り付けるVBAを組みました。 しかし、下記のVBAだとA列から貼り付けられる状態です。Sheets("sheet1").Range("A4:K4").Copy _ Sheets("sheet12").Cells(Rows.Count, 1).End(xlUp).Offset(1) この状態では使用に不都合があるため、B列の空白を選択して上から貼り付けれたいと思うのですが、どのようにすれば良いのでしょうか？
VBAでユーザーフォームを使って複数検索する方法について質問いたします。Windows7のExcel2010です。某有名サイト様で以下のコードをコピペして実行したのですが、 次のように変更したく思います。 ①検索対象は「現在のシート」ではなく、「Sheet1を除く全シート」。 ②ユーザーフォームにFoundCell.Addressでセルのアドレスを表示するのではなく、そのセルがあるシート名を表示。 ③ユーザーフォームマクロで、該当セルをダブルクリックすると、シートを移動してそのセルのひとつ右のセルを選択する。 なお、検索対象のシートは160枚あります。 以上3点の変更をよろしくお願い致します。 Sub Sample8() Dim FoundCell As Range, FirstCell As Range Set FoundCell = Cells.Find(What:="田中") If FoundCell Is Nothing Then MsgBox "見つかりません" Exit Sub Else Set FirstCell = FoundCell UserForm1.ListBox1.AddItem FoundCell.Address & vbTab & FoundCell.Value End If Do Set FoundCell = Cells.FindNext(FoundCell) If FoundCell.Address = FirstCell.Address Then Exit Do Else UserForm1.ListBox1.AddItem FoundCell.Address & vbTab & FoundCell.Value End If Loop UserForm1.Show vbModeless End Sub
エクセル2013の連続印刷マクロ作成方法を教えてください。 印刷用シートと台帳シートがあります。印刷シートはHLOOKUPを使用して、印刷シートのNoに数字を入力すれば、台帳シートのNoのデータが反映されるように作成しています。 また台帳シートには、Ｃ1から横にNoをふってます。 台帳シートのNoを印刷シートに反映させて、台帳シートのNoがある分だけ連続で印刷させたいのですが、行の連続印刷は作成したものがあるのですが、今回列の連続印刷になるため、恐れ入りますがご教授お願いいたします。
ｺﾏﾝﾄﾞﾎﾞﾀﾝがｸﾘｯｸされる度に日付を+1したい。 ﾎﾞﾀﾝを1回押したら日付が+1されるように、 以下のｺｰﾄﾞを作成しました。 ここからどう変えればいいでしょうか。Private Sub CommandButton7_Click() Dim tmp3 As String, CL As String CL = Chr(13) & Chr(10) tmp3 = DateAdd("d", 1, Date) & CL TextBox17.Value = tmp3 End Sub
excel 2013でVBAを動かしていたのですが excel 2016では、そのVBAが動きませんでした。 游ゴシックだからでしょうか？原因が分かる方いませんか？以下、一部のVBAです。 Dim foundCell As Range Set foundCell = Cells.Find(What:="【備考】") If foundCell Is Nothing Then Else Cells.Find(What:="【備考】").Select Selection.Cut Selection.End(xlUp).Select ActiveCell.Offset(0, 3).Select ActiveSheet.Paste End If
エクセルvba ユーザーフォームのテキストボックス内書式を変更したいのですが。。 上手くできません。どうすれば良いですか。。 したいこと） セルA1に入った値をユーザーフォームで表示したい。セルA1には書式"[m].ss"で値は833.5と表示されているのですが、そのまま833.5をユーザーフォームで表示したいのです。 Private Sub UserForm_Initialize() Me.TextBox1.Text = Sheet1.Range("A1").Value End Sub だと0.579050925925926ってなります。。 Private Sub UserForm_Initialize() Me.TextBox1 = Format(Sheet1.Range("A1"), "[m].ss") End Sub とすると1.ssになる・・・
エクセルで2個のデータを関数を使って比較したいのですが、うまくいきません。 データAは先月のデータで、英数字で5桁になっています。場所はA2からA35000です。A35000まで参照してますが、実際のデータは33000件ほどで、残りは空欄です。今後増える可能性があり、多くしています。 データBは今月のデータで、データの形式等はデータAと同じです。場所はC2からC35000までです。 B列に書いた関数は下記です。 =IF(A2="","",IF(COUNTIF($C$2:$C$35000,A2)=1,"","Deleted")) D列に書いた関数は下記になります。 =IF(C2="","",IF(COUNTIF($A$2:$A$35000,C2)=1,"","NEW")) 結果正常に答えを出すセルと、そうでないセルがあり、原因がわからず困っています。 添付の写真のように、どちらにもあるのに、消えた！新しい！と言われて困惑してます。 COUNTIFの答えが2になっているのが、原因かなと思うのですが、その原因がわかりません。 それぞれのデータの中には同じものは無いです。 あと処理時間が凄くかかります。他にいい方法があればご教授いただきたく。 よろしくお願いいます。
HTML画面のセレクトボックスにEXCELからデータを表示させる方法を 教えて下さい。テキストボックスには表示できますがセレクトボックス にはできません。テキストボックスに表示させるVBAマクロは下記の 通りです。 ＨＴＭＬタグネーム：ssss とします。 ①テスト画面の取得 Set doc = oIE.document Set elements = doc.getElementsByName(&quot;ssss&quot;) If elements.Length = 0 Then MsgBox &quot;テスト画面 表示要素 取得できませんでした。&quot;, vbExclamation, &quot;警告&quot; Exit Sub End If ②テスト内容表示 elements.Item(0).Value = Range(&quot;D33&quot;) ①、②の記述でＥＸＣＥＬシートＤ３３セルに設定したﾃｽﾄ内容が Ｗｅｂ画面に表示されます。
ネット検索して下記のようにhtmをエクセルに取り込む VBAは見つけたのですが、できれば特定フォルダのHTMを一括で 取り込みたいのですが、どのようにすれば良いのか分からないので、お教えいただければと存じます。 ※取り込むファイルはaccess_001.htm～access_050.htmと連番になっております もし可能でしたら、各HTMをシートごとに取り込みと、 1シートにまとめる方法を知りたいです。 Sub test() Dim cFile As Variant Dim iR As Long iR = Cells(Rows.Count, "A").End(xlUp).Row + 1 cFile = Application.GetOpenFilename() If cFile = False Then Exit Sub End If cFile = Replace(cFile, "\", "/") With ActiveSheet.QueryTables.Add(Connection:="URL;file:///" & cFile, Destination:=Range("$A$" & iR)) .Name = cFile .FieldNames = True .RowNumbers = False .FillAdjacentFormulas = False .PreserveFormatting = True .RefreshOnFileOpen = False .BackgroundQuery = True .RefreshStyle = xlInsertDeleteCells .SavePassword = False .SaveData = True .AdjustColumnWidth = True .RefreshPeriod = 0 .WebSelectionType = xlEntirePage .WebFormatting = xlWebFormattingNone .WebPreFormattedTextToColumns = True .WebConsecutiveDelimitersAsOne = True .WebSingleBlockTextImport = False .WebDisableDateRecognition = False .WebDisableRedirections = False .Refresh BackgroundQuery:=False End With End Sub
教えて下さい。 Ｖｉｓｕａｌ Basicでひらがな（カタカナ）で入力した文字を 別のテキストボックスに自動的に漢字変換されセットするには どうしたらいいでしょうか？漢字からひらがなの変換は多数事例がありますが ひらがな（カタカナ）から漢字の変換の事例はなく ご教授下さい。 例 入力 ﾄｳｷｮｳ 出力 東京 ※出力エリアは確定されるのでなく一番 候補を出力している状態 参考ページ、コーディング例があれば教えて下さい。 宜しくお願いいたします。
VBScriptのRegExpで文字列に含まれる日付をmdからmmddに変えるにはどうしたらいいですか？試しにこれでやってみると「何々は2016年\b0\d\b月\b0\d\b日にこうします」と全然だめです。 re.Pattern = "\b\d\b" str = re.Replace("何々は2016年6月1日にこうします", "\b0\d\b") 正規表現はほとんど経験ありません。よろしくお願いします。
VBAで同じファイル内で、1シートを100行ずつに分割後、シート名をセル"D2"にする内容が下記になります。文字数が長いので、31文字で指定をし実行をしました。 しかし、エラーは無く、シート名は変わらず、”Sheet１，２，３…”というような表記でしかなりません。 他の内容でもトライしたのですがうまくいかず、どう直したら、表示されるのか…？よろしくお願いします。 Sub Example() '100 行毎にシート分 Dim ws As Worksheet, ts As Worksheet Dim x As Long, y As Long, i As Long, z As Long Set ts = ActiveSheet x = ts.UsedRange.Rows.Count y = Int(x / 100) + IIf(x Mod 100 > 0, 1, 0) z = ts.UsedRange.Rows(1).Row For i = 1 To y Set ws = Sheets.Add WsName = Left(ts.Range("D2").Value, 31) ←●シート名変更箇所 ts.Rows(z & ":" & z + 99).Copy ws.Range("A1") z = z + 100 Next i End Sub
EXCELワークシート関数について質問です。 隣の（例えばJ8）セルに"西田C"という文字列があれば、そのセル（例えばK8）に1を返すようにしたいのですが、どんな関数を使えばよいのでしょうか。IFの中に何かの関数を入れれば行けるような気がするのですが。。。 因みにExcel2000です。 宜しくお願い致します。
マクロ初心者です。複数のファイルを開くときにエラーを表示させないようにしたいです。 ファイル数はいくつになるかわからないので、このように記述しています。 Sub_ファイルを開く()Workbook.Open "Workbook.xlsx" Workbook.Open "Workbook(1).xlsx" Workbook.Open "Workbook(2).xlsx" Workbook.Open "Workbook(3).xlsx" Workbook.Open "Workbook(4).xlsx" Workbook.Open "Workbook(5).xlsx" Workbook.Open "Workbook(6).xlsx" Workbook.Open "Workbook(7).xlsx" Workbook.Open "Workbook(8).xlsx" Workbook.Open "Workbook(9).xlsx" End Sub
Windows7→10に変わった事により、以下エクセル マクロにエラーが出ています。。 どなたかご教示いただけないでしょうか。（Wondows10 & Excel 2010） 【マクロの内容】 あるファイルの1つのシートを、所定の名前を付けて 新たなファイルとして吐き出す。 下記は、【御見積書】＋所定のセルの文字_xlt で吐き出す設定です。 Windows10の環境で実行すると、以下の部分でエラーになります。 「main.SaveAs Filename:=myTemp」 エクセルを吐き出す事はできますが、上記の名前がつかず book1として出てきます。。 大変お手数ですが、どこを変更すればよいか教えていただけないでしょうか。 なにとぞよろしくお願いいたします。 ------------------------------------------------------------------------------------------------------------------------------ Dim myTemp As String With ThisWorkbook.Worksheets("御見積") '名前の確定 myTemp = "C:\" & ThisWorkbook.Worksheets("御見積").Range("G7") & "_" & ".xlt" End With main.SaveAs Filename:=myTemp main.Close Workbooks.Add myTemp ActiveWorkbook.Saved = False Application.ScreenUpdating = True Application.Wait [NOW()+"0:00:00.500"] Kill myTemp Application.ErrorCheckingOptions.BackgroundChecking = False MsgBox "書き出しました" End Sub
【VBA】ｵｰﾄﾌｨﾙﾀｰでの複数条件抽出 ﾏｸﾛ初心者です。ｵｰﾄﾌｨﾙﾀｰで”機種別”SHEETのK1～K5に記入された複数条件を指定し、 一覧表SHEETの3列目の項目を抽出したいのですが、”機種別”SHEETに記入した条件が空白の時は対象外としたいです。 現在の式は以下となります。 Sheets("一覧表").Select Range("A3").Select Selection.AutoFilter Dim Target(4) As String Target(0) = Worksheets("機種別").Range("K1").Value Target(1) = Worksheets("機種別").Range("K2").Value Target(2) = Worksheets("機種別").Range("K3").Value Target(3) = Worksheets("機種別").Range("K4").Value Target(4) = Worksheets("機種別").Range("K5").Value Worksheets("一覧表").Range("A3").AutoFilter Field:=3, _ Criteria1:=Target, _ Operator:=xlFilterValues これに空白以外の条件を追加したいのですが、いい方法はありますでしょうか？ 皆様の意見をお聞かせください。 何卒宜しくお願い致します。
とある方がVisual Studio (C#)でつくられていたシステムを その方のPCから自分のPCにコピーして持ってきて ひとまず動かしてみようとしたのですが開始を押してから「FileNotFoundExceptionはハンドルされませんでした。」 という題名でエラーが出てしまいましてその内容は 「型 'System.IO.FileNotFoundException' のハンドルされていない 例外がSystem.Drawing.dll で発生しました」 と 「追加情報:C:\Users\(その方のPCのアカウント名)\ Desktop\rogozukei\yonnkaku.png」 と書いてありました。 この問題に対して考えられる対処法は何かありますか？ 宜しくお願いします。
EXCEL VBAで、教えてください。下記のコードで、range("A3")の２つ右隣の、１つ下の数字を取得したいのですが、 下記のコードは、右斜め下になっています（こちらで教えていただいたのですが） ←の部分のcolumns(1),0を変えてもうまくいきません。 どのように変えればいいのでしょうか？ Dim i With Workbooks("Book2.xlsx").Worksheets("Sheet2") i = Application.Match(Range("A3").Value, .Columns(1), 0) ← If Not IsError(i) Then .Cells(i, 2).Value = Range("B4").Value End If End With End Sub
VBA LOOP処理について SHEET名「移動前」とSHEET名「移動後」が存在します。 「移動前」のデータを行ごとに「移動後」に移動させたいと考えています。移動前には1行目から88行目までデータが存在しており、 移動前の「１」行目を移動先の「１」行目、 移動前の「１２」行目を移動先の「２行目」 移動前の「２３」行目を移動先の「３行目」 移動前の「３４」行目を移動先の「４行目」 移動前の「４５」行目を移動先の「５行目」 移動前の「５６」行目を移動先の「６行目」 移動前の「６７」行目を移動先の「７行目」 移動前の「７８」行目を移動先の「８行目」 次に 「２」行目を移動先の「９行目」と移していきたいと考えています。 この場合のプログラムをご教示お願い致します。 下記途中まで作成したのですが、２回転目のColumns(i).Selectがまた１行目についてしまい、 失敗しています・・・。 For r = 1 To 11 For i = 1 To 8 Sheets("移動前").Select Columns(r + (i - 1) * 11).Select Selection.Cut Sheets("移動後").Select Columns(i).Select ActiveSheet.Paste Next Next
エクセルマクロ VBA について質問です。 シート名に特定の文字列が含まれるものについて 決められたセルに各特定の文字を入力したいです。 以下内容です。複数のエクセルファイルがあり 保有するシート名はそれぞれ異なります。 A、B、C、D の4種類の文字を含むシートがあり、 シート名にAを含む場合は、AY1セルに「1」と入力。 シート名にBを含む場合は、AY1セルに「2」と入力。 シート名にCを含む場合は、AY1セルに「3」と入力。 シート名にDを含む場合は、AY1セルに「4」と入力。 又、ファイルによっては「A」とゆう１シートのみの場合もあれば 「B」「C」の２シートや、 「A」「C-1」「C-2」など複数保有している場合もあります。 保有するシート全てに、上記内容のマクロを実行するにはどうすればよいでしょうか。
エクセルVBAで教えて下さい。 OSはWindows10、Excelは2016です。 下記コードは主要部分だけを絞って書かせて頂きました。Sub test1() Dim fpath As String Dim wb1 As Workbook, wb2 As Workbook fpath = "D:\Data\" Set wb1 = Workbooks.Open(fpath & "Book1.xlsx") Set wb2 = Workbooks.Open(fpath & "Book2.xlsx") With wb1.Worksheets(1) .Range("A1:B1").Copy Destination:=wb2.Worhsheets(1).Range("A1") End With End Sub Sub test2() Dim fpath As String Dim wb1 As Workbook, wb2 As Workbook fpath = "D:\Data\" Set wb1 = Workbooks.Open(fpath & "Book1.xlsx") Set wb2 = Workbooks.Open(fpath & "Book2.xlsx") With wb1.Worksheets(1) wb2.Worksheets(1).Range("A1").Value = .Range("A1").Value wb2.Worksheets(1).Range("B1").Value = .Range("B1").Value End With End Sub このコードでtest1の方は実行すると .Range("A1:B1").Copy Destination:=wb2.Worhsheets(1).Range("A1") の部分で 実行時エラー '438': オブジェクトは、このプロパティをサポートしていません。 というエラーが出てしまいます。 test2の方は正常に実行されます。 いつもtest1のように書いていて、出来ていたと思うのですが、 最近Windows10にアップグレードしました。 この事が何か関係していますでしょうか。 情報をお持ちの方、どうぞ教えて下さい。 宜しくお願い致します。
VBAで教えてください。 下記コードで、同じフォルダ内にあるワークブックをすべて開きたいのですが、 写真のように、ブック名を表示してくれません。 何かコードが違っているのでしょうか？Private Sub Workbook_Open() Dim wb As Workbook, fname As String On Error Resume Next Application.ScreenUpdating = False fname = ThisWorkbook.Path & "\*.xlsm?" fname = Dir(fname, vbNormal) Do While fname <> "" If fname <> ThisWorkbook.Name Then Workbooks.Open ThisWorkbook.Path & "\" & fname ActiveWindow.WindowState = xlMinimized End If fname = Dir Loop Windows(ThisWorkbook.Name).WindowState = xlMaximized Application.ScreenUpdating = True end Sub
VBAで、セルの値から、フォルダ作成⇒テキストファイル作成⇒テキストの中身書込をしたいです。 参考までに画像をご確認いただけたらと思います。たとえば、 フォルダ名⇒1 そのフォルダの中⇒01～06.txtを保存 そのテキストの中身⇒1,2,3,4,5と書き込み（C列～G列がカンマ（,）区切りで入っていてほしい） 申し訳ありません。 私は、まったくVBAを触ったこともありません、、、。 ネット検索を駆使して、下記のソースで、フォルダを作成し、CSVでファイルを作成し、中身をカンマ区切りで入れるところまできました。 ただ、CSVではなく、テキストファイルにしたいのです 涙 どなたかどうかお助けください。 -------------------------------------------------------------------------------------------------------------------------- Sub フォルダを作ってテキストファイルを入れる() Const xPath0 = "C:\Users\uhs\Desktop\エンゼルハート原稿テキストファイル一括作成\" Dim xSheet As Worksheet Dim xPath As String Dim xName As String Dim xText As String Dim nn As Integer Application.DisplayAlerts = False Set xSheet = ActiveSheet For nn = 2 To xSheet.Range("A" & Rows.Count).End(xlUp).Row 'フォルダ名 xPath = (xPath0 & xSheet.Cells(nn, "A").Value & "\") 'テキスト名 xName = xSheet.Cells(nn, "B").Value 'テキスト中身 xText = xSheet.Cells(nn, "C").Value & "," & xSheet.Cells(nn, "D").Value & "," & xSheet.Cells(nn, "E").Value & "," & xSheet.Cells(nn, "F").Value & "," & xSheet.Cells(nn, "G").Value If (Dir(xPath, vbDirectory) = vbNullString) Then MkDir xPath End If ChDrive (Left(xPath, 1)) ChDir (xPath) With Workbooks.Add Worksheets(1).Cells(1, "A").Value = xText .SaveAs (xPath & xName & ".csv") .Close False End With Next Application.DisplayAlerts = True MsgBox "完了しました" End Sub --------------------------------------------------------------------------------------------------------------------------
【VBA】差し込みコピー？このコードはSHEET1よりSHEET2へ転記したい為のコードで、他サイトからの流用です。 A列に1がある行のみ、差し込み印字するようです。 このコードを改変したいのですが、したい事は SHEET1の2行目から最下行までをSHEET2の指定場所（ちょっと離れたセルもあります）に コピーして貼り付けたいのです。 宜しくお願いします。 Sub Test1() Dim r As Range With Worksheets("sheet1") For Each r In .Range("A2", .Range("D" & .Rows.Count).End(xlUp)) If r.Value = 1 Then Worksheets("sheet3").Range("A9").Value = r.Offset(0, 0).Value Worksheets("sheet3").Range("b9").Value = r.Offset(0, 1).Value Worksheets("sheet3").Range("c9").Value = r.Offset(0, 2).Value Worksheets("sheet3").Range("h9").Value = r.Offset(0, 3).Value For i = 1 To MaxRow MaxRow = Sheets("Sheet1").Cells(Rows.Count, 1).End(xlUp).Row Next i End If Next r End With End Sub
Excel シートに画像を自動で表示・更新させたい やりたい事は以下の通りです。Sheet1のA1の値が変わったらSheet2のB1にSheet1のA1に対応した画像(例えば"C:\" & worksheets("Sheet1").Range("A1").Value & ".png")を表示させたい。 Sheet1のA2の値が変わったらSheet3のB1にSheet1のA2に対応した画像(例えば"C:\" & worksheets("Sheet1").Range("A2").Value & ".png")を表示させたい。 またエラー処理として、 Sheet1のA1の値が無かったらSheet2のB1には(例えば"C:\0.png")を表示させたい。 Sheet1のA2の値が無かったらSheet3のB1には(例えば"C:\0.png")を表示させたい。 お知恵をお貸しいただければと思います。
DateTimePickerのカレンダーを表示させたとき、画像のようなダイアログを表示し月選択するとダイアログが閉じるようにしたいです。値としては**年**月が理想ですが、**年**月1日でもできれば教えて頂きたいです。 Visual Basicです。
VBAで、別ファイルの”顧客情報”を元にシート（もしくはセルの値）で並び替えすることはできますでしょうか？ ●顧客情報(ファイルA） A列 B列 顧客名 顧客ID ABC社 P0025 ●各顧客ファイル（各ファイルB） セル（C2）にはファイル名と同じ顧客名が入力されてる。 下記は作ったのもの、シート名でのソートなのでどうやって”顧客データ”ベースに並び 替えが出来るのか…よろしくお願いします。 ************ Sub Sample() Dim WshShell Set WshShell = CreateObject("WScript.Shell") WshShell.CurrentDirectory = "\\10.0.155.12\ス本部\03-00 支払請求\" Application.FindFile With Worksheets.Add 'ダミーシートを挿入する 'ワークシート名をセルに書き出す For i = 1 To Worksheets.Count .Cells(i, 1).Value =Worksheets(i).Name Next i 'ワークシート名をソートする .Range("A1").CurrentRegion.Sort.Range("A1") 'ワークシートの位置を並べ替える Worksheets(.Cells(1, 1).Value).Move before:=Worksheets(1) For i = 2 To Worksheets.Count Worksheets(.Cells(i, 1).Value).Move After:=Worksheets(i - 1) Next i 'ダミーシートを削除する Application.DisplayAlerts = False .Delete Application.DisplayAlerts = True End With
Excel２０１０ マクロの質問です。 複数ブックから特定のシートのデータを集合させようとしています。 完全に初心者であるサイトでご紹介されていたマクロを引用させてもらっています。Sub ○○○() Fol = ThisWorkbook.Path & "○○○○" Dim Fn Dim NewFile As Workbook Dim Wb As Workbook Dim Ws1 As Worksheet Dim Ws2 As Worksheet Dim R As Range Set Ws1 = ThisWorkbook.Worksheets(1) Set R = Ws1.Range("A1") Fn = Dir(Fol, vbNormal) Do Until Fn = "" Set Wb = Workbooks.Open(Fol & Fn) 'ワークシート1をコピーする場合は Wb.Worksheets(1) 'ワークシート2をコピーする場合は Wb.Worksheets(2) Set Ws2 = Wb.Worksheets(1) 'Aの1行目から8列目までをコピーして結合する Ws2.Range("A1", Ws2.Cells(Rows.Count, 1).End(xlUp)).Resize(, 8).Copy R Set R = R.End(xlDown).Offset(1) Wb.Close 'Debug.Print Fn Fn = Dir Loop Set R = Nothing Set Ws1 = Nothing: Set Ws2 = Nothing Set Wb = Nothing: Set NewFile = Nothing End Sub 基本的にはうまくいくのですが、 １．データが1行しかない場合 ２．データがなく空欄である場合 Set R = R.End(xlDown).Offset(1) が引っかかって実行時エラーになります。 If文で「空欄なら」「移動して空欄なら」を記述すればよいのでしょうが 試行錯誤しましたがよくわかりませんでした。 アドバイスをお願いします。よろしくお願いします。
上司が現在以下のようなマクロを組んでいます。 が、どこかのサイトから拾ってきただけで、全く理解が出来ないとのことです。部下の自分に解読しておいてとの指示が出ましたが、自分もマクロの知識には乏しく皆様のお力をお借りしたく参りました。 ---以下本文--- Dim buf() As Byte, b As Variant Dim ss() As String Dim dd() As String Dim y As Variant Dim io As Variant, i As Variant Dim myFile Dim a, LB$, c, L$, x ,------------------------------------------ myFile = Application.GetOpenFilename("すべてのファイル,*.:") If VarType(myFile) = vbBoolean Then Exit Sub b = FileLen(myFile) If b > 3094850098# Then b = 3094850098# ReDim buf(1 To b) ReDim ss(1 To b) io = FreeFile() Open myFile For Binary As io Get #io, , buf Close io i = 1 c = 3 2 ReDim dd(1 To b) chk = 1 a = 1 y = 1 Do If c = 50000 Then Worksheets("DATA2").Select c = 4 Goto 2 Enf If dd(y) = ss(i) dd(y) = Right$("00" & Hex$(buf(i)), 2) If dd(y) = "FF" Then c = c + 1 a = 1 y = 1 Goto 1 If b = i Then Exit Sub End If End If If b = i Then Exit Sub End If ----本文ここまで---- 何がどのように動き変換されるのか理解したいです。 以上、宜しくお願いします。
vb2015です。 5つの数字をランダムに重複なく表示させています。 以下のようなコードを書きましたが、数が増えると行も増えます。 どのように書けば、簡略化できますか。また、gotoもあまり使ってはいけないみたいなことを以前回答者に指摘されていますが・・・ よろしくご教授ください。 Randomize() 1: x1 = Int(Rnd() * n0) If sd(x1).s4 = "済" Or sd(x1).s1 = "" Then GoTo 1 Label1.Text = sd(x1).s1 2: x2 = Int(Rnd() * n0) If x2 = x1 Or sd(x2).s4 = "済" Or sd(x2).s1 = "" Then GoTo 2 Label2.Text = sd(x2).s1 3: x3 = Int(Rnd() * n0) If x3 = x1 Or sd(x3).s4 = "済" Or sd(x3).s1 = "" Then GoTo 3 If x3 = x2 Or sd(x3).s4 = "済" Or sd(x3).s1 = "" Then GoTo 3 Label3.Text = sd(x3).s1 4: x4 = Int(Rnd() * n0) If x4 = x1 Or sd(x4).s4 = "済" Or sd(x4).s1 = "" Then GoTo 4 If x4 = x2 Or sd(x4).s4 = "済" Or sd(x4).s1 = "" Then GoTo 4 If x4 = x3 Or sd(x4).s4 = "済" Or sd(x4).s1 = "" Then GoTo 4 Label4.Text = sd(x4).s1 5: x5 = Int(Rnd() * n0) If x5 = x1 Or sd(x5).s4 = "済" Or sd(x5).s1 = "" Then GoTo 5 If x5 = x2 Or sd(x5).s4 = "済" Or sd(x5).s1 = "" Then GoTo 5 If x5 = x3 Or sd(x5).s4 = "済" Or sd(x5).s1 = "" Then GoTo 5 If x5 = x4 Or sd(x5).s4 = "済" Or sd(x5).s1 = "" Then GoTo 5 Label5.Text = sd(x5).s1
リストボックスからデータを選んで別シートを開くようにしています。 選んでない時は『物件を選択して下さい。』のメッセージを出します。下記の要領ですると選んでも選ばなくても『物件を…のメッセージが出てしまい、別シートが開きません。 同じ要領でちゃんと動いているものもあるのにどうしてこれはちゃんと動かないのでしょうか。 どこが間違っていますか？ご教示願います。 Private Sub btn開く_Click() If lst物件.Text = "" Then MsgBox "物件を選択して下さい。", vbInformation, "確認" Exit Sub End If fom追加変更シート.Show End Sub
いつもお世話になっております。ExcelのVBAにて行き詰まってしまったので 質問させていただきます。 今現在、算数の位の計算プログラムを 作成しようとしています。 UserFormのTextBox1に数値4桁(例.1234)を入力すると、TextBox2(1)、TextBox3(2)、TextBox4(3)、TextBox5(4)といった具合で、１つずつ分けて数値が出力されるようにするということは可能でしょうか？ また数値3桁(例.123)の場合には、 TextBox2(無)、TextBox3(1)、TextBox4(2)、TextBox5(3)となるように考えております。 自分でも考えてみたのですが、 文字と数値を分けるということしかできず 行き詰まってしまいました。 私の知識不足のため どなたか何卒、ご教授お願い致します。
【VBAの確認】”変更”フォルダ内のファイルにはが全て同じパスワード（abcd）がかかってお り、その中の（"山"シート）を新しいファイル(ブック)にまとめる作業を別ファイル上 （Aファイル）で作ったのですが、うまくいきません。下記修正箇所あればご教示お願 いします。 Const FolderName = "C:\Users\Desktop\変更" Const PassWD = "abcd" Sub Sample() On Error Resume Next Dim TSheet As String TSheet = Dir(ThisWorkbook.Path & "\*.xls*", vbNormal) Do While TSheet <> "" If TSheet <> "*".xlsx" Then Workbooks.Open (ThisWorkbook.Path & "\" & TSheet) ActiveWorkbook.Sheets("山").Copy after:= _ Workbooks.Add.Sheets(1) ActiveSheet.Name = Range("A1").Value 'シート名をセルA1の値に変更 Workbooks(TSheet).Close End If TSheet = Dir() Loop End Sub
Excel2010 VBAでCSVを上手く取り込みたいです。取り込みたいCSVは、 カンマ区切りですので、カンマで区切ってセルに入力していけますが 、データ中にもカンマが入っており、列が増えてしまったりして上手く取り込めないです。 CSVファイルをダブルクリックでエクセルで開けば、その辺りの処理は上手くやってくれています。 ですが、副作用として 頭のゼロが消えたり、長い数字が指数表示になってしまいます。 ・CSV内の数値項目を含め、全て文字列として取込でOK ・データ中のカンマはデータとして認識して ・欲を言えば、CSV内のダブルコーテーションも削除（データ中のダブルコーテーションは削除しない） ような取込を希望しますが、やり方をご存知の型や、こういう場合の対処方法を説明してあるサイト等 をご存知の方が居れば、ご教示頂けますでしょうか。
opencv1を使用したプログラムをopencv2で使用して動かそうとしたら 主にソースファイルが開けませんと表示されました。この原因がopencvとopencv2での表記の仕方が変わったからでしょうか？ 解決策を教えてください。
Visual C#で、クラスAのフィールドをクラスAの外部から操作する方法についてお聞きします。 ローグライクRPGを制作していて、困ったことがあります。添付画像（※１）のようなプログラムを書いたとき、当然エラーになりますよね。 そこで、（※２）のようにしてプログラムを修正しました。 もちろん、これでも質問タイトルの動作はしてくれるのですが、 このプログラムですと、プログラムが大規模なものになったときに以下のような問題が生じて、 プログラムが煩雑になってしまいます。 ・ Projectクラス外部（Renameクラスなど）でProjectクラスのインスタンスを操作したいときに、いちいちProjectクラス内でrenameのようなインスタンスを生成しておかなければいけない ・ Projectクラス内部から他のクラスのメソッドを呼び出す際に、引数として渡さなければならないインスタンスが多くなってしまう 特に、引数がいくつも増えてしまうことに違和感を感じます。 根本的にコーディングが間違っているのでしょうか？ どなたかご教授願います。 環境： Windows10 64bit Visual Studio 2015 Community
VB.netでSQLサーバーに接続してデーターベースを操作したいです。ネットでいろいろ調べてみました。 下記のサンプルコードがありました。Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Dim St As String Dim Cn As New System.Data.SqlClient.SqlConnection Dim SQL As System.Data.SqlClient.SqlCommand Dim ServerName As String = "(local)" 'サーバー名(またはIPアドレス) Dim UserID As String = "sa" 'ユーザーID Dim Password As String = "" 'パスワード Dim DatabaseName As String = "Northwind" 'データベース St = "Server=" & ServerName & ";" St &= "User ID=" & UserID & ";" St &= "Password=" & Password & ";" St &= "Initial Catalog=" & DatabaseName Cn.ConnectionString = St SQL = Cn.CreateCommand SQL.CommandText = "SELECT FirstName FROM Employees" Cn.Open() MsgBox(SQL.ExecuteScalar) Cn.Close() SQL.Dispose() Cn.Dispose() End Sub 上記コードでデータベース名を記入する箇所があるのですが、データーベースを設置しているパスを 記入する必要はないのでしょうか？ C:￥Dataset￥Sdataフォルダーの中にS1（データーベース名）を設置しています。また、データーベースの拡張子も記述しなければいけませんよね。Sqlサーバー2014EEを使っています。 本当に初心者で申し訳ありません。データーベースのパスの記述と、拡張子の記述について教えてください。お願い申し上げます。
印刷に関する質問です。vba初心者です。先輩方助けて下さい！ 下の定数欄の開始番号と終了番号にセルの値を反映させたいのですが、うまくいきません。ご教授願います。 開始番号には印刷シートと同じシートのR14の値を 終了番号には印刷シートと同じシートのS14の値を入れたいのですが、。 Sub Print_Out_1() 'セルに値を設定しながら印刷する '定数 Const conStart As Long = 1 '開始番号 Const conEnd As Long = 40 '終了番号 Const conStep As Long = 1 '間隔 Const conCell As String = "B2" 'セル番地 '変数 Dim lngI As Long With Application .ScreenUpdating = False With .ActiveSheet.Range(conCell) For lngI = conStart To conEnd Step conStep.Value = lngI ActiveSheet.PrintOut Next End With.ScreenUpdating = True End With End Sub
連続演算ができません。 この式で減算、乗算、除算は連続演算してくれるのですが 加算だけ、計算されず、連結演算されてしまいます。例えば、６+５+８にすると、普通なら19と答えが出るはずなのですが 加算だけ、658と出てきます。 こういった場合はこの式でどうすればよろしいのでしょうか 教えていただきたいです If X = "" Then X = TextBox1.Text Y = "-" TextBox1.Text = "" Else TextBox1.Text = X - TextBox1.Text X = TextBox1.Tex z = 1 End If
VBA初心者です。 Excelのファイルが開かれた時と、そのファイルのどこかが変更されたときに同じ処理を行いたいと思っています。Private Sub Workbook_Open() 処理A End Sub Private Sub Worksheet_Change(ByVal Target As Range) 処理A End Sub を使えば出来そうなのですが、この２つをまとめてすっきり記述することはできませんか？ ご教示お願いします。
エクセルVBAのシート上に挿入したコンボボックスにACCESSデータベースのテーブルから取得したレコードをリスト表示させて選択したいのですがどのような構文を記述したら良いでしょうか？現状以下の構文でデータベースに接続することまでは出来ています。 Private Sub ComboBox1_Change() Dim DBpath As String 'ファイル名 Dim adoCn As Object 'ADOコネクションオブジェクト Dim adoRs As Object 'ADOレコードセットオブジェクト Dim strSQL As String 'SQL文 DBpath = ThisWorkbook.Path & "\miyageDB.accdb" Set adoCn = CreateObject("ADODB.Connection") Set adoRs = CreateObject("ADODB.Recordset") adoCn.Open "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & DBpath & ";" '業者名一覧取得 strSQL = "Select Distinct 業者名 From M_syouhin " adoRs.Open strSQL, adoCn 'SQLを実行して対象をRecordSetへ With ComboBox1 End With adoRs.Close 'レコードセットのクローズ adoCn.Close 'コネクションのクローズ Set adoRs = Nothing 'オブジェクトの破棄 Set adoCn = Nothing End Sub
Excelについて質問です。フィルター機能についてなのですが、 例えば A列 B列 → A列 B列 あ店 りんご → あ店 ばなな い店 ばなな → あ店 りんご あ店 ばなな → い店 いちご う店 みかん → い店 ばなな い店 いちご → う店 みかん のように,昇順で分けたいのですが、フィルター機能だけではできないのでしょうか？
表形式のシフト表をカレンダー形式にて抽出したい。 20名分ほどのシフト表なのですが、全員の1か月分のシフト表がエクセルの1シートにあります。 そのシートを「シートA」とします。・A列に名前が入っており、20名分の行番号は変わることはありません。（名前は変わります） ・B,C列を飛んで、D列以降には31日分の列に日付軸が入ります。 ・シフトの内容はA10、A20、A30、B10、B20と言った様な形式のコードとなります。 別シートにはシートAの内容をカレンダー形式で表示します。 このシートは「シートB」とします。 ・A～B列の行ごとに日付と曜日が入ります。1日分で５行使用しています。 ・C列以降の５列毎に「Aパート」「Bパート」「休み」と振り分けます。 ・各パート毎に、5列×５行の２５マス ・シートAの２０名を上記３パートの枠組みに固定で配置（セル位置は固定ですが、並びは変則的） ・各日、パート毎にシートAの各自該当マスのシフトコードを参照し、該当する場合は「名前10」の形式に変換し表示。該当しない場合は非表示。 やりたいことの概要は上記なのですが、文面で書くと意味不明になってしまいました。 現状、上記の１３人バージョンはあるのですがシートBの方にはIF文の乱用でなんとか実現しているような形でして、この度２０人形式に変更したいのですが列と行の変な組み合わせのせいでコピペもできず手作業で打ち込むには気が遠くなったために質問をさせて頂きました。 そもそも形式を変えれば済む話なのかもしれませんが、会社のファイルなので簡単には変えられないという制約があっての事態です。 駄文で申し訳ありませんが、効率的な構築方法を助言を頂けますと幸いです。 やりたいことを簡易的に書いた画像を添付しました。
VBAでユーザーフォームの作成でリストボックスからシートを選択し、そのシートのある範囲（”A5”を起点に最終行・最終列)の合計をメッセージボックスで出したいと思いトライしています。しかし、シートを選択し、画面も選択した画面まで来てそのあと、動いてくれません。どこが悪いのか行教示いただけると幸いです。よろしくお願いします （見よう見まねで初めて作ったため、変な内容かと思いますがご容赦ください） ★ユーザーフォーム１ List Box1 CommandButtan1 ★ユーザーフォーム１（コード） Private Sub CommandButton1_Click() Me.Hide End Sub Private Sub ListBox1_Click() MsgBox (ListBox1.Text & "が選択されました") Me.Hide Worksheets(ListBox1.Text).Activate End Sub ★モジュール Sub ListBoxShow() Dim idx As Integer UserForm1.ListBox1.Clear For idx = 1 To ThisWorkbook.Worksheets.Count UserForm1.ListBox1.AddItem Worksheets(idx).Name Next idx UserForm1.Show Sub Example() Dim Msg As Integer Dim t As Variant t = WorksheetFunction.Sum(Range(Range("A5").End(xlToRight).Column, Range("A5").End(xlDown)) MsgBox "合計は" & t & "円です。", End Sub
vb.netのふとした疑問知恵袋なら一括で解答が得られると思い、質問させていただきます。 VB.NETについて質問があります。 Q1.Label1.textなどに値を格納するとき、 Label1.text = null、nothing、"空欄" のそれぞれの違いはなんでしょうか？また、これらの使い分けも教えていただけたらと思います。 ※私なりにはnullは0などの｢ない｣よりも空っぽの｢ない｣のイメージが何となくありますが、曖昧で… Q2.｢And｣｢&｣｢AndAlso｣の具体的な違いはなんでしょうか？また、これらの使い分けはどういったものでしょうか？ よろしくお願いします。
VB.NET「処理の中断/待機」について 現在、別の質問をさせていただいておりますが、こちらも質問させていただきます。Q．「ボタンを押すと、テキストが表示され後、その1秒後に自動的に別のテキストを表示させる」には？ （イメージとしてテレビやゲーム等のテロップやメッセージのように） そこで（現在のコード）･･･ Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click RichTextBox1.Text = ”あいうえお” ’処理を1秒間待機させる System.Threading.Thread.Sleep(1000) RichTextBox1.Text = ”かきくけこ” End Sub ・・・ としましたが、結果は 「ボタン(押す)→テキスト：空欄のまま1秒待機→テキスト：かきくけこ」 これでは”あいうえお”は表示されず、ただ1秒後に”かきくけこ”と出るだけになってしまいます。 説明不足ではありますが、ご教授お願いします。 可能であれば具体的にお願いいたします。
エクセルのVBAについての質問です。"sheet1"のコードウィンドウに書かれてある特定のマクロ（複数書かれている中の１つ、１つが不可能であれば書かれているマクロ全部）を、標準モジュールに書かれているマクロによって"sheet2"のコードウィンドウにコピーしたいと考えています。 どういうプログラムを書けばいいのか、そもそも可能なのかを教えていただけると助かります。 よろしくお願いします。
Excelドロップダウンリストを削除できない。 ご覧いただき，ありがとうございます。 初めに「A１～D１」を結合し，このセルへの入力規制（ドロップダウンリスト）を設定しました。その後，「A１～D1」の結合を解除し，「A１～D２」を結合し，このセルへの入力規制（ドロップダウンリスト）を設定しました。 この状態になって，初めに「A1~D１」に設定した入力規制が削除できないままで困っています。 具体的にはドロップダウンリストの下向きの三角矢印が残ってしまっています。 セルを選択し，入力規制画面の「すべてクリア」をしても効いていないようです。 ご教示お願いします。
全く同じ処理内容のﾌﾟﾛｸﾞﾗﾑをまとめたい。 (2) 例えば番号が違うだけのパターン。 ｺﾏﾝﾄﾞﾎﾞﾀﾝ番号とﾌﾚｰﾑ番号が違います。Private Sub CommandButton4_Click() Static st If st = False Then st = True Else st = False End If Frame7.Visible = st End Sub Private Sub CommandButton5_Click() Static st If st = False Then st = True Else st = False End If Frame8.Visible = st End Sub どのようにやればいいでしょうか。
VBAについて 先日、特定のフォルダから特定のセルに入力された文字列を読み取って、その文字列が含まれるファイル名を書き出すＶＢＡを作って頂いたのですが、どうにもうまく動きません。ファイル名を書き出すところまでは動くのですが、特定のセルに入力された文字列に対応したファイル名が書き出されません。 どこを修正すればよいか教えてください。 Dim i As Long, buf As String Dim NM As String, r As Long Const Path As String = "C:\Users\AA\Desktop\Aフォルダ\" r = 1 Do While Cells(r + 3, 2).Value <> "" NM = Cells(r, 1).Value buf = Dir(Path & "*.*") r = r + 1 Loop Do While buf <> "" If buf Like "*" & NM & "*" Then i = i + 1 Cells(i + 2, 6) = buf End If buf = Dir() Loop B3以降に入力された文字列を読み取って、Aフォルダに入っているファイルから文字列が含まれるファイルをF3以降に入力する感じです。
VB.netでSQLサーバー2014EEに接続する試みですが、下記のコードでOK表示が出ました。これは接続ができたことでしょうか？Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click Dim St As String Dim Cn As New System.Data.SqlClient.SqlConnection Dim SQL As System.Data.SqlClient.SqlCommand Dim ServerName As String = "TATSUHIKO-PC" 'サーバー名(またはIPアドレス) Dim DatabaseName As String = "S1" 'データベース St = "Server=""(local)"";" St &= "integrated security=SSPI;" St &= "initial catalog = S1" Cn.ConnectionString = St SQL = Cn.CreateCommand SQL.CommandText = "SELECT * FROM s1data" Cn.Open() MsgBox("setuzoku") MsgBox(SQL.ExecuteScalar) Cn.Close() SQL.Dispose() Cn.Dispose() End Sub 疑問があるのですけど、SQLサーバー2014をインストールしたときは、確か混合認証モードでパスワードも入力してインストールしたのですけど、データーベースをManagementStudioでデーターベースを作ってみてみると、Windows認証モードで表示されています。よって、上記コードで記述してみました。 設置したボタンをクリックすると「OK」表示が出ました。接続されているのですよね。Windows認証モードでデーターベースが作られているのでしょうか？なんだか混乱しています。ご教授をお願い申し上げます。
何度もお金をせがむなんて妖怪のせいですね
PDFから情報を抽出したいです。 ライブラリやSDKやツールについて知恵を拝借したいです。 抽出したい情報： ブックマーク（しおり） ・ブックマーク名 ・ページ数 ・作成者 ・作成時間 アノテーション（注釈） ・注釈のタイプ ・テキスト情報 ・ページ数 ・作成者 ・作成時間 開発言語はVBAの予定です。 ソースコードの中でライブラリとして引用したいです。 最悪、コマンドラインで実行できればいいと思います。 アンテナハウスのPDF Tool APIを試したが、 アノテーションのページ数が抽出できない為、 やめざるを得ませんでした。 よろしくお願い致します。
PC間でUDPを使いメッセージのやり取りを行う方法について visual studio 2015のvisual basicで通信ソフトを作っています。 できれば言語はこれで統一したいです。（ほかのメンバーが作っているソフトと合体させたいので） UDPについてはネットで調べたので少しなら知っています。今回は送る動作はしているが、届いていない。もしくは、受信側が受け取る用意をしていない、という点が疑問で質問させていただきました。 目標としては、 １．２台のPC間の通信の実現（メッセージを送りあう） １についてですが今のところ、一台での通信になっています。クロスケーブルを使ってPC間の通信を試みたのですが、メッセージが届きません。 IPアドレスの確認、変更方法は把握していますが、デフォルトゲートウェイなどの変更が必要なのかなどは把握できていない状態です。 ２．日本語を送りあう 今はアルファベット、数字しか送れません。送受信する文字列のバイト数をどうにかする必要があるのかな？と思い、ほかのサンプルコードなどを参考に調べています。 サンプルコードをコピペしても動かないかエラーが出てしまうのでこの動画を参考に作りました。 https://www.youtube.com/watch?v=15H2_ikPr9E コードは以下です。正常に動いています。テキストボックス４つとボタン一つです。 IPアドレス ポート番号（今回は2000） 送る内容 のように記入して送信すると４つ目のテキストボックスに送った内容が表示されます。 Imports System.Net Imports System.Text.Encoding Public Class Form1 Dim publisher As New Sockets.UdpClient(0) Dim subscriber As New Sockets.UdpClient(2000) Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click publisher.Connect(TBTo.Text, TBPort.Text) Dim sendbytes() As Byte = ASCII.GetBytes(TBSend.Text) publisher.Send(sendbytes, sendbytes.Length) End Sub Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load subscriber.Client.ReceiveTimeout = 100 subscriber.Client.Blocking = False End Sub Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick Try Dim ep As IPEndPoint = New IPEndPoint(IPAddress.Any, 0) Dim rcvbytes() As Byte = subscriber.Receive(ep) TBRcv.Text = ASCII.GetString(rcvbytes) Catch ex As Exception End Try End Sub End Clas ここからが質問なのですが １．一台で動くということは送信から受信までできているということですよね？ そうでなければ方法をご教授をお願いします。 ２．Dim publisher As New Sockets.UdpClient(0) この0はどのような役割を担っていますか？ ３．PC間の通信を実現させるにはどの部分の改善が必要でしょうか？ 長くなってしまいましたがよろしくお願いします。
VBAを用いてIEを操作する方法についてです。VBAを用いてIEを操作するプログラミングをしておりましたが、家のパソコンではうまくいきましたが他のパソコンではうまくどうっしない事態が起こりました。この原因は何でしょうか？行っていたこととしまして、エクセルの値を検索し、その検索結果をコピーし、エクセルに保存ということをしていたのですが、コピーできている範囲が変わり、ほしいデータが得られません。よろしくお願いいたします。 http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1315983530...
エクセル2013のマクロについての質問です。A列1行から約1000行にまで単語が入っています。 それらの単語全てを半角スペースを挟んでC1にいっきに並べるマクロを教えてほしいです。よろしくお願いします。
エクセルで「上の3×3のセルのどこかに数字が入っていたら、数字が入っているセルの3つ下の文字列を表示させる」やり方がわかりません……。 教えてくださいよろしくお願いいたします。エクセルでA1:C3（/はセルの分かれ目です）のセルの / / / /５ / / ↑中列右に数字（1～9のいずれか）が入力されている場合 (数字は9セルの中のどこか1か所しか入力されません。ほかの8セルは関数で空欄になるようにしてあります) すぐ下のA4:C6のセル あ / こ / や が / い / の こ / ど / も ↑中列右の”の”が表示される関数をA7のセルに作りたいのですが、やり方がわかりません。 どなたか教えてください……。
エクセルマクロの指定したセルをダブルクリックでセルのサイズに合わせて写真挿入するものをネットで拾って使っています。非常に使い勝手がよく便利なのですがiphoneの縦画像を挿入した際にセルから縦のサイズがはみ出でしまいます。 画像がセルからはみ出ない様にしたいのですがどこのコードをどう変更すればいいのか全くわかりません。 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーー Option Explicit Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Excel.Range, Cancel As Boolean) Dim myF As Variant Dim mySp As Object Dim myAD1 As String Dim myAD2 As String Dim myHH As Double Dim myWW As Double Dim myHH2 As Double Dim myWW2 As Double If Application.Intersect(Range("B5,B21,B37,N5,N21,N37,Z5,Z21,Z37,AL5,AL21,AL37,AX5,AX21,AX37"), Target) Is Nothing Then Exit Sub Cancel = True With Application.FileDialog(msoFileDialogFilePicker) .Title = "画像の選択" .AllowMultiSelect = False .InitialFileName = Range("B3").Value If .Show = -1 Then myF = .SelectedItems(1) End If End With If myF = "" Then MsgBox "画像を選択してください。" Exit Sub End If For Each mySp In ActiveSheet.Shapes myAD1 = mySp.TopLeftCell.MergeArea.Address myAD2 = Target.Address If myAD1 = myAD2 Then mySp.Delete Next Set mySp = ActiveSheet.Shapes.AddPicture(Filename:=myF, LinkToFile:=False, _ SaveWithDocument:=True, Left:=Target.Left, Top:=Target.Top, _ Width:=0, Height:=0) mySp.ScaleHeight 1, msoTrue mySp.ScaleWidth 1, msoTrue mySp.LockAspectRatio = msoTrue If mySp.Width > Target.Width Then mySp.Width = Target.Width - 10 If mySp.Height > Target.Height Then mySp.Height = Target.Height - 10 myHH2 = (Target.Height / 2) - (mySp.Height / 2) myWW2 = (Target.Width / 2) - (mySp.Width / 2) mySp.Top = Target.Top + myHH2 mySp.Left = Target.Left + myWW2 Set mySp = Nothing End Sub ーーーーーーーーーーーーーーーーーーーーーーーーーーーーー 現在、画像の左側のようになるのを右側のようにセルの中に入りきるようにしたいです。 ご教示お願いします。
エクセルで特定の言葉を○で囲むための方法を教えてください。会社で他社の専用伝票を エクセルで作成→印字がされている伝票へ印刷→履歴を残したいといわれ、私なりに考えて作成しておりますが、文字を○で囲む箇所が大変多く、どのようにしていいか困っております。 このエクセルは、複数の社員が使用します。 文字を入力するのが精一杯な社員も数名おるため、手動でオートシェイプを使うことをできれば避けたいです。 履歴も残す必要があるため入力規則で選択し、その選択肢の時は、このシートのここへ○をつけるという風にしたいです） 印字された伝票へ印刷するので最初は、 背景無色でつくった○の画像を、図のリンク貼り付け・切り替えで作成してみたのですが、 多すぎて混乱してきたので、このような場合、どのようなＶＢＡを使うのかなど教えていただけないでしょうか。 ◆使用しているエクセルは2003です。 ◆伝票は２種類あります。 シート１と２に作成しました。 このシート１と２に○をつけたいです。（どちらかまたは両方へ） ◆シート１と２はvlookなどを使用しております ◆シート３に入力ページをつくっております。 ◆○で囲みたい項目については、すべて入力規制で選択するようにしています。 ◆○をつける項目の例です。 項目１→以上・以下・未記入の場合は空白 （伝票１のみに○をつけたいです） 項目２→都道府県のどれかに○・未記入の場合は空白 （伝票２のみに○をつけたいです） 項目３→付属１・付属２・・・（複数選択可）・未記入の場合は空白 （両方の伝票に○をつけたいです） ○をつける項目は２０箇所ほど 各項目とも選択肢はだいたい３～５種類です。 （どれか１つを選択して○をつける、複数選択可能、○の大きさもそれぞれ異なります） 分かりづらい文章ですみません。 わかりやすい例などと合わせて、良い方法をおしえていただけると助かります。 どうぞよろしくおねがいします。
Visual Basicで積分するプログラムの書き方で悩んでいます。具体的には、y=3x^2−4x＋5 (3＜x＜10)の式の 面積近似をΔx0=0.1~1としたときの面積誤差の変化を確かめる、といったものです。 For nextかLoopを用いればよいことはわかっているのですが、組み立て方がいまいちよくわかりません。 簡単な例などを用いて教えていただけると嬉しいです。
マクロにおいて、対象属性とはなんのことでしょうか？
exel VBAでの 図形複数選択について質問です。 同じ名前の図形を複数選択するコードを考えているのですが sub sumple() Dim myShp As shape For Each myShp In Activesheet.ShapesIf myShp.Name = "まる" Then myShp.Select False End if Next End sub 上記のコードだとグループ化されている中にある"まる"という図形が選択されません。 グループ化の中の図形も選択できるようにはできないでしょうか？ 分かりづらくて申し訳ございません。
VB6のテキストボックスについて VB6でテキストボックスに出力する際に変数と文字を同時に出力することはできないのでしょうか？たとえばA=10とB=20 の場合 10～20と表示したいのですが～を""で囲んでもエラーが出てしまってわかりません。 回答お願いします。
VB.NET xdoc2txtをつかってPDFからテキストを取り出したいです。c:￥tempにあるpdfファイル（複数でフォーマットは全て同じ、ファイル名は違います）から テキスト情報を取り込みたいです。 できれば、指定座標のテキストを抜き出したいです。 例ですが3行目の5文字目から15文字目を抜き出すということをしたいです。 xdoc2txt.exeやxdoc2txt.dllなどはどこに配置したら良いのかも教えてください。 どうぞよろしくお願いします。
下記のマクロを実行すると、互換性チェックのダイアログボックスが表示されます。続行をクリックすると、保存されるので問題はないのですが、見た目がわるいので、強制的に表示させないプログラムを下記のプログラムに埋め込めて貰えないでしょうか。お願い致します。 Sub 保存() Sheets("計調BKUP").Select Dim 既定ファイル名 As String Dim 保存ファイル名 As Variant 既定ファイル名 = "計調BKUP" & Format(Now(), "yyyymmdd-hhmmss") 保存ファイル名 = "X:\共有\システム関係\消耗品発注\計画調達課\計調BKUP\" & 既定ファイル名 & ".xls" If 保存ファイル名 = False Then MsgBox "保存は中止されました。" Else With ThisWorkbook.ActiveSheet Workbooks.Add .Copy After:=ActiveWorkbook.Sheets(1) Application.DisplayAlerts = False ActiveWorkbook.Sheets(1).Delete Application.DisplayAlerts = True ActiveWorkbook.SaveAs 保存ファイル名, xlNormal ActiveWorkbook.Close False End With Sheets("計調BKUP").Select Range("H1").Select MsgBox "バックアップを作成しました。" End If End Sub
VBAについて質問です。 最近VBAでゲームプログラミングをするということに興味を持って始めたのですが、いきなりキー入力の部分でつまづきました。昔のファミコンのRPGみたいに、マップが1マスずつ区切られていることを想定して、またRPGなのでシート上にボタンを用意してそれにマクロを設定すると延々カチカチカチカチクリックしなければならずうっとうしいと思ったので、直接キーボード上のキー入力でマップ上のキャラクターを動かせるようにしたいと考えました。 そこで打ったマクロがこれです ------ Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long) Sub MoveTest() Application.OnKey "{LEFT}", "MoveLeft" End Sub Sub MoveLeft() Cells(1, 1) = Cells(1, 1) + 1 Sleep 500 End Sub ------ 実装時にはCells(1,1)はマップ上のX軸を-1するプログラムに変えますが、とりあえずのテストとしてキーボードの左キーを押すとセルA1に入力されている数字が1つずつ上がるようになっています。 また、一気に左に動くと動かしづらいので、左キーを押しっぱなしにしても0.5秒経つまで左に移動するという処理を待ってもらうようにしてあります。 ここまでは狙い通りだったのですが、問題は左ボタンを離してもその時点から数字が1つ上がってしまうんです。 プレイヤーが「ここ！」と止めたはずの位置から、（障害物が無ければ）キャラクターの位置が1マス左にずれてしまうことになり、これはまずいです。 ネットを調べるとIsKeyDownやIsDownなどを使えばいいんだろうなという予想は立っていますが、正直どのように組み合わせればいいのかいまいち分かりません。どなたか分かる方がいらっしゃればアドバイスをお願いします。 または、「このようなプログラムではなくこうした方がいいのでは？」というアドバイスがあればお願いします。
OUTLOOK VBA メアドのドメインを取りたい。BA250!! http://b.0218.jp/20121119234620.html 上記URLに、エクセルでワークシート関数でのやり方があります。 Outlook VBAで、メールの複数ある宛先から、ドメインだけ取りたいです。 RecipientのAddressプロパティーのなかから、 @以下を文字列で抽出したいですが、どのようにコーディングしたらよいでしょうか。 Recipientのプロパティーでドメインだけ表示するプロパティーがあればよさそうですが、 無いようです。 アドバイス宜しくお願い致します。
エクセル・マクロで、半角の拗音促音(ャュョ…)を半角の大文字(ヤユヨ…)に変換したいのですが、 下記の状態では拗音促音は小さいまま… 漢字で書いてある銀行口座→”銀行”を除いてカナに変換の流れなのですが この後に、拗音促音を大文字にできるコードが入れられず、苦慮しております 他の人が作成したマクロを現在使用していて、複数作業が一回でできるようになっているため、下記一部抜粋です下記コードに追加して実行できないか模索しております。 どうぞよろしくお願いします。 ************************************ Dim bankFlag As Boolean Dim ibFlag As Boolean Dim remarks As String Dim tmp As String Dim plantNo As Integer '***半角カナ変換 *** tmp = Replace(plantData(plantNo, 8), "銀行", "") tmp = Left(tmp, InStr(tmp, "（") - 1) tmp = StrConv(Application.GetPhonetic(tmp), 8) 'カナに変換
Excel VBAで図形内のテキスト取得 Excel2016で、図形内に入力されているテキストを取得し 別シートのセルへ出力したいと考えています。シートは「P01/P02/P03....」と任意の数だけあり、(最大P99) 最後に「作業」というシートがあります。 この「P**」のシート内にある複数の図形からすべてテキストを取得して 「作業」シートのB5セルから下に出力していき リストのような形にしたいです。 調べながらやろうとしたものの中々理解できず苦戦しています。 分かりにくいかもしれませんが、ご教授よろしくお願いいたします。
vb2010について質問です。 DictionaryのインスタンスにHashtableのインスタンスを格納するにはどうすればよいのでしょうか？何度やってもエラーが出てしまうので困っています…。
エクセルＶＢＡ・ＭＰ３再生時の入力一時停止についてお知恵をおかしください。バーコードスキャナで番号を読み取りDATABASEシートのＰ２セルに入力、同じ番号を検索し名前を取得、その名前の行の今日の日付欄に○を入力するというマクロを組んでいます。 また、○が入力されたあと、「あいさつ」というＭＰ３が再生されるようにしています。 通常時はこのコードで問題ないのですが、バーコードによる入力が立て続けに行われ、ＭＰ３が再生されている間に次の番号、更に次の番号と続けてスキャン入力されると、（今は入力された番号全てを処理しようと動いています）マクロの処理が追いつかなくなってしまいます。 そこで、ＭＰ３の再生が終了するまで次の番号が入力できない、もしくはＭＰ３再生を中断し新たな入力に対応するようにできればと考えたのですが、どの部分のコードを変えたらいいのかよくわかりません。 いまのコードは次の通りです。 Dim C As Integer '列番号 Dim ToDay As Date '本日の日付 '今日の日付を取得 ToDay = Date Set FoundCell = Rows(5).Find(What:=DateValue(ToDay), LookIn:=xlFormulas) FoundCell.Activate C = ActiveCell.Column Dim FRng As Range Dim Fst As String Dim FStr() As String Dim FAd() As String Dim Cnt As Long Dim Re As String Range("B7").Activate Set FRng = Range("B7:H50").Find(Worksheets("DATABASE").Range("P2").Value, _ after:=Range("B50"), LookIn:=xlValues, LookAt:=xlPart) If Not FRng Is Nothing Then Fst = FRng.Address Do Cnt = Cnt + 1 ReDim Preserve FStr(Cnt) ReDim Preserve FAd(Cnt) FStr(Cnt) = Cnt & "： " & FRng.Value FAd(Cnt) = FRng.Address Set FRng = Range("B７:H50").FindNext(FRng) Loop Until FRng.Address = Fst If Cnt = 1 Then Range(FAd(Cnt)).Activate Else Re = InputBox(Cnt & " 件見つかりました。 " & _ "何番目ですか？ 番号で指定してください。" & _ Join(FStr, vbLf)) If Val(Re) > 0 And Val(Re) <= Cnt Then _ Range(FAd(Val(Re))).Activate End If Else MsgBox "見つかりません。", vbExclamation End If Set FRng = Nothing ActiveCell.Offset(0, C - 8).Activate ActiveCell = "○" Dim SoundFile As String, rc As Long SoundFile = "C:\Users\Home\OneDrive\H28\あいさつ.mp3" If Dir(SoundFile) = "" Then MsgBox SoundFile & vbCrLf & "がありません。", vbExclamation Exit Sub End If rc = mciSendString("Play " & SoundFile, "", 0, 0) End Sub ＭＰ３ファイルは、5秒ほどあります。 イメージとしては ・ＭＰ３の再生が終わるまで次の入力を受けつけない ・ＭＰ３再生中に次の入力が行われた場合ＭＰ３再生を中断し入力の処理を行う のいずれかができればと思っています。 お詳しい方、どうかご教示ください。
エクセル2013 表示/非表示の自動について(VBA?) C8•E8•G8•l8•K8があり(それぞれ2列ずつセル結合)、 20~49行が非表示だとします(A列に結合セルが混在)。 E8に値を入力すると、非表示だった20~29が表示。 G8に値を入力すると、非表示だった30~39が表示。 I8やK8も同じようにしたいのですが、それを自動で設定することは可能でしょうか。 また上記がSheet1の場合、Sheet2も連動させることは可能でしょうか。 たとえば、4~7が非表示だとします。 Sheet1のE8に値を入力すると、Sheet2の非表示だった4行目が表示。 Sheet1のG8に値を入力すると、Sheet2の非表示だった5行目が表示。 6•7行目についても、同じようにしたいと思います。 どうぞよろしくお願いいたします。
セル結合が至る所にされている表があります （画像参照） 白地（アルファベット）の箇所はセルの保護がされています 黄色字の箇所はセルの保護がされておらず、入力できるようになっています左上から右下へ向かって黄色字の箇所のみ通し番号を振っていきたいのですが 結合セルであるため、なかなかうまくいきません 良い方法があればご教示いただきたく思います。 ちなみに参照画像では14までしかありませんが 実際には1000を超えます。 ですので参照画像でA1～BH5までを選択した状態で マクロを起動し、黄色箇所のみ通し番号を振る、ということができれば と思います。 どうぞよろしくお願いいたします。
ExcelVBAにて質問させていただきます。今現在 Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) If Intersect(Target, Range("g2:g152")) Is Nothing Then Exit Sub End If UserForm1.Show Cancel = True End Sub と、G2からG１５２をダブルクリックでUserForm１がでるようにしていますが、 さらにE2からE１５２をダブルクリックでUserForm２をでるようにしたいのですが、 どうすればいいでしょうか？
全く同じ処理内容のﾌﾟﾛｸﾞﾗﾑをまとめたい。例えば番号が違うだけのパターン、 With ComboBox2 .AddItem "A" .AddItem "B" .AddItem "C" .AddItem "D" End With With ComboBox3 .AddItem "A" .AddItem "B" .AddItem "C" .AddItem "D" End With ・・・ となっています。 うまくまとめるにはどのようにやればいいのでしょう。
初歩的質問だと思うのですが、 ネットで調べて色々試してみても駄目なのでこちらでご質問します。 エクセルのＶＢＡでフォームにリストボックス一個とコンボボックスを一個を設置し エクセルシートのsheet1(基本リスト)のA1:A10をリストボックスに Sheet1(基本リスト)のB1:B10をコンボボックスに格納というか反映させるにはどの様に書けばよいのでしょうか？できればフォームを開くと同時に読み込みたいのですが… よろしくご教授願います。
エクセルマクロ VBA について質問です。 シート名に特定の文字列が含まれるものについて 決められたセルに各特定の文字を入力したいです。 以下内容です。複数のエクセルファイルがあり 保有するシート名はそれぞれ異なります。 A、B、C、D の4種類の文字を含むシートがあり、 シート名にAを含む場合は、AY1セルに「1」と入力。 シート名にBを含む場合は、AY1セルに「2」と入力。 シート名にCを含む場合は、AY1セルに「3」と入力。 シート名にDを含む場合は、AY1セルに「4」と入力。 又、ファイルによっては「A」とゆう１シートのみの場合もあれば 「B」「C」の２シートや、 「A」「C-1」「C-2」など複数保有している場合もあります。 保有するシート全てに、上記内容のマクロを実行するにはどうすればよいでしょうか。
2つのブックシートがあります上段が入力シートになり Aセルにはアットランダムに1〜4の固定値が入力されます Ｂセルには日付、 CとGとＨには各々数値を入力します 下段がデータの反映シートになりますが号炉ごとにデータを振り分けるのと同じ日付、ここでは6月１日赤矢印になりますが 自動的に下段の該当する号炉に合計値を振り分けますにはどのように関数式？又はマクロコードをいれたらいいのでしょうか？ 日付ごとに管理したいのですが可能でしょうか？どなたかわかるかたいらしましたら是非ともご教授の程よろしくお願い致します
ﾕｰｻﾞｰﾌｫｰﾑ1のﾃｷｽﾄﾎﾞｯｸｽ1に日付を出力させる。 ﾃｷｽﾄﾎﾞｯｸｽ1をｸﾘｯｸしたら、####/##/##と出て #記号の上から数字入力できるようにしたいです。どのようにすればいいでしょうか。
下記のように特定のセルの結果を切り捨てにしますが、I列の最終行（可変）まで繰り返す 場合どのようにすればよろしいでしょうか。Range("I2").FormulaR1C1 = Application.RoundDown(Range("I2").Value, 1) ご教示ください。
こんにちわ‼︎ http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1316020568... については 本当にありがとうございました（≧∇≦） 実は、作成していただいたファイルを試し、完成したのですが、実際のファイルでトライ したところ、エラーは出ず作業は完了するのですが、ホントは８枚に分かれるはずなのに、なぜか５シートしかできませんでした。 考えられる、原因はお分かりになりますでしょうか？ （別ファイルで、３０シートになるはずのものも５シートで切れてしまいました。いただいたファイルでは、何千行にし実行したら、キレイに実行できました(´Д` )) 私のファイルの問題なのかもしれませんが、ご意見いただきたく質問させていただきました。 御面倒おかけしすいませんが、どうぞよろしくお願いします。
エクセルのマクロによる文字列操作について エクセルのマクロについてご教授お願いいたします。 マクロ初心者です。 A列からBU列までの情報管理ファイルです。 行は最後の行までの処理です。Sheet1のA列には数字が記載されています。 A列の数字が0以外の場合、その行のB列の文字(仮に"あ"とします。) B列が"あ"の行をすべて切り取り、Sheet2の2行目から貼り付けたいと考えています。（1行目は見出し入力済みの為) A列が0以外の行は複数あるので、最後の行まで検索し、完成を目標としてます。 検索は完全一致でしたいと思っております。 ・参考画像の場合 （転記対象の行を塗りつぶしています。) A2のセルが0以外の為、その行のB列(B2)の文字列である北海道の行すべてが転記対象となります。 （この場合2/3/10行目) 他に6行目の大阪がB列の行（6/9行目) 16行目の愛知(16行のみ) 7行目の神奈川 (7行目の神奈川と12行目の神奈川県は別という認識の為、12行目は転記対象ではありません。) わかりにくい文章で申し訳ございません。 上記の動作マクロの記述をご教授いただけますでしょうか。 処理の参考画像です。 ・処理前のSheet1 http://www.fastpic.jp/images.php?file=6727069569.jpg ・処理後のSheet1 http://www.fastpic.jp/images.php?file=4160386225.jpg ・処理後のSheet2 http://www.fastpic.jp/images.php?file=9861053990.jpg 何卒よろしくお願い申し上げます。
ASP.NETのウェブアプリケーションのGridViewについて質問です。 GridViewの列にテキストボックスの列とドロップダウンリストの列を配置したいです。 そしてユーザーにテキストボックスに日付を入力してもらい、ドロップダウンリストの内容を変えたいと思っています。ドロップダウンリストの内容は入力してもらった日付を条件にデータベースからデータを持って来たく思っています。 このようなことはGriedViewを使ってできますか？ 使えるイベントやコードの仕方などを教えていただけると幸いです。
現在Access VBAを勉強しています。 今度成果物を作成しなければならないのですが、 どのような物を作成すれば良いのか分かりません。 どのような物を作成すれば良いでしょうか？案を教えてください。 ちなみに、教材として 「Access VBA マクロ超入門講座 Access 2010/2007対応」 (技術評論社/結城圭介)を使用しており一冊全部終えていますので、 ある程度のことは解ります。 どうかよろしくお願いします。
Visual BasicやＰＨＰを使えると、インターネットエクスプローラーを自動操作できると聞いたのですが、これらの専門書を何冊かタイトルと目次をペラペラと見てみたのですが、インターネットエクスプローラーを自動操作するという項目は見つかりませんでした。こういった用途はメジャーな使い道ではないのでしょうか？ それとも入門書的なものを１冊一通り勉強すれば、応用して基本的なことはできるようになりますか？そもそもこれらの言語って、パソコンの何のソフトを主に自動操作できるのでしょうか？エクセルＶＢＡならエクセルなわけですが・・・ インターネットエクスプローラーの自動操作に関して、Visual BasicまたはＰＨＰを勉強するというのは、参考書などの充実度も含めて、妥当なのでしょうか？もっと良い言語がありますか？
閲覧ありがとうございます。 今は素人ですが将来プログラマーになりたいので、色々とお勉強中です。 最初にExcelでのVBAについて勉強したいのですが、何かおすすめの方法はありませんか？ またわかりやすい本なども教えてほしいです。
VBAでコピーを実行するとキャッシュに保存されている！？こちらで教えていただいた以下のプロシージャを使用しています。 Sub sample() Dim xFSO, xPath As String, xFld As String, xSub Set FSO = CreateObject("Scripting.FileSystemObject") xPath = ThisWorkbook.Path xFld = Dir(xPath, vbDirectory) Application.ScreenUpdating = False Worksheets("Sheet6").Copy With ActiveWorkbook For Each xSub In FSO.GetFolder(xPath).ParentFolder.SubFolders If xSub.Name <> xFld Then .SaveAs Filename:=xSub & "\" & "AAA" End If Next xSub .Close savechanges:=False End With Set FSO = Nothing Application.ScreenUpdating = False End Sub 試行している段階なのですが， このVBAを実行して生成されたフォルダにあるブックを消去して，またこのVBAを実行するとします。キャッシュまでは考慮していなかったのですが，どうもキャッシュに保存されてしまっているようで 「この場所に'○○￥○○￥○○￥cache￥AAA.xlsx'という名前のファイルが既にあります。置き換えますか？」という表示が出ます。 キャッシュに保存されてしまうのは，仕方のないことなのでしょうか？ 他のVBAでコピーを実行する場合には，試行してみると「この場所に'○○￥○○￥○○￥cache￥XXX.xlsx'という名前のファイルが既にあります。置き換えますか？」という表示が出ないので，キャッシュには保存されていないように思うのですが。 素人ゆえによく分かっていません。 どなたかご教示下さい。 よろしくお願いいたします。
VB.NETのリストボックスで質問があります。 右クリックのメニューを設けたのですが、気になるところが２つあります。・リストのデータがない下の余白の部分を右クリックしても、メニューが表示されてしまいます。これを表示させないようにする方法があれば教えてください。 ・右クリックすると表示されるメニューは、その左側の部分がグレーの四角になっているのですが、その部分を取り除く（つまりは文字の部分だけにする）ことはできるのでしょうか。方法があれば教えてください。
VBEにて、ワークシートをコピーしたいと思い、「できる Excel マクロ＆VBA」という本を読みながら勉強している初心者です。下記を入力した際、 「実行時エラー13 型が一致しません」 と表示されてしまいます。 どうしたらいいかわからず困っています。 アドバイスお願いします。 Sub 新規請求書追加() Dim フォームシート As Worksheet Dim 請求番号 As Integer Dim 請求書シート名 As String Set フォームシート = Worksheets("フォーム") 請求番号 = CInt(Worksheets(Worksheets.Count).Name) + 1 請求書シート名 = Format(請求番号, "0000") フォームシート.Copy after:=Worksheets(Worksheets.Count) ActiveSheet.Name = 請求書シート名 End Sub
初心者です。(VBAに関する質問) 以下のソースを実行させると、 コンパイルエラー：SubまたはFunctionが定義されていません というメッセージが表示されるのですが、何が原因か分かりません。原因を教えて下さい!! Private Sub CommandButton1_Click() その日の日付を保持する｡ Dim Today As Date Today = Date 'A3セルに値があるか調べる Dim BlnA3 As Boolean BlnA3 = ISBLANK(A3) '初めて日付ボタンをクリックした時の処理 If BlnA3 = True Then Cells(3, 1).Value = Format(Today, "mm月dd日") '日付ボタンを2回以上クリックした時の処理 'F列に値が入力されている最終行を取得して､最終行の次の行及び日付列に次の日の日付を入力する｡ Else Dim MaxRow As Integer Dim NextRow As Integer MaxRow = Range("F").End(xlDown).Row NextRow = MaxRow+ 1 Cells(NextRow, 1).Value = Format(Today, "mm月dd日") End Sub
vbaについて、質問です。 セルの中のある文字列から一部分を抜き出したい処理をしたいので、ご教授願います。例．2番目と3番目の"_"の文字列を抜き出す（表示する） aaaa_rehrte_kore_sert ↑"kore"の部分を表示させたいです。
excel マクロ電子化候補1 Sub Tenki() Dim DataSh As Worksheet, Matome As Worksheet, EndRow As Long Dim Hani As Range, rng As Range, i As Long, Retu As String Set DataSh = Worksheets(" データ ") Set Matome = Worksheets(" まとめ ") Set Hani = Matome.Range("A1:A" & Matome.Cells(Rows.Count, 1).End(xlUp).Row) EndRow = DataSh.Cells(Rows.Count, 1).End(xlUp).Row For Each rng In Hani With DataSh For i = 1 To EndRow If .Range("A" & i) = rng.Value Then Select Case .Range("A" & i).Offset(, 1).Value Case 1 '資料№ごとに張り付ける列を指定している（CASE 1 なら資料№が1の場合はAA列に貼り付ける） Retu = "AA" Case 2 Retu = "CB" Case 3 Retu = "EC" Case 31 Retu = "GD" Case 32 Retu = "IE" Case 33 Retu = "KF" Case 34 Retu = "MG" Case 35 Retu = "OH" Case 61 Retu = "QI" Case 62 Retu = "SJ" Case 63 Retu = "UK" Case 99 Retu = "WL" Case Else Exit For End Select .Range(.Range("CL" & i), .Range("EL" & i)).Copy Matome.Cells(rng.Row, Retu) 'データシートのCL～EL列をコピーしている End If Next i End With Next rng End Sub
webサイトでのエクセルの表示についての質問です。 やりたい事はだいたい以下の様な事です。 webサイトにテンプレートファイルを 置いてそのファイルを表示した状態で 開きたいのですがやり方が解りません。 解る方教えて下さい。 よろしくお願い致します。
お世話になっております。 EXCELの操作方法についてご質問がございます。固定長形式のファイルを作成することが目的で、 列幅をすべて1に設定しセルの結合でサイズを合わせ、 固定長形式のファイルを作成することができました。 (拡張子を.prn→.txt) ここでご質問です。 1行目にはヘッダーレコード 2行目以降にはデータレコード 最終行にはフッターレコード という形式になっていて、 データレコード部分の行数は都度変わります。 シート1に上記の形式(セルの結合で作った固定長の長さ) を作っておき、 シート2にデータレコード部分のデータを保存すれば、 シート1の固定幅にシート2のデータが反映するような、 ブックを作りたいのですが... 皆様のお力をお借りできないでしょうか？ 宜しくお願いします！
Visual C++ 2010 Expressはどこでダウンロードできますか？説明には http://www.microsoft.com/japan/msdn/vstudio/express/ ここで落とすように書いてありますがページがなくなっていてできません ネット検索で探すと https://www.visualstudio.com/ このサイトに飛んで何を落とせばいいかよくわからないです
選択範囲をCSVで出力するマクロを教えてください。 出力範囲のセルはA2:N73でセルには関数が入っていて 別タブからそれぞれ数字や文字を返しています。下記マクロを実行すると CSVファイルで保存できるものの、 シートに返してきている値を正しく反映しません。 さらに可能であれば保存先を最初から指定するマクロを追記したいです。 何度か試行錯誤してみたのですがお手上げのためどなたかご教授願います。 よろしくお願いします。 ========================================================== Sub CSV作成() Dim myRng As Range, myFileName As String Set myRng = Range("A2:N73") If myRng Is Nothing Then Exit Sub myFileName = Application.GetSaveAsFilename(FileFilter:="CSVファイル (*.csv,*.csv") If myFileName = "False" Then Exit Sub Application.ScreenUpdating = False With Worksheets.Add myRng.Copy .Cells(1, 1) .Move End With With ActiveWorkbook .SaveAs Filename:=myFileName, FileFormat:=xlCSV .Close False End With Application.ScreenUpdating = True Set myRng = Nothing End Sub
リストボックスの表示の方法リストボックスの値が 1 AA 2 BB 3 CC とあります。 リストボックスで選択した 値が入っているテーブルの値を 表示すると、 1とか2が表示されます。 AAとかBBを表示するには どうするのでしょうか？ よろしくお願いします。
Visual studio 2012で、相対パスによるファイル参照ができなくなってしまいました。プロジェクトを丸ごと別のディレクトリにコピーしてしまったのが原因だと思うのですが、相対パスの基準パスはどこで設定するのでしょうか？
pictureboxにbitmapを使用してグラフを表示させるアプリを作成しています。 visual studio 2015 C#です。グラフの表示は出来たので、拡大縮小とスクロールバーをつけてコントロール制御をする機能をつけたいです。それとX軸のところに目盛をつけて（今は何もつけてない）拡大縮小に対応して表示が変化するようにしたいです。 参考に出来るサンプルかサイトがあれば教えて欲しいです。よろしくお願いします。 ちなみにX軸の目盛は、ラベルを等間隔に貼り付けまくって、縮尺を変更する都度ラベルの表示を書き換えると言う具合でしょうか？一般的にはどう作りこむのかわかりません。 それと、X軸の目盛をクリックして編集できるようにしたいです。例えば時間を書き換えたらそこにジャンプして該当する箇所のグラフが表示されるというような感じ。 そういう物を作りたい場合は、やはりラベルを等間隔に貼り付けするという事になるのでしょうか？
下記のコードはシートの行から別シートのセルA1に入力した数字を探し（補正をかけ）、行2と行4の値をセルA2とB2にそれぞれ値を返します i = Range("C1").Value + 1Range("A2").Value = wb.Worksheets(1).Cells(2, i).Value Range("B2").Value = wb.Worksheets(1).Cells(4, i).Value 行を指定し、同じ動作をさせる場合どのよにして行うのかご教示お願いします Dim i As Integer Dim RName As String i = Range("C1").Value + 1 RName = wb.Worksheets(1).Range(1).Find("i").Select Range("A2").Value = wb.Worksheets(1).Cells(2, "RName").Value Range("B2").Value = wb.Worksheets(1).Cells(4, "RName").Value 自分で入力したコードでは RName = wb.Worksheets(1).Range(1).Find("i").Select で、アプリケーション・オブジェクト定義エラーが発生し原因が判りません。 恐らくコードの解釈の仕方が間違っていると考えられますが、ご教示していただけると幸いです
vb.net です。 以下のURLでの問合せにベストアンサーとして選ばせていただいた回答を見てやってみようかと思ったのですが、どうもどうやったらいいかわかりません。http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1015961100... 書いていただいたコードを新たなクラスを挿入してそこに入れたのですが、これをどのように使ったらいいのか見当が付きません。 まことに恥ずかしいお願いではありますが、全体的なコードをご教示いただきたくよろしくお願いします。 回答をいただいた時にやってみればよかったのに、今頃になって大変申し訳ございません。
ＶＢＡについてです。 "データ貼付シート"に画面を置いたまま、"管理リスト"シートと非表示にしてある "P1-2"シート "P3-4"シート・・・"P49-50"シート迄を印刷したいです。データ量は毎回変わる為"データ貼付シートのC列でデータ量が解ります。 データ量の分だけ印刷がしたいのです。 下記の様にしたらシート"P1-2"とシート"P3-4"だけ沢山印刷されてしまいました。 どこを修正したら良いかお力添えを頂けたらと思います。 宜しくお願い致します。 Sub Macro1() ' ' Macro1 Macro ' ' Keyboard Shortcut: Ctrl+Shift+Z ' For Cnt = 1 To 25 n = Cells(Rows.Count, "C").End(xlUp).Row Worksheets("データ貼付").Activate If MsgBox("リストとカードを印刷しますか？", vbQuestion + vbYesNo) = vbYes Then Worksheets("管理ﾘｽﾄ").PrintOut Worksheets("P1-2").Visible = False Application.ScreenUpdating = False Worksheets("P1-2").Visible = True Worksheets("P1-2").PrintOut Worksheets("P1-2").Visible = False Application.ScreenUpdating = False Worksheets("P3-4").Visible = True Worksheets("P3-4").PrintOut Worksheets("P3-4").Visible = False End If Next End Sub
office2010で写真を画像として貼り付ける方法を教えていただけないでしょうか？？現在、シートに貼り付けている写真だけを削除し他のオブジェクト（ボタンやオートシェイプ）はそのまま残すマクロを作っているのですが2007ではうまくいったのですが2010では判定がうまくいきません。 原因としては貼り付けた画像が2010ではリンクしている画像（11）になってしまうからだと考えます。 pictures.insertとaddpictureの両方を試したのですが、うまくいきませんでした。 もしわかる方がいましたら、ご教示の方よろしくお願いします。 以下が画像削除のコードとそれぞれの画像貼付のコードです。 ---------------------------------------------------------------------------------- For Each oShape In ActiveSheet.Shapes If oShape.Type = msoPicture Then oShape.Delete End If Next ---------------------------------------------------------------------------------- 貼り付けている画像のmsoShapeTypeがmsoPicture(13)かどうかで判定 をしています。 .Pictures.Insertの場合 -------------------------------------------------------------------------------------- Set objPhoto = objSH.Pictures.Insert(strFileName).ShapeRange -------------------------------------------------------------------------------------- AddPictureの場合 -------------------------------------------------------------------------------------- Set objPhoto2 = objSH.Shapes.AddPicture( _ Filename:=strFileName, _ linktofile:=False, _ savewithdocument:=True, _ Left:=objPhoto.Left, _ Top:=objPhoto.Top, _ Width:=objPhoto.Width, _ Height:=objPhoto.Height) --------------------------------------------------------------------------------------
ExcelのVBAについて教えて下さい！ VBAで、TRUEまたはFALSEをを返すあるセルがTRUEになるまで再計算を続けるというマクロを組みたいのですが、上手く行きません。Sub test() Do ActiveSheet.Calculate Loop Until Cells(1, 1) = "True" End Sub このコードの何がまずいでしょうか、またどうすれば希望のマクロが組めるでしょうか。 回答よろしくお願いします！
【WPFについて教えてください】 初歩的な質問でお恥ずかしいのですがWPFについて教えていただきたいことがあります。[作りたいもの] 3画面（A、B、C）を自由に遷移できるWPFアプリケーション。 ① 画面上部は3画面とも共通で時計と3つのボタン（a、b、c）を配置。 ② 画面下部は3画面それぞれ独自の表示内容。 押されたボタンに応じて画面を切り替える。 ↓ 以下のように作りたいと思っていますが、手こずっています。 画面上部が共通なため、①を配置したメイン画面を用意。 画面下部の表示内容をユーザーコントロールとして別途用意し、押されたボタンに応じて画面下部の表示を切り替える。 下手くそな説明で申し訳ありません。 お力を貸してください。
VBAの判定および集計についてご教示ください。添付ファイルのような作成されるExcelデータがあるのですが、B列で4000以上・未満の判別した後で、その判別に基づいたC列、D列、E列の合計を算出したいのですが、VBA初心者の私には複雑すぎてどうしてよいのか全く分かりません。 どなたか助けてください。 サンプル構文があると大変助かります。 宜しくお願いします。
既出既述されている内容で申し訳ありません。表のE列・R列を見て"小計"、と、"合計"という文字を見つけたらSum関数、SUMIF関数を入れるマクロですが、知識不足のため、小計・合計の変数とかループを使用して、簡単にする方法を教えてください。よろしくお願いします。 表はE３４とR34の列に小計がありますが位置は可変します。 E34列・・・H、I、J、K、L は５列小計と５列の合計 R34列・・・U、V、W、X、Y、 は５列小計と５列合計 Sub 小計合計No1() Dim r As Long, j As Long, sidx As Long, sidx1 As Long sidx = 34 For r = 2 To Cells(Rows.Count, 5).End(xlUp).Row If Cells(r, 5) = "小計" Then ’E列 Cells(r, 8).Formula = "=sum(H" & sidx & ":H" & r - 1 & ")" Cells(r, 9).Formula = "=sum(I" & sidx & ":I" & r - 1 & ")" Cells(r, 10).Formula = "=sum(J" & sidx & ":J" & r - 1 & ")" Cells(r, 11).Formula = "=sum(K" & sidx & ":K" & r - 1 & ")" Cells(r, 12).Formula = "=sum(L" & sidx & ":L" & r - 1 & ")" sidx = r + 1 End If Next If Cells(sidx, 5) = "合計" Then Cells(sidx, 8).Formula = "=SUMIF(E34:L" & sidx - 1 & ",""小計"",H34:H" & sidx - 1 & ")" End If sidx1 = 34 For r = 2 To Cells(Rows.Count, 18).End(xlUp).Row If Cells(r, 18) = "小計" Then ’R列 Cells(r, 21).Formula = "=sum(U" & sidx1 & ":U" & r - 1 & ")" Cells(r, 22).Formula = "=sum(V" & sidx1 & ":V" & r - 1 & ")" Cells(r, 23).Formula = "=sum(W" & sidx1 & ":W" & r - 1 & ")" Cells(r, 24).Formula = "=sum(X" & sidx1 & ":X" & r - 1 & ")" Cells(r, 25).Formula = "=sum(Y" & sidx1 & ":Y" & r - 1 & ")" sidx1 = r + 1 End If Next If Cells(sidx1, 18) = "合計" Then Cells(sidx1, 21).Formula = "=SUMIF(R34:Y" & sidx1 - 1 & ",""小計"",U34:U" & sidx1 - 1 & ")" End If End Sub
VBAで、Workbook_Deactivate と Workbook_WindowDeactivate の違いを初心者でもイメージで器ように教えていただきたいのですが・・・。よろしくお願いいたします。
vbaのチェックボックスについてシートに配置した複数のチェックボックスを択一条件で選択状態を取得したいです。 今の所、フォームコントロールを利用しています。 見た目がシートに馴染んでいるためです。 一度選択状態をセルに入れる設定からセルを読み取るようなダサいやり方しかおもいつかないです。 スマートなやり方はないのでしょうか？
エクセルVBAでアタッシュケースの復号化する方法を 教えてください。 画像にあります「tesuto.exe」をダブルクリックすると 「このファイルは暗号化されています。～」と入力画面が 出てきます。 これにパスワードを入力して復号化ボタンを押下するVBA コードが知りたいです。 いろいろと検索して探したのですが、これというものが 見つからなかったため、今回質問させていただきました。 できれば「tesuto.exe」をダブルクリックするところから 希望の保存場所へ保存できるコードを教えていただけますと 助かります。 わかる方がいらっしゃいましたら宜しくお願いします。
助けてください。 エクセル関数またはVBAでの質問です。 複数の文字列の中から、○印を付けた商品名だけ、カンマで区切って別のセルに横並びで表示したいのですが、どういうやり方があるのでしょう。商品名 購入 りんご ○ いちご バナナ ○ ぶどう ○ 購入する果物→りんご,バナナ,ぶどう こんな感じです。 どなたかよろしくお願いいたします。
マクロについて教えてください。 どこが間違えていますか sheet1に連続して入力された文字を別シートに入力していきたいと思います。 下の①の方法だとうまくいきませんでした。いろいろ考えて②にするとうまくいきました。 ①はどこが間違っているんですか 疑問１） For i = 1 To Worksheets(1).Range("A" & Rows.Count).End(xlUp).Row でiが1～最後のセルまで値が変わるので Worksheets(r).Range("C1").Value = Worksheets(1).Range("A" & i)で Range("A" & i)がA1,A2と変化するのではないのでしょうか？ For r = 2 To 5 では2から5まで数字が変わるのに For i = 1 To Worksheets(1).Range("A" & Rows.Count).End(xlUp).Row では数字は変わっていかないのでしょうか？ ① Sub d() For r = 2 To 5 For i = 1 To Worksheets(1).Range("A" & Rows.Count).End(xlUp).Row Worksheets(r).Range("C1").Value = Worksheets(1).Range("A" & i) Next i Next r End Sub ② Sub dd() i = 1 For r = 2 To 5 Worksheets(r).Range("c1").Value = Worksheets(1).Range("A" & i) i = i + 1 Next r End Sub
Excel VBAについてお教えください。下記のようなデータがsheet1にあるとします。A列,B列 1,Japan,○ 2,Japan, 3,America, 4,America, 5,France,○ 6,France, 7,France, 8,Italy, 欲しいデータ Japan,Japan France,France,France ○がB列にあったとします。○がついている国名で、次の行で同じ国名だと、その国名を変数に連結させたいと思っています。 最大行を取得して、ループでまわして何かをすれば解決できるとは思いますが、何をすればいいのかがわかりません。 どのように解決すればよいかお教え頂けませんでしょうか。よろしくお願いします。
vbaについての2点質問がございます。「一点目」 シート名【テストシート】 使う変数【left】＝A列に入れたい変数 ： 【right】=右隣のセルに入れたい変数 テストシートのA列の行を上から下に探していって最初の空白が来たらそこにleftを入れて さらにその右隣のセルにもrightを入れたいです。 「二点目」 未定回数繰り返しデータを入れます。A1(A列一行目)→A2→A3と読み込み もしA1が空白なら値を入れて 次の繰り返しでA1→A2とまた繰り返し、また空白が来たらA1に戻るという 繰り返し方法がございますか？ 空白がくるまで繰り返せばいいと思ったのですが、それだと一番初めのA1に入れるときは 必ず空白の状態なので、そもそも繰り返さないという事になります・・・ どなたかご教授頂けたら幸いです。よろしくお願い致します。
VBAにて 拡張子のないファイルを 「open A for input as #1」で開き 「line input」 で読込み→セルに出力する操作をしています。セルの出力内容をテキストエディタで確認すると、改行コードが含まれています。 (元のファイルに改行コードは含まれていません) 改行コードを含まないように出力する方法はありますか？
マクロについて教えてください。Ｂ列とＣ列の比較ですがうまくいきません。 どこが間違っていますか？ 同じ文字があるセルの横に○をつけたいと思ってます。 エラーが起こったり一文字しかできなかったりします。 変数の宣言は今回はのせていません。 Sub 文字の検索() For r = 1 To Worksheets(1).Range("a" & Rows.Count).End(xlUp).Row Set Rng = Worksheets(1).Range("b1:b5").Find(Worksheets(1).Range("c" & r).Value, lookat:=xlPart) If NotRng Is Nothing Then firstaddress = Rng.Address Do Rng.Offset(0, -1).Value = "○" Set Rng = Worksheets(1).Range("b1:b5").FindNext(Rng) Loop Until Rng.Address = firstaddress End If Next r End Sub
【ワードVBA】入力フォームに入力した複数文字列をセル内の複数の異なる文字列と置換する処理どのようにすれば、入力フォームで入力した文字列をセル内の特定の文字列を選択して置き換えることができるでしょうか。 ■入力フォームイメージ■ 【】はTextBox Label1 【a】 Label2 【ｂ】 Label3 【ｃ】 TextBoxに仕様ごとの特徴を記載。 ■置換したいWord文書イメージ■ ・縦と横に複数セルが並んでいる表 ・そのセルの１つの中に、○○はd秒、▲▲はe秒、■■はf秒と記載 ■やりたいこと■ ・セル内のd、e、fを入力フォームで打ち込んだa、b、cという文字列に置換したい ・入力フォームにVBAを記載します セルを選択して、その中身を丸ごと入力した内容に書き換えるところまではできています。 お力を貸してくださると幸いです。 能力の高い方、お力をおかし下さいm（_ _）ｍ
Excel VBA 初心者です。 教えて下さい。 C列に入力するとJ列に入力した時間が出ます。G行からAA行は1つ上の行をコピーして貼り付け行を埋める内容ですが、 C列よりも先にG列からAA列までに【変更箇所以外】を1つ上をコピーして貼り付けしたいのですが分かりません。 C8行に入力するとG８行に入力時間 G8行からAA9行は始まりなのでコピーしないようにしたいです。 Private Sub Worksheet_Change(ByVal Target As Range) Dim rng, r As Range Dim i As Integer, j As Integer If Intersect(Target, Range("C8:C47,F8:F47")) Is Nothing Then Exit Sub Application.EnableEvents = False If Target.Column = 3 Then Set rng = Intersect(Target, Range("C8:C47")) If rng Is Nothing Then Exit Sub For Each r In rng If r.Value <> "" Then If r.Row <> 8 And _ WorksheetFunction.CountA(Range("G" & r.Row & ":AA" & r.Row)) = 0 Then End If Range("G" & r.Row & ":AA" & r.Row).Value = Range("G" & r.Row - 1 & ":AA" & r.Row - 1).Value Range("J" & r.Row).Value = Format(Now(), "hh:mm") Else Range("J" & r.Row).ClearContents End If Next r j = 6 Else j = 3 End If For i = 8 To 47 If Cells(i, j).Value = "" Then Cells(i, j).Select Exit For End If Next i Application.EnableEvents = True End Sub
Excel VBAで写真のように1～順番に 番号を振りたいのですが、4の倍数で下の段にするコードはどのように書いたらよろしいでしょうか？ ご存知の方、お力添えのほどよろしくお願い致します。
Excel2013で可視セルのみに区切り位置を適用する方法を教えてください 氏名 住所性別 A 東京都男性 B 北海道女性 C 鹿児島県女性D 福岡県男性みたいに並んでるデータがあったとして、 "住所性別"を"住所"と"性別"に列を分けたいです 都道府県が3文字と4文字の場合に分けて 区切り位置を使うことまでは思いついたんですが ABDのような3文字の都道府県のみに フィルターをかけて区切り位置を使おうとすると 見えないセル(ここではC)にも適用されて 変なところで区切られてしまいます そこでフィルターされたセルに"Alt+;"で 可視セルを適用してみましたが、今度は 「複数の選択範囲に対して そのコマンドを使用することはできません 1つの範囲を選択し、もう一度実行してください」 とエラーを返されてしまいました 可視セルのみに一度に区切り位置を 実行する方法はないでしょうか?
vbs の定石みたいな記述 Option Explicit Dim x これは、書かなくても動きますが、 書かないと、どんな不都合が生じると 考えられますか？あるいは、単に、正式の形式がそうなっているだけで、 省略可、 省略しても何も変わらない、ということですか？
①エクセルvbaでセルに入力した値をディレクトリィに反映させフォルダを開く方法 フォルダ名が西暦と月で管理されています。201601・201602と月毎に名前が変わるので、セルA1に2016、B1に01or1と入力した場合に201601のフォルダを指定しフォルダを開く ②ブック名が不定期に一部が変更され複製が作られるので、固定名の部分でブックを指定し最新のブックを開く方法 フォルダ内で似たようなファイルが有る為「最新版」の部分を指定し、日付が新しいブックを開くようにしたい ・収集データ（最新版1）←残る ・収集データ（最新版2）←こちらを指定したい ・収集データ（検討1） ←似て異なるブック 上記2点をマクロで行いたいのですが、思うように行きません マクロに詳しい方、ご教示お願いします ・・・現在色々試してみてますが、起動できません PNama = "C:\Documents and Settings\MYPC\デスクトップ\" FName = Range("A1").Value & Range("B1").Value & "" ←A1B1参照 Workbooks.Open Filename:=Pname & FName
おはようございます。深夜から悩んでいることがあります。朝から本日の脳のエネルギーの消耗となるか糧となるかはご回答様次第ですが・・冗談はさておき・・・ １を２進数の100000000で割った場合＝何バイトになりますか？ よろしくお願いいたします。
Excel VBAで文字列の中に、特定の文字列がいくつ含まれてるかカウントするにはどうやればいいいですか？例えばこの質問の中に「文字列」という文字列が全部で４つとかです。
Visual Studio（VB）についての質問です。 文字の数に合わせてテキストボックスと文字の大きさを変えたいのですが、うまくいかず困っています。テキストボックスの文字が4文字のとき、テキストボックスの大きさを60x240にするとして、以下のように組んでみました。 Dim s As String =TextBox1.Text TextBox2.Text=s.Text Dim len As String = s.Length If s.Length = 4 Then TextBox2.Height=60 TextBox2.Width=240 しかし、これではエラーが出ます。他にも、 TextBox2.Location=New Size(60,240) TextBox2.Font=New Size(60,240) なども試しましたが、エラーが出ました。 文字の大きさは、テキストボックスの大きさと連動していると思ったので、プログラム中に触れはしませんでしたが、関係あるのでしょうか。。。 添削をよろしくお願いします。
C# でグラフ表示アプリを作成したいと思ています。visual studio 2015 community です。chartと言う部品がありますが、それを使用せずにpictureboxにbitmapを使用して折れ線グラフを作成したいです。 chartにグラフを表示させるのは現時点で出来ています。 やった事がない事なので、サンプルか参考サイトが欲しいです。 よろしくお願いします。
アクセスＶＢＡについて質問です。 アクセスで収集した画像や各種保証書等を管理しております。不要となったものについて、テーブル内のレコードと一緒にハイパーリンク先の画像ファイル（tiff）を削除したいと考えております。 レコードについては普通にクエリの組み合わせでマクロを組みました。 画像についてはハイパーリンクのリンクパスをテキスト化したテーブルにデータを集約させました。 同テーブル内には重複データは存在しません。 また、フィールドも画像パスという１フィールドのみです。 管理しているアクセスファイルと同じ階層に画像フォルダを作っておりますが、その中で画像種別に階層分けしております。 上述のマクロでリンクパスをテキスト化したテーブル（リンクパステキスト）を作成したあと、フォームのボタンのイベントで画像削除を一括で行う予定で、以下のコードを作成しました。 Private Sub トグル0_Click() Dim DB As DAO.Database Dim RS As DAO.Recordset Set DB = CurrentDb() Set RS = DB.OpenRecordset("リンクパステキスト", dbOpenDynaset) Do Until RS.EOF Kill (画像パス) RS.MoveNext Loop RS.Close: Set RS = Nothing cn.Close: Set cn = Nothing End Sub しかしながら、実行時エラー 13 型が一致しません。 というメッセージが出ます。 試行錯誤しているのですが、いつもこのメッセージで躓きます。 お分かりの方、理由を修正方法を御教授ください。 よろしくお願いいたします。
エクセルのマクロについて教えてください。 １．シート２にセルＢ７Ｃ７Ｄ７にデータを入れます。 ２．シート１にはＢ列Ｃ列Ｄ列にデータが入っています。 ３．シート２のＣ７と一致する、仮にシート１のＣａのＢａＤａのデータに、Ｂ７Ｄ ７のデータを 上書きする場合のマクロを教えていただけませんでしょうか？ 分かりにくい説明で恐縮ですが、どうぞ宜しくお願いします。
【Access2010 VBA】Access自体の閉じるボタン（×ボタン）押下時のアクションはありますか？ユーザーフォームではなく、Accessアプリケーション自体の閉じるボタン（×ボタン）を押下時の アクションをVBAでコントロールしたいのですが、どうすればよろしいでしょうか？ そもそも可能でしょうか？ 検索してみましたが、これというものも見つからず。 よろしくお願いします。
EXCELマクロ 列の自動非表示について 対象列の非表示をボタンクリック1つで自動で出来るようにしたいです。当方知識不足の為うまくいきませんでしたので、 ご教示頂ければと思い、質問致します。 添付「合計」行に入っている数値が”0”の場合、 その列を非表示にしたいです。（添付画像ではD列とG列） 尚、列や行は今後も増減があることがあります。 どなたかご教示頂ければ幸いです。よろしくお願い致します。
アクセス2013について質問です。①「検索」フォームの「フォーム画像ID」テキストボックスにＩＤを入力し、 ②「画像検索」クエリにて「画像パスリスト」テーブルと「フォーム画像ＩＤ」を紐付けして、 ③「画像パスリスト」テーブルに格納されている「画像フルパス」フィールドの値 C:\Users\334623\Pictures\121.Jpeg を上記 「検索」フォームの「画像ﾌﾙﾊﾟｽ」テキストボックスに表示されるようにしたいのですが、 「画像フルパス」テキストボックスに「＃Ｎａｍｅ？」表示が出て上手く行きません。 ・フォームプロパティのレコードソースは「画像検索」 ・「画像ﾌﾙﾊﾟｽ」テキストボックスのコントロールソースには「=[画像検索2]![画像フルパス]」 に設定しております。 最終的には「検索」フォームにて「画像フルパス」テキストボックスに表示された値を 同フォームのイメージコントロールの「ピクチャ」プロパティに代入して 画像を表示させたいと思っています。 どなたかお力をお貸し頂けませんでしょうか？
VBについて質問です。 テキストボックスに値がない場合はボタンを使用不可に、 値を記入したらボタンを使用可にする方法を教えてください。初めから記入されている、されていない場合はできるのですが、 記入した途端、ボタンが押せるようにしたいのです。 よろしくお願いします。
先日はお世話になりました。 下記コードについて困った事がおこりましたので、再度質問させて下さい。 自分で作成している表は問題なく動くのですが、accessをエクセルに変換した表だと動かないのです。エラー表示も出ません。 デバッグのステップインを使い自分の表と変換した表を比べたところ、変換した表は一番下から５行目と６行目を飛ばします。（黄色の線がつかない） 何が原因なのでしょうか・・・ Sub Sample() Dim st1 As Worksheet, st2 As Worksheet Dim r1 As Long, r2 As Long Dim c As Long Set st1 = Worksheets("Sheet1") Set st2 = Worksheets("Sheet2") 'Sheet2を一旦クリアする st2.Cells.Clear 'Sheet2の１行目を設定する For c = 1 To 16 With st2.Cells(1, c) .NumberFormatLocal = "h:mm;@" .Value = TimeSerial(5, 30, 0) + TimeSerial(0, 30, 0) * c End With Next 'Sheet1の最終行まで繰り返す For r1 = 2 To st1.Range("A" & st1.Rows.Count).End(xlUp).Row c = vbEmpty On Error Resume Next c = Application.WorksheetFunction.Match(st1.Range("G" & r1).Value, st2.Rows(1), 0) On Error GoTo 0 If c <> vbEmpty Then r2 = st2.Cells(st2.Rows.Count, c).End(xlUp).Row + 1 st2.Cells(r2, c).Value = st1.Range("C" & r1).Value End If Next r1 End Sub
コンボボックスに選択した後でも、複数表示が出来るＶＢＡ探しています マスタシート Ｎｏ 商品 何 ケース数 １ Ａ １ ３ コンボボックスに選択した後の状態Ａ １ ３ 入力をするシート("Sheet1") Ｎｏ 商品 何 ケース数 １ Ａ １ ３ ではよろしくお願いします。 補足要求を必要あったらせびして下さい ＶＢＡコード Sub ＣｏｍｂｏＢｏｘ1_Change() Dim st2 As Worksheet ListBox1.Clear Set st2 = Worksheets("マスターシート") With ComboBox .AddItem st2.Range("A" & r).Value .List(r - 2, 0) = st2.Range("B" & r).Value .List(r - 2, 1) = st2.Range("C" & r).Value .List(r - 2, 2) = st2.Range("Ｄ" & r).Value End With End Sub Private Sub CommandButton1_Click() 行 = ComboBox1.LitIndex Ｎｏ= ComboBox1.List(行, 0) 商品= ComboBox1.List(行, 1) 何 = ComboBox1.List(行, 2) ケース = ComboBox1.List(行, 3) With Worksheets("Sheet1") lastrow = .Cells(Rows.Count, 1).End(xlUp).Row + 1 .Cells(lastrow, 1).Value = Ｎｏ .Cells(lastrow, 2).Value = 商品 .Cells(lastrow, 3).Value = 何 .Cells(lastrow, 4).Value = ケース End Sub Private Sub UserForm_Initialize() Dim lRow As Long With Worksheets("マスターシート") lRow = .Cells(Rows.Count, 1).End(xlUp).Row End With With ComboBox1 .ColumnCount = 4 .ColumnWidths = "0:50;50;50" .RowSource = "マスターシート!A2:Ｄ" & lRow End With
このような表があります…① Ｂ列～Ｋ列位まで数字や文字等とびとびで入力されてます。 このＡ列には個人名が入っており、名前と名前の間は5行だったり10行だったり3行だったりとしています。また人数も増減します。 デスクトップ上にある(仮)新規フォルダには「A1234山田 太郎.xlsx」といったような エクセルファイルが100個ほど入ってます。これも数は増減します。…② また必ず①の中の名前のデータが(仮)新規フォルダにあるとは限らないです。 ①のAセルの名前で(仮)新規フォルダにあるファイルの中から該当するエクセルファイルを開きたいです。 作業としては、①のAの山田 太郎のファイルを検索してA1234山田 太郎.xlsxを開いて作業して閉じて、また次の加藤 ハナコのファイルを探してA1235加藤 ハナコ.xlsxを開いて作業して閉じてです。 作業部分はマクロで作成してあります。 ワイルドカードを使ってすでにネットにある情報でマクロ作ってもうまくいきません。 こういった動きは可能でしょうか？ お忙しいとは思いますがどうぞ教えていただけたら助かります。
以下のSQLをエクセルVBAで実行したところ 「指定されたフィールド’JANコード’がＳＱＬステートメントのＦＲＯＭ句にある複数のテーブルを参照しました」 というエラーが返されます。SQL = _ "Select " & _ "M.JANコード, T_kiroku.日付, T_kiroku.納品数, T_kiroku.販売数, T_kiroku.返品数, T_kiroku.ロス, Sum(納品数) As 納品合計, Sum(販売数) As 販売合計, Sum(返品数) As 返品合計, Sum(ロス) As ロス合計 " & _ "From " & _ "M_syouhin As M " & _ "Left Join " & _ "T_kiroku As T " & _ "On " & _ "M.JANコード = T.JANコード " & _ "Where " & _ "(JANコード = '" & Jan & "' ) " & _ "And " & _ "日付 >= #" & Format(Niti, "yyyy/mm/dd") & "# " & _ "And " & _ "日付 <= #" & Format(Niti2, "yyyy/mm/dd") & "# " & _ "Order By 日付 Asc " おそらく別名の付け方、もしくは使用の仕方が間違っていると思うのですがどう違うのかが判別できません。 どなたか解かる方がいらっしゃいましたら教えていただけないでしょうか？
VBAでのOutlookメール一括作成について 公開されているコードを元に下記のようにVBAからOutlookメールを一括で作成するコードを見よう見まねで作ってみました。ただ、あらかじめ指定されたテンプレートのみになっているため、複数のテンプレートから選択できるようにしたいのですがどのようにすればよいのでしょうか？ Enum 列 企業名 = 2 氏名 宛先 件名 添付ファイル End Enum Private Sub CommandButton1_Click() Dim ol As New Outlook.Application Dim m As MailItem Dim maxrow: maxrow = Range("b2").End(xlDown).Row For i = 3 To maxrow Set m = ol.CreateItemFromTemplate("C:\Users\AA\Desktop\Aフォルダ\test.oft") m.To = Cells(i, 列.宛先).Value m.Subject = Cells(i, 列.件名).Value m.Attachments.Add "C:\Users\AA\Desktop\Bフォルダ\" & Cells(i, 列.添付ファイル).Value m.HTMLBody = Replace(m.HTMLBody, "□□", Cells(i, 列.企業名).Value) m.HTMLBody = Replace(m.HTMLBody, "●●", Cells(i, 列.氏名).Value) m.SaveAs "C:\Users\AA\Desktop\Cフォルダ\" & Cells(i, 列.企業名).Value & "_" & Cells(i, 列.氏名).Value & ".msg" Next i End Sub 宜しくお願いします。
EXCELで、２つのファイル間でデータをコピぺしたいマクロに悩んでいます。 例えば、 FAIL1のsheet1のセル（A1:E**）の表があります。この表をFAIL2のsheet2の表にコピーする際、 A2→B2へ、B2→D2へ、C2→A2へ、D2→E2へ、E2→C2へ列を入れ替えてコピーする。 これを2行目から最後の行目まで繰り返し行い、終わります。 セルの書式は、文字列、数字、年月日、時間があります。 **は、表によって変化します。 実際には、50列くらいあって、マクロが長～くなって疲れてしまい、 修正も苦労しており、困っています。 ご教示お願いします。
ｺﾝﾎﾞﾎﾞｯｸｽの値を別ﾌﾞｯｸに出力したい。ﾌﾞｯｸAのﾕｰｻﾞｰﾌｫｰﾑ1のｺﾝﾎﾞﾎﾞｯｸｽ1に格納されている値を 別の保存先("C:\Users\\\)ﾌﾞｯｸBのｼｰﾄ1のB5に出力したい。 どのようにすればいいでしょうか。
Vb.netでexeファイル終了後も入力値を保持したい。 Vb.net初心者です。 一つの項目についてプログラム終了後に再度起動した 場合に前回の値を表示したいと思っています。 よろしくお願いします。
EXCEL／VBA と ACCESS／VBA の入門書を 同じ、出版社 を探しているのですが、Amazonで検索しても見つかりませんでした、誰かご存知の方いらっしゃいませんか?情報提供お願いします…
Visual Basicでアプリケーションを作成して、そのアプリケーションを使用する各ユーザ様のPCにインストール（CDにて）を行います。アプリケーションのシステム修正を行った場合、各PCのアプリケーションを起動した際にアプリケーションを自動更新を行って欲しいと（修正したアプリケーションを各PCに自動反映）ユーザ様から要望を頂いています。どのようにすればアプリケーションの自動更新を行う機能が実現できるかご教授下さい。参考のホームページ等の情報を頂ければ更に幸です。 宜しくお願いいたします。
Outlook2013で添付ファイルを指定したプリンタから自動で印刷する方法を教えていただきたいです。 添付ファイルの種類は.JPGを想定しています。ネットで調べて下のようなマクロを組んだのですが、 下から4～5行目の部分でエラーが出てしまいます。 Shell ("AcroRd32.exe /t " & SAVE_PATH & FILENAME & "Microsoft Print to PDF Microsoft Print to PDF PORTROMPT") の部分です。 どうすればうまく印刷できるようになりますか？ ご教授よろしくお願いいたします。 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー ' メール受信時に発生するイベント Private Sub Application_NewMailEx(ByVal EntryIDCollection As String) Dim i As Integer Dim c As Integer Dim colID As Variant ' If InStr(EntryIDCollection, ",") = 0 Then SaveAttachments EntryIDCollection Else colID = Split(EntryIDCollection, ",") For i = LBound(colID) To UBound(colID) SaveAttachments colID(i) Next End If End Sub ' ' 添付ファイルの保存を行うサブ プロシージャ Private Sub SaveAttachments(ByVal strEntryID As String) Const SAVE_PATH = "C:\attachments\" Dim objFSO As Object ' FileSystemObject Dim objMsg As Object Dim objAttach As Attachment Dim strFileName As String Dim c As Integer: c = 1 Set objFSO = CreateObject("Scripting.FileSystemObject") Set objMsg = Application.Session.GetItemFromID(strEntryID) ' ' ここで条件指定 ' For Each objAttach In objMsg.Attachments With objAttach strFileName = SAVE_PATH & objAttach.FILENAME While objFSO.FileExists(strFileName) strFileName = SAVE_PATH & Left(.FILENAME, InStrRev(.FILENAME, ".") - 1) _ & "-" & c & Mid(.FILENAME, InStrRev(.FILENAME, ".")) c = c + 1 Wend .SaveAsFile strFileName End With Next Set objMsg = Nothing Set objFSO = Nothing Dim FILENAME As String ' ファイル名の取得 FILENAME = Dir(SAVE_PATH & "*.jpg") Do While FILENAME <> "" Shell ("AcroRd32.exe /t " & SAVE_PATH & FILENAME & "Microsoft Print to PDF Microsoft Print to PDF PORTROMPT") FILENAME = Dir() Loop End Sub ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー
エクセル2007で複数のファイルの複数シートを一つのファイルに結合したく、下記コードで 結合はできたのですが、元データに挿入されている写真がすべて赤い×印と「リレーションシップIDｒＩｄ2のイメージパーツがファイルにありませんでした」と表示されます。 元データの中に拡張子が「.xls」のものも混じっていますが、このデータは（下記コードでは 結合できませんが）ちゃんと写真が表示されます。 「.xlsx」のものだけがダメなようです。 いろいろＷｅｂで検索して「ファイルが壊れているかも」などの回答は見つけたのですが、 どうもそうではないような気がするのですが、直し方がわかりません。 ご教授いただけると助かります。 Sub consolid() Application.ScreenUpdating = False '画面更新を一時停止 Set mb = ThisWorkbook myfdr = ThisWorkbook.Path fname = Dir(myfdr & "\*.xlsx") 'フォルダ内のExcelファイルを検索 Do Until fname = Empty '全て検索し終えると、fname = Empty となるので、その間以下を実行 If fname <> mb.Name Then 'ファイル名がこのファイルじゃなければ Set wb = Workbooks.Open(myfdr & "\" & fname) '選択したファイルを開く wb.Worksheets.Copy Before:=mb.Sheets(mb.Sheets.Count) 'コピーしてまとめ用ブック末尾に置く wb.Close '選択したファイルを閉じる n = n + 1 'ブック数をカウント End If fname = Dir '選択したフォルダ内の次のExcelファイルを検索します Loop '繰り返す Application.ScreenUpdating = True '画面更新一時停止を解除 MsgBox n & "件のブックをまとめましました。" End Sub
エクセルで自動で日付と曜日が入るようにしたいのですが、教えてください。１つのブックが１年分で１つのシートが２１日分の日程表を作っているのですが、各シートの日付が７日を１つの塊として移動していくようにしたいです。（5/26～6/15のシートの次のシートは6/2～6/22その次は6/9～6/29・・・）これからずっと使用できるように、開始日を決めたら全シート自動で日と曜日が入るとすごく助かるのです。。。 シート１には入力用の１年カレンダーを入れてるので、そこで開始日を設定したいなと思います。 よろしくお願い致します。
エクセルで、稼動日での経過日数と経過時間（リードタイム）を算出したいです。 WORKDAY関数を使用しようとおもいましたが、土曜が稼動日の時もあるので、、、。休日をSeet2 A列に全て入力しておくとして、どのようにすれば計算可能でしょうか？ データはSeet1にあります。結果もSheet1の Cに日数で表示、Dに時間で表示(単位：時間) させたいです。 例) 開始 2016/5/30 8:00 終了 2016/5/31 7:59 → 日数 2日、 時間 23:59 ※欲を言えば、一日を8：00～翌7：59で計算できると、より有難いです。 ・・・無理ならば、構いません。 例2) 開始 2016/5/30 8:00 終了 2016/5/31 7:59 → 日数 1日、 時間 23:59 計算元のデータの E列 開始日時 と M列 開始日・N列 開始時 は同じもので、日と時間が分解されているだけです。 F列 終了日時 と Ｏ列 終了日・Ｐ列 終了時 も同様です。 使い易い方を使って頂いて、構いません。 すみませんが、宜しくお願い致します。
VB で for文うぃお使ってラベルの変更をしたいのですが label1 ～ label10 があり 1つづつ、中の変数を別の変数に代入したいのですが for 1 = 1 to 10aaa = "label" & i & ".text" next i のようにループでの処理は出来ないでしょうか？
VBAのプログラムで困っています。Private Sub Worksheet_SelectionChange(ByVal Target As Range) For i = 1 To 10 For j = 1 To 10 x = 13 If Cells(i, x).Value = Date And Cells(j, x) = "ミカン" Then gogo = gogo & Cells(i, "A") & "," End If Next j Next i Range("A8") = gogo End Sub というコードを書くとA8に A列にある「愛媛」という文字が２回入ってしまいます。 どう改善すればいいでしょうか？
エクセル2013で右上の×ボタンを押して保存しないを選択すると visualBasicから メモリ不足ですとメッセージが出ることがあります。 保存する場合は問題ないので保存はできます。コードも黄色くなるところはありません。唯一、心当たりといえばユーザーフォームにテキストボックスを20個くらい追加してから、保存しないボタンを押すと10回に1回くらいのペースでメッセージが出ます。パソコンの容量は全然足りてます。解決するヒントを頂けたらありがたいです。
エクセルVBAで以下の動作を実現させたいのですがどのようにすれば良いでしょうか？・特定のセルからEnterまたはTabキーで移動する際に隣接したセルではなく挿入したCommandButtonをアクティブにする
ExcelVBAで全角半角が混ざっている状態で、規定のバイト数を超えた部分の文字列の末尾を抜き出したい ※バイト数で判断しなくても半角文字は2文字で全角文字1文字分と判断されていれば問題ありません テキストボックス1 を5文字(10バイト)制限にして、超えた部分に関してテキストボックス2に自動で抜き出して入力されるようにしたいと考えています。 テキストボックス1の中身をANSI形式にしてLenB関数でバイト数を調べて、10バイトを超えていたらその分のバイト数をRightB関数でテキストボックス1から抜き出すコードを書いてみたのですが、 抜き出す際に半角文字を2バイトとして扱ってしまっているようで上手くいきません。 やり方は全く違っていても構いませんので、ご助言頂けると幸いです。
マクロでどこが間違ってますか? A1の、値が5または55だったらb1を変えると言うことをしたいです。 Sub d() If Worksheets(1).Range("a1").Value = "5" Or "55&quot; Then Worksheets(1).Range("b1").Value = 3 End If End Sub
VBAについて質問です。下記のように指定フォルダに格納されているファイル名を特定セルに抽出するマクロを見よう見まねで作成したのですが、このマクロにA列の文字列を読み取って指定フォルダ内に格納されている同じ文字列が入っているファイル名を抽出するようにすることは可能でしょうか？ もしくは、新しいマクロがあれば教えてください。 Private Sub CommandButton2_Click() Dim i As Long, buf As String Const Path As String = "C:\Users\AA\Desktop\Aフォルダ\" buf = Dir(Path & "*.*") Do While buf <> "" i = i + 1 Cells(i + 1, 5) = buf buf = Dir() Loop End Sub
VBA入門者です。 参照画像のようなことをしたいです。 ある程度の列の情報まではそのままで、それ以降の列の情報を操作したいです。 条件 ①１列目（食べ物）～４列目（味は？）までの情報が１セットになっています。 実施したいこと ①１列目の食べ物の名前（たこやき、お好み焼き、コーラ）を２列目の”好き嫌い”のセルに代入させたい。 ②１列目、３列目、４列目の情報を削除したい。 ③何セットあるかは不明だが、全てのセットに同様の処理を行いたい。 ④最終的には２列目の情報と１列目の食べ物の名前だけの列を左詰めで表示させたい。 以上になります。 ご教授願います。よろしくお願いします。
VBAで文字列の操作について A列に20160609というような数列がありこれを2016/06/09の日付形式に変えたいです。 数列（日付）は複数あり変換文字列を指定しての置換はできないとします。VBA初心者なので一度B列に=CONCATENATE(LEFT(D1,4),"/",RIGHT(LEFT(D1,6),2),"/",RIGHT(D1,2)) の数式を置いて文字列としてA列に張り付けるというような、原始的なやり方しか浮かばないのですが、 これで特に困っているという話ではなく、方法として、VBA上で文字を取得し「/」を追加し元のセルに戻すするというような、ほかのセルを利用しないやり方はあるのでしょうか？ よろしくお願いします。
Excelでの時間の計算について 仕事で各個人の担当時間を集計したいと考えています。 シート１で各自の休憩時間を入力します。名前 日付 曜日 開始 終了 時間 内容 山田 １ 月 22:30 23:00 0:30 0 鈴木 １ 月 23:00 23:30 0:30 0 山本 ２ 火 1:00 2:00 1:00 0 山田 ２ 火 1:30 2:00 0:30 0 吉田 ２ 火 2:00 3:00 1:00 0 ・ ・ ・ シート２で各自の労働時間を入力します。 名前 日付 曜日 開始 終了 時間 内容 山田 １ 月 20:30 24:00 3:30 1 鈴木 １ 月 21:00 24:00 3:00 1 山本 ２ 火 0:00 4:00 4:00 1 山田 ２ 火 0:00 5:00 5:00 1 シート３では実際の勤務時間を出力くします。 この際少々複雑なのですが、下記のような出力です。 名前 日付 曜日 開始 終了 時間 内容 代替（代替のみこのシートで入力） 山田 １ 月 20:30 22:30 2:00 1 吉村 １ 月 22:30 23:00 0:30 2 吉村 山田 １ 月 23:00 24:00 3:30 1 鈴木 １ 月 21:00 23:00 3:00 1 吉田 １ 月 23:00 23:30 0:30 2 吉田 鈴木 １ 月 23:30 24:00 0:30 1 山本 ２ 火 0:00 1:00 1:00 1 吉村 ２ 火 1:00 2:00 1:00 2 吉村 山本 ２ 火 2:00 4:00 2:00 1 山田 ２ 火 0:00 1:30 1:30 1 山田 ２ 火 1:30 2:00 0:30 2 吉田 山田 ２ 火 2:00 5:00 3:00 1 勤務時間の下記と 山田 １ 月 20:30 24:00 3:30 1 休憩時間の下記を 山田 １ 月 22:30 23:00 0:30 0 下記のように時間で分解して、表示したいのです。 名前 日付 曜日 開始 終了 時間 内容 代替（代替のみこのシートで入力） 山田 １ 月 20:30 22:30 2:00 1 吉村 １ 月 22:30 23:00 0:30 2 吉村 山田 １ 月 23:00 24:00 3:30 1 休憩時間は別の人が担当するので、代替の入力を行います。 勤務時間は暦日で入力しますので、現時点では連続していても下記のような入力です。 山田 １ 月 20:30 24:00 3:30 1 山田 ２ 火 0:00 5:00 5:00 1 将来的には下記のような入力で、上記のように分解できたらと考えています。 山田 １ 月 20:30 5:00 8:30 1 （翌日にまたがることはありますが、それ以上はありません） 内容の部分はあまり気にしないでください。 仕事の内容を数字で表しています。今後3～使用しますが、これは労働時間を入力する際に入力します。 代替で仕事に着く人は必ず2で表記します。 休憩時間の0は、あまり意味がありません。 休憩時間に名前が入っている場合でも勤務時間がない人が発生しますので、無視します。 現在手入力で行っている作業で、簡略化したいのもありますが、ミスを少なくしたいと考えています。 単純な作業ですが、表計算させるとすると余りにも複雑で、Excelで可能な作業であるのかさえも分かりません。 私の技術は、関数を使用した表計算をかじった程度です。 記録で作成できる単純なマクロは使えますが、VBAをこれから勉強したいと思っているのですが、今のところちんぷんかんぷんで何も進んでいません。 何かきっかけになる情報を頂ければと考えています。 よろしくお願いします。
VBAで教えていただけたらと思います。Range("A3")に入っている文字を 違うワークブックの中の、違うシートのA列から探して、 Range("A3")の斜め下（”B4")の数字を、 選んだA列の隣（B列）に反映させたいです。 Do Untilを使うのだと思うのですが、 どのようなコードになるか、教えていただければ、助かります。 よろしくお願いいたします。
Excelでの並び替えについて質問です。 シート１で下記のように入力し、シート２に並び替えて出力したいです。名前 日付 曜日 開始 終了 時間 山田 １ 月 22:00 23:00 1:00 鈴木 １ 月 22:00 23:30 1:30 ――― 空欄 ――― 山本 ２ 火 1:00 3:00 2:00 山田 ２ 火 1:00 2:15 1:15 ――― 空欄 ――― 山田 ２ 火 2:30 3:30 1:00 鈴木 ２ 火 2:30 3:30 1:00 ・ ・ ・ ・ シート２に出力したいデータは下記のような並び替えです。 名前 □□□□□□□□□/ 名前 □□□□□□□□□/ 名前 日付 曜日 開始 終了 時間 / 日付 曜日 開始 終了 時間 / 日付・・・ 山田（シート２では固定）/鈴木□□□□□□□□□□/山本 １ 月 22:00 23:00 1:00 / １ 月 22:00 23:30 1:30 / ２ 火 1:00・・・ ２ 火 □1:00 □2:15 1:15 / ２ 火 □2:30 □3:30 1:00 /・ ２ 火 □2:30 □3:30 1:00 /・・・□□□□□□□□□/ ・ ・ ・ ・ ・ ・ ・ ・ ・ ・ (□は空白で実際には必要ありません) このような並び替えは可能でしょうか？ どうのような方法で行えば良いかご教授下さい。 知識としては関数を使用したデータ利用程度です。 VBAなどで可能かな？とも考えて、かじろうとしていますがまだまだちんぷんかんぷんな状況です。 よろしくお願いします。
エクセルのVBAについて質問です。 大量のデーターがsheet1に入っています。VBAで下記の作業を行っております。sheetを追加して500行毎に分割 分割したsheetをsheet毎にCSVで保存 ※追加されるsheet数はその時のデータ量により異なります。 ※追加されるsheet名は「果物1」「果物2」・・・「野菜1」「野菜2」・・・というように種類よって異なります。 CSV形式で保存した際に500行に満たないsheetの場合下記のようにブランク行に 「,,,」と入ってしまします。 A商店,りんご ,5月1日,10個 B商店,みかん,5月2日,5個 C商店,バナナ ,5月3日,12本 ,,, ,,, ,,, ここからが質問なのですが、作製したCSVを受注システムに取り込むのですが、 「,,,」が入っているとエラーが発生し取り込むことが出来ません。 CSVに保存する際にブランク行の「,,,」を削除して保存する方法はございませんでしょうか。 質問が分かりにくく申し訳ございませんが、よろしくお願い致します。
エクセルのマクロで質問です。 普段ずっと使っていたマクロが、今日突然エラーになりました。 マクロの内容は、上下のデータが異なる場合、１行挿入するというものです。主に、データをソート後に、重複したものを区切る目的で使用しています。 エラー箇所は「If Cells(i, 1) <> Cells(i - 1, 1) Then」だと出てくるのですが、これをどの様に書き換えれば良いかご教授下さい。 宜しくお願い致します。 ［マクロ全文はこれです］ Sub サンプル() Dim maxrow As Long Dim i As Long maxrow = Cells(Rows.Count, 1).End(xlUp).Row For i = maxrow To 2 Step -1 If Cells(i, 1) <> Cells(i - 1, 1) Then Rows(i).Insert End If Next i End Sub
エクセルのvbaでの質問です A1セルに時刻を入力しています（例えば８：００） このＡ１セルの時刻８：００より１０分経過以内であれば 次のマクロを開始したいのですがお願いします。Ｉｆで Ａ１＞ TimeValue("00:10:00") とかではしていますが。
IE操作マクロについて質問です。ソース <input type="text" name="outputParameter.headerLimitPrice" maxlength="11" size="13" value="71"ISTYLE="4" > 自分で作ったマクロ objIE.Document.all.outputParameter.headerLimitPrice.Value = kakaku 実行時エラー 438 オブジェクトは、このプロパティまたはメソッドをサポートしてません となってしまいます。 どこが悪いのでしょうか？
Excelのマクロ処理について B65=太郎さん 年齢22歳 B66=花子さん 年齢18歳 B67=二郎さん 年齢20歳 B68=梅子さん 年齢25歳 B69=松子さん 年齢26歳と入力されています。 "さん"からまえの名前と、年齢を抽出し B4～B13のセルに、 B4=花子 B5=18 B6=二郎 B7=20 B8=太郎 B9=22 B10=梅子 B11=25 B12=松子 B13=26 と年齢の低い順並べ替え値としてコピーし、さらにその処理をBからDDまで自動的に横向きで進めるにはどうすればよいでしょうか。 宜しくお願い致します。
A列の最終データが記録されている行の＋1行目をアクティブにするマクロができました。 Sub Macro1() n = Cells(Rows.Count, "A").End(xlUp).Row + 1 Range("A" & n).Select Rows(ActiveCell.Row).Select End Sub さらに、ここから300行目までをセレクトしたいのですが、どうすればよいですか。
excel マクロについてです。 一つのマクロで複数のシートで作業される時、マクロ実行中にページにジャンプしてるのが数秒間肉眼で見えます。かっこ悪いので、何か対策はあるでしょうか。 例えばマクロが完了するまで、「マクロ実行中」と書かれたシートのみを表示し、終了したらシート1をアクティブにするようなです。
VBAを使ったcsvの自動アップロードについて質問です。エクセル2013のVBAを使用して下記のコードを入力し、自動ログインまでは出来ました。 ログイン後、指定のフォルダにあるcsvファイルを自動で取込みたいのですが、コードがわかりません。。 ------------------------------------------------ Sub 自動ログイン() Dim objIE As Object Dim obj As Object Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True objIE.Navigate "https://test.aaaaaaa.com/" Do While objIE.ReadyState <> 4 Do While objIE.Busy = True Loop Loop 'IDとパスワードの入力 For Each obj In objIE.document.getElementsByTagName("input") If obj.ID = "username" Then obj.Value = "sdc@aaaaaaa.co.jp" End If If obj.ID = "password" Then obj.Value = "aaaaaaaaa" End If Next 'ログインボタンをクリック For Each obj In objIE.document.getElementsByTagName("input") If obj.ID = "Login" Then obj.Click End If Next 'CSV取込み Set objIE = Nothing End Sub ----------------------------------------------------------------------- 上記の『'CSV取込み』から先のコードが分かりません。。 サイトへログイン後、ホーム画面から『CSV取込』画面へタブを選択して移動→ファイル選択で 『参照』ボタンを押下→『C:\EDIDATA\RCV\シーワ\SW_0525.csv』このファイル名を開く→『取込』ボタンを押下→ログアウト どなたか上記処理のコードをご教授頂けないでしょうか？？
VBA勉強中です。ファイルをCSV変換して保存。 CSV変換したファイルをエクセルに取り込むと 元にしたファイルと同じかどうかを見る作業になります。 ①CSV変換するファイルを選ぶダイアログを出す ②ファイルをCSV変換して保存 ③CSV変換元のファイルにシートを追加して CSVを取り込む(文字列にて) ④元ファイルにシートを追加して CSV変換前と変換後を比較する。 変換前と変換後の値、 文字列が合っていれば○ あっていなければ×をシートに反映。 反映する場所は、比較するセルに反映。 例 ①シートと②シートの セルA1を比較した場合 ③シートのA1に○か×を反映 セルが空欄の場合は空欄のまま CSVの保存場所はファイルと同じ場所。 フォルダの中にはCSVファイルとシートが追加された元ファイルの２つが格納された状態をイメージしております。 上記の作業をコードを書いてボタン一つでやろうと奮起していましたが出来ずに終ってしまいました。 どなたかご教授ください。
マクロを含むエクセルファイルを開いたところ、セルの範囲選択が出来なくなりました。 一度別のシートを選択すると範囲選択出来るようになります。原因を探ったところ、どうやら、各シートにマクロを含んでいるので、ワークブックを開いた時に全てのシートに対して Private Sub Workbook_Open() Sheets("シート1").Protect UserInterfaceOnly:=True Sheets("シート2").Protect UserInterfaceOnly:=True End Sub というコードを入力していることが原因のようでした。 そこで、 ActiveSheet.Select というコードを付け加えることで解消することが出来ました。 他に良い方法があれば教えていただけないでしょうか。
ExcelVBAについて教えてください。 Web上で公開されているExcelブックを、直接開いてデータを取得する方法はありますか？https://------------/data/aaa.xls みたいなのを、直接開いて、データ取得して、閉じたいのですが… 因みに、ファイルは毎月50ファイルほど月別の別ページに追加されていき、三年分は集計する必要があるので、全部ダウンロードしておくのは困難極まります。 URLには規則性があるので、生成は自動で可能です。 よろしくお願いします。
マクロについて質問です。 以前こちらで質問させていただいて、以下のマクロを組んでいます。 Sub 転記() Dim cFile As String, pFile As String, sFile As String Dim eb As Workbook, twb As Workbook, r As Range, ws As Worksheet ChDrive (ThisWorkbook.Path) ChDir (ThisWorkbook.Path) cFile = Application.GetOpenFilename _ ("ExcelFiles(*. xlsm), *xlsm?", Title:="転記元", MultiSelect:=False) If cFile = "False" Then Exit Sub Set twb = Workbooks.Open(ThisWorkbook.Path & "\記録簿.xlsm") Set wb = Workbooks.Open(cFile, ReadOnly:=True) For Each ws In wb.Worksheets With twb.Worksheets(1) Set r = .Cells(.Rows.Count, "B").End(xlUp).Offset(1, 0) r.Offset(0, 0).Value = ws.Range("E14").Value r.Offset(0, 1).Value = ws.Range("L14").Value r.Offset(0, 2).Value = ws.Range("R13").Value r.Offset(0, 3).Value = ws.Range("R14").Value r.Offset(0, 4).Value = ws.Range("U14").Value r.Offset(0, 5).Value = ws.Range("E19").Value r.Offset(0, 7).Value = ws.Range("E21").Value r.Offset(0, 8).Value = ws.Range("E27").Value r.Offset(0, 9).Value = ws.Range("E20").Value End With Next ws On Error Resume Next sFile = Application.GetSaveAsFilename(InitialFileName:=" ", _ filefilter:="Excelファイル, *.xlsm, Excel 2010 ファイル, *xlsm") If sFile <> "False" Then twb.SaveAs Filename:=sFile, FileFormat:=xlWorkbookNomal End If wb.Close False: twb.Close False End Sub マクロを実行すると、最後の名前を付けて保存がうまくいかないのか、保存先の指定や保存ファイル名を入力して、保存というボタンは押せます。 その後特にエラーも起こらないのですが、 指定した保存先を確認すると、保存したはずのファイルがありません。 うまく保存されていないのでしょうか、、、？ 以前は問題なく使えていたのですが、久々に使おうとすると上記のような状態でした。 お知恵をお貸しください。 よろしくお願いします！
関数について質問になります 添付ファイルのようにsheet1に地域別の週売上があり、sheet2に合計表があるのですが、sheet1の１行目に数字の１が入っている曜日の合計を表示したいのです。常にこの１の曜日が変わります。（例では水～日にはいってますが、月、水、金となる場合もあります） sheet2のC3：C12にはどのような関数を入れれば対応できますでしょうか？ よろしくご教示願います。できるかどうかわかりませんが・・・
Excel VBAの初心者です。 データベースから検索値のデータを参照して閲覧し、 そのデータを指定の書式で印刷した上でデータベースに その発行履歴をつけるようにしたいと思っています。今ブックには、シート１（データの検索・閲覧）、シート２（印刷用シート）、 シート３（既存データベース）があります。 シート１の特定セルに検索値を入力すると、 シート３の該当データをvlookupで参照して閲覧することができるようにしています。 シート２は、シート１で検索したデータを更に参照して作成する指定の書式で、 単なる印刷用です。 シート１にボタンを用意して、 ボタンを押すと、シート２を印刷すると同時に、 シート３の特定のセルに発行した日の日付が入力されるように したいのですが、どのようにプログラミングすれば良いか 分からず行き詰りました…。 シート３は概ね以下のようなデータベースとなっており、 A B C D ・ ・ １ （検索値） （データ） （データ） （空欄） ２ （検索値） （データ） （データ） （空欄） ・ ・ シート１でA1セルの検索値を参照してボタンを押した時は、 このA1セルの検索値のある行のD１の空欄へ日付が入力されるように したいのです。 同様に、シート１でA2セルの検索値を参照してボタンを押した時は、 D2の空欄へ日付が入力されるという具合です。 入力するセルを特定するにはどうすればよいか分からず ずっと悩んでいます…。 ご教授よろしくお願いしますm(__)m
vb.netです。リストボックスで、マウスカーソルがリスト上にある時、そのリストの行のデータを反転表示または下線を引いて表示させたいと思っております。Ｗｅｂの記事と当方の少ない知識で、まずは次のように、行の末尾に"★"を表示するようにやってみたのですが、カーソルを当てるとチカチカしてしまうなど、全くダメでした。 Private Sub Form1_Load(ByVal sender As System.Object, _ ByVal e As System.EventArgs) Handles MyBase.Load Dim i As Integer For i = 0 To 9 ListBox1.Items.Add((i.ToString() + "番目")) Next i End Sub Private Sub ListBox1_MouseMove(ByVal sender As Object, ByVal e As MouseEventArgs) Handles ListBox1.MouseMove Dim i As Integer = ListBox1.IndexFromPoint(e.Location) If i = -1 Then Exit Sub Else ListBox1.Items.Clear() For c = 0 To 9 If c = i Then _ ListBox1.Items.Add((i.ToString() + "番目")) _ Else _ ListBox1.Items.Add((i.ToString() + "番目" & "★")) Next c End If End Sub 初歩的な質問で大変恥ずかしい限りですが、ご教示をよろしくお願いします。
ACCESS2007 を使っています。 下記の記述の間違いを教えてください。 荷札を梱包数量分印刷する目的で、"荷札発行"というレポートを作成し、下記の記述をしましたが1部しか印刷されません。梱包数量は荷札発行レポートの中にあります。 今はレポートを印刷プレビューで開き、梱包数量を確認して印刷・部数（梱包数量）入力をして印刷という手順を踏んでいます。マクロも考えましたが、マクロの実行は最大でも19回までなので、それ以上発行する場合があるためVBAにしました。 Private Sub ラベル55_Click() DoCmd.OpenReport "荷札発行", acViewPreview DoCmd.PrintOut acPrintAll, , , , 梱包数量 End Sub
A列B列に適当な数字が入っているとして B列の数字が赤になるとA列の数字も赤になる マクロを教えてもらえませんか？たとえばB３、B６、B17、B２０の数字が赤になると A３、A6、A17、A２０の数字も赤になるということです。 宜しくお願いいたします。
Visual Basic 2015 で質問です。 テキストボックスが空欄の時にボタンを使用不可にする方法を教えてください。
エクセルでここからここまでと、決めた範囲を自動で色付けしたいのですが。例えば、○から★までを色付けしたい場合に、 A1に○、E1に★と入力して、空白のセルも含めて A1、B1、C1、D1、E1のセル全てに色をつける方法 はあるでしょうか？ 更に言えば、セルの入力場所は固定できないので、あくまでも ○から★の間のみ色をつけるという条件です。
【Excelファイルをファイル名で保存の時、拡張子を消したい】ファイルを保存するときに、【ファイル名＋シート名】で保存したいのですが、下記を入力したところ、 Sub シート毎にファイルに保存() Application.FindFile 'ファイル選択 PA = ThisWorkbook.Path For i = 1 To Worksheets.Count Worksheets(i).Select FileName:=PA & "\" & ThisWorkbook.Name & Worksheets(i).Name & ".xls" ↓ ファイル名.xlsxシート名 と、拡張子の名前が出てしまいます。 （自身のPC表示設定では、拡張子は非表示なので出ないものと思っておりました） どのように変更したら、拡張子は消えますでしょうか？よろしくお願いしますm(__)m
VBA初心者です。よろしくお願いします。 先日した質問 説明が足りなかったので再度質問し直します。 図の左表を右表のように別シートに集計をしたいのです。同じ伝票番号に項目が何個あるかはランダムです。 どなたか力をお貸しくださいませんか。 よろしくお願いします。
InputBoxで人数を入力する、人数分の点数をセルに入力するマクロを作成。 点数もInputBoxを用いて入力する。ただし、入力された点数が０～１５０点の間にない場合、－５を代入する。点数はアクティブセルから縦（上から下）に代入する。 これを教えてください
エクセルのマクロによる行削除操作について エクセルのマクロについてご教授お願いいたします。 office 2013使用 マクロ初心者です。 行は最後の行までの処理です。A列⇒注文番号 B列⇒注文番号に対する枝番 C列⇒商品名 D列・E列⇒条件列 という下記の処理前画像のようなエクセルファイルがあります。 この中から小口配送できるもの以外の行を削除したいと考えております。 小口配送の条件は ・条件１ D列orE列に小口の文字列が含まれる ・条件２ A列の注文番号が同じ行がある場合、その行のD列orE列にも小口の文字列が含まれる。 以上となっております。 D列orE列に小口の文字列が含まれていないセルの削除という処理は調べて分かったのですが、画像データの場合、注文番号102のケース(5-7行目)のデータが7行目だけ削除されてしまい困っております。 つきましては下記のような動作をするマクロの記述をご教授いただけますでしょうか。 ①D列orE列に"小口"の文字が含まれない行を検索する。 ②その行のA列の文字列を取得する。 ➂A列をその文字列で検索し、当てはまる行を削除する。 画像の場合 ①7～10行目が該当 ②102,103,104が該当 ➂5～10行目が該当するので、削除 よって処理後画像の状態になることを目的としております。 わかりにくい文章で申し訳ございません。 何卒よろしくお願い申し上げます。 エクセル画像です。 処理前 http://www.fastpic.jp/images.php?file=1180067676.jpg 処理後 http://www.fastpic.jp/images.php?file=5947020749.jpg
VBA初心者です。よろしくお願いします。 図の左表を右表のように別シートに集計をしたいのです。 ＶＢＡ初心者なもので、上手くいきません･･･。どなたか力をお貸しくださいませんか。よろしくお願いします。
52行ごとに区切るマクロがあり、アレンジをしようと思い、下記内容を、「マクロ実行用ファイル」に、”ボタン”を作り、このファイル内で実行させたいと思い（分割させたいシートはこのファイルに移動済） シート名の日付が変わるため”Sheet("プリンタ-*").Select”と書いたのですが、エラー になります。 【コンパイルエラー：”Sub,Functionが定義されていません。”と出ます】 御面倒おかけしますがよろしくお願いします。 Sub シート分割() Dim ws As Worksheet Dim rng As Range Dim sEnd As Long Dim frng As Range Dim s As Long Set ws = ActiveSheet ’●ここをアクティブではなくシートを選択させるようにしたいです● For n = 1 To Range("A1").End(xlDown).Row Step 52 '52行ごと区切る Sheets("プリンタ-*").Select '元シートを選択 '●シート名 ”プリンタ-日付”● ←今回変更箇所 Application.Goto Reference:="R" & n & ":R" & n + 51 Selection.Copy 'コピー Sheets.Add 'シートを追加 ActiveSheet.Paste '貼り付け ActiveSheet.Name = Left(ActiveSheet.Range("C2").Value, 31) 'セルC2（日付）をシート名にする Next n Application.CutCopyMode = False 'コピーの解除 Worksheets("プリンタ-*").Delete ’元シートを削除 End Sub
ＶＢＡがうまく動きません Sub ボタン1_Click() Dim varFile As VariantActiveSheet.Outline.ShowLevels rowlevels:=2 varFile = Application.GetSaveAsFilename(InitialFileName:=Range("a2") & Range("h2") & "月" & ".csv", _ FileFilter:="CSVファイル(*.csv),*.csv", _ FilterIndex:=1, _ Title:="保存ファイルの指定") ActiveSheet.Copy ActiveWorkbook.SaveAs Filename:=varFile, FileFormat:=xlCSV, _ CreateBackup:=False, Local:=True Rows(Range("J" & Rows.Count).End(xlUp).Row + 1 & ":" & 206).ClearContents MsgBox ("CSV出力しました。" & vbLf & vbLf & varFile) End Sub 上記のＶＢＡでできるＣＳＶファイルのＪ列で数字の入っている下の行、以下すべて削除したいのですがうまく動きません。ご教授願います。
エクセル 2013 マクロについて 連絡書の配布先を変更しながら印刷していきたいです。 下記のコードはマクロの記録そのままです。 これをまとめるにはどうすればよいでしょうか。配布先の名簿はI10～I32まで入っており、貼り付け先は同シート内のB7です。 Sub 印刷() Range("I10").Select Selection.Copy Range("B7").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _ IgnorePrintAreas:=False Range("I11").Select Application.CutCopyMode = False Selection.Copy Range("B7").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _ IgnorePrintAreas:=False ・ ・ ・ ・ ・ End Sub どなたか分かる方よろしくお願いします。
プログラムの設計に関して 独学でプログラムを勉強し、社内ツールを作っており、 専業のプログラマではないので基本的な質問ですがご容赦ください。 VBでプログラムを開発しています。当初は 1回限りのプログラムだから早くできるツールを と言われ 特にFunctionやClassなどにせずにだらだらとコードを書いたのですが、 後から機能の追加や機能の変更などが重なり、 現在よく使う機能はファンクションなどにしています。 VBに限らず言えることだと思いますが、 当初から機能別のプログラムを組んでおけばよかったと思いますが、 プログラムを設計する場合、1機能づつClass化することが普通でしょうか？ どのような基準でFunctionやClassにするのか、手本や基準などはあるのでしょうか？ また、それらが学べる教科書やサイトなどはありますでしょうか
excel VBAを使い、別excelファイルからメインのexcelファイルにコピーをしたいのですが...例えば、B.xlsmのSheet1のA列とB列を、A.xlsmのSheet2のC列とD列にコピーするとしたら、 VBAにどのような記述をしたら良いでしょうか...? お時間に余裕がございましたらご教授いただけると幸いです。 よろしくお願いいたします。
エクセルのユーザーフォームについての質問です。データをsheet1に入力していますが、新規入力、データ修正と削除についてユーザーフォームを作成して検索機能と前記の方法でデータ管理をしたいと思い挑戦しています。データは数字や文字が混在したA列からＪの列の１０項目でA列の4行目を1として連番（約5,000行）で管理しています。 ユーザーフォームにTextBoxを11個配置し、そのうちの１つ（例えばTextBox1）に連番を入力し検索させて、残りの１０個に各項目を表示させ修正、削除を可能にしたいと考えています。また、連番で管理しているため、新規の場合はsheet2に同様の項目で入力し、修正、削除ができればと思っています。 また、sheet1のデータ削除についてはsheet1からは削除して、削除したデータはsheet3に移動させたいと考えています。 同様の考え方などで質問も多くされており、その回答などを参考にしてユーザーフォームを作成しましたが、ＶＢＡについて初心者のためネットで探しては試している状況で、もう目が痛くなってきました。 やっと探した回答で検索部分を作成しましたが、どうしてもうまく動きません。 初心者のうえ、要を得ない説明で申し訳ありませんが、ユーザーフォームについてどなたかご教授していただけないでしょうか。 よろしくお願いします。
エクセルにおいて複数条件を指定した時のフィルター機能について教えてください。 大量のデータが詰まったシートにおいて以下の条件のものをフィルターによって非表示にしたいと考えています。①Ｂ列に文字列「ＡＡＡ」が含まれていて、かつ、Ｄ列に文字列「1-100」と記載がある行を非表示にする ②Ｅ列もしくはＦ列のどちらかに「○」のチェックが入っていて、かつ、Ｇ列とＨ列それぞれの数値が相違している行を非表示にする マクロを実行するだけで①と②が非表示になるように制御したいと考えています。 初心者なのでソースを書くことにも悪戦苦闘しております。 ぜひご教授ください。
bat処理、vbs処理に関しての質問です。 現在zipファイルを解凍するvbsを作成し動作確認まで行えたのですが、パスワード付きのzipファイルの解凍方法が分からず苦戦しています。現在下記のような記述をしているのですが、パスワードを引数として渡せるのか、またvbsでは行えないのかわからないので教えて頂ければと思います。 Option Explicit Dim ZipFile, ExtractTo, fso, objShell, FilesInZip, objFolder Dim pass pass = C 'ZIPファイル ZipFile = Cxxx.zip '解凍先 ExtractTo = CUsers '解凍先のフォルダが無い場合は作成する Set fso = CreateObject(Scripting.FileSystemObject) If Not fso.FolderExists(ExtractTo) Then fso.CreateFolder(ExtractTo) End If 'ZIPファイルを解凍して、全てのファイルを解凍先フォルダにコピーする。 Set objShell = CreateObject(Shell.Application) Set FilesInZip = objShell.NameSpace(ZipFile).items Set objFolder = objShell.NameSpace(ExtractTo) If (Not objFolder Is Nothing) Then objFolder.CopyHere FilesInZip, FOF_NOCONFIRMATION + FOF_SILENT End If 'オブジェクトの破棄 Set fso = Nothing Set objFolder = Nothing Set FilesInZip = Nothing Set objShell = Nothing
Visual Basic の勉強をしたいのですが、お勧めの本はありますでしょうか？大学の授業で軽く学びましたが、資料はプリント配布だったためきちんとした書籍を購入して勉強したいと思い、質問しました。 よろしくお願いいたします。
Excel（VBA)で経費精算のツール作成を行っております。 マクロ初心者のため、作成に非常に困っております。 要求等多いですが、お力添えいただければと思います。（長文になりすみません） （目的） 社内で社員全員から交通費精算書と経費精算書のExcelファイルを一つのフォルダに入れて、マクロのボタンを押すことで、それぞれ、交通費のシートに転記・経費のシートに転記する仕組みを作りたいと考えております。また、社員番号と社員の氏名だけは別のシートに作ったマスタから抽出するような仕組みを作りたいと考えております。 （現状できたところ） ネットの情報などをコピーしながらメイン画面から、【交通費のボタン】【経費のボタン】を押すことでそれぞれシートに転記することができました。（作成マクロは添付します） （課題・行いたいこと） ・シート名やブック名などをパスで指定しているため社員の方がいじったり、間違えた場合エラーが表示されてしまう。 ・ブック内にsampleのデータが入ってしまうと集計結果に支障を出してしまう ・それぞれボタンを押さないといけない。（できれば一つにまとめたい） ・交通費のシートと経費のシートにわけないとその後の動作が順調にいかない状況が生じる。 →一つのマクロのボタンでシート名やブック名に左右されず、集計できるようににし交通費は交通費のシートに記入・経費は経費のシートに記入するようにしたいです。また、社員番号・氏名は現在作成マクロからとってくるようにようにしたいです。 また、シート内にsampleと書かれたシートがある場合は転記から除外するなどの条件も付けられたら尚嬉しく思います。 可能であれば、マクロが上記の要求を満たした動きをする、 変更した文を教えていただければと思います。 ご要望が多いのは重々承知です、よろしくお願いいたします。 アドバイスがいただきやすいよう、 マクロの構文が作りやすいように現状の構文を画像で載せたいと思います。 見にくい部分もあるかと思いますが何卒、よろしくお願いいたします。 ＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿ 【現状のマクロの文】 ＊交通費の精算書のマクロを画像で添付させていただきました。 経費はすみません。スペースの関係で貼ることができませんでした。 マクロのフォーマット自体は経費の精算書も交通費同様なので、 異なる点を【画像に記入した番号ごと】に記載したいと思います。 ①集計シートを表示する ”TE集計表”→経費の場合は”GE集計表”です。 （②以降もすべてTE集計表がGE集計表になります。） ②一行目にタイトル記入が下記になります。 '1行目にタイトルを記入.Cells(1, 1) = "社員コード" .Cells(1, 2) = "氏名" .Cells(1, 3) = "日付" .Cells(1, 4) = "目的" .Cells(1, 5) = "補助科目" .Cells(1, 6) = "部門" .Cells(1, 7) = "総計" .Cells(1, 8) = "詳細" .Cells(1, 9) = "受領" ③は交通費と同様です。 ④データ転記が下記のように変更です。 Dim salessheet As Worksheet Dim 基準行 As Long 日付 As Date Dim 目的 As String Dim 補助科目 As String Dim 部門 As String Dim 総計 As String Dim 詳細 As String Dim 受領 As String ・データシートから値を取得も下記のように変更です。 日付 = datasheet.Cells(i, 1) 目的 = datasheet.Cells(i, 2) 補助科目 = datasheet.Cells(i, 4) 部門 = datasheet.Cells(i, 5) 総計 = datasheet.Cells(i, 6) 詳細 = datasheet.Cells(i, 7) 受領 = datasheet.Cells(i, 8) ⑤値を転記は下記のように変更です。 salessheet.Cells(基準行 + i - 8, 1) = 社員コード salessheet.Cells(基準行 + i - 8, 2) = 氏名 salessheet.Cells(基準行 + i - 8, 3) = 日付 salessheet.Cells(基準行 + i - 8, 4) = 目的 salessheet.Cells(基準行 + i - 8, 5) = 補助科目 salessheet.Cells(基準行 + i - 8, 6) = 部門 salessheet.Cells(基準行 + i - 8, 7) = 総計 salessheet.Cells(基準行 + i - 8, 8) = 詳細 salessheet.Cells(基準行 + i - 8, 9) = 受領 何卒、ご教授よろしくお願いいたします。
Excelで以下のようなことを、簡単にする方法があるか知りたいです。 ①10×10のマスの中でランダムに色付けされたセルがある。 ②色付けされた数は、任意に決定する。③黒色に塗られたセルにおいて、左橋から右端まで繋がっているかどうか、Excelに判断させる。斜めもありとする。 非常に難しいことかと思いますが、どなたかご知恵がありましたらよろしくお願いいたします。
エクセルのVBAで以下のようなことは出来ますか？ 出来る場合、どのようにプログラムを組めば良いでしょうか？【前提条件】 ①以下の作業は全てエクセルで行う。 ②1つの管理ファイルで業務の進捗を確認する。 ②進捗は指定データファイルの有無で判断する。 （ディレクトリは管理ファイルとは別とする） ③指定データファイルがある場合、管理ファイルのセルの色を変える。 （セルはA1とし、色は白→黄色とする） ④データファイルには特定のセルに確認欄を設け、確認欄に「〇」があれば、セルの色を変える。 （色は白or 黄色→青とする） ⑤指定した時間（例えば8:00~9:00）にデータファイルが存在しなければ、セルの色を変える。 （色は白→赤とする） ⑥管理ファイルには「更新ボタン」を設け、人がボタンをクリックすることによって、 データが更新されるものとする。
今時VB学ぶ人ってなに目的な人なの？
シミュレーションをマクロで実行したいです。 現在全て手動で行っております。 詳細は添付画像にて。 F列の製品在庫が50を切るタイミングの平日に生産依頼をかけております。G列の出荷は見込み数で変動しますが先1年まで見込み数を入力しております。 N列は製品を作る資材の委託先の在庫。P列・R列は弊社の工場在庫になっております。 シミュレーション画像の下がマクロのイメージになります。 ここからがご質問です。 ①F列の値が50を切る日付(土日以外)でD列に数値が入力される。(自分で数値を事前に入力) ②N列の資材がマイナスになる45日前のM列に数値が入力される。(自分で数値を事前に入力) ③R列の資材がマイナスになる3日前のQ列に数値が入力される。(自分で数値を事前に入力) ④P列の数値がマイナスになる3日前にO列に数値が入力される。(自分で数値を事前に入力) ⑤A列の指定した日付以降から半年(180日)先まで①～④のシミュレーションをマクロで、 これらを実行出来るマクロを作って頂けないでしょうか・・・。 お手数お掛け致しますが 何卒宜しくお願い申し上げます。
エクセルにて表を参照して２つが正しいかチェックするマクロ 画像の通り、 右側に正しい組み合わせの表があり、 任意のセルを選択してマクロボタンを押すと正しくない組み合わせが赤くなるマクロを教えてください。 ご教授のほどよろしくお願いします。 ちなみに画像ではA列とB列に並んでいますが 実際は色んなセル(列)にあります。
ガルパン劇場版のBDに付いていたシリアルコードを使ってケータイでみようと思い、そのシリアルコードが書かれた紙の通りにVANDAI VISUAL CLUBの会員登録をしました。そして「DISK PLUSアプリをインストールして映像をダウンロード」と紙に書かれていたのでアプリをインストールしたのですが映像をダウンロードするにはログインしないといけないみたいで、ログインするにはEメールアドレスとパスワードが必要なのですがEメールなんて設定してないのですが どうしたらいいのでしょうか 説明が下手で申し訳ないのですが回答よろしくお願いします
Excel VBAからワードヘッダの操作について Excel VBAのコマンドボタンを押して、ワードヘッダにあるオートシェイプの文字列を指定したものに変換するというものを作っています。＊ワードヘッダに直接入れずに、あえてオートシシェイプを入れて文字列操作しているのには、理由があるので、そこは勘弁してください。 しかし、どうしてもうまくいきません。どうすればこのヘッダー内のオートシシェイプにある文字列を操作できますか。 Private sub Button_click() Dim wd as word.document On Error Resume Next Set wd = GetObject(ThisWorkbook.path & "指定ワードファイル.docm")’ワードファイルを指定（開いている前提） ’以下、自分なりに作ってみたコードですが、エラーが出てうまくいきません。 ’イメージは、開いたワードファイル＞ヘッダ＞オートシェイプ”世帯主" の文字を「指定した言葉」に変更。 wd.Sections(1).Headers.Item.Shapes.Range(Array("世帯主")).TextFrame.TextRange.Text = "指定した言葉" end sub
meta propertyのcontent内容をVBAで取得する方法をお教えください。 取得したいのは以下のHTML内のkeyword部分です。<meta property="example" content="keyword" /> 以下のホームページを参考として以下の通りのVBAを作成しましたが、うまくいきません。 http://www.vba-ie.net/element/meta.html Sub GoToURL_Click() Dim objIE As InternetExplorer Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True objIE.navigate Cells(1, 1).Value Do While objIE.Busy = True Or objIE.readyState <> 4 DoEvents Loop Cells(1, 1) = objIE.document.getElementsByName("example")(0).Content Do While objIE.Busy = True Or objIE.readyState <> 4 DoEvents Loop End Sub どうぞよろしくお願いいたします。
excelのマクロで、階層形式で並んでいる項目に対し、 連番を振っていきたいのですがマクロを作れる方がいらっしゃればお願いします。 添付の画像がイメージとなります。B~E列を判断し、A列に番号を割り当てる。 目的としては、数字で階層が判断できることです。 どうぞ、よろしくお願いいたします。
コンピューターにmsvcp140.dllがないため…さい。 というエラーが発生しx264guiExをインストールできません。一応少し調べ、 https://www.microsoft.com/ja-JP/download/details.aspx?id=48145 Visual C++ 再頒布可能パッケージも入れました。しかし何も変わりません。 どうにか改善できないでしょうか。。
ある売上レコードの金額の計算方法が単価(取引先により違う)×個数=金額 となる場合(単純にしてますが個数により割引などがありもう少し計算が入ります)、 AccessでやらずにEXCELで入力と計算をして、 Accessに転記するほうがいいですか？ Accessでも再計算しないようにしていれば重さに違いはありませんか？ そもそもAccessではこのような計算してだす金額はレコードとして保持せず、 使用するたびに計算するのでしょうか？
エクセルのセルの中のデータを、マクロを使って分割したいのですがわかりません。 下記のマクロで1行目は分割できるのですが、これと同じ事を下に向かって続けていきたいです。その場合はどうすればいいのでしょうか？ Sub Macro() Dim AllDate As Variant Dim i As Integer AllData = Split(Cells(1, 1).Value, " ") For i = 0 To UBound(AllData) Cells(1, i + 2).Value = AllData(i) Next End Sub データはA行に格納されています。データの長さは一定ではありません。 列の長さも日によって違います。 このマクロはネットで見つけたものです。マクロの仕組み自体がまだまだ理解しきれていません。 どうぞよろしくお願いします。
エクセル（ｅｘｃｅｌ）のリストボックスについて 「データ」－「入力規則」からリストをつくって、 セルに特定の文字しかいれられないようにすることはできますが、リストで選択した文字を削除されな いようにすることも可能でしょうか？ できればマクロやＶＢＡを使用しないで解決したい のですが。
以下のようなファイル（シート複数）が複数あります。■ファイル：店舗A.xls （シート：洋菓子） 商品名 価格 数量 ランク 商品A 100 2個 A 商品B 150 3個 B 商品C 100 1個 C 商品D 250 2個 A （シート：和菓子） 商品名 価格 数量 ランク 商品A 100 1個 A 商品B 150 3個 B 商品C 100 1個 C 商品D 250 1個 A （シート：その他） 商品名 価格 数量 ランク 商品A 100 1個 A 商品B 150 3個 B 商品C 100 1個 C 商品D 250 4個 A また、マクロをつけたいファイルには以下のようなシートをつけようと思ってます。 ■集計.xls （シート：マスタ） 店名 コード 店舗A 10001 店舗B 10002 店舗C 10003 マクロで処理したい内容は、ファイル（ファイル：店舗A.xls）をダイアログで選らんで ファイル：店舗A.xlsの内容を読み込ませて、各シートのランクがAのものだけリスト化し、 シート：マスタの行で、ファイル名が店名と一致しているコードをそれぞれの行に対して追加し、 CSV出力するようなものを作りたいです。 ■作成したいファイル（店舗A.csv） 商品A , 100 , 2個 , A , 10001 , 商品D , 250 , 2個 , A , 10001 , 商品A , 100 , 1個 , A , 10001 , 商品D , 250 , 1個 , A , 10001 , 商品A , 100 , 1個 , A , 10001 , 商品D , 250 , 4個 , A , 10001 , そもそも実現できるでしょうか？すみませんが対応方法がお分かりでしたらご教示いただきたいです。 よろしくお願いいたします。
Windowsバッチについて質問です。（初心者です。） ドラッグ＆ドロップした複数のファイル名をクリップボードにコピーしたいのですが、ファイル名の表示まではできたのですが、取得の仕方が分かりません。 現在は以下のように記述しています。 お知恵を貸して頂けますと幸いです。 echo off setlocal enabledelayedexpansion set COUNT=0 for %%a in (%*) do ( echo %%~nxa set /A COUNT=COUNT+1 ) pause
Excelでの並び替えについて質問です。 シート１で下記のように入力し、シート２に並び替えて出力したいです。名前 日付 曜日 開始 終了 時間 山田 １ 月 22:00 23:00 1:00 鈴木 １ 月 22:00 23:30 1:30 ――― 空欄 ――― 山本 ２ 火 1:00 3:00 2:00 山田 ２ 火 1:00 2:15 1:15 ――― 空欄 ――― 山田 ２ 火 2:30 3:30 1:00 鈴木 ２ 火 2:30 3:30 1:00 ・ ・ ・ ・ シート２に出力したいデータは下記のような並び替えです。 名前 / 名前 / 名前 日付 曜日 開始 終了 時間 / 日付 曜日 開始 終了 時間 / 日付・・・ 山田□□□□□□□□□□/鈴木□□□□□□□□□□/山本 １ 月 22:00 23:00 1:00 / １ 月 22:00 23:30 1:30 / ２ 火 1:00・・・ ２ 火 □1:00 □2:15 1:15 / ２ 火 □2:30 □3:30 1:00 /・ ２ 火 □2:30 □3:30 1:00 /・・・□□□□□□□□□/ ・ ・ ・ ・ ・ ・ ・ ・ ・ ・ (□は空白で実際には必要ありません) このような並び替えは可能でしょうか？ どうのような方法で行えば良いかご教授下さい。 知識としては関数を使用したデータ利用程度です。 VBAなどで可能かな？とも考えて、かじろうとしていますがまだまだちんぷんかんぷんな状況です。 よろしくお願いします。
マクロで並び替えをしたいです。知恵袋で検索して、下記のように書きましたが、、、 下記のままでは、一つ目のキーの並び替えが終わってから、 ２つ目のキーに並び替えになってしまうので、思い通りに動きませんでした。 キーを２つ指定したい場合はどこを直せばよいでしょうか？ 宜しくお願いします！ 最優先されるキー Ａ列を昇順に 次に優先されるキー Ｃ列を昇順に Dim 最終行 As Long 最終行 = Range("A" & Rows.Count).End(xlUp).Row Range("A1:K" & 最終行).Sort Columns("A"), xlAscending, Header:=xlYes Range("A1:K" & 最終行).Sort Columns("C"), xlAscending, Header:=xlYes End Sub
【VBAのセル範囲合計】各シート（雛形同じ）のセル範囲（E23:AH36）を指定し、その”合計値”を別シートに書き出し一覧を作れるようにしたのですが、値が合計されずセルのE23の値のみが表示されてしまいました。 どこが悪いのでしょうか…ご教示の程お願い致します。 ちなみに”WorksheetFunction.Sum(Range("E23:AH36")）に変えてみたのですが、値が全て”0”で表示されてしまいました…＿|￣|○ よろしくお願いします ************************ Sub Test1() Dim TmpSheet As Worksheet, i As Integer Dim ws As Worksheet Dim xCur As Range Set xCur = Selection i = Worksheets.Count Set TmpSheet = Worksheets.Add(After:=Sheets(Sheets.Count)) With TmpSheet For i = 1 To i '●↓ここの箇所↓ もともとセル1つ指定だったのを範囲指定に変更しました● .Cells(i, 3).Value = Worksheets(i).Range("E23:AH36").Value Next For Each ws In Worksheets Cells(ws.Index, 1) = ws.Name Next ・ ・ ・
ユーザーフォームにコマンドボタンA、Bを配置して、ボタンを クリックすると、sheet1のｾﾙA1 に、ボタンA＝1、ボタンB＝2、を書き込み、更には、元々登録しているマクロ Macro100() を実行したいです。 コマンドボタンに、「マクロの登録」をする方法が解りません。 ご指導お願い致します。 excel2010です。 もともとのsheet1 には、多くマクロを作っていますが、 ユーザーフォームは勝手が違う気がします。
VBA 特定の文字を含むセル色を全て変更する方法 下記図のように左側がSHEET名「データ」、右側がSHEET名「マスター」が存在します。「データ」SHEETには列、行にかかわらず文字が記載されており、 「マスター」SHEETにはA列にセル色のついた文字が記載されています。 このとき、「データ」SHEETを「マスター」SHEETに基づいて、 「りんご」と文字が含まれているセル色は「りんご」のセル色と同じ赤色に、 「みかん」と文字が含まれているセル色は「みかん」のセル色と同じ黄色にさせたいと考えています。 「マスター」SHEETの文字やセル色はその都度変更されます。 上記を実行することができるプログラムをご教示お願い致します。 ※EXCEL２０１０
VB2015とAccess MDBを使い、OLEDB4.0でアクセスしています。sql = "SELECT time_in, " sql = sql & "time_out, " sql = sql & "time_awaygo, " sql = sql & "time_awayback " sql = sql & "FROM タイムカード " 4つの列は「出社時刻」、「退社時刻」、「外出時刻」、「戻り時刻」となっており、 ここから読み出したデータを処理するために関数を1つ作りました。 これで良いのかはわかりませんが、関数の戻り値を加算していって結果的に 1か月の勤務時間を求めようと思っています。 Private Function CalcWorkdate(tin As Object, tout As Object, tgo As Object, tback As Object) As TimeSpan として引数に読み出したデータを渡すためObject型で宣言しています。 (Date型ではNullを渡せないため) 退社時刻から出社時刻を引いた時間が勤務時間になりますが、戻り時刻から外出時刻を 引いた値が外出時間で、勤務時間から差し引きたいのです。 引数をObjectにしたのでテーブル上NULLの場合もIf文で聞くことが出来ますが この場合の聞き方としては何が適切でしょうか。 ちなみに、「If tgo = "" then 」では演算子'='は型DBNullと文字列""に対して定義されていませんと返されます。 If tgo Is Nothing Then ではエラーは出ませんが正しく判定されません。 教えて下さい。よろしくお願いします。
エクセル2007で列幅を調整させないＶＢＡを教えてください。列幅をあえて固定させる(※1) というものでなく、エクセル2007からデフォルトとなった列幅の自動調整をキャンセルさせるＶＢＡを知りたいです。 ※1：ネットで調べると、その解決策にひとつに、『あえて列幅を固定させる』方法というのがありましたが、このやり方は求めていません。
マクロの日付表示について質問させていただきます。 他の質問等を探して、Ｃ列に言葉が入るとＢ列に日付が自動で表示されるＶＢＡを以下で入力し。実行することは出来ました。↓ Private Sub Worksheet_Change(ByVal Target As Range) If Target.Column = 3 Then If Cells(Target.Row, 3).Value <> "" Then Status = Date Else Status = "" If TypeName(Target.Value) <> "Variant()" Then Cells(Target.Row, 2).Value = Status Else _ For i = 0 To UBound(Target.Value) - 1: Cells(Target.Row + i, 2).Value = Status: Next End If End Sub そして、Ｅ列に入力したらＤ列・・Ｇ列に入力したらＦ列に・・と同じように日付を自動で入力できたらと思い、上記の３を５に変更し、 Private Sub Worksheet_Change(ByVal Target As Range) If Target.Column = 3 Then If Cells(Target.Row, 3).Value <> "" Then Status = Date Else Status = "" If TypeName(Target.Value) <> "Variant()" Then Cells(Target.Row, 2).Value = Status Else _ For i = 0 To UBound(Target.Value) - 1: Cells(Target.Row + i, 2).Value = Status: Next End If End Sub ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー Private Sub Worksheet_Change(ByVal Target As Range) If Target.Column = ５ Then If Cells(Target.Row, ５).Value <> "" Then Status = Date Else Status = "" If TypeName(Target.Value) <> "Variant()" Then Cells(Target.Row,４）.Value = Status Else _ For i = 0 To UBound(Target.Value) - 1: Cells(Target.Row + i, ４).Value = Status: Next End If End Sub というような感じでｺﾋﾟｰしては数字を変更し、繋げて同じＶＢＡを入れたところエラーになりました。 Ｃ列、Ｅ列、Ｇ列、Ｉ列、Ｋ列をそれぞれ入力した際に、 Ｂ列、Ｄ列、Ｆ列、Ｈ列、Ｊ列がそれぞれその日の日付が入るようなマクロを教えて頂けたらと思います。 無知で申し訳ありませんが、よろしくお願いいたします。
重複データをチェックして文字列を結合し、重複行を削除 顧客の在庫管理表を作成しているのですが、大変困っております。 VBA初心者で技術不足なのでどうかご教授願います。「顧客表」として、下の表があります。 受注番号 注文日 苗字 名前 商品ID 項目・選択肢 1111111 05/23 大田 光 10000028 サイズA 1111111 05/23 大田 光 10002028 サイズA 222222 05/22 真田 新 10000028 サイズV 222222 05/22 真田 新 10000228 サイズG 222222 05/22 真田 新 100 10028 サイズT 333333 05/21 武井 優 10000058 サイズO 333333 05/21 武井 優 10200028 サイズB 333333 05/21 武井 優 10700028 サイズA 重複行は必ず下にあります（連続しています） これを1列目「受注番号」をキーとして、同じ番号であればその行を削除して、「商品ID」、「項目・選択肢」の内容を結合し結合部分はスペースを開け、1行にまとめるマクロを作りたいのです。 わかりにくい説明かと思いますが何卒宜しくお願い致します。
シート１に作られている表形式のデータ（複数）を一つのデータにまとめたいのですが VBAに疎いもので、自分ではどうにも分かりません。 どなたか、お知恵をかしてください。下表のような状態のデータをVBAを使って加工したい。 状況及び加工 ①セルが複数結合されている。 ⇒セルの結合を全て解除する セルの結合を解除すると空白列が出来るので 表頭項目名のある列以外の空白列を削除する ②タイトルが表毎についている。⇒タイトル行(1)と直下の行(2)及び 表頭項目行(3)を残して下表のタイトル行、 直下の行及び表頭項目行を削除する
vbaについて 下のようにa>=bのときに正常と表示させたいのですが異常と表示されてしまいます。 どう直せばいいでしょうか。※cells(2,2)=10.6、textbox1=10.2 Dim a As Currency Dim b As Currency A=round(cells(2,2),2) B=round(textbox1,2) if a>=b then msgbox "正常" else msgbox "異常" end if
vbaについて 下のようにa>=bのときに正常と表示させたいのですが異常と表示されてしまいます。 どう直せばいいでしょうか。※cells(2,2)=10.6、textbox1=10.2 Dim a As Currency Dim b As Currency A=cells(2,2) B=textbox1 if a>=b then msgbox "正常" else msgbox "異常" end if
ExcelのVBAのエラー処理について教えてください。下記のマクロで、開くファイルがないときに処理を飛ばしたいのですが、 On Error GoTo Err1の下の行で「ファイルが見つかりません」とエラーが出て止まってしまいます。 どうすればよいでしょうか。 記 ------------------------------------------------------------------- For i=1 to 100 BookNameH=cells(i,1) 'H-Open On Error GoTo Err1 'エラー処理定義 Set TargetBook = Workbooks.Open(BookNameH) With TargetBook.Sheets(1) ---処理--- End With 'H-Close Application.DisplayAlerts = False TargetBook.Close Application.DisplayAlerts = True GoTo Tnext Err1: Resume'エラー処理停止 Tnext: On Error GoTo 0 ---別の処理--- Next i ------------------------------------------------------------------- 以上
VBA初心者です。 ボタンでファイルを選択、読み込み、 そのデータをエクセルのシートに展開するものを作りたく試行錯誤しています。 スペース区切りでセルが分離されるものが理想です。以下、現状作っているものになります。 Private Sub CommandButton1_Click() Dim hogehoge hogehoge = Application.GetOpenFilename Workbooks.Opentext filename:=hogehoge, Datatype:=xlDelimited, Space=True End Sub データが流し込まれ、セルも分離されているのですが、 新しくウィンドウを開いて出力してしまっているのを何とかしたいと思っています。 出来れば、ボタンを設置したシート上で開くのが理想なのですが、 何か出力先を決めれるような機能はあるでしょうか？よろしくお願いします。
このExcelの数式の読み方を教えてください =+IFERROR((VLOOKUP(A3,Sheet1!$N$2:$R$3000,5,0)),"")上記の数式は、商品リストを作る上で上司の方が施してくださった数式で、 すごく便利だったので自分も覚えておこうと思い その上司から一応、教えてはもらったのですが 自分の頭が良くないばかりに、しっかり理解することができませんでした。 忙しい方なので、もう一度教えてくださいとは言いだしづらく この場を借りて質問した次第です。 式内の「=+IFERROR((VLOOKUP(A3,Sheet1!$N$」 ここまでは理解しましたが この後の数字や文字がどこを指すのかよくわかりません そもそも、この聞き方で理解していただけるかどうかも 分からないので、他に必要な情報があれば 記載できる範囲で追記します。 ちなみに、 B列のセルにJANコードを入力すると、その隣の A列のセルにB列に入力したJANコードの下五桁が表示され C列にそのJANコード下五桁に対応した商品名が返されるという物です。 私にある程度のExcel知識があるものとして 回答して頂いて結構です。 ここの回答で私が理解できなければ 私自身が本当の阿呆だったということで。（泣） よろしくお願いいたします。
エクセル初心者です。シートの1列目に時間を設定し、それぞれの時間帯で料金を加算する関数を組んでいます。始まりと終わりの時間を入力すると、総計がでてくるものです。7：00～8：00 ・・・8：01～9：00・・ ～ ・・13：01～14：00・・・ 14：01～15：00 100円・・・・・・・・ 200円・・・・・・・・・・・・・ 300円・・・・・・・・・・・ 400円 例）始まる時間7：32・・・終わる時間13：50 総計1000円 通常は支障ないのですが、時々上の時間区分に当てはまらないケースが発生します。 6：00～8：00・・・ 8：01～9：00・・ ～ ・・13：01～14：00・・・ 14：01～19：00 100円・・・・・・・・・ 200円・・・・・・・・・・・・ 300円・・・・・・・・・・・ 400円 始まる時間や終わる時間が代わってしまいます。この場合、今組んでいる関数だと始まりの時間を６：００と入力しても反映されません。シートを増やさずに、例えばＡ列に区分のための記号（７：００始まりのときは空欄、６：００始まりのときは○など）を入れて、関数を切り替えるようなことは可能なのでしょうか。始まる時間と終わる時間が伸びるだけで、該当区分の料金は同じです。どんな方法で、どんなコードが必要なのか、初歩的な質問でまことに恐縮なのですが、お詳しい方教えていただけませんでしょうか。よろしくお願いいたします。
タイムテーブルを使う業務についているのですが、それでの作業についてご教授いただければと思います。 現在まず、下記のようなタイムテーブルのシートを使用しています。＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ ___1コマ目_ 2コマ目_ 3コマ目_ 4コマ目 5/1 ＿Aさん __Bさん__ Cさん 5/2 ________________Dさん 5/3 _________Cさん__ Aさん___ Dさん 5/4 _________ Bさん ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ やりたいのは、タイムテーブル外のセルで人名のドロップダウンリストを作り、 例えばAさんを選択すると、その週のAさんのコマを自動的に文字データとして返してくれることです。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ ↓名前選択 Aさん ↓自動表示 5/1 1コマ目 5/3 3コマ目 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Vlookを使用しようと考えたのですが、抽出したいデータの行や列が固定のため、行き詰まっています。 どなたか、ご教授いただけると大変助かります。
Excel VBAの値の取得についてお願いいたします。 ネット上からを値を取得したいのですが、 取得値に通貨記号が含まれていて純粋な数値が取得できません。取得後に置き換え等のコードを試してみたのですが、 どうやってもマクロの流れの中で取り除くことができません。 やりたいこと １$ → 1 110.144289円 → 110.144289 取得に使用したコード Worksheets("シート1").Cells(1, 1).Value = _ objIE.document.getElementsByClassName("○○")(0).outerText 詳しい方ご教示いただけないでしょうか？ できればコードをいただければ幸いです。 よろしくお願いいたします。
VBAの処理でA列に入力されている（ＸＸＸＸＸ_OOOOO)の文字列を_の前後で区切った文字をB列とＣ列にそれぞれ自動で入力するような処理はできないでしょうか。関数を事前にセルへ入力しておけば済む話ですが、A列に一度にデータが入力されるようにあるソフトのシステムが構成されている為と、毎回データの件数が違うため自動で入力される処理が出来ないかと思っています。 =IF(A4="","",MID(A4,FIND("_",A4)+1,LEN(A4)))の式がB列に入力されるようにできれば処理できるとは思っていますが、それより前のコードをどうすればいいのかわからないです。
VBAにて下記のマクロを複数シートに適用するには・・・ Excel2016 VBAにて下記のマクロを作成し、コマンドボタンにて動作させるようにしております。内容としては、まず「P01～P**(99まで任意の数)」のシートがあり、 最後に「原紙」「素材」「作業」のシートがあります。 マクロを実行させるコマンドボタンは「作業」シートに配置してあり、 それをクリックすると、「P01～P**(99まで任意の数)」のシート内のセルに存在する 全ての値を「作業」シートのB5セルから下に一覧として並べるようにしたいと考えています。 コードが下記のようになっています。 ------------------------------------------------------------------------ Sub リスト化() Dim ws As Worksheet Dim RowCnt As Integer Dim ColCnt As Integer Dim y As Integer Dim x As Integer Dim z As Integer Set ws = Worksheets("P01") ws.Activate Sheets("P01").Cells.SpecialCells(xlLastCell).Select RowCnt = Selection.Row ColCnt = Selection.Column y = 1 x = 1 z = 4 With Sheets("P01") For y = 1 To RowCnt For x = 1 To ColCnt If Cells(y, x) <> "" Then z = z + 1 Sheets("作業").Cells(z, 2) = .Cells(y, x) Else End If Next x Next y End With End Sub ------------------------------------------------------------------------- 現在、対象のシート名をP01だけとしているので思うように動作していますが これを「P01～P**(99まで任意の数)」を対象 (「原紙」と「素材」、「作業」シートは対象外)としたときに、 どうしたらよいか分からず困っています。 イメージとしては、P01の一覧の下にP02、その下にP03の一覧、、、 と連続していき、対象のシートの値がすべてB5以下に縦一列に並ぶという感じです。 分かりにくくて申し訳ありませんが、よろしければご教授願います。
エクセルでマクロを組み始めたばかりの者です。下記のようなマクロを組んでみましたが、27行目もしくは41行目のActiveSheet.Pasteで「実行時エラー‘1004‘： 変更しようとしているセルまたはグラフは保護されているため読み取り専用となっています…」というエラーメッセージが出て止まってしまいます。 しようとしている内容は、転送ボタンを押し各シートの指定セルへ一括転送（コピー）をしたいのです。 その際、転送先はシート保護をしておきたいのです。 エラーはエクセル2010で確認しましたが、職場のＰＣを使用するため2007や2003等他のバージョンを利用する可能性もあります。また、仕事で使用するため早急に使わなければならず焦っています。 Option Explicit Private Sub CommandButton2_Click() Call Macro2 End Sub Sub Macro2() Workbook.Open Filename:=”K:¥共有¥○○○.xlsm” ActiveSheet.Unprotect ThisWorkbook.Activate Range(”D4:G20”).Select Selection.Copy Windows(”○○○.xlsm”).Activate Range(”E7”).Select ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode = False Workbook.Open Filename:=”C:¥Users¥Desktop¥×××.xlsm” ActiveSheet.Unprotect ThisWorkbook.Activate Range(”D4:G20”).Select Selection.Copy Windows(”×××.xlsm”).Activate Sheet(”△△△”).Select Range(”AF18:AI34”).Select ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode = False Workbook.Open Filename:=”K:¥共有¥□□□.xlsm” ActiveSheet.Unprotect ThisWorkbook.Activate Range(”D4:G20”).Select Selection.Copy Windows(”□□□.xlsm”).Activate Sheet(”▽▽▽”).Select Range(”AF18:AI34”).Select ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode = False MsgBox " 『○○○』と" & vbCrLf & "『×××』と" & vbCrLf & "『□□□』の" & vbCrLf & "規格を変更しました。" End Sub どの様に修正すれば良いのでしょうか？ マクロが原因でしょうか？または他の原因があるのでしょうか？ マクロ初心者のため、修正方法など具体的な詳細をお教えいただけないでしょうか。 お手数をおかけして申し訳ございませんが、よろしくお願いします。
エクセルのマクロ ボタン一つで複数のセルの内容を置き換えることってできますか。 それぞれ別のセルに入力されている文字や数字に置き換えたり、プルダウンの選択を自動で行ったりしたいです。「マクロの記録」でやってみましたがだめでした。
Excelマクロを使って自身のファイル名を入力する方法を教えて下さい。 自身のファイル名を取得する方法として、 ActiveWorkbook.Name と言う記事を見つけました。ActiveWorkbook.Name Range("A1").Select ActiveSheet.Paste と記述しても出来ませんでした。 Excelセル（A,1）に入力するには、それをどの様に使えば良いのでしょうか。 宜しくお願いします。
エクセルＶＢＡ テキストボックスの重複入力について教えてください。ユーザーフォーム１上にテキストボックス１があります。バーコードリーダーで商品のコードを読むとその値がテキストボックス１に入力、コマンドボタン１をクリックでシートＡ列に上から順に入力されているのですが、時々同じ商品と気づかずに同じコードを続けて読んでしまい後からシート上で削除しています。例えばテキストボックス１に最初００１１０というバーコード入力があり、次も全く同じ値００１１０がテキストボックス１に入力された場合、メッセージ「同じ番号です」を表示して元の入力待機状態に戻す（シートに書き込まずに戻る）ことはできるのでしょうか。シーＡ列を=IF(COUNTIF～～等で参照することは今回せず、テキストボックス１の前後入力の比較でＶＢＡ処理を行えればと思っています。どうかお知恵をおかしください。
ExcelVBA初心者です。 質問させてください。質問１・・・D列にすでにあるデータを編集しようとすると下記のようなメッセージがでるように してあるのですが、なぜかK6やN6を編集しようとすると 型が一致しないと言われます。 どうしてでしょうか？ 質問２・・・さらにできればD列の全てではなく、D８：D１０８と範囲指定できれば 理想なのですがどうすればいいでしょうか？ Private Sub Worksheet_SelectionChange(ByVal Target As Range) If Target.Column = 4 And Target <> "" Then Select Case MsgBox("入力されてます、編集しますか?", vbExclamation Or vbYesNo) Case vbYes Application.SendKeys "{F2}", True End Select End If End Sub
VBAをつかってインターネット上のサイトを動かしたいのですが、JavaScriptの操作のところでつまづいております。 VBAとJavaScriptは基本の基本は分かりますが、初心者です。ソースを見ると、下のようになっております。 <a href="#noMove" onclick="doNextTicketOrganizationPageNew('','195938');">15/07/28 12:00</a> ブラウザ表示上で「15/07/28 12:00」という文字をクリックした先のページに進みたいです。 いろいろ調べてみて試してみたのですが、うまくいかず・・・ よい方法があればご教授いただけると嬉しいです。 よろしくお願いいたします。
【Access2010】フォーカスを移動させたくない Me.imp_端末 ↓ imp_cmb_回線 ・ ・ ・ この順でタブ移動順を設定しています。それぞれに入力チェックを設けており、 エラーとなった場合は次の項目へ進まずに 再び同じ項目にフォーカスを留めたままにしておきたいのですが、 下記の通り記述しても次の項目へ進んでしまいます。 （GoToControlでも同じです） 入力チェックをクリアして初めて次の項目へ進ませたいです。 どのように記述すればよろしいでしょうか？ よろしくお願いします。 - - - - - - - - - - - - - - - - Private Sub imp_端末_AfterUpdate() Dim IMsg As String Dim IRet As Integer '長さチェック If Len(Me.imp_端末) > 10 Then IMsg = "10文字以内で入力してください。" IRet = MsgBox(IMsg, vbCritical, "Error") Me.imp_端末 = Null Me.imp_端末.SetFocus 'DoCmd.GoToControl "imp_端末" Exit Sub End If End Sub - - - - - - - - - - - - - - - -
VBAでフォルダ名の表示が「・」（点）になってしまいます。 必要箇所を抜き出すと以下のような記述です。Dim japan As Strinｇ ・・・ japan = Dir(ActiveWorkbook.Path, vbDirectory) ・・・ bk1.Worksheets(5).Cells(2, 2).Value = japan 大雑把な内容としては，複数のフォルダ内の複数ブックの一部をCopyPictureして， 新規のブックとして作成し，それぞれのフォルダに保存するというものです。 （イメージ） Aフォルダにある，aブック～dブック CopyPictureで新規ブックを作成し，Aフォルダに保存 他のフォルダにも同様の処理を行う。 「japan」という変数を使う前は， bk1.Worksheets(5).Cells(2, 2).Value =Dir(ActiveWorkbook.Path, vbDirectory)としていました。 しかし，この記述だと，フォルダ内の複数のブックの全てがコピーされず，一つのブックだけがCopyPictureされてしまいました。 そこで，「japan」という変数にしてみました。 変数にすると，全てのブックに対してCopyPictureがなされるのですが， Cells(2, 2)にはフォルダ名でなく，「・」（点）と表示がされます。 解決策をご教示ください。 よろしくお願いいたします。
VBAで絶対パスを相対パス指定にしたい。 現在，以下のような記述をして，絶対パス指定をしております。 このVBAをどこでも動作するように，相対パス指定にしたいと考えております。どのように記述を変えればよいかご教示ください。 よろしくお願いいたします。 現在の記述 strDir = "C:\UUU\AAA\BBB\" strmDir = strDir & "フォルダ\" FindFNm = "*新規ブック.xls*"
指定のシート、セルに、数式を登録するマクロを作りたいですが、エラーになります。セルに登録した数式は、 =IF(A2="",IF(A3="","",MID(A3,5,3)),A2) （ただし、A2,A3のセル番地はマクロ上では変数です） エラーになるマクロ ActiveCell.FormulaR1C1 = _ "=IF(RC[-12]="""",IF([RC[-11]="""","""",MID(RC[-11],5,3)),RC[-12])" EXCEL2010です。 聞きながら見よう見まねでがんばっています。 ご指導お願いします。
ネットワーク上の共有ドライブ内にある下記のvbaが入っているブックを開き、 保護されたビューの解除をすると 『オブジェクト変数または With ブロック変数が設定されていません』というエラーが出ますが、無視してデバッグを選ばず終了を選ぶとvba通りの動きをします。 何が原因でしょうか？ デバッグを押すと★のところにマークが行きます。 Private Sub Worksheet_SelectionChange(ByVal Target As Range) Dim c As Range Dim r As Range Dim myRange As Range ★ Set c = ActiveSheet.Cells.Find(what:="□", LookIn:=xlValues, lookat:=xlWhole) Set myRange = c For Each r In ActiveSheet.UsedRange If r = "□" Or r = "■" Then Set myRange = Union(myRange, r) End If Next r If Target.Count <> 1 Then Exit Sub If Intersect(Target, myRange) Is Nothing Then Exit Sub If Target.Value = "□" Then Target.Value = "■" Else Target.Value = "□" End If End Sub
先日、複数パスワード一括解除コードについて質問し、回答をいただいた通りやってみましたが、 入れる場所を間違っておりましたでしょうか？なんだかうまくいきません。今一度ご教授くださいませ。 ＞Workbooks.Openの前で入力させればよいのではないですか。それも pw = InputBox(myFn&"のパス")のようにしたらどうでしょうか。 → Workbooks.Openの前らしき場所に、複数のパスワードとしてpw = InputBox(myFn&"のパス")をいれてみました。言われていることと全く違いましたでしょうか・・・ Sub TEST01() Dim myFn As String Dim pw As String Dim wb As Workbook '以上変数宣言 Application.ScreenUpdating = False '画面更新一時停止 myFn = Dir(ThisWorkbook.Path & "\*.xls?") 'エクセルBOOK検索 Do While myFn <> "" '対象が存在する限り続行 If myFn <> ThisWorkbook.Name Then 'ファイル名が自分の名と違っていれば pw = InputBox(myFn&"123") pw = InputBox(myFn&"321") pw = InputBox(myFn&"213") Set wb = Workbooks.Open(ThisWorkbook.Path & "\" & myFn, Password:=pw) '開く With wb Application.DisplayAlerts = False '警告一時停止 .SaveAs Filename:=wb.FullName, Password:="" 'パスワードなしで上書保存 .Close False '閉じる Application.DisplayAlerts = True '警告停止解除 End With End If myFn = Dir() '次検索 Loop '繰り返し Application.ScreenUpdating = True '画面更新停止解除 MsgBox "終了しました。" End Sub
VBAの待機のさせ方がわかりません。 shell関数で外部プログラムを呼び出し、その終了までVBAを待機させたいのです。 が、そのやり方がわかりません。https://www.moug.net/tech/exvba/0150034.html ここを参考にしましたが、 動かしてみると、外部プログラムの開始を待機してしまいます。 どこがいけないんでしょうか。 EXCELは2013と2016を使っています。 ご教授お願いします。
VBAを用いてIEを操作する方法。はじめまして初心者です。 IEで指定のページを開き、検索を行い、結果のページを開くことまでできました。そこからページの指定の文章をexcelで保存したいのですが調べていてもなかなかできません。アドバイスを頂けたらと思い投稿させていただきました。ご教授のほどよろしくお願い致します。以下のプログラムが検索結果まで開けたものになります。文章をexcelに抽出する方法と指定の文章をコピーする方法が知りたいです。エクセルにコピーしたい範囲は検索結果です。よろしくお願い致します。 Public Sub IE基本_個体識別番号検索() Dim ie As New InternetExplorer ie.navigate "https://www.id.nlbc.go.jp/top.html" ie.Visible = True While ie.Busy = True And ie.readyState < READYSTATE_COMPLETE DoEvents Wend Dim doc As HTMLDocument Set doc = ie.document Dim sel As IHTMLSelectElement Dim inp As IHTMLInputElement Set objInpTxt = ie.document.getElementsByName("txtIDNO")(0) objInpTxt.Value = "1337256214" Dim btn As HTMLInputElement Set btn = doc.getElementsByTagName("input")(0) btn.form.submit While ie.Busy = True And ie.readyState < READYSTATE_COMPLETE DoEvents Wend Application.Wait Now + TimeValue("00:00:05") Set btn = doc.getElementsByTagName("input")(0) btn.form.submit End Sub
visual studio2008のプログラムをvisual studio2015で動かそうとしたのですが、 インクルードファイルが開けませんというエラーと#include<cv.h>などでエラーが起きて動きませんでした。 opencvは古いのは1.1 preを使用していたのですが、 最新のopencvでは動作しないのでしょうか？
Visual Basic でアプリを作成し、使っているのですが、たびたび、アプリは立ち上がるのですが、肝心のフォームが表示されなくなり、実質何の操作もできないという状態に陥り困っています。この状態になると、以後、何度アプリを終了して再立ち上げしても、アプリは立ち上がるのですが、フォームは表示されません。 回避策として、アプリを入れているフォルダー名を変更して、新しいアプリとして立ち上げることをしていますが、原因が分からないので、この要領で使い続けるとコンピューターに影響が出ないか心配しています。 フォームが非表示になる原因と対策、そして回避策継続の場合のコンピューターへの影響等をご存知の方は、よろしくお願いします。
Visual Studio2013を利用していますが、開発者コマンドプロンプトで実行した結果とVisual Studioでビルドして実行した結果が異なってしまいます。VisualStudioで問題なくビルドできたので、どこが問題なのかもよくわかりません。 このようなことが起きる原因はなんでしょうか?
エクセルのＶＢＡについてついて質問です。（windows7) マクロでvlookupでセルを抽出するというのは教えていただき わかりました。 ここで質問です。同じくvlookupで単一セルではなく、一行全体を引っ張ってくる（抽出する）方法はありますか？ 例えば、 シート１にキーとなる文字列がある。 （ex, 31a abc afc など） シート２にデータ一覧（キー文字列を含む）がある。 （ex, 31a---aaaaa---ggggg 123---ddddd---kkkkk afc---55555---uuuuu など） シート３には、シート２のデータ一覧から、シート１のキー文字列を含む行全体を抽出する （ex, 31a---aaaaa---ggggg afc---55555---uuuuu など） ということです。 上記の例だと、まずマクロでvlookupでやり、それからRowsプロパティでやる、ということでしょうか？ わかる方、よろしくお願いします。 （ちなみにマクロ初心者で、具体的なコードで説明していただけると勉強になります）
可変の最終行の値を左に一つ移動する方法をご教示ください。 Range("C1").End(xlDown).Select
"F1:H1"の数字が"A1:D1"の中にあれば、 その数字を赤にするなのですが、 これを１行１行行いたいのです。全部で２００行。 そのマクロ文を教えて貰えないでしょうか？A B C D F G H 3 2 4 9 9 3 4 1 3 4 9 9 3 5 1 3 5 9 9 3 6 3 2 6 9 9 3 7 1 2 6 9 9 3 8 ２００
VBAでWSHによるメッセージを表示したのですが閉じてくれません。 WEBサイトからいただいたサンプルコードです。Sub Sample2() Dim wsh As Object Set wsh = CreateObject("WScript.Shell") wsh.Popup "5秒後、自動的に閉じます", 5, "Title", vbInformation Set wsh = Nothing End Sub 参照設定はいらないと思いますが一応つけてもだめでした。 何かほかの設定が必要なのでしょうか？
C#でメソッド名についている< > の意味が分かりません。例） public static T CreateMap<T>(IDataReader reader) { 処理; } どう検索すればよいのかわからない状態ですので、 何かキーワードだけでもいただけると助かりますm(_ _)m
さきほどVBAについて質問させていただいたものです。プログラムが書ききれなかったため再質問させていただきます。 現在以下のようなコードとなっております。イメージとしましては、エクセルの値を検索ボックスに入れる→検索ボタンを押す→検索結果を表示し、それをエクセルに保存というところまでできました。これを保存が完了すれば一度IEを閉じ、再度エクセルの値を入力するところからループしかし、エクセルの値はA1～A50までを順にといったようなことがしたいです。ご教授いただけたら幸いです。 Public Sub IE_番号検索成功() Dim ie As New InternetExplorer ie.navigate "https://www.id.nlbc.go.jp/top.html" ie.Visible = True While ie.Busy = True And ie.readyState < READYSTATE_COMPLETE DoEvents Wend Dim doc As HTMLDocument Set doc = ie.document Dim sel As IHTMLSelectElement Dim inp As IHTMLInputElement Set objInpTxt = ie.document.getElementsByName("txtIDNO")(0) objInpTxt.Value = Range("A1").Value Dim btn As HTMLInputElement Set btn = doc.getElementsByTagName("input")(0) btn.form.submit While ie.Busy = True And ie.readyState < READYSTATE_COMPLETE DoEvents Wend Application.Wait Now + TimeValue("00:00:05") Set btn = doc.getElementsByTagName("input")(0) btn.form.submit Application.Wait Now + TimeValue("00:00:05") Dim objWb As Workbook Set objWb = Workbooks.Add Set tbl = ie.document.getElementsByTagName("table")(0) Set tr = tbl.getElementsByTagName("tr") Set th = tr(0).getElementsByTagName("TH") For c = 1 To th.Length Cells(1, c).Value = th(c - 1).innerText Next For r = 2 To tr.Length Set td = tr(r - 1).getElementsByTagName("td") For c = 1 To td.Length Cells(r, c).Value = td(c - 1).innerText Next Next Dim fileName As String fileName = Range("A15") ActiveWorkbook.SaveAs fileName End Sub
Google検索結果のリンクを開く VBAでInternetExplorerのオブジェクトを作成し、 検索結果をAccessのデータとして収集することを考えてます。VBAでGoogleを開き、検索窓にキーワードを設定して結果を 出したまではできたんですが、次のコードじゃ検索結果を 開くことができませんでした。 For Each obj In oIE.Document.links obj.click Debug.Print obj.innertext Next obj どうやったら検索結果のリンクを開けるでしょうか？ あと、質問日時や質問内容はリンクを開くことができたら 取得できるでしょうか？ ご存知の方、ご教示くだしさい。
今、ExcelVBAでプログラムを作っています。・マクロ（.xlsx) ・テンプレートファイル（.xlsx） ・ファイル1（.xlsx） ・ファイル2（.xlsx） ・ファイル3（.xlsx） を使ったプログラムで、 ①マクロ(.xlsx)の実行ボタンをクリック ②テンプレートファイル（.xlsx）をコピー ③コピーしたテンプレートファイルの シート("ファイル1")にファイル1（.xlsx）のデータを範囲選択しコピー （※ファイル2，3も同様） ④ファイル1～3のあるパスに③でできたファイルを名前を付けて保存 という流れです。 自分でも作ってみたのですが上手くいかず… 画像でも流れを書いてあるので、見にくいかもしれませんが コードを教えていただけると嬉しいです。
visualstudio2015communityでprivateメソッドの単体テストを行う方法を教えて下さい。1,テスト対象メソッド上で右クリック 2,単体テストの作成 3,フィルタボタンからパブリック以外のアイテム表示 の流れで実施しようとしたら、2,の段階で 「パブリックでないといけません」の旨の メッセージが出て前に進めません。 クラス名_accesser という名前のクラスを VBが自動で作ってくれるやり方が知りたいです。
C#で『() =>』という演算子の意味が感覚的にわからないのですが、、、どなたか教えていただけますでしょうか。 使用例 await Task.Run( () =>{ Tread.Sleep(5000); });
Excelについて質問です。 セル内に入力する文字数を制限したいです。 半角数字4文字（例えば、1111などの4文字）が入力されたら次のセルに移動したいのですが、いい方法がありません。Private Sub Worksheet_Change(ByVal Target As Range) Dim wCellVal As String 'セルの値を取得する With Worksheets("Sheet1") wCellVal = .Cells(Target.Row, Target.Column).Value End With 'A列(ID)の文字数チェックを行う If Target.Column = 1 Then If Len(wCellVal) > 4 Then MsgBox "IDは4桁以内で入力してください。", vbOKOnly + vbExclamation, "入力エラー" Exit Sub End If End If End Sub 上記のようなコードを見つけたのですが、これだとセルに入力しエンターキーを押した後にイベントが発生するのでちょっと違います。 やりたい事は、エンターキーで確定する前に5桁目が入力されたら次のセルに移動したいです。 VBAでなくても、セルの書式設定や入力規則でも構いません。 ご教示いただけますでしょうか。 よろしくお願いいたします。
ExcelのVBA初心者です。セルをダブルクリックした際のイベントとして、ダブルクリックしたC列のセル（アクティブセル？）の行のデータをuserform上に反映させたいと考えております。 一応機能はするのですが、素直にダブルクリックした行のデータを反映してくれません。というのも、例えばrangeC2をダブルクリックすると、1回目はデータはuserformに反映されません。一度表示されたuserformを閉じて再度C2をダブルクリックするとC2のデータが飛びます。そして次に、C3のセルをダブルクリックするとやはりC2のデータが反映され、再度userformを閉じてダブルクリックしなおすとC3のデータが飛びます。これはアクティブセルがひとつ前にダブルクックした場所？と思ってMsgBox ActiveCell.rowやtarget.rowで確認してみましたが、ちゃんと直前にダブルクリックしたRowの数値を取っていました… 分かりづらい説明で申し訳ございませんが、ご教授頂けると幸いです。私が今作った内容を張らせていただきます。 Praivet Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) Dim rng As Range Dim rng2 As Long Set rng = Range("C5:C8000") If Not Intersect(Target, rng) Is Nothing then Application.EnableEvents =False UserForm2.show rng2 = Target.Row (※または ActiveCell.Rowにて行番号を取得してました） ’氏名 UserForm2.myTx10 = Worksheets(2).cells(rng2,3).Text UserForm2.myTx11 = Worksheets(2).cells(rng2,4).Text ・・・・・以下同じように続きます・・・・ rng2= Target.Rowの前にMsgBox Target.Rowを書き確認してみましたが、MsgBoxの数値は求めているものでした・・・しかし、実際にCells(rng2,3).Textのrng2は違う数値？なのか違う行のデータを反映してしまします。 説明下手なため、ご理解しにくいかとは思いますが、よろしくお願い致します。 また、行のデータをuserformに反映できるのであれば、別の方法でも構いせん。以前はB列にコマンドボタンを配置し、そのコマンドボタンを押したらそのコマンドボタンの位置を取得し、その行のデータをuserformに反映・・・と考えておりましたが…ダブルクリックイベントを前に作ったことがあったため、今回もダブルクリックイベントに変更したまでしたので。
このマクロは現在使用中（社員の誰か不明）ですが、一部修正し使用したいのですが、全く修正方法がわかりません。何方かご教授くださいませんか。現在は、日にち順列に集計してますが、その列を商品コードとし発送済み合計個数を集計したい。 シート１．２のC列・A列は発送日（C列の発送日はまばらになってて、シート２のA列は全て記入されています。）シート１のAJ列に個数、シート２はR列が個数、集計はシート１のF列・シート２のB列が商品コードで、集計シート３のD列の商品コードを基準にして、発送済のシート１・２の合計個数をシート３で集計したいのと、集計位置がE列なので、右に移動しK列に集計したいのですがこの様な事はできますか。大変申し訳ありませんが、ご教授の程、よろしくお願い致します。 Public Sub Samp1() Dim dic As Object Dim vA As Variant, v As Variant Dim vSh3Data As Variant Dim vShDay As Variant, vShData As Variant Dim i As Long, j As Long, k As Long Const CELM As Long = 1 vA = Array(Array("Sheet1", "C", "F", "AJ"), Array("Sheet2", "A", "B", "R")) Set dic = CreateObject("Scripting.Dictionary") With Worksheets("Sheet3") With .Range("D28", .Cells(Rows.Count, "D").End(xlUp)) .Offset(, 1).Resize(, CELM).ClearContents vSh3Data = .Resize(, CELM + 1).Value For i = 1 To UBound(vSh3Data) dic(vSh3Data(i, 1)) = i Next For Each v In vA With Worksheets(v(0)) With .Range(.Cells(2, v(3)), .Cells(Rows.Count, v(2)).End(xlUp)) vShDay = .Value i = Cells(1, v(3)).Column - Cells(1, v(2)).Column vShData = .Offset(, i).Resize(, CELM).Value End With End With For i = 1 To UBound(vShDay) j = dic(vShDay(i, 1)) If (j <> 0) Then For k = 1 To CELM vSh3Data(j, k + 1) = vSh3Data(j, k + 1) + vShData(i, k) Next End If Next Next .Resize(, CELM + 1).Value = vSh3Data End With End With Set dic = Nothing End Sub
パラメータの設定方法がわかりません。 パラメータの設定を行っているクエリ[10出力前完成_Q]を実行したいのですが、パラメータの設定の仕方がわかりません。実行時エラー 3061 パラメータが少なすぎます。3を指定してください。 ----- Const conSourceName As String = "10出力前完成_Q" Dim db As DAO.Database Dim qd As DAO.QueryDef Dim rsHeader As DAO.Recordset Dim strSQL As String fncOutputRecords = False strSQL = "SELECT [10出力前完成_Q].[Pin],[10出力前完成_Q].[PinInfo],[10出力前完成_Q].[所属]" & _ "FROM [" & conSourceName & "] " & _ "ORDER BY [10出力前完成_Q].[所属],[10出力前完成_Q].[Pin],[10出力前完成_Q].[PinInfo]" Set db = CurrentDb 'Set qd = db.QueryDef(conSourceName, strSQL) Set rsHeader = db.OpenRecordset(strSQL, dbOpenSnapshot) →ここでエラー
Excelvba マクロ実行中に列A40:A42の値をリストボックス表示し その中から選択した値をセルA4に代入するといったマクロを作成したいと思っております。どなたか詳しい方のご教授をお願いいたします。
エクセルのVBAに、 Option Explicit Sub test() If Range("A2").Value > 1 Then 'A2は１より大きいか？If [A2] Mod 2 <> 0 Then If [A2] Mod 3 <> 0 Then If [A2] Mod 5 <> 0 Then If [A2] Mod 7 <> 0 Then If [A2] Mod 11 <> 0 Then If [A2] Mod 13 <> 0 Then Else Range("B2").Value = Range("A2").Value / 13 Range("B3").Value = "13" End If Else Range("B2").Value = Range("A2").Value / 11 Range("B3").Value = "11" End If Else Range("B2").Value = Range("A2").Value / 7 Range("B3").Value = "7" End If Else Range("B2").Value = Range("A2").Value / 5 Range("B3").Value = "5" End If Else Range("B2").Value = Range("A2").Value / 3 Range("B3").Value = "3" End If Else Range("B2").Value = Range("A2").Value / 2 Range("B3").Value = "2" End If '2で割る Else '終わる End If If Range("B2").Value > 1 Then 'B2は１より大きいか？ If [B2] Mod 2 <> 0 Then If [B2] Mod 3 <> 0 Then If [B2] Mod 5 <> 0 Then If [B2] Mod 7 <> 0 Then If [B2] Mod 11 <> 0 Then If [B2] Mod 13 <> 0 Then Else Range("C2").Value = Range("B2").Value / 13 Range("C3").Value = "13" End If Else Range("C2").Value = Range("B2").Value / 11 Range("C3").Value = "11" End If Else Range("C2").Value = Range("B2").Value / 7 Range("C3").Value = "7" End If Else Range("C2").Value = Range("B2").Value / 5 Range("C3").Value = "5" End If Else Range("C2").Value = Range("B2").Value / 3 Range("C3").Value = "3" End If Else Range("C2").Value = Range("B2").Value / 2 Range("C3").Value = "2" End If '2で割る Else '終わる End If If Range("C2").Value > 1 Then 'C2は１より大きいか？ If [C2] Mod 2 <> 0 Then If [C2] Mod 3 <> 0 Then If [C2] Mod 5 <> 0 Then If [C2] Mod 7 <> 0 Then If [C2] Mod 11 <> 0 Then If [C2] Mod 13 <> 0 Then Else Range("D2").Value = Range("C2").Value / 13 Range("D3").Value = "13" End If Else Range("D2").Value = Range("C2").Value / 11 Range("D3").Value = "11" End If Else Range("D2").Value = Range("C2").Value / 7 Range("D3").Value = "7" End If Else Range("D2").Value = Range("C2").Value / 5 Range("D3").Value = "5" End If Else Range("D2").Value = Range("C2").Value / 3 Range("D3").Value = "3" End If Else Range("D2").Value = Range("C2").Value / 2 Range("D3").Value = "2" End If '2で割る Else '終わる End If end sub とSheet１に書いているのですが、これをひとまとめにできないでしょうか？ 例えば、ループや変数を使ってです。お願いします。
EXCELのVBAでオプションボタンとコンボボックスORテキストボックスORチェックボックスでオートフィルタをかける方法を教えて下さい・・・画像のような検索フォームを作成し複数条件でオートフィルタを掛けたいのです。 オプションボタンの１～６は必須選択で、オプションボタン２、３、４、５を選んだ場合はそれぞれ詳細条件を配置しています。 検索ボタンを押すと以下のようにオートフィルタをしたいと思っています。 オプションボタン１を検索→sheet1全データ表示 オプションボタン２＋コンボボックス１→sheet1Ａ列でオートフィルタ オプションボタン３＋テキストボックス１（数値入力）→sheet1Ｃ列で【入力した数値】以上でオートフィルタ オプションボタン４＋チェックボックス１→sheet1Ｄ列でオートフィルタ オプションボタン５＋チェックボックス２→sheet1Ｅ列でオートフィルタ オプションボタン５＋チェックボックス３→sheet1Ｆ列でオートフィルタ オプションボタン６→sheet2を表示 検索ボタンに組み込むプログラムの作成について皆様のお知恵をお貸し頂きたく、宜しくお願い致します。<m(__)m>
マクロ・VBA初心者です。 経費精算のExcelデータを画像のような「"",]で区切ったテキストファイルを作成するマクロを作りたいと考えてます。完成イメージ：マクロのボタンを押すとテキストファイルの形でフォルダに作成される。もしくは、マクロボタンを押すとテキストファイルの形で区切ったものが表示されるものを作りたいです。 ＊経費精算データに関してA列からX列まであり、集計データにより列にデータを埋めていく作業が入っております。なので、A列からX1列まででデータが記入されている範囲で集計できるようにしたいと考えております。 現在は、勉強しつつ組み立てた結果、 CSVのExcelファイルをフォルダの中に作成できるようになりました。 （コードは下記に記載します） ただ、テキストファイルが作れるコードができていないのが問題です。 このコードをどのように変えればよいのか？ もしくは、別のコードで出来るようならば教えていただけると嬉しく思います。 宜しくお願いします。 ______________________________ 〈コード〉 Option Explicit Sub ExcelファイルCSV形式作成() '変数宣言 Dim filePath As String Dim i As Long Dim maxRow As Long Dim fileNo As Integer '初期値設定 filePath = ActiveWorkbook.Path & "\経費計算エクセル（CSV保存）.csv" maxRow = Range("A1").End(xlDown).Row '最終行取得 fileNo = FreeFile 'FreeFile関数で使用可能なファイル番号取得 'ファイル開く Open filePath For Output As #fileNo '最終行までループ For i = 1 To maxRow '列の数は決め打ち Write #fileNo, Cells(i, 1), Cells(i, 2), Cells(i, 3), Cells(i, 4), Cells(i, 5), Cells(i, 6); Cells(i, 7), Cells(i, 8), Cells(i, 9); Cells(i, 10), Cells(i, 11), Cells(i, 12); Cells(i, 13), Cells(i, 14), Cells(i, 15); Cells(i, 16), Cells(i, 17), Cells(i, 18); Cells(i, 19), Cells(i, 20), Cells(i, 21); Cells(i, 22), Cells(i, 23), Cells(i, 24) Next i 'ファイル閉じる Close #fileNo End Sub ＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿ 宜しくお願いします。
『シートの保護』下の『可視セルの選択』方法 EXCEL2007において『シートの保護』をしていても 『可視セルの選択』をするにはどうすれば良いでしょうか？マクロの記述などが必要なのであれば、 そのコードもご教授頂けると幸いです。 どうしても必要な機能なので困っております。 どなたか御知恵を拝借できませんでしょうか？ 何卒よろしくお願い申し上げます。
〈フォルダ内のファイル名に限らず、2種類のファイルを1つの集計用ファイルに集計し、それぞれ別々のシートの転記するマクロ。〉 マクロ・VBA初心者です。 ご教授、宜しくお願いします。上記の動作を行うVBAコードを教えていただけたら幸いです。 ■詳細 社員から経費精算書・交通費精算書のファイルをもらい一つのフォルダーに入れた状態で集計用のファイルに転記する） 経費のデータは→経費用データのシート 交通費は→交通費用データのシート 経費精算書から取り出したい（集計用Excelに転記したい）値のセルは、B4、B5、A列からH列の9行目から下のセルが埋まっている値（9行目含む 交通費精算書から取り出したい値のセルは B4、B5、AからK列の9行目から下のセルが埋まっている値（9行目含む） 仮にシートを条件で切り分けるとしたらセルA1がそれぞれ下記のように記入があります。 経費A1セル General Expense Report 交通費A1セル Travel Expense Report また、過去にも質問をさせていただいたのでこちらをリンク貼らせていただきます。 ■詳細と経費と交通費の異なる点記入 http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1215944929... ■コードの記入は下記のリンクに貼っています。 http://okwave.jp/qa/q9174557.html 最終行の列が字数制限で消えてまいした。 '---------------------------------------- Next i End Sub 非常に困っています、 何卒、よろしくお願いいたします。
プログラマの報酬が異常に安いのが日本という国はなぜですか 1位 Ruby on Rails $109,460(約1300万円) 2位 Objective C $108,225(約1280万円)3位 Python $100,717(約1200万円) 4位 JAVA $94,908(約1110万円) 5位 C++ $93,502(約1100万円) 6位 JavaScript $91,461(約1080万円) 7位 C $90,134(約1060万円) 8位 R $90,055(約1060万円) 9位 C# $89,074(約1050万円) 10位 Visual Basic $85,962(約1010万円) 11位 SQL $85,511(約1000万円) 12位 PERL $82,513(約971万円) 世界に比較して年収が低いという日本の記事の内容です
vb2015を使用しています。 フォームのボタンを押すと、外部アプリケーションが開くといったことがやりたいです。どのようにコードを記述すればよいでしょうか 用意したものは、 フリーソフト一式（フォルダ名：例えば、abc アプリケーション名：defg.exe とします。） フォーム１まい、ボタン１つ です。 よろしくお願いします。
VBとRuby、独学でテキストのみで学ぶのに、適しているのはどちらですか？余分な有料ソフトとか不要なほうは。
Visual Basicにてセキュリティ系のソフトを作っているのですがタスクマネージャー内のプロセスの非表示の方法を教えてください
VBAを使用してデータ処理をしたいのですが。 Aのシートに 100行1000列程のデータ量で、各セルに0.5から30.5位の値がランダムで入っています。ただし僅かな量ですが、さらにランダムでいくつかのセルにハイフンが入ったセルがあります。 大体のセルに数値が入っており、稀にハイフンが入っている状態です。 例えばシートAのA5に10、A6に20、A7に2とそれぞれ値が入っていると仮定して そのデータをシートBのA6に15、A7に11というように入力していきたいのですが 稀にハイフンがあるため、以下のようなコードを記述します。 For i = 1 to 1000 'Columnのカウント For j = 1 to 100 'Rowのカウント If Sheets("SheetA").Cells(j,i).Value = "-" Then x =Cells(j-1,i) Else x =Cells(j,i) If Sheets("SheetA").Cells(j,i).Value = "-" Then y =Cells(j+1,i) Else y =Cells(j,i) z = (x+y)/2 Sheets("SheetB").Cells(j,i).Value = z Next j Next i このコードだと対象のセルのどちらかがハイフンであれば その上下の値を持ってきて平均値を出すことが出来ますが ハイフンが3つ以上続くと、結局計算が出来ずエラーが出てしまいます。 この場合、上ないし下方向に、ハイフンを除く数値データがあるセルまで参照先を広げるような よい方法はないでしょうか。 業務で使用するファイルのため 具体的なコードを記述できず、分かりづらい点が多々あるかと思います。 また、記載しているコードももしかすると間違いがあるかもしれません。 申し訳ございませんが、ご助力をお願いいたします。
VBAのLine inputステートメントについて 会社で利用しているエクセルマクロの理解を進めようと、コードを読んでいるのですがLine inputステートメントの記述箇所で疑問があります。 ググってみると、「テキストファイルを１行ずつ読み込む。最終行まで順に読み込む際は do loopなど繰り返し命令を使用する。」などなど説明がありますが、実際の動作と違っています。 下記の記述で全行を読み込み、カンマ区切りでtmpへ格納されます。 なお、配列数は８５０程になります。 Line Input #FileNum, temp(0) ' 1行読込 Line Input temp(0) = Replace(temp(0), vbLf, ",") '改行 Chr(10) 置き換え temp(0) = Replace(temp(0), " ", "") '空白置き換え tmp = Split(temp(0), ",") 'カンマ区切りで配列に格納 temp(1) = UBound(tmp) '配列数 なぜこれだけで全行読み込めるのでしょうか？
Dirでファイル名一覧と別セルにそのファイルの更新日を表示させる方法 画像のようにしたいと考えています。現在は更新日の列はなく、ファイル名だけ表示 させているのですが、更新日を追加しようと思うのですが、うまくいきません。 以下の構文で表示させているのですが、FileDatetimeの使い方がいまいちわかりません。 Sub List() Dim r As Long, c As Integer, FPath As String, FName As String Range("A3:D1000").Clear Application.ScreenUpdating = False r = 3 For c = 1 To 6 FPath = "C:\aaaa\bbbb\cccc\" & Cells(2, c).Value & "\" ' FName = Dir$(FPath & "\*.xlsm*") ' Do While FName <> "" Cells(r, c).Value = FName ActiveSheet.Hyperlinks.Add Anchor:=Cells(r, c), _ Address:=FPath & FName, TextToDisplay:=Cells(r, c).Value r = r + 1 FName = Dir$ Loop r = 3 Next Application.ScreenUpdating = True End Sub よろしくおねがいします。 利用環境：windows7 excel2010
Visual Basicで1～50までの数をランダムに生成したい。 Visual Basicでボタンを押すと、1～50までのランダムな数字をセル（1,1）に表示したいのです。そのときボタンを50回押し終わるまで数字は重複しないようにしたいのですがやり方が分かりません。 1回押すたびに数字が表示され、もう一度押すまで表示は変わらないでほしいです。 よろしくお願いします。
Ipadの問診で生成されたCSVがあります。 そのデータは１つの設問毎が１行になるようにレイアウトされています。（E列が患者ID、I列が設問ID(74種類)、N列が設問文、P列が回答となり、同じ患者さんの各々の設問データが合計２２行から３０行と並んでいます。） 合計４９３１３行になっています。 これを患者さんごとに１行にならびかえ、その横列に設問IDごとに自動で並べ変えるマクロを組もうとしています。 E列の患者IDが＝ならば、I列の設問IDを参照して、別シートの同じ設問IDの所に P列の回答を入力する 次に下の行に行き、同じ処理を繰り返す。 もしも、患者ID＜＞ならば、E列からH列までを別シートの一段下の行A列〜D列に入力し、 I列設問IDを参照し、別シートの設問IDと同じ場所にP列の回答を入力 したいと考えています。 条件付けが難しい上あまりに数が多いので途方に暮れております。 ご教授頂けますと幸いです。 Sub 振り分け() Dim PatientID As String Dim GroupID As Long Dim gyo Dim retsu For i 2 to 49313 よろしくお願いします。 環境はExcel 2007 for Macです。
エクセル関数が得意な方、教えてください。 バージョン：2013エクセル。入力BOXに住所の地番より前を入力したとき、検索テーブルから一致する日数を結果として表示したいです。判定例としては、①完全一致②ワイルドカードを含めて完全一致③1列目に完全一致するが、2列目に一致するものがない場合があります。※画像参照。 エクセルが得意な方、ご教授よろしくお願い致します。
Excelにお詳しい方に質問です。 Sheet1のA3セル、B3セル、C3セル、D3セルに、何らかの文章が入力されているとします。G3セルにはボタン (フォームコントロール) が入っています。 G3セルのボタンをクリックすると、A3セル、B3セル、C3セル、D3セルに入力されていた文章が、自動でSheet2の「A列、A3セル以降で最上部のセル (空白セルの防止です。上から順々に敷き詰められるようにしたい)」「B列、B3セル以下同文」「C列、C3セル以下同文」「D列、D3セル以下同文」に反映されるようにしたいです。 またsheet1のシート名は「見積もり管理表」で、sheet2のシート名は「工事予定表」です。 ボタンでの実現が厳しければ、代わりに「◯」でも構いません。 どのようなコードを組めば、これを実現出来ますでしょうか‥‥質問が下手で、申し訳ありません汗。 大変お手数をおかけしますが、どなたかご教示頂けると幸いです。
Excelにお詳しい方に質問です。 Sheet1のA3セルに、何らかの文章が入力されているとします。 B3セルにはチェックボックスが入っています。 B3セルのチェックボックスにチェックを入れると、A3セルに入力されていた文章が、自動でSheet2の「A列、A3セル以降で最上部のセル (空白セルの防止です。上から順々に敷き詰められるようにしたい)」に反映されるようにしたいです。 チェックボックスでの実現が厳しければ、代わりに「◯」でも構いません。 どのような関数を組めば、これを実現出来ますでしょうか‥‥質問が下手で、申し訳ありません汗。 大変お手数をおかけしますが、どなたかご教示頂けると幸いです。
VBA 結合セルに連番をふる方法 Excel 2013 VBA勉強中です。結合セルに連番をふる方法を教えてください。 ①A6セル以降は2行ずつセル結合 ②B6セル以降は単独セルで各セルに値あり の場合、B列の値があるまで、A列に連番をふりたいと思います。 最終行は毎回バラバラで、以下のように組んでみたのですが、「2•4•6•••」のように偶数番号のみが振られてしまいます。 「1•2•3•••」のように連番をふるにはどのようにすればいいでしょうか。 また、その際に、「001•002•003•••」と3桁の番号にするにはどのようにすればいいでしょうか。 教えていただけると助かります。 ↓↓↓ Sub test1() Dim i As Long Application.ScreenUpdating = False For i = 6 To Cells(Rows.Count, "B").End(xlUp).Row If Cells(i, "B") <> "" Then Cells(i, "A") = i - 4 Next Application.ScreenUpdating = True End Sub
VBA Likeで変数を使った検索 シートを複数選択させるマクロを作っているのですが 「型が一致しません」のコンパイルエラーに悩まされています。複数シートがある中でシート名に「P0～P9」を含むシートを 同時に選択したいと考えています。 以下のコードで実行してみましたがうまくいきません。 ----------------------------------------------------------------------- Sub 選択() Dim ws As Worksheet Dim x(9) As Variant For Each ws In Worksheets If ws.Name Like "P" & x & "*" Then If ActiveSheet.Name Like "P" & x & "*" Then ws.Select (False) Else ws.Select End If End If Next End Sub --------------------------------------------------------------------------- 変数を使えたほうが便利かと思い挑戦してみたものの 行き詰まってしまいました。 当方VBA初心者でネットで調べながら作っていますので 初歩的なこともほとんど理解できておりません。 こんな質問で申し訳ないですがご教授願います。
VBAのバブルソートについて加藤 潔氏の"Excel環境におけるVisual Basicプログラミング(第3版)"の第17章ソートで本にあるバブルソートのサンプルプログラムを入力したのですがうまくプログラムが動きません 具体的にいうと、シート1の(k1, k2)に乱数で生成した数字を書き込むところまでは動くのですが、MsgBoxが表示されたあと｢インデックスが有効範囲にありませんと表示されデバッグすると"Worksheets(ns).Cells(k2, k1) = a(k)"のところにマーカーが引かれます また、ソートもうまく動いていないようです どこが間違っているかお教えいただけますか 以下サンプルプログラム(エディタからコピペしました) ――――――――――――――――――――――――――――――――― Option Explicit Sub sort() Dim a() As Integer Dim n As Integer Dim s As String n = InputBox("ソートする数の個数") ReDim a(n) ready n, a yomikaki 0, 1, n, a s = Time sortB n, a s = s & "->" & Time MsgBox "経過時間(バブル) " & s yomikaki 1, 2, n, a End Sub 'バブルソート Sub sortB(n As Integer, ByRef a() As Integer) Dim k As Integer Dim ok As Boolean Do ok = True For k = 1 To n - 1 If a(k) > a(k + 1) Then swap a(k), a(k + 1) ok = False End If Next k Loop Until ok End Sub '乱数を生成し、シート1に書き込む Sub ready(n As Integer, a() As Integer) Const saidai As Integer = 10000 Dim k As Integer Randomize For k = 1 To n a(k) = Int(Rnd * saidai) Next k yomikaki 1, 1, n, a End Sub 'ワークシートと配列の間でデータの読み書きをする Sub yomikaki(m As Integer, ns As Integer, n As Integer, a() As Integer) Dim k As Integer, k1 As Integer, k2 As Integer Const haba As Integer = 10 k1 = 1 k2 = 1 For k = 1 To n If m = 0 Then a(k) = Worksheets(ns).Cells(k2, k1) Else Worksheets(ns).Cells(k2, k1) = a(k) End If k1 = k1 + 1 If k1 > haba Then k2 = k2 + 1 k1 = 1 End If Next k End Sub '2つの引数の値を交換する Sub swap(ByRef x As Integer, ByRef y As Integer) Dim z As Integer z = x x = y y = z End Sub ――――――――――――――――――――――――――――――――― 知恵袋ではインデントが無効になるみたいです 見づらくて申し訳ないですがよろしくお願いします
VBA シートに連番を打ち、尚並び替えを行うマクロ 表題の通り、Excel2016にてVBAを使用して複数あるシートに連番を打つマクロを作成しています。連番は「P01,P02,P03…」のような形式で表示させるものです。 以下そのコードになります。 ------------------------------------------------------- Sub 連番() Dim n As Integer Dim 文字連番 As String Dim i As Long Dim a As Long Dim shname As String ThisWorkbook.Sheets("作業").Move after:=Sheets(Sheets.Count) For i = 1 To Sheets.Count - 1 shname = Sheets(i).Name If shname = ("素材") Then Sheets("素材").Move before:=Sheets("作業") GoTo Continue ElseIf shname = ("原紙") Then On Error GoTo Continue Sheets("原紙").Move before:=Sheets("素材") GoTo Continue Else 文字連番 = Mid(i + 100, 2) Sheets(i).Name = "P" + 文字連番 End If Next i Continue: End Sub ---------------------------------------------------------------------- 当方、VBAには全く触れたことがなく、今回初めて作成するために ネットで様々なものを読みながら繋ぎ合わせたようなコードになってしまっています。 ここで本題に入りますが、最初は連番のみ打てればと思っていたのですが シートの並び替えも一緒に出来たらいいなと思いました。 イメージとしては複数シートがある中、「素材」「原紙」「作業」というシートはあらかじめ存在するシートで、その中でも「作業」シートは必ず存在します。（「素材」「原紙」シートは存在したり存在しなかったりします） その他に、「01」「02」や「3」「4」「005」など統一されていないシート名が複数あるとします。 これを左から順に「P01,P02,P03,,,」と統一し、最後に「素材」「原紙」「作業」と並ぶようにしたいと考えています。 マクロの実行は最後尾のシートである「作業」にボタンを配置してそこから実行させています。 ところが、上記のコードでは1度ボタンを押して実行した時点では並び替えのみされて もう1度実行させると連番を打つという結果になってしまいました。 1度の実行で並び替え、連番まで終えるためにはどうしたらよいのでしょうか。
C# calendar お世話になってます。現在visual studioを使用してアプリを作っているのですが カレンダーのコントロールを使用して 任意の日付だけに色を付けたいと考えています。 カレンダーのBackgroundでは全体が変わってしまいますし、 CalendarDayButtonStyleを使用すると全ての日付が変わってしまうので 任意の日付だけ変化させる方法をご教授いただけたらと思います。 宜しくお願いします。
VBSでテキストファイルを1文字ずつ読み込んで10文字目の文字をメッセージボックスに表示することはできますか？
二つのエクセルファイルを開いて、 データを転記していく構文を作りましたが上手く動いてくれません。 どこがおかしいのかわかりませんので教えてください。Sub データ転記() Application.ScreenUpdating = False '文字列を格納する。 Dim c As Long Dim z As Long Dim u As Long Dim v As Long 'ループ用 Dim a As Long '行を認識させる。 a = 2000 'Do～Loopまでの処理を繰り返す。 Do Until a = 0 Dim x As Range '品番名を選択する。 Dim t As Range '列番号を格納する。 Dim y As Range 'シリアル値へ変換した日付を取得する。 c = Range("A" & a).Value2 'ブックを切り替える。 ActiveWindow.ActivateNext '指定範囲の検索を実行する。 '(検索が出来なければ終了) Set x = Range("N3:AR3").Find(What:=c) If x Is Nothing Then MsgBox "見つかりません" Exit Sub Else x.Offset(-1, 0).Select u = ActiveCell '品番名を格納する。 ActiveWindow.ActivateNext z = Range("C" & a).Value 'ブックを切り替える。 ActiveWindow.ActivateNext '指定範囲の検索を実行する。 '(検索が出来なければ終了) Set t = Range("E3:E679").Find(What:=z) t.Offset(0, u).Select ActiveCell.Offset(2, 0).Select 'ブックを切り替える。 ActiveWindow.ActivateNext v = Range("K" & a) 'ブックを切り替える。 ActiveWindow.ActivateNext ActiveCell.Value = v 'データが無い場合は終了する。 If x Is Nothing Then Exit Sub Else End If End If '-1行を認識させる。 a = a - 1 Loop Application.ScreenUpdating = True End Sub
ユーザーフォームにdateで取得した日付を自動表示し、そのほかに手入力した項目とともに、データの登録をしています。登録後に同日の日付のデータだけを抽出して印刷したいのですが、日付の比較がうまくいきません。どんな原因が考えられるでしょうか
エクセルのVBAについて質問です。マクロ初心者というか全くわからないのですが、 どうしても仕事で緊急に必要で調べています。 以下の様なファイルがあります。行は膨大で3000行以上あり、会社ごとに別のエクセルファイルにしていく必要があります。会社ごとにエクセルをメールで送り確認したいことがあるのです。 例） A B C D E …… 検収可不可 会社コード 会社名 金額 発注開始 発注終了…… （空欄） 1234 ○☓商事 100 5/20 5/25…… エクセルファイルにする方法については以下のページで調べたのですが、 別のエクセルファイルにするときに、A列はタイトル（例でいうと、検収可不可）のみ入っており、 ファイルを送る会社様に入力していただく必要があるので空欄になっているのです。 しかし、何度やっても動かないため、もしやとおもって、 A列に文字を入力して動かしてみたらきちんとファイルが生成されました。 空白のスペースを入れたら確かに動くのですが、 会社様がファイルをあけたときに変なところで入力が開始されてしまうので避けたいのです。。。 以下のページで知ったコードはあくまでA列に入力がある場合のみのようなのですが、 どうにかA列にタイトルだけ文字がはいっていて、それ以降セルに入力がなくても動くようなコードを教えていただけませんでしょうか。本当は下記の件を投稿されていた方に再度質問させていただき、ベストアンサーにしたいところなのですが、OKWaveが登録できない状態みたいで、、、申し訳ありません。どうぞよろしくお願いいたします。 http://netricoh.okwave.jp/qa9024498.html sub macro1() dim w as worksheet dim n as long dim r as long dim s as string dim WSH as variant dim myPath as string set w = activesheet n = worksheets.count on error goto errhandle for r = 2 to w.range("A65536").end(xlup).row s = w.cells(r, "A") & "_" & w.cells(r, "B") w.rows(r).copy worksheets(s).range("A65536").end(xlup).offset(1) next r on error goto 0 set wsh = createobject("Wscript.Shell") mypath = wsh.specialfolders("Desktop") & "\" for r = worksheets.count to n + 1 step -1 worksheets(worksheets.count).copy activesheet.columns.autofit activeworkbook.saveas filename:=mypath & activesheet.name activeworkbook.close false application.displayalerts = false worksheets(worksheets.count).delete application.displayalerts = true next r w.select exit sub errhandle: worksheets.add after:=worksheets(worksheets.count) activesheet.name = s w.rows(1).copy range("A1") resume end sub
VBAの処理 複数階層で複数のフォルダ内にEXCEL.WORD.PPTが格納されています。 VBAを使用して格納フォルダ、ブック名、シート名の一覧表を作成したいです。WORDとPPTはシート名がないのでWORDとPPTは格納フォルダ、ブック名で大丈夫です。 詳しい方、助けていただけると助かります。
（Excel2010） VBAについて すべてのマクロを停止するコマンドをご教示ください ※初心者なので用語が適切でない点はご容赦 たとえば sub A() ・・・・if 条件 then Exit sub End if ・・・・ End sub ならば Exit subを使うと停止できることはわかります。 ですが sub B() call A ・・・ End sub のように sub B 内に sub Aを入れ子にしたとき、 sub A内の条件に合致したとき、sub Aのみではなく sub Bのマクロ（？）も止めたいのです。 よろしくお願いします。
エクセルでファイルを開くと、全てのシートが自動で改ページプレビュー表示になるようにするにはどうしたらいいですか？
先日、マクロで質問したものです。 http://m.chiebukuro.yahoo.co.jp/detail/q14159970669 回避コードで、その部分にエラーは出なくなりました。ありがとうございました。 また…別の問題です。 まず、13ファイルあるが、途中でコピーが止まり、3ファイルで終了してしまいます。 又、コピーが終わると、そのファイルを閉じると言うWB.close部分がデバックが出てしまう… もうどうしたらよいか分かりません… お願いします。ファイルは開きっぱなしでも良いのですが、同じ形のファイルが、13ファイルのうち、3ファイルしか統合できないのが、問題です。 ちなみに1ファイル、2000行でAAの列まで文字が入ってます。しかし、所々空欄です。 13ファイルで23400行ぐらいになります… 多すぎるのでしょうか。ファイル名は、 13ファイルすべて、人の名前です。 教えてください。お願いします。
VB.NET ComboBoxの選択肢に無い項目を直接テキスト入力されるのを禁止する方法 例えば、性別を入力するComboBoxのItemsに"男性"と"女性"が設定されているとします。このComboBoxに、"男性"と"女性"以外の値が直接テキスト入力されると困ります。 オートコンプリートを使用したいので、ドロップダウンリストにすることもできません。 前述以外の値が入力された際に、テキストを空白にする方法はありますか？ よろしくお願いします。
VB.NET 入力文字が移動しないようにしたい 3個のテキストボックスA,B,Cを、 プロパティでテキストボックスAとCのImeModeをOffに、テキストボックスBのImeModeをHiraganaに設定してあるフォームがあります。 テキストボックスBにフォーカスを当て文字入力すると、 ImeModeをHiraganaに設定してあるため、ひらがなで入力されます。 しかし入力が未確定(下線がついている状態)で、 テキストボックスA,Cをクリックしてフォーカスを当てると テキストボックスBで入力中の文字が確定せずそのまま移動してしまいます。 テキストボックスBで入力が未確定の時に、 テキストボックスA,Cをクリックしてフォーカスを移した際に テキストボックスBでの入力を取り消してフォーカスを移動させる方法はありますでしょうか。 よろしくお願いします。
アクセス2013に関する質問です。 度々の質問すみません。 ”メイン”フォームで入力した内容を”検査結果”テーブルの各項目（レコード）に代入するようにしております。入力する項目が多いので、オプショングループボタンで ”異常なし”を選択した場合はそのまま当該データは入力を完了して次のテーブル行に移動し、 ”異常有り”を選択した場合は、異常内容を入力する”検査結果”入力フォームが開くようにしようと思っております。 しかしながら上記オプションボタンでデータが更新され、別の”検査結果”入力フォームを開く際にテーブルが新規入力となり、"検査内容結果"フォームで入力した内容は次の行のデータに代入されてしまいます。 私が考えるのは”検査内容結果”フォームに入力した内容が前の行のレコード（各フィールド）に代入されれば良いかと考えておりますが、具体的な方策が解りません。 この考え方が正しいかも判りません。 どなたかご教示頂けませんでしょうか？
アクセス2013に関する質問です。 度々の質問すみません。 ”メイン”フォームで入力した内容を”検査結果”テーブルの各項目（レコード）に代入するようにしております。入力する項目が多いので、オプショングループボタンで ”異常なし”を選択した場合はそのまま当該データは入力を完了して次のテーブル行に移動し、 ”異常有り”を選択した場合は、異常内容を入力する”検査結果”入力フォームが開くようにしようと思っております。 しかしながら上記オプションボタンでデータが更新され、別の”検査結果”入力フォームを開く際にテーブルが新規入力となり、"検査内容結果"フォームで入力した内容は次の行のデータに代入されてしまいます。 私が考えるのは”検査内容結果”フォームに入力した内容が前の行のレコード（各フィールド）に代入されれば良いかと考えておりますが、具体的な方策が解りません。 この考え方が正しいかも判りません。 どなたかご教示頂けませんでしょうか？
アクセスのオプションボタンとテキストBOXの連動について質問します。例えば オプションボタンで １ 開封検査 ２ 外観検査 ３ 開封・外観検査 ４ 検査無し と言ったものを作成し、 ”１ 開封検査”を選択した場合は テキストBOXの開封検査の入力欄のみ入力可能になり、 ”３ 開封・外観検査”を選択した場合は 開封検査と外観検査の両方が入力可能になり、 ”４ 検査無し”を選択した場合は両方とも入力不可になる・・・ と言ったような設定はどの様にすればよろしいのでしょうか？ また、上記をコンボボックスで行った場合の設定方法についてもお教え頂けませんでしょうか？ どなたかお助けください。
VB.NETのコンボボックスについて2つ質問があります。1： コンボボックスにフォーカスが当たっている時に上下方向キーで項目を変更でき、 最初の項目が選ばれている時に上キーを押すと、TabIndexがコンボボックスの直前にあるもの(テキストボックスなど)にフォーカスが移動し、 最後の項目が選ばれている時に下キーを押すと、TabIndexがコンボボックスの直後にあるものにフォーカスが移動できるようにする方法はありますでしょうか。 2： コンボボックスのプロパティでSelectionMarginに当たるものはありますでしょうか。 よろしくお願いします。
VBAのUserForm_QueryCloseと、UserForm_Terminateの違いを教えてください。(なんとなく、両方ともUserFormを閉じるときにイベントが発生するのかなぁ・・・という、漠然としたイメージしかなく、どんな違いがあるのか分かりません。) よろしくお願いします。
VBAの実に初歩的な疑問なのですがByRefがうまく返りません。 本当は２が返るはずなのですが、VBAがおかしいのでしょうか？Sub test() Dim a As Long a = 1 subtest1 (a) Debug.Print a ' 1が返る End Sub Sub subtest(ByRef a As Long) a = a + 1 End Sub
vb2010でエクセルを操作して散布図を作製しています。 グラフ系列を設定する際に下記記述にすると、プロセスにExcel.exeが残ってしまうのですが、どういった記述が正しいのでしょうか。プログラムを閉じるとプロセスからExcel.exeは消えます。また、With内をコメントアウトするとプロセスは残らないことは確認しています。 Dim xlCharts As Excel.ChartObjects Dim xlChart As Excel.ChartObject Dim xlChart1 As Excel.Chart Dim series As Excel.Series xlCharts = DirectCast(xlSheet.ChartObjects, Excel.ChartObjects) xlChart1 = xlChart.Chart With xlChart1 series = .SeriesCollection(1) series.Format.Line.Weight = Me.TextBox11.Text series.Border.Color = ColorTranslator.ToOle(Color.Blue) MRComObject(series) END With
一覧表から検索するマクロです。 セルC1に入力した文字を含むセルをあいまい検索しています。下記のコードで検索はできますが、例えば「新宿」というワードで検索すると 表には「新宿本店」「新宿西口店」など、候補が複数あります。 現在、一番上にある「新宿」を含むセルにカーソルが移動しますが 次の候補へカーソル移動するにはどのようにしたらいいですか？ Sub 角丸四角形3_Click() Dim result As Range Set result = Range("B4:B300").Find(What:=Range("C1").Value, LookAt:=xlPart) If result Is Nothing = False Then result.Select Else MsgBox "該当データがありません！" Exit Sub End If End Sub
Excel VBAで If Date > 42523 Then の42523(2016/6/2)をシリアル値ではなくて人間が見てわかる日付の形式にするにはどう書けばいいですか？
Excel VBAで教えてくださいm(__)m ActiveSheet.Copy After:=ActiveSheet ActiveSheet.SelectActiveSheet.Name = Range("Y1") & ("月分") Range("A2:E3") = "" End Sub このコードで、最後の ’Range("A2:E3") = "" ですが、コピーする前のシートが空白になってしまいます。 新しく作ったコピーされた方のシートを空白したい場合どのようなコードが正しいでしょか？
このvisualbasicのコードの説明ができませんすみませんが1列1列説明を詳しく教えてください
数独・ナンプレで、次の一手を表示させるVBAのプログラム分かる人いませんか？？Nice Loopあたりまで解析できるソルバーみたいなものを作りたいです。 ネットで落ちているものはあまり良いものがなかったし、すぐ仮置きして解くようなプログラムばかり(笑)だったので質問させていただきました。
エクセル関数に関する質問です。VLOOKUP(DATEDIF(RC[-7],R[-33]C[-10],"y"),Seet2!R3C2:R55C4,3,FALSE) のR[-33]C[-10]（基準となる日付が入っています）を固定して計算させたい場合どのようにしたら良いでしょうか？ A1を$A$1にするとそのセルだけ固定される方法は知っているのですが、検索でRC[ ]は括弧を消す...ようなことは分かったのですが、実際R[-33]C[-10]の括弧を外してもエラーになってしまいました。 他の人が作成した表で、もともとはTODAY()が入力されていたのですが、基準日を固定させる必要があり、やり方が分からず困っています。宜しくお願い致します。
Visual Basicのピクチャーボックス背景色に関する質問です。windows7の環境でVisual Basic2010のアプリケーションを作成しました。ビルドを実行し.exeファイルを作成、windows XPのPCにインストールし動かしてみると、本来黒色のはずのピクチャーボックスの背景色が白色になってしまいます。原因と対策を教えてください。
Hyoe0919文字列の最後尾に並んPublic resultRowNum As Integer Private Function Search_0(searchStr As String, sheetOjbFrom As Worksheet, toSheetObject As Worksheet) As Integer Dim lngYLine As Long Dim intXLine As Integer Dim Obj As Object ' Set Obj = sheetOjbFrom.Cells.Find(searchStr, lookat:=xlWhole) ' If Obj Is Nothing Then ' MsgBox "りんごは見つかりませんでした。" ' Else ' lngYLine = sheetOjbFrom.Cells.Find("りんご", lookat:=xlWhole).Row Dim c As Range Dim firstAddress As String Set c = sheetOjbFrom.Cells.Find(searchStr, LookIn:=xlValues, lookat:=xlPart) If Not c Is Nothing Then firstAddress = c.Address Do lngYLine = c.Row intXLine = c.Column 'MsgBox "りんごは、" + CStr(lngYLine) + "行目の" + CStr(intXLine) + "列目にあります" sheetOjbFrom.Cells(lngYLine, 1).EntireRow.Copy Destination:=toSheetObject.Rows(resultRowNum) resultRowNum = resultRowNum + 1 'Print #1, ws.Cells(i, 1).Value Set c = sheetOjbFrom.Cells.FindNext(c) Loop While Not c Is Nothing And c.Address <> firstAddress End If Search_0 = 0 End Function Sub Search() Dim findKey(2) As String Dim searchFoldPath As String Dim searchFileName As String Dim intResult As Integer Dim sheetCnt As Integer Dim copyTofold As String Dim copyToFileName As String findKey(0) = "りんご" findKey(1) = "ばなな" searchFoldPath = "C:\test\" searchFileName = Dir(searchFoldPath & "*.xls*") copyTofold = "C:\cpto\" copyToFileName = "result.xlsx" Dim wb As Workbook Dim copyToWb As Workbook Dim i As Integer Dim j As Integer resultRowNum = 1 Set copyToWb = Workbooks.Open(copyTofold & copyToFileName) Do While searchFileName <> "" If searchFileName <> ThisWorkbook.Name Then Set wb = Workbooks.Open(searchFoldPath & searchFileName) wb.Activate MsgBox wb.Worksheets.Count sheetCnt = wb.Worksheets.Count For i = 1 To sheetCnt For j = 0 To 2 wb.Worksheets(i).Activate intResult = Search_0(findKey(j), wb.Worksheets(i), copyToWb.Worksheets(1)) Next Next wb.Close (False) End If searchFileName = Dir() MsgBox searchFileName Loop copyToWb.Close (True) 'Dim searchStr As String 'Dim sheetOjbCopyFrom As Worksheet 'Dim sheetOjbCopyTo As Worksheet 'searchStr = "りんご" 'Set sheetOjbCopyFrom = Worksheets("sheet4") ' Set sheetOjbCopyTo = Worksheets("sheet3") ' intResult = Search_0(searchStr, sheetOjbCopyFrom, sheetOjbCopyTo) End Sub
Public resultRowNum As IntegerPrivate Function Search_0(searchStr As String, sheetOjbFrom As Worksheet, toSheetObject As Worksheet) As Integer Dim lngYLine As Long Dim intXLine As Integer Dim Obj As Object ' Set Obj = sheetOjbFrom.Cells.Find(searchStr, lookat:=xlWhole) ' If Obj Is Nothing Then ' MsgBox "りんごは見つかりませんでした。" ' Else ' lngYLine = sheetOjbFrom.Cells.Find("りんご", lookat:=xlWhole).Row Dim c As Range Dim firstAddress As String Set c = sheetOjbFrom.Cells.Find(searchStr, LookIn:=xlValues, lookat:=xlPart) If Not c Is Nothing Then firstAddress = c.Address Do lngYLine = c.Row intXLine = c.Column MsgBox "りんごは、" + CStr(lngYLine) + "行目の" _ + CStr(intXLine) + "列目にあります" sheetOjbFrom.Cells(lngYLine, 1).EntireRow.Copy Destination:=toSheetObject.Rows(resultRowNum) resultRowNum = resultRowNum + 1 Set c = sheetOjbFrom.Cells.FindNext(c) Loop While Not c Is Nothing And c.Address <> firstAddress End If Search_0 = 0 End Function Sub Search() Dim findKey(2) As String Dim searchFoldPath As String Dim searchFileName As String Dim intResult As Integer Dim copyTofold As String Dim copyToFileName As String findKey(0) = "りんご" findKey(1) = "ばなな" searchFoldPath = "C:\test\" searchFileName = Dir(searchFoldPath & "*.xls*") copyTofold = "C:\cpto\" copyToFileName = "result.xlsx" Dim wb As Workbook Dim copyToWb As Workbook Dim i As Integer Dim j As Integer resultRowNum = 1 Set copyToWb = Workbooks.Open(copyTofold & copyToFileName) Do While searchFileName <> "" Set wb = Workbooks.Open(searchFoldPath & searchFileName) For i = 1 To wb.Worksheets.Count For j = 0 To UBound(findKey) - LBound(findKey) + 1 intResult = Search_0(findKey(j), wb.Worksheets(i), copyToWb.Worksheets(1)) Next Next wb.Close (False) searchFileName = Dir() Loop copyToWb.Close (True) 'Dim searchStr As String 'Dim sheetOjbCopyFrom As Worksheet 'Dim sheetOjbCopyTo As Worksheet 'searchStr = "りんご" 'Set sheetOjbCopyFrom = Worksheets("sheet4") ' Set sheetOjbCopyTo = Worksheets("sheet3") ' intResult = Search_0(searchStr, sheetOjbCopyFrom, sheetOjbCopyTo) End Sub
VB.NETについて いまテキストボックス2つに数字を入力し、+、-、×、÷、POWボタンをおして計算できる電卓を作っているのですが、どちらか片方に数字が未入力の場合"数字が入力されていません"とメッセージボックスで表示するのですが、その出し方がわかりません。 どう処理すればメッセージボックスに表示されますでしょうか？ また、POWで^を使わず、繰り返し処理で累乗を行わなければいけないのですが、その処理も教えていただきたいです。
このvisualbasicのコードですが一列一列説明してくださいお願いします
【エクセル】当番表の作成について みだしの件について、質問します。 エクセルで当番表を作成しているのですが、一か月分手動で名前を入力するのが面倒くさくなりました。なので、ボタンワンクリックで全て自動入力できるようなマクロの構文を教えていただけないでしょうか。 表のイメージは、以下のとおりです。 ----------------------------------------------- □□□□Ａ Ｂ Ｃ Ｄ Ｅ ・・・・・・・ １（月） ２（火） ３（水） ・ ・ ・ ・ ----------------------------------------------- 人数が１５人ほどで、「同じ人が同じ日にＡにもＢにも入っている」といった状況は避けたいです。 ちなみ、当方マクロを触ったことはありません。（マクロ以外ならなんでもできます。） これを機に、マクロに初挑戦してみたいとも思っています。 なにとぞ、よろしくしくお願いします。
複数のエクセルbookを一つのbookにまとめたい 関連質問が多数あるのですが、ズバリこれ！というものが見つからないので、再質問します。 エクセルのVBAに関する質問です。VBAを今学んでいる最中なのですが、仕事でどうしても急いで以下の作業をしなければならなくてじっくり考える時間がありません。ご教授いただければと思います。 複数のbook（列の項目は同じ、sheet１にのみデータが入っている）を新たなbookにまとめて 一つにしたいと思っております。 各bookの行数はbookによって異なります。 かなり前の関連質問だとエクセル2007より前のものでしょうか、65536行まで対応という ようなコードになっているものなので、データ入力されている最終行をすべてコピーしてあらたなbookへまとめるというものにしたいです。
VBA勉強中の者です。下記の様な文字化けしたデータを一括で直したいです。 文字化け 42499 42433 42666 5月16日 2月3日 11月8日 ↓ 5/9 3/4 10/23 5/16 2/3 11/8 この様に変更したいです。 現在、この様に直すのに、セル書式の設定→表示形式→日付→2016/5/9選択 2016/削除→「'」を付けて→'5/9完成 上記の流れで作業しています。 セルを選択した時に2016/は表示させたくなくてこの様なやり方をしています。 表の中の何処で文字化けしているかは分かりません。なので、シート全体の中で42から始まる5桁の数字と月日が入ったセルを見つけて5/9の形に持っていきたいです。 表中のセルには、上記の他に、2桁・3桁の整数や、13×12といった文字が入っています。ですので上記のような方法がいいかなと思っています。 表は7000行の44列と膨大なものになります。 ご教授お願いいたします。
担当者ごとにブックを作成するマクロをご教授ください。 ブックAとブックBがあります。 このブックAの3番目のシートに担当表が作成されています。 担当表というのは、A列3行目以下:識別コード(数字4桁)、B列3行目以下:担当者名が入力されていて、1担当者あたりに識別コードは多数あります。 ブックBは識別コードごとにシート分けられています。(シート名は識別コードです) ブックAのシート1よりマクロを実行して(マクロボタンを作成します)、ブックBを選択ダイアログで選択し、そのブックBを担当者ごとの別ブックに分けたいです。 作成したブックはデスクトップに年月日のフォルダを作成し、その中に担当者名＋様分というブックを保存というかんじにしたいです。 識別コードが多数あるので、マクロで行いたいです。 よろしくお願いします。
Excel VBAにて以下の処理を行うプログラムが組めず、困っています。■やろうとしていること ・日付順に並び替える ・今日から2週間以内の日付を残してそれ以外を消去 の二点の作業を行おうと思っています。 ■使用シーン 『毎日更新されたデータがExcelファイルで届く。そのうち今日から二週間以内のデータのみを 取り出して閲覧したい。 考えている形式は閲覧用のファイルを作り、Sheet1に新しく届いたデータを貼り付け、 VBAを走らせて一発で「今日から二週間以内のデータを日付順に」閲覧できるファイル』 ■VBAの実施に使っているダミーデータ(練習用データ) Sheet１ 項目 実施日 参加人数 遠足 20160405 24 夏祭り 20160730 20 林間学校 20160520 25 臨海学校 20160831 18 運動会 20160920 22 学園祭 20161105 29 Sheet2 Today関数 Today数値化 計算に使用する数値 2016/6/1 42522 20160601(=B2(42522)+20118079) ■組んだプログラム Sub Macro1() ActiveWorkbook.Worksheets("Sheet1").Sort.SortFields.Clear ActiveWorkbook.Worksheets("Sheet1").Sort.SortFields.Add Key:=Range("B2"), _ SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal With ActiveWorkbook.Worksheets("Sheet1").Sort .SetRange Range("A2:C10") .Header = xlNo .MatchCase = False .Orientation = xlTopToBottom .SortMethod = xlPinYin .Apply End With If "B2" < Worksheets("Sheets2").Cell("E2") + 14 Then Worksheets("Sheets1").EntireRow Delete Shift:=xlShiftUp End Sub ■起こったエラー 『SubまたはFunctionが定義されていません』と出ます。 並び替えまではうまくいったのですが、IFを入れて行の削除(今日から二週間以内以外を削除)の 部分がうまくいきません。どなたかアドバイスいただけないでしょうか？
VBで作成された集計アプリ、作成者以外が中を見るには？前任者がVBで作成した集計アプリを残して、異動してしまいました。 この集計アプリを使用したデータが欲しいと様々な人からリクエストを受けているのですが、、 使用をするにもメンテナンスができず、どんな条件で集計されていたか見ることすらできず、 困り果てています。 せめて、アプリ内のコードを見て集計条件に見当をつけながら、 他の集計方法でデータの作成をしたいのですが、作成者以外が開いて見ることは可能でしょうか？ 集計アプリは５０万行あるような巨大なデータの塊を集計する仕様です。 自分のスキルは、自作のVBA（excel）で集計の自動化ができる程度です。 異動した方以外にVBが使用できる方は社内にはいません・・・ お知恵をお貸しください。
Excelで使うマクロに関する質問ですが、教えて頂いた事や、検索して探した物を自分で組み合わせて作ってみました。Sub test() Dim rng For Each rng In ActiveCell.Resize(10, 10) Select Case rng.Interior.Color Case RGB(235, 255, 41) rng.Interior.ColorIndex = 38 Case RGB(231, 255, 5) rng.Interior.ColorIndex = 4 Case RGB(239, 255, 83) rng.Interior.ColorIndex = xlNone End Select Next End Sub 左上隅をクリックすると、１０列１０行が選択されます。 実行すると色が変わる予想でしたが、予想が外れました。 上段の Case RGB(235, 255, 41) rng.Interior.ColorIndex = 38 下段の Case RGB(239, 255, 83) rng.Interior.ColorIndex = xlNone この二か所は色が変化しましたが、中段の Case RGB(231, 255, 5) rng.Interior.ColorIndex = 4この個所が変化してくれませんでした。 何故、中段の箇所だけ色が変化しないのでしょうか。 中段の箇所も変化する様にして頂けませんか。２０１０です。 よろしくお願い致します。
vbaについて A1:B2セルをコピーしメモ帳に貼り付けようと思うのですが 型が一致しませんと表示されてしまいます。 どう直せばいいでしょうか。Dim clip As New DataObject clip.SetText Range("A1:B2").Value clip.PutInClipboard ※Range("A1:B2").copyだと余計に改行されてしまうのでこのやり方は、避けたいと思います。 よろしくお願いします。
ExcelのVBAで指定セルのテキストに該当文字が含まれているかどうかを判定したいのですが・・・。 ちなみにExcel2016です。 Sheet1のA1：A10にテキスト文が書かれています。その中に該当する文字（以下のマクロであれば「男」「女」の部分）が含まれているかどうかをB1：B10にそれぞれ返したいのです。 1行だけであれば以下のマクロでできるのですが、 これをA1⇒B1に判定、A2⇒B2に判定・・・・ というようにしたい場合にはどのようにマクロを書けばよいのでしょうか？ ---------------------------------------------------------------- Sub sample() If WorksheetFunction.CountIf(Range("A1"), "*男*") > 0 Then Range("B1").Value = "○" ElseIf WorksheetFunction.CountIf(Range("A1"), "*女*") > 0 Then Range("B1").Value = "○" Else Range("B1").Value = "" End If End Sub ---------------------------------------------------------------- また、可能であればこの文字列を別シートに一覧として作成しておき、 そこから判断させることができるようであればなお良いのですが。 （これであれば、判定する文字が増えても容易に対応可能なので） A 1男 2女 3子供 . . . . 以上、お手すきの時にでも御知恵を拝借いただけますと助かります。
【至急】エクセルでテキストデータを自動読み込み+複数の記号で分割読み込みしたい。 マクロのコードを教えて頂けませんでしょうか？？ テキストデータは、全角:、半角:、タブで区切りがされています。 マクロで、 1.ファイル選択 2.複数の区切り文字でテキストを分割 3.分割したデータをエクセルシートに貼り付け を行いたいです。 結論として、別のシートにある先輩がデザインしたカルテに数字や文字列だけ反映させたいです。 システムが改修されるまでの2週間しか使わないので、データを吐き出したシートからカルテシートへのデータ反映はなんとか数式で対応しようと思っています。 勉強しろ、というお声もあると思いますが、先輩が連日遅くまでコピペでカルテにデータ入力されてることを昨日知り、急いで対応してあげたいです。 当方、マクロはほぼわからない素人なので助けて頂けると有り難いです。 よろしくお願いします(T_T)
visualbasic2015は、vb6に近いのですか？それともvb.netに近いのですか？
エクセルのハイパーリンクについて質問です。 早速例題ですが、 A列に会社名・B列に出発地・C列に到着地 を入力するとします。＿＿＿A＿＿B＿＿C＿＿ １＿A社＿東京＿大阪 ２＿A社＿大阪＿東京 ３＿B社＿沖縄＿福岡 ４＿＿＿以下続く＿＿＿ 各々それぞれにPDFファイルが存在します。 そのファイルへリンクさせることは可能でしょうか？ また、可能な場合は教えていただけますと助かります。 ※必ずしもA1セルにはA社がくるとは限りません。 全部で１００通り以上の組み合わせがあります。 説明不足ではございますが、何卒よろしくお願いします。
エクセル ＶＢＡ ＣＳＶ データ 2つのCSVデータを、ひとつのエクセルに抽出したいです。 また、二つ目のＣＳＶファイル選択時にキャンセルした場合、一つ目に開いたブックは閉じたいです。strFileName = Application.GetOpenFilename(FileFilter:="CSV ファイル (*.csv),*.csv,テキストファイル (*.txt),*.txt", Title:=cnsTITLE) If (strFileName = "False") Then Exit Sub Set wb(1) = Workbooks.Add With ActiveSheet.QueryTables.Add(Connection:="TEXT;" & _ strFileName, _ Destination:=Range("A1")) .AdjustColumnWidth = False .TextFilePlatform = 932 .TextFileCommaDelimiter = True .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _ 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, _ 1, 1, 2, 2, 2, 1, 1, 1, 1, 2, _ 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1) .Refresh .Delete End With strFileName = Application.GetOpenFilename(FileFilter:="CSV ファイル (*.csv),*.csv,テキストファイル (*.txt),*.txt", Title:=cnsTITLE) If (strFileName = "False") Then Exit Sub Set wb(2) = Workbooks.Add With ActiveSheet.QueryTables.Add(Connection:="TEXT;" & _ strFileName, _ Destination:=Range("A1")) .AdjustColumnWidth = False .TextFilePlatform = 932 .TextFileCommaDelimiter = True .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _ 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, _ 1, 1, 2, 2, 2, 1, 1, 1, 1, 2, _ 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1) .Refresh .Delete End With Set ws(1) = wb(1).Sheets("Sheet1") Set ws(2) = wb(2).Sheets("Sheet1") 上記の様な感じで作ってみましたが、うまくいきませんでした。 ふたつのＣＳＶをwb(1)とwb(2)にセットできれば解決します。 良いコードを教えて下さい。 ダイアログで毎回2つのＣＳＶを選択するのも面倒ですが、毎回ファイル名が違うのでそこはあきらめています・・・。 詳しい方、ご教示願います。
【エクセルVBA】のシート並び替えについて。 「ファイルA」の複数のシートを、”顧客一覧(シート)”のB列をベースに並び替えたいと思い下記を入力。（230件ほど顧客名があり、A列は番号が振ってあり番号順に並び替えてある顧客リスト） また、並び替えをしたい「ファイルA」は、”顧客一覧（シート）”リストにない場合もあります。 実行時エラー９ インデックスが有効範囲にありません。 （デバックはSet ws = Sheets(.Cells(i,2).Value)が黄色になるのですが範囲は間違っていないと思うのですが …） と表示されます。 どこが間違って、どう直したらよいのかご教示いただけると助かります。よろしくお願いします(´Д` ) ************** Sub シート並べ替え Dim i As Long With Sheets("顧客一覧") .Hyperlinks.Delete .Move before:=Sheets(1) For i = 2 To .Cells(.Rows.Count, 2).End(xlUp).Row Set ws = Sheets(.Cells(i, 2).Value) ws.Move after:=Sheets(i - 1) On Error GoTo MSG Next i .Activate Exit Sub MSG: MsgBox .Cells(i, 2).Value & "シートが見当たりません。" End With End Sub
アクセスのコンボボックスについて質問です。 複数列に連結したいと思っております。現在 コンボボックス 名前 不良内容コード 列数 3 を作り隣にテキストボックスを２つ配置して テキストボックス１ 名前 不良内容 コントロールソース =[不良内容コード].Column(1) テキストボックス２ 名前 外観・開封区分 コントロールソース =[不良内容コード].Column(2) でそれぞれ２列目、３列目の値を表示できるようにしたのですが、 この２列目と３列目の値を”テーブル１”のそれぞれ別のフィールドに新規レコードとして 代入したいのです。 どの様にすれば良いのか悩んでいます。 どなたかご教示頂けませんでしょうか？
Excelにて 同じ色のセルに同じ数字を入れる方法を教えてください大至急お願いします！
ファイル名を指定しないで保存 CSVファイルに変換して出力を実行していますが 保存先を固定で保存し、かつ同一ブックがある場合は上書き保存するというコードはどのように記述すればいいでしょうか？保存先は￥１１１．１１１．１１１．１１１￥データ csvFile = Application.GetSaveAsFilename(dname & Format(buf, "mmdd") & ".csv", "CSV (*.csv),*.csv") If csvFile = False Then End LastRow = Cells(Rows.Count, 1).End(xlUp).Row LastCol = Cells(1, Columns.Count).End(xlToLeft).Column fileNumber = FreeFile Open csvFile For Output As #fileNumber For Row = 1 To LastRow For Col = 1 To LastCol - 1 Print #fileNumber, Cells(Row, Col) & ","; Next Print #fileNumber, Cells(Row, Col) & "" Next Close fileNumber End Sub
エクセルのマクロによる文字列操作について エクセルのマクロについてご教授お願いいたします。 マクロ初心者です。 A列からBT列までの情報管理ファイルです。 行は最後の行までの処理です。A列には数字が記載されています。 A列の数字が0以外の場合、その行のB列の文字をセル全体から検索し、文字色を赤色にし、B列を基準に文字色赤色が上に来るように並べ替えをするマクロの記述をご教授いただけますでしょうか。 わかりにくい文章で申し訳ございません。 処理の参考画像です。 処理前 http://www.fastpic.jp/images.php?file=2068097103.jpg 処理後 http://www.fastpic.jp/images.php?file=3491041724.jpg
コンボボックスで選択されたものとは別のセルをコピーペーストする方法をお教えて下さい。 タイトルをA列に、その内容をB列に設定しておきます。 コンボボックスにタイトルを追加しておきます。 コンボボックスでタイトルを選択するとC1に内容をコピーペーストしたいです。 ex)コンボボックスにA1を選択すると、C1にB1をコピペ C1内にペーストされた結果は毎回修正するので、修正した際、もとのB列の内容は変わらないようにしたいです。 上記のように実行するコードが分かりません。 コンボボックスを使うのがベストなのかも分からない素人ですがお教えいただけると幸いです。
VBAでうまくいきません。Private Sub Worksheet_Activate() If ActiveSheet.ProtectContents = True Then MsgBox "保護されています。" **Range("K5").Interior.ColorIndex = 3 Else MsgBox "保護されていません。" Range("K5").Interior.ColorIndex = 1 End If End Sub 保護した時には、うまくいくのですが、再度このシートをActiveにしたときに **の行がエラーになってしまいます。。 できれば、Activeになった時ではなく、このworksheetが保護されたときに、セルを赤くしたいのですが、 勉強のため、2通り教えていただけると嬉しいです。 よろしくお願いいたします。
vbaについて A1:B2セルをコピーしメモ帳に貼り付けようと思うのですが 型が一致しませんと表示されてしまいます。 どう直せばいいでしょうか。Dim clip As New DataObject clip.SetText Range("A1:B2").Value clip.PutInClipboard ※Range("A1:B2").copyだと余計に改行されてしまうのでこのやり方は、避けたいと思います。 よろしくお願いします。
R言語に興味があります。For Next等のいわゆる構文を少なくして本題である処理に集中しやすいと聞きます。 エクセルマクロと比べてどうですか？用途はcsvを使ったデータ処理です。平均等の関数も使いますが、主力はvlookup、フィルタリングあるいはグラフや傾向の分析です。データ数は多いです。と言っても1シートに入らない量はまれです。でも使う時は数十枚分ドンと来ます。 エクセルマクロと比べて機能が同等なら、コード作成しやすそうに見えるRを使おうかと思ってます。 どうでしょうか？
Access 処理中に効果音は出せますか？ Access で処理中にドラムロールのような効果音は出せますでしょうか？処理後に結果を表示した時にファンファーレの様な効果音を出すことは 出来ますでしょうか？ プレゼン時に 効果音として出したい と要望されたのですが、 どの様にVBAを書けばいいのかわからず 悩んでおります。 どなたかご教授いただければ 有り難いです。 よろしくお願いいたします。
VBAでのIE操作において「Web ページからのメッセージ」ボックスが表示された場合「はい」をPostMessageでクリックし、メッセージの内容によって分岐処理をしたいと考えています。「Web ページからのメッセージ」ボックスに表示されているメッセージの取得方法を教えてください。
ＰＣの動作環境に対するスペックテストについての質問です。 VB2010 のアプリケーションに .net framework 4.0で動いています。グリッドを使用した画面が３画面あります。 メモリ１ＧＢを積んだＰＣにマカフィーのウイルスソフトを積んでいます。 ＰＣソフトを積んでいない時は、１ＧＢの半分５１２ＭＢぐらいメモリを使用しています。 ソフトを起動すると7割ぐらいメモリを使用します。 スペック的にやはりマカフィーとグリッドを使用している１ＧＢは、厳しい物なのでしょうか？ ソフトの作り方にもよるとは、思いますが… 感想を聞かして下さい！！
Excel VBAで質問です sheet1のセルA1にa001またはa002 同じくsheet1のセルA1にb001またはb002 を入力した時に、 a001,a002だった場合sheet2へ b001,b002だった場合sheet3へ という形で入力したら自動的に行うものを作りたいのですが、初心者が故にうまく行きません どうか教えてください!!
ｸﾗｽﾗｲﾌﾞﾗﾘにてﾒｯｾｰｼﾞﾎﾞｯｸｽの分岐処理がうまくいきません。現在、Visual Studio(作成言語:VIsual Basic)でｸﾗｽﾗｲﾌﾞﾗﾘを参照する ﾌｫｰﾑｱﾌﾟﾘｹｰｼｮﾝを作成しております。 参照するｸﾗｽﾗｲﾌﾞﾗﾘを作成したのですが、 元のﾌｫｰﾑｱﾌﾟﾘｹｰｼｮﾝに戻る記述を設定したところ、 OKﾎﾞﾀﾝを押下する以外に、ｷｬﾝｾﾙﾎﾞﾀﾝや右上の×を押してもｸﾗｽﾗｲﾌﾞﾗﾘが終了してしまいました。 以上のことから質問をさせてください。 １：ｸﾗｽﾗｲﾌﾞﾗﾘでﾒｯｾｰｼﾞﾎﾞｯｸｽの分岐処理(OK,ｷｬﾝｾﾙ,右上の×)を割り当てることは不可能なのでしょうか。 ｿｰｽは以下のようになります。 Private Sub btnEnd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEnd.Click Dim back As Long back = MsgBox("当処理を終了し画面を閉じてよろしいですか", vbOKCancel, "終了処理") Select Case back Case vbOK '閉じる Me.Close() Case vbCancel Return End Select End Sub ご指導ご鞭撻のほどよろしくお願いいたします。
(.NET) Stream の取り扱いについて シークをして読み書きをするクラスのコンストラクタに Position != 0 の Stream が渡された場合、(A) 渡された Stream の Position = 0 を offset = 0 とする (B) 渡された Stream の Position = current を offset = 0 とする (C) 渡された Stream の Position != 0 の場合、Exception を throw する のどれが適当なのでしょうか？
Excel マクロ検索システムについて質問です。 現在、氏名ボタンを押したら、リストボックスにsheet1で入力してあるデータを表示させています。氏名のテキストボックスに田中を入力したら、（田中）の情報が書き出されます。 ここで、佐藤を入力したら、エラーがでず、（鈴木り）の情報が書き出されてしまいます。 リストボックスに名前がのっていない人を入力したらエラーがでる文がわかりません。 分かる方がいたらよろしくお願いします。 添付ファイルのマクロに指摘をお願いします。
VB6.0についてです。シャットダウンを阻止するプログラムを作っています。シャットダウンを検知するとこまでは出来るのですが、それを止めるやり方がわかりません。調べてもわかりませんでした。 VB6.0についてお詳しい方、よろしくお願いします。
エクセルvbaで質問なのですが、配列変数(30)で、1から31までの数字を格納しています。これを指定したエリアに最大6回出現させたいのですが、randomizeだと回数がバラバラでうまくいきません。何かいい方法はないでしょうか？
visual studio コンソールアプリケーション お世話になってます。現在visual studioを使用してアプリケーションの作成などを 行っているのですが、コンソールアプリケーションを 使用する際にコマンドプロンプトではなくPowerShellを 使用したいと思っているのですがやり方が分かりません。 ご存知の方ご教授いただけたら幸いです。 宜しくお願いします。
各シートの同じセルを抽出するやり方を教えてください。 現在シートが1~500まであり、各シートのA1に記入するとそれがシート名に変換されるようVBAを組んでいます。別のシートに一覧をつくりたいのですが、先にINDIRECTをいれておいても、 シート名が変更されるとエラーになります。 各シートの各箇所に記入するたびにシート名が変更になったり、金額、日時などが一覧に飛ぶようにしたいのですが、何かいい案があれば教えて頂きたいです。 VBAも初心者の為シート名のマクロをいれて、このままさらに他のマクロをどう組み合わせればいいのかもわかりません。 どうぞよろしくお願い致します。
VB.NET初心者です。 VB2010を使用しています。適当なクラスを作成し、Stringの配列を引数に持ったメソッドの実装を行い、メソッド内では引数に指定した文字列配列の長さを４倍にした値を出力する。 ボタンクリック時の処理でこのクラスをインスタンス化し、適当な要素を１つ持つ配列を与えてメソッドを呼び出す。 という問題について、配列をどうやって実装すればよいのかわかりません。 Public Class Class1 Public Sub str(ByVal a As String) Dim x As Integer = a.Length - 1 Console.WriteLine(x*4) End Sub End Class ボタン処理↓ Dim class１ As New Class1() class1.str("あいうえお") メソッドにどのように配列を持たせればよいのか教えていただけると幸いです。
沢山の同じフォームのファイルを一まとめにしたくて、あるサイトから下記マクロを参考にさせていただきましたが、テストではうまくいったのに、実際に使用しているファイルを実行したらデバックが出ました。(Set R = R.End(xlDown).Offset(1)) の部分です。 まったくわかりません。 この部分はどのような意味なのでしょうか？ また、可能性としてどのような原因があると思われますか？ ちなみに参考にしたマクロは下記のものです。 Sub ExcelbookCombine() Const Fol As String = "C:\Users\新しいフォルダー\" Dim Fn Dim NewFile As Workbook Dim Wb As Workbook Dim Ws1 As Worksheet Dim Ws2 As Worksheet Dim R As Range Set NewFile = Workbooks.Add Set Ws1 = NewFile.Worksheets(1) Set R = Ws1.Range("A1") Fn = Dir(Fol, vbNormal) Do Until Fn = "" Set Wb = Workbooks.Open(Fol & Fn) Set Ws2 = Wb.Worksheets(1) Ws2.Range("C1", Ws2.Cells(Rows.Count, 3).End(xlUp)).Resize(, 20).Copy R Set R = R.End(xlDown).Offset(1) Wb.Close 'Debug.Print Fn Fn = Dir Loop Set R = Nothing Set Ws1 = Nothing: Set Ws2 = Nothing Set Wb = Nothing: Set NewFile = Nothing End Sub
エクセルマクロ VBA FoundCelｌ について質問です。 B1には＝TODAY()が入力されています。以下の方法でB10:B161から今日の日付を検索しようと思うのですが上手くいきません。 Dim FoundCell As Range Set FoundCell = Range("B10:B161").Find(What:=Range("B1"), LookIn:=xlValues) 今までは Set FoundCell = Range("B10:B161").Find(What:=Format(Now(), "m/dd"), LookIn:=xlValues) で検索していたのですが、m/dd mm/dd m/d mm/d を区別してしまうのか上手く検索できないため上の方法でできたら・・・と思います。 B1はThisWorkbook、検索するのは別のブックになります。 よろしくお願いします。
VBSにて以下のvalue部分に記載されている"This is a test"をエクセルにコピペしたいのですが、結果は何もコピーされません。（マクロの処理は正常終了しています） ↓取得したいvalueが記載されているHTMLソース（サイトはWeblio翻訳：http://translate.weblio.jp/ です） <input type="hidden" name="translatedText" value="This is a test." id=translatedText> 以下はVBSのコードです。 Range("K2") = objIE.document.getElementsByName("translatedText")(0).innerText コードが正しくないと思うのですが、どのようにすればよいか是非お教えください。 よろしくお願いいたします。
ＶＢＡのINPUTBOXで何も入れずにキャンセルボタンを押したらINPUTBOXが閉じる スクリプト教えてください。 デフォルトを空白で閉じるスクリプトも教えていただければ たすかります。
VBAの初心者です。特定の条件を満たすセルのべつの指定のセルをコピーして別のセルに貼付けたいです A B C D E ・・・・・・・Z 1 3 4 5 sum(A+B) ・・ C 6 2 4 5 sum(A+B) ・・F 7 4 4 5 sum(A+B) ・・C 3 6 4 5 sum(A+B) ・・C ・ ・ ・ ・ ・ ・ ・ ・ 条件 Z列が Cの場合、E列の値をA列に貼り付けたい（値のみ）です。 よろしくお願いします。
VBAを使って、セルの値を「参照」から記入されている「値」そのものにしたい。VBAによってシート２を別ブックにコピーする場合、そのシート２の中のセルにシート１を参照するデータが入っていた場合、不具合が絶対発生しないようにするためには、どのようにすればよいでしょうか。 つまり、シート２をコピーして別ブックとして保存して、開いた際に、エラーなどの表示がでないようにしたいのです。 （例） シート２のセルA1に「=シート1!A24」と入力されている状態 よろしくお願いします。
以前visual basicで作成された販売管理システムをaccess2013で作り直す作業をしていますが、次の文のわかる方、教えていただけないでしょうか。すみません、どうかよろしくお願いいたします。 use sijisho copy to 請求 for 納期>=form.開始日.value .and.納期<=終了日.value select 2 use 請求発行 order tag 顧客番号 dele all pack appe from 請求 total on 顧客番号 to 請求合計 fiel a,b,c,d . . goto top select 1 use seikyuu order 顧客番号 select 2 use 請求合計 . . goto top
ExcelVBAでファイル名に連番をつけて保存しているのですが Filename = Range("A1") '保存するファイルの名前を取得Workbook_path = ActiveWorkbook.Path 'ファイル名に連番を設定 For fCount = 1 To 999 If Dir(Workbook_path & "\" & Filename & Right("00" & CStr(fCount), 3) & ".csv") = "" Then Savename = (Workbook_path & "\" & Filename & Right("00" & CStr(fCount), 3)) Exit For End If Next というコードで現在のフォルダの中を確認して連番をつけています。 しかし、ファイル001を作成→サブフォルダである処理済フォルダに移動をしてしまうと 再度ファイル001が作成されてしまいます。 また、001、002、003と作成して002だけ処理済みにいれた場合004を作成したりしたいのです。 現在のフォルダとサブフォルダを含めた連番設定にしたいのですがどういうコードで出来ますでしょうか？
文字コードで悩んでいます webシステムを開発しているのですが、自アプリとその周りのデータベースをUTF-8を指定して作成しておりました。 最近になってこのシステムと連携する別のシステムがアプリもデータベースもShift_JISで作成されていることが分かり、自アプリもShift_JISに変更することになりました。 しかし、webシステム開発の経験が浅く(現在の作業はほぼほぼ完成していて前任者から引き継いだだけ)文字コードなどに対する知識もあまりありません。 自アプリと周辺のデータベースには既にデータが登録されており、それら全てがUTF-8で登録されているのですが、アプリやデータベースサーバーの文字コードをShift_JISに変更する場合どのようなことに配慮しなければならないでしょうか。 また、エンドユーザのテストが終わっているので、使用できる文字に変更があると伝えなければならないと思っておりますが、UTF-8とShift_JISで使用可否の分かる対比表のようなものはないでしょうか。 拙い質問文になってしまいましたが、回答をよろしくお願いします。
Excel、マクロについての質問です。 もしも関数でも以下の事ができる場合はマクロでなくても構いません。 なるべく簡単な方法を教えていただけると助かります。図の様な空白セルがいくつも続く表の空白を取り、一つの表に合体してから、交互に続く結果の下だけを取り、形にしたいと考えております。 また、大きな表の中の一部（仮にA~D列）のものを合体させたいと考えておりますので、そちらも考慮の上回答頂けると幸いです。 別のシートに貼り付けて使うか、この表があるシートでこの形に成形するかはお任せします。お手数ですが、より簡単な方法を教えて頂けると幸いです。 言葉があまり上手でなく申し訳ありません、回答宜しくお願い致します。
WIN2015 エクセル2007を使用しております。 下記画像の通り、データが羅列されており、 一定の間隔で同一のグラフを作成したいです。（指定範囲も3行ごとに下にずれたデータ範囲になります。） こちらの3行で1データにつき、1グラフを300こ近く作りたいのですが、 マクロなどで可能でしょうか？
VBAド素人なのですが ExcelのVBAを使ってカウントダウンタイマーを作りたいのですが http://ateitexe.com/count-down-timer/こちらのサイトやhttp://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1211545308...こちらの方の質問なども参考にいろいろ試して見たのですが カウントダウンは成功したのですが 残り秒数が0になるとリセットし、再び設定した数字に戻ってカウント開始するように設定する方法が あればご教授願えませんか？ 希望としましては テキストボックス←残り秒数 コマンドボタン（開始・停止・リセット）の3つを設定出来たらと思っています。 カウントダウンタイマーの使用目的としましては Excelでしりとりをするときに時間制限を設けて緊張感を出せたらと思っています
Vb.net textbox1で表示されているパス名のフォルダの有無についてPrivate Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click Dim strDirPath As String strDirPath = System.IO.Path.Combine(TextBox1.Text, "ABC") 'フォルダの存在確認 If System.IO.Directory.Exists(strDirPath) = True Then MessageBox.Show("存在します", "通知") Else MessageBox.Show("存在しません", "通知") End If end sub textbox1に表示されているパス名の中にABC というフォルダがあります ボタン2をクリックして、ABCというフォルダがあるのかを確認致したく思います 確かにABCというフォルダがありますが、実行すると存在しませんと表示されてしまいます どのようにしたら良いでしょうか？ ご教授下さい
担当者ごとにブックを作成するマクロをご教授ください。 ブックAとブックBがあります。 このブックAのシート2に担当表(A列3行目以下:識別コード、B列3行目以下:担当者名が入力されています)があります。 ブックBは識別コードごとにシート分けされています。(シート名は識別コードです) ブックAのシート1よりマクロを実行して(マクロボタンを作成します)、ブックBを担当者ごとに別ブックに分けたいです。 識別コードが多数あるので、できればマクロで行いたいです。 よろしくお願いします。
お助けください。 現在検索フォームを使って、Sheet1からフォームに入力したキーワードを検索するマクロを組んでいますが、検索対象を同じBook内の複数シートにすることは可能なのでしょうか？現在、同じWorkbook内にSheet1からSheet5があるのですが、 検索する対象のSheetをSheet1だけではなくSheet3、Sheet5を追加したいのです。 検索する範囲はSheet1と同じで構いません。 詳しい方、可能であればコードをご教示お願いいたします。 Private Sub CommandButton1_Click() Call Samp1F(Me.lstName, Array(Me.txbName1.Value, Me.txbName2.Value)) If (Me.lstName.ListCount = 0) Then MsgBox "Sorry....見つかりませんでした" End If End Sub Public Sub Samp1F(obj As Object, vA As Variant) Dim r As Range Dim v As Variant Dim sS As String Dim i As Long, j As Long, k As Long obj.RowSource = "" obj.Clear k = LBound(vA) If (Len(vA(k)) = 0) Then Exit Sub For i = k To UBound(vA) If (Len(vA(i)) > 0) Then With Worksheets("Sheet1").Range("A1").CurrentRegion.Resize(, 6) Set r = .Find(vA(i), LookAt:=xlPart, MatchByte:=False) If (Not r Is Nothing) Then sS = r.Address Do v = r.Value For j = i + 1 To UBound(vA) If (Len(vA(j)) > 0) Then If (InStr(1, v, vA(j), vbTextCompare) = 0) Then Exit For End If Next If (j > UBound(vA)) Then k = r.Row obj.AddItem .Cells(k, 1).Value j = obj.ListCount - 1 obj.List(j, 1) = .Cells(k, 5).Value obj.List(j, 2) = .Cells(k, 6).Value End If Set r = .FindNext(r) Loop While (r.Address <> sS) End If End With Exit For End If Next End Sub
購入品の管理をしたいと思っていますが、やり始めたばっかりのためわかりません。データを登録することはできたのですが、呼び出すことができないので教えて頂きたい。 やりたいことは、職員番号を入力すると、自動で別シート（シート名:一覧）から品名、数量をコピーして持ってくる。シート一覧からは削除される。 どうすればできますか？
【急募】 Rを使ったはずれ値検出を行っているのですが、現在はプロットして判明した異常値をエクセルから手作業で取り除いています。手作業が入ることにより、ミスする可能性も増えますし、 何より効率が悪いです。 Rのコンソール上で、異常だと判断した値を取り除いて新たなデータを作成する方法をご教示ください。 ・参考 現状、以下のような手順で異常値を検出しています。 1.全データの平均を求める 2.全データの分散を求める 3.異常値の除去 4.１～３の作業をあと2回繰り返す。 5.最終的に残った値の平均、分散を正常モデルとする。 6.正常モデルと新たに取得したデータを比較して、異常検知を行う。
vusialbasicのプログラミング中に型 「'System.InvalidCastException' のハンドルされていない例外が Microsoft.VisualBasic.dll で発生しました 追加情報:String "" から型 'Integer' への変換は無効です。」 とエラーがでてしまいます。コードは以下です Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click Dim Si As Integer, Ra As Integer, SIS As Integer = CInt(TextBox1.Text), RAI As Integer = CInt(TextBox2.Text) Si = 4231322 Ra = 2223115 If SIS = Si Then 邪神.Show() Me.Hide() Else MessageBox.Show("パスワードが違います") End If If RAI = Ra Then Dim Sn As New 神格 Sn.Owner = Me Sn.Show() Else MessageBox.Show("パスワードが違います") End If End Sub いろいろ検索して出てきた解決方法を試してもうまくいかなくて・・・ どうすれば解決しますか?ちなみにVusialStudio2013です。
VB2015 + AccessMDBでタイムカードのシステムを作ろうと思っています。■1. 出勤 画面から入力(ボタンを押されたときの日時を記録) Dim a As Date = Date.Now ■2. 退勤 画面から入力(ボタンを押されたときの日時を記録) Dim b As Date = Date.Now ■3. 計算処理 (1)労働時間を計算する。 労働時間 ＝ 退勤 － 出勤 － 昼休み時間(1時間) 単純に退勤－出勤とするので有れば簡単に求まりました。 しかし、そこから休憩時間の1時間を強制的に引くやり方が分かりません。 Dim a As Date = #2016-05-31 09:00:00# Dim b As Date = #2016-05-31 18:00:00# Dim c As TimeSpan = b - a - #01:00:00#(※1) (※1)これでは「これらの引数で呼び出せるアクセス可能な'-'が無いため、オーバーロードの解決に 失敗しました。」と出てしまいます。 教えて下さい。よろしくお願いします。
VBA初心者です。 下記プログラムを組んだのですが、思い通りにならず困っています。 何が悪いのか教えてもらえませんか？表というシート上の約600行ある一覧表のZ列から"山田"という名前を見つけて、 sheet1に必要項目だけ表示させたいのです。 このプログラムを実行すると3行分(102行, 105行, 232行)だけ表示され、 それ以降のデータが表示されません。 実際表にはまだまだ250行や590行にも山田はあります。 Sub Kensaku() Dim Wsb As Worksheet Dim MaxRow As Integer Dim IC As Integer Dim TMP As String Dim objFind As Object Dim LST As Integer Dim Firstpoint As String Set Wsb = Worksheets("表") TMP = "山田" Set objFind = Wsb.Columns("Z").Find(TMP) If objFind Is Nothing Then MsgBox "該当データがありませんでした。" Exit Sub End If LST = Wsb.Columns("Z").Find(objFind).Row Firstpoint = objFind.Address Do Set firstcell = Range("B17") firstcell.Cells(IC + 1, 1).Value = Wsb.Cells(LST, 1).Value firstcell.Cells(IC + 1, 2).Value = Wsb.Cells(LST, 3).Value firstcell.Cells(IC + 1, 4).Value = Wsb.Cells(LST, 4).Value firstcell.Cells(IC + 1, 11).Value = Wsb.Cells(LST, 26).Value firstcell.Cells(IC + 1, 13).Value = Wsb.Cells(LST, 27).Value IC = IC + 1 Set objFind = Wsb.Columns("Z").FindNext(objFind) LST = objFind.Row If Firstpoint = objFind.Address Then MsgBox "検索を完了しました。" Exit Do End If Loop End Sub
エクセルVBAでコードがうまく作れません。下記のコードで、textbox1 と range("Y1")の数字が同じ場合はメッセージを出して中断したいのですが、同じ数字が入っていても、elseのほうに入ってしまい、デバックしてしまいます。 textbox1.value でやってもダメでした。 何がダメなんでしょうか？ If Val(TextBox1) = Val(Range("Y1")) Then MsgBox "月がダブっています！" UserForm2.Hide Else Range("Y1").Value = TextBox1.Value Dim ShName As String ShName = ActiveSheet.Name With Sheets(ShName) .Copy after:=ActiveSheet ActiveSheet.Name = .Range("Y1") & "月分" ActiveSheet.Range("B2:E130").Value = "" End With End If UserForm2.Hide End Sub
エクセルＶＢＡについての質問です。 毎回違うＣＳＶファイルからデータをエクセルに転記しているのですが、ＶＢＡにて転記するＣＳＶファイルのシート名を取得させる方法はありますでしょうか？現状ですと、１年分のファイル名を指定して作ってあるので、ボタンが１２個設定しており、もっとスマートに作成できないかと思い質問させていただきました。 ＶＢＡをやり始めて日が浅いため、コードもでたらめな部分があるかもしれませんが、よろしくお願いします。 Private Sub CommandButton17_Click() Dim strFileName As String ChDir ("C:\") strFileName = Application.GetOpenFilename("線量評価ブック (*.CSV),*.CSV", 1, "ファイルを選択") If (strFileName <> "False") Then If (Trim(Dir(strFileName)) = "") Then Call MsgBox("ファイルが見つかりません", vbOKOnly, "確認") Else ' ThisWorkbook.Worksheets("Sheet5").Range("D6:G100").ClearContents Workbooks.Open FileName:=strFileName Workbooks("5月線量結果.csv").Worksheets("5月線量結果").Range("A:A,C:C,D:D,E:E,F:F,H:H,I:I,K:K,L:L,M:M,N:N,P:P,Q:Q,R:R,S:S").Select Range("S1").Activate Selection.Delete Shift:=xlToLeft Workbooks("5月線量結果.csv").Worksheets("5月線量結果").Range("A2:D188").AdvancedFilter Action:=xlFilterInPlace, Unique:=True ActiveWindow.SmallScroll Down:=-141 Workbooks("5月線量結果.csv").Worksheets("5月線量結果").Range("A2:A188,B2:B188,C2:C188,D2:D188").Copy _ Destination:=ThisWorkbook.Worksheets("sheet5").Range("D6") ActiveWorkbook.Saved = True ActiveWorkbook.Close Range("F6:G84").Replace "#EMPTY", "" End If End If End Sub
以下のAのﾏｸﾛを実行するとｴﾗｰになってしまったので、何が悪いのか確認するためにBのﾏｸﾛを作ってみると実行することができました。Aのﾏｸﾛは何がだめなのでしょうか Sub A() Dim 最終伝票行 As Long 最終伝票行 = Range("B:B").Find(What:="334600", After:=ActiveCell, LookIn:=xlFormulas, LookAt _ :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _ False, MatchByte:=False, SearchFormat:=False).Row MsgBox 最終伝票行 End Sub Sub B() Dim 最終伝票行 As Long 最終伝票行 = Range("B:B").Find(What:="334600").Row MsgBox 最終伝票行 End Sub
VBA勉強中の者です。 画像のようなヘッダとデータが混在している表から特定の品番（行）とヘッダ（列）を指定すると値が出てくるコードを書きたく思っております。品番はC列にまとめましたが、ヘッダは行ごとに異なります。 品番で行を出して、ヘッダはE列の連番を使い、求めたい品番の連番の数が3なら 品番のある行から3上に行くとその品番のヘッダがあり、その行に指定するヘッダ名ある列を出して 品番の行とヘッダの列の交わるところの値を返すと求められると思っているのですが、どのように組んでいいのか分からず、ご教授願えればと思い投稿させて頂きました。 上記の方法で、ヘッダが一行の時は出来ますが、ヘッダが2行になった時はどのようにすればいいのかも合わせてご教授願いたいです。 実際のデータは列が33列の行が1万行からなるデータになります。 手でやるには途方もなく、助けて頂きたいです。 よろしくお願い致します。
C言語についての質問です 二つの数値を入力し、その間の数値をファイルに出力するプログラムを作成したいのですが、このプログラムでは１つの数字しか出力されません。どうすればいいでしょうか？#include <stdio.h> int main(void) { int a; int b; int i; FILE *file; printf("数値1の入力:/n"); scanf("%d",&a); printf("数値2の入力:/n"); scanf("%d",&b); if(a==b) printf("もう一度入力してください/n"); else if(a<b) for(i=a; i<=b; i++) { file = fopen("range.txt","w"); fprintf(file,"%d",i); fclose(file); } else for(i=b; i<=a; i++){ file = fopen("range.txt","w"); fprintf(file,"%d",i); fprintf(file,"%d",i); fclose(file); } printf("出力しました./n"); return 0; }
文字列の中にある数値の桁区切り(半角カンマ)を削除するマクロを作成したいのですが、こちらで皆さんに教わりながら何とか出来上がってきました。ただ、このマクロを動かすと、変換の処理はうまくいったのですが、『実行時エラー'91':オブジェクト変数または With ブロック変数が設定されていません。』が発生します。 デバックをしたところ、『Loop Until r_end = r.Address』、この部分が黄色く反転しています。 発生原因がわかりません。 初心者ですが、試行錯誤して作っています。 お詳しい方教えてください。宜しくお願い致します。 【処理の例】 ※数値の桁区切りの半角カンマのみ削除する。 幅 1,500mm,高さ 1,200mm ⇒ 幅 1500mm,高さ 1200mm 【現在のマクロ】 Sub 置換2() Dim r As Range Set r = Range("A4:A1000").Find(What:=",", lookat:=xlPart) If r Is Nothing Then Exit Sub r_end = r.Address With CreateObject("VBScript.RegExp") .Pattern = "(\d+)(,)(\d+\d+\d)" .Global = True Do r = .Replace(r, "$1$3") Set r = Range("A4:A1000").FindNext(r) Loop Until r_end = r.Address End With End Sub
ＡＣＣＥＳＳの使用方法について 一度質問しましたが、まだ理解に達さなかったので再度質問します。 フォーム上で内容を打ち込んで反映させたいです。 リストボックス①と②があるとします。①に値集合ソースで各課の名前を入れて、それと連動し作成したテーブルから課のデータが ②に記載されるようにしました。(①で課を選択すると②にその課のデータが出現する) ②のリストボックスにデータを入力し、内容を更新(テーブルも)出来るようにしたいです。 リストボックスの近くにテキストボックスを設け、さらにその横にコマンドボタンを貼って、テキストボックスに入力したデータをボタンを押してリストボックスに追加するようするにはどうすればいいでしょう。 初心者すぎてわかりません。 よろしくお願いします。
Excel VBAで日付をm/dで表示させたいのですがうまくいきません。VBAなんか使わなくてもできるというのはわかっていますが、あまり知識のない他人が使うこともあり、できるだけ簡単に、別に書いているコードにまとめたいと考えています。 Format関数くらいしか思いつかないのですが、"m/d"では"5月30日"となり、5/30のように " / " で区切ったシンプルな表記にはならず。 VBAを用いたコードで上手くいく方法をご存知の方いらっしゃいましたら教えて下さい。よろしくお願いします。
エクセルのVBAについて、どうか、どなたかお助けいただけないでしょうか。 内容が込み入っており、且つ初心者の私には、まったくどのようにしていいのかわからない状態です。2つのエクセルファイルがあり、1つはデータの入ったデータファイル、1つは出力先のファイルです。 データファイルのB列の文字列が「データ」の場合、 出力先ファイルのセルに、「これは「データファイル項目名（A列）」についてです。」と文章を出力し、となりのセルに、データファイルのE列のデータと、それに付随する定型文を自動的に表示させたいのです。 データファイルのB列には、4種類の文字列があり、定型文もそれぞれに違うものがあります。 データファイルのB列のうち、「項目型」の場合にのみ、D列にもデータがあるか確認したうえで、文章を変えたいと思っています。 わかりずらい説明で誠に申し訳ありませんが、どなたかお助け頂けますと幸いです。 どうぞ宜しくお願いいたします。
エクセルのマクロに関する質問です。今開いてるブックの『Aシート』に転送ボタンを作成します。これとは別に『Bシート』を作り、『Aシート』の2列目からAA列目までと、『Bシート』の2列目からW列目までのデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内の『マクロ』というブック、『1シート』ならびに『2シート』の名前のシートにセルB9～,C9～,D9～…といったように毎日転送(コピー)しようと思います。 イメージとしては以下の通りです。 【5/3】 『Aシート』 日付 名前 時刻 データ … 5/1 田中 7：30 534986 5/2 太田 13：00 691324 5/3 鈴木 14：00 143985 ↓[転送ボタン] 『1シート』 日付 名前 時刻 データ … 5/1 田中 7：30 534986 5/2 太田 13：00 691324 5/3 鈴木 14：00 143985 【翌日5/4】 『Aシート』 日付 名前 時刻 データ … 5/1 田中 7：30 534986 5/2 太田 13：00 691324 5/3 鈴木 14：00 143985 5/4 佐藤 8：30 068912 ↓[転送ボタン] 『1シート』 日付 名前 時刻 データ … 5/1 田中 7：30 534986 5/2 太田 13：00 691324 5/3 鈴木 14：00 143985 5/4 佐藤 8：30 068912 5/5以降も下の行に毎日『Aシート』『Bシート』に入力したデータを『1シート』『2シート』に転送(コピー)し保存します。 その際、転送先はシート保護をしておきたいのです。 Sub Macro1() Dim GYOU As Long Dim 様式1 As Worksheet, 様式2 As Worksheet Dim 様式A As Worksheet, 様式B As Worksheet With ThisWorkbook Set 様式A = .Worksheets("様式A") Set 様式B = .Worksheets("様式B") End With With Workbook.Open(Filename:="C:\共有\マクロ.xlsx") Set 様式1 = .Worksheets("様式1") Set 様式2 = .Worksheets("様式2") 様式1.Unprotect 様式2.Unprotect 様式A.Unprotect 様式B.Unprotect 様式A.Range("B16:AA2000").Copy 様式1.Range("B" & Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues 様式B.Range("B16:W2000").Copy 様式2.Range("B" & Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues Application.CutCopyMode = False 様式1.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True 様式2.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True 様式A.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True 様式B.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True .Close SaveChanges:=True End With MsgBox "『マクロブック』へ" & vbCrLf & "データ転送しました。" End Sub この様なマクロを組んでみましたが、転送ボタンを押した際転送先の『様式1』『様式2』シート共に保護がかかったままデータがされるものの最初のデータ（5/1）から当日分（5/4）全てが張り付けられてしまいます。 【翌日5/4】 翌日5/4】 『Aシート』 日付 名前 時刻 データ … 5/1 田中 7：30 534986 5/2 太田 13：00 691324 5/3 鈴木 14：00 143985 5/4 佐藤 8：30 068912 ↓[転送ボタン] 『1シート』 日付 名前 時刻 データ … 5/1 田中 7：30 534986 5/2 太田 13：00 691324 5/3 鈴木 14：00 143985 5/1 田中 7：30 534986 5/2 太田 13：00 691324 5/3 鈴木 14：00 143985 5/4 佐藤 8：30 068912 ポイントとしましては以下の通りです。 (1)『様式A,B』のシートは『様式1,2』へそれぞれ転送。 (2)毎日データ転送し、『様式1,2』へは下の行へその都度入る。 (3)『様式A,B』及び『様式1,2』は入力箇所以外は保護が掛けられ、データ転送後も保護が掛けられた状態のまま保存。 (4)日付データは重複しない。 どの様に修正すれば良いのでしょうか？ よろしくお願いします。
VBAで、Cancel = Trueというのがありますが、いまは×から閉じられなくしたり、保存や終了の操作をキャンセルするくらいしか使い道を知りませんが、他にどんなときに使用できるのですか？ばくぜんとした質問でたいへん恐縮ですが、よろしくおねがいします。
VBAのコードを教えてください。 ロケーションの管理表をVBAを使って作成したいのですが、毎度のことですがコードがわかりません教えてください。 以下のように考えています。①登録 1.ﾌｫｰﾑに品目とﾛｹｰｼｮﾝを入力してﾎﾞﾀﾝを押すと、品目の重複ﾁｪｯｸをおこなう（ﾒｯｾｰｼﾞ[OK]or[ｷｬﾝｾﾙ]） 2.[OK]⇒ｼｰﾄのA列とB列に入力した品目とﾛｹｰｼｮﾝが登録される。 3.[ｷｬﾝｾﾙ]⇒終了 ただし、重複していても同じ品目で複数のﾛｹｰｼｮﾝという場合があるため、ﾕｰｻﾞｰの判断で登録は可能 （1のﾒｯｾｰｼﾞは、あくまで重複品目があるかどうかの情報を表示するだけと考えています） ②削除 1.ﾌｫｰﾑに品目とﾛｹｰｼｮﾝを入力してﾎﾞﾀﾝを押すと、表に登録されている一致するﾃﾞｰﾀが削除される できるかどうかわかりませんが、例えば品目のみ入力してﾎﾞﾀﾝをおすと、ﾌｫｰﾑに更に何か追加してﾛｹｰｼｮﾝのみの修正できれば…とも思いますが、考えつかないので上記①②のコードを教えて下さい。 何卒よろしくお願いします。
エクセルマクロについて右クリックでメニューを追加する方法はできたのですが、”Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)”なのでシート上で右クリックしたときの処理になってしまいます。画像上で右クリックでメニューを追加するマクロはありますか？ わかる方教えてください。
エクセル2007を使用しています。 数値12桁を入力し続けるのですが、 件数が万件を超えているため、VBAがあればどうか教えてください。自分以外も入力するので、できるだけ不可をかけないために お知恵をお貸しいただけますと幸いです。 入力は、B列・C列・D列・E列・F列です。 A列・G列・H列は貼り付けてます。 A氏名 Bコード1 Cコード2 Dコード3 E性別 F生年月日（和暦） G登録日（西暦） Hメモ ① 氏名 コード1 コード2 コード3 性別 生年月日 登録日 メモ ② 山田 1111 0000 2222 1 ggge/m/d yyyy/mm/dd △ ③ 佐藤 1111 1111 2222 2 ggge/m/d yyyy/mm/dd □ ④ 田中 1111 1111 1111 1 ggge/m/d yyyy/mm/dd □ ⑤ 鈴木 文字列4桁（数値）入力後、自動で隣のセルに移動し、 D列まで入力したら、下の段のB列に自動で移動する。 ※文字数は以下になります。 B列・C列・D列は4桁 E列は1桁 F列はフリー（入力時に西暦や和暦が混在しているため） イメージは ②B列 → C 列 → D列 → E列 → F列 → ③B列 → C 列 → D列 → E列 → F列 → ④B列 → C 列 → D列 → E列 → F列 → ⑤ ツールメニューのオプションは使用しない方法がよいです。 他の方が載せていたのは、ツールオプションでセルを右に移動し、 以下のVBAをいれれば、下のセルに移動するとなっていました。 私の場合は、Fなので、Const RetsuNo As Integerは7なのかな。。。 とは思っていますが、自信はないです。 Private Sub Worksheet_SelectionChange(ByVal Target As Range)・Const RetsuNo As Integer = 5・・If Target.Column = RetsuNo Then・Target.Offset(1, -3).Select・End If End Sub・ 説明不足で、長くて申し訳ありませんが、どうかお知恵をお貸しください。 でも、EnterもTabも押さず、指定の桁で自動移動は難しいでしょうか。。。。。
エクセル vbaについて質問です。 初めまして、今研修でシステムを作っているのですが困っております。ご教授頂けたらと思います。 内容は以下です。 0. csvファイルが用意してある。csv中身「〇〇、タイプ(1.2.3)、△△、パターン種類(文字列)、◇◇、」 ※パターン種類とタイプは紐づいてます。 パターンAだとタイプ1、Cだと3となっております。 1. csvファイルを一行ずつエクセルで読み込む(タイプとパターン種類のみ) 2. パターン種類の列を主に重複データを検索、削除、削除した件数を種類ごとに合計して出力(そのパターンがタイプ2ならタイプ2の列に合計を出力) 3. 読み込む際、別シートに元々登録してあるパターンと比較し、一致したら別シートパターンの右隣のセルのパターン説明文を代わりに読み込む。 4.読み込んだ行をNo1 2 3 4 5と最大行まで順番に番号を付けていく。 以上、となります。 非常にわかりにくい部分が多いと思いますので画像を貼ります。 分かりにくくて申し訳ございません。お力添えをいただけたらと思います。 よろしくお願いいたします。
マクロにて、選択範囲のセルの先頭にある空白を削除するマクロを作成しています。http://oshiete.goo.ne.jp/qa/2229631.html こちらを参考にマクロを作成し、おおかた挙動も問題ないのですが、 セルの選択範囲がひとつの場合に、『実行時エラー13 型が一致しません』のエラーが発生します。 デバックすると『lngRowCnt = UBound(Buffer)』ここの部分がひっかかります。 セルの選択がひとつの場合は処理を行わないという形でエラーの回避はできたのですが、 セルの選択がひとつの場合も同様の処理を行うマクロを作れません。 お詳しい方、教えてください。 よろしくお願いいたします。 Sub 空白を削除() Dim rngTarget As Range Dim Buffer As Variant Dim lngRowCnt As Long Dim lngColCnt As Long Dim k As Long, j As Long Set rngTarget = Selection Buffer = rngTarget.Value lngRowCnt = UBound(Buffer) lngColCnt = UBound(Buffer, 2) For k = 1 To lngRowCnt For j = 1 To lngColCnt Buffer(k, j) = LTrim$(Buffer(k, j)) Next j Next k End If rngTarget.Value = Buffer Set rngTarget = Nothing End Sub
フォーム間のフォーカス移動 ユーザフォームを二つ作成。UserForm1、UserForm2 UserForm1にListBox1、コマンドボタン(CBtn1)を配置 UserForm2にテキストボックスを三つ(TextBox2,FormNameBox2,ListBNameBox2)、コマンドボタン(CBtn2)を配置します。 まずUserForm1を起動してListBox1に日付をリスト化します。 CBtn1をクリックしてUserForm2を開きます。 '///////////UserForm1のコード/////////// Private Sub UserForm_Initialize() ListBox1.AddItem "2016/05/10" ListBox1.AddItem "2016/05/11" ListBox1.AddItem "2016/05/12" ListBox1.AddItem "2016/05/13" ListBox1.AddItem "2016/05/14" End Sub Private Sub CBtn1_Click() With UserForm2 .FormNameBox2 = Me.Name .ListBNameBox2 = "ListBox1" .Top = Me.Top + Me.ListBox1.Top .Left = Me.Left + Me.ListBox1.Left + Me.ListBox1.Width + 10 .Show End With End Sub ’///////////////////////////////////////////////////////////// UserForm2が開かれるとTextBox2に日付を入れます。 UserForm2のテキストボックスFormNameBox2 にフォーム名"UserForm1" UserForm2のテキストボックスListBNameBox2 に リストボックス名"ListBox1" がそれぞれ入ります。 '///////////UserForm2のコード/////////// Private Sub UserForm_Initialize() TextBox2.Text = "2016/05/12" End Sub Private Sub CBtn2_Click() Dim i As Long If TextBox2.Text = "" Then Exit Sub With UserForms.Add(FormNameBox2.Text).Controls(ListBNameBox2.Text) For i = 0 To .ListCount - 1 If .List(i) = TextBox2.Text Then ' MsgBox i & "番目に見つかりました" '****************************** .SetFocus .ListIndex = i '****************************** Unload Me Exit Sub End If Next i End With MsgBox "見つかりませんでした" End Sub ’///////////////////////////////////////////////////////////// CBtn2をクリックすると、UserForm1.ListBox1内の"2016/05/12"位置を検索してUserForm1.ListBox1内の"2016/05/12"を選択状態にしたいのです。 '******************************間の記述を UserForm1.ListBox1.SetFocus UserForm1.ListBox1.ListIndex = i とするとUserForm1.ListBox1内の"2016/05/12"が選択状態となりますが、フォーム名とテキストボックス名を変数で指定すると選択状態となりません。 何がダメなのでしょう。 ご教授お願いいたします。
Sub 表の最下部に新しい入力枠を追加() Dim rr As Long Application.ScreenUpdating = Falserr = UsedRange.Rows.Count Range("A2:N12").Copy Range("A" & rr + 1).PasteSpecial Application.CutCopyMode = False Application.ScreenUpdating = True End Sub ' 表の最下部に新しい入力枠を追加 Macro いつもお世話になってます。 以前いただいたボタンを押すと表に枠を追加するマクロ（上）を入れてみると 上の4段目のrr=の行が黄色になりエラーになります。 どこが悪いのでしょうか？
rnd関数が毎回同じ数を返してしまう現象について vba いつもお世話になっております。エクセルVBAで、データを配列に読み込み、ランダムで一つを選び、吐き出す、っというプログラムを作成しています。 ランダムの箇所が多いので、その部分だけサブルーチンにしてみたのですが、 なぜかrnd関数がいつも同じ数字を返してくるケースがあるようです。 これは考えられる原因は何があるでしょうか？ xAryに配列を格納しています。 要素数 = UBound(xAry) + 1 minInt = 1 乱数 = Int((要素数 - minInt + 1) * rnd + minInt) - 1 Debug.Print xAry(乱数) 上記のようなものを実行した際に、 いつも同じ乱数値が返ってくることがあります。 たとえば、エクセルを再起動したりした際にはかならず 乱数値は１，２，３ 等が帰ってくるような現象です。 乱数の出し方は、いくつかのサイトを参考にしてみました。
Cells(2, 4) = ExecuteExcel4Macro('D:\M管理DATA\[データ2015.xls]データBOX'!R25C4)年度別データファイルを複数年読み込む場合に事前にデータファイルに記述してあるデータ件数を読み取りデータ読込みのさいのパンクを防ぎたいのですが、ファイルにパスワード設定をしているためパスワードの要求がきてしまいます。 ExecuteExcel4Macroには, Password:=PASS, WriteResPassword:=PASSのような、記述はどのようにすればよいのでしょうか? ネットでいろいろ調べましたが困りはてました。
excel ユーザーフォーム中で、シートを表示または、一部を表示する方法はないのでしょうか？
クイズを出題するフォームを作成しているのですが行き詰まってしまいました、、。 大変恐縮ではありますが、お知恵を拝借したく質問させていただきました。フォームのイメージとしましては OptionButton1~5に問題を表示 解答ボタン（CommandButton1)をクリックすると正解か不正解かをMsgBoxに表示 （何も選択していない場合はエラーメッセージを表示） 次へボタン（CommandButton２）をクリックすると次の問題へと移り変わる 終了ボタン（CommandButton３）をクリックするとページを閉じる クイズ作成にあたりWorksheets(1)に以下のものを記入してあります。 No 問題 答１ 答２ 答３ 答４ 答５ 正解 問１ 如月 きらつき きさらぎ ききつき きさつき きさづき 2 問２ 弥生 やよい やせい やしょう やいき よせい 1 問３ 五月 ごがつ ごつき さつき いつき みつき 3 問４ 神無月 かんなづき かんなつき かんなずき かみなずき かみなづき 1 問５ 師走 しはしる しそう しっそう じそう しわす 5 A３~A7までNo B３~B7まで問題 C3~C7まで答１ D3~D7まで答２ E3~E7まで答３ F3~F7まで答４ G3~G7まで答５ H3~H7まで正解 私が進められたところは、以下のコードまでとなります。 Private Sub CommandButton1_Click() If OptionButton1 = False And OptionButton2 = False And OptionButton3 = False And OptionButton4 = False And OptionButton5 = False Then ret = MsgBox("答えを選択してください！！", 48, "注意") End If End Sub Private Sub UserForm_initialize() TextBox1 = Worksheets(1).Cells(3, 2) OptionButton1.Caption = Worksheets(1).Cells(3, 3) OptionButton2.Caption = Worksheets(1).Cells(3, 4) OptionButton3.Caption = Worksheets(1).Cells(3, 5) OptionButton4.Caption = Worksheets(1).Cells(3, 6) OptionButton5.Caption = Worksheets(1).Cells(3, 7) End Sub お力添えいただければ大変嬉しいです。よろしく御願い致します。
Visual Studioでのデバック最適化の質問です．テキストファイルの読み込みを行っているのですが，全く同じことをしているXcodeと比べてとても遅いです．具体的にはXcodeで約0.01秒，Visual Studioで約16秒です． XcodeではOptimization LeveをFaster[-O2]にしています．Visual StudioではConfiguration Properties→C/C++→Optimization→OptimizationをMaximize Speed(/O2)にしています． これで両者同じように最適化してると思いますが，Visual Studioでさらに変更すべき設定等があるのでしょうか？ それともpcのスペックの差でしょうか？ ちなみにVisual StudioではOptimization以外，何の変更もしていません． 何かご存知の方いらっしゃったら，ご教授下さい． お願い致します．
シートモジュールでVlookupを組みいろいろとテストを行っていると、検索値が無いときにエラーが発生してしまったので、対処法を調べてエラー処理を組みました。その際、Vlookupの戻り値に変数を設定し、変数に戻り値が格納されているところまでは確認出来たのですが、以下のエラー処理下のrangeオブジェクトの値がEmptyになり、エラーが発生してしまいます。 エラーメッセージは「実行時エラー’1004’：アプリケーション定義またはオブジェクト定義のエラーです」になります。 変数の戻り値は文字列か数値になるのでVariant型にしているのですが、他の型になるのでしょうか。 何卒お力添えをお願いします。 Private Sub Worksheet_SelectionChange(ByVal Target As Range) If Target.Address(False, False) = "G7" Then If Range("D7").Value = "" Then Exit Sub End If Dim SYOUBUNRUI As String Dim HANNI As Range Dim i As Long Dim MAX As Long Dim KATABAN As Variant Dim TEKISEI As Variant MAX = 65000 For i = 3 To MAX Step 1 If Worksheets("在庫リスト一覧").Cells(i, 1).Value = "" Then Exit For End If Next i i = i - 1 SYOUBUNRUI = Range("D7").Value Set HANNI = Worksheets("在庫リスト一覧").Range("C3: E" & i) On Error Resume Next KATABAN = WorksheetFunction.VLookup(SYOUBUNRUI, HANNI, 2, False) TEKISEI = WorksheetFunction.VLookup(SYOUBUNRUI, HANNI, 3, False) If Err.Number <> 0 Then MsgBox "在庫管理リスト一覧に" & vbCrLf & "登録されていません", vbCritical KATABAN = "" TEKISEI = "" End If On Error GoTo 0 Range("E7").Value = KATABAN Range("F7").Value = TEKISEI End If End Sub
VBAを用いてIEを操作する方法について。初心者です。VBAを用いてテキストボックスに値を入れて検索を掛けたいのですが、値を直接指定すると成功しますが、エクセルのシート上の値を指定して検索しようとするとステートメントの最後ですとエラーが出ます。解決方法をご教授いただけたら幸いです。 これだと成功しますが、 Set objInpTxt = ie.document.getElementsByName("txtIDNO")(0) objInpTxt.Value = "1180300768" こちらでは失敗します。 Set objInpTxt = ie.document.getElementsByName("txtIDNO")(0) objInpTxt.Value = "Range("A1")"
マクロボタンを押して以外の条件でポップアップを表示させるにはどうしたらいいのでしょうか？条件はF1からＦ20までのセル範囲で多少問わず範囲内で1が表示されていれば『1表示あり』のコメントをポップアップ表示させたいのですがどのようなマクロコードになりますでしょうか？何卒ご教授のほどよろしくお願い致します
先ほどIEの検索結果の保存方法について質問させていただいたものです。補足になぜか書き足せなかったので再質問させていただきます。以下がコードとなります。Public Sub IE基本_個体識別番号検索成功() Dim ie As New InternetExplorer ie.navigate "https://www.id.nlbc.go.jp/top.html" ie.Visible = True While ie.Busy = True And ie.readyState < READYSTATE_COMPLETE DoEvents Wend Dim doc As HTMLDocument Set doc = ie.document Dim sel As IHTMLSelectElement Dim inp As IHTMLInputElement Set objInpTxt = ie.document.getElementsByName("txtIDNO")(0) objInpTxt.Value = "1337256214" Dim btn As HTMLInputElement Set btn = doc.getElementsByTagName("input")(0) btn.form.submit While ie.Busy = True And ie.readyState < READYSTATE_COMPLETE DoEvents Wend Application.Wait Now + TimeValue("00:00:05") Set btn = doc.getElementsByTagName("input")(0) btn.form.submit Application.Wait Now + TimeValue("00:00:05") SendKeys ("^A") SendKeys ("^C") Range("A1").Select ActiveSheet.Paste End Sub
VBA初心者です。会社のファイルでマクロ作成に取り組んでいますが 下記の内容で実行すると、行いたい目的は出来ているのですが時間が30秒くらいかかります。会社のパソコンはスペックがとても悪いのが原因なのですが、そこは変えようがないので 少しでも動きを軽やかにするためには下記をどう変更すれば良いかわかりません。 無駄なところがあったらご指導いただけると助かります。 よろしくお願いします。 Application.ScreenUpdating = False Application.EnableEvents = False ActiveSheet.Unprotect ("1234") ActiveSheet.AutoFilterMode = False Range("A2:AH2").AutoFilter Range("AE1").Copy Range("AE3:AE2000").Select Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _ SkipBlanks:=False, Transpose:=False Application.CutCopyMode = False Selection.Value = Selection.Value Range("A2:AH2000").Sort Key1:=Range("K2"), Order1:=xlAscending, Key2:= _ Range("N2"), Order2:=xlAscending, Key3:=Range("AE2"), Order3:=xlAscending _ , Header:=xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:= _ xlTopToBottom, SortMethod:=xlPinYin, DataOption1:=xlSortNormal, _ DataOption2:=xlSortNormal, DataOption3:=xlSortNormal Range("A1:J1").Copy Range("A3:A2000").Select Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _ SkipBlanks:=False, Transpose:=False Selection.Value = Selection.Value Range("A:J,AC:AI").Select Selection.EntireColumn.Hidden = True ActiveSheet.Protect ("1234"), DrawingObjects:=True, Contents:=True, Scenarios:=True _ , AllowFiltering:=True Application.EnableEvents = True End Sub
ネットショップで自動購入のため以下のマクロを作ってみました 「all」ページ→画像情報で検索して商品ページ画面→自動でカートインとなる予定で作りましたが 実行してもカートに入りません初心者なのでかなりつたないコードになっていると思いますが カートに入らないのはどこに問題があるかどなたかご教授いただけませんでしょうか Option Explicit Sub vba() Dim obIE As Object Dim Obj As Object Set obIE = CreateObject("InternetExplorer.Application") obIE.Visible = True obIE.navigate "http://www.supremenewyork.com/shop/all" Do While obIE.readyState <> 4 Do While obIE.Busy = True Loop Loop For Each Obj In obIE.document.getElementsByTagName("img") If InStr(Obj.outerHTML, "116144") > 0 Then Obj.Click Exit For End If Next Do While obIE.readyState <> 6 Do While obIE.Busy = True Loop Loop For Each Obj In obIE.document.getElementsByTagName("input") If InStr(Obj.outerHTML, "カートに入れる") > 0 Then Obj.Click Exit For End If Next obIE.navigate "https://www.supremenewyork.com/checkout" ' Application.Wait Time:=Now + TimeValue("00:00:02") End Sub
エクセルマクロの初心者です。繰り返し処理For ～ Nextを試しても定義エラーとなり、解決策がわからず困っています。どなたかご教授をお願いいたします。シート名(データ)の3行目～12行目を１行目毎にコピーし、2行目に貼り付け、シート名(出力)を３回印刷するものですが、Rows("i:i").Selectが定義エラーとなります。 Dim i As Integer For i = 3 To 10 Sheets("データ").Select Rows("i:i").Select Selection.Copy Rows("2:2").Select ActiveSheet.Paste Sheets("出力").Select ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _ IgnorePrintAreas:=False ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _ IgnorePrintAreas:=False ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _ IgnorePrintAreas:=False Next
Excelの初心者です。専門用語などはあまり理解できていないのでご了承お願いします（ヘンテコなこというかもです）。ある同一のフォルダー内に、２つのエクセルのデーターをマクロ有効で保存したとします。片方のファイル名を「物理定数」もう片方を、「サンプル」とします。 物理定数のファイルの方には、VBAのコードが保存されており、例えば、 sub 物理定数() dim GN as double GN=6.67408*(10)^(-11) cells(1,1).value="ニュートン定数" cells(1,2).value=GN end sub と記載されていたとします（これをプロシージャって呼ぶんでしょうか？）。で、いったんこのファイルを閉じ、次に「サンプル」のファイルを呼び出したとします。私は、いつもこのサンプルのファイルに物理定数のVBAのコードを張り付けるために、物理定数のファイルを開き、VBAのソースコードをコピーアンドペーストし、サンプル（の標準モジュール欄）のところに、それを張り付けるという方法でいつもやりしのいできましたが、わざわざ物理定数のファイルを開くのは面倒なので何か方法はないのか？と思ったのです。 例えば、そのサンプルのファイルのVBAを開き、標準モジュールを挿入し sub sample() call 物理定数 end sub としたのですが、物理定数のVBAのコードを呼び出せませんでした。 アドバイスお願いします。(´･ω･｀)
VBAでのメール送受信に関する質問です。 VBAでメールの受信と、内容をプログラムで読み込んだうえで振り分けをしたいと思っています。（メールのタイトルや、受信内容によって処理内容を変えて保存したりしたいです。） いろいろ調べてみましたら、 エクセルを使ったメールの送受信にはBASE21というのが良いということを知りました。 http://officetanaka.net/excel/vba/tips/tips46.htm こちらのページを参考にプログラムを組んでみましたら、無事に動いたのですが、 この場合、新規で受信されたメールのみ、処理ができるようです。 ですが、全てのメールをブックに保存していると、さすがにブックが重くなってしまうので、 一度、指定したフォルダ（ローカル）にメールを溜めこみ、 ReadMailメソッドで開いて、本文などを読み込み、セレクトケースなどで場合分けして処理するのはどうかなと考えました。 しかし、今度はReadMailメソッドの使い方がわからず、 実際に実行してみると、「型が一致しません」と出てしまいます。。。 もし詳しい方いらっしゃれば、教えて頂けましたらうれしいです。 Sub メールチェック() Set bobj = CreateObject("basp21") file = "メールフォルダの保存場所を指定" Para = "from:subject:" dirname = "" output = bobj.ReadMail(file, Para, dirname) Debug.Print output(0) End Sub ↑上記ですと、「型が一致しません」と出ます。 受信はできており、メールフォルダ内には、メールのファイルは溜まっており、あとは開くだけかなと思っていたんですが、ハマってしまいましたm(_ _)m BASE21のヘルプ http://www.hi-ho.ne.jp/~babaq/basp21.html#0005
標準入力から0~20の範囲の実数のデータ列を読み込み、その数の出現個数に関するヒストグラムを書き出すプログラムを作成して下さい 以下、条件です ・1行目にはデータの個数が記載されている。1 行目を読み込んだ後に，データ列を格納する配列を malloc 関数を使って確保する。 ・データ列を引数とするヒストグラム描画のための histogram 関数を作成する。 ・データ列のそれぞれの実数値を四捨五入して得られる数値でヒストグラムを作る。 ・数え上げる整数値の範囲は、データ列の最小値から最大値まで。 ・ヒストグラムの棒は、半角のアスタリスク * を 1 個分として表現する。 実行例はこんな感じになります。 入力 12 2.2 3.7 3.1 2.9 8.6 2.3 6.6 3.2 6.7 5.9 2.8 7.2 出力 2 ** 3 **** 4 * 5 6 * 7 *** 8 9 * 10 どうかよろしくお願いいたします。
VBAのボタンイベントにおけるインスタンス変数を他のボタンイベントでも利用する方法ボタン押下（イベント）が発生する度に、動的配列に要素を追加して、とあるクラスインスタンスを格納させたいと思っています。 その後、別のボタン押下（イベント）でその動的配列に格納したインスタンス情報を使いたいのですが、どうもうまくいきません。 下記に現状のコードを大まかに記載いたしました。 解決策を教えていただけないでしょうか。 ＜大雑把な現在のコード＞ クラスモジュール class A() @@@@ end class 標準モジュール public dim 動的配列名() as object public dim i as integer sub ボタンXを押したら() redim 動的配列名(1) set 動的配列名(i) = new classA i = i +1 end sub sub ボタンYを押したら() 動的配列名(i -1).ファンクション end sub 補足： ボタンＸとボタンＹは別のタイミングで発生させたい。また、ボタンＹは必ず発生するとは限らない。 このとき、ボタンＹのファンクション実行時に「インスタンス変数またはwith~」 というエラーが発生。 自分の考え： ボタンＸのサブプロシージャにおけるredimがプロシージャ内の適用範囲のためボタンＹサブプロシージャでは参照できないのではないかと思っています。 しかし、やり方が思いつかずに悩んでいます。 以上です。 よろしくお願いいたします。
C#のVisualStudioでのビルドで、OSの環境変数が定義されている時のみ有効になるようなプリプロセッサ条件を書きたいのですが、方法はありますか？#if ENV_ENABLED #endif
ソースファイル比較用のツールで タブとスペースを区別しないように出来ないでしょうか と言うのも、修正後のソースの変更していないところが開発環境の自動補正機能でスペースだったところが全部タブに置き換わってしまったのです そのため、同じソースなのに、比較ツールを使用すると「変更箇所」として検出されてしまいます DFやWinmergeで解決出来ないでしょうか また、他のツールでそういうところを検出しないようなツールは無いでしょうか
エクセル2016 VBAで教えてください。アクティブシートのワークシート名を取得する場合、 MsgBox ActiveSheet.Name で取得できますが、 ワークシート名ではなくアクティブなオブジェクト名を取得するにはどのようなコードで取得できますか？ 下の写真の例ですと、Sheet11(予定表)がアクティブシートの場合、 「Sheet11」を取得したいです。 よろしくおねがいいたします。
VBで作成したシリアル通信ソフトのデータ表示更新の早さについて 現在VB2015を利用して、組込みマイコンからのシリアル通信データを受信して グラフを表示させるソフトを作成しています。組込みマイコンのソフトは、テストの為にボリュームを可変させて ADコンバータの値を送信しています。 Tera Termというフリーのソフトでデータを受信すると、ボリュームの可変によって 表示される値はほぼリアルタイムに更新されますが、自分が作成した VBの通信ソフトでは、グラフ表示に反映されるのが遅いため、 テキスト表示させてみましたが、こちらでも数秒くらいの遅れが生じます。 VBの通信ソフトは、色々な所から参考にさせて頂いており、 一般的なつくりかと思います。また、VBベースのサンプルソフトを２個くらい 落として走らせましたが、同じ様に、データ更新が数秒かかっています。 VBで作成する通信ソフトはこの程度の遅れは発生するものなのか、 それとも私の使い方が悪い、この方法だと早いというがありましたら ご教授頂けないでしょうか？ 通信間隔：10msec ボーレート：38400 通信データ：15データ スタートデータ(1)+アスキーデータ(4*3)+CRLF(2) Private Sub SerialPort1_DataReceived(ByVal sender As Object, ByVal e As System.IO.Ports.SerialDataReceivedEventArgs) Handles SerialPort1.DataReceived Dim strDataReceived As String Dim add As New AddDataDelegate(AddressOf AddData) Try strDataReceived = SerialPort1.ReadLine Catch ex As Exception strDataReceived = ex.Message End Try IDS_RXDATA.Invoke(add, strDataReceived) End Sub
VB Express 2013 web操作 "image"のクリック VB Express 2013を用いてweb上のimage(ログインボタン)をクリックしたいです。 具体的には、下記URLのようなサイトにID、パスワードを入力してログインボタンを押し自動 でログインするプログラムを作成したいです。 https://www.netbk.co.jp/wpl/NBGate 下記のようなプログラムでID、パスワードは入力できるのですが、 ログインボタンを押してログインすることができません。 クリック部のコードどのようにしたらよいのでしょうか？ Dim elem As HtmlElement = Nothing 'パスワード、ＩＤ入力 For Each elem In .Document.GetElementsByTagName("input") If elem.Name = "userName" Then elem.InnerText = "" elem.InnerText = "ｘｘｘｘｘｘ" End If If elem.Name = "loginPwdSet" Then elem.InnerText = "" elem.InnerText = "ｘｘｘｘｘｘ" End If Next 'ログインボタンのクリック For Each elem In .Document.All If elem.Name = "" Then elem.InvokeMember("click") Exit For End If Next
VBScriptのRegExpで \p{Han}+ （漢字に一致）は使えないのですか？マッチしませんでした。 re.Pattern = "\p{Han}+" Set colMatches = re.Execute("yahoo知恵") For Each Match In colMatches MsgBox Match.Value Next
VBAからのIE操作について。VBAからHTMLのtdタグを取得する際に、rowspanが含まれる時、rowspanの値のみを取得する方法はあるでしょうか？ tdのouterHTMLにInStr関数でrowspanの有無を判別してから値を取得する。といった方法は自分で思い付きましたが、他に良い方法はあるでしょうか？ VBAは触りだして一年程経ちましたが、HTMLに関する知識は今勉強中、程度のレベルです。
アクセスVBAからエクセルのマクロを開いた場合のダイアログを表示しないようにしたいです。Dim xlApp As Object Dim xlBook As Object Dim stPath As String stPath = CurrentProject.Path & "\テストExcel.xls" Set xlApp = CreateObject("Excel.Application") Set xlBook = xlApp.Workbooks.Open(stPath) xlBook.Application.Run "マクロ名" xlBook.Close Set xlBook = Nothing xlApp.Quit Set xlApp = Nothing 上記のVBAをアクセスで動かすと、エクセルから「保存しますか？」というダイアログが表示されます。 ダイアログを表示しないで上書き保存するように組むためにはどのようにしたら良いでしょうか。 ご教授宜しくお願い致します。
エクセルでマクロをし始めたばかりのため、皆様にお教え頂きたいです。1度質問させて頂きましたが上手くいかず急ぎの為、何度も質問させて頂き申し訳ございません。 今開いてる様式Aシートに転送ボタンを作成します。これとは別に様式Bシートを作り、様式AシートのセルC4からC27までと、様式BシートのセルC4からC23までのデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内のマクロというブック、様式1ならびに2の名前のシートにセルB9,C9,D9…といったように縦並びから横並びに変えて毎日までに転送しようと思います。(行と列を入れ替えて2シート一括転送コピー。) その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub CommandButton1_Click() Call Macro1 End Sub Sub Macro1() Dim GYOU As Long Workbook.Open Filename:=”C:¥共有¥マクロ.xlsx” ActiveSheet.Unprotect ThisWorkbook.Activate With Workbooks(”マクロ.xlsx”) Sheets(”様式A”).Activate Sheets(”様式A”).Unprotect GYOU = .Sheets(”様式1”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式1”).Range(”A” & GYOU & ”:AA” & GYOU + 1880).Value =Sheets(”様式A”).Range(”A2:AA2000”).Value Sheets(”様式B”).Activate Sheets(”様式B”).Unprotect GYOU = .Sheets(”様式2”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式2”).Range(”A” & GYOU & ”:W” & GYOU + 1880).Value =Sheets(”様式B”).Range(”A2:W2000”).Value Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Close SaveChanges:=True End with End Sub この様なマクロを組んでみましたが、転送先の様式1シートにはデータが転送されているものの保護が掛かっておらず、様式2シートは保護が掛かったままデータが転送されていない状態です。 ポイントとしましては以下の通りです。 ①様式A,Bのシートは様式1,2へそれぞれ転送。 ②毎日データ転送し、様式1,2へは下の行へその都度入る。 ③様式A,B及び様式1,2は入力箇所以外は保護が掛けられ、データ転送後も保護が掛けられた状態のまま保存。 どの様に修正すれば良いのでしょうか？ お手数をおかけして本当に申し訳ございませんが、よろしくお願いします。
VB2015を使用してOLEDB4.0でAccessMDBに接続しています。 ネットで次のようなソースを見つけました。Public Function ExecuteSql(ByVal sql As String, Optional ByVal tot As Integer = -1) As DataTable Dim dt As New DataTable Try Dim sqlCommand As New OleDbCommand(sql, _con, _trn) If tot > -1 Then sqlCommand.CommandTimeout = tot End If Dim adapter As New OleDbDataAdapter(sqlCommand) adapter.Fill(dt) adapter.Dispose() sqlCommand.Dispose() Catch ex As Exception Throw New Exception("ExecuteSql Error", ex) End Try Return dt End Function エラーがCatchされたときにExceptionで落とすのでは無く上位で リトライの判断をすべくなにがしらかエラー処理をここでしておきたいと 思っています。 この関数の型がDataTableのため取得出来なかった状態(Null? DBNull?)を 返したいのですが「DBNullはクラス型であり、式として使用する事はできません」や 「Nullは宣言されていません。アクセスできない保護レベルになっています」と VBに怒られてしまいます。 Catch ex As Exception dt = Null End Try のような感じで上位に空である（処理が失敗した）事を 返し、上位ではそれを判断したい（出来ればそれを見る方法）のですが なかなか回答に出会えませんでした。 教えて頂けないでしょうか。 よろしくお願いします。
VBAを用いてIEを操作する方法について。はじめまして初心者です。VBAを用いてIEを操作し、検索結果をエクセル若しくはテキストファイルに保存したいです。サンプルコードを用いて助言していただければ幸いです。よろしくお願いいたします。
VB.netです。 そのコレクションの並び替えで、先頭から（例えば）３文字目以降で並び替えをして、その結果をリストボックスに表示させたいのです。現時点のコードは次のようになっています。Public Class Form1 Private Sub Button1_Click_1(sender As Object, e As EventArgs) Handles Button1.Click ListBox1.Items.Clear() Dim item_dataList As New Class1 Class1.Main() For Each i As String In item_dataList.d ListBox1.Items.Add(i.Substring(2)) Next End Sub End Class Public Class Class1 Shared _d As New List(Of String) Public Shared Sub Main() _d.Clear() Call a1() _d.Sort() _d.Reverse() End Sub Private Shared Sub a1() _d.Add("33いうえ") _d.Add("00えあか") _d.Add("11あいう") _d.Add("22いおか") End Sub Public ReadOnly Property d() As List(Of String) Get Return _d End Get End Property End Class 先頭２文字とそれ以降は連動させたいので、単にリストボックスの表示だけ並び替えをするのではなく、コレクションそのものを先頭からＮ文字目以降で並び替えさせたいのであります。 ご教示方よろしくお願いします。
マクロ初心者です。デスクトップに 「雛形集」フォルダがあります。 その中に 雛形1.xls 雛形2.xls 雛形3.xls ・ ・ ・ と雛形のブックが複数あります。 各雛形ブックにはシート1のみです。 デスクトップの別のフォルダに 「マクロ実行.xlsm」 というブックがあります マクロ実行ブックのシート1に チェックボックスで □「雛形1」 □「雛形2」 □「雛形3」 ・ ・ ・ とActiveXで挿入したチェックボックスが 複数あります。 コピーしたい雛形にチェックをいれて コマンドボタンをクリックすると 新規ブックを作成 ↓ 新規ブックに選択した雛形ブックのシートがコピーされる。 ↓ コピーされたシート以外は消去される。 ↓ 新規ブックがデスクトップに保存される。 ということがしたいのですが、 全くわかりません。 どのように組めばいいか、 コードの記載をお願いします 簡単に言うと 選択した雛形ブックをコピーしてデスクトップに保存 です。 よろしくお願いします。
BASICについて質問です 縦10行横3列の一覧表を作成しているのですが 10 CLS 20 READ N,M 30 DIM A(N,M) 40 FOR I=1 TO N50 FOR J=1 TO M:READ A(I,J):NEXT J 60 NEXT I 70 CLS 80 PRINT(I,J) 1000 DATA 10,3 1010 DATA 93 90,81,35,54,55,32,48,34 1020 DATA 63,64,51,76,78,71,39,60,43 1030 DATA 57,58,51,77,76,65,80,78,60 1040 DATA 65,90,70 out of data 50と表示され出力できません。どこを直せばよいでしょうか？
【Excel2010】vbaご教授願います。 添付画像の、 黄色セルに入力されている数値を、 マクロボタンを押すと一括でdeleteするマクロをご教授願います。（※ deleteを実行する前に、メッセージボックスでYES NOを聞いてくる） できましたら、コードの意味も一緒に解説いただけると幸いです。 宜しくお願い致します。
Excel VBAについてです。A1のセルに「A100」と入力したら、A100のWordファイルを開く A１のセルに「B100」と入力したら、B100のWordファイルを開く A1のセルに「C100」と入力したら・・・ といったようなプログラムを作りたいのですが、初心者すぎて上手く行きません。 よろしければ御指南お願いします。
エクセルマクロVBAについて質問です。 ひとつづつエクセルファイルを実行すると問題ないのですが、 LOOPで複数ファイルをまとめて実行すると、 画像が一行分下に落ちたようになってしまいます。一つづつだと起きない事が、ループでやると起こります。 複数一括で実行させたいのですが 改善策はありますか？
EXCEL VBA について教えてください。当方初心者です。 ユーザーフォームを利用して同じデータをシート1とシート2にデータを入力するようにしたいです。 ユーザーフォームではテキストボックス1に品名・テキストボックス2に価格・テキストボックス3に数量が 入るようにしてあります。同じようにテキストボックス4に品名・テキストボックス5に価格・・・・と 商品データを5つ分入力するよう作成しています。コマンドボタンによりシート1とシート2に同じデータを転記したいのですが シート1には入力した全商品データを横に並べて1行に入力するように下記のように設定しています。 Private Sub CommandButton1_Click() Dim ln As Long ln = Range("C1048576").End(xlUp).Row Cells(ln + 1, 1) = TextBox1.Value Cells(ln + 1, 2) = TextBox2.Value Cells(ln + 1, 3) = TextBox3.Value Cells(ln + 1, 4) = TextBox4.Value Cells(ln + 1, 5) = TextBox5.Value Cells(ln + 1, 6) = TextBox6.Value ・ ・ ・ End Sub こちらは問題ないのですが、シート2への入力の仕方がわかりません。 シート2は1行に1つの商品分の商品名・価格・数量のみ入力され、2つ目の商品2は商品1の下の行に商品名・価格・数量 が入るようにしたいのです。 商品名・価格・数量 商品名・価格・数量 商品名・価格・数量 ・ ・ ・ 上記の設定に加えてどのようにコードを設定してあげればいいのかご教授ください。
vbaに関する質問です。 たびたびお世話になります。 あるサイトのフォームにアクセスして、name要素を取得する、ということはvbaでは可能なのでしょうか？いくつかのサイトに自動ログインしたいですが、name要素をいちいち全てのサイトのソースを確認して、指定するのは大変なので、 先に、formを解析するようなツールを作った方が楽なのではと思い始めました。 イメージとしてはこのような感じです。 ---------サイトAのhtml------------- <input type="text" name="id" maxlength="10" istyle="3" value=""> <input type="text" name="ps" maxlength="10" istyle="3" value=""> --------------------------------------- 実行結果 -------------------------------------- id ps --------------------------------------- ---------サイトBのhtml------------- <input type="text" name="username" maxlength="10" istyle="3" value=""> <input type="text" name="password" maxlength="10" istyle="3" value=""> --------------------------------------- 実行結果 -------------------------------------- username password --------------------------------------- のようなイメージです。 フォーム入力について調べていると、name属性を指定して値をセットする方法についてはわかったのですが、 そのname属性を、VBAを用いて取得する方法についてはちょっとわからなかったので質問させて頂きましたm(_ _)m
エクセル マクロで、他のブックを開くVBAについて質問です。１つのエクセルブックから、「伝票」という名前ののエクセルを開き、「参照」シートへデータの貼り付けを行いたいのですが、以下のように作成したら ブックを開けない、とエラーが表示されます。 「伝票」のエクセルにはリンクされているものがないはずなのですが、開くと 他のデータソースへのリンクが含まれています と表示されます。 それが原因なのでしょうか？ 間違っている箇所を教えていただけないでしょうか。よろしくお願いします。 Range("A1:D1").Select Application.CutCopyMode = False Selection.Copy Set TargetBook = Workbooks.Open(Filename:="伝票.xlsx") ThisWorkbook.Activate With TargetBook.Sheets("参照") Range("A1").Select ActiveSheet.Paste Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False
先ほどVBAの質問で回答を頂いた者です。 もう一点知りたいのですが、 複数のシートがあって、全シート対象に実行かけるには どのようにVBAを書いたらよいでしょうか？
Ｃ＃で初心者にも分かりやすいような（なるべく短い）電卓のソースコードください
ＡＣＣＥＳＳの使用方法について フォーム上で内容を打ち込んで反映させたいです。 リストボックス①と②があるとします。①に値集合ソースで各課の名前を入れて、それと連動し作成したテーブルから課のデータが ②に記載されるようにしました。(①で課を選択すると②にその課のデータが出現する) そして本題ですが、②のリストボックスに手入力で直接データを入力し、 内容を更新(テーブルも)出来るようにしたいです。 帳票フォーム？サブフォーム？等を駆使すればいいのでしょうか？ よろしくお願いします。
ExcelVBAでフォーカスの移動がうまくいかずに困っております。 お詳しい方、是非教えてください。テキストボックスが a1 a2 (a3) (a4) b1 b2 (b3) (b4) という風にならんでおり、a3 と a4 は当初は非表示となっていますが、a2 の値によって a3 もしくは a4 のどちらかを表示することまでは成功しています。 (b1～4についても同様です。) ただ、a2 に値を入力してEnterキーを押した後、そのままでは b1 にフォーカスが移動してしまうため、表示された a3 や a4 にフォーカスを移せないか下記のようにしてみました。 Private Sub a2_Afterupdate() Dim n As String If a2 = 123 then n = 3 Else n = 4 End If Me.Controls("a" & n ).Visible = True Me.Controls("a" & n ).SetFocus '←今回つけ加えた部分 End Sub しかし、このようにするとどうしてかフォーカスが a3 でも b1 でもなく、b2 へ移ってしまいます。 a2_Afterupdate での処理がいけないのかと思い、a2_Exit や b1_Enter 等でなんとかできないかとやってはみましたが、全て上手くいきませんでした。 また、本命へのSetFocusの前に違うものへ一度飛ばしてみても、ダメでした。 どなたかお詳しい方、どうして上手くいかないのか、どうしたら上手くいくのかを教えてください。 よろしくお願いします。
エクセル2016 VBA でのセルの範囲の選択方法 添付図のような赤枠範囲を選択するにはVBAで行うにはどうしたらよろしいでしょうか。 途中何も入力しない列や行に変化する場合もあります。また、同じシートに複数の表があります。 できますでしょうか？ よろしくお願いします。
エクセルVBA 「エラーがある時は無視して続きを続行」を表現したい前回の質問http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q10159610945 「エクセルVBA 無限ループになるのを防ぐ処理がしたい」 で、VBAのコード上に変数の取得のコードがあり、参照元に探す値がない場合永遠に探し続ける無限ループになるのを解決するのに以下のコードを教えてもらいました。 Sub TEST1() 、 、 、 y = Application.CountIf(Columns("B"), "1") ' 教えてもらったのは以下の部分です。 If y = 0 Then End If y > 1 Then Range("AA1:AC1").AutoFill Destination:=Range("AA1:AC1").Resize(y) 、 、 、 、 この If y = 0 Then End を入れる事により、 変数ｙにはいる項目がひとつもない場合はマクロを強制終了するマクロとなりましたが、これだと例えば Sub マクロを一括で処理() Application.Run "ＴＥＳＴ1" Application.Run "ＴＥＳＴ2" Application.Run "ＴＥＳＴ3" End Sub などといくつかのマクロを連続で処理するマクロを組んだ場合、TEST1の時点でエラー発生でマクロが終了してしまうとTEST2、TEST3のマクロには続いてくれずにそこで止まってしまってこまっています。TEST1でエラーがあっても終了するのはTEST1のみとし、続きのTEST2とTEST3はマクロを実行してもらう処理の方法を教えて下さい。 Sub マクロを一括で処理() のVBAになにかを記述するのか、 Sub TEST1() のほうになにかを追加するべきなのかもわかりません。 よろしくお願い致します。
エクセル CONCATENATEについて質問です。 フィルタで表示されたセルからのみ抽出したいのですがやり方がわかりません。 過去の質問に同じ条件の質問がありVBAに Function SUBCONCATENATE(rngArea As Range) As String Dim R As Range For Each R In rngArea If R.EntireRow.Hidden = False Then SUBCONCATENATE = SUBCONCATENATE & R Next End Function を張り付けてみたのですがNextに対するForがありませんと表示され出来ませんでした。 どなたか詳しい方教えてください。 よろしくお願いします。
エクセル2006、VBAの配列のことで教えてください。ある、一定のループ処理で、 数値 7 8 7 7 6 5 9 3 7 9 （数値数と数値はランダムです） と返したとします。 これを重複ないような形で、配列の要素数を確定したうえで一元配列にうまく入れる方法をVBAで設定する方法ありますか？（できれば、短い命令がいいのですが） 具体的には、上の数値の場合ですと 動的配列HAIRETUに ReDim HAIRETU(数値は6となりますがまずここを計算したい） でもって、HAIRETUの各要素は HAIRETU(1)=7 HAIRETU(2)=8 HAIRETU(3)=6 HAIRETU(4)=5 HAIRETU(5)=9 HAIRETU(6)=3 といった感じです。 （Option Base 1で予め配列の下限値は設定しています） よろしくお願いいたします。
VBAで生成したチェックボックスのアドレス取得について Excel2013 Excel2013 VBAで生成したチェックボックスのアドレスを取得したいのですが、うまく動かないようです。チェックボックスが指定したアドレスにあるにも関わらず、TopLeftCell.Addressでアドレスを取得しようとすると、異なるアドレスが返ってきます。ただし、一度シートを保存すると正しいアドレスが返ってきます。 Set chk = .CheckBoxes.Add(Left:=...略 chk.Name = "chkSelect" ...略 という風にチェックボックスを生成します。 チェックボックスは意図した場所に作られています。 その後、 Dim myChk As CheckBox Dim strTest As String For Each myChk In ActiveSheet.CheckBoxes strTest = strTest & myChk.TopLeftCell.Address & vbCrLf Next MsgBox strTest このようにメッセージボックスですべてのチェックボックスのアドレスを取得しています。 ところが、A6～A10にチェックボックスを作ってアドレスを取得したところ、 $A$6 $A$6 $A$6 $A$6 $A$6 という風に、最初のチェックボックスと同じ値を返してきます。 シートを一度保存すると、正常な値が返ってきます。 $A$6 $A$7 $A$8 $A$9 $A$10 ここに、さらにA13までチェックボックスを追加すると、 $A$6 $A$7 $A$8 $A$9 $A$10 $A$6 $A$6 $A$6 という風に、また最初のチェックボックスと同じ値が返ってきます。 いろいろ検証してみたのですが、どうしても保存前に正しいアドレスをチェックできません。 ちなみに、最終的に行いたいことは、指定したアドレスのチェックボックスの削除です。 正しいアドレスが取得できるときには、正しく削除できています。 Excel2013を使用しています。 解決法をご存知の方、どうかお願いいたします。
ACCESS 2010を利用しています。 タブコントロールでフォームを作成したのですが、 タブの各ページの背景色を白から変更できません。プロパティシートには背景色の設定項目はありませんので、 Me.Section(0).BackColor = 16579556 を入力したところ、タブコントロールの背景に色はついたのですが、 書くページは白のままです。 恐れ入りますが、どのように設定するのか、ご教示お願いします。
毎日更新されるcsvデータをAccessとリンク付けしています。csvデータの1列に余計な列があるため、1行削除したcsvデータを他のファイルにエクスポートして エクスポートしたファイルのデータをリンク付けしています。 いくつか同じ処理を行うファイルがあるため、それぞれ更新ボタンを作成して、イベントにファイル名だけ変えています。 この更新を1つのボタンで処理したいのですが、どのように記載するといいのでしょうか？ ※それぞれAの部分がを変えてボタンを複数作成しています。 ----------------------------------------------------------------------------------------------- Private Sub 更新1_Click() Dim fSo As Object Dim buf As Variant Dim f As Object Set fSo = CreateObject("Scripting.FileSystemObject") With fSo.GetFile("C:\csvファイル\A.csv").OpenAsTextStream .SkipLine buf = .readall .Close End With Set f = fSo.OpenTextFile("C:\csvファイル\リンク\A.csv", 2, True) f.Write buf f.Close MsgBox "更新1が完了しました。" End Sub ------------------------------------------------------------------------------------------
マクロでの質問です ある特定のフォルダのエクセルブック名を一括で変更したいのですが 15本番データ20160301テスト1.xlsx・・・・のブック名の15本番データ部分を16テストデータに変更したいのですが コードがわかりません 下記コードをどのように修正すればよろしいでしょうか Dim FLname As String Dim FL As String Dim DL As Variant FL = ThisWorkbook.path & "\" FLname = Dir(FL & "\*.xlsx") Do While FLname <> "" IF Flname <> *15本番データ FLname = Dir() Loop
エクセルのマクロについて教えてください。 エクセル97-03で使えていましたが、2010バージョンになったら、マクロが使えなくなりました。2つのブックを使っているものなのですが、2010バージョンで開くとブックがばらばらになってしまい、保存は1枚のブックしかできず、エラ－9がでます。 ちなみに、保存はexcelマクロ有効ブックに変えています。 私は、マクロを組むことができず、前任者が作ったものをそのまま使っているのですが、どうすればいいでしょうか？ Private Sub Workbook_BeforeClose(Cancel As Boolean) '印刷ボタンアイコンを使用できるようにする Application.CommandBars("Standard").Controls(6).Enabled = True '各シートの値を０にする Worksheets("A").Range("D2:D9").Value = "" Worksheets("B").Range("A25").Value = "" End Sub Private Sub Workbook_Open() Application.ScreenUpdating = False ActiveWorkbook.Unprotect Sheets("B").Select Cells(25, 1).Value = ActiveWorkbook.Name Dim 左ウィンドウ名 As String 左ウィンドウ名 = Cells(30, 1).Value Dim 右ウィンドウ名 As String 右ウィンドウ名 = Cells(31, 1).Value Windows(右ウィンドウ名).Activate Sheets("C").Select Windows(左ウィンドウ名).Activate Sheets("D").Select ActiveWindow.ScrollColumn = 1 '画面を見やすくする ActiveWindow.ScrollRow = 1 '画面を見やすくする Range("E11").Select ActiveWindow.FreezePanes = True ActiveWindow.ScrollRow = Cells(2, 8).Value Range("E10").End(xlDown).Select ActiveWindow.WindowState = xlMaximized '印刷ボタンアイコンを使用できなくする Application.CommandBars("Standard").Controls(6).Enabled = False ActiveWorkbook.Protect Windows:=True Application.ScreenUpdating = True UserForm1.Show vbModeless End Sub
ACCESSの条件式について Private Sub 連絡先_BeforeUpdate(Cancel As Integer)If Me.連絡先 = "無" Or Len(Me!連絡先) > 0 And Len(Me!連絡先) <> 11 Then MsgBox "携帯は11桁です。" Cancel = True Exit Sub End If End Sub フィールドの連絡先に、既定値で”無”としています。 フィールドの連絡先が、”無” または、11桁の数字が入力れてたら、登録できるようにしたいのですが、 上記の条件式ですと、無のとき登録できないのですが、原因がわからず困っています。 どなたか、ご教示お願いします。
("Book2.xlsm").から、("Book1.xlsx").にコピーをしたく、以下のコードを書きました。 ですが、どちらも実行時エラー9となります。 どこが悪いのか判りません。ご教授をお願いします。 Workbooks("Book2.xlsm").Worksheets("wk").Range("F10").Copy Workbooks("Book1.xlsx").Worksheets("Sheet1").Range("C3") ThisWorkbook.Worksheets("wk").Range("F10").Copy Workbooks("Book1").Worksheets("Sheet1").Range("C3")
まだVBAを始めたばかりです。 今バブルソートをやっているのですがD1セルからD10セルにある数字をソートしなければなりません。 これではD1セルからD10セルに０しか入りません。どのようにすればちゃんとソートできるのでしょうか？？ Dim i As Long Dim j As Long Dim work As Long Dim age(10) As Long age(10) = range("D1:D10").Select i = 1 j = i + 1 For i = i To 9 For j = i To 10 If age(i) > age(j) Then work = age(j) age(j) = age(i) age(i) = work End If Next j Next i range("D1:D10") = age(10) End Sub ちなみにこのやり方をネットから引っ張ってきたのですが最初の行を入れただけでコンパイルエラー修正候補 変数とでました。どうすればよいのでしょうか？？ よろしくお願いします。 for( i = n-1 ; i >= 2 ; i = i-1 ){ for( i = n-1 ; i >= 2 ; i = i-1 ){ for( j = 0 ; j <= i-1 ; j = j+1 ){ if( a[j] > a[j+1] ){ tmp = a[j]; a[j] = a[j+1];
JANコードでアマゾンで検索して、出てきた商品のURLをとりたいのですが、VBAを書いていただけませんか？たとえば、JANコードが4573222377046だと4573222377046をアマゾンのトップ画面の検索窓で検索して出てきた商品はURLがhttp://www.amazon.co.jp/dp/B01BK7OKHAです。
weblioから主な意味、の右側の一文をコピーするマクロを作成したいのですがどのようにすれば実現することができるでしょうか。もっというと英単語を入力してボタンを押せば、エクセルに英語/日本語と貼り付けられるようにしたいのです。 私の拙考だと全文をまず取得して主な意味、文字列"主な意味"を検索して…というのが限界です。これを実装する技術もありませんが。 UWSCでwebページに対して初歩的な操作はできるのですが、今回どうすればいいのか検討がつきません。 何々を勉強すればいい、というのでも構いませんので、回答よろしくお願いいたします。 weblioのページ見本：http://ejje.weblio.jp/content/arbitrarily
Excel VBA 取り出す範囲を指定してcsvファイルを作成したい下記コード(VLookup)で値を抽出して表示させた後値の範囲(10～最終行)に関連する列の値を指定して希望の並びにしてcsvファイルを作成したいです。 Sub 番号表示() Dim MaxRow As Long Dim i As Long Dim a As Variant With Worksheets("Sheet1") MaxRow = .Cells(Rows.Count,1).End(xlUp).Row For i = 10 To MaxRow a = Application.VLookup(.Cells(i,1).Value, _ Worksheets("Sheet2").Range("A:B"), 2, False) If IsError(a) Then .Cells(i, 2).ClearContents Else .Cells(i, 2).Value = a End If Next End With End Sub この状態から A列(1列)の 10行目から最終行 →csvのA列(1列)の1行目～ B列(2列)の 10行目から最終行 →csvのD列(4列)の1行目～ E列(5列)にある値の左4桁 10行目から最終行 →csvのB列(2列)の1行目～ E列(5列)にある値の右6桁 10行目から最終行 →csvのC列(3列)の1行目～ に貼りつけてcsvファイルを作成 作成されるcsvの名前は Sheet1のG1セルの値.csv で作成 作成される場所はデスクトップ にすることは可能でしょうか？ 前回質問させてもらったのですが Left,Right関数を使った取り出し方が必要になり自分では解決できませんでした。 よろしくお願いします。
マクドナルドマネージャーです。 クローズのタスク作業で質問です。 ストックチャートの出力をする時は、今日の日付から今日の日付でしたか？
Gmailの本文を抽出したいです。Google Apps ScriptかVBAでコードを書いていただけませんか？以下のGメールで、A、B、Cを抽出したいです。 たまに複数商品、メールにかかれているときがあり、そのときはそれぞれの商品のDやEも抽出したいです。 GメールはWというラベルをつけています。 ーーーーーーーーーーーーーーーーー OOO様、 Amazonに出品された商品に対する注文が確定いたしました。 このEメールの手順に従って、商品を出荷し、出荷通知を送信してください。 注文番号: A 以下の商品を発送してください。 商品: X コンディション： X コンディション説明： X X X 出品ID: 0000 SKU: B 数量: 1 注文日: 2000/00/00 価格: ￥ 0000 配送料: ￥000 Amazon手数料: (￥ C) 振込金額合計: ￥ 0000 （複数商品のときは以下が続く） 商品: Y コンディション： Y コンディション説明： Y Y Y 出品ID: 1111 SKU: D 数量: 1 注文日: 2000/00/00 価格: ￥ 0000 配送料: ￥000 Amazon手数料: (￥ E) 振込金額合計: ￥ 0000
マックのＡｕｔｏｍａｔａｏｒってフォルダ内に別のフォルダがいくつかある場合、つまりフォルダが複数の階層に分かれている場合、特定の深層の階層を検索したり、全階層を検索したりすることは出来ないのでしょうか？
Debug Assertion Failed! Program: ...cuments¥Visual Studio 2015¥Projects ¥kadai05¥Debug¥kadai05.exe File: minkernel¥crts¥ucrt¥src¥appcrt¥stdio¥input.cpp Line: 29 Expression: stream != nullptr For information on how your program can cause an assertion failure, see the Visual C++ documentation on asserts. (Press Retry to debug the application) デバックしようとするとこれが出てくるのですがどうしたらよいですか？
ｖｂａについての質問します ① マスターシートには、3列のデータあります。管理番号を使って、検索の機能でその行を探して、マスターシートのNｏが書いてあるセルを取得します。その取得したマスターシートのNｏ検索を掛けて、その結果をコンボボックスに、２列表示されます。 ② コンボボックスを選んでも（修正）２列が表示されるコードを探しています NO 日付 品Ｎｏ 品種 1 4月1日 1 あさ 2 4月2日 2 いす マスターシート 品Ｎｏ 品種 年 1 あさ １９９２ 2 いす ２０００ 例えば…管理番号の１で検索したら、コンボボックスに あさ １９９２と表示されるようにコードを書きたい。 コード 初期化 With Worksheets("マスターシート") lRow2 = .Cells(Rows.Count, 1).End(xlUp).Row End With With ComboBox3 .ColumnCount = 3 .ColumnWidths = "0:50;50" .RowSource = "マスターシート!A2:d" & lRow2 End With 検索ボタンをクリックした後 検索 = TextBox1.Text 行 = .Range("A:A").Find(検索).Row w = Worksheets("Sheet1").Cells(行, 4).Value Set rng = Worksheets("マスターシート").Range("A:A").Find(w, LookIn:=xlValues) r = rng.Row With UserForm2.ComboBox3 .AddItem Worksheets("マスターシート").Range("A" & r).Value .List(UserForm2.ComboBox3.ListCount - 1, 2) = Worksheets("マスターシート").Range("B" & r).Value .List(UserForm2.ComboBox3.ListCount - 1, 3) = Worksheets("マスターシート").Range("C" & r).Value End With どうでしょうか よろしくお願いします。
マクロについて質問です。 同じブックにあるいくつかのシートに同じ数式の処理をしたいです。 数式はなんとなくできたのですが、１つのシートに何回も同じ処理を繰り返しています。そして、特定の１つのシートは除きたいです。 色々なブックに対応させたく、ブックのシート数とシート名はそれぞれ違います。 よろしくお願いします。
アクセスでcsvのデータを読み込みをしたいのでモジュールに入力してみたのですが、、、 しかし、下記では、一枚のシートに集約されてしまう… ・ファイル：A,Ｂ,C…とファイル(各ファイルシート1枚のみ）が50個ほどある ・accessに、インポートした際は ”テーブル”にはA,B,C… と作りたいのです。 どうしたら、ファイルごとにテーブルを作ることが出来ますか？よろしくお願いします ************************* Sub cmdImport() Dim myFilename As Variant Dim myPath As Variant myPath = "C:\Users\Desktop\過去データ\" myFilename = Dir("C:\Users\Desktop\過去データ\***.csv") Do Until myFilename = "" DoCmd.TransferText acImportDelim, "", "csv定義" & "csv", myFilename, True myFilename = Dir() Loop End Sub *************************
マクロ初心者です。 bookAで選択した行をコピーし、BookB最後の次の行にペーストするマクロを作りました。 なおかつ、コピー完了した行のA列（元データbookAのA列）に、『その行はコピー済み』の意味で印を入力したいです。 １行ずつなら出来たのですが、複数の行のA列にコピー済みの印を入力することができません。 任意の複数の行（コピーしたい行がその時によって違う）が選択されている場合、その複数の行、それぞれのA列に文字を入力したいです。 セルに色を付ける方法なら簡単そうでしょうか？ 色分けしているセルがあるので、なるべくA列に印を付ける方法がしりたいです。 何か方法はありますでしょうか？ どなたかご教授お願い致します。
Excel VBAのchangeイベントを各セル一度だけ実行させるにはどうすればよいしょうか？I列の数値が変わったら各セルにつき一度だけ右隣のセルに値をコピーする（二度目以降の変化は無視する）マクロを作成しているのですが、「一度だけ」という部分が作れません。 どのように作成すれば良いか、お詳しい方にご教授頂ければ幸いです。 今の所出来上がっているのは、以下のところまでです（I1からI3まで）。 Private Sub Worksheet_Change(ByVal Target As Range) If Not Intersect(Target, Range("I1")) Is Nothing Then Range("J1").Value = Range("I1").Value End If If Not Intersect(Target, Range("I2")) Is Nothing Then Range("J2").Value = Range("I2").Value End If If Not Intersect(Target, Range("I3")) Is Nothing Then Range("J3").Value = Range("I3").Value End If End Sub
まだ前回の質問が解決しておりませんが、どうかお力をお貸しくださいませ。 こんなコードを書きました。<div id = "table"> <table border="1"width="700" height="635"> <tr><td id ="f1" ></td><td id="f2"></td><td id="f3"></td></tr> </div> ～～～ var arrayD = ["f1","f2","f3"]; for(var i= 0;i<3;i++){ var elem = document.getElementById(arrayD[i]); elem.innerText =i; } のようにして順番には配列を作成して数字を１から選んでならべました このテーブルの中にリンクのようものを張りたいのですが、 やり方がわかりません。 どうやらこれはJavascriptには難しいようなのすが どなたかわかる方がいたらお願いいたします。
以下の関数をVBAにしたいと考えています。22行目に G22セルに =IF(AND(G$19>=$C20,G$19<=$D20),"1","") H22セルに =IF(AND(H$19>=$C20,H$19<=$D20),"1","") ・ ・ ・ BJ22セルに =IF(AND(BJ$19>=$C20,BJ$19<=$D20),"1","") 25行目に G25セルに =IF(AND(G$19>=$C23,G$19<=$D23),"1","") H25セルに =IF(AND(H$19>=$C23,H$19<=$D23),"1","") ・ ・ ・ BJ25セルに =IF(AND(BJ$19>=$C23,BJ$19<=$D23),"1","") 規則性ある数式をVBAにて一括管理したいと考えています。 皆様の知恵をお借りしたいです！
アクセス初心者です。 フォームで、テキスト1にAと入力したときに テキスト2に今日の日付が入るようにしたいです。またテキスト2に既に日付が入っているときには 変更されたくない場合はどうすればよいですか。
バッチファイル FTP 同時に実行 ftp -s:ftp_AAA_img.txt ftp -s:ftp_BBB_img.txt exit今は、上記の様にしていますが、AAAが終わったらBBBを開始します。 AAAとBBBを同時に実行(進行）させるにはどの様にしたら良いですか？
エクセル VBA 最終入力されているセルからの範囲 Sub 範囲指定()i = Cells(Rows.Count, "C").End(xlUp).RowApplication.Intersect(ActiveSheet.UsedRange, Range("C1:E" & i)).Select End sub もしC列が空白でその他の列に入力、のような場合は どのような式変わりますでしょうか すみまん 教えて頂けますでしょうか（教えて頂いたのですが更にこの質問を聞き忘れちゃいまして・・）
EXCEL VBAについて質問です。以下にプログラムを記載してあるのですが、ボタン1をクリックすると”Sample”を呼び出し、"Sample"内には"test"を1分おきに繰り返し呼び出すプログラムにしてあります。 "test"は無限に繰り返されてしまうので、ボタン2を作成し、これを押すと"Sample"を停止するようにしたつもりですが、停止しません。 どのような原因が考えられるか、どなたかお詳しい方、教えて下さい。 どうぞよろしくお願いいたします。 －－－－－－－－－－－－－－－－－－－－－－－－－ Sub ボタン1_Click() '開始ボタン DataOld = "2001/1/1" Call Sample End Sub －－－－－－－－－－－－－－－－－－－－－－－－－ Sub Sample() Call test Application.OnTime Now + TimeValue("00:01:00"), "Sample" End Sub －－－－－－－－－－－－－－－－－－－－－－－－－ Sub ボタン2_Click() '停止ボタン Dim i As Long On Error Resume Next For i = 0 To 10 Application.OnTime Now + TimeValue("00:00:0" & i), "Sample", , False 'Next End Sub
RANDBETWEEN関数で出力される乱数の分布が一様にならない…orzエクセルにて、RANDBEETWEEN関数を用いたシミュレーションプログラムを制作していますが、大変に困ったことになりました。 時系列順に並んだ各セルに、=RANDBETWEEN(1,100)/100を入力して、0.1～1.0を一様に分布させるつもりだったのですが、いざやってみると、特定の数値が偏って多く発生してしまい、2.5％程度の出現確率であったはずのものが、たいがい10％程度にまでなってしまうのです。(EX:0.665～0.690、5％を下ったのは一度だけ) しかも、これは試行回数を300近くに増やして調べたもので、本来は100回ぐらいにつき、だいたい均等に数字が現れてくれる必要があります。 ので、少なくとも現状、全く使い物になっていませんorz なんとか、これらの問題を解決したうえで、先に進まねばならないのですが、私一人の力ではどうにもならなく、皆様のお知恵をお借りできればと思い、こちらに投稿をさせていただきました。 0.1～1.0の間で、100回の試行回数についてだいたい均等に分布されるような乱数を発生させることは、エクセルにおいて可能なのでしょうか…。 ゴールデンウイーク明けのご多忙かもしれない時期に、このようなお願いをさせていただくのは気が引けるのですが、もし、お手すきの方がいらっしゃいましたら、どうかお助け願えますと幸いです。 誠に恐れ入りますが、どうぞ、よろしくお願い申し上げます_ _
RANDBETWEEN関数で出力される乱数の分布が一様にならない…orzエクセルにて、RANDBEETWEEN関数を用いたシミュレーションプログラムを制作していますが、大変に困ったことになりました。 時系列順に並んだ各セルに、=RANDBETWEEN(1,100)/100を入力して、0.1～1.0を一様に分布させるつもりだったのですが、いざやってみると、特定の数値が偏って多く発生してしまい、2.5％程度の出現確率であったはずのものが、たいがい10％程度にまでなってしまうのです。(EX:0.665～0.690、5％を下ったのは一度だけ) しかも、これは試行回数を300近くに増やして調べたもので、本来は100回ぐらいにつき、だいたい均等に数字が現れてくれる必要があります。 ので、少なくとも現状、全く使い物になっていませんorz なんとか、これらの問題を解決したうえで、先に進まねばならないのですが、私一人の力ではどうにもならなく、皆様のお知恵をお借りできればと思い、こちらに投稿をさせていただきました。 0.1～1.0の間で、100回の試行回数についてだいたい均等に分布されるような乱数を発生させることは、エクセルにおいて可能なのでしょうか…。 ゴールデンウイーク明けのご多忙かもしれない時期に、このようなお願いをさせていただくのは気が引けるのですが、もし、お手すきの方がいらっしゃいましたら、どうかお助け願えますと幸いです。 誠に恐れ入りますが、どうぞ、よろしくお願い申し上げます_ _
ExcelVBAのことで教えてください。①Range("E135").Value = Application.WorksheetFunction.Sum(Range("E2:E130")) ②If TextBox1 = Range("E135") Then MsgBox "OKです" Else MsgBox "合計が合いません!" End Sub このコードで間違っているところはありますか？ E135の値とtextbox1の値が同じでも、違くても”合計が合いません!”と出てしまいます。 ご教授ください。
マクロで圧縮ファイルを解凍したい。 マクロでパスワード付きzipファイルの解凍を行いたいです。パスワードが誤っていた場合、誤っていたという旨のメッセージを表示させ終了したいのですが、 パスワードの入力を再度促すフォームが開いてしまいます。 下記ソースの何が間違っているのかおしえていただけるとありがたいです。 Sub test Dim objZip As Variant Dim ret As Long Dim shellObj As Object Set shellObj = CreateObject("Shell.Application") 'シェルオブジェクトの作成 Set objZip = shellObj.Namespace(CVar(zipファイルのフルパス)).Items Application.SendKeys "(パスワード)" & "{Enter}" ret = shellObj.Namespace(CVar(解凍先フォルダパス)).CopyHere(objZip) If ret > 0 Then MsgBox "失敗しました。" End If End Sub
VBAについてです。 B4:D102までのセルにデータが入力されている状態です。今のコードではデータ入力されているセルの左端（例：B4）をダブルクリックするとクリックしたセルの行の左端までと右にはデータ入力されているセル(例：D4)まで黄色で塗りつぶす。 データ入力されているセルの右端（例：D4）をダブルクリックするとクリックしたセルの行の右端までと左にはデータ入力されているセル(例：B4)まで黄色で塗りつぶす。という処理になります。 その処理を↓のようにしたいのですがどこを弄ればよいのでしょうか。 ①データ入力されているセルの左端をダブルクリックすると左に1つ、右にはデータ入力されているセルまで黄色で塗りつぶす。（例：A4:D4） ②データ入力されているセルの右端をダブルクリックすると右に3つ、左にはデータ入力されているセルまで黄色で塗りつぶす。(例：B4:G4) Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) Dim Iro As Long Dim Hidari As Long Dim Migi As Long Dim r As Long Const Iro2 As Long = 6 Iro = Target.Interior.ColorIndex If Target.Value <> "" Then Hidari = Target.End(xlToLeft).Column Migi = Target.End(xlToRight).Column r = Target.Row If Iro = Iro2 Then Range(Cells(r, Hidari), Cells(r, Migi)).Interior.ColorIndex = xlNone Else Range(Cells(r, Hidari), Cells(r, Migi)).Interior.ColorIndex = Iro2 End If Cancel = True End If End Sub
特定文字Aを探して、その右隣のセルに指定文字列を入れるコードを組んでいます。 特定文字Aは複数箇所有り、特定文字Bが左のセルにある場合は、右隣に指定文字列を入れないという条件があるのと、A列に特定文字Aがある場合があるので、以下のようなコードを組んでいます。 それぞれのコードの意味を知りたくてわかる範囲で書いてみました。 わからないところがあるので、それぞれの意味を教えてもらえないでしょうか？ また、コード的に間違っている箇所があれば教えてください。 Dim i i = 0 '1～Textbox2の値までを繰り返す For i = 1 To Worksheets("sheet1").TextBox2 'シート内の"特定文字A"を探す With ThisWorkbook.Worksheets("DATA").Range("A1:IV500") Set c = .Find("特定文字A", LookIn:=xlValues) If Not c Is Nothing Then firstAddress = c.Address Do 'もしcがＡ列じゃない場合 If c.Column <> 1 Then 'もし"特定文字B"を含むセルがcの左隣にあったら If c.Offset(0, -1).Value = "*" & "特定文字B" & "*" Then Exit Sub 'もし"特定文字B"を含むセルがcの左隣になかったら Else 'cの右隣に入力 c.Offset(0, 1).Value = Worksheets("sheet1").Cells(i, 22) End If 'もしcがＡ列の場合 Else 'cの右隣に入力 c.Offset(0, 1).Value = Worksheets("sheet1").Cells(i, 22) End If Set c = .FindNext(c) Loop While Not c Is Nothing And c.Address <> firstAddress End If End With
VBA初心者です。あるフォルダに入っている複数のテキストファイルのテキストを抽出したいと考えていますが、文字化けしてしまいました。そこで、ADODBを使ってUTF－８を読み込めるようにするのかな、と思って下記のように組んでみたのですが、うまくいかず、どこをどう直せばいいのか全くわからなくなってしまいました。どなたかご回答よろしくお願いします。 Sub Macro1() Dim buf As String, cnt As Long, Target As Object With CreateObject("Script.FileSystemObject") For Each Target In .GetFolder("C\sample").Files .Close With CreateObject("ADODB.stream") .Charset = "UTF-8" .Open .LoadFromFile Target buf = .ReadText .Close cnt = cnt + 1 Cells(cnt, 1) = Target.Name Cells(cnt, 2) = buf End With Next Target End With End Sub 【読み込めたけれど文字化けしてしまったコード】 もしかするとUTF－８とかの問題ではないかもしれないので・・・ Sub Sample1() Dim buf As String, cnt As Long Dim f As Object With CreateObject("Scripting.FileSystemObject") For Each f In .GetFolder("C:\sample").Files With .GetFile(f).OpenAsTextStream buf = .ReadAll .Close cnt = cnt + 1 Cells(cnt, 2) = buf Cells(cnt, 1) = f.Name End With Next f End With End Sub
C#で以下のようなポイントクラスを削除したいのですが、配列やリストの削除の時と同じようにすると、 エラーがでます。例えば、ｐｔｓ2を削除したい場合、 pts2.remove(); ではダメなのでしょうか。 ///////////////////////////////////////////////// Point[] pts = new Point[] { new Point { X = 50, Y = 50 }, new Point { X = 50, Y = 75 }, new Point { X = 75, Y = 80 }, new Point { X = 70, Y = 60 }, new Point { X = 100, Y = 70 }, new Point { X = 110, Y = 45 }, }; Point[] pts2 = new Point[] {new Point { X = 200, Y = 50 }, new Point { X = 250, Y = 250 }, new Point { X = 290, Y = 240 }, new Point { X = 300, Y = 140 }, new Point { X = 400, Y = 150 }, new Point { X = 450, Y = 205 }, new Point { X = 500, Y = 220 } , new Point { X = 460, Y = 70 } }; Point[] pts3 = new Point[] {new Point { X = 16, Y = 10 }, new Point { X = 55, Y = 95 }, new Point { X = 66, Y = 92 }, };
VBAの質問です。 A列に1〜5までの数字が１つずつランダムに入っていて、 A列の値が1または3のときに、同じ行のC列の文字をシングルコーテーションで括りたいのですが、どのようにすればよいか教えてください。 宜しくお願いします。
Excel2007で自動でセルに着色したいと思います。例のようなカレンダーにF列の土日やG列のマル印の列(表の部分)だけに、入力しただけで自動で着色するにはどのようにすればよいでしょうか。ご教授いただければ幸いです。
Excel VBAで、内容が変更された列によって処理を分けたいのですが、どのように記述したらよいでしょうか。Sheetのイベントプロシージャ Worksheet_Change(ByVal Target As Range)の中で、 内容が変化したセル（列）によって処理を分けたいと考えております。 Select Case Target ・・・・・ Case (d列) Case (e列) Case (f列) end Select のような分岐になるかと思うのですが、具体的にどのように記述したらよいのか、 分かりません。 大変お手数をおかけしますが、ご教示願います。
Excel VBAで質問です。 ユーザーフォームの二つのコンボボックスからＡ列（社名）とＢ列（業務名）を選び出せるようにしたいです。 多少省略されてますが、下の図の様なリストを作成してます。コンボボックス１でＡ社が選ばれていれば、コンボボックス２では仕事１から５までリストに載るように、 更に出来れば同じ社名は一つにまとめたいです。 http://www.asahi-net.or.jp/~zn3y-ngi/YNxv9g0395.htmlと http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1431038914で 似たようなものを見つけましたがリストは既に出来上がっていて、社名は更に増え続けるので参考になりませんでした。 プログラムの知識はほぼゼロですのでコードを載せてくれると助かります。
チップ500枚差し上げます！エクセルのVBAマクロについての質問です。マクロ初心者です。マクロのセル計算をオートで指定セル以降も行うにはどうしたらいいのでしょうか？閲覧有難うございます。if range("a2&quot;)=1 and range("b2")<7 then range("c2")="○" elseif range("a2")=2 and range("b2")<10 then range("c2")="○" else range("c2")="×" この作業を、(a3:a30)と(b3:b30)のそれぞれに数値が記入されるたびにマクロをc3以降のセルで実行しても、オートでcに○か×かを表示させるにはどうしたらいいのでしょうか？分かりにくい質問で申し訳ありませんでした。
vbsで音量を測量することはできますか？
ﾃｷｽﾄﾎﾞｯｸｽをﾀﾞﾌﾞﾙｸﾘｯｸで日付を入力したい。ﾕｰｻﾞｰﾌｫｰﾑ1のﾃｷｽﾄﾎﾞｯｸｽ1をﾀﾞﾌﾞﾙｸﾘｯｸすると, 日付(yyyy/mm/dd)が自動で入力されるようにしたいです。 どのようにすればいいですか。
マクロで、あるｾﾙに関数を設定したいです。A001.Cells(2, 32).Select ActiveCell.FormulaR1C1 = _ ”=MID(AC8,FIND("@",SUBSTITUTE(AC8,",","@",5))+1,FIND("@",SUBSTITUTE(AC8,",","@",6))-FIND("@",SUBSTITUTE(AC8,",","@",5))-1)” 初心者ですみません。 上記の関数が良いのか悪いのか？ 直接、手入力だとセルに書けるのですが、正しい書き方を教えてください。 出来れば、もっと簡単な関数に改良できれば、もっと助かるのですが よろしくお願いします。
Access2010でリンクテーブルに新規レコードが追加されたら再クエリして開いているフォームを更新する方法がわかる方いますか？ リンク元テーブルがあるデータベースはサーバー上にありますが、フロントエンドとして使用しているmdbファイルは利用者個々のパソコンのローカルに保存して使っています。 他の人がフォームにレコードを追加しても、手動でコマンドボタンを押して再クエリしないと更新されないので、自動で更新されたらと思います。 よろしくお願いします。 テーブルにレコードが追加されたタイミングでイベントをひろったりできないものかと思います。
Excelのマクロに関して教えてください。知識は、初心者レベルです。 オートフィルタで抽出したデータ（可視セル）の特定の列に値を入力したいです。 いろいろ調べましたが暗礁に乗り上げました。。。 データは、A列からCG列まで入っています。 A列は、空欄です。 やりたいことは CG列で、「1」と「2」を抽出。 「1」の場合は、Ａ列に○を入力。 「2」の場合は、Ａ列に◎を入力。 最後に、フィルタの解除。 下記でやってみましたが、○は、入るけど、見出し行（1列）まで○が入ってしまい 次の、「2」で「◎」を入力が、動いてくれません。 どのような記述がよいのか、教えていただけますでしょうか？ よろしくお願いします。 --------------------------------------------------------------------- Sub test() Worksheets("sheet1").Select Range("CG1").Select Selection.AutoFilter Selection.AutoFilter Field:=85, Criteria1:="1" For Each c In Worksheets("sheet1").Columns(85).SpecialCells(xlCellTypeVisible) If c = "" Then Exit Sub End If Range("a" & c.Row) = "〇" Next c Selection.AutoFilter Field:=85, Criteria1:="2" For Each c In Worksheets("sheet1").Columns(85).SpecialCells(xlCellTypeVisible) If c = "" Then Exit Sub End If Range("a" & c.Row) = "◎" Next c End SubCG列まで入っています。 A列は、空欄です。 やりたいことは CG列で、「1」と「2」を抽出。 「1」の場合は、Ａ列に○を入力。 「2」の場合は、Ａ列に◎を入力。 下記でやってみましたが、○は、入るけど、見出し行（1列）まで○が入ってしまい 次の、「2」で「◎」を入力が、動いてくれません。 どのような記述がよいのか、教えていただけますでしょうか？ よろしくお願いします。 --------------------------------------------------------------------- Sub test() Worksheets("sheet1").Select Range("CG1").Select Selection.AutoFilter Selection.AutoFilter Field:=85, Criteria1:="1" For Each c In Worksheets("sheet1").Columns(85).SpecialCells(xlCellTypeVisible) If c = "" Then Exit Sub End If Range("a" & c.Row) = "〇" Next c Selection.AutoFilter Field:=85, Criteria1:="2" For Each c In Worksheets("sheet1").Columns(85).SpecialCells(xlCellTypeVisible) If c = "" Then Exit Sub End If Range("a" & c.Row) = "◎" Next c End Sub
既に作成されたピボットテーブルの更新をマクロで行っています。 ですが、毎回実行するたびに、ピボットテーブルのデータソース範囲の行が減っていき、 希望の表ではなくなっていきます。更新したあとに、何か追記することで、データソース範囲を自動で一番下の行まで選択することは可能でしょうか？ マクロ初心者の為、追記などのプログラムを書いて頂けると、助かります(>< 現在、下記の内容でピボットテーブルの更新をしています。 Sheets("まとめ").Select Dim pvt As PivotTable For Each pvt In ActiveSheet.PivotTables pvt.PivotCache.Refresh Next 「まとめ」のシートには３つのピボットテーブルがあり、 ピボットテーブル1は、シート「あ」のA~Ｌ列の最終行までを選択したい 〃 2は、シート「い」の 〃 〃 3は、シート「う」の 〃 「あ」「い」「う」のシートの行数は、毎回変わります。 説明下手ですみません。 宜しくお願い致します！
excel vba に関する質問です。 シート１のA1,A2,A3に入力した値を作成した（転記ボタン）をクリックすることで シート２のA1,A3,A5に転記するプログラムを組みたいと思っております。 その際に、①転記後シート１に入力した数字はクリアされる。 ②２回目以降転記を行う際に、以前入力した列の右列（最右列）に転記される この２点も満たしたいと思っております。 自分で組んでみたのは、 Sub prog1() Worksheets("シート２").Range("A1,A3,A5"). Value = Worksheets("シート１").Range("A1:A3").Value End Sub Sub prog2() Dim Sh1 As Worksheet Dim Sh2 As Worksheet Dim lastColumns As Long Set Sh1 = Worksheet("シート１") Set Sh2 = Worksheet("シート２") With Sh2 lastColumns = .Cells(１).End(xlToRight).Column.Columns("A").Copy.Paste Destination:=.Columns(lastColumns 1) End With With Sh 1 .Range("A1:A3").ClearContents End With End Sub 的外れなプログラムかもしれませんが、どうかご教授お願いいたします。
エクセル2007以降です。 エクセルのＶＢＡを使って別ファイルのシートにあるデータを読み込み、それをコピーしていきたいのですがうまくいきません。読み込みたいファイルは一つのフォルダにまとめていますが多数あります。 シート名は調べましたが一致していません。読み込み対象のシートの数もファイルによってばらばらです。 読み込み対象のシートの様式は共通しているので判別処理は可能です。 この三つの壁が乗り越えられません。 よろしくお願いします。
Excel VBAを用いて以下の2つの大小の円形をプログラミングしました． これは計算に合わせたものなんですが，計算をしないでプログラムする方法はありますか？赤丸をしている円の部分です． よろしくお願いします．． Sub () と End Sub は省略してあります． Dim N1 As Integer Dim iNO1 As Integer Dim jNO1 As Integer Dim 目標直径1 As Single Dim 初期距離1 As Single Dim 距離間隔1 As Single Dim 角度分解能1 As Single Dim 角度1 As Single 目標直径1 = 46 目標直径2 = 24 距離間隔1 = Range("B6").Value 角度 = 2 Call 初期値1 For N1 = 1 To Int(360 / 角度) '円(大) 初期距離1 = 0 角度1 = (角度 * N1 / 360 * 6.28) Do While 初期距離1 <= 目標直径1 / 2 iNO1 = Int(初期距離1 * Cos(角度1) / 距離間隔1) jNO1 = Int(初期距離1 * Sin(角度1) / 距離間隔1) Cells(38 + jNO1, 41 + iNO1).Value = "" 初期距離1 = 初期距離1 + 距離間隔1 Loop Next For N1 = 1 To Int(360 / 角度) '円(小) 初期距離1 = 0 角度1 = (角度 * N1 / 360 * 6.28) Do While 初期距離1 <= 目標直径2 / 2 iNO1 = Int(初期距離1 * Cos(角度1) / 距離間隔1) jNO1 = Int(初期距離1 * Sin(角度1) / 距離間隔1) Cells(61 + jNO1, 64 + iNO1).Value = "" 初期距離1 = 初期距離1 + 距離間隔1 Loop Next
Access VBAについての質問です。テーブルに必要なデータを入力し、 フォームに 「フリガナ順」「生年月日順」 「男かつフリガナ」「女かつフリガナ」 といったオプションボタンをつけてソートを作成し レポート（印刷プレビュー）を表示するようにしました。 レポートを閉じ、テーブルを編集しようとサブフォームを開くと テーブルに登録した順ではなく、 先ほど行ったソート順で表示されるようになってしまいました。 これを解決したいのですが、解決法がわかりません。 プログラムで解決するのでしょうか？ 詳しい方、教えてください。 下記にソートの部分のソースコードを載せておきます。 【抽出】 Option Compare Database Private Sub btnBack_Click() DoCmd.OpenForm "抽出条件", acNormal DoCmd.Close acForm, "抽出" End Sub Private Sub btnPreview_Click() '印刷 DoCmd.OpenReport "名簿", acViewPreview, Me.OpenArgs DoCmd.Close acForm, "抽出" End Sub 【抽出条件】 Option Compare Database Private Sub btnBack_Click() DoCmd.OpenForm "メインフォーム", acNormal DoCmd.Close acForm, "抽出条件" End Sub Private Sub btnHyoji_Click() Dim StrSQL As String If IsNull(grpChusyutsu) = True Then MsgBox "チェックを入れてください" Else Select Case grpChusyutsu.Value Case 1 'フリガナ アイウエオ順 StrSQL = "SELECT * FROM tbl名簿 ORDER BY フリガナ;" Case 2 '生年月日 昇順 StrSQL = "SELECT * FROM tbl名簿 ORDER BY 生年月日;" Case 3 '男性のみ かつ フリガナ アイウエオ順 StrSQL = "SELECT * FROM tbl名簿 WHERE 性別 = '男' ORDER BY フリガナ;" Case 4 '女性のみ かつ フリガナ アイウエオ順 StrSQL = "SELECT * FROM tbl名簿 WHERE 性別 = '女' ORDER BY フリガナ;" End Select DoCmd.OpenForm "抽出", , , , , , StrSQL Forms("抽出").sfmChusyutsu.Form.RecordSource = StrSQL DoCmd.Close acForm, "抽出条件" End If End Sub
エクセルのマクロについて 1. TEMPLATEというシートをコピー2. 1でコピーしたTEMPLATEのコピー(おそらくTEMPLATE(2)などという名前になっているハズですが)を、SHEETNAMEというシートのA2に入力してある内容に変更 3. 2で名前を変更したシートのC1にSHEETNAMEのB2の内容を入力 4. 2で名前を変更したシートのD5からD15、D18からD28、D31からD37、D40からD43、D58からD106を数式から値に変換(一旦コピーして同じセルに「値の貼り付け」として行う作業)する。 5. 1～4の作業をSHEETNAMEのB2から縦方向にB行が空欄になるまで続ける。 宜しくお願いします。
エクセルに関する質問です。 一つのブックに「繰越」「入庫」「出庫」「在庫」とあるとします。「繰越」シート Ａ列：日付 Ｂ列：管理番号 Ｃ列：品種 Ｄ列：数量 「入庫」シート Ａ列：日付 Ｂ列：管理番号 Ｃ列：品種 Ｄ列：数量 「出庫」シート Ａ列：日付 Ｂ列：管理番号 Ｃ列：品種 Ｄ列：数量 「在庫」シート Ａ列：管理番号 Ｂ列：品種 Ｄ列：数量 としたいのですが、マクロではなく関数でできるものでしょうか。 管理番号：数字＋アルファベット 【2438372FGG】など 品種：みかん、りんご、なし など 数量：整数 とします。「繰越」「入庫」「在庫」シートは手入力になります。 品種の要素が入ると難しくなりましてお知恵を拝借しなければなりません。 宜しくお願いします。
teratermのデータをexelで表示する方法に関する書籍を紹介して下さい。
vbaについて ①下図のようにエクセルに入力 ・C2～C11に数値を入力 ・C12に=SUM(C2:C11)と入力しC2～C11の合計を出す ②下のマクロを実行このとき問題なしが表示されればいいのですが問題ありが表示されてしまいます。 ※C12セルに直接8と入力すると問題なしと表示される ※C2～C11の組み合わせを変えるとうまくいくときもある どう直せばいいでしょうか。 Sub test() Workbooks("test.xls").Activate Worksheets("test").Activate k = Range("C12") s = Range("E3") If k >= s Then MsgBox "問題なし" else MsgBox "問題あり" End If End Sub よろしくお願いします。
Excel VBAにて、同じブック内の別シートに記されたデータを取得する方法について Excel（2010）の VBAにて、同じブック内の別シートに記されたデータを取得する方法について教えてください。 ■条件 セルの内容が変化がVBAマクロのトリガーとなっています。 別シートに記されたデータは、D4～Dnnnに入力されています。 最後の行は不定であり、データの取得前に最後の行（番号）を得る必要があります。 つまり、データ範囲が可変であることに対応する必要があります。 ■現状のVBAプログラム With ThisWorkbook.Worksheets("個人別").Range("d4:d315") データ範囲が固定されており、最終行（番号）が変化したら、都度プログラムを 書き換えています。 プログラムを書き換えなくても済むようにしたいと考えております。 offsetやResizeを使用することによりできるらしいのですが、よくわかりません。 お手数をおかけしますが、何卒よろしくお願いします。
マクロ初心者で大変恐縮ですが、よろしくお願い致します。 エクセルで、特定のブック”A”の特定のシート”AA”を、複数のブックB~Zの一番左側にコピーしたいのです。他の方の質問で以下の様な記述が見つかったので試してみたのですが、うまく起動しません。 途中でエラーが起きるとかではなく、ブックB~Zを起動している様子さえ無いのです。 「temp」と名付けたフォルダにxlsファイルをいくつか入れて試しているのですが… また、以下の命令文の場合、コピーしたいシート”AA”はどのように指定されているのでしょうか？ 現在開いているシートをコピーするように指定したプログラムなのでしょうか。 Sub MatomeCopy() Dim Filename As String Const FilePath As String = "C:\temp\" Dim SourceSheet As Worksheet Dim TargetBook As Workbook Set SourceSheet = ActiveSheet Filename = Dir(FilePath & "*.xls", vbNormal) Do While Filename <> "" Set TargetBook = Workbooks.Open(FilePath & Filename) SourceSheet.Copy after:=TargetBook.Worksheets(TargetBook.Worksheets.Count) TargetBook.Worksheets(TargetBook.Worksheets.Count).Name = SourceSheet.Name TargetBook.Close savechanges:=True Filename = Dir() Loop Set SourceSheet = Nothing Set TargetBook = Nothing End Sub
visual studio2015ですがこのエラーはどういう意味ですか？どうすればできますか？ プログラムはあっています。
excelのマクロを使用して1つのセルに入力された長文の文字列を 自動改行する処理を組みたいのですが、以前他の方の投稿で類似したソースを下記の通り確認したのですが、一部違いがありましてどなたか 教えて頂けたらとおもいます。 改行したいセルの番地が都度変更になるので例えばセルA1に 選択されているセル番地を格納しておき、その値を参照して 改行するようなソースをご連絡いただけると助かります。 ※方法は何でも構いません。 *************************************************************************** セルのD1ならば Const RanVal As String = "D1" 'セルの個所を設定 'ここから下を張り付ける====================================================================== Const RanVal As String = "A1" 'セルの個所を設定 Const MaxSt As Long = 44 '切り分ける文字数を設定 Dim Flag As Boolean Dim StVal As String, ICon As Integer Dim Start_M As Integer, Last_M As Integer Private Sub Worksheet_Change(ByVal Target As Range) If Flag = True Then Exit Sub If Range(RanVal).Address = Target.Address Then Flag = True StVal = Range(RanVal) ICon = S_LCON(Len(StVal)) Start_M = 1 For i = 1 To ICon Target.Offset(i - 1, 0).Value = Mid(StVal, Start_M, MaxSt) Start_M = Start_M + MaxSt Next i Flag = False End If End Sub Function S_LCON(A As Integer) As Integer If (A Mod MaxSt) <> 0 Then S_LCON = Application.WorksheetFunction.RoundUp(A / MaxSt, 0) Else S_LCON = A / MaxSt End If End Function '====================================================================== ***************************************************************************
以下のマクロを使ってリボンを非表示にしたところ、リボンを再表示させる方法が分からなくなってしまいました。 Ctrl+F1でも出ません。情けないことで申し訳ありませんが、何卒、リボンを再 表示する方法をご教授願います。 Sub Auto_Open() Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",False)" End Sub
前回教えて頂いたシート1の行D7:F7のセルを含むB7:H7の値を、別シート2のA3:G3に貼り付けて以後シート1に入力毎に下行に追加していくfor nextのマクロを組みました。 動作自体はエラーもかからず正常に行われている(はずな)のですが、貼り付けの際にシート2のA列とF.G列には値が貼り付けられるのに、B:E列は空白になってしまいます。 シート2は保護もしておらず、セルの書式設定等も特に変更しておりません。 試しに上で組んだマクロに追加でAA列を起点にしてrange.valueで空白部分のみを貼り付けるようにしてみても反映されませんでした。元々ネット上にあったfor nextの構文を使用し、変数のみを修正したので全く同一のfor nextのマクロで他ブックでは正常に貼り付けできておりました。 シート1のB7:D7セルはエクセルのドロップダウンリストが連動して組まれており、E7:F7はマクロでVlookupが組まれているのですが、これが影響しているのでしょうか？ もうお手上げ状態です。何卒お力添えをお願い致します。
下記のコードで標準偏差と3σを 求めるマクロを作成していたのですが、 それとは別に同じ諸元名をカウントし、 その合計値を元に、平均値を算出するマクロを 教えてください。Sub siguma() Dim maxrow As Long Dim start As Long Dim last As Long Dim i As Integer Dim siguma As Double '最終行を取得 maxrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row '変数定義 start = 1 last = 1 '最終行まで処理 For i = 1 To maxrow '諸元名が一緒の場合、加算処理 If Cells(i, 2).Value = Cells(i + 1, 2).Value Then last = last + 1 '標準偏差を計算 ElseIf Cells(i, 2).Value <> Cells(i + 1, 2).Value Then siguma = WorksheetFunction.StDevP(Cells(start, 24).Value, Cells(last, 24).Value) Cells(i, 17).Value = siguma '3σを計算 Cells(i, 18).Value = 3 * siguma '開始位置を更新 start = i + 1 '最終位置を更新 last = last + 1 Else: End If Next i End Sub
分析ツールを導入しているのにATPVBEAN.XLAが見つかりませんエラー 「分析ツール」と「分析ツールVBA」の両方を導入しているのに、マクロを実行するとエラー1004「ATPVBEAN.XLAが見つかりません」が出ます。 原因は何が考えられるでしょうか。 【環境】Excel2007(32bit),Windows7 32bit 【ファイル拡張子】xls（xlsmではありません） 【コード】Application.Run "ATPVBAEN.XLA!Regress", ActiveSheet.Range("$D$4:$D$40"), _ ActiveSheet.Range("$B$4:$C$40"), False, False, 95, Worksheets("ワークシート").Range( _ "$A$" & F & ":$K$" & (F + 29)), False, False, False, False, , False
VBAでセルが空白でない間、数式にエラーが含まれるセルを判定して、真の場合は入力されているデータをクリアしたいのですが、どうしても「型が一致しません」というエラーが出てきてしまいます。どこが間違っているのかわからないのですが、どなたか教えてください。 【セルの入力状況】 A列に数値もしくは文字列。B列にA列の数値（文字列）を含む数式。A列のセルが文字列のときは#value! 【コード】 Dim i As Long i = 1 Do While Cells(i,2).Value <>"" If IsError(Cells(i,2).Value) Then Cells(i,2).ClearContents End If i = i + 1 Loop
Visual Studio2015 のVisual Basicについて質問です。ツールボックスにあるDateGridViewの「列の追加」を選択すると、画像のようになってしまい使えず困っています。 これはどのような不具合なのでしょうか？ 解決策があれば教えてください。 よろしくお願いします。
エクセルでマクロを組み始めたばかりのため、皆様にご教授頂ければと思います。 今開いいるシートに転送ボタンを作成します。このシートのセルC4からC27まで、もしくはC23までのデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内のマクロというブック、様式1ならびに2の名前のシートにセルB9,C9,D9…といったように縦並びから横並びに変えて毎日までに転送しようと思います。(一括転送) その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub CommandButton1_Click() Call Macro1 End Sub Sub Macro1() Workbook.Open Filename:=”C:¥共有¥マクロ.xlsx” ThisWorkbook.Activate With Workbooks(”マクロ.xlsx”) GYOU = .Sheets(”様式1”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式1”).Range(”A” & GYOU & ”:AA” & GYOU + 1880).Value =Sheets(”様式1”).Range(”A2:AA2000”).Value GYOU = .Sheets(”様式2”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式2”).Range(”A” & GYOU & ”:W” & GYOU + 1880).Value =Sheets(”様式2”).Range(”A2:W2000”).Value ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode =False End Sub この様なマクロを組んでみましたが、コンパイルエラーが出て、「変数が定義されていません」と表示されます。 どの様に修正すれば良いのでしょうか？お手数をおかけして申し訳ございませんが、よろしくお願いします。
エクセルでマクロを組み始めたばかりのため、皆様にご教授頂ければと思います。今開いいるシートに転送ボタンを作成します。このシートのセルC4からC27までデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内のマクロというブック、様式名のシートにセルB9,C9,D9…といったように縦並びから横並びに変えて毎日までに転送しようと思います。 その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub CommandButton1_Click() Call Macro1 End Sub Sub Macro1() Workbook.Open Filename:=”C:¥共有¥マクロ.xlsm” Activesheet.Unprotect ThisWorkbook.Activate Range(”C4:C27”).Select Selection.Copy Windows(”マクロ.xlsm”).Activate Sheets(”様式”).Select Range(”B65536”).End(xlUp).Offset(1).Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:= True ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode =False End Sub この様なマクロを組んでみました。転送ボタンを押して走るものの、転送先シートは同行に同じデータが並んでしまいます。 どの様に修正すれば良いのでしょうか？お手数をおかけして申し訳ございませんが、よろしくお願いします。
エクセルでマクロをし始めたばかりのため、皆様にお教え頂きたいです。今開いいるシートに転送ボタンを作成します。このシートのセルC4からC27まで、もしくはC23までのデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内のマクロというブック、様式1ならびに2の名前のシートにセルB9,C9,D9…といったように縦並びから横並びに変えて毎日までに転送しようと思います。(行と列を入れ替えて2シート一括転送コピー。) その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub CommandButton1_Click() Call Macro1 End Sub Sub Macro1() Dim GYOU As Long Workbook.Open Filename:=”C:¥共有¥マクロ.xlsx” ThisWorkbook.Activate With Workbooks(”マクロ.xlsx”) GYOU = .Sheets(”様式1”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式1”).Range(”A” & GYOU & ”:AA” & GYOU + 1880).Value =Sheets(”様式1”).Range(”A2:AA2000”).Value GYOU = .Sheets(”様式2”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式2”).Range(”A” & GYOU & ”:W” & GYOU + 1880).Value =Sheets(”様式2”).Range(”A2:W2000”).Value ActiveSheet.Unprotect Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Close SaveChanges:=True End with Range(”A2:AA6000”).Value=”” End Sub この様なマクロを組んでみましたがエラーメッセージが出て、止まってしまいます。 どの様に修正すれば良いのでしょうか？お手数をおかけして申し訳ございませんが、よろしくお願いします。
VBAで質問です。添付の通り、エクセルで3行目にNoと、品名が入力されます。ここに入力された、Noと品名と同じセルをC6：E10の中から選択したい。（選択するだけでいいです。） この例の場合、No3のメロンが入力された、D8セルが選択されるように。 同じNoで、同じ品名が入力される事はありません。 また、万が一該当しなかった場合、「該当なし」のメッセージを表示させたい。 どうぞよろしくお願いします。
VBAで質問です。添付の通り、エクセルで3行目にNoと、品名が入力されます。ここに入力された、Noと品名と同じセルをC6：E10の中から選択したい。（選択するだけでいいです。） この例の場合、No3のメロンが入力された、D8セルが選択されるように。 同じNoで、同じ品名が入力される事はありません。 また、万が一該当しなかった場合、「該当なし」のメッセージを表示させたい。 どうぞよろしくお願いします。
vbaの実行中にユーザーフォームを表示して、コマンドボタンを押し、 元のコードに戻り、押したボタンがどのボタンだった取得したいのですがどのようにするとよいでしょうかsenntakuというユーザーフォームに itiniti hutuka と名前を付けたコマンドボタンがあります それを以下のように利用したいです sub tes Dim s as String senntaku.Show If s = "itiniti" Then MsgBox "ok" Else MsgBox "miss" End If End Sub sに押したボタンを格納する方法を教えてください。
マクロ（ＶＢＡ）について以下のマクロはあるフォルダに入っているものを一つのエクセルにまとめるものですが、これを実行をすると、結合するエクセルの行が１行しかない場合エラーが出てしまうのですが、対策法はございますでしょうか。 よろしくお願いいたします。 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ Sub ExcelbookCombine() '結合したいファイルがあるフォルダの場所 cドライブなら "C:\test\" Dim Fol As String Fol = ThisWorkbook.Path & "\結合前\" Dim Fn Dim NewFile As Workbook Dim wb As Workbook Dim Ws1 As Worksheet Dim Ws2 As Worksheet Dim R As Range Set NewFile = Workbooks.Add Set Ws1 = NewFile.Worksheets(1) Set R = Ws1.Range("A1") Fn = Dir(Fol, vbNormal) Do Until Fn = "" Set wb = Workbooks.Open(Fol & Fn) 'ワークシート1をコピーする場合は Wb.Worksheets(1) 'ワークシート2をコピーする場合は Wb.Worksheets(2) Set Ws2 = wb.Worksheets(1) 'Aの1行目から12列目までをコピーして結合する Ws2.Range("A1", Ws2.Cells(Rows.Count, 1).End(xlUp)).Resize(, 50).Copy R Set R = R.End(xlDown).Offset(1) wb.Close 'Debug.Print Fn Fn = Dir Loop Set R = Nothing Set Ws1 = Nothing: Set Ws2 = Nothing Set wb = Nothing: Set NewFile = Nothing '市区町村入力 Dim buf As String buf = InputBox("市区町村名を入力してください") 'デスクトップに保存 Dim MyWS As Object Dim MyDesktop As String Set MyWS = CreateObject("WScript.Shell") MyDesktop = MyWS.SpecialFolders("Desktop") Set myRange = Range("G:G") ActiveWorkbook.SaveAs _ Filename:=MyDesktop & "\" & "【結果】" & buf & Format(Date, "yyyymmdd") & " " & _ WorksheetFunction.CountA(myRange) & "件" & ".csv", _ FileFormat:=xlCSV, Local:=True i = i + AddRow Set MyWS = Nothing ActiveWindow.Close False End Sub
【Access VBA】DAOからADOに変更したら、WHERE句が機能しなくなりました。※表現が適当でなければ申し訳ありません DAOからADOに変更したら、WHERE句が機能しなくなったようです。 Private Sub COUNTER_SELECTION() Dim CN As ADODB.Connection Dim RS As ADODB.Recordset Dim strSQL As String Set CN = CurrentProject.Connection Set RS = New ADODB.Recordset strSQL = "SELECT COUNT(*) AS RecCount FROM T_端末検索ソース" strSQL = strSQL & " WHERE 端末番号 LIKE '*" & Me.imp_端末 & "*'" strSQL = strSQL & " AND 回線番号 LIKE '*" & Me.imp_回線 & "*'" strSQL = strSQL & " AND メールアドレス LIKE '*" & Me.imp_メール & "*'" strSQL = strSQL & " AND クライアント名 LIKE '*" & Me.imp_cmb_クライアント & "*'" strSQL = strSQL & " AND エリア区分 LIKE '*" & Me.imp_cmb_エリア & "*'" strSQL = strSQL & " AND 貸与者氏名 LIKE '*" & Me.imp_貸与者 & "*'" RS.Open strSQL, CN, adOpenKeyset, adLockOptimistic 'レコード件数を取得 Me.cnt_select = RS![RecCount] Me.Refresh RS.close: Set RS = Nothing CN.close: Set CN = Nothing End Sub RS![RecCount]が0件、つまり結果が返ってこなくなりました。 エラーメッセージは出ません。 WHERE句を外し、 『strSQL = "SELECT COUNT(*) AS RecCount FROM T_端末検索ソース"』 だけで実行すると、全件カウントします。 DAOで動かしていた時と、SQLは変更していません。 何がおかしいのでしょうか？ 質問に不備・不足がありましたら、ご指摘ください。 訂正・補足させていただきます。
エクセルVBA、繰り返し処理について質問です。 やりたい事 ワークシート1月のセルを基本シートの指定のセルにコピーする。①セル（3,4～9）をセル（3,2～7)へ ②セル（7,4～9）をセル（3,8～13）へ ③セル（11,4～9）をセル（3,14～19）へ ④セル（15,4～9）をセル（3,20～25）へ ⑤セル（19,4～9）をセル（3,26～31）へ ①～⑤の繰り返しで、以下のコードを作ってみましたが、セル（19、4～9）の値がすべてのセルにコピーされてしまします。 Dim i As Integer, t As Integer For i = 3 To 19 Step 4 For t = 2 To 26 Step 6 Worksheets("1月").Cells(i, 4).Copy Destination:=Worksheets("基本").Cells(3, t) Worksheets("1月").Cells(i, 5).Copy Destination:=Worksheets("基本").Cells(3, t + 1) Worksheets("1月").Cells(i, 6).Copy Destination:=Worksheets("基本").Cells(3, t + 2) Worksheets("1月").Cells(i, 7).Copy Destination:=Worksheets("基本").Cells(3, t + 3) Worksheets("1月").Cells(i, 8).Copy Destination:=Worksheets("基本").Cells(3, t + 4) Worksheets("1月").Cells(i, 9).Copy Destination:=Worksheets("基本").Cells(3, t + 5) Next Next End Sub スッキリしたコードをと思い、いろいろ調べながら作ってみましたが、繰り返し処理が二つ同時はできないのでしょうか？よくわかりません。 教えてください！よろしくお願い致します。
Outlookに届くメールの情報を収集・集計したい 外勤スタッフの出退勤報告をメールで受けていますが、 それらを一括して収集・集計する方法がないか考えています。 私が開発したものではないのですが、 エクセルブックの提出状況を管理するマクロ（以下破線内）があるのですが、 これを流用してOutlooメッセージ（.msgファイル）を集計できますでしょうか？ ある程度のルール決め（メールタイトルに"出勤 or 退勤"を記入する）は 運用でカバーしたいと思いますが、 ・出勤 or 退勤の区別 ・受信日時 ・送信先メールアドレス 最低限これらの情報は取得したいと考えています。 以上、よろしくお願いします。 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Private Sub FileDisp(strPath, I) Dim objFS, objFLD, objFL, objSub With ThisWorkbook.ActiveSheet Set objFS = CreateObject("Scripting.FileSystemObject") Set objFLD = objFS.GetFolder(strPath) For Each objFL In objFLD.Files If objFL.Type = "Microsoft Excel 97-2003 ワークシート" Then .Cells(I, 2) = objFS.GetBaseName(objFL.Path) .Cells(I, 2) = objFS.GetFileName(objFL.Path) .Cells(I, 3) = objFLD.Name .Cells(I, 4) = Int(objFL.Size / 1024) .Cells(I, 5) = objFL.Type .Cells(I, 6) = objFL.DateCreated .Cells(I, 7) = objFL.DateLastAccessed .Cells(I, 8) = objFL.DateLastModified I = I + 1 End If Next For Each objSub In objFLD.SubFolders FileDisp objSub.Path, I Next End With End Sub - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
私はエクセルのVBAで以下のある雑誌を見てプログラムを組んだのですが、起動しません。どこが問題なのか分からないです。誰か教えて下さい。よろしくお願いいたします。 Sub main() For a = 1 To 20 Shell "C:¥Program Files¥Internet Explorer¥IEXPLORE.EXE http://www.xxx,com/” Next End Sub
他のフォームからリストボックスの情報を所得したい(オブジェクト名を変数にして) UserForm1、UserForm2UserForm1にはリストボックス"リストList"があり10個のリスト情報があります。 UserForm1からコマンドボタンでUserForm2をShow(UserForm1は閉じずに）し、UserForm2上にあるコマンドボタンをクリックするとUserForm1にあるリストボックスのListCountを取り出すと言う物です。 UserForm1からUserForm2を表示する際には UserForm2のテキストボックスFormNemuBoxにフォーム名”UserForm1”を入れ、テキストボックスListBNemuBoxにUserForm1のリストボックス名"リストList"が入ります。 フォーム名とテキストボックス名を直接書けばListCountは取り出せます MsgBox UserForm1.リストList.ListCount 結果：10 このフォーム名とテキストボックス名を変数でしたいと以下のようにしてみましたが MsgBox UserForms.Add(FormNemuBox).Controls(ListBNemuBox).ListCount 「種類が一致しません」と言われ停止します。 また一旦変数に格納しなければならないのか？と思い Dim i As Variant i = UserForms.Add(FormNemuBox).Controls(ListBNemuBox).ListCount としてみましたが、「オブジェクトが必要です」と言われます。 そもそも出来ないのか？とも思ってしまいましたが、何か方法があれば教えてください。
マクロについて教えて下さい。 マクロでヘッダーの入力をするように以下のコードを組んでいます。ActiveSheet.PageSetup .CenterHeader = Join(Application.Transpose(Sheets("管理表").Range("H7:H9").Value), vbLf) 現状のフォントが、ＭＳ Ｐゴシックになります。 ＭＳ Ｐ明朝で入力したいのですがうまくいきません。 ご教授願います。
Excelでコピーをした際に改行が含まれないようにする方法 現在ExcelVBAでSendkeyを使ってセルの数値をコピーしてExcel外のフォームにペーストするプログラムを書いています。ただしフォームの仕様によっては改行が含まれていると受け付けないものもあり大変困っています。 メモ帳やコントロールのテキストボックスに入れてからコピーしたりと色々と試してみたのですが上手くいきません。 なにか方法があれば御指南下さい。
Ｅｘｃｅｌの操作方法について教えて下さい。現在、考えている使い方は、シート１に元帳を作りデータを登録しました。シート２に現品添付するタグを作成します。登録したデータをシート２の現品添付タグに反映させる方法を教えて頂けないでしょうか？ 登録番号を入力すれば、添付タグに反映出来るようにしたいと考えております。 元帳の入力したデータの並びと現品添付タグのデータの並びは、レイアウトの関係で同じではありません。 また、同一ファイル内のシート間では無く別のファイルのシートに作ったデータを反映させることは、可能でしょうか？ 例えば、『製造データファイルのシート１』から『入出金データファイルシート１』へとかです。 素人の質問で恐縮ですが、ご教示のほど宜しくお願い致します。
Dxライブラリ、visual studio2013、c++なんですが、オンラインゲームを作っているのですがTCPでサーバー1台にクライアント10台の繋げ方(プログラム)を教えてください。 1対1なら繋がったのですが、クライアントの方を増やすと、上手く繋がりません。よろしくお願いします
マクロを作成して、以下のようなシステムを利用したいと考えています。素人でマクロの内容の理解に苦しんでいるのですが、以下のような内容のマクロの構成は可能でしょうか。マクロの構成ついてご教授お願いします。書類を作成の際に利用したいと考えています。 例えば書類を作成した場合に… ① 「sheet1」に書類を作成する。 ② 「sheet1」内でマクロで作成した「印刷ボタン」をクリックすると表が紙面として印刷される。さらに表の必要な内容のみ「sheet2」へ抽出して保存される。（「sheet2」へ抽出して保存については、書類作成の度にマクロで作成した「印刷ボタン」を押すと「sheet2」へ表もしくは行等を追加して蓄積保存されるようにしたい） ③ ①と②を行うと自動保存され、ファイルを閉じても保存される。 ④ ファイルと閉じると、「sheet1」の内容のみクリアされる。 宜しくお願いします。
Excelのデータ取り扱いについて 1列目のセルに144000個のデータがあります。これらのデータを、始めから順に1440個ずつ抜き取り順次隣のセルに表示させるにはどのようしたら良いですか？Excel関数あるいはVBAで出来る方法があればお願いします。
vbaについて 下記のようなことをやりたいのですがうまくいきません。 どう直せばいいでしょうか。TextBox2・3・4に通常というワードが入力されていない場合は、TextBox1に通常を入力 ※TextBox1・2・3・4は、改行もされている場合あり ssm = "通常" If InStr(TextBox2.Value, ssm) = 0 And InStr(TextBox3.Value, ssm) = 0 And InStr(TextBox4.Value, ssm) = 0 Then If TextBox1 = "" Then TextBox1 = ssm Else TextBox1 = TextBox1 & vbCrLf & ssm End If End If よろしくお願いします。
vbaについて 下記のようなことをやりたいのですがうまくいきません。 どう直せばいいでしょうか。TextBox2・3・4に通常というワードが入力されていない場合は、TextBox1に通常を入力 ※TextBox1・2・3・4は、改行もされている場合あり ssm = "通常" If InStr(IsNull(TextBox2.Value, ""), ssm) = False And InStr(IsNull(TextBox3.Value, ""), ssm) = False And InStr(IsNull(TextBox4.Value, ""), ssm) = False Then If TextBox1 = "" Then TextBox1 = ssm Else TextBox1 = TextBox1 & vbCrLf & ssm End If End If よろしくお願いします。
vbaについて 下記のようなことをやりたいのですがうまくいきません。 どう直せばいいでしょうか。TextBox2・3・4に通常というワードが入力されていない場合は、TextBox1に通常を入力 ※TextBox1・2・3・4は、改行もされている場合あり ssm = "通常" If InStr(TextBox2.Value, ssm) = 0 And InStr(TextBox3.Value, ssm) = 0 And InStr(TextBox4.Value, ssm) = 0 Then If TextBox1 = "" Then TextBox1 = ssm Else TextBox1 = TextBox1 & vbCrLf & ssm End If End If よろしくお願いします。
在宅でExcelやACCESSでVBAの開発をやりたいのですが、Microsoftのソフトを買うのが高いため、ためらっています。替わりのソフトでは動作不良などの心配もありますし、何か方法はありますか？皆さん、どうしてるんでしょうか？
【VBAについて】 今、エクセルで作ったグラフをPPTに貼り付けるマクロを作成しております。 ファイルの場所を示すときに、絶対参照であれば、作れるのですが、相対参照でうまく作れない状態です。どなたか、下記絶対参照のコードを相対参照にして頂けませんでしょうか？ 現在のコードは下記コードです(途中まで)。 ******************************************************* Sub PPTに図形をはりつけ() Dim ppt As PowerPoint.Application Set ppt = New PowerPoint.Application Dim pst As Presentation 'パワポファイルパスを適宜変更 Set pst = ppt.Presentations.Open("C:\Users\××\ファイル名.pptx") *******************************************************
ＶＢ２０１０のインストーラについて 現在、VS2010のセットアッププロジェクトからインストーラを作成しています。ビルド環境のOSが Windows 7の環境で作成したインストーラを実行すると、インストールしたファイルのタイムスタンプがＶＢ２０１０の開発で作成したReleseのタイムスタンプと異なります。 Windows 7: 作成日時、更新日時がインストーラの更新日時と同じです。 タイムスタンプが変わらないようにするには、どうしたらいいのでしょうか？
VBA(Excel2010)において教えてください。Windows7を使用しています。VBAにおいて、昔でいうところのMSXシリーズで、ゲームプログラムの際に、 スプライト機能がありましたが、WindowsのExcelでゲームを作る際に、キャラクターはスプライトはありませんから、どのようにして作成するのかご教示いただきたいのですが、構いませんか？ ドット絵にして作成するとは聞いたことがありますが、それがVBAでどのようにコードを書いて動かすのでしょうか。パズルゲームを考えています。VBA(Excel2010)において教えてください。Windows7を使用しています。VBAにおいて、昔でいうところのMSXシリーズで、ゲームプログラムの際に、 スプライト機能がありましたが、WindowsのExcelでゲームを作る際に、キャラクターはスプライトはありませんから、どのようにして作成するのかご教示いただきたいのですが、構いませんか？ ドット絵にして作成するとは聞いたことがありますが、それがVBAでどのようにコードを書いて動かすのでしょうか。パズルゲームを考えています。
vbaについて 下記のようなことをやりたいのですがうまくいきません。 どう直せばいいでしょうか。TextBox2・3・4に通常というワードが入力されていない場合は、TextBox1に通常を入力 ※TextBox1・2・3・4は、改行もされている場合あり ssm = "通常" If InStr(IsNull(TextBox2.Value, ""), ssm) = False And InStr(IsNull(TextBox3.Value, ""), ssm) = False And InStr(IsNull(TextBox4.Value, ""), ssm) = False Then If TextBox1 = "" Then TextBox1 = ssm Else TextBox1 = TextBox1 & vbCrLf & ssm End If End If よろしくお願いします。
下記の記述でWorksheetFunctionのＤｓｕｍプロパティを取得できませんとでますが原因がわかりません。どなたかご教授ください。Sub InpDcount() Dim iCol As Integer Dim iRow As Integer For iCol = 3 To 10 For iRow = 8 To 19 Worksheets("①全体実績").Range("R4") = Worksheets("①全体実績").Cells(iRow, 2) '条件：月 Worksheets("①全体実績").Range("S4") = Worksheets("①全体実績").Cells(5, iCol) '条件：班 DoEvents 'WorksheetFunction関数がここでマクロを使う場合は下記が必要 Worksheets("①全体実績").Cells(iRow, iCol).Value = WorksheetFunction.DSum(Worksheets("入力").Range("S3:W500"), Sheet1.Range("V3"), Worksheets("①全体実績").Range("R3:S4")) Worksheets("①全体実績").Cells(iRow, iCol).Select Next iRow Next iCol Range("I4").Select End Sub
vbaについて 下記のようなことをやりたいのですがうまくいきません。 どう直せばいいでしょうか。TextBox2・3・4に通常というワードが入力されていない場合は、TextBox1に通常を入力 ※TextBox1・2・3・4は、改行もされている場合あり ssm = "通常" If InStr(TextBox2.Value, ssm) = 0 And InStr(TextBox3.Value, ssm) = 0 And InStr(TextBox4.Value, ssm) = 0 Then If TextBox1 = "" Then TextBox1 = ssm Else TextBox1 = TextBox1 & vbCrLf & ssm End If End If よろしくお願いします。
visual studio community 2015 with update2 をインストールしようと思ったら下のｇ増のような表示が出ます。osはwindows7sp1homeで対応してるはずなのにこんな表示が出てしまいます。回答よろしくお願いします。
マクロが全く分からず、ヤフーで検索しているのですが、理解できず、知恵袋でお聞きします。 同じフォルダ内にある複数のBOOKに同じ処理をしたい場合どうしたらよいか知りたいです。一つのBOOKには、シート名AとBの2つのシートがあります。 やりたい事 １.BのシートはAのシートをリンクしています。リンクは必要ないので、Bのシートは値を貼り付けAのシートを削除。 2.BOOK名をシート名にする 3.ひとつのBOOKにまとめる
Accessでのデータベース作成について質問失礼致します。 以前質問させて頂き、その時のデータベースはうまく作る事ができたのですが、応用した物を作ろうとしたらまたもや躓いてしまいました。状況から説明致します。 テーブル（以下Ｔ）フィールド（以下Ｆ）クエリ（以下Ｑ）で表記致します。 T_得意先マスタ F：得意先コード（主キー） F：得意先名 F：住所・電話番号等々 サンプルとしてレコードに得意先コードをT1・T2・T3と入力してあります。 T_ユーザーマスタ Ｆ：ユーザーコード（主キー） Ｆ：ユーザー名 Ｆ：住所・電話番号等々 サンプルとしてレコードにユーザーコードを1・2・3と入力してあります。 T_車両マスタ Ｆ：車両管理No．（主キー） Ｆ：型番 Ｆ：ユーザーコード Ｆ：得意先コード サンプルとしてレコードに車両管理No．をM0123・M0124・M0125と入力してあります。 ユーザーコードと得意先コードも適当に入力してあります。 T_商品マスタ Ｆ：商品コード（主キー） Ｆ：商品名 Ｆ：標準単価 サンプルとしてレコードに商品コードをS1・S2・S3と入力してあります。 T_適用価格マスタ Ｆ：商品コード Ｆ：得意先コード Ｆ：適用単価 詳細は後程 T_日報 Ｆ：日報ＩＤ（主キー） Ｆ：日付 Ｆ：車両管理No． T_日報明細 Ｆ：日報ＩＤ Ｆ：商品コード Ｆ：数量 Ｑ_日報見出し Ｔ_日報・Ｆ：日報ＩＤ Ｔ_日報・Ｆ：日付 Ｔ_日報・Ｆ：車両管理No． Ｑ_日報明細 T_日報明細・Ｆ：日報ＩＤ T_日報明細・Ｆ：商品コード T_商品マスタ・Ｆ：商品名 T_日報明細・Ｆ：数量 あとは「Ｑ_日報」を基にした日報フォームがあります。 躓いているのは「Q_日報明細」で、ビルダを使い 適用単価: DLookUp("[適用単価]","[適用価格マスタ]","([得意先コード]=" & [Forms]![日報フォーム]![得意先コード] & ")And([商品コード]=" & [商品マスタ].[商品コード] & ")") と入力しても適用価格を返してきません。 「クエリ式'([得意先コード]=)And([商品コード]=S1)'の不要な')'があります。」 とエラーになるのです。 これが主で困っている点です。 適用価格マスタには 得意先コード、商品コード、適用単価 T1、S1、￥5,000 T1、S2、￥3,000 T1、S3、￥2,000 T2、S1、￥4,500 T2、S2、￥2,500 以下同様に・・・ １つの同じ商品でも得意先毎に売上げる金額が違うので、車両管理Ｎｏ．を入力すると得意先から売上げ単価まで間違いなく記載される報告書を作りたくて現在データベースを作っています。 どなたか「Ｑ_日報明細」に適用価格を返す方法をご教授ください。 よろしくお願い致します。
VisualStudio Codeで入力の記録はできますか？例えばサクラエディタだとCtrl+Shift+Mで記録を開始し 入力が終わった後にCtrl+Shift+Mを押すと記録を終了します。 そして一度記録したらCtrl+Shift+Lで先ほど記録した入力を再現できます。 このような機能はVisualStudio Codeには無いのでしょうか？
エクセルの入力フォームについて質問です。 名前一覧というシートを作り、Ａ列に名前、Ｂ列に社員番号を入力してあります。入力フォームでコンボボックス1に名前一覧のＡ列とＢ列を取得させて コンボボックス1に名前、テキストボックス1に社員番号を表示するまではできたのですが、 登録後、他の名前を入力しようとするとエラー381が出てきてしまいます。 エラーを修正する方法を教えてください。 コンボボックス1のプログラムは以下の通りです Private Sub ComboBox1_Change() With Me!ComboBox1 Me!TextBox1 = .Column(1) End With End Sub ちなみにクリアボタンも設置しておりまして、 Dim Ctrl As Control For Each Ctrl In Controls If TypeName(Ctrl) = "TextBox" Then _ Ctrl.Value = "" Next Ctrl For Each Ctrl In Controls If TypeName(Ctrl) = "ComboBox" Then _ Ctrl.Value = "" Next Ctrｌ End Sub としています。こちらのボタンを押しても同じエラーがでますので こちらの解決方法も教えてください。
Excel2013で空白を左詰めさせたい。 ACCESSをエクスポートしたデータで、歯抜けがあって気になるので左へ寄せたいです。 ＜変更前＞ 1000 ３５ ２９７ １３ 1001 ４ ０ ５１９６８ 1002 ５７ ３９２ １ 1003 ４８７２６ ９５１ 1004 ２１５７ １ ８ 1005 １ ９２ ７３５ … 9999 ８ ９ ２ ３ ＜変更後＞ 1000 ３５２９７１３ 1001 ４０５１９６８ 1002 ５７３９２１ 1003 ４８７２６９５１ 1004 ２１５７１８ 1005 １９２７３５ … 9999 ８９２３ 数字は1つのセルに入っています。 (A1に1000、B1に空白、C1に３、D1に５…、A2に1001、B2に空白、C2に４、D2に空白…、といった具合です。) これを＜変更前＞から＜変更後＞へと加工したいです。 VBAを使うことは可能です。 宜しくお願い致します。
またTCPチャットアプリの件で質問です。現在サーバ側アプリを作成中なのですが、リッスン処理待機→クライアントから接続要求をして、TCP接続を行うところまでは何とか出来たのですが、受信用のイベントハンドラの作成が上手く行きません。 受信用イベントハンドラを用意して、さらにそれを開始する処理が必要と言う事を知ったのですが、どう作成したらいいのでしょうか？ 下記が現在途中まで作ってあるサーバ側のアプリのコードです。 ReceiveDataCallbackの中に開始処理を書いて、受信があった都度server_ReceivedDataに 入る様にしたいのですが。 using System; using System.Collections; using System.Collections.Generic; using System.ComponentModel; using System.Data; using System.Drawing; using System.Linq; using System.Text; using System.Threading.Tasks; using System.Windows.Forms; using System.Net; using System.Net.Sockets; using System.Runtime.InteropServices; namespace server2 { public partial class Form1 : Form { ///////各種クラス宣言 private Socket socket; private IPEndPoint socketEP; private bool startedReceiving = false; private System.IO.MemoryStream _receivedBytes; //////イベント登録 //データ受信イベント public delegate void ReceivedEventHandler(object sender, Byte[] e); public event ReceivedEventHandler OnReceiveData; //接続断イベント public delegate void DisconnectedEventHandler(object sender, EventArgs e); public event DisconnectedEventHandler OnDisconnected; //接続OKイベント public delegate void ConnectedEventHandler(EventArgs e); public event ConnectedEventHandler OnConnected; //エラーイベント public delegate void ErrorEventHandler(EventArgs e, string Msg); public event ErrorEventHandler OnTcpError; public Form1() { InitializeComponent(); this.socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); } private void Form1_Load(object sender, EventArgs e) { //エンドポイント this.socketEP = new IPEndPoint(Dns.Resolve("0.0.0.0").AddressList[0], 2345);//IPEndPointとは、IPアドレスとポート番号でネットワークエンドポイントを表す。 this.socket.Bind(this.socketEP); //Listen(サーバ接続待ち状態)を開始する。 this.socket.Listen(100);//socketを待機状態にする。引数は保留中の接続のキューの最大長。 //サーバ状態をセット //this._serverState = ServerState.Listening; //接続要求施行を開始する //this.socket.BeginAccept(new AsyncCallback(this.AcceptCallback), null); //イベントハンドラ追加 OnReceiveData += new ReceivedEventHandler(server_ReceivedData); //startReceive //初期化 byte[] receiveBuffer = new byte[1024]; this._receivedBytes = new System.IO.MemoryStream(); this.startedReceiving = true; //非同期受信を開始 this.socket.BeginReceive(receiveBuffer, 0, receiveBuffer.Length, SocketFlags.None, new AsyncCallback(ReceiveDataCallback), receiveBuffer); } protected virtual void server_ReceivedData(object sender, Byte[] e) { // if (this.ReceivedData != null) // { //イベント処理時は、イベントを通して他のメソッドに任せる。 // this.ReceivedData(this, e); // } } //BeginReceiveのコールバック private void ReceiveDataCallback(IAsyncResult ar) { //この中に受信イベントハンドラを開始する処理を書きたい }//private void ReceiveDataCallback(IAsyncResult ar) } }
visual c++ 2008におけるエラーについて。「ゲームプログラマになる前に覚えておきたい技術」と言う本についてです 第2章の2.3.1「サンプルコード」にあるdrawpixelsというプログラムを付属のCD-ROMから 読み込み、それをvisual c++で自分でコンパイルして実行しようと思った矢先 次のようなエラーが発生しました。 1>------ ビルド開始: プロジェクト: drawPixels, 構成: Debug Win32 ------ 1>リンクしています... 1>D:\GameLib2008\2DGraphics1\lib\GameLib_d.lib : fatal error LNK1127: ライブラリが壊れています。 1>ビルドログは "file://d:\GameLib2008\src\02_2DGraphics1\drawPixels\Debug\BuildLog.htm" に保存されました。 1>drawPixels - エラー 1、警告 0 ========== ビルド: 0 正常終了、1 失敗、0 更新不要、0 スキップ ========== ライブラリのパスの設定をした際にこのようになりました。 「ライブラリが壊れている」と言われた場合に、どのように対処すればいいのかが 見当もつかないような状況です。 この本を実際に読まれたかた、もしくは似たようなエラーを経験したことがある方に 解決策を教えてもらいたいです。 自分の考えでは、GameLib_d.libというライブラリファイルに異常があるだけだと思っているのですが、 そのほかにも原因があるのでしょうか？ 回答よろしくお願いします。
バッチファイルについて質問 はい、どうも皆さんこんにちは、今晩は、おはようございます。最近バッチファイルで凄いもの作ってみたいなーって考えていたんですが、そこで考えたのがオンラインゲームです（アホでしょうがないですね）。一度バッチで文字だけ完全RPG（経験値、ゴールド、店、レベル、フィールドとか）を作ったんですが、それはそれで楽しかったです、はい。今回はそのさらに上を目指してオンライン（マップとかなくていい感じ、ていうか文字だけの方で）でRPGを作ってみたかったなぁ・・・て考えたんです。 そして疑問。 オンラインと言ったらバッチだけではできず、一人目のバッチを外部ファイルにデータを送信させてその外部ファイルがデータをサーバーに送信し、サーバーが処理をして第二のプレイヤーの外部ファイルにデータを送り、その外部ファイルが受信したデータをバッチに送信する。 わかりやすく図で： バッチ１ ---> 外部ファイル ---> サーバー ---> 外部ファイル ---> バッチ２ [__________________________] こんな感じです こんなのは可能でしょうか？ あと、外部ファイルと言ってもデータ送信＆受信（インターネット式）からするとどうすればいいのでしょうか？ちなみに外部ファイルだけでゲーム作るのは無しです。バッチで作りたいんですから。
エクセルのマクロについての質問です。sheet1(原本)のBE51の値をsheet2（保管）のA5～74まで空白を探して上から貼り付け、sheet1(原本)のBE52の値をsheet2（保管）のB5～74まで空白を探して上から貼り付けsheet1(原本)のBE53の値をsheet2（保管）のC5～74まで空白を探して上から貼り付けていくマクロを作成したのですが、sheet2（保管）ではなく別の閉じたエクセル（例[保管場所.xls]）に同じように貼りつけていく事は可能なのでしょうか？ 何方か教えて下さい！ Private Sub 報告書保存_Click() On Error Resume Next Dim i As Long Dim j As Long Dim k As Long Dim Sh1 As Worksheet Dim Sh2 As Worksheet Set Sh1 = ThisWorkbook.Worksheets("原本") Set Sh2 = ThisWorkbook.Worksheets("保管") k = 1 For i = 51 To 53 If Sh1.Cells(i, "BE") > 0 Then For j = 5 To 74 If Sh2.Cells(j, k) = "" Then Sh2.Cells(j, k) = Sh1.Cells(i, "BE") Exit For End If Next End If k = k + 1 Next If MsgBox("保存しますか？", vbYesNo) = vbYes Then Set Sh1 = Nothing Set Sh2 = Nothing End Sub
c#についてです。Excelを保存するときいちいち「すでにその名前のファイルがありますが上書きしますか」のようなものが出てくるのですが、消すことはできますか？ 調べたらVBAの方法はあったのですがc#から起動、保存、終了をしているのでc#での方法、または関係なく消すことのできる方法を教えて欲しいです。
VBAにてInputboxなどでセルの参照をその都度変える。 いつもお世話になっております。 エクセル初心者です。現在、各シートにてそのシート名をセルに 表示させるマクロを作成しております。他の方々の質問を拝見いたしまして、 下記にてＡ１セルに表示させる事ができました。 (色々コピペしただけですので、不必要なコードもあるかも しれませんが・・・・) Sub シート名をA1に表示() Dim Sh As Worksheet For Each Sh In Worksheets Sh.Range("A1").Value = Sh.Name Next Application.ReferenceStyle = xlA1 End Sub この表示させるセル(上記で言うA1)を マクロ実行者がその都度指定する事は可能でしょうか？ 調べてみるとInputboxで文字を入力できることを知り、 試そうとしたのですが、よく分かりません。 デフォルトではＡ１と入力しておいて、場合により A2やA3と変えたいです。 自分が実行する時は単純に上記のコードを変えれば済む話なのですが、 ＶＢＡを全く知らない人も利用できるようにしたいため、この度質問させ ていただきました。(マクロ実行はボタンを作成します) また、End Subと書いてありますが、 実は上記のコード前後にもシートを追加するコードや雛形を 他のシートにコピーするコードもあり、流れを変えたくないため できれば上記のコードにInputbox等を挿入するだけで完成させたいです。 （わがままですみません。もちろん各シート名をセルに表示させる他の コード含みでご教示いただければ大歓迎です。) 何卒お願いいたします。
エクセル 添付画像のように並び替える方法 各項目のABC郡には単語が並んでいます(実際は100行を超え) これを全てA→B→Cの順に縦一列に並べて別のセルにコピーしたいのです。画像では大きなグループは動物、までで終わっていますが実際は50以上あります。 ABCもABだけだったり、ABCDまであったり、様々なのです。 この並び替えは毎日行います。 手作業で選択してコピーするのは大変なので何か良い方法は無いでしょうか？
マクロで３箇所にあるデータを検索し該当する場所に値の貼付けを行うように一応組んで見たのですが①コードは所定の位置にコピー出来ますが②は全くコピーされず③はコピー出来ます。②のコードのどの部分がおかしいのでしょうか、また、三つのコードをまとめるにはどの様にするのでしょうか。①は前任者が作成し②③は素人の私が付足したのですが何方か、ご教示ください、よろしくお願いします。 ①のコードは"J3"月を検索範囲"AO3:CJ3"からコピー範囲"Z5:AA"の値を"AO3:CJ3"にある月に貼り付ける。 ②は①と同様"T3"月を検索範囲"ED3:FY3"からコピー範囲"T5:U"の値を"ED3:FY3"にある月に貼り付ける。 ③は①②同様"T3"月を検索範囲"ED3:FY3"からコピー範囲"Z5:AA"の値を"ED3:FY3"にある月に貼り付ける。 "ED3:FY3"は、４月から３月で、（ED3"月"、ED4"個数"、EE4"金額"）、(EF3"月"、EF4"個数"、EG4"金額"）で、ED3"月"とEF3"月"は同じ月となりその繰り返しになります。 ① Set FoundCell = Range("AO3:CJ3").Find(What:=Range("J3"), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows) If FoundCell Is Nothing Then MsgBox "検索に失敗しました" Else FoundCell.Select Debug.Print FoundCell.Row; FoundCell.Address End If Range("J5:M" & MaxRow).Copy FoundCell = ActiveCell.Address On Error Resume Next Range(FoundCell).Offset(2, 0).PasteSpecial Paste:=xlPasteValues Range("J3").Copy Range(FoundCell).PasteSpecial Application.CutCopyMode = False Set FoundCell = Nothing ② Set FoundCell = Range("ED3:FY3").Find(What:=Range("T3"), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows) If FoundCell Is Nothing Then MsgBox "検索に失敗しました" Else FoundCell.Select Debug.Print FoundCell.Row; FoundCell.Address End If Range("T5:U" & MaxRow).Copy FoundCell = ActiveCell.Address On Error Resume Next Range(FoundCell).Offset(2, 0).PasteSpecial Paste:=xlPasteValues Range("T3").Copy Range(FoundCell).PasteSpecial Application.CutCopyMode = False Set FoundCell = Nothing ③ Set FoundCell = Range("ED3:FY3").Find(What:=Range("T3"), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows) If FoundCell Is Nothing Then MsgBox "検索に失敗しました" Else FoundCell.Select Debug.Print FoundCell.Row; FoundCell.Address End If Range("Z5:AA" & MaxRow).Copy FoundCell = ActiveCell.Address On Error Resume Next Range(FoundCell).Offset(2, 0).PasteSpecial Paste:=xlPasteValues Range("T3").Copy Range(FoundCell).PasteSpecial Application.CutCopyMode = False Set FoundCell = Nothing
Excel、マクロ、関数についての質問です。 以下の事が関数、またはマクロで処理出来る場合はどちらの方法でも構いません。なるべく簡単な方法で回答頂けると幸いです。①特定の文字（例：市場）を含むセル（横D列、縦15番目から最終セルまで）にのみ、特定の文字（例：※）をその文字の最後につける方法を教えて下さい。こちらは、なるべくマクロで済むのならマクロでお願いしたいです。 （例） ああ市場→ああ市場※ ううけけ→ううけけ ききくく市場→ききくく市場※ ささ市場→ささ市場※ ああああ→ああああ ぬぬ→ぬぬ ②特定の文字が同じく（ただし間の空白セルはまばらに）二つ続く表と別々の文字が（また間の空白セルはまばらに）続く表があるのですが、左側の表で特定の文字が二つ続く場合は一番先頭のものを取って挟む様に特定の記号（例▶︎▶︎あああ⚪︎⚪︎）を入れ、右の表もセルの間に空白セルが紛れている事があるので、隣と合わせて先頭の文字だけに特定の文字（例◆◆カカ◻︎◻︎）を入れる様にしたいと考えております。 同じ文字が続く場合、または空白の場合は記号を入れず、別の文字が出てきた時にだけ間に特定の文字を入れる方法が知りたいです。 尚、空白セルは他の表と同じ行数になる様調節しているものなので、空白セルを取って関数、またはマクロを使用する事は考えておりません。 注文ばかりで申し訳ありませんが、是非回答頂けると幸いです。不明瞭な点があれば、お手数でがご一報ください。
ExcelVBA処理の高速化のやり方について 私はよくExcelVBA処理の高速化について以下のことをよくやります。・Application.ScreenUpdating = False ・Application.EnableEvents = False ある職場でExcelVBAを使ったツールを見たら ・Application.Visible = False にしてました。 私はステータスバーに処理の進捗状況を表示させるために、 いちど Application.ScreenUpdating = True に戻して ステータスバーに処理の進捗状況を表示させてます。 上記の２つって高速化のメリットに差が結構ありますか？ ステータスバーのこともありなるべく前者を使いたいのですが。
ExcelのVisual Basicのプロジェクトエクスプローラーの フォルダーの切り替えボタンってどういう時に使うのですか？元々は VBA Project (Book1) Microsoft Excel Objects Sheet1(Sheet1) ThisWorkbook と書かれているのですが、 ボタンを押すと VBA Project (Book1) Sheet1(Sheet1) ThisWorkbook になります。 Microsoft Excel Objectsのようなフォルダが複数ある場合に、順番に表示させる機能ですか？ それならばどういうメリットがありますか？
ExcelでVisual Basicを開いたら、プロジェクトエクスプローラーに VBA Project (Book1) Microsoft Excel ObjectsSheet1(Sheet1) ThisWorkbook と書かれていて、階層になっているのですが、 それぞれどういう意味ですか？
Dxライブラリ、visual studio2013、c++なんですが、オンラインゲームを作っているのですがTCPでサーバー1台にクライアント10台の繋げ方(プログラム)を教えてください。1対1なら繋がったのですが、クライアントの方を増やすと、上手く繋がりません。よろしくお願いします
下記のコードで標準偏差と3σを 求めるマクロを作成していたのですが、 うまく動作しません。原因と改善点を教えていただけないでしょうか Sub siguma() Dim maxrow As Long Dim start As Long Dim last As Long Dim i As Integer Dim siguma As Double '最終行を取得 maxrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row '変数定義 start = 1 last = 1 '最終行まで処理 For i = 1 To maxrow '諸元名が一緒の場合、加算処理 If Cells(i, 2).Value = Cells(i + 1, 2).Value Then last = last + 1 '標準偏差を計算 ElseIf Cells(i, 2).Value <> Cells(i + 1, 2).Value Then siguma = WorksheetFunction.StDevP(Cells(start, 24).Value, Cells(last, 24).Value) Cells(i, 17).Value = siguma '3σを計算 Cells(i, 18).Value = 3 * siguma '開始位置を更新 start = i + 1 '最終位置を更新 last = last + 1 Else: End If Next i End Sub
VBAについて現在、仕事で使うのでExcelのVBAを勉強しています。 WordとPowerPointも使うので、2つのVBAも覚えたいのです。 そこで質問ですが、 WordとPowerPointのVBAも根本的な所はExcelと同じように考えればと思っています。 ExcelのVBAだと、セルやシート、ブックはRangeやCells、Sheets、Workbookなどで指定してプロパティやメソッドを付けれますよね。 これがWordだとドキュメント、行、段落、表、ページ、文章など、PowerPointだとプレゼンテーション、スライド、スライドマスタ、スライドレイアウト、アニメーション、画面切り替えなどは、どんなオブジェクトやプロパティで表したらいいのでしょうか？ 調べてもWordとPowerPointのVBAの説明がほとんどありません。 よろしくお願いします。
vbs のスクリプトを教えて下さい。 次は、開いている explorer を閉じるものです。 複数個あっても、全部閉じます。 '------------- ' explorer を強制終了。exe = "explorer.exe" '（閉じるアプリ名 ： パスなし、ファイル名のみ指定） 小文字変換して比較される。 Set ApplLST = GetObject("winmgmts:").InstancesOf("win32_process") For Each Appl In ApplLST If LCase(Appl.Name) = LCase(exe) Then Appl.Terminate Next '------------- 質問、複数個の explorer のうち、最後に開いたものだけを 閉じるには、どのように書けばいいですか？
vb.net groupboxの枠線に色を付けたい groupboxをフォームに配置しています groupboxの枠線に色を付けたいのですが、プロパティ等に設定項目等が見つかりませんでした どのようにしたら、枠線に色を付けることが出来ますでしょうか？ ご教授下さい
Microsoft ExcelのBookが3つあり、それぞれをA.xlsm,B.xlsx,C.xlsxとします。Aに記述されたVBAで、Aのセル(1,1)に、B、Cそれぞれのセル(1,1)の値の平均を示す方法を教えてください。
日本の住所を英語に直すサイト（http://sys.web-burger.com/zip/）があり、エクセルの住所録をここにいれて翻訳結果をエクセルに取り込みたいです。そのようなことは可能でしょうか？VBA書いていただけませんか？ また、いくつか作業が必要なのですが、こちらも教えていただけますか？ ① エクセルの住所の番地を全部ハイフンでつなぐ。 住所は、都道府県と住所１、住所２に分かれてます。 （例） 兵庫県 中央区中央1-2-3 グランド東京１２３ 大阪府 神戸市中央区中央 １丁目２－３４グランド１２３ これらを1-2-3-123や1-2-34-123という形にして、英訳サイトのStreet欄に入るようにしたいです。 ② 結果シートで日本語か英語かでJやEをある列にいれてます。 Eだったら ・郵便番号の欄を空白にする ・住所欄にサイトの翻訳結果をはりつける ・氏名欄をローマ字にする サンプルを添付します。 https://docs.google.com/spreadsheets/d/1d9jHP0mRmR6bVcCDjQPAowvZMhi...
エクセルVBAでFX自動売買プログラムを制作出来ますか？
プログラミングのことで教えてください。 言語に関わらないと思いますが、下記のことを考えおりますがどのようにすれば良いのかアドバイスを頂きたいです。VB .net , Oracle DB ・テーブルAとテーブルBがあり、AとBは結合するための条件はDATE型のカラムでしかありません。 ・オンラインからボタンを押下すると、テーブルAとテーブルBにはデータが入り、DATE型はシステム日付が入ります。(年月日時分秒） 設計上、このような状況で動いていたのですが、該当のアプリケーションは利用ユーザも５人程で、偶然（？）年月日時分秒 が一致してしまいました。 ボタンを押すときに、更新するテーブルAもしくはテーブルBをロックすれば良いのかなとも思ったのですが、同時刻でロックしに行った場合、どうなるのでしょうか？？ 初心者で申し訳ないですが、案など教えて頂けたらと思います。 （複数の方からご意見いただきたいです）
VBAについて Sheet1は列ごとに個人ごとの情報が入っています。 Sheet2のAN列には判定基準が入っています。 Sheet3には判定によって返す値が入っています。このB列2行目からA列で値が入っている全ての行に以下の式を挿入したいのですがエラーになってしまいます。(アプリケーション定義またはオブジェクト定義のエラーです) =IF(IsError(VLookup(Sheet2!AN2),Sheet3!$A$154:$B$154,2,FALSE)),"",(VLookup(Sheet2!AN2),Sheet3!$A$154:$B$154,2,FALSE)) ※AN2は行ごとにAN3、AN4と変わる ※他のシートには同じ列に同じ人の情報が入っている ちなみにIferrorを外すと、うまくいきます。 よろしくお願い致します。
配列化したラベルの文字表示について質問です。フォーム上に５０音の頭文字が割り振られている１２個のボタンが有り、『あ』のボタンを押すと『あ』行の個々の文字から始まる単語をDBから抽出してラベルで表示させるプログラムを書いています。 初回でボタンを押す→抽出→表示はうまく出来たのですが、次に他のボタンを押しても初回で表示された文字が消えずに２回目に表示された文字と重なって表示されてしまいます。 【例】 初回『あ』ボタンを押す。 Label(0) あああああああ Label(1) いいいいいいい ２回目『か』ボタンを押す。 Label(0) かかかああああ Label(1) きききいいいい ネットで検索してみたり、For~NextにRefresh（）を記述しても解決しませんでした。 解決方法、または解決の糸口になるようなことがありましたら教えていただけないでしょうか？ よろしくお願いします ・ソースコード（抜粋） '配列削除 For di As Integer = 1 To __OL_DELETE_DATA_COUNT__ Me.Controls.Remove(B_onetree(di)) Me.Controls.Remove(L_onetree(di)) next 'ラベルコントロールインスタンスを生成 For i As Integer = 1 To __OL_SERECT_DATA_COUNT__ Me.L_onetree(i) = New System.Windows.Forms.Label() 'プロパティの設定 Me.L_onetree(i).Location = New Point(__OL_LOT_X__, __OL_LOT_Y__) Me.L_onetree(i).AutoSize = New AutoSizeMode=False Me.L_onetree(i).Size = New Size(93, 27) Me.L_onetree(i).Font = New Font("MS UI Gothic", 14.25, FontStyle.Bold) Me.L_onetree(i).Name = "L_ot" & i.ToString() Me.L_onetree(i).Text="" 'フォームにラベルを追加 Me.Controls.Add(L_onetree(i)) Me.ResumeLayout(False) ''フォームサイズ（高さ）変更 __OL_FS__ = __OL_FS__ + 40 '次座標値入力 __OL_BOT_Y__ = __OL_BOT_Y__ + 40 __OL_LOT_Y__ = __OL_LOT_Y__ + 40 'データ表示 L_onetree(i).Text = "・" & __OL_RE_TITLE__(__OL_ST_COUNT__).ToString __OL_ST_COUNT__=__OL_ST_COUNT__+1 Next
4行目のI列から日付がずらーっと入ったスケジュール表があるのですが、5行目以降の項目に対して開始日と終了日を入力したら4行目の日付を元に色が塗られるようにVBAで作成したいので教えてください！ このスケジュール表も｢何日～何日のスケジュール表を作成！｣というVBAで作ってますので毎回日付が違いますので条件付き書式や関数ではなくVBAで作りたいと思ってます。 4行目の日付は2016/5/17という書式設定ですが日付のみが表示されるように指定してあります。 開始日と終了日も西暦から入力します。 どうやって作ればいいか教えてください。 ※Excelのサンプル画像を投稿しての再質問です。
Sub 集計() Dim y As Integer Dim m As Integer Dim res(12) As Long y = 2016Worksheets("フォーマット").Select For m = 4 To 15 res(m) = Application.CountIf(Range("G:G"), ">=" & DateSerial(y, m, 1)) - Application.CountIf(Range("G:G"), ">=" & DateSerial(y, m + 1, 1)) 'Worksheets("集計").Range("W" & m).Value = Format(DateSerial(y, m, 1), "yyyy年m月") Worksheets("集計").Range("C" & m).Value = res(m) Next m Worksheets("集計").Select End Sub 上記のマクロがエラーとなります。 解決方法を教えて下さい。 2016/4月から2017年3月まで集計したいです。
マクロについて質問です。res(m) = Application.CountIf(Range("G:G"), ">=" & DateSerial(y, m, 1)) - Application.CountIf(Range("G:G"), ">=" & DateSerial(y, m + 1, 1)) この式を分かりやすく丁寧に教えていただけないでしょうか？
VisualBasicのオススメ本が有りましたら教えてください❗ 明日から仕事でVisualBasicを使うことになりました。エクセルマクロを使ったログ解析の業務です。 分からない用語等があれば即興で引けるようなものだと助かります。 どうかよろしくおねがいします。
エクセルのマクロで一定の条件の値を別シートから抽出したいです。 条件の取得としては以下の処理になります。 図の左のようにシート１には不規則に日付情報が並んでいます。まず、マクロを実行する日の日付のセル（シートに１つだけ存在します）を選択し、その左端Ａ列の値を取得します。 更に取得した値から下２つも同様に取得します。 例えばマクロを実行させた今日が２月３日ならばＡ列の「３、４、７」が取得されます。 また、Ａ列は２０で終わっておりますがＡ１セルにループさせたいです。 マクロを実行させた日付によっては値として「２０、１、３」が取得されるような感じです。 この条件の値を図の右のようなシート２の特定列（図ではＣ列）において抽出させたいです。 例えば今日が２月３日ならば先ほど取得した「３、４、７」のいずれかをＣ列に含む行のみを表示させる形になります（他の行は間引いて抽出結果のみ上に詰める表示がよいです）。 図ではＣ列に「３」をもつ２行目と「７」をもつ５行目のみが抽出されるはずです。 マクロ初心者なので悪戦苦闘しております。 ぜひご教授ください。 よろしくお願いします。
※至急です※ ご回答お願いします。 ホームページについてです。 業者にスマートフォン向けのサイト作成を依頼しました。 ム―バブルタイプを使用しており、サーバーはｆｆｆｔｐです。現在ＰＣ版のＨＰがある状態です。 業者からはＨＴＭＬでデータを受け取っています。 業者より ①データ一式を サーバー上に（下層の【s】フォルダ）に アップして下さい。 ②ＰＣ版ホームページの<head>～</head>の中に、 下記のタグをコピペして設置して下さい。 ※タグ自体はもらっています。 ①と②の指示を受けていますが初心者でよくわかりません。 下層の【s】フォルダも見当たりません。 最下層がどこなのかを知る方法も教えていただきたいです。 サクラエディタで既存のページの写真変更、文字変更程度は出来ますが 全くの初心者なのでわかりやすく教えていただけると助かります。 添付画像は業者からのデータです。 宜しくお願い致します。
バーコードの読み取りについて教えて下さい。 エクセルのセルの書式設定を”BC39”にし、そのセルに"＊M60046＊"という値をVBAで設定しました。その後、そのエクセルシートをVBAから印刷し、印刷された紙のバーコード部分をスキャンしたら「m60046」とテキストファイルに読み取れました。 なぜスキャン結果が「M60046」とならないのでしょうか。 わかる方いればやり方を教えていただけないでしょうか。
仕事でExcelマクロを使用しています。ひとつのbook内に1000近くのsheetがあります。 これらをひとつづつcsvで、ファイル名は（sheet名.csv）として保存したいのです。 sheet名の重複はありません。 欲を言えば処理スピードが早いといいのですが… どなたか、ご教授ください。よろしくお願いします。
VB.netです。 リストボックスに、別のクラスで作られたコレクションの文字列の一部を表示させたいのですが、うまくいきません。 今のところのコードは次のようになっています。なおこれは、昨日q13159318738で質問させていただき、回答をいただいたものを基に直したものなのですが、「文字列の一部をリストボックスに表示する」ことができないということは解決できませんでした。返信欄を用いて書き込みしようと思ったのですが、文字数が多いせいかなぜかできませんでしたので、あらためて新たな質問でいれさせていただきました。 Public Class Form1 Private Sub Button1_Click_1(sender As Object, e As EventArgs) Handles Button1.Click ListBox1.Items.Clear() Dim item_dataList As New Class1 Class1.Main() For Each i As String In item_dataList.d ListBox1.Items.Add(i) Next End Sub End Class Public Class Class1 Shared _d As New List(Of String) Public Shared Sub Main() For c = 1 To 5 aaa() Next _d.Sort() End Sub Private Shared Sub aaa() _d.Add("ｘｘ" & "ＸＸＸＸ") End Sub Public ReadOnly Property d() As List(Of String) Get Return _d End Get End Property End Class で当方の思いは、リストボックスにの文字列「Add(i)」の一部（Substring(3)など）を表示させたいのですが、いろいろやってみたのですが、うまくいません。 大変恐縮ですが、ご教示いただければ助かります。
Vb.Net初心者です。 フォーム上に表示するListBoxでは、次のようなことはできるでしょうか。 ①たとえば上の３行だけ、あるいは３行目と５行目だけ背景色または文字色を変える。②マウスが乗っている行だけ背景色または文字色を変える。 また同様にDataGridViewの場合、①はできそうなのですが②がどのようにしたらいいかわかりません。 ご教示方よろしくお願いします。
excel vbaの事で質問です。1000-1 1001-1 預かり中 1001-2 預かり中 1001-3 預かり中 1002-1 預かり中 1003-1 預かり中 1003-2 預かり中 1004-1 1004-2 1004-3 預かり中 上記の場合預かり中の件数4人とカウントしたい 以上のようなシートのテーブルがあった場合にハイフンの前の数字（顧客NO）と預かり中の条件でカウントをしたいのですがどのようなコードになりますか？ よろしくお願い致します。
オートフィルターがうまくいきません。 下記のコードをかきました。ボタンを押すと、必要なものが抽出されるはずなのですが・・・ Private Sub CommandButton1_Click() '検索 Range("A7").AutoFilter Range("A7:M5000").AdvancedFilter _ Action:=xlFilterInPlace, _ CriteriaRange:=Range("A2:M3"), _ Unique:=False End Sub 今まではできたのに、 新しくデータを入力したものや、 元に入っているデータを書き替えたりすると、 全く抽出してくれません。 空欄もありません。 一体なぜでしょう？
WindowsのPoweｒShellのスクリプトについてなのですが、「 $ps = Start-Process -FilePath 実行コマンド -ArgumentList NNN -PassThru 」 上記のような記述で、１つのprocessであれば終了待ちは可能なのですが、 実際には上記のコマンドを、forループ内で、条件を満たしてる場合だけ、NNNのところを変えて、 processを起動したいと考えています。 そのあとに、実行したprocessがすべて終了するのを待って、 次の処理へ移行したいと思っているのですが、 Start-Proceesの返り値である、「System.ComponentModel.Component」を、事前に配列などで宣言は、可能でしょうか？ または、一番良いのは、事前に配列を宣言するのではなく、processの実行時に配列の要素を追加していければと考えています。 何か、良いアイデアがありましたら、ご教授頂けると嬉しいです。
C＃で作って、ＷＥＢにアップする方法 お世話になります。ＶＢやＶＢＡおよびｃ＃そのたＤＢなど、ローカルで動作するのものは多少作ったことがあるのですが、 ＷＥＢで動作するものをまともに作ったことがありません。 今回関係者一同で共有使用できるカレンダーソフトが必要になりました。 多少特殊な使い方をする為、GoogleCalenderなどではなく、イチから作りこみをする必要があります。 Visualstudioにてｃ＃で作れば、簡易にＷＥＢ・ＡＳＰサーバにアップして、動作させられる、 というのは聞いたことがあるのですが、具体的にどのような手順で何をすればよいのか、 説明している本やサイトを教えて頂けませんでしょうか よろしくお願いします。
Excel VBAを学んでいる者です。ShapesコレクションのAddメソッドについてお教えください。 例えば、AddChartやAddPolylineでオブジェクトを生成したとします。Polylineオブジェクトを10個、シート上に作成します。 各オブジェクトに対して、名前を付けることは可能なんでしょうか？名前をつけて、その特定のオブジェクトに対して何らかの操作をしたいと思っていますが、オブジェクトに対しての名前の付け方がわからない為、どのようにすればよいでしょうか？ 昔に学校でVBを習った時には、ボタンとか、色々なオブジェクトに対して名前をつけられたと記憶していますが、VBAでもそのような事は可能なんでしょうか？
VB初心者です。 Outlookメール（.msg）から添付ファイルのみ取り出すコーディングはできますか。 サンプルなどで教えてほしいです。探しましたがわかりませんでした。Outlookから「：C￥メール」にmsgファイルを手動で移し、そこからVBにて「：C￥添付ファイル」に添付ファイルのみを取り出したいです。
C言語自体（アプリケーション）のPC移行について。 移行元をA、移行先をBとします。 AのCドライブ（容量）が満タンに近くなったため、 容量の大きいPC、Bを購入しました。そこでAの中のものをBへUSB伝いで移行させたのですが C言語のみ正常に動作することが出来ませんでした。 使っているのはMicroSoft Visual Studio 2013です。 移行したソフトを起動させようとすると 「Cannot find one or more components. Please reinstall the application」 日本語訳（エキサイト翻訳より）は 「1つ以上のコンポーネントを見つけることができない。 どうぞ、アプリケーションを再設置してください。」 です。 友人にファイルを確認してもらい、 使える人と同じファイルやアプリケーションの配置と なっていることは確認しました。 正常に使えるための解決案はありませんでしょうか。 候補でも構いません。 また、USB伝いでの移行ということで ライセンスの関係で使えないことを考えたのですが そこはどうなのでしょうか。
VB.NETのプログラムについて質問です。 フォームに存在するピクチャボックスをドラッグで移動させるアプリケーションをつくろうと思い、 次のようなコードを入力しました。Public Class Form1 Dim bDrag As Boolean, ptDrag As Point Private Sub PictureBox1_MouseDown(sender As Object, e As EventArgs) Handles PictureBox1.MouseDown If bDrag = False Then bDrag = True ptDrag = Cursor.Position End If End Sub Private Sub PictureBox1_MouseMove(sender As Object, e As EventArgs) Handles PictureBox1.MouseMove If bDrag Then PictureBox1.Location = PictureBox1.Location + Cursor.Position - ptDrag ptDrag = Cursor.Position End If End Sub Private Sub PictureBox1_MouseUp(sender As Object, e As EventArgs) Handles PictureBox1.MouseUp bDrag = False End Sub End Class このプログラム自体は正常に動いたのですが、ピクチャボックスの数が増えた時同じコードを書き足さねばならず、非常に面倒です。 ピクチャボックスの数が増えてもコードを書き足さずに、一括で管理できる方法はありませんか。 そのような方法がありましたら、教えてください。
visualbasic5.0では、Clsを使ってテキストボックスに記入された文字とかをクリアしていたので、2010でも同じように使えるのかと思っていたら使えませんでした…5.0の時のClsはどのように記述すれば2010でも同じようなものが使えるようになりますか？
エクセルVBAの質問です。 Aブックの日付を入力したセルとM列の価格を基にAブックのC,D,E,F列にBブックの価格を表示させるにはどのようなマクロが良いのでしょうか？Aブック： ・固定セル：日付 ・M列＝価格100行 AブックM列の価格と同じ行にBブックからひっぱたA,B,C,Dの価格を AブックC,D,E,F列に表示させる M列には100行あるので、100行のAブックC,D,E,F列全て埋めたいのです。 Bブックには検索したシートが無い場合もあるのでエラー回避しながら数値を持ってきたいのです。 Bブック（シートに（1510C+AブックのM列の価格）の名前） ・A列＝日付 ・B列＝価格A ・C列＝価格B ・D列＝価格C ・E列＝価格D どうぞよろしくお願いします。
Exccel2010のハイパーリンクのアドレスに社内http://を入力したのですが、文字数が大きすぎて接続ができません。 その手前までのhttp://では、開くことが可能です。VBAを使って文字数が大きくてもリンクするようにできないものでしょうか？ ご教授をお願いします。
ExcelのVBAで下記のコードを使うと エラー 91 「オブジェクト変数または With ブロック変数が設定されていません。」がでます。 改善策を教えて下さい。Dim r As Range Set r = Range("A2:A99").Find(ComboBox1.Value).Offset(0, 1).Value ComboBox2.Value = r Dim r As Range Set r = Range("B2:B99").Find(ComboBox2.Value).Offset(0, -1).Value Set ComboBox1.Value = r
EXCELのVBAでテキストボックス（とコマンドボタン）で検索した結果をラベル、またはリストボックスに表示することはできますか？例１、氏名を検索して該当の人物の生年月日、住所、血液型をそれぞれ別のラベルに表示する。 例２、血液型を検索して該当の人物（複数）をリストに表示し、そこから選択した人物のデータを 各ラベルに表示する。
EXCELのVBAでコンボボックス１で血液型を選んで コンボボックス２に該当の人物だけ表示させたいのですがどうすればよいでしょうか？
VBAで人工無能を作っています。 この文だとエラーになってしまうのはわかっているんですが、 どう直せばいいかわかりません。助けてください！ ちなみにこの上は.txtファイルをロードする文です For k = 1 To 100 If InStr(kan, nin(k)) Then MsgBox (nan(k)) Next ElseIf InStr(kan, "さようなら") Then End Else MsgBox ("辞書にない......") End If End Sub
エクセルのVBAについて教えてください。Public Function Samp1(ByVal iNum As Long, vA As Variant) As Variant Dim vB As Variant Dim i As Long ReDim vB(LBound(vA) To UBound(vA)) i = LBound(vA) Do While (1) While ((iNum > 0) And (i <= UBound(vA))) vB(i) = iNum \ vA(i) iNum = iNum - vA(i) * vB(i) i = i + 1 Wend If (iNum = 0) Then Exit Do For i = UBound(vA) To LBound(vA) Step -1 If (vB(i) > 0) Then Exit For Next If (i < LBound(vA)) Then Exit Do If (i = UBound(vA)) Then iNum = iNum + vA(i) * vB(i) vB(i) = 0 Else iNum = iNum + vA(i) vB(i) = vB(i) - 1 End If i = i + 1 Loop If (iNum = 0) Then Samp1 = vB End Function Public Sub test1() Dim vA As Variant, vB As Variant Dim sS As String Dim i As Long vA = Array(8, 5, 3) sS = "" Do While (1) sS = sS & "余りの寸法を入力してOKを押す" sS = InputBox(sS, , "0") i = Val(sS) If (i < 1) Then Exit Do vB = Samp1(i, vA) sS = "" If (Not IsEmpty(vB)) Then sS = "必要なスポンジ厚み及び枚数: " & i & vbCrLf & vbCrLf For i = LBound(vA) To UBound(vA) sS = sS & vA(i) & " が " & vB(i) & " 個 (" _ & vA(i) * vB(i) & ")" & vbCrLf Cells(i + 13, "Au").Value = vB(i) Next sS = sS & vbCrLf End If Loop End Sub においてマクロを実行した時に、値を自分で入力するのですが 特定のセルに数値が入力されるとマクロが実行され、自動計算し特定のセルに解を出力するには どのようにしたら良いでしょうか？ セルBA７に”２６”と入力すると、勝手にマクロ実行 解を特定のセルに出力 と言ったような感じです。 宜しくお願いします。
ループ処理について教えて下さい！ シート「入力」のＢ２～Ｂ３０まである値をシート「ＱＲコード」にあるＣ９に入力させＱＲを表示させて印刷します。これをシート「入力」のＢ２から下にデータがあるまでを繰り返したい。下記のようにコードを書きましたが２番目で止まってしまします。どこを改善すればよろしいでしょうか。どうかご教示願います。 Sub ＱＲPRINT() Application.DisplayAlerts = False Application.ScreenUpdating = False Dim strFileName As String On Error Resume Next On Error GoTo 0 Windows("カバ－シート印刷.xlsm").Activate Dim i As Long i = 2 Do While Cells(i, 2) <> "" Worksheets("ＱＲコード").Cells(9, 3) = Worksheets("入力").Cells(i, 2) Worksheets("QRコード").PrintOut Copies:=1 '変数iを1つ繰り上げ i = i + 1 Loop Sheets("入力").Select Range("B2:B21").Select Selection.ClearContents End Sub
ループ処理について教えて下さい！ シート「入力」のＢ２～Ｂ３０まである値をシート「ＱＲコード」にあるＣ９に入力させＱＲを表示させて印刷します。これをシート「入力」のＢ２から下にデータがあるまでを繰り返したい。下記のようにコードを書きましたが２番目で止まってしまします。どこを改善すればよろしいでしょうか。どうかご教示願います。 Sub ＱＲPRINT() Application.DisplayAlerts = False Application.ScreenUpdating = False Dim strFileName As String On Error Resume Next On Error GoTo 0 Windows("カバ－シート印刷.xlsm").Activate Dim i As Long i = 2 Do While Cells(i, 2) <> "" Worksheets("ＱＲコード").Cells(9, 3) = Worksheets("入力").Cells(i, 2) Worksheets("QRコード").PrintOut Copies:=1 '変数iを1つ繰り上げ i = i + 1 Loop Sheets("入力").Select Range("B2:B21").Select Selection.ClearContents End Sub
マクロが保存される先、モジュールの場所について 後で追えるように、マクロ名に番号入れて登録していますが、 マクロの保存先を指定したり、移動したり、モジュール名変更などできるものでしょうか基本的な質問ですみません。
Visual Studio（バージョンは2008以降ならなんでも）でVB、C#問わず、アプリでファイルオープンしようとした際の排他エラー時に、どのプロセスがロックしているかを、アプリ内で知るにはどうすればよいでしょうか。 どのプロセスでロックしているのかをアプリ内で取得できるなら、それをエラーログに出力したいと思っています。
エクセルの一部のセルに保護をかけて、そのセルの関数をいじることが出来ないようにしたいのですがどうすればいいですか。また、そのセルが関数が入っていることをわかるように色等を付けてわかりやすくしたいです。但し印刷の際は色は出ないようにしたいです。
VBAで特定シートを複数コピーするには。 ご覧いただきましてありがとうございます。シートをコピーするにはCopyメソッドを使うことは分かったのですが，以下のようなことをするには知識不足でして，どなたかご教示いただけませんでしょうか。 やりたいこと ①自ブックの特定のシート（Sheet6）をコピーする。 ②親フォルダ内の，自ブックの存在するサブフォルダを除く，全てのサブフォルダに新規ブックとして，「AAA」という名前で保存する。 ③相対パス指定で行いたい。 前提 ①親フォルダにはサブフォルダa，サブフォルダb，サブフォルダc…と複数のフォルダが存在する。 ②自ブックは親フォルダ内のサブフォルダ「自ブックフォルダ」に保存されている。 よろしくお願いいたします。
お世話になっております。 ExcelVBAのユーザーフォームでの質問なのですが textbox1に値が入った場合ListBox1_Click内で宣言している変数の更新は可能ですか？説明の仕方がこれであったいるのかちょっと自信ないのですが コードを簡単に載せさせていただきますので是非ご教授願います。 Private T As Variant Private TT As Variant Private Sub TextBox1_Change() T = TextBox1.Value End Sub Private Sub TextBox2_Change() TT = TextBox2.Value End Sub Private Sub ListBox1_Click() txtbox3.value=" &T & "分～" & TT & "分” End sub ちょっと簡単に書いたので一部間違っているかもしれませんがよろしくお願いします。
お世話になります。 excel VBAに関する質問です。現在sheet1にA～F列までデータ（複数行）がありテキストボックス１で入力した内容をF列で検索して検索結果をリストボックス２に表示するようになっています。 質問の内容ですが不要なデータ（行）を検索結果から削除できるようにリストボックス２に表示された中から選択してコマンドボタンを押した際に選択した抽出行を削除できるようにならないかと考えています。 その為のコードをご教授いただけないでしょうか？ よろしくお願いします。 ※以下が現在のコードです。 Private Sub TextBox1_Change() Dim Obj As Object Dim wAddST As Variant Dim w As Variant ListBox2.Clear If TextBox1.Value = "" Then Exit Sub With Worksheets("SheetA").Columns("F") Set Obj = .Cells.Find(What:=TextBox1.Value, _ LookIn:=xlValues, _ lookat:=xlPart, _ MatchByte:=False) If Not Obj Is Nothing Then wAddST = Obj.Address Do If IsArray(w) Then ReDim Preserve w(1 To 6, 1 To UBound(w, 2) + 1) Else ReDim w(1 To 6, 1 To 1) End If w(1, UBound(w, 2)) = Obj.EntireRow.Range("A1").Value w(2, UBound(w, 2)) = Obj.EntireRow.Range("B1").Value w(3, UBound(w, 2)) = Obj.EntireRow.Range("C1").Value w(4, UBound(w, 2)) = Obj.EntireRow.Range("D1").Value w(5, UBound(w, 2)) = Obj.EntireRow.Range("E1").Value w(6, UBound(w, 2)) = Obj.EntireRow.Range("F1").Value Set Obj = .Cells.FindNext(Obj) If Obj.Address = wAddST Then Exit Do Loop End If End With If IsArray(w) Then ListBox2.Column() = w Else MsgBox "存在しません。", _ vbOKOnly + vbInformation, "検索" End If End Sub
VBA 空白セルに数式を貼付 B2からB20の範囲の空白セルに、 B1に入っている数式を貼付を行いたいのですが 以下の記述だと、B2からB20すべてに貼付をしてしまいます。Sub test() With ActiveSheet For Each c In Intersect(.Range("B2:B20"), .Range("A1").CurrentRegion) If c.Formula = "" Then c.Value = Range("B1").Copy c.PasteSpecial Paste:=xlPasteFormulas Next End With End Sub この記述をどのように修正したらうまくいくでしょうか？ ご指導願います。 またこの記述だとモッサリしていて動きが悪いです。 B1のセルにはVLOOKUPなどが入る予定なのですが… 上記の記述以外で、良い方法があれば、お教え頂きたいです。 よろしくお願いします。
VBAを使い、フォルダ内の全てのエクセルシートを開き、特定の箇所に数字を記入し、閉じたいです。 いつもお世話になっております。VBAを使い、 『「フォルダ内の全てのエクセルシートを開」き、「特定の箇所に数字を記入」』 したいです。 稚拙ながら下記の記述で、 「フォルダ内の全てのエクセルシートを開」く 事は出来ました。 その後、 「特定の箇所に数字を記入」 の為に、下記のコメントアウト部分を記述したのですが、 （試しという事でで、セル『A2』に『123』と入力する様にしました） エラーこそ出ないものの、上手く入力されませんでした。 ご面倒だとは思いますが、お分かりになられる方がおられましたら、ご教授いただけないでしょうか。 よろしくお願いいたします。 Sub OpenAllBooks() Dim FileName As String Dim OpenedBook As Workbook Dim IsBookOpen As Boolean On Error Resume Next FileName = Dir(ThisWorkbook.Path & "\*.xls") Do While FileName <> "" IsBookOpen = False For Each OpenedBook In Workbooks If OpenedBook.Name = FileName Then IsBookOpen = True Exit For End If Next If IsBookOpen = False Then Workbooks.Open (ThisWorkbook.Path & "\" & FileName) コメントアウト 'Workbooks(ThisWorkbook.Path & "\" & FileName).Activate コメントアウト 'SelectedWorkbook.Range("A2").Value = 123 End If FileName = Dir() Loop End Sub
複数のエクセルファイルに、同じシートの同じセルに同じ内容を 入力して保存したいのですが・・・すでにある複数のファイルの一部の数値が変更になり、すべてのファイルに同じ入力作業をしなくてはなりません。 ちなみに 複数のファイルはデータは違いますが、同じプログラムです。 すべてのファイルは、同一のパスワードが設定されています。 ”料率”というシートのＡ1に0.4を入力 Ｂ２に0.7を入力するとします。 ファイルを開くパスワードは、ｘｘｘｘとします。 ビジュアルベーシックの知識がありません。 ご教示をお願いいたします。
文字の検索についてお教え下さい。A列に文字が入っている物として 1行目「い」 2行目「い」 3行目「い」 4行目「い」 5行目「ろ」 6行目「ろ」 7行目「は」 8行目「は」 9行目「に」 10行目「ほ」 現状、If cells(i,1) <> "い" then 見たいな意味でFor文のループをしていますが、 実際は「い」が数千行や数万行とかあったりするので、「ろ」に辿り着くまで結構な時間を要します。 この場合、一つずつ見て行くのではなく、「ろ」を一発で検索する手段はあるでしょうか？ ちなみに、「い」の次が必ず「ろ」になるわけではないので、mutchを使った文も私は思いつきませんでした。 お詳しい方、何卒お力をお貸し下さい。
EXCELで、シート上の登録ボタンをクリックするとメッセージボックスが表示して、中にボタンを４個表示して、どれかクリックすると閉じて、設定してあるマクロが動く。 というイメージを作りたいのです。メッセージボックスでは無理なのは解りましたが、同様のイメージになるような作り方を ご教授ください。よろしくお願いします。
エクセルマクロで色を一括変更できる記述をご教示ください。 シート内にあるすべての黄色に塗られたセルをマクロを使って一括で黒色にしたいのですが、そんなマクロ作成は可能なのでしょうか？
セルの結合について教えてください。 VBAでセルの結合をしようとしていますが、下記の条件の場合どうすれば結合できるか教えてください。 ・H5～T5まですでに結合されている ・H6～T6まですでに結合されている すでに結合されているセルを更に結合する場合、H5:H6というような先頭のセルのみの指定でいけますか？ それともH5：T6のような全てを指定しないとダメでしょうか？ 最初に提示したすでに結合されているセルの範囲も変わる場合があるかもしれないので、結合されているセルを検索して、その結合されているセルと下のセルを結合するというようなこともできるのでしょうか？
エクセルで特定文字Aの右のセルに指定文字を入れるというコードを作っています。 特定文字Aは複数箇所ありますが、全ての特定文字Aの横に指定文字を入れるのではなく、特定文字Aの左のセルに特定文字Bがあった場合は、指定文字は入れません。 が、どうしてもうまく動きません。 現状、下記のコードです。 Dim i i = 0 For i = 1 To Worksheets("sheet1").TextBox2 With ThisWorkbook.Worksheets("DATA").Range("A1:IV500") Set c = .Find("特定文字A", LookIn:=xlValues) If Not c Is Nothing Then firstAddress = c.Address Do Dim isOk As Boolean isOk = False If c.Column = 1 Then isOk = True Else If Not c.Offset(0, -1).Value Like "*" & 特定文字B & "*" Then isOk = True End If End If If isOk = True Then c.Offset(0, 1).Value = Worksheets("sheet1").Cells(i, 22) End If Set c = .FindNext(c) Loop While Not c Is Nothing And c.Address <> firstAddress End If End With このコードで動かした場合、特定文字Aの左のセルに特定文字Bがある場合に指定文字を入れないという箇所以外のところも指定文字が入らずに困っています。
至急です。 文字列の中にある特定のキーワードより前を取得するコードをご教示頂けないでしょうか。 例としまして、 lstr = ″あいうえお″ キーワードが、″え″の場合、″あいう″を取得するコードです。 何卒、宜しくお願い申し上げます。至急です。 文字列の中にある特定のキーワードより前を取得するコードをご教示頂けないでしょうか。 例としまして、 lstr = ″あいうえお″ キーワードが、″え″の場合、″あいう″を取得するコードです。 何卒、宜しくお願い申し上げます。
Exelのコード（自動日付入力）に関して質問です。 パソコンに詳しい方にお聞きします。 以前知恵袋で、日付の自動入力のやり方を見ました。例えば、Ｄ列に何かを入力すると、自動的にＣ列に日付が書き込まれる方法は シートのコードに Private Sub Worksheet_Change(ByVal Target As Range) If Target.Column <> 4 Then Exit Sub Application.EnableEvents = False Target.Offset(, -1).Value = Now Application.EnableEvents = True End Sub を追加するだけだということで、試すと大成功でした。 そこで更にＦ列にも何かを入力すると、自動的にＥ列にも日付が書き込まれるようにもしたいのです。 （※入力はＤとＦのみ。日付はＣとＥに出てくればＯＫです。） その場合のシートのコードはどのようにすればいいでしょうか。 解答お待ちしております。
エクセルで質問です。 今一つのファイルに違うpass付きのファイルをリンクさせています。 もちろん更新するために毎回passを聞いてきますがVBAでpass自動入力で開けないかやり方を教えてください。
ワードから赤文字だけを抜き取ってエクセルに貼り付けたい。 こちらの質問の続きです。http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1015866687... 上記の質問でご回答いただきましたが、実行すると「SubまたはFunctionが定義されていません」というアラートが出てしまいました。 下記VBAの修正をお願いします。 Sub Sample() Dim fpath As String Dim fname As String Dim i As Long, j As Long, k As Long Dim cnt As Long Dim moji As String 'フォルダの選択 With Application.FileDialog(msoFileDialogFolderPicker) .Title = "フォルダを選択" .AllowMultiSelect = False If .Show = -1 Then fpath = .SelectedItems(1) & "\" Else Exit Sub End If End With Application.ScreenUpdating = False Set WD = CreateObject("Word.Application") fname = Dir(fpath & "*.docx") If fname = "" Then MsgBox ("データなし") Exit Sub End If j = 0 Do Until fname = "" Set wddoc = WD.Documents.Open(fpath & fname) wddoc.Range.Copy Range("A1").Select ActiveSheet.Paste j = j + 1 k = 1 For i = 1 To Cells(Rows.Count, 1).End(xlUp).Row moji = "" For cnt = 1 To Len(Range("A" & i).Value) If Range("A" & i).Characters(Start:=cnt, Length:=1).Font.Color = vbRed Then moji = moji & Mid(Range("A" & i).Value, cnt, 1) End If Next cnt If moji <> "" Then k = k + 1 Cells(j, k) = moji End If Next i Range("A1:A" & Cells(Rows.Count, 1).End(xlUp).Row).ClearContents wddoc.Close fname = Dir() Loop WD.Quit Set WD = Nothing Columns("A:A").Delete Range("A1").Select Application.ScreenUpdating = True End Sub
JANコード（4573222377046）でアマゾンで検索して、出てきた商品のURL（http://www.amazon.co.jp/dp/B01BK7OKHA）をとりたいのですが、VBAを書いていただけませんか？ ↑のコードやURLは一例ですが、もっているJANコードが何万もあります。手作業では大変です。
マクロを教えてください。VBA勉強中ですが、至急必要なマクロができたので、次の作業を行うコードを教えてください。 ブックには最初に集計シートと、その後ろに15ほどシートがあります。 集計シートの次のシート名を取得→集計シートのA1セルに転記→集計シートの次のシートの一番終わりのセル（ctrl）をコピー→集計シートの、先ほど転記したシート名の隣B1にペースト→次のシートのシート名を集計のA2に転記→次のシートの最後のセルを集計のB2へ転記→…繰り返し やりたいことは、各シート名とそのシートの最後のセルの内容を集計シートに一覧にしたいということです。 よろしくお願いします。
どこが間違えっているでしょうか？VBA初心者です。 住所１（G列）の改行有無を調べたいです。 改行有の人のみ表示させたいです。 関数はG列から結構離れてますが、AK列に入れてます。 関数は「=IF(ISERROR(FIND(CHAR(10),G7)),"","改行有")」です。 ＊人数が変動するので自動的に最終行変更(途中余白無視して最後まで)できるプログラムをお願いします。 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー Sub 住所1行目改行有無チェック() ' ' 住所1行目改行有無チェック Macro ' Dim LastRow As Long LastRow = Range("Q" & Rows.Count).End(xlUp).Row Range("AK7").Select ActiveCell.FormulaR1C1 = "=IF(ISERROR(FIND(CHAR(10),RC[-30])),"","改行有")" Selection.AutoFill Destination:=Range("AK7:AK" & LastRow), Type:=xlFillDefault ActiveSheet.Range("$A$6:$AK$" & LastRow).AutoFilter Field:=37, Criteria1:="改行有" Range("G6").Select MsgBox "住所1行目改行チェック終了しました。" End Sub ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー 上のVBAを入れて実施してみたのですが、ActiveCellの行がエラーらしくうまくできません。 どこが間違いでしょうか？
ACCESS2013のデータを、Excelデータに変換をしたいです。(ACCESS2013のデータ) 製品名 工程 工程順 製品１ Ａ工程 1 製品１ Ｄ工程 2 製品１ Ｇ工程 3 製品２ Ｂ工程 1 製品２ Ｅ工程 2 製品３ Ｃ工程 1 製品３ Ｆ工程 2 製品３ Ｈ工程 3 製品３ Ｉ工程 4 (Excelへ変換したいデータ形式) 製品１ Ａ工程 Ｄ工程 Ｇ工程 製品２ Ｂ工程 Ｅ工程 製品３ Ｃ工程 Ｆ工程 Ｈ工程 Ｉ工程 どうすれば上記のような形にできますでしょうか？ 製品・工程が多く、手作業では時間が掛かりすぎますのでクエリやVBAで変換したいです。 済みませんが、宜しくお願い致します。
VBAで以下のソースから3,728という数値のみ取り出したい場合、どのようにプログラムすればよいでしょうか？<div class="grid_4"> <div class="kabunushi"> <p><span class="fontbold">【株式】</span>1/31 11,772千株</p> <p id="kabu_tl"><span class="fontbold">【株主】</span>[単]3,728名<15.11> 万株</p> Dim class10 As IHTMLElement Set class10 = doc.getElementsByClassName("kabunushi")(0) Dim td7 As IHTMLElement Set td7 = class10.getElementsByTagName("p")(0) Worksheets("メイン").Cells(2, 14) = td7.innerText これですと【株主】と表示されてしまいます。 詳しい方よろしくお願いします。
エクセルマクロにつきまして、ご教授ください。添付のようなセルがあり、 A列の結合されている部分ごとで表示を行い、 A列に記入されている文字をタイトルとしてPDF出力を行いたいのですが、 そのようなマクロは可能でしょうか？ （今回であれば、 マクロ起動→A1:B3までを範囲として、A1セルに書かれた文字をタイトルとしてPDF出力 A4：B13までを範囲として、A4セルに書かれた文字をタイトルとしてPDF出力 A14:B14までを範囲として、A4セルに書かれた文字をタイトルとしてPDF出力 A15:B17までを範囲として、A4セルに書かれた文字をタイトルとしてPDF出力 といった形で、記入された最後のセルまで繰り返したいです） また、どのように組めば良いのでしょうか？ よろしくお願いいたします。
ＶＢＡ（マクロ）でオートフィルターを使うとき可変する範囲を設定する方法についてマクロで以下のようなものを組んだのですが、これだとオートフィルターをかける範囲が$A$1:$U$1001を超えたときにうまく作動しなくなってしまうので直したいのですが、やり方がうまくわからず困っています。 あと、Sheets("Sheet1").Selectと指定しまうことにより、２回目以降一回エクセル一度×で消してから行わなくていけないのですが、いい対策法はございますでしょうか. よろしくお願いいたします。 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ Cells.Select Selection.AutoFilter ActiveSheet.Range("$A$1:$U$1001").AutoFilter Field:=8, Criteria1:="AAA" Cells.Select Selection.Copy Sheets.Add After:=Sheets(Sheets.Count) Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Sheets("Sheet1").Select Columns("F:F").Select Selection.NumberFormatLocal = "yyyy/m/d h:mm;@" Sheets("Sheet1").Name = "AAA"
CheckBoxの変更をキャンセルする方法は？CheckBoxが変更された際に、とある条件によって変更の可否したいのですが Me.Undo または Cancel = True としてもダメでした。 どうしたら良いでしょうか？
VBAで自分自身の名前を取得 UserForm1にCommandButton1とTextBox1～3を配置。Private Sub CommandButton1_Click() TextBox1 = Me.Name TextBox2 = Me.ActiveControl.Name End Sub とすれば、TextBox1には「UserForm1」、TextBox2には「CommandButton1」とオブジェクト名が表示されます。 TextBox2がChangeされた時、TextBox3に「TextBox2」とオブジェクト名が表示されるようにしたいのですが、Activeでないオブジェクト名を取得するには、どのように記述したら良いのでしょうか？ Private Sub TextBox2_Change() TextBox3 = Me.?? End Sub Activeでない自分自身のオブジェクト名取得方法って感じですかね。
Access 2007 でのデータベース作成について質問させていただきます。 販売管理のシステムを自作しようと思うのですが、手詰まりでどうしたらよいのか困っています。要点としましては、 １：得意先毎に同じ物でも販売している物の単価が違う。 ２：品目毎の集計と得意先毎の集計を行いたい。 ３：入力フォームで絞り込んで選択していく方式にしたい。（例：得意先→商品名と選ぶと、予めテーブルにマスターとして登録してある単価を返し、数量を入力すると計算される。） ４：３で入力したものを印刷ボタンを作って印刷したい。 以上です。 得意先マスター、商品の価格マスターのテーブルの作成は終わりましたが、肝心の伝票テーブルと入力フォームをどのように作成していいかわかりません。 伝票テーブルをどのように作り、ＶＢＡをどうしてやればいいのか教えて頂けると幸いです。 よろしくお願い致します。
マクロで最終列を取得して削除 初歩的な質問かもしれませんが ある一定の行以降を削除する場合 Row = Cells(Rows.Count, 1).End(xlUp).RowRows("2:" & Row).Delete で削除可能ですが 列の場合 Col = Cells(1, Columns.Count).End(xlToLeft).Column Columns("2:" & Col).Delete ではエラーが出ます どうすればよろしいのでしょうか？
VBAでご教授ください。If Val(TextBox1) = Val(Range("H1")) = Val(Range("AA3")) Then 上記のコード すべてが同じ数字でも Else のコードに行ってしまいます。 If Val(TextBox1) = Val(Range("H1")) = Then ここまでは、うまくいったのですが、もう一つ参照を増やした場合、 使うコードは変えなくてはいけないのでしょうか？ If Val(TextBox1) = Val(Range("H1")) = Val(Range("AA3")) Then MsgBox "OKです！" TextBox1 = Clear UserForm1.Hide Else MsgBox "合いません" TextBox1 = Clear UserForm1.Hide End If End Sub
マクロで コピー→値で貼り付け の作業をおこなっていると、 実行途中で、メッセージボックスが表示され、 「既にデータがありますが、置き換えますか？」と出てきます。 都度、「はい」を選択すれば良いのですが、 できれば、プログラム内で「はい」を選択できると助かるのですが、 どうプログラムを足せばよいでしょうか？ 下記のようにプログラムいれてあります。 Set range1 = Range("L6:L21") range1.Copy Range("L10").PasteSpecial Paste:=xlPasteValues Application.CutCopyMode = False 宜しくお願いします！
エクセルのマクロで、シートBのＡ列の日付が「過去～指定日（シート"A"のB2の日付)」までの行の、 Ａ～K列までセルを選択をしたいです。下記の表ですと、 シートAのＡ2～Ｋ7までを選択したいです。 ※1行目は表題？が入っているので、2行目から選択したいです。 ※入力されている日付は作業時 毎回、変わります。 ※指定日(シート"A"のB2の日付）がシートAのA列に該当が無い時もあります。 マクロ初心者なので、プログラムを書いて貰えると助かるのですが。。。どうか、宜しくお願い致します。
ｺﾝﾎﾞﾎﾞｯｸｽの選択値を別ﾌｫｰﾑのｺﾝﾎﾞﾎﾞｯｸｽに代入するには。「ﾕｰｻﾞｰﾌｫｰﾑ1のｺﾝﾎﾞﾎﾞｯｸｽ1で選択された値を 同ﾌﾞｯｸのﾕｰｻﾞｰﾌｫｰﾑ2のｺﾝﾎﾞﾎﾞｯｸｽ1に代入したいです。」 開く順番ですが、 先にﾕｰｻﾞｰﾌｫｰﾑ1を開いて次にﾕｰｻﾞｰﾌｫｰﾑ2を開きます。 既にｺｰﾄﾞを組みました。 ここでﾕｰｻﾞｰﾌｫｰﾑ2が開かれたときに、 ｺﾝﾎﾞﾎﾞｯｸｽ1に値が出ているのが望ましいです。 よろしくお願いします。
【VBA】同ブックからの列方向への転記集約について 宜しくお願いします。 下記画像①はVBAによる集計で、赤丸の様に日にち分のシートが作成され、 J1：K28の様な結果となります。日々のこのJ1：K28をマクロで作成される新しいシートに転記したいのですが、 図②の様に行方向への転記となってしまいます。 これを、横方向に連続して転記したいのです。 何卒お教え下さい。 下記は転記しているコードです。 宜しくお願いします。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Sub 全シート実行() Application.ScreenUpdating = False Dim Sht As Worksheet For Each Sht In Worksheets If Sht.Name <> "元データ貼付シート" And Sht.Name <> "取引先名リスト" Then Sht.Select Call 集計実行→体裁完了 End If Next Sht Application.ScreenUpdating = True 'ここまで集計実行 'ここから一票纏め Dim sno As Integer Dim i As Integer sno = Worksheets().Count Sheets(1).Select Sheets.Add For i = 2 To sno + 1 Sheets(i).Range("j1:k28").Copy Sheets(1).Range("A65535").End(xlUp).Offset(1, 0).Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Next End Sub
Excelのシートモジュールのマクロで列を結合したセルの高さを自動調整したいです。現在、D1、E1、F1のセルを結合して１つのセルにしていますが、文字を"＆"を使って繋がているため、文字数が全部で500文字くらいあります。 セル結合を解くわけにはいかず、左側のところでダブルクリックによる自動調整もできないため、Excelのシートモジュールのマクロで行の高さを自動調整できればと思っていますが、自分ひとりではなかなか上手くできず…どうか知恵をお貸し下さい。 どうぞよろしくお願い致します。
VBAに詳しい方、教えて下さい。（環境はwindows10のIEです。) 出品作業をExcelで管理しつつexcelから自動出品できる方法を模索しています。ソース元はhttp://www.buyma.com/my/itemedit/の出品するページで 買付け地、発送地をセレクトボックス選択でヨーロッパ、フランスに自動設定したいのですが Dim Select1 As HTMLSelectElement 'Set Select1 = objIE.document.getElementById("itemedit_purchase_area") 'Select1.Value = "2003000000" で、最初のセレクトボックスをヨーロッパに変更はできたのですが、プルダウン選択後に表示されるヨーロッパの国の候補に変わらず選択ができません。 選択後の変更が反映されるにはどういったコードが必要か教えてください。 宜しくお願いします。
Excelで使うマクロを変えて頂けませんか。Sub test() If Selection.Areas.Count <> 2 Then Exit Sub End If With Selection.Areas .Item(1).Resize(5, 5).Copy .Item(2).Cells(1).PasteSpecial Paste:=xlPasteFormats Application.CutCopyMode = False End With End Sub 内容は、最初５列５行の左上隅をクリック(1)、ctrlキーを押し別の５列５行の左上隅をクリック (2)、そしてマクロを実行、結果は(2)の５列５行に、(1)の５列５行の書式がコピーされる、その様な内容のマクロです。 変えて頂きたいのは、書式コピーではなく、(1)と(2)の５列５行を重ね合わせたとして考え、同じ数字が入力された(2)の方のセルにInterior.ColorIndex = 6で着色される様に .Item(1).Resize(5, 5).Copy .Item(2).Cells(1).PasteSpecial Paste:=xlPasteFormats Application.CutCopyMode = False この個所を変えて頂きたいのです。 よろしくお願い致します。２０１０です。
エクセルについての質問です。 エクセルで、関数を考えたり、ＶＢＡでプログラムを考えたり素人には 大変です。小額（下は、１００円～、みたいな）で、そう言う事を作成してくれる、サイトは有りませんか？または、個人で頼める人はいないのでしょうか？ あんな事、こんな事をしたいと思っても、どうすれば良いんだろう？ このようなサイトが有っても、説明が下手だと厳しいし、だったら、 誰か、代行してくれないかなーとか、思ってしまいます。 よろしく、お願いします。
エクセルの関数についてお伺いいたします。 添付ファイルの左側の表を矢印のみぎがわの表のように集約したいです。例えばQ1には項目が８つあり（2行目）、その下（B3:I7)には数字の1または0が入っている表があるのですが、数字の1を2行目の番号に変え、さらにその番号をカンマでつなげて、右の同行に集約したいのです。（数字の0は集約しない） 関数でできるか調べて =CONCATENATE(セル番地,",",セル番地,",",セル番地) でできることはわかったのですが、これだと0が入ってしまうのと、0を空欄にしてみたのですがカンマが残ってしまいます。関数で実現することは可能でしょうか？

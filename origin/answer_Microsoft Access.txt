.CommandText = "INSERT INTO db_nukitori(MEASSURE_t) VALUES(TextBox1);" を .CommandText = "INSERT INTO db_nukitori(MEASSURE_t) VALUES(”＆TextBox1.Text & ");" としてみて下さい。
If DCount("管理番号", "MT_獲得","管理番号=" & Me!管理番号) > 0 でしょうか。
納品書（控）のシートを開いたまま実行します。 コピー先のシート名を「Sheet2」とし、A列にデータを追加します。 数式がどのようになっているかわかんないので、値複写します。 Sub Sample() Dim endRow1 As Long Dim endRow2 As Long endRow1 = Cells(Rows.Count, 1).End(xlUp).Row - 9 With Sheets("Sheet2") endRow2 = .Cells(Rows.Count, 1).End(xlUp).Row + 1 .Range("A" & endRow2).Resize(endRow1, 11).Value = Range("A10:k" & endRow1 + 9).Value End With End Sub
EXCEL VBAはEXCEL用でAccessVBAはAccess用のプログラムの機能ですので、当然異なる部分が多々有ります。EXCELは表計算ソフトで基本的には表の縦横方向の計算を得意とした物です。一方、Accessはリレーショナルデータベースと呼ばれる物でデータを複数のテーブルで持ち、EXCELでは対応の難しい複雑なニーズにも対応出来る物です。同じような事がEXCELでもACCESSでも出来る物も有りますが、内容によってはEXCELの方が簡単に出来る物や、逆にACCESSに方が簡単に出来る物があります。尚、本格的なシステムの場合はリレーショナルデータベースはSQLを使って操作し、SQLで出来ない部分はプログラミング言語を使って開発します。ACCESSもデータを操作する部分はバックでSQLが動きますが、SQLをなるべく表に出さないで動くようにしています、その分簡単なはずですが、最初からSQLで作った方が簡単な事が多いので、かえって初心者には理解しにくい部分も多いです。
>voodoo_runnerさん >フォームをWebで公開して入力してもらうにはどのようにすれば良いのでしょうか？ ActiveX等を使えばいいと思います。
たぶん2000の頃に許されていた記述が2013では厳しくチェックされるようになったため、エラー扱いされていると思います。 tbls運送累積ファイル.3便 のように . で区切るとプロパティの意味ですが、クエリで使うフィールドなら[tbls運送累積ファイル]![3便]のようにしなければなりません。 このような記述がそこら中にあるとしたら、全面的に修正しなければなりませんので、実質的には使用できないと思ったほうが良いです。
=DLookUp("商品名","商品","商品番号='" & [商品番号] & "'")
燃料の差と言うのは前日との差を求めたいと言う事でしょうか？ でしたら下記が参考になると思います。 Access2000を元にした解説ですが、クエリの基本は同じなので十分参考になると思います。 MS-Access2000超入門部屋--クエリで「ひとつ前のレコード」を参照する方法 http://www.mahoutsukaino.com/ac/ac2000/ac2000/maeno/maeno01.htm
レポートイメージそのままの出力ではなく、レコードソースに近い出力になります。
パソコンのスペック依存になりますが、 よっぽど古く無い限りAccessで十分です。 作る前に 想定されるレコードをダミーで入れてみて、性能測定してみれば？ また、 Accessをフロントで バックのデータベースを 他のデータベースサーバでも開発は可能ですよ。
おっしゃるような考え方は、ありますが、 数百件や数千件を検索のような、微細なデータでは、 問題になりません、。また、MSACCESSは、ユーザー向け個人向け データベースで、大きな、（30万件以上とか）には向きません。 便利と思うように設定したらいいですよ、 検索時計算しても、させておいたものを表示しても、 保持させておいたほうが早いと感じるのは、データ量が少ないからです。（でも、検索時計算させれば物理的には、時k名がかかりますよ） アクセスなら、いつ計算させるかですよね、単価/数量入力時当然 結果も表示させるでしょうから、そのとき保存させるのがいいかも。
求めたい結果: DCount("数量","クエリA","日付=#" & [日付] & "# AND [NO]=" & [NO] & "AND 数量=" & [数量]) 日付と数量は括弧なしでかまいませんが、 「No」は予約語ですから、フィールド名であることを表すために [ ] で括らなくてはいけません。 可能なら、「No」 のフィールド名を変更することをお勧めします。 あとあと苦労することになりますから。
多分基本的に無理です。マイクロソフトからウインドウズアップデートを介してウイルス様のプログラムが送られてくるのです。そのうちEDGEに関しての不具合が増えてきます。そうして突然ダウンします。WIN10を買えば現象は嘘のように無くなるでしょう。IEでも同じことです。WEBによってはIEのアップデートを要求されますが WIN10を買わない限りアップデートできません。
>microsoftのストアで購入した映画をタブレット端末で観ることは可能ですか？ 購入した端末で見るのならmicrosoftのストアに限らず可能です。
やってみる価値はありますが、使い物になるかどうかはわかりません。 access2010 SharePointリスト ADO接続 http://mukkumuku.blogspot.com/2011/04/access2010-sharepoint-ado.htm... AccessアプリからSharePointリストへ接続 http://nanbo.org/accesssplist/ Access：SharePointリストのリンク -1- http://nanbo.org/access-lts1/
顧客マスタTと受注マスタTを顧客IDで結合したのであれば、 顧客IDを入れない限り受注マスタを入れることはできませんから、 それがはじかれるということではないですか？ 顧客マスタTが事前にあって、受注マスタTを他のシステムデータから 一括でインポートするとしても、その中の顧客IDが顧客マスタに存在 しないものの場合、インポートできずにエラーになります。
おおざっぱには、西暦年だけから元号に出来ますが 厳密にするには日付にしないといけません。 例えば 1989年1月7日は、昭和64年 1989年1月8日は、平成元年
最初の質問への返信、確認しました。 セーフモードでもだめだとすると、難しいですね。 ダメもとで、管理者権限お持ちなら、仮のユーザアカウント作ってみて、そのアカウントからACCESS起動してみるとか。 それでもだめならコントロールパネルのから「プログラムと機能（Win7ではこれでした）」で、Officeの「変更」を選んで「修復」を試みるとか。 アンインストールして再インストールが最後の手段でしょうか。 一応、確認ですが以前は問題なく起動していたのですよね。
SQLでいいですか？ 例えば select テーブル名.管理番号, テーブル名.入金日, テーブル名.入金金額,sum(t2.入金金額) as 累計 from テーブル名, テーブル名 as t2 where t2.管理番号 <= テーブル名.管理番号 group by テーブル名.管理番号, テーブル名.入金日, テーブル名.入金金額 order by テーブル名.管理番号 とか select テーブル名.管理番号, テーブル名.入金日, テーブル名.入金金額, select sum(t2.入金金額) from テーブル名 as t2 where t2.管理番号 <= テーブル名.管理番号 ) as 累計 from テーブル名 order by テーブル名.管理番号 でとうでしょう？ DSUM関数使ってもできます。
そのAccess2007で作成されたシステムがAccessプロジェクト（ADPファイル）であるなら、2013以降ではそのままでは利用できません。 Access 2013 で廃止、変更された機能 - Access https://support.office.com/ja-jp/article/Access-2013-%E3%81%A7%E5%B... ADPからの移行方法は、下記のMSのサイトに簡単に紹介されてますが、実際にやろうとするとかなり難儀らしいです。（私自身はやったことがないのでブログ等の情報からですが） Access における変更点 https://msdn.microsoft.com/ja-jp/library/office/jj618413.aspx?f=255... ADPでなくMDBかACCDBならそのまま使えるか、あるいは小規模の手直しで使えると思います。 2013と2016のどちらにするかは、変更されたのはUIやテンプレートなどの補助的な部分で基本機能としてはほとんど変わりないので、最新版の2016の方が今後ながく使える可能性か高いと思います。
ＶＢＡでクエリを動的に生成して実行する方法をご存じでしょうか？ 下記で解説されています。 ＳＱＬ文のひな形はクエリで作り、ＶＢＡ上で条件となる部分を変数に置き換えます。 ＳＱＬはＡＮＤ条件は高速に処理出来ます、ＯＲ条件の場合処理速度が極端に遅くなる事が有ります。 そんな時は１条件毎に（ＡＮＤはまとめて実行でＯＫ）ＳＱＬ文を実行し、一時的なテーブルに書き出し。 ＯＲとなる条件で再度実行して書き出しを繰り返せば最終的に一時的なテーブルに結果は得られます。 クエリを作らずにＳＱＬ文を実行する http://www.moug.net/tech/acvba/0040010.html
UPDATE テーブル名 set 項目名 = Mid(項目名,1,4) & "/" & Mid(項目名,5,2) & "/" & Mid(項目名,7,2) の要領でどうでしょう？ あらかじめ、テーブル定義でその項目の長さを10以上に設定変更する必要がありますが。
やり方としては２通リあります。 一応、こんなイメージでいいですか Ｔ_工務店(工務店ID, 工務店名 ) 工務店IDが主キー T_技術者(技術者ID,工務店ID,技術者名) 技術者IDが主キー 一つはＴ_工務店とT_技術者を工務店IDで結合して上でT_工務店.工務店ID,T_工務店.工務店名でグルーピングして、T_技術者.技術者IDで「カウント」を指定します。 必要に応じて「技術者数」のような列名に変更します。 もう一つはDCOUNT関数です これもクエリを作りますが、基本T_工務店から工務店IDと工務店名を設定して、その後ろに DCount("[技術者ID]","T_技術者","[工務店ID] = " & [T_工務店].[工務店ID]) を追加します
商品ID、購入者ID のあるテーブル名を ★★ と仮定します クエリの SQLビューに以下を記述して、表示してみてどうなりますか TRANSFORM First(購入者ID) AS 値 SELECT 順 FROM ( SELECT Q1.商品ID, Q1.購入者ID, Count(Q2.購入者ID)+1 AS 順 FROM ★★ AS Q1 LEFT JOIN ★★ AS Q2 ON Q1.商品ID=Q2.商品ID AND Q1.購入者ID>Q2.購入者ID GROUP BY Q1.商品ID, Q1.購入者ID) AS Q3 GROUP BY 順 PIVOT 商品ID;
シェアＮｏ１に君臨して好き勝手な企業ですネ。 マイクロソフトアカウントで起動していれば、マイクロソフトが出しているソフトの異常に付いては有る程度無料相談が出来ます、オフィース３６５が有効ならさらにその上のレベルの相談も可能です。 https://support.microsoft.com/ja-jp で探し周ったらチャットの相談が出来ました。 Ｗｉｎ８と１０で採用されているカレンダーの文字化けで相談したのですが、結局改善はされなかったですけどネ。 余談 ３０年ほど前に日本独自のＯＳとしてトロンが開発されていました、所がアメリカからの横やりで中止に追い込まれたようです。 私が思うに自動車や家電の貿易摩擦の生贄にされたのではと思っています。 トロンは無料なら言いだろうと、家電向け等の無料ＯＳとして細々と生き残っているようです。
ていうか、2003と2013じゃUIが全然違うんじゃないかな。はやい話が、2003にはリボンはまだなかったと思うし、データベースウィンドウがまだあったりとか。 初心者が勉強するにはかえってワケわかんなくなるだけ。同じバージョンの本を買いましょう。お金の問題じゃないから、ホント。
前提条件を確認させてください。 テーブル1のテーブルデザインは不可ということでしょうか。 新規テーブルの追加は可能ですか？ テーブル1は読み取り専用ということですが、フォームにチェックボックスは詳細に配置してあるのでしょうか？ だとすると、チェックボックスをON/OFFしてしたいことは、チェックしたレコードを絞り込みたいといういうことでしょうか？ だとすると、新規テーブルが作れるなら（コード TEXT、CHECK YES/NO）というテーブルを追加してテーブル1からコードデータをコピーして、この新規テーブルとテーブル1と結合したクエリをもとにしたフォームを作ってみてはいかがでしょうか。
提示のコードの [フィールド名] というのはオプショングループのコントロールソースですか。 オプショングループに連結したフィールドには、数値しか入力できません。 オプショングループのValueも数値です。 もし、やりたいことがフォーム上のテキストボックスにオプショングループの選択に対応したテキストを表示させたいということなら、ＶＢＡは必要ないです。 テキストボックスのコントロールソースに下記の式を設定してください。 =Choose([フレーム名], "東京", "大阪", "名古屋, "静岡", "")
私の理解している限りではテーブルに部分的に色を変えるような機能は有りません。 テーブル内容をフォーム上のテキストボックスに表示できるようにして、条件付き書式を使うか、ＶＢＡで処理します。
そんなもん、データとプログラム見ないと判りません。ので、推測。 １、ハイフン入りとそうでないかの違い ２、数字型と文字型の違い ３、郵便番号以外のフィールドが影響している それくらいしか想像つかないですね。
リボンの「外部データ」タブで中央付近にある[PDFまたはXPS]で出力できます。
ありません。 amazonの中古本が一番安いようです。 https://www.amazon.co.jp/gp/offer-listing/4844334441/ref=sr_1_1_olp...
記載のやり方はテキストファイル用でありACCESSでは通用しません。 というのも、ACCESSはDBファイルを開くとファイルの更新日付がその時点の日時に書き変わるからです。 誤って開いてしまっただけで即更新対象です。 運用方法としては何通りかありますが、ここではDBのテーブルにバージョン情報を持つ方法を記します。 DBファイルとして３つ必要です。 (1) 通常運用用DB（ローカル配置） (2) 最新版DB（サーバ配置） (3) 更新用DB（１と同じ場所） DB(1)(2)にバージョン管理用のテーブルを設置します。 テーブル名を「tblVersion」とします。 フィールドはとりあえず１つで、名前を「Version」とします。 フィールド型はお好みでどうぞ。 DB(1)に下記のコードを配置し、DBスタート時に起動させます。 '--- ここから↓ Const ttl = "バージョンチェック" Dim strRefDB Dim strQRY Dim RS Dim FLAG ' strRefDB = "【配置したパス】" & "\(2)最新版DB.accdb" strQRY = "Select * FROM tblVersion IN '' [MS ACCESS;DATABASE=" & strRefDB & ";]" On Error Resume Next Err.Clear Set RS = CurrentDb.OpenRecordset(strQRY) If Err.Number Then MsgBox "バージョンアップ参照のDBに不具合あり" & String(2, 13) & Err.Number & vbCr & Err.Description, vbCritical, ttl Exit Sub 'Function End If On Error GoTo 0 FLAG = False If RS.RecordCount > 0 Then 'バージョンの比較 If DLookup("Version", "tblVersion") <> RS!Version Then FLAG = True End If RS.Close Set RS = Nothing If FLAG Then If MsgBox("新しいバージョンがあります" & String(2, 13) & "バージョンアップしますか？", vbInformation + vbYesNo, ttl) = vbYes Then '更新用DBを起動 Shell """" & SysCmd(acSysCmdAccessDir) & "msaccess.exe""" & " " & """" & CurrentProject.Path & "\(3)更新用DB.accdb""", vbNormalFocus 'そして、このDBはコピー対象となるので終了させる DoCmd.Quit End If End If '--- ここまで↑ あとは (3)更新用DB でファイルをコピーし、完了した旨を告知させます。 ＜省略＞（もしかしたら(3)で(1)が終了するまで待機させるコードが必要かも）
フロントエンドをサーバ上の共有フォルダーに置くという方法も考えられますが、破損の危険性が高いらしくお勧めできません。また、ユーザーが使用中は上書き更新できませんので、ユーザーが使用してないときにしか更新できません。 フロントエンドはローカルにおいて、サーバー上の共有フォルダーに最新ファイルをおいて、ローカルとサーバーのファイルのバージョンを比較して、更新されていたらコピーして上書きするという方法がいいかと思います。 下記でWSHスクリプトを紹介していますのでご参考に。 複数ユーザーで共有している場合のフロントエンドファイルのバージョンアップ http://hatenachips.blog34.fc2.com/blog-entry-422.html ただし、上記はフロントエンドのパスは固定なので、下記の方法でスクリプトのパスを取得してそれを利用するようにしてください。スクリプトとフロントエンドは同じフォルダに置きます。 WSHでスクリプトファイル自身が存在するフォルダパスを取得する - Qiita http://qiita.com/asterisk9101/items/54cdcedb9ef60ea0bb21WSH スクリプトの方法を紹介しましたが、Access自身で起動用のプログラムを作成してもいいでしょう。
Access Runtimeはすでに作成済みのファイルを実行するためだけのものなのでスタートメニューには登録されません。ファイルの新規作成はできないということ。ファイルをコピーすればAccessのアイコンになります。バージョン違いは厳しいと思いますよ、やったことないけど。それと、Runtimeで運用する場合、Accessの組み込みメニューは一切使えない(VBAからも含めて)、セキュリティの警告を出さないようにするためにはレジストリをいじる必要がある、オブジェクトをデザインビューで開くことはできない(VBAによっても同様)、実行時エラーは即終了するためきめ細かなエラー処理が不可欠、などなどいくつかの固有の制約もあります。よく調べて検討することをおすすめします。 ちなみに、2010のRuntimeを入れて、それで開くようにしたらどうでしょう。 方法‥‥ "2010のRuntimeの実行ファイルのフルパス"＋半角スペース＋"Accessファイルのフルパス" という文字列を用意して、新規作成したショートカットのプロパティを開いて｢リンク先｣にコピペする。で、このショートカットをたたいて起動すればよい。 2013と2010が同居できるかどうか不明ですが、もしできるのなら、というお話。
フォームのプロパティに「レコードセット」というのがあるので、そこの設定次第でしょうか。 反映するのは「テーブルのレコード」で、「ダイナセットに反映」とはあまり聞かれない言い回しです。
店舗マスタ と 商品マスタ から、店舗コード、商品コードの組合せを求めます SELECT 店舗コード, 商品コード FROM 店舗マスタ, 商品マスタ; これを、仮に ★★ とします この ★★ と 出荷明細を 店舗コード、商品コード で結び付けます この時 ★★ 側は全部とすると、出荷明細 に無いところは Null 扱いに･･･ Nz を使って、出荷明細 の出荷数 を･･･ SELECT Q1.店舗コード, Q1.商品コード, Nz(Q2.出荷数,0) AS 出荷数 FROM ★★ AS Q1 LEFT JOIN 出荷明細 AS Q2 ON Q1.店舗コード=Q2.店舗コード AND Q1.商品コード=Q2.商品コード ORDER BY Q1.店舗コード, Q1.商品コード; この ★★ を展開してみると SELECT Q1.店舗コード, Q1.商品コード, Nz(Q2.出荷数,0) AS 出荷数 FROM (SELECT 店舗コード, 商品コード FROM 店舗マスタ, 商品マスタ) AS Q1 LEFT JOIN 出荷明細 AS Q2 ON Q1.店舗コード=Q2.店舗コード AND Q1.商品コード=Q2.商品コード ORDER BY Q1.店舗コード, Q1.商品コード;
subtotal関数はエクセルの関数ですので、Accessのテーブルやフォーム等では使えません。 サブフォームのフォームフッターにテキストボックスを配置して、下記のように設定します。 コントロールソース =Sum([フィールド名]) 名前 フィールド名合計 メインフォームにテキストボックスを配置して、下記のように設定。 コントロールソース =[サブフォームコントロール名].Form![フィールド名合計] これで、メインフォームのテキストボックスにサブフォームの合計が表示されます。 サブフォームのフォームフッターはデータシートビューだと表示されませんが、参照はできます。
下記のようなテーブル設計にします。 商品マスター ・商品コード 主キー ・商品名 ・・・・（その他商品に関するデータのフィールド 取引先等） 店マスター ・店コード 主キー ・店名 ・・・・（その他店に関するデータのフィールド 担当者、連絡先等） あと、100 とか 150 という数値が何なのか不明ですが、 商品と店の組み合わせで決まる数値だと思いますが、 数量マスター ・商品コード 主キー※ ・店コード 主キー※ ・数量 数値型または通貨型 ※複数フィールド主キー ただし、「数量」の部分は内容が分かる名前に変更したほうがいいでしょう。 例えば「定価」とか「梱包単位」とか・・・・ 明細テーブル ・日付 ・商品コード ・店コード ・備考 リレーションシップは、下記のフィールド間で結びます。 明細テーブル.商品コード と 数量マスター.商品コード 明細テーブル.店コード と 数量マスター.店コード これでクエリを作成して、数量マスターから「数量」を表示させれば 該当の数量が表示されます。
>> １，２について Accessのフォームにはステータスバーは無いんじゃないかな？ Accessにはステータスバーは有るけど。 http://www.feedsoft.net/access/tips/tips78.html >> ３について TableDefコントロール使うしかないんじゃないですかね。AttributesプロパティかPropertiesプロパティかなぁ。 https://msdn.microsoft.com/ja-jp/library/office/ff195790.aspx
以下の様な方法ではどうでしょう テーブル作成クエリでの作成先に csv ファイルを指定する ファイルが存在するとエラーになるので、 事前に、存在したら (1)、(2) を付加しながら、 無いファイル名が見つかるまで････ Option Compare Database Option Explicit Public Sub Samp1()    Dim vCs As Variant, v As Variant    Dim sP As String, sF As String, sS As String    Dim sSql As String    Dim i As Long    Const CSQL As String = "" _       & "SELECT * INTO [{%1}] IN " _       & "'{%2}'[Text;FMT=Delimited;HDR=YES;IMEX=0] " _       & "FROM [{%3}];"    Const CEXT As String = ".csv"    vCs = Array( _             Array("tbl_A", "file_A"), _             Array("tbl_B", "file_B") _       )    sP = CurrentProject.Path    For Each v In vCs       sF = v(1): sS = "": i = 1       While (Dir(sP & "\" & sF & sS & CEXT) <> "")          sS = " (" & i & ")"          i = i + 1       Wend       sF = sF & sS & CEXT       sSql = CSQL       sSql = Replace(sSql, "{%1}", sF)       sSql = Replace(sSql, "{%2}", sP)       sSql = Replace(sSql, "{%3}", v(0))       CurrentDb.Execute sSql    Next End Sub
クエリに以下のフィールドを作成してください。 件数1:件数-Nz((SELECT TOP 1 件数 FROM テーブル1 AS T1 WHERE T1.作業内容=テーブル1.作業内容 AND T1.担当者=テーブル1.担当者 AND T1.日付=テーブル1.日付 AND T1.時間<テーブル1.時間 ORDER BY T1.時間 DESC),0)
Microsoft【ACCESS】のグラフのお話ならば、 グラフ編集モードでデータラベル部分をダブルクリックすると 「データラベルの書式設定」のダイアログが表示されるので それの「表示形式」タブを選択すれば「パーセンテージ」に 「小数点以下の桁数」の指示ができるようになります。
自分は、とにかく作ってみて覚えるでした。 ただ、最初から「生産管理のシステム作るで！」っていってもどこから手を付ければいいかわからなかったので、小さいところからだんだんとステップアップしていった感じです。 画面の見た目作るで ↓ 画面に入力した値を保存できるようにするで ↓ 保存したデータを表示させてみるで ↓ ２つのテーブルを使ってみるで ↓ レポートも作ってみるけ？ ↓ せっかくだか、メニュー画面つくってみるべ みたいに。 で、その都度、必要な情報をネットで調べたり、本を見たりして覚えていきました。 調べるにしても大きな範囲では、情報があつまらないので、出来るだけ小さな範囲で（フォームを作る、テキストボックスの値を編集する、テーブルの内容を表示する等々）調べるようにして、それを一つずつこなしていって、最終的には大きな一つを作るような感じにです。
テスト用に作ったテーブルのフィールド定義で主キー設定がされていて、CSVのデータにはそこで重複したものがあるのではないでしょうか。 Accessのバージョンが分かりませんが、いったん外部データのインポートウイザードの流れに従って操作し、「オートナンバー型」の列を先頭にした３列の新規テーブルに格納してみてください。 ウイザードの操作の中で、CSVデータから取り込む列を選択する事も出来ます。 取り込んだ新規テーブルについて「重複クエリ」を使えば、重複しているデータが確認出来るはずです。
>（1） 数量が入力済みのレコードにあたるまでループ >（2）-1. 0件だった場合はフォームをそのまま閉じる >（2）-2. 1件以上見つかった場合、その時点でループを抜ける 数量が入力済み(Nullでない)レコードの件数は下記の方法で取得できます。 サブフォームのフォームヘッダーかフッターにテキストボックスを配置してコントロールソースを下記のように設定する。 =Count([数量]) ※CountはNullを数えない。 このテキストボックスを参照すれば、ループさせる必用はありません。 If Forms![フォーム名]![サブフォーム名].Form![入力済み件数] > 0 Then lRes = MsgBox("数量を保存せずにフォームを閉じてよろしいですか？", vbYesNo) 以下略 >（4）-1. Yes：保存せずに閉じる（数量フィールドをNull） データシート形式のサブフォームの場合、レコード移動した時点、あるいはメインフォームへフォーカス移動した時点でレコード保存されます。 つまりメインフォームのイベントで保存をキャンセルすることは不可能です。「保存せず」というのが「数量フィールドをNull」に更新するということなら、更新クエリを走らせるか、サブフォームのレコードセットをループして更新することになります。 ただ、「更新ボタンを押すことで、然るべき処理が実行され一覧から消える」というのが不明なので、明確な回答は難しいです。 例えば、サブフォームのソースがワークテーブルで、更新ボタンで、本テーブルに反映させるという処理なら、反映させる処理を実行しなければいいだけです。
これは簡単ですよ。良いウェブを選んで良いトレーニングを受けたら、一回で合格することがぜひできます！進めたいウェブがありますが、名前はPass4Test.jpで、Microsoftの98-369試験のテストと解答がありますから、お助けになることができると思いますよ。http://www.pass4test.jp/98-369.html ご利用ください。
まずは調べることから始めましょう。 色々同じような質問されている方がいますよ。 http://oshiete.goo.ne.jp/qa/505348.html http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1213137114...
なんでMicrosoftAccessが該当カテゴリになってるんだろう？ 貴方のメールは届けられませんでした。 smmx.nifty.comに送られた奴です。 そんな人いません。 【以下メールの形式】 ＜紳士淑女の皆様、このメールはスパムじゃござんせん、スパムに分類しないでね＞
バージョンは違うかもしれませんが、参考にどうぞ。 https://www.filemaker.com/help/14/fmp/ja/html/odbc_ess.21.6.html
・エラーの内容は正確に書かないと対策はもらえません。 「INSERT INTO ステートメントに認識できないフィールド <フィールド名> があります。正しい名前を入力したかを確認して、もう一度操作してください。(Error 3127)」 このエラーメッセージから「間違った名前をSQL文の中に書いてる」ことがわかりますが、心当たりはありませんか？ ・ググったほうが早い時もあります。 「エラー 3127」でググると同じエラーで解決した例が表示されます。 ■INSERT INTO ステートメントに認識できないフィールド http://okwave.jp/qa/q3473769.html
このコードをどのイベントに記述したのか提示してください。 あるいは、Private Sub の行をコピーして貼り付け下さい。 それと、どのようにうまく動かないのか、詳細に説明してください。 エラーがでるなら、エラーメッセージを提示して、デバッグボタンを押した時に反転表示される行をコピーして貼り付けてください。 とりあえず、 思いついたエラーは、入力コントロール（ラベルやコマンドボタン等）のタグに "必須" と設定している場合ですね。
フォームは連結フォームになってますか。（レコードソースにテーブルかクエリが設定してある。） 連結フォームだと、OpenRecordset、AddNew などせずに、 Docmd.RunCommand acCmdSaveRecord を実行するだけでテーブルに保存されます。 あるいは、レコード移動する、フォームを閉じるなどでも保存されます。 にも、かかわらずOpenRecordset、AddNew で別に新規追加しているので、２レコード追加されてしまうのでしょう。 一方が空白になるのは、 Call ClearControls でおそらく空白かNullを代入しているのだと思いますが、そのため空白のレコードになるのでしょう。 OpenRecordset、AddNew が必用なのは、非連結フォームの場合ですが、意味も分からずにどこからか拾ってきてものを使っているのですね。 非連結フォームは、それなりのスキルが必用ですので、まずは連結フォームでの設計を理解してから必要なら取り入れたらいいでしょう。 連結で新規登録フォームを設定する場合は、下記のようにします。 フォームの「データ入力用」プロパティを「はい」にする。 「保存」ボタンには、下記のコードを記述する。 Private Sub 保存_Click() Docmd.RunCommand acCmdSaveRecord 'レコード保存 Docmd.GoToRecord , , acNewRec '新規レコードヘ移動 End Sub これだけです。
ワークシートの名前が、全件になっていないと、 Set ws = ThisWorkbook.Worksheets("全件") ここで出ますよ。
Like "*" & [forms]![form名]![テキスト名] & "*" Or [forms]![form名]![テキスト名] Is Null ではどうでしょうか。
JOIN句はフィールドの対応を書く必要があるため、 固定値を書いている時点でアウトだと思います。 FROM テーブルB LEFT JOIN テーブルA ON テーブルB.FieldName = テーブルA.FieldName; でテーブルA側が'00'だけを抽出の意味で書いているとしたら、 FROM テーブルB LEFT JOIN テーブルA ON テーブルB.FieldName = テーブルA.FieldName WHERE テーブルA.FieldName ='10' かと思います。（こんな抽出はしないと思いますが） SQL講座 http://www.pursue.ne.jp/jouhousyo/SQLDoc/select22.html
CGIのプログラムはWebブラウザからの変数を標準入力か環境変数で受け取って標準出力にHTML（ただし、先頭にContent-Type: text/html;が必要）を書き込む事でWebブラウザに表示出来ます。
> like [Forms]![フォーム1]![タブ1]![ページ1]![テキストボックス1] ではなにか抜けているのでしょうか？ 抜けていません。多すぎます。 like [Forms]![フォーム1]![テキストボックス1]
現段階で分からない点が複数あっても、ひとつずつ問題点をクリアしていってください。 １スレに多数質問だと「業者に頼みなさい」という回答が返って来るだけです。 とりあえず、質問回答より先にDBの仕様について逆に質問です。 (１) 1つの大会で複数競技にエントリーしている人がいたらどうしますか？ (２) 年度は現状ではIDが１から新しい年度になっていますが、次回(未来)開催する大会に不都合は出ませんか？ (３) VBAで記述されたSQL文を拝見すると「名簿テーブル」にセットされる大会に関するデータが『名称』になっていますが、あとから名称が変わってしまった(間違っていた・入力ミス)場合はどうしますか？ まずは↓こんなテーブル形態(各ID同士でリレーション)にして再考されたらいかがですか。 「名簿テーブル」 名簿ID : pk 氏名 性別 「参加テーブル」 名簿ID 大会ID 種目ID 賞ID 「大会テーブル」 大会ID : pk 年度 (検索用) 開催日 (開催順ソート用) 大会名 「種目テーブル」 種目ID : pk 種目名 「賞テーブル」 賞ID : pk 賞名
これかな。 提供されたファイルと起動するACCESSのバージョンの問題なので、提供者に確認するしかないです。 ■エラー メッセージ "データベースに含まれている VBA プロジェクトを読み取れないため、データベースを開くことができません" が、Access 2010 でコンパイル済みの Microsoft Access MDE、ACCDE、または ADE ファイルを開くと表示される https://support.microsoft.com/ja-jp/kb/2533794
「その他」タブの「複数選択」を 「標準」または「拡張」にしてください。
質問① コードの一部分だけを抜き出しても他に部分に原因がある場合もありますので、できれば全体を提示するようにしましょう。 とりあえず提示されている部分だけで、回答しますと。 最初の If の部分は、「大会」フィールドに対してBETWEEN条件、 次の Else If 以降は「賞」フィールドに対して条件を設定していますが、 矛盾してませんか。 まずは、どのフィールドに対して、どのような条件を設定したいのかを明確に説明してください。 あと、「大会」「賞」の各フィールドのデータ型も明示してください。 質問② Null と "" は別物ですので違いをしっかり意識しましょう。 質問①では IsNull で判断していますので、"" を代入したのではIsNullでは判定できません。Nullを代入しましょう。 txtID.Value = Null ～～～～～～～～～～～～～（”～”は省略部分） Me.コンボ1.Value = Null Me.コンボ2.Value = Null
こんなトラブルが出るくらいですから、 できることならフォーム名を変えたほうがいいですね。 Forms![F-フォーム名].Requery
Forms!売上伝票!名前 = Me!名前 にブレークポイントを設定して Me!名前 の変数内容をチェックしてみて下さい。 多分見れないと思います。 Me.名前 なら見れると思います。
> ひとつのクエリーでは不具合が生じるので、 どのようなテーブル構成になっているのか不明ですが、 通常は 売上テーブル と 商品マスターテーブル をリンクさせたひとつのクエリで 問題ないはずです。 テーブル設計例 売上テーブル 売上ID 売上日 顧客コード 商品コード 個数 価格テーブル 商品コード 商品名 メーカー 価格 クエリで２つのテーブルを商品コードで結合する 現状のテーブル構成、クエリの設計がどうなっているか提示してもらえますか。 説明が難してければ、SQL文を貼り付けてもらってもOKです。
回答になっていませんけど、、、、 手作業で改行コードを入れることは考えていないのですよね。 手作業なら改行すれば済むことですので、、、 自動で改行コードを入れるには何らかの法則が必要になりますよね。 その法則を教えてください。 なお、正規表現が使えるエディタですと文字列を置換するときに置換後の文字に改行コードを入れて、置換後には改行できるかと思います。 お使いのエディタの置換画面に『正規表現』とかの選択肢があるなら、チェックが付けて、置換後の文字の後ろに『\n』(半角)を付けてください。 メモ帳・ワードパッドはできません。 ワードですと、置換画面であいまい検索のチェックを外して、『\n』ではなく『^p』にしてください。
日付/時刻型のフィールドの抽出なら、私が良くやるのは、 その[日付]とは別に[抽出開始日]と[抽出終了日]を用意し、 [日付]を入れたときに更新後イベントで Me![抽出開始日] = CDate(Format(Me![日付],"@@@@/@@\/\0\1")) Me![抽出終了日] = DateAdd("m",1,Me![抽出開始日]) - 1 として Between [Forms]![Ｆ商品]![抽出開始日] And Between [Forms]![Ｆ商品]![抽出終了日] としています。 [抽出開始日]と[抽出終了日]は「可視=いいえ」にするとすっきりします。
VBAは不要。クエリに以下のフィールドを作成。 文字列として処理するパターン Mid(10000+[フィールド1],2,1) Mid(10000+[フィールド1],3,1) Mid(10000+[フィールド1],4,1) Right([フィールド1],1) 数学的に処理するパターン [フィールド1] \ 1000 ([フィールド1] mod 1000)\100 ([フィールド1] mod 100)\10 [フィールド1] mod 10
このSQLをどこに設定するのか次第です。 クエリの抽出条件に記述するなら、 Between [Forms]![フォーム名]![コンボ1] And [Forms]![フォーム名]![コンボ2] というようにどのフォームにあるのか分かるように記述します。 この場合、データ型意識する必要はないです。クエリの方で適切に変換してくれます。 ただ、クエリの「クエリパラメータ」プロパティでデータ型を明確に指定しておいた方かベターですが（下記リンク先参照）。 ■T'sWare Access Tips #542 ～パラメータクエリのパラメータのデータ型を限定するには？～ http://tsware.jp/tips/tips_542.htm VBAでFilterプロパティ等に設定する条件式を生成する場合は、 対象フィールドのデータ型によって記述が変わってきます。 さらにVBAコード中でSQL条件式は文字列として扱うことになるということの理解も必要です。 (VBAのコードと SQL文は別物なので） 自分自身のフォームのFilterプロパティに設定する場合のコード例 対象フィールドが数値型の場合 Me.Filter = "フィールド名 Between " & Me.コンボ1 & " And " & Me.コンボ2 対象フィールドがテキスト型の場合 Me.Filter = "フィールド名 Between '" & Me.コンボ1 & "' And '" & Me.コンボ2 & "'" 対象フィールドが日付/時刻型の場合 Me.Filter = "フィールド名 Between #" & Me.コンボ1 & "# And #" & Me.コンボ2 & "#" ちなみに型変換関数はVBA内でデータ型を変換する場合に使いますが、VBAコード中のSQL条件式の場合は不必要な場合がほとんどです。
添付が見えませんが、データを〇〇ごとにまとめたい、といった場合はピボットテーブルが1番楽で早いですよ。 まずは試してください。 Excel2010：ピボットテーブルの使い方 http://www.office-qa.com/Excel/ex124.htm
直接の回答ではなく、原因を調べる方法を。 どのイベントがどういう順番で発生するか。 コードの中の各変数がその時どんな値を保持しているか。 シングルステップで追っていく方法で確認できます。意図した通りにコードが実行されているか確認してみましょう。 不具合の原因を突き止め、それを取り除くノウハウの蓄積はコードの品質向上に大きく寄与するものです。 ほかの回答にもありますが、プログラム実行中にDefaultValueを設定することに何の意味もありません。TextBoxに値を設定するなら、Valueプロパティに設定します。やったことないから分からないけど、それが原因だったりするかもよ。
>makooshiroさん2016/7/2115:00:01 >これをAccessで表現するにはどうしたらよいでしょうか。 どうするかは設計次第になります。
AccessのSQLに詳しい訳でもなく、専門家でもありませんので心苦しいのですが。 直接 SQL を書くより、 クエリを作って それを実行、 あるいは クエリの SQL を VBA にコピーして DAO 等で実行する、 などが簡単かと思います。 ※アップデート UPDATE T_bukatsu LEFT JOIN T_bukatsu_sub ON (T_bukatsu.User = T_bukatsu_sub.User) AND (T_bukatsu.Bukatsu = T_bukatsu_sub.Bukatsu) SET T_bukatsu.is_end = 1 WHERE (T_bukatsu_sub.Bukatsu Is Null) AND (T_bukatsu.is_end=0) ※インサート 【方法1】クエリを２つ作る ●１つめ Q_current ： 現在生きている部活 SELECT T_bukatsu.ID,T_bukatsu.User,T_bukatsu.Year,T_bukatsu.Bukatsu FROM T_bukatsu WHERE T_bukatsu.is_end=0 ●２つめ 名前はお好きに： 現在生きている部活に無いものを Insert INSERT INTO T_bukatsu ( [User], [Year], Bukatsu ) SELECT T_bukatsu_sub.User, T_bukatsu_sub.Year, T_bukatsu_sub.Bukatsu FROM T_bukatsu_sub LEFT JOIN Q_current ON (T_bukatsu_sub.Bukatsu = Q_current.Bukatsu) AND (T_bukatsu_sub.User = Q_current.User) WHERE Q_current.Bukatsu Is Null 【方法2】クエリ１個、上記の Q_current をサブクエリに。 INSERT INTO T_bukatsu ( [User], [Year], Bukatsu ) SELECT T_bukatsu_sub.User, T_bukatsu_sub.Year, T_bukatsu_sub.Bukatsu FROM T_bukatsu_sub LEFT JOIN ( SELECT T_bukatsu.ID,T_bukatsu.User,T_bukatsu.Year,T_bukatsu.Bukatsu FROM T_bukatsu WHERE T_bukatsu.is_end=0 ) AS QC ON (T_bukatsu_sub.Bukatsu = QC.Bukatsu) AND (T_bukatsu_sub.User = QC.User) WHERE QC.Bukatsu Is Null 殆んどクエリが生成した SQL のままです。 前提条件 (1) T_bukatsu の 「id」は オートナンバー であること。 (2) T_bukatsu_sub の 「User, Bukatsu」の組み合わせで重複しないインデックスが設定されていること。 (3) T_bukatsu に、追加・修正のルールに反したデータが無いこと。 (2) がないと「更新不可」のクエリになり、フラグの書き換えができません。 その場合は もう１工夫が必要。 直接本題と関係ありませんが [User], [Year] は 予約語？ ですので フィールド名として使用しない方が、後々の苦労が避けられると思います。 SQL で直に編集したところが一部あります。 修正ミスがあったらごめんなさい。
> 最終的には店舗ごとのTシャツとトレーナーの合算値を求めたいです。 現状のテーブルのままで、単純にこれを実現するなら、集計クエリのデザインビューで下記のように設定すればいいでしょう。 フィールド ／ 集計 ／ 抽出条件 ------------------------------------------------- 店舗 ／ グループ化 種別: "Tシャツ＆トレーナー" ／ グループ化 個数計: 個数 ／ 合計 品名 ／ Where条件式 ／ In ("Tシャツ","トレーナー") SQLなら、 SELECT 店舗, "Tシャツ＆トレーナー" As 種別, SUM(個数) AS 個数計 FROM 売上テーブル WHERE 品名 In ("Tシャツ","トレーナー") GROUP BY 店舗, 種別; しかし、 このような場合、データベースの設計では別に商品マスターテーブルを作成します。（これを「正規化」といいます。 例えば下記のようなテーブルになります。 商品マスター 商品コード 品名 種別 ----------------------- 1 Tシャツ Tシャツ＆トレーナー 2 トレーナー Tシャツ＆トレーナー 3 コート ・・・ ・・・ 売上テーブル 店舗 商品コード 個数 ---------------------- A店 1 500 A店 3 30 B店 3 30 B店 2 1000 A店 1 500 B店 1 2000 A店 2 1000 こうすれば、希望の種別での集計が簡単にできます。 本来は、店舗、種別もマスターテーブル化すべきですが。 一度「正規化」も含めてデータベース設計の勉強をさせてテーブル設計を見直すことをお勧めます。
マクロでは無理な気がします。 ＶＢＡでの方法です。 クリック時イベントを イベントプロシージャ に変更し … を押すと ＶＢＥ（ビジュアルベーシックエディタ）画面が開きます。 Private Sub コマンド1_Click() End Sub みたいになっているはずです。 コマンド1 は貴方がボタンに付けた名前のままでＯＫです。 上記を下記になるように追加して下さい、 マクロ1 マクロ2 は貴方が起動したいマクロ名に変更して下さい。 Private Sub コマンド1_Click() If GetKeyState(vbKeyShift) < 0 Then DoCmd.RunMacro ("マクロ1") 'Shiftを押しながらクリックのとき Else DoCmd.RunMacro ("マクロ2") End If End Sub ＶＢＥ画面の左側に Form_フォーム名 と書かれた所が有ります。 その下の空欄で 右クリック 挿入 標準モジュール と押すと、その空欄部分に Module1 が出来ます。 それをダブルクリックすると Option Compare Database と書かれたフォームが表示されます。 その下の部分に数行程度間を開けて Declare Function GetKeyState Lib "user32" (ByVal nVirtKey As Long) As Integer を追加して下さい。 これで完了です、Module1 を保存して VBE を閉じて下さい。
ワイルドカードを使用すればいいのでは。 c:\hoge\*.*とすると、c:\hoge配下にあるすべてのファイルを対象とすることができます。 ただ、カメラの種類が複数あるということなので、1回1回実行する都度変更するのではなく、カメラの種類分batファイルを作成しておけばいいのではないのでしょうか？ やりたいことを簡潔にbatファイルにしておくほうが、カメラが増えたり、変更したりした際にメンテナンスもしやすくなると思います。
ソースの公開までは契約されていなければ、それは出来ないでしょうね。 ソース非表示という事はMDEやACCDEでもらってるんですかね。それは、コンパイル済み形式だから、そう簡単に内容は読めませんよ。
データベースのカテゴリに「ACCESS」があること自体が使っている人が多いという証拠ですね。 データベースと開発環境が一体化していて便利なところも使われている理由の一つです。
プロファイルを追加しようとして、エラーが出るのがどの段階か分かりません。 名前、パスワード・・・。ユーザーアカウント名あたりかな。 プロバイダのメールサービスと契約していないのなら、Yahooメールを設定されては？ Yahoo!メールヘルプ - メールソフトで送受信するには（Yahoo!メールアドレスの場合） http://www.yahoo-help.jp/app/answers/detail/p/622/a_id/80574/faq/pc... 今までのメールは、違うファイルにありますし壊れている可能性もあります。 直ぐに見ることはできませんので、インポートを試してください。
以下のような感じです。 「abc.csv」を「abc#csv」と書くこと、パスに「\」を書かないことに 注意してください。 SELECT フィールド名 FROM [abc#csv] IN 'c:' 'Text;HDR=YES;'; 以下でもOKです。 SELECT フィールド名 FROM [Text;DATABASE=c:;HDR=YES;].[abc.csv];
「Me!顧客コード」といった記述で連結テーブルのフィールドを 指定できますので、保存したいときは Me!顧客コード = Me!txt_顧客コード を事前に実行してはどうですか。
回答し直してます SQL を作り込む部分を詳しめにしてみました 年代の扱いは、現時点( Date() )から何年前～何年までと･･･ 条件が必ずある場合の例で････ （部分的に条件がない･･･性別指定なし･･･とかなら、変更要） この部分をそのまま Samp1 の ★ 部分で処理すれば Samp1 でも動くかと･･･ なお、新テーブルに作り込む部分は、顧客コード だけにしました 顧客テーブル名：★★ 条件テーブル名：▼▼ 新テーブル名：◆◆ ※ 新テーブルは、顧客コード フィールドだけで･･･ としています 出来上がった 新テーブルの内容と顧客テーブルを結び付ければ･･･ SELECT Q1.* FROM ★★ AS Q1 INNER JOIN ◆◆ AS Q2 ON Q1.顧客コード=Q2.顧客コード; とか SELECT Q1.* FROM ★★ AS Q1 WHERE EXISTS (SELECT 1 FROM ◆◆ WHERE 顧客コード=Q1.顧客コード); とか SELECT * FROM ★★ WHERE 顧客コード IN (SELECT 顧客コード FROM ◆◆); とか･･･で一覧ができると思います 乱数で求める部分･･･色々方法はあるので違う方法にしてみました ※ 扱うものを 顧客コード １つにしたので方法の幅が広がり････ また、初期回答で記述していた以下 > 条件の処理を進めていくうちに、顧客コードが重複する様なら、 > どの段階で重複を排除しながら条件の件数処理するか･･･ これに対応してみました 乱数で求まった 顧客コード を Dictionary に蓄えていきます 乱数抽出した 顧客コード が既に･･･現条件分の件数分求め直す 以下雰囲気で･･･ Public Sub Samp2()    Dim dic As Object    Dim cn As ADODB.Connection    Dim rs As New ADODB.Recordset    Dim rsS As New ADODB.Recordset    Dim sSql As String    Dim v As Variant    Dim i As Long, j As Long, k As Long, n As Long    Const CSEP As String = ","    Const CSQL As String = "SELECT 顧客コード FROM ★★ " _       & "WHERE (住所 Like '%{%1}%') AND (性別='{%2}') AND " _       & "(生年月日 > #{%3}#) AND (生年月日 <= #{%4}#);"    Set dic = CreateObject("Scripting.Dictionary")    Set cn = CurrentProject.Connection    Randomize    rs.Open "▼▼", cn, adOpenForwardOnly, adLockReadOnly    While (Not rs.EOF)       sSql = CSQL       sSql = Replace(sSql, "{%1}", rs("住所"))       sSql = Replace(sSql, "{%2}", rs("性別"))       sSql = Replace(sSql, "{%3}" _                , DateAdd("yyyy", -(rs("年代") + 10), Date))       sSql = Replace(sSql, "{%4}" _                , DateAdd("yyyy", -rs("年代"), Date))       rsS.Open sSql, cn, adOpenForwardOnly, adLockReadOnly       If (Not rsS.EOF) Then          v = Split(rsS.GetString(adClipString, , "", CSEP), CSEP)       Else          v = Array()       End If       rsS.Close       n = rs("件数")       k = UBound(v) - 1       j = dic.Count       While (((dic.Count - j) < n) And (k >= 0))          i = Int((k + 1) * Rnd())          dic(v(i)) = Empty          v(i) = v(k)          k = k - 1       Wend       rs.MoveNext    Wend    rs.Close    If (dic.Count > 0) Then       cn.Execute "DELETE * FROM ◆◆;"       rs.Open "◆◆", cn, adOpenForwardOnly, adLockOptimistic       For Each v In dic.Keys          rs.AddNew          rs("顧客コード") = v          rs.Update       Next       rs.Close    End If    Set cn = Nothing    Set dic = Nothing End Sub 以下初期回答 2016/7/20 09:59:03 雰囲気以下でどうなりますか まず、新テーブルを作ってクリアしておきます 新テーブルは、顧客テーブルと同じフィールド名・順になっているとします ・新テーブルを開いておきます ・条件テーブルを開いて、順に処理していきます ・顧客テーブルから抽出する条件を ★ 部分で作り込み、データを入手 抽出件数が条件の件数以下なら、全件 でなければ 1 ～ 抽出件数の範囲で条件の件数分ランダムで ・上記で選んだ数値をレコード位置とし、その位置のものを追加 以下未検証･･･おかしかったらごめんなさい ※ ★ 部分の作り方等が悪く･･･？ 条件の処理を進めていくうちに、顧客コードが重複する様なら、 どの段階で重複を排除しながら条件の件数処理するか･･･ 悩むところと思いますが･･･ Dictionary をもう１つ使うとか 新テーブル側の顧客コードを重複無しにして、Update の失敗件数を利用するとか Public Sub Samp1()    Dim dic As Object    Dim cn As ADODB.Connection    Dim rs As New ADODB.Recordset    Dim rsFrom As New ADODB.Recordset    Dim rsTo As New ADODB.Recordset    Dim sSql As String    Dim v As Variant    Dim i As Long, j As Long    Set dic = CreateObject("Scripting.Dictionary")    Set cn = CurrentProject.Connection    Randomize    rsTo.Open "新テーブル", cn, adOpenForwardOnly, adLockOptimistic    rs.Open "条件テーブル", cn, adOpenForwardOnly, adLockReadOnly    While (Not rs.EOF)       j = rs("件数")       sSql = "SELECT * FROM 顧客テーブル WHERE 住所・・・・" ' ★       rsFrom.Open sSql, cn, adOpenStatic, adLockReadOnly       If (Not rsFrom.EOF) Then          dic.RemoveAll          If (rsFrom.RecordCount <= j) Then             For i = 1 To rsFrom.RecordCount                dic(i) = Empty             Next          Else             While (dic.Count < j)                i = Int(rsFrom.RecordCount * Rnd()) + 1                dic(i) = Empty             Wend          End If          For Each v In dic.Keys             rsFrom.AbsolutePosition = v             rsTo.AddNew             For i = 0 To rsFrom.Fields.Count - 1                rsTo(i) = rsFrom(i)             Next             rsTo.Update          Next       End If       rsFrom.Close       rs.MoveNext    Wend    rs.Close    rsTo.Close    Set cn = Nothing    Set dic = Nothing End Sub 返信 2016/07/20 13:54:59 そうそう 良く考えたら、 新テーブル側は 顧客コード だけで良いですね 処理も速くなるし、データ容量も少なくて済むし･･･ 実体は、顧客テーブルと新テーブルを結び付ければ、いつでも入手できますね ※ 住所の中身はどんな感じ？ 部分一致で抽出したりするのでしょうか？
可能です。 フォームを閉じるときのイベントで音楽を鳴らすなり、新しくフォームを開くときのイベントで音楽を鳴らすなりできます。
こちらで回答したんですけどね。 http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1416050570... ちょっと言葉が足りなかったかな。 デザインビューで イメージコントロールの「コントロールソース」に = "\\123.456.78.90\MainMenu\QA検査結果記録システム\QA検査画像" & "\" & [Forms]![詳細検索フォーム]![詳細画像ID2] & ".JPG" と記述しておくだけです。 VBA は必要ありませんし、 何のエラーも表示されません。 表示できない画像は表示されない、というだけのことです。
他の人の質疑応答から判断して、下記のような状況かなと推測します。 連結の帳票フォームで100件くらいのデータを一気に新規入力している。 入力は前に入力した値と同じ場合が多い。 この入力を効率化したい。 あっていますか。 だとするなら、入力時にテキストボックスの「規定値」プロパティに入力した値をVBAで設定しておけば、新規レコードに前の入力値が規定値として表示されますので、変更がなければそのままEnter(あるいはTab)、変更があるときのみ入力すればよく、入力の効率化が可能です。 テキストボックスの更新後処理のイベントプロシージャを下記のように記述すればいでしょう。 数値型のフィールドと連結したテキストボックスの場合 Private Sub フィールド1_AfterUpdate() Me.フィールド1.DefaultValue = Nz(Me.フィールド1.Value, "Null") End Sub テキスト型のフィールドと連結したテキストボックスの場合 Private Sub フィールド2_AfterUpdate() If IsNull(Me.フィールド2.Value) Then Me.フィールド2.DefaultValue = "Null" Else Me.フィールド2.DefaultValue = """" & Me.フィールド2.Value & """" End If End Sub
Null のレコードを抽出するときは、=演算子ではなく Is演算子を使います。 抽出条件欄では=演算子は省略できますが、Is演算子は省略できないという仕様です。 よって、下記のように設定してください。 「抽出条件」欄 Is Null And Forms!フォーム名!ボタン名 = 1 そのしたの「または」欄 Not Is Null And Forms!フォーム名!ボタン名 <> 1
追加クエリを使うとか繰り返し処理でコピーするとか。 繰り返し処理は下記が参考になります。 追加の場合は rs.Edit の代わりに rs.AddNew です。 全てのレコードを一括修正する（DAO） http://www.moug.net/tech/acvba/0080015.html
現状、どのようにマクロを設定したのか不明なので、まずは現状のマクロを削除してください。 その上で下記の手順でマクロを設定してください。 １．フォームの「読み込み時」の右端のビルドボタンをクリックして「マクロビルダー」を選択してOKをクリック。 ２．アクションの追加で「レコードの移動」を選択。 ３．「レコード」欄で「最後のレコード」を選択。 ４．「上書き保存」をクリック、「閉じる」をクリック。 ５．いったんフォームを閉じて、開いてみる。最後のレコードに移動しているのを確認する。 以上を試してみて上手く行かない場合は、再度、どのようにうまくいかないのか説明してください。
どのようにじゃなくて、フォーム作ったんだろ？？？
個人的な感想ですが、そのフォームでは何がしかの処理を行っているんですよね？ （読み込みや追加、更新、削除等） タイミング的にはAccessからSQLを発行、MYSQL側で処理を行う時点でAUTO_INCREMENTがナンバリングされると思います。 （違っていたらごめんなさい） なので、SQLを発行し、発行後処理が正常に終わったならばリクエリを行う等すれば 問題なく表示できるのではないかと。
下記のコードを使うとできます。 標準モジュールに貼り付けます。 Public Function Kado(Kido As Date, Teishi As Date) Kado = (Teishi - Kido) * 1440 '分換算 Kado = Kado \ 60 & ":" & Kado Mod 60 '表示編集 End Function イミディエイトで確認すると、こんな感じになります。 ? Kado(#2016/07/25 08:18# , #2016/07/26 17:45#) 33:27 クエリでは、フィールドに 稼働時間:Kado([起動日時] , [停止日時]) と書いて下さい。
＞VBAを使用するにもアイディアがさっぱりでません。 ＶＢＡが使えるなら何も悩む事無いと思うのですが？ 「登録画面」のデータを取り敢えずグローバル変数に記憶して、 元の画面に戻った時に「ミリ」か「インチ」を判断して代入するだけの事ですよネ？
２パターン ◆パターン１ With ～ End With ステートメントだと↓こんな感じ ' [フォームB]を編集しかできなくする With Forms![フォームB] .AllowAdditions = False .AllowEdits = True .AllowDeletions = False End With ◆パターン２ Set ステートメントだと↓こんな感じ ' [フォームB]を編集しかできなくする Dim F As Form Set F = Forms![フォームB] F.AllowAdditions = False F.AllowEdits = True F.AllowDeletions = False Set F = Nothing '←終了時に自動で解放してくれるが、明示的にする方が視覚的に分かりやすい P2はDimをフォームモジュール全体に効かせるように配置させれば、そのフォーム内でずっと効果が持続します。 つまり↓こうゆうこと Option Compare Database Dim F As Form Private Sub Form_Open(Cancel As Integer) Set F = Forms![フォームB] End Sub Private Sub Form_Current() F![コマンドボタン].Enabled = True End Sub
VBAエキスパートを運営しているオデッセイコミュニケーションズのカスタマーサービスです。 Access VBAベーシックの試験問題はお試しになったサンプル問題と同様に択一形式で解答していただく問題か、複数選択の形式で解答していただく問題が出題されます。MOS Excelのような操作形式ではございませんが、VBAの作成や読解力といった実践力を評価します。 ご参考になれば幸いです。
入力規則に以下の式を設定してはどうでしょうか。 InStr(1,":;.*()<>”’",[フィールド名],0)=0
えっと、それって在庫管理って言えるシステムですか？ 入庫したときには在庫にプラスし、出庫したときは在庫をマイナスするという基本の機能が無いように読めます。 物の移動とシステムの値が乖離（かけ離れること）するようなシステムは、 本当の在庫管理とは言えず、「後付けで在庫に合わせたよシステム」という タイトルがあっているような気がします。 とりえず在庫管理の基本をざっと説明します。 ①在庫マスタの基本テーブルは、品目ごとの在庫数を記録する在庫マスタと入庫・出庫の履歴を管理する入出庫履歴テーブルの２つで成り立ちます。 ②物を入れるときに合わせて入庫の入力を行い、在庫がプラスされ、合わせて履歴上に日付、時刻、入庫数、入庫後の在庫数、その他購入時の注文番号などを記録する。 ③物を出すときに合わせて出庫の入力を行い、在庫がマイナスされ、合わせて履歴上に日付、時刻、出庫数、出庫後の在庫数、その他使用した製造番号などを記録する。 ④現在の在庫数は在庫マスタの数量を見てもよいし、入出庫履歴で１点ずつ確認することもできます。 ⑤棚卸では在庫マスタを棚位置順に一覧化し、実数との差異を入庫または出庫で調整する。
可能ですが保存する事に意味が有るとは思えません。 データベースの基本は同じ情報は保存しない事です。 「東池袋」と「東京都」「豊島区」を関連付けるキーが有るのなら、必要になった時に再度関連付けて表示すれば良いのです。 「東池袋」「東京都」「豊島区」を新規のテーブルとして保存する必要は有りません。 勿論例外は有ります、キーが変化する場合は保存する事に意味が有ります。
OSS-DB http://www.oss-db.jp/ ここの資格に近いと思います。 [受験対策]→[学習教材・教育機関の紹介]に載っている書籍が参考になると思います。
Me.Filter = "周期ID = 1 Or 周期ID = 2 "
違いというより、 関係は、相関関係を含みます。 一般的な関係は、意味が広く、何らかの関係？が関係です。 全ての関係を含みます。 相関関係は、統計学的に測定した結果、正の関係と負の関係と無関係に分類出来た場合に相関関係と呼びます。 この他に因果関係というのもあって、これも関係に含まれますが、相関関係が統計で発見された観測結果であるのに対して理論的に何らかの関係を持っている場合が因果関係です。相関関係があると因果関係がある可能性が高いですが、たまたまそうなっただけで因果関係が成立しない場合もあります。
http://www.sk-access.com/mailmaga/vol258.html
Ifは必要ありません。 以下の1文で実現できます。 Me!btn1.Enabled = Not IsNull(Me!txt1 + Me!txt2 + Me!txt3 + Me!txt4 + Me!txt5 + Me!txt6 + Me!txt7 + Me!txt8 + Me!txt9 + Me!txt10)
私はリレーションシップは将来データベース構造を変更する時に操作ミス（データベース構造の詳細を忘れて）でデータが消えかねないので使うべきでは無いと言う考え方です。 よってリレーションシップが設定されているシステムは判りません。 （今回の件に付いてはそれほど複雑な構造では無さそうなので、チョット調べれば直ぐに思い出せるレベルかも知れませんが！！） もしリレーションシップを使わなくても良いと言うので有れば下記を参考にしてリレーションシップを削除した上で （念の為ファイルのコピーを残して下さい。） ・テーブル名 ・フィールド名 ・貴方が欲しい結果（データ）の見本 を返信して下さい。 リレーションシップを削除する https://support.office.com/ja-jp/article/%E3%83%AA%E3%83%AC%E3%83%B...
無理だと思います。 っていうか無理です。
サブフォームのレコードソースをクエリにして、クエリのフィールド欄の方に式を設定すれば右クリックメニューに昇順・降順が現れます。 設定例 重量: Format([テーブル名].[重量],IIf([テーブル名].[重量]-Int([テーブル名].[重量])>0,"#,##0.#","#,##0")) ただし、Format関数の返り値はテキスト型なので、数値としての並び順とは異なりますので、希望のものにはならないでしょう。 右クリックメニューはあきらめて、メインフォームに並べ替えのボタンを配置してVBAでサブフォームの OrderByプロパティを設定して並べ替えるようにすることになると思います。
クエリＣにおいて、結合線をダブルクリックし、AのすべてとBの存在するものを選択します。 フィールドには各項目を並べ、最後に残数の計算式を書きます。 このとき存在しない品目の受信数はNullになるため、 計算ができないので、Nz関数で0の扱いにしてやります。 クエリA.........クエリB 品目番号------>品目番号 在庫数............受信数 フィールド:｜品目番号｜在庫数|受信数｜残数:[在庫数]-Nz([受信数],0)｜
①パスワード変更のフォームを作る。 ID : xxxxx 旧パスワード ： xxxx 新パスワード ： xxxx [取り消し] [変更] ← これボタン ②変更ボタンを押したときに処理 ・入力済みチェック（ID、旧、新） ・ユーザー存在チェック（IDのユーザーが登録されてるか） ・パスワードの更新（UPDATE文を使用）
まず、ご希望のことは、 サブフォームの一覧で選択したレコードをメインフォームに表示させて、 メインフォームで更新して、それを「更新」ボタンでサブフォームに反映させる。 また、メインフォームで新規入力したものを「追加」ボタンでサブフォームに新規追加する。 ということですね。 あとコード中にあるMDBAccess というのは独自のデータ操作クラスですか。 その内容が不明なので想像で回答するしかないですね。 サブフォームのクリック時で メインフォームのRecordSourceにSQLを設定していますが、 これは連結フォームになりますので、不用意な操作でデータが削除されたり、更新されたりします。 ご希望のことを実現する場合は、非連結の方が適切だと思います。非連結ならテーブルデータが不用意に削除されたり更新されたりすることはないので。 あとサブフォームの選択したレコードを更新する場合も、更新クエリで更新するより、サブフォームで直接更新したほうがシンプルです。 ということで下記のようなコードでご希望のことは実現できます。 Private Sub 更新_Click() 'メインフォームの更新をサブフォームのカレントレコードに反映 With Me.サブフォームB.Form .colm1.Value = Me.textbox1.Value .colm2.Value = Me.textbox2.Value .colm3.Value = Me.textbox3.Value .colm4.Value = Me.textbox4.Value .colm5.Value = Me.textbox5.Value .Refresh End With '入力したデータをNULLへ Me.textbox1.Value = Null Me.textbox2.Value = Null Me.textbox3.Value = Null Me.textbox4.Value = Null Me.textbox5.Value = Null End Sub Private Sub 追加_Click() Me.サブフォームB.Form.Recordset.Addnew Call 更新_Click() End Sub サブフォームBのレコードセレクタをクリックしたときのコード Private Sub Form_Click() With Me.Parent !textbox1.Value = Me.colm1.Value !textbox2.Value = Me.colm2.Value !textbox3.Value = Me.colm3.Value !textbox4.Value = Me.colm4.Value !textbox5.Value = Me.colm5.Value End With End Sub
簡単にできる方法はないです。クエリとVBAで振る方法でも良ければあります。 その場合、対象となるテーブルの内容と、テーブル内のどのフィールドの順番で連番を振るのかを提示して下さい。 また、フィールド値の重複がある場合は、どうするのかも提示して下さい。 （こちらは絶対に重複しないのであれば不要です）
今回のようなシンプルな条件なら、VBA を使わずにクエリに直接下記のような式を記述すればいいでしょう。 判定: IIf([区分]="A" AND [Status１]=[Status2],"OK","NG") VBA を使うなら、標準モジュールに下記のような関数を作成します。 Public Function Hantei(区分, Status1 Status2) As String If 区分="A" AND Status1=Status2 Then Hantei = "OK" Else Hantei = "NG" End If End Function クエリに下記の式を記述します。 判定: Hantei([区分], [Status１], [Status2]) 条件式が複雑になる場合は、VBAの方が対応しやすいですね。
>リカバーの手順も教えて頂けたらありがたいです。 HDDをフォーマットしてOSのCDを入れて起動するだけです。
同一製品でも同じ性能が出ているか確認していないと思いますので、まずはベンチマークソフトでハード的に同じ性能が出ていることを確認して下さい。 メモリ２枚指しが1枚認識されていない、HDDに初期不良がありリトライが多発しているなど 例；CrystalDiskMark http://www.vector.co.jp/soft/winnt/hardware/se426253.html
言いたいことは判らないでもないけど、質問は落ち着いて、出来るだけ正しい日本語で書きましょう。 Accessに限った事ではないのですが、文字を範囲で取る場合は、文字コードの比較になります。 文字コードが判らなかったら、まず、そこから調べてください。 文字列を比較する際には、その文字列を形成する文字の文字コード順に並びます。 例えば、例に上がっている「金賞」と「銀賞」ですが、文字コードで比較すると「銀賞」の方が大きくなります。 まず、これが基本。 で、質問の内容なんですが、「文字列を範囲検索する際にはSQL（もしくはDLookupなどの関数の条件部分）では、どう書くべきか。Betweenを使えばよいのか？」という事だとするならば、まさしくその通りです。しかし、その場合上記の文字コードを意識しなければなりません。 例えば、「特賞」「金賞」「銀賞」と言うデータが有り、特賞と金賞の上位2つを取りたい場合、「Between '特賞' and '金賞'」と書きたくなります。しかし、文字コード順で言えば「金賞」「銀賞」「特賞」と、特賞が一番大きくなります。結果、先ほどの条件では上位2件ではなく、全てが取られてしまうことになります。 これを回避するために、普通は範囲で条件に指定したり、大小比較するデータは、数字として保存し、その対応データを別途保持し、表示の際にそのデータを扱うようにします。 こういう別途持つデータを「マスターデータ」等と呼びます。 結論として回答は「文字列の範囲指定はBetweenで指定できる。しかしそれは思った通りの抽出が出来るとは限らない。」と、なります。
OpenForm の第４引数の意味を考えれば間違いが理解できると思います。 第４引数は抽出条件を設定します。 "顧客コード='" & Me.[txt_顧客コード] & "'" は、[txt_顧客コード] に入力した顧客コードのレコードを抽出するということです。 既存のレコードが存在する場合は、該当のレコードが表示されるので、顧客コードも既に入力済みで表示されます。 新規入力の場合は、該当のレコードが存在せずに、新規レコードになるので、顧客コードも未入力状態になります。 新規レコードで顧客コードを表示させたい場合は、「規定値」プロパティに顧客コードを設定します。 よって、下記のコードで希望の結果になるでしょう。 Private Sub cmd_新規_Click() '追加モードで開く（新規レコードの入力） DoCmd.OpenForm "F_新規入力", , , , acFormAdd '規定値（DefaultValue）を設定 Forms!F_新規入力!顧客コード.DefaultValue = "='" & Me.[txt_顧客コード] & "'" End Sub
`SET GLOBAL` （サーバー全体の値）で変更しようとすると SUPER権限が必要になりますが、 `SET SESSION` （そのセッション固有で使われる値）であれば一般ユーザーでも設定できるかと思います。 ``` mysql> SET SESSION wait_timeout = 28800; ``` セッション固有のため、接続するたびにこのステートメントで値を設定してあげてください。
自力で作られてきたことは大変だったのではないかと察しますが、 無理やり作った感が否めないので、ここで一時的にできたとしても、 その先でまた行き詰ってしまいそうな感じがします。 設計から見てもらえる人を探したほうが良いと思います。
参考 http://vba-geek.jp/blog-entry-161.html で、これだと、ホイール自体がキャンセルされるような気もする。 試してないんで、まずはこれをどうぞ。
マクロ「アプリケーションの実行」で explorer.exe "D:\" といった具合に指定してください。
「移動」というのはどんな処理ですか？ ID..... 名前 001... あああ 002... いいい 002... ううう 003... えええ をこのあとどのように「移動」するのですか？
そもそも！どんな集計を希望されていますか。 それが、質問にないから回答しようにもできない 単なる小計なら、ピボットテーブルのグループ化でできるかもしれないし sqlでできるかもしれないです。
当月の末日の値は、 翌月の１日－１ で求めます。閏年や月ごとの違いを考慮する必要はありません。 以下は、任意の日付が属する月の末日を返す関数の例。引数は省略可能、省略した場合は当月の末日を返す。 Public Function GetMatsujitsu(Optional D As Date = Date()) As Date Dim Next As Date Next = DateAdd("m", 1, D) GetMatsujitsu = DateSerial(Year(Next), Month(Next), 1) - 1 End Function 補足について‥‥‥ 当方のミスです。ごめんなさい。Optionalの引数の既定値に関数は使えないということでした。 で、以下のように修正しました。 Public Function GetMatsujitsu(Optional D As Date = 0) As Date Dim N As Date If D = 0 Then D = Date() End If N = DateAdd("m", 1, D) GetMatsujitsu = DateSerial(Year(N), Month(N), 1) - 1 End Function お手数かけました。
各店舗のデータが売上データだと仮定して、 ①３つのEXCELファイルをACCESSにリンクして、売上_A店、売上_B店、売上_C店のテーブルを作成します。 ②選択クエリで売上_A店と商品一覧テーブルを配置し、商品コード同士で結合し、 フィールドに売上_A店の商品コード、商品一覧の商品名、商品一覧の単価、売上_A店の数量、金額:[商品一覧]![単価] * [売上_A店]![数量]を配置し実行します。 ③②と同様に売上_B店と売上_C店の選択クエリを作ります。
質問者様が言うゴミサイト名を AV IDOL と言います 感染ファイル名 MovieID_OVOrOkKJdFQEUkgN16O8Z7KkkOxkYRye. hta.zm6q010 ■運営会社 株式会社アイティー通信 ■運営責任者 ヨシダマコト ■所在地 東京都杉並区高円寺南4-24-9 電話番号 03-6454-6425 03-5913-7463 03-6454-6426 不正請求額 １５万を８５０００円 文字で感染前～感染後の流れを書いても 逆に文字数だけを悪戯に増やしてしまうので こちらの落書きを参考にして原因を考えて見てください http://white-miffy.bbs.fc2.com/?act=reply&tid=15629515 本題です >一昨日、押してはならないところをクリックしたみたいです 上記の落書きの番号で言うならば 4 htaファイルを実行させる画面ですの部分を見てください このファイル名の最後にhtaと書いてあるのが分かりますか？ 此れをゴミが実行しろと騙すから添付画像が出てくるのです またブラウザもWindows標準の場合は確実に感染出来ます >履歴を見ると三段階の警告が出ていたらしいです。 再度同じことを言えば上記落書きで言う ０・１・２の部分を見て貰えば理解出来るかと思います >「本日」が過ぎたらいったいどうなる 何にも変わりません。精々入金期限を変わってるに変わるだけです >どうしたらよいか、教えてください 此れは最後に説明をします >「Microsoft OneDrive サインイン 此れに関しては今回のゴミとは全く関係ありません もし不要だと思うなら少し難易度が有りますが 下記サイト様を参考にしてください http://www.ka-net.org/blog/?p=5934 駆除に関して こちらの長たらしい説明を読んで下さい 初心者様向けに書いてますので回りくどい説明です 部分的に注意事項も書いてますので飛ばさないで下さい http://white-miffy.bbs.fc2.com/?act=reply&tid=10844408 今後はこのようなゴミには気を付けて下さい なお電話番号で検索をすると この手の被害者を食い物にしてるゴミ業者が 表向き注意喚起と謳いカモを誘導しています 絶対に無料電話相談だの投稿フォームから送信何てしないで下さい 失礼します
いろいろ聞きたいこともあるのですが･･･ フォームのレコードソースには何か設定されてますか？ 設定されているのなら > Set Me.Recordset = rs これが、うまくいったとしても > Me.Requery これで帳消しになりそうな気がします 通常 Me.Recordset は DAO で作られると思いますが、 あえて ADO を設定する背景には何があるのでしょうか "Q_商品購入先" は、記述あった左外部結合の内容ですか？ であれば、商品cd は、SELECT 内に無いので > rs.Filter = "商品cd=" & ･･･ ここでエラーになると思うのですが･･･ rs.Source = "SELECT * FROM Q_商品購入先 WHERE 商品cd=" & Me.cmb しても時遅し･･･？ > 抽出クエリーを作成、抽出フォームを作りました。 フォームが既に連結（レコードソース指定）されているのなら、 Me.Filter = ・・・ Me.FilterOn = True で絞り込んだ方が良いのかも??? また、元のクエリでは select t購入先.購入先cd ,t購入先.会社名, t購入先.商品cd FROM ･･･ として 商品cd も含めるようにしておくとか･･･
普通は[Ctrl]+"F"で表示される、検索と置換ダイヤログを使う人が多いと思います。 [Ctrl]+"F"はEXCELでも似たようなダイヤログが出ますので覚えていると便利ですよ。
分かりやすいAccessの書籍も執筆されている、 緒方典子さんのサイトです。 当該サイトは、かなり人気が高いと聞いています。 まず、ここを読んでみてください。 http://www.mahoutsukaino.com/ac/ac2000/ac2000/sonota/sonota03_1.htm このサイトには、Accessのバージョンは古いものが多いですが 他にも色々と、ためになることが満載です。 ザッとでも良いので、ご覧になってみてください。 Accessのことが、少しずつ分かってくると思います。
①テーブルAを開いたままで、 ②テーブルBに職業Cを追加し、 ③その後テーブルAのコンボボックスを開いても職業Cが見えない ということで良いですか？ であれば、③でコンボボックスを開く前に[F5]キーを押して下さい。 これでコンボボックスの内容が更新されます。 マクロのアクションの「再クエリ」と同じ効果があります。
ネットワークからリンク設定していますか? リンク先が、\\MyPC\・・・・ の様になっていなければなりませんし、他のPCから見た時同じアドレスでないと駄目です。 よく使う方法として、MDBのある直上のフォルダに対して仮想のドライブ名を付け、他のPCでも同じドライブ名を割り当てるという手法があります。 複数で同時にしようするのでしたら、バックグラウンドはSQL Server にすると良いと思います。
まだ、EXCELの考え方にとらわれているようなので、考え方を変えないとどこかで行き詰ってしまうと思います。 例えば、「また1～31までのフィールドを設けて納品日に数量を入力する..」という部分は、ACCESS(に限らずリレーショナルデータベース)では、こんな持ち方をします。 |機種名|日付...........|生産数| |AAAA|2016/07/01/|.....10| |AAAA|2016/07/02/|.......0| |AAAA|2016/07/03/|.......0| |AAAA|2016/07/04/|.....10| |： |： まだスタートしたばかりであれば、すぐに作り始めるのではなく、似たものを探すなど、少し大きく構えて取り組まれたほうが良いと思います。 知恵袋では局所的な質問/回答しかできないので、基本から教えてくれるところを探した方が良いかもしれません。
>?DateDiff("yyyy","2000/1/1","2000/12/31") DateDiffは指定した 2 つの日付/時刻の間隔数なので、1/1～12/31では1年にはなりません。 時分まで意識して。2001/1/1 00:00 ～ 2001/12/31 00:00とするとわかりやすいと思います。 |1/1.....|1/2....|..................|12/31| |<----------------------------->| >?DateDiff("yyyy","2000/1/1","2001/1/1")であれば、 |1/1.....|1/2....|..................|12/31...|1/1...| |<--------------------------------------->| 終わり側の日付に意識的に１を足してやってはどうでしょうか？ ? DateDiff("yyyy",CDate("2001/1/1"),DateAdd("d",1,CDate("2001/12/31")))
アクセスの選択クエリで「Σ」ボタンで押下し、 「集計」行を「最大」に。 結果 OK なら SQL ビューに切り替えて SQL をコピー エクセルの VBA で オープンする SQL の変数にセット。
AMAのサイトを見ました。 ACCESSの価値・相場が分からない業者が値付けしてるんじゃないでしょうか。 でもどうしても2010を求めなければならないレアなケース(多分ない)に陥ったら、AMAでなら２万強で売られているOFFICE2010Proを購入しますけど。 それと、ヤフオクの相場も見ましたが２万円前後で落札されてるケースも多々ありますね。 需要はあるっぽいですね。 有益回答ではなく意見に近くなりましたが以上です。
ACCESS2016+Windows7環境で試しましたが、縮小される問題は起きないようです。 Windows10の問題かもしれません。(環境がないので評価できず)
ＶＢＡを使えば可能ですが、ＶＢＡが判らないのでしたら。 実行したいクエリに関連するテーブルをリンクしたアクセスファイルを作り アクセスが起動した時に自動実行されるマクロでクエリの処理とアクセスの終了まで行えば良いです。 アクセスの起動は下記で出来ると思います。 指定日時/起動時等にアプリケーションを自動実行させる http://www.fwindows.com/tips/tips020628.htm
「タイムカード印刷」とは・・・？ ・入退情報記録用の白紙カードを印刷する ・タイムカードに記録された結果を集計などのデータ操作をする ・・・いずれにせよ 【元となるクエリ(テーブル)の仕様(配置フィールド)が不詳】 と 『クエリーで本日の月日を取得して「年」「月」は、何とか出せるようになりました。 』の【何とか】とは何？ なので ぼんやりとする回答になりますが クエリの[日付に関するフィールド]の「抽出条件」に ① Between #yyyy/7/16# AND #yyyy/7/31# ② Between #yyyy/8/1# AND #yyyy/8/15# としてみる(yyyyの部分には'対象年'に置き換える) です。
その市販されているアプリケーションの独自の機能をコピーした場合、著作権等を犯したとみなされます。 自社で利用したとしても、それにより利益が発生し、本来の権利者の権利を阻害しているのですからアウトですね。 問題は独自の機能ってのが、プログラムのロジックから、見た目まで含まれるんですね（それが、利便性の根源であれば） 例えば、一般的な経理処理を再現するのであれば問題ありませんが、ある業種で通例上用いられる経理処理をあるアプリを「見習って」作っても、見た目、機能が一致した場合、アウトです。（と、判断される）
どんなデータを元に、どんなグラフを描画しているかを開示してみてはどうですか？ できるかもしれないし、やはりできないかもしれないですが、言葉だけの空中戦よりは何か見えてくるかもしれません。 例えば、元データはこんな風で、
>iamsingingwithwalkingさん >XMLファイルをHTML化する方法はあるでしょうか？ あります。 ＞方法があれば、教えて頂けないでしょうか。 たくさんのやり方があるので検索してお好みの方法をお選び下さい。
総合テーブルから１日目の講座申込を抽出する「クエリ１」、 総合テーブルから２日目の講座申込を抽出する「クエリ２」、 総合テーブルから３日目の講座申込を抽出する「クエリ３」、 総合テーブルから４日目の講座申込を抽出する「クエリ４」、 上記の４つを縦に結合するUNIONクエリをつくり、 下記のような縦データが得られるようにします。 Aさん ＸＸ県ＸＸ市 1日目 A講座 Aさん ＸＸ県ＸＸ市 2日目 D講座 Bさん ＹＹ県ＹＹ市 1日目 A講座 Bさん ＹＹ県ＹＹ市 3日目 B講座 Cさん ＺＺ県ＺＺ市 1日目 A講座 Cさん ＺＺ県ＺＺ市 2日目 B講座 Cさん ＺＺ県ＺＺ市 3日目 C講座 このUNIONクエリの結果を元にさらに集計クエリを作成し下記の結果を求めます。 A講座 3 B講座 2 C講座 1 D講座 1
>そんなことは可能？ はい、可能です。 Access VBAもExcel VBAもプログラミング言語としては同じものです。主として扱うオブジェクトが違うのと、既定のApplicationオブジェクトが違うこと。 例えば、AccessのDLookup関数は、 Access.Applicatin.DLookup のはじめの部分を省略したもので、Access VBAの既定のApplicatinオブジェクトがAccess.Applicatinだからそれが可能になるわけです。よくわからなくてもかまいませんが、Excelも同様です。 セキュリティについては、そのPCでExcelを開いてオプション→セキュリティから必要に応じて設定を変更する必要があります。
>Forms!売上伝票!取引先マスター!名前 Forms![メインフォーム名]![サブフォーム名]![コントロール名] の意味で書いているとしたら間違いですので、式ビルダを使うと正しい式が獲られます。 Forms![メインフォーム名]![サブフォームコントロール名].Form![コントロール名]
マクロ利用のケースならば、 今日の日付に対して開くフォームを決定する場合 1日(ついたち)なら、マクロの「条件」に → Day(Date()) = 1 「アクション」に → フォームを開く 「フォーム名」に → 1日稼働のフォーム名 2日(ふつか)なら、マクロの「条件」に → Day(Date()) = 2 「アクション」に → フォームを開く 「フォーム名」に → 2日稼働のフォーム名 上記パターンで1つのマクロ内に31日(行)分作ります。 なお、VBAで上記のフォーム名パターンなら Docmd.OpenForm Day(Date()) & "日稼働のフォーム名" と、この1行でサクッと現すことができます。 （名称に統一性がないのなら、やはり実質31行分を記述となる） もし日付の部分を他のフォームのテキストボックスの内容を参照するのなら Date() → CDate(Forms![参照するフォーム名]![参照するテキストボックス名]) と置き換えます。 VBAのパターンで表現するなら Docmd.OpenForm Day(CDate(Forms![参照するフォーム名]![参照するテキストボックス名])) & "日稼働のフォーム名" です。
フォーム１での計算結果を確定させないと、別フォーム２では利用できません。 非連結コントロールでなく、連結コントロールに計算結果を、保存すれば、その結果をフォーム２でも利用できます。 説明が、粗いですが、推量してください。
フォームのデザインビューで、左上のルーラー(目盛り)の交点にある正方形をクリックすると、黒い四角が表示されます。 その状態でマウスカーソルを動かさずプロパティを出すと「フォームのプロパティ」が表示されます。 (他の方法として、「テキストボックスのプロパティ」にあるコンボボックスから「フォーム」を選ぶと「フォームのプロパティ」に切り替わります。) 「フォームのプロパティ」の「データ」タブにある「レコードソース」がフォームに表示されるデータが入っているテーブルまたはクエリです。 余談ですが、「他の人が作ったAccessデータをカスタマイズ」との事なので、非連結フォームについて少しだけ書いておきます。 レコードと連結したフォームの場合、Access独特の動きになり、ボタン等で登録をしたりキャンセルしたり出来ません。 そこでボタンなどで操作性をWindowsアプリ風にする場合、「レコードソース」および「コントロールソース」を空にした非連結フォームにして、マクロやVBAなどでデータの読み込みや登録を行う場合があります。 もしそのようなフォームに出会った場合、プロパティのイベントタブにカスタマイズのヒントが入っています。 フォームのプロパティのイベント「読み込み時」に初期化処理が記述されていたり、「登録」ボタンのプロパティのイベント「クリック時」に登録処理が記述されていたりします。 非連結の場合、「フォーム内に表示されている文字列がどこのテーブルのデータから引用されているのか」はデータを選ぶコンボボックスの「更新後処理」または「読み込み」ボタンの「クリック時」などを見ると分かると思います。
そうなんですか。 でも、それがどうしたんですか？
Program Files は名前のとおり、プログラムを保存するのが本来 なぜ、そこへの保存をしなくなったかは、そこのファイルを置き換えるコンピュータウイルスがあるから、Windowsでそういった大事なところへのファイル書き込みを制限するようになったので、Windows7からだったと思います 家でも、道具と材料は別々に置くように、パソコン内も分けるべきで、ドキュメントフォルダなどにすべきではないでしょうか。
そこの動作は変更できないですね。 リボンの「検索」クリックまたは Ctrl+F で出る検索ダイアログなら 特定フィールドのみ対象にしたり、完全一致か部分一致などを指定して検索できます。
かなりの高解像度で表示されているということでしょうか？ 普通の解像度であればそれなりに見えると思いますが.... Windows10ならディスプレイ設定で 「テキスト、アプリ、その他の項目サイズを変更する」で 表示倍率を上げることもできます。
Accessでは、フォームとレポートは連動はしません。 フォームは、テーブルからフォーム、またはテーブル、クエリ、フォームという流れでデータが関連付けられます。 レポートも同様で、テーブルからレポート、またはテーブル、クエリ、レポートいう流れでデータが関連付けられます。 レポートは出力されるオブジェクトなので、レポートのデータからクエリやテーブルへデータは流れません。 レポートで表示したいフィールド（項目）をまず決めておきます。 その項目を抽出させるために、テーブルを元にクエリを作成し、そのクエリを元にフォームを作成します。フォーム上に必要な条件を指定して、クエリを実行するとレポートが表示されるようにするのが一般的ですね。
何に利用したいですか？利用者は何人くらいですか？ これだけ聞けば、どちらが適しているかを答えられます。 今回の質問を大げさに書くと、 タンス1個を2人だけで運びたいのですが、 軽トラが良いですか？(ACCESS) 10トントラックが良いですか？(PHP+mysql） と聞いているにように感じられます。
当方Ｗｉｎ１０とアクセス２００７ですが、そのような現象は出ていません。 使用不可では無く ・オフ ・半角英数 等では如何でしょうか？
「メモ」というメモ型のフィールドを持つテーブルを用意し、 このテーブルを元にフォームを作成し、 普通に行を追加できました。 フォームのレコードソース： テーブル名 フォーム上のテキストボックスのコントロールソース：メモ（フィールド名）
> アクセスでエクスポートができません エクスポートはどのような方法でやってますか？ 提示あった内容では抽出できているのですよね？ 以下の記述でどんな動きになりますか？ （報告もない方だったでしょうか？） 選択クエリ名を ★★ とした場合、 Samp1 では、DoCmd.TransferSpreadsheet を使って Samp2 では、自力で なお、Samp2 では保存していないので･･･ Public Sub Samp1()    Const CFILE As String = "D:\Hoge\Moge.xlsx" ' 修正要    DoCmd.TransferSpreadsheet acExport _                , acSpreadsheetTypeExcel12Xml _                , "★★", CFILE, True End Sub Public Sub Samp2()    Dim cn As ADODB.Connection    Dim rs As New ADODB.Recordset    Dim i As Long    Set cn = CurrentProject.Connection    rs.Open "★★", cn, adOpenForwardOnly, adLockReadOnly    If (Not rs.EOF) Then       With CreateObject("Excel.Application")          With .Workbooks.Add             With .Worksheets(1)                With .Range("A1")                   For i = 0 To rs.Fields.Count - 1                      .Offset(, i).Value = rs(i).Name                   Next                   .Offset(1).CopyFromRecordset rs                End With             End With          End With          .Visible = True       End With    End If    rs.Close End Sub
「FilterOn句」 とは？ VBAで使われるフォームの FilterOnプロパティ のことでしょうか。 フィルターを利用するときは FilterOn だけでは成立せず、 Filterとペアで利用します。 ↓ Me.Filter = "[オプション] in ( 'ナビ' , 'キーレス' )" Me.FilterOn = True ↑ in句の右側のシングルコーテーション内の文字列部分をテキストボックスなどより取り入れ、可変化の仕組みにすると応用が効きますね（ただし、それなりに面倒）
とりあえず、 グループウエア 無料 をキーワードにWEB検索して、 出てきたものの仕様とにらめっこしてから考えたほうがよさそう気がします。
バックアップコピーを取らずにいじるとそうなります。 変更する場合は壊れても戻せるようにファイルをコピーしておくことをお勧めします。 コピーをとっていないとしたら、変更した人に責任を持って戻してもらいます。 戻せないとしたら、お金を出してでも直せる人、直せる企業に頼むしかありません。
ご希望のシステムは構築可能です。 似たようなシステムを作成/運用していますが、 Accessの知識より、webサーバーやwebページの知識がいります。 それも静的なHTMLだけでなく、ASPやPHP等を使った動的なページを作れる事です。メーラーも使える必要がありますね。
設定している式を具体的に提示された方が間違い、及び正解を回答しやすいです。 また、「例外として処理する」とは、具体的にどのような動作になってほしいのでしょうか。 とりあえず想像で、下記のようだと仮定して回答します。 ・クエリの式 式1: Format(CDate([年月日を入力してください]),"gggee年mm月dd日") ・バラメータに日付以外を入力した場合は、"日付でない" と表示する 回答 下記のようにIsDate関数で日付かどうか判断します。 式1: IIf(IsDate([年月日を入力してください]),Format(CDate([年月日を入力してください]),"gggee\年mm\月dd\日"),"日付でない")
一旦、SQL文を文字列変数に格納して表示しましょう。 と書いてみましたが・・・クエリ実行をしているのか、モジュールでガリガリと書いているのかがわからないので何とも・・・。 ただ、１つだけ言えるのは・・・解析に苦労しているということは、修正しなければまた苦労するいうこと。問題解決して時間ができたら、きれいに修正しましょう！ 役立たずで、ごめんなさい。
私は値集合ソースを値リストにすることは無く必ずテーブルにしています。 値リストは未来永劫変わらないようなもの(例:性別)では使えるかもしれませんが、genderlessの今の時代ではこれさえも変わる可能性があるので、テーブルにした方が無難です。 （いっぱい仕込んじゃってたらご愁傷様です）
ＭＳのサポート技術情報で解説されています。 フォームから入力した条件のみ有効にしてデータを抽出する方法 https://support.microsoft.com/ja-jp/kb/881390
>「作成」タブ→「クエリデザイン」→「デザイン」タブから「SQL」ビュー、で SQL文の入力 INSERT文で登録できます。 Ex. INSERT INTO TblA (F1,F2,F3) VALUES (1,2,3) >データの登録やデータの検索、削除、更新は 全て一つのクエリ内で 行うことが可能ですか？ 検索、削除、更新はそれぞれ別のクエリを作成する必要があります。
本は人の好みに左右されやすいので、私の選び方だけ書きます。 ①まず書店に行って同じ種類の参考書を全部ぺらぺらめくって見ます。(全種類） ②その中でレイアウト、色使い、文字の大きさ、図解などで直感的に良いと思ったものを２～３種類選抜します。 ③後はじっくりとその２～３種類を吟味して一番自分に合ったもの物を選びます。 ④自分のレベルに合ったものだけを購入し、必要のないレベルのものは先に購入しません。
Format関数でなく、アクセスの書式のヘルプですが、 固定：最低 1 桁を表示します。負の数値、小数点と通貨の記号、小数点以下の桁数については、Windows の地域の設定で指定されている設定に従います。 https://support.office.com/ja-jp/article/-Format-書式-プロパティ-数値型と通貨型-ca77795e-b40d-4abb-b42f-daa0bb709620 とあります。 アクセスのHELPから、Format関数をみても同じページにたどりつくので、Format関数もこれに準拠していると思います。
まずはAcccessにしてもVBAにしても文字列、数値、日付、、、等々。 データの属性、というものがあるので「テキストボックス」が「４つ」といわれても困ってしまう、、、。 下記はサンプルの一例ですので、質問者の答えになっているかはわからないのであしからず。追加の質問には答えません。 テーブル名：T_Sample フィールド名：下記の５つ ID（オートナンバー型） 商品名（テキスト型） 金額（数値型） 納品日時（日付型） 備考（テキスト型） フォームのテキストボックス名以下４つ（フォーム名は適当でOK） フォーム自体は1行１レコードの複数のアイテムを扱うフォームで表示を前提 フォームヘッダーに以下の４つのテキストボックスを配置 TXT_商品名（書式設定無し） TXT_金額（書式数値で設定） TXT_納品日時（書式日付で設定） TXT_備考（書式設定無し） ボタンは１つ BTN_検索（イベントプロシージャ＞クリック時を設定） 以下ボタンのプロシージャに以下を記述 Private Sub BTN_検索_Click() Me.RecordSource = "select * from T_Sample " _ & "Where 商品名 Like '*" & Me!TXT_商品名 & "*' " _ & "And 金額 Like '" & Me!TXT_金額 & "' " _ & "And 納品日時 Like '*" & TXT_納品日時 & "*' " _ & "And 備考 Like '*" & TXT_備考 & "*' Order by ID;" End Sub 数字以外は「あいまい検索」になっています。（「金額」にもLikeを使っているというとこは深く突っ込まないで、、、） 検索時に４つの条件を満たしたものを表示させるというのは、「And」を使います。もちろん、「金額」のところに他の条件に入っている「＊」を同じように追加すれば、金額もあいまい検索（数値のあいまい検索などめったにしませんが）もできます。 なお、「＊」を削除すれば4つの項目が完全一致しないと（ひとつでも間違いや空欄があると）ヒットしないという、絞込みもできますが検索ってのは見つけたいから探すので、文字列はあいまい検索を使うのが一般的だと（私は）思います。 日付に「＊」をつけているのはテキストボックスが空欄だった場合に、「すべての条件」として日付が空欄でも、入ってても引っかかってくれるようにする、、、やさしさ、だと思っています。 なお、Me.Recordsource以降の文章はSQL記述なので、わからない場合はクエリを作ってSQLでプレビューすると、知識がなくてもある程度は作成できます。VBAの文章内に放り込む場合はちょっと癖があるので、その辺は書籍などを1冊購入して勉強してください。ネットで相談したり、検索するよりそっちのほうが理解が早いです。 まぁ、かく言う私もそれほど詳しいわけじゃないので、 間違ってたら誰か他のやさしい人、突っ込んでください。
状況がよく分かりません。 一旦読み込んだレコードセットは途中で更新しても 再読込しないかぎり並び順がかわることはないです。 もう少し具体的にやっていること、 どのような検索条件でどのような更新をしているかを説明 してください。 あるいは、実際のコードを提示したほうが間違いを指摘しやすいですね。 以下はアドバイスですが 通常は、 検索条件にあうレコードを更新する場合、 FindFirst, FindNext で更新するより、 開くときに抽出条件を設定して開いて、 全件更新するほうが効率的で高速です。 可能なら更新クエリで更新するのが一番高速です。
たぶん2007以降の下記の問題だと思いますが、 残念ながらズバリの解決方法が無く、 自分で微調整するしかなかったと思います。 Access 2007 で直線を含むレポートやフォームのセクションの高さが、直線の配置により増加することがある https://support.microsoft.com/ja-jp/kb/932492
何も書いてないのでACCESSでの話とします。 すべてのテーブルを定義し、選択クエリを作成します。 それをSQLビューで表示すれば求める回答になります。 ①②③は、 SELECT 表示するフィールド名1,表示するフィールド名2 FROM テーブル名 WHERE 抽出条件 ④は、 値引テーブルを使い、商品番号をグループ化、値引率の平均（集計関数）を使います。 ⑤は、 商品と注文口と顧客を結合し、商品番号に123があれば抽出し、顧客番号と顧客名をグループ化して表示する。 ⑥値引と注文口と注文を結合し、25%値引きを抽出し、該当する注文をグループ化して表示する。
気になるのは、現状のリーダーで制御文字が含むデータを読み込むことができますか？ メーカー、機種にもよりますが、出来るのであれば 読み込んだ文字列を1文字ずつ調べ、制御文字であればそれまでの文字列を区切って 配列やテキストボックス等に入れる。 制御文字じゃなければそのままループさせる。 というやり方をすれば処理できると思います。 例としてですが以下のページに文字列から制御コードを除去する方法が 記載されています。 http://tsware.jp/tips/tips_406.htm これを改変すればお望みの処理が可能かと。
「期」フィールドはテキスト型で、「前期」「後期」というデータが入っているとします。 人グループヘッダーのテキストボックスのコントロールソースを下記のようにしてください。 前期小計 =Sum(IIf([期]="前期",[金額],0)) 後記小計 =Sum(IIf([期]="後記",[金額],0))
実数値での誤差かと思うので･･･ 重さ、重量下限、重量上限 のデータ型は何になっていますか？ 通貨型なら、小数点以下 4 桁までの精度 を持つので、 可能なら通貨型に変更します 変更不可なら、小数点以下３桁までを文字列にして比較する？ Format(重量, "0.000") BETWEEN Format([T_送料]![重量下限], "0.000") AND Format([T_送料]![重量上限], "0.000") 整数部分が１桁以上もあるのなら、文字列比較はおかしくなるので･･･ 1000 倍して小数以下を切り捨て比較する？ INT(重量*1000) BETWEEN INT([T_送料]![重量下限]*1000) AND INT([T_送料]![重量上限]*1000) 元々の値を 1000 倍して持つ？
> 番号テーブルを作って、 > 指定回数を増やすまではどうにかできたことも なら、もう少しと思います 日付･･･日付型とすると 日付+回数-1 で日付が出来上がります 以下例） 連番用テーブルが T連番 で、連番フィールドだけ 1 ～ 10 程度入っているとします 以下をクエリの SQLビューに記述してみます （元のテーブル名を ★★ と仮定） SELECT 番号, 種別, 名称, ★★.日付+連番-1 AS 日付, 分類番号 FROM ★★, T連番 WHERE 連番<=3 ORDER BY 番号, 連番;
下記で手動とＶＢＡの両方で解説されています。 データシートの列幅をまとめて調整する方法 http://tsware.jp/tips/tips_563.htm
汎用系のコンピュータの出力データ(20160705)をACCESSの日付時/刻型に変換するには、 すでに数値型で入っているテーブル1とは別に日付/時刻型のフィールドを定義したテーブル２を用意して、 テーブル１を元にした追加クエリを作成し、フィールド上で 項目名2:CDate(Format([項目名],"@@@@/@@/@@")) を入力し、追加先にテーブル2の項目名とすればできます。 Format関数で20160705が2016/07/05という文字列に変換され、 CDate関数でACCESS内部で扱う日付/時刻型の値に変換されます。
2016のダウンロード版が14000円程度でしたね。 で、古いバージョンのプロダクトキー版が2013で６００００円程度。 Office2016はOffice365の最新バージョンです。 Office365は「ネット上でOfficeの利用できるクラウドサービス」です。つまりネットが使えないと利用できない。 Office2013はOfficeの最新バージョンです。PCにインストールして使います。 でも、今回の物はプロダクトキー版つまり、インストールに必要な情報しかなく、インストール用のDVDを別途準備するか、インターネットからダウンロードする必要が有ります。つまりネットにつながっていないとどちらも利用できない。 つまり、どっちもネットが無いと利用できないんですね。最近のバージョンはフルパッケージ売ってないのかなぁ。家電量販店にでも行くしかないですね。
Null を検索するときの条件式は、=演算子ではなく、Is演算子を使います。 条件式例 フィールド名 Is Null 希望のことが、コンボ●● が未入力の場合は、Nullのレコードを抽出したいということなら、下記のようにしてください。 Dim stFilter As String If IsNull(Me![コンボ●●].Value) = True Then stFilter = "送付先番号 Is Null" Else stFilter = "送付先番号 = " & Me![コンボ●●].Value End If Me.Filter = stFilter Me.FilterOn = True
> ・・・テム\QA検査画像」フォルダ なら ・・・テム\QA検査画像" & "\" & [詳細検索フォーム]![詳細画像ID] と "\" を間に入れるとか？ ※ 環境テーブルとか持って フィールド ID, 項目1 ・・・ で、ID=1 の 項目1 に \123.456.78.90\・・・テム\QA検査画像\ を入れておいて Me!詳細画像検索イメージ.Picture = _    DLookup("項目1","環境テーブル","ID=1") _    & [詳細検索フォーム]![詳細画像ID] & ".JPG" とかしてみるとか･･･ 画像の置き場が変わっても、テーブル内の変更だけで VBA には影響なし･･･ってのは、どうでしょうか･･･???
[Forms]![詳細検索フォーム]![詳細開封不良内容]=[開封不良内容] Or [Forms]![詳細検索フォーム]![詳細開封不良内容]=[開封不良内容2] でしょうか？
回答し直してます 返信内容 2016/07/12 07:20:24 ～～～～ VBAは勉強を始めたばかりです。見栄を張ってほとんどという表現をしてしまいました^_^; 詳しいご解説ありがとうございます。まさに写真のフォーム画面のようなものをイメージしていました。 >返信いただければ、フォームの設定・VBA 記述を提示しますが･･･ 是非お願いします。 ちなみに登録ボタンで本チャンテーブルに移行までご教示頂けると尚嬉しいです。 ～～～～ 以降 2007 にて確認した作成手順等記述しますが、動作確認用なので･･･ 実際に使えるものにするには、エラー処理・入力チェック処理等盛り込まなくては････ > VBAは勉強を始めたばかりです ではハードルが高いかも？･･･でも、頑張ってください 確認・作成手順（ 2007 にて ） ・新規 accdb を開きます ・登録確認用テーブルを作成 テーブル名： T65 フィールド情報 an：オートナンバ 項目11：数値型 項目12：テキスト型 項目13：テキスト型 ・フォームデザインからフォームを開きます プロパティで変更するもの   ポップアップ：はい   レコードセレクタ：いいえ   移動ボタン：いいえ ・リストボックスの配置（ラベルは削除） プロパティで変更するもの   名前： lst1   列数： 4   列幅： 0;1.5;2;2   列見出し：はい   幅： 6cm   高さ： 7cm   立体表示：影付き ・テキストボックスの配置 テキストボックス３つを配置し、名前を上から txt1 / txt2 / txt3 txt1 の書式を数値に 各ラベルの標題を 項目1 / 項目2 / 項目3 へ変更 ・コマンドボタン３つ ボタンの名前を上から btn1 / btn2 / btn3 へ変更 標題を 追加 / 削除 / 登録 へ変更 btn1 のプロパティ クリック時 を [イベント プロシージャ] に変更後、右横の[･･･] クリック すると Private Sub btn1_Click() End Sub の表示になると思います その画面、上側のメニューから「ツール」→「参照設定」を開き Microsoft ActiveX Data Objects x.y Library にチェック入れ （過去バージョン用に変換することがあるので、x.y は 2.5 にしてました） 数字の大きい方を指定しておけば･･･ Private Sub btn1_Click() End Sub この表示があるところ全部以下に置き換え Option Compare Database Option Explicit Dim rs As ADODB.Recordset Dim iNum As Long Private Sub Form_Load()    Set rs = New ADODB.Recordset    With rs       .Fields.Append "ID", adInteger       .Fields.Append "項目1", adInteger       .Fields.Append "項目2", adVarWChar, 255       .Fields.Append "項目3", adVarWChar, 255       .CursorLocation = adUseClient       .CursorType = adOpenKeyset       .LockType = adLockOptimistic       .Open    End With    Set Me.lst1.Recordset = rs End Sub Private Sub btn1_Click()    Dim i As Long    rs.AddNew    iNum = iNum + 1    rs("ID") = iNum    For i = 1 To 3       rs("項目" & i) = Me("txt" & i).Value    Next    rs.Update    Set Me.lst1.Recordset = rs    Me.txt1 = Me.txt1 + 1 End Sub Private Sub btn2_Click()    With Me.lst1       If (.ListIndex < 0) Then Exit Sub       rs.AbsolutePosition = .ListIndex + 1       rs.Delete       Set .Recordset = rs    End With End Sub Private Sub btn3_Click()    Dim cn As ADODB.Connection    Dim rsTo As New ADODB.Recordset    Dim i As Long    If (rs.RecordCount > 0) Then       Set cn = CurrentProject.Connection       rsTo.Open "T65", cn, adOpenForwardOnly, adLockOptimistic       rs.MoveFirst       While (Not rs.EOF)          rsTo.AddNew          For i = 1 To rs.Fields.Count - 1             Select Case rs(i).Name                Case "項目1": rsTo("項目11") = rs(i)                Case "項目2": rsTo("項目12") = rs(i)                Case "項目3": rsTo("項目13") = rs(i)             End Select          Next          rsTo.Update          rs.Delete          rs.MoveNext       Wend       rsTo.Close       Set cn = Nothing    End If    Set Me.lst1.Recordset = rs End Sub ・フォームを保存し、表示/操作してみます ※ 追加ボタンを押す場合は、入力チェックしていないので、テキストボックスに値を入れてから･･･ VBA 記述でやっていること（大雑把に） データを蓄える ADO の Recordset および データ順の採番用 が、どの関数からでも見れる様に > Dim rs As ADODB.Recordset > Dim iNum As Long フォームの読み込み時に、データ蓄え用の Recordset を作成し、 >      .Fields.Append "ID", adInteger >      .Fields.Append "項目1", adInteger >      .Fields.Append "項目2", adVarWChar, 255 >      .Fields.Append "項目3", adVarWChar, 255 リストボックス lst1 に設定 リストボックスの連結列は 1 になっており、行で重複しないようにし、 採番したものを Access さんに見せて、その採番以降を表示･･･ 今回、表示したいものは 3 つ + 採番用１つなので >  列数： 4 >  列幅： 0;1.5;2;2 追加ボタンが押されたら、 採番値を更新し、テキストボックスから Recordset に蓄え それをリストボックスの Recordset に設定 削除ボタンが押されたら、 リストボックスで選択されたものがあったら、 位置を特定して削除後、リストボックスの Recordset に設定 登録ボタンが押されたら、 データを蓄えていたら、テーブルを開いて 覚えていたデータ先頭から、追加処理 追加したら覚えていたデータは削除して･･･ 処理終わったら、リストボックスの Recordset に設定 今回、フォームでデータを蓄える時/テーブルのフィールド名を違うものにしていました もし、同じ文字列（項目1、項目11 等）を使っていたら >         For i = 1 To rs.Fields.Count - 1 >            Select Case rs(i).Name >               Case "項目1": rsTo("項目11") = rs(i) >               Case "項目2": rsTo("項目12") = rs(i) >               Case "項目3": rsTo("項目13") = rs(i) >            End Select >         Next ↓          For i = 1 To rs.Fields.Count - 1             rsTo(rs(i).Name) = rs(i)          Next で ※ > Case "項目1": rsTo("項目11") = rs(i) これは、フォームで覚えていた 項目1 は、本チャンテーブルの 項目11 へ ※ For i = 1 To rs.Fields.Count - 1 通常は、For i = 0 To rs.Fields.Count - 1 と、For 始りは 0 からですが、 リストボックス連結列用の ID は対象外なので、1 始りで･･･ ※ リストボックス部分を、帳票のサブフォームを埋め込む方法でも同様の方法で可能です なお、添付画像は、登録ボタンを追加したものに変更しました ※※ 上記手順でやってみた結果を教えてください 以下、初期回答 2016/7/11 12:50:57 > VBAはほとんど使えません。 どの程度でしょうか？ VBA であれば、チョイで出来るのですが･･･ 概要だけ説明すると > リストボックスにデータを蓄積する データは、ADO の Recordset で蓄えます 通常の Recordset ではなく、テーブル/クエリに関連付けていないもので･･･ リストボックスへの表示は、 リストボックスが持っている Recordset に、 データを蓄えた Recordset を Set する方法になります データは Recordset に蓄えるので、 本チャンテーブルへの追加は、Recordset 同士の代入でいけると思います 一応、動作確認してみたフォーム画面を添付します このフォームで、 本チャンテーブルへの追加処理がない状態の記述量は、40 行もありません 追加ボタンで、データを蓄え、リストボックス表示に･･･ 削除ボタンで、リストボックスで選んでいた行を削除･･･ 返信いただければ、フォームの設定・VBA 記述を提示しますが･･･
「読みとる」ことならリーダー側の設定になりますが、 「読み取り後の妥当性チェック」であればACCESSになります。 先頭からの8桁が決められた値と同じかどうかを確認するとしたら、 更新前処理イベントで下記のように記述します。 Private Sub バーコード_BeforeUpdate(Cancel As Integer) If Left(Me![バーコード], 8) <> "12345678" Then Cancel = True MsgBox "先頭8桁が12345678ではありません" Exit Sub End If End Sub
そりゃ欲しい結果が複数テーブルわたっていたら、必須でしょうね。
文字列を計算式に変換する方法では有りませんが、 クエリのフィールドに計算式を書く事ができる事はご存知ですか？ テーブルのフィールド名として[個数]と[単価]が有れば クエリのフィールドに 金額:(([個数]-1)×[単価])+300 のようにすれば計算可能です。
私ならこんな感じで作ります。 メインの非連結コントロールを抽出条件に入れた選択クエリを サブフォームのレコードソースにします。 ┌───────────────────── │メイン │ │カテゴリ[........|▼] │材料[...........] [検索] │ │┌──────────────────── ││サブ ││ ││抽出結果表 ││ ││ ハイパーリンクは Yahoo#http://www.yahoo.co.jp/# もしくは http://www.yahoo.co.jp/#http://www.yahoo.co.jp/# という感じの文字列(別名#URL#)にしてから取り込むとどうなりますか？
入力フォームでのチェックであれば、 JANコードを入れるテキストボックスの更新前処理で、 下記のように記述します。 Private Sub JAN_CODE_BeforeUpdate(Cancel As Integer) If DCount("*", "商品マスター", "ＪＡＮコード='" & Me![JAN_CODE] & "'") = 0 Then Cancel = True MsgBox "このコードは商品マスターに登録されていません(" & Me![JAN_CODE] & ")" Exit Sub End If End Sub ※「ＪＡＮコード」は商品マスタのフィールド名、「JAN_CODE」は入力フォームのコントロール名になります。
メールサーバーと接続するアドレスとかパスワードがＶＢＡのプログラムの何処かに有ると思います。 （優秀なデータベース管理者なら変更する事を見越して、テーブルにしているかも知れません。） 探して変更するしか無いと思います。 ＞旧サーバーを再度契約 に付いては完全に前と同じ（アドレスとかパスワード）で無ければ意味が有りません。 同じに出来ますかネ？ アドレスは出来てもパスワードは難しい気がします。
コマンドボタンの「ハイパーリンク」プロパティを下記のように設定してください。 ="情報フォルダのパス" & [名前] & ".PDF" これで関連付けられたアプリケションでPDFファイルが開きます。 ＶＢＡを使うなら、[情報]ボタンのクリック時のイベントプロシージャを下記のように記述してください。 Private Sub 情報_Click() Application.FollowHyperlink "情報フォルダのパス" & Me.名前 & ".PDF" End Sub
検索するとこれが。 http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1410753359...
>Access2013を立ち上げ、空のデータベースを作る際に保存場所を選択する際、 >ファイルの種類のプルダウンにバージョンを選択できるようなのですが >それで問題ないでしょうか？ はい、それでOKです。 ＞通信を用い MDBをそのまま電子メールで送るとメールサーバの拡張子のチェックで送れない場合がありますので、そのときは拡張子をmdbからmd_に変更し添付すると遅れます。 容量の問題があれば、さらに圧縮してから添付することになります。 受け取った相手側では、解凍後、拡張子をmdbに戻してから開きます。
Excel のデータを Access 2007 に取り込む方法を 再確認したらどうですか(・・? ただインポートではエラーになりますよ。
そのような質問の場合、該当URLか、該当部分のHTMLソースが分からないことには、正確な回答はできません。 そもそもエクスポートボタンというものの外見すら説明していませんので、ますます対応が難しいです。 まずは、必要な情報の開示をお願いします。
以下でどうなりますか 前提条件 テーブル名：★★ フィールド名：項目、数値 用意するもの 連番用テーブル テーブル名：T連番 フィールド名：連番（数値型） １～ 20 程度入れておく ※ 20 までなら 200 までをサポート クエリの SQLビュー に以下を記述して表示してみます SELECT Q1.項目, IIF(Q1.項目<>"A", Q1.数値, IIF(Q2.連番*10<=Q1.数値,10,Q1.数値-(Q2.連番-1)*10) ) AS 数値 FROM ★★ AS Q1, T連番 AS Q2 WHERE IIF(Q1.項目<>"A",Q2.連番=1,Q2.連番<=(Q1.数値-1)\10+1) ORDER BY Q1.項目, Q2.連番;
２つに分けた場合でもクエリで１つにする事も出来ますし １つの場合でもクエリで２つに分ける事も出来ます。 どちらでも良いです。 テーブルのメモリ効率を重視するなら２つに分けるですが データを入力する等の使いかって（いちいちテーブルの切替が必要になる）を重視するなら１つの方が良いです。
VBAが出来るのなら http://hatenachips.blog34.fc2.com/blog-entry-17.html http://www.accessclub.jp/bbs3/0181/superbeg59774.html
> カウント対象リストがない場合は、0（ゼロ）を出したいのです。 回答そのままで 0 がでると思いますが･･･ > CLNG(NZ( Count(Q_123.リスト名)、0） AS 件数 ) が1つ少ない上記に変更した意図は何なのでしょう？
回答し直してます > 親 → 子 → 孫 ･･･の１本道になっていて、 > 返信にあった様な、 > 親 → ２つの子 → その内１つに孫 > には対応できてなかったです 返信 2016-07-09 21:41:23 の内容 ～～～ 親ﾃｰﾌﾞﾙ：親ID(オートナンバー)、親登録ID(数値型:重複なし)、親名前(テキスト型)、登録日(日付型) 子ﾃｰﾌﾞﾙ1：子1ID(オートナンバー)、親参照ID(数値型)、子1名前(テキスト型)、子1数量(数値型) 子ﾃｰﾌﾞﾙ2：子2ID(オートナンバー)、親参照ID(数値型)、子2使用日(数値型)、子2備考(テキスト型) 孫ﾃｰﾌﾞﾙ：孫ID(オートナンバー)、子2参照ID(数値型)、孫名前(テキスト型)、孫数量(数値型) 親の複製と同時にやりたいこと ①親登録IDに複製時＋１する。 ②複製した方に親名前に”コピー”を付けそのフォームに移動。 ～～～ ということで、情報の提示があったので修正してみました 以下の Samp2 でどうなりますか 関数名等は前回のものと同じですが、引数とか変更しています 親テーブル処理が特殊なので、それ以降とで分けて処理してみました Option Compare Database Option Explicit Public Sub Samp2()    Dim vTbl As Variant, vTblC As Variant    Dim rs As ADODB.Recordset    Dim i As Long, j As Long, iNewID As Long    vTbl = Array("親ﾃｰﾌﾞﾙ", "親ID", "親ID")    vTblC = Array( _             Array( _                Array("子ﾃｰﾌﾞﾙ1", "子1ID", "親参照ID") _             ), _             Array( _                Array("子ﾃｰﾌﾞﾙ2", "子2ID", "親参照ID"), _                Array( _                   Array("孫ﾃｰﾌﾞﾙ", "孫ID", "子2参照ID") _                ) _             ) _          )    i = 2 ' コピーする親ID    Set rs = RecOpen(vTbl, i)    If (Not rs.EOF) Then       With rs.Clone          .AddNew          For j = 0 To rs.Fields.Count - 1             Select Case rs(j).Name                Case vTbl(1)                Case "親登録ID"                   .Fields(j) = rs(j) + 1 '                  .Fields(j) = DMax("親登録ID", vTbl(0)) + 1                Case "親名前"                   .Fields(j) = rs(j) & " コピー"                Case Else                   .Fields(j) = rs(j)             End Select          Next          .Update          iNewID = .Fields(vTbl(1))          .Close       End With       For Each vTbl In vTblC          Call ChainCopy(vTbl, i, iNewID)       Next    End If    rs.Close ' iNewID に複製後の親ID が入っているので、 ' Form を Requry 後、Me.Recordset に FindFirst すればそこが表示･･･ End Sub Private Sub ChainCopy(vTblC As Variant, iOld As Long, iNew As Long)    Dim rs As ADODB.Recordset    Dim vTbl As Variant    Dim i As Long, j As Long, iNewID As Long    vTbl = vTblC(0)    Set rs = RecOpen(vTbl, iOld)    For i = 1 To rs.RecordCount       iNewID = OneCopy(rs, vTbl, iNew)       For j = 1 To UBound(vTblC)          Call ChainCopy(vTblC(j), rs(vTbl(1)), iNewID)       Next       rs.MoveNext    Next    rs.Close    Set rs = Nothing End Sub Private Function RecOpen(vTbl As Variant _                   , iOld As Long) As ADODB.Recordset    Dim cn As ADODB.Connection    Dim rs As ADODB.Recordset    Dim sSql As String    Const CSQL As String = _       "SELECT * FROM {%1} WHERE {%2} = {%3} ORDER BY {%4};"    Set cn = CurrentProject.Connection    Set rs = New ADODB.Recordset    sSql = CSQL    sSql = Replace(sSql, "{%1}", vTbl(0))    sSql = Replace(sSql, "{%2}", vTbl(2))    sSql = Replace(sSql, "{%3}", iOld)    sSql = Replace(sSql, "{%4}", vTbl(1))    rs.Source = sSql    rs.Open , cn, adOpenStatic, adLockOptimistic    Set RecOpen = rs    Set cn = Nothing End Function Private Function OneCopy(rs As ADODB.Recordset _                   , vTbl As Variant _                   , iFixVal As Long) As Long    Dim iNewID As Long, i As Long    If (rs.EOF) Then Exit Function    With rs.Clone       .AddNew       For i = 0 To rs.Fields.Count - 1          Select Case rs(i).Name             Case vTbl(1)             Case Else                .Fields(i) = rs(i)          End Select       Next       .Fields(vTbl(2)) = iFixVal       .Update       iNewID = .Fields(vTbl(1))       .Close    End With    OneCopy = iNewID End Function 以下は初期回答 2016/7/5 08:34:44 過去に以下で回答していたのですが サブのサブも含めたレコードのコピー http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1214486428... フォーム上でどのような表示構成になっているかわかりませんが、 レコードを辿った再帰処理でグルングルン回れば良いと思います 処理概要として 親のレコードをコピーします その結果、（IDの）旧値・新値を下位のテーブル処理に回します 下位では、旧値で抽出し、コピーします コピーする際、上位の新値を埋め込みます その結果、（IDの）旧値・新値を下位のテーブル処理に回します これの繰り返し･･･ > Array("子ﾃｰﾌﾞﾙ", "子ID", "親参照ID", "親参照ID") これの意味合いは、 １つ目：テーブル名 ２つ目：採番するフィールド名 ３つ目：旧値で抽出する時のフィールド名 ４つ目：上位からの新値を設定するフィールド名 基本的に３つ目、４つ目は同じですが、 最上位の親テーブルでは、上位の新値がないため 設定するしないを、４つ目が Null かで判別･･･ 今回、採番するフィールドはオートナンバなので、 コピー時に値を代入しないように･･･ Option Compare Database Option Explicit Dim vTbl As Variant Public Sub Samp1()    Dim i As Long    vTbl = Array( _             Array("親ﾃｰﾌﾞﾙ", "親ID", "親ID", Null), _             Array("子ﾃｰﾌﾞﾙ", "子ID", "親参照ID", "親参照ID"), _             Array("孫ﾃｰﾌﾞﾙ", "孫ID", "子参照ID", "子参照ID") _          )    i = 2 ' コピーする親ID    Call ChainCopy(0, i, 0) End Sub Private Sub ChainCopy(iNst As Long, iOld As Long, iNew As Long)    Dim rs As ADODB.Recordset    Dim i As Long, iNewID As Long    Set rs = RecOpen(iNst, iOld)    For i = 1 To rs.RecordCount       iNewID = OneCopy(rs, iNst, iNew)       If (iNst < UBound(vTbl)) Then          Call ChainCopy(iNst + 1, rs(vTbl(iNst)(1)), iNewID)       End If       rs.MoveNext    Next    rs.Close    Set rs = Nothing End Sub Private Function RecOpen(iNst As Long, iOld As Long) As ADODB.Recordset    Dim cn As ADODB.Connection    Dim rs As ADODB.Recordset    Dim sSql As String    Const CSQL As String = _       "SELECT * FROM {%1} WHERE {%2} = {%3} ORDER BY {%4};"    Set cn = CurrentProject.Connection    Set rs = New ADODB.Recordset    sSql = CSQL    sSql = Replace(sSql, "{%1}", vTbl(iNst)(0))    sSql = Replace(sSql, "{%2}", vTbl(iNst)(2))    sSql = Replace(sSql, "{%3}", iOld)    sSql = Replace(sSql, "{%4}", vTbl(iNst)(1))    rs.Source = sSql    rs.Open , cn, adOpenStatic, adLockOptimistic    Set RecOpen = rs    Set cn = Nothing End Function Private Function OneCopy(rs As ADODB.Recordset, iNst As Long, _                      iFixVal As Long) As Long    Dim iNewID As Long, i As Long    If (rs.EOF) Then Exit Function    With rs.Clone       .AddNew       For i = 0 To rs.Fields.Count - 1          Select Case rs(i).Name             Case vTbl(iNst)(1)             Case Else                .Fields(i) = rs(i)          End Select       Next       If (Not IsNull(vTbl(iNst)(3))) Then          .Fields(vTbl(iNst)(3)) = iFixVal       End If       .Update       iNewID = .Fields(vTbl(iNst)(1))       .Close    End With    OneCopy = iNewID End Function
下記で解説されています。 三流君は私からみると一流ですが、解説に余談が多いです。 しっかり最後まで読めば判ると思います。 Access Form TextBoxの.SelLength .SelStartプロパティ http://www.ken3.org/vba/backno/vba065.html
作成した選択クエリを元にフォームを作成すれば、フォームCは普通にできます。 テーブルを元にするのではなく、選択クエリを元にします。
クエリで表示する･･･でも良いですか？ > 黄色の部分のデータは、一営業日前の商品の値段 20160108 の バナナ が 120 ということは、 20160106 に無く 20160105 の値段を持ってきている･･･ 過去、直近日付の値段を拾う？ クエリのSQLビューに以下を記述して表示してみます SELECT Q1.*, Q2.値段 AS 前日の値段 FROM テーブル１ AS Q1 LEFT JOIN テーブル１ AS Q2 ON Q1.商品番号=Q2.商品番号 AND Q1.日付>Q2.日付 WHERE Q2.商品番号 Is Null OR Q2.日付 = (SELECT Max(日付) FROM テーブル１ WHERE 商品番号=Q1.商品番号 AND 日付<Q1.日付); ※ この結果では、 20160108 の りんご の前日の値段は 110 になります やっていることは、 テーブル１ 自身を、同じ商品番号の以前の日付と結び付け 以前の日付がないか、または、以前の日付の最大日付に絞って･･･ 余談） 上記の考え方を前回ご質問に応用してみると SELECT Q1.日付, Q1.商品番号, Q1.商品, Max(Q2.販売数) AS 販売数新記録 FROM テーブル１ AS Q1 LEFT JOIN テーブル１ AS Q2 ON (Q1.商品番号=Q2.商品番号) AND (Q1.日付>=Q2.日付) GROUP BY Q1.日付, Q1.商品番号, Q1.商品; テーブル１ 自身を、同じ商品番号のその日を含む以前の日付と結び付け Q1 側でグループ化して、その日を含む以前の販売数最大を･･･ その日の販売数が過去最大と同じだったら NEW を表示するには （タイ記録でも NEW になりますが） SELECT Q1.日付, Q1.商品番号, Q1.商品, Max(Q2.販売数) AS 販売数新記録, IIF(First(Q1.販売数)=販売数新記録,"NEW") AS 更新 FROM テーブル１ AS Q1 LEFT JOIN テーブル１ AS Q2 ON (Q1.商品番号=Q2.商品番号) AND (Q1.日付>=Q2.日付) GROUP BY Q1.日付, Q1.商品番号, Q1.商品; ※ ３行目に判別処理を追加しただけ･･･ ※ 最小日付 20160105 にも NEW が表示されますが、表示したくない･･･なら Count(*) > 1 とかの判別した後にするとか･･･ IIF(Count(*)>1,IIF(First(Q1.販売数)=販売数新記録,"NEW")) AS 更新
画像が小さくて説明がどこを指しているのか全く見えませんが、 型式IDと点検周期毎に使用する部品の一覧データを用意しておいて、 0001__Part1__5 0001__Part2__2 0002__Part1__3 0002__Part3__1 : 該当するデータを抽出し、サブフォームのレコードソースとなるテーブルに追加する必要があります。 追加後に再クエリでサブフォームに表示されるようになります。
＞①差引残高の表示の仕方。 ＞ 上の残高＋売上金額ー受入れ金額を表示したいのですが、 ＞ どのようにしたらいいかわかりません・・・。 ＶＢＡを使う必要があります。 T_台帳入力に差し引き残高の列も追加しておいて、 選択クエリでで日付(昇順)＋品名(昇順)＋取引先(昇順)に並べて、 １行目から順に差引残高=(残高)＋売上金額－受入れ金額を順に計算し、 セットします。 この結果を売上帳に印字することになります。 ＞②1行めに、前期繰り越しや、前月繰り越しといったように、 ＞入力できるようにしたいです・・・。 ①の処理の前にフォーム上に入力しておいて、T_台帳入力の先頭行に セットすることになります。 ＞③また、コクヨの売上帳の枠に合わせて印刷したいのですが、 ＞リング穴のある関係で、表と裏とで、開始位置がかわります・・・。 ＞何か良い対処方はございませんでしょうか？？ 専用紙を使わずに、汎用紙上に印字してはどうですか？ その場合に表裏の双方に印字するのであれば、左右余白を確保して 中央に印字することになります。
商品情報の商品コードに主キーが設定されていますか？ また、クエリ上のJANコードはデータTBL側になります。 データTBL........商品情報 JANコード(∞)------(1)JANコード .............................商品名 .............................単価 フィールド:|JANコード|商品名...|単価....| テーブル名:|データTBL|商品情報|商品情報|
記述する順が違いますが、順次読んでいってください > ②場所Tを部分一致から前方一致にしたい。 strFilter = " AND 場所T Like '*" & Me.txt場所T & "*'" ↓ここで記述している左側の * を外します strFilter = " AND 場所T Like '" & Me.txt場所T & "*'" * は、文字があってもなくても良いですよ･･･っていう意味なので > ④Me.Filter = Mid(strFilter, 6)の意味がわからない。 順次条件が入力されていると、出来上がる内容は " AND ・・・・ AND ・・・・ AND ・・・・" となるので 先頭からの " AND " を削除して "・・・・ AND ・・・・ AND ・・・・" 条件が記述されていない状態 "" で、Mid で 6 文字目から･･･ エラーにはならずに "" が得られるので、共通処理にて 以下の様な記述の仕方もあります アクセス２００７のフォームでの複数条件での抽出 http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1015825463... > ③検索フォームと検索結果表示フォームを別にしたい 上記 URL での設定例箇所 >   Me.Filter = Mid(sS, Len(CANDOR) + 1) >   Me.FilterOn = Len(Me.Filter) > 0 は、以下とも書ける With Me    .Filter = Mid(sS, Len(CANDOR) + 1)    .FilterOn = Len(.Filter) > 0 End With この With Me 部分を他のフォームに変えてあげれば With Forms("検索結果表示フォーム名")    .Filter = Mid(sS, Len(CANDOR) + 1)    .FilterOn = Len(.Filter) > 0 End With > ①印刷プレビュー表示（レポートは作成済） ・・・& "' OR 場所T Like ・・・ と、 検索時の AND ではなくなっていますが？ ここに記述する条件は、Me.Filter に設定した内容と同じなので DoCmd.OpenReport "R_医療", acViewPreview, , Me.Filter とするとか･･･ もちろん、入手する Filter 情報が他フォームなら･･･ わかりますか？
為替レートの変換のテーブルも下記のように持つと後の処理が楽になります。 日付_________ 通貨______レート 2016/07/07___USD______104 2016/07/07___EUR______130 2016/07/07___GBP______150 2016/07/08___USD______103 2016/07/08___EUR______129 2016/07/08___GBP______149 ： 見づらければこれでもOK 通貨____日付____________レート EUR____2016/07/07______130 EUR____2016/07/08______129 : GBP____2016/07/07______150 GBP____2016/07/08______149 ： USD____2016/07/07______104 USD____2016/07/08______103 :
レポートのレコード出力順序は何で決定していますか？ レポートの機能「並べ替え/グループ化」を利用しないと想定外の順序で出てくる場合があります。
アプリをとって（xboxの）アカウント作ってみればいかがでしょうか。それからアプリでサインインしてみましょう。 ちなみにとおくの人と通信ができますが、30日間の無料体験を終えるとそこからは有料になってしまいます。そのことを考えるとUUUMのおしゃべりマルチがいいかと…。
正箱数と端数で別々のレポートを出すなら、クエリを基にしたクエリを作ればよいのではないでしょうか？ ・元のクエリから正箱数が0の品番を除いたレコードを抽出するクエリ(正箱数用) ・元のクエリから端数が0の品番を除いたレコードを抽出するクエリ(端数用) 正箱数分同じレポートを印刷するという部分はマクロなりVBAなりで実現するのが素直だと思います。
AccessのようなRDBMS(リレーショナルデータベースマネージメントシステム)の考え方、テーブル設計、結果の求め方を理解しきれていないのだと思います。 VBAマクロや他のプログラム言語とSQL(クエリ)の考え方はまるっきり違います。 他のプログラム言語はデータを1件ずつ処理しますが、RDBMSはデータを複数件一気に処理します。 一般的なAccess入門ではRDBMSとしてのAccessをあまり紹介していません。 なので、クエリをきちんと使う方法を学ぶのには向きません。 OracleやPostgreSQLの入門サイトを参考にして、RDBMS向けのテーブル設計や正規化について学ぶことをお勧めします。 SQL言語は方言が多く、OracleやPostgreSQL用のクエリでAccessでは動かないものも多いのであくまでも「考え方」を学ぶためのものと捉えてください。 クエリをうまく活用するにはテーブル設計とインデックスを理解する必要があります。 テーブル設計がヘボいとクエリを使おうとするととても複雑になり「何でこんなことやってるんだろう？」となると思います。 インデックスを使えないと無駄な処理時間が増える事になります。 ご質問の【やりたい事】の件ですが、「入力して」という部分はクエリでは実現できません。その部分はフォームなり、マクロなり、VBAなりで実現することになります。 顧客担当者マスタのテーブルですが、素直に設計する場合、 ・ID|担当者名|顧客ID (キーはID) ・顧客ID|枝番|担当者名 (キーは顧客ID,枝番) の様にするのが良いと思います。 (後者の場合は枝番の払い出しにオートナンバー型が使えない問題があります。) 応用としては、顧客ID-枝番の構成をIDとしてしまう方法があります。 (RDBMSを理解していない人だとやりがち。) ただし、この方法だと顧客IDで抽出する時にインデックス機能が働かず、抽出に時間がかかります。 【やりたい事】について、もし自分で設計・実装するなら 「顧客IDを入力すると、顧客社名がテキストボックスに、顧客担当者一覧がサブフォームに表示されるフォームを作成」という事にして、 ・顧客担当者マスタは ID|担当者名|顧客ID (キーはID) ・非連結フォームを用意する ・テキストボックスを顧客ID入力用、顧客社名表示用の２つ配置 ・顧客担当者マスタを元にクエリを作成 ・非連結フォームにクエリを基にしたサブフォームを追加 ・クエリの顧客IDの検索条件に顧客ID入力用を入れる ・顧客ID入力用の更新イベントに顧客社名表示用に顧客社名検索結果を入れる処理 (VBAのDlookup等を使用) ・顧客ID入力用の更新イベントにサブフォームのリクエリを追加 こんな感じにすると思います。
2007からの機能なので2003には無いです。 名前順に並び替えて探したり、最近作ったものであれば作成日の降順に並べたりして探してました。
レポートのレコードソースのクエリに以下の２つのフィールドを追加して活用する。 表示顧客名 : IIf(Nz([変更後の顧客名])="", [顧客名] , [変更後の顧客名]) 表示チェック : CBool(Nz([変更後の顧客名])<>"")
Private Sub テキストボックス1_DblClick(Cancel As Integer) MsgBox UBound(Split(Left(Nz(テキストボックス1.Text), テキストボックス1.SelStart), vbCr)) + 1 End Sub
＞番号に対応した項目が入力されるようにしています 本当にテーブルに”名称”で保存されていますか？
下記で解説されています。 エクセル 文字列を日付に変換する http://www.tipsfound.com/excel/02106
テーブルの詳細が不明ですが https://www.microsoft.com/japan/office/previous/xp/suminaka/access/... のような感じですか？ http://www.wanichan.com/pc/access/2010/5/19.html
C# Access で検索すればいろいろ見つかりますよ。 http://kageura.hatenadiary.jp/entry/2015/03/31/140132 これとかわかりやすいかも？
ACCESSだとフリーのテンプレートなどもあって、ゼロタイムでできてしまうことがあります。 売上管理ソフト for Access2010 http://www.vector.co.jp/soft/winnt/business/se501119.html
クエリー（SQL)では無理ですね。 Recordset取得して、グルグル回すしかないでしょう。 しかし、思った通りの並びになるとは限りませんね。
> 1N0001-1 > 1N0001-10 > 1N0001-2 これをきれいに並べるには、"-" 区切りの･･･ 左側の昇順、右側を文字→数値にした昇順を指定すれば･･･ "-" 区切りの何個目？を求めるユーザ定義関数を作って利用します 標準モジュールに以下を記述します Public Function CutMoji(vSrc As Variant, iNum As Long _             , Optional sSep As String = "-") As String    On Error Resume Next    CutMoji = Split(vSrc, sSep)(iNum - 1) End Function 使い方は CutMoji(文字列, 何個目, [区切り文字]) [区切り文字]：省略可（省略時 "-" ） クエリでは、SQLビューに以下の様に記述します SELECT * FROM テーブル名 ORDER BY CutMoji(数値,1), Val(CutMoji(数値,2)); "-" 区切りの１個目で昇順 その後、２個目を数値にしたもので昇順 例外として、"-" 区切り左側が１種類しかない場合 SELECT * FROM テーブル名 ORDER BY Len(数値), 数値; と、文字数昇順、文字列昇順でも
AcsDbQueryToXls はユーザー関数のようですがその中身に問題が有ると思われます。 今まで問題無く使えていたのなら、引数が間違っている可能性も有ります。
iOSの場合、時間表記が12時間(例 : 午前8:00 午後8:00)にしているなら、24時間(例 : 8:00 20:00)の表記に設定を戻すと出来ます。
前回の回答とほぼ一緒ですが 以下のSQLをエクセルVBAで実行したところ 「指 http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1016029176... なぜ GROUP BY しないのですか？
もしかしてＷｉｎ７や８．１からＷｉｎ１０にアップグレードしたＰＣでしょうか？ だとしたらＰＣ自体の異常ですのでＯＳのクリーンインストールしか無いと思います。
不一致クエリーでも作れば良いんじゃないですか。
Wb2.Save の後に wb2.close True するか Application.DisplayAlerts = False wb2.close True Application.DisplayAlerts = True のどちらかでいけると思います。
アクセスを使っているのですよネ テーブル名とフィールド名を正確に教えてください。
逆引き の意味がよくわかりません、クエリAもテーブルAを元に作成されているわけではない？別テーブルからと思い回答します。 テーブルBの 住所1 住所2 住所3 が 東京都、港区、赤坂*-*-* のように分かれているのですか？また、住所表記にずれはないですか? 「１丁目１－１」と「１－１－１」はアクセスなどソフト的には別物です。 住所で都道府県を省略ものもあって、そういったデータが無いか? なので、住所でするのは漏れが発生することがあります、そういった前提で テーブルBを元にクエリを作成 住所まとめ: Trim([住所1]) & Trim([住所2]) & Trim([住所3]) と 郵便番号 を表示する項目に設定、これを「Q_TblB」とでも適宜保存 これで、住所1 住所2 住所3 の 東京都、港区、赤坂*-*-* が 住所まとめ:東京都港区赤坂*-*-* のようにまとまります。 もう一つクエリを作成 クエリA と Q_TblB で クエリAの「住所」とQ_TblBの「住所まとめ」を結合 http://www.sk-access.com/syo_query/sqa010_ketsugou.html もしクエリAは全件表示するなら結合プロパティを設定、結合の線をダブルクリックして、「クエリAの全レコードと..」にチェック これで、クエリAのフィールド全部とQ_TblBの郵便番号を表示する項目に設定
デジタル放送番組を録画したDVDは、CPRMで著作権保護されています。 これらのメディアをコンピューターで再生するには、 下記の2項目に対応している必要があります。 ①光ディスクドライブがCPRMに対応している。 ②再生ソフトがCPRMに対応している。 PCのスペック表や利用している再生ソフトを確認し、対応していないならそれなりのものを見つけるか購入する必要があります。
http://tsware.jp/tips/tips_028.htm ただ、これだと右側の見出しが出力されないので http://hatenachips.blog34.fc2.com/blog-entry-199.html も参考にして下さい
受付ナンバーの更新前処理のイベントに下記のように記述して、 件数を確認して0件なら存在しないと判定します。 Private Sub 受付ナンバー_BeforeUpdate(Cancel As Integer) If DCount("*", "テーブル名", "受付ナンバー=" & Me![受付ナンバー]) = 0 Then Cancel = True MsgBox "該当受付ナンバーがありません(" & Me![受付ナンバー] & ")" End If End Sub
同時に4人が上限ならProで問題ないですよ。5人までOKです。Serverは高いので小規模ならうまく使いまわした方が良いです。 ちなみにServerはProも必要です。Advancedはデータビューア・デバック・カスタム関数により開発しやすくなるというだけです。 ３は自動的にDBに溜まっていくのでわざわざエクセルにする必要はありません。 ４について、管理者レイアウトと作業員レイアウトを分ければよいです。管理者レイアウトだけ出力機能を付ければよい？ 共有については共有フォルダとは関係ありませんFileMaker内で共有させます。共有設定していないとローカルネットワーク内でだれでも共有できてしまいます。
＞15/7/4開始で本日が16/7/4の場合は1年ではなく、11ヶ月とする計算にしています。 ＞1/1～12/31の期間であれば、本当は1年（12ヶ月）という計算結果になれば、なおいいのですが 矛盾する仕様だと思いますが、最初の方も1年（12ヶ月）にしてはダメなのですか？ ＞開始日から終了日、終了していない場合は現在までの経過年月を計算させています ”終了日”と言うフィールドが未登録の場合は今日の日付で計算すると言う事でしょうか？
サブレポートがあるなら、何らかグループ化できると思います。 なので、グループ化して改ページを挿入すればいいと思います https://support.office.com/ja-jp/article/Access-レポートに改ページ-コントロールを挿入する-86d2ea7d-7aa6-44f2-8507-23134a9a2e15
貴方のコードには無駄な処理が多いように思います。 下記で貴方が行いたい事の全てが解説されています。 ブックを開く http://officetanaka.net/excel/vba/file/file01.htm 参考 ＞指定のファイルが存在した場合は問題なく開けるのですが、ない場合ダイアログが出なかったり、出るときもあったりと動作がうまくいきません。ダイアログから選択できた場合も使用中のファイルとか出て読み取り専用で開きますかとかになったりします。 上記の現象は多分見えない状態（不可視）で該当するエクセルファイルが既に開いているのだと思います。 開く筈なのに開かない時は”タスクマネージャー”でエクセルが開いていないか確認してみてください。
パラメータを一度入力したら３つのクエリでその値を使って対象品目を抽出し、別のテーブルに追加するというものであれば、 フォーム上に 抽出対象品目[_________|▼] のようにコンボボックスまたはテキストボックスを配置し、 ３つのクエリの品目フィールドの抽出条件に Forms![フォーム名]![抽出対象品目] と記述すれば、それぞれのクエリはフォームの入力データを参照し抽出を行います。
フォームヘッダーとフォームフッター ではなく ページヘッダーとページフッター であるとか？
連結したフォームで選ばないという状態は無いはずです。 新規行に移動する事は出来ますが。
ＤＢの仕様に構築途中で変更が生じた場合にレコードソースの変更が必要なケースもあり得るため 詳しくは ・現在のＤＢのテーブルやクエリの仕様が変更され、それらの名前が変わった場合 ・SQLでレコードソースを定義していて、それに影響を及ぼす各名称や条件などの仕様が変わった場合 など
新しいクエリを作成し、デザインビューを右クリック > SQLビューに 以下をコピペ SELECT Q_データ.リスト名, Count(Q_123.リスト名) AS 件数 FROM Q_データ LEFT JOIN Q_123 ON Q_データ.リスト名 = Q_123.リスト名 GROUP BY Q_データ.リスト名;
MOS試験の場合は バージョンも記載しましょう！ ２０１３から内容が変わっていますので、 そんな事もあり得ると思います。
こちらを参考に Access 2010 のナビゲーションウィンドウの表示の幅が狭くなってしまった http://answers.microsoft.com/ja-jp/office/forum/office_2010-access/...
どなたも回答されないようなので、私も画像印刷以外はすぐに思いつきそうですが、作る時間が..ない 私なら代替え案として、ファイルリストのフリーソフトを使って一覧をCSVに http://www.vector.co.jp/magazine/softnews/030402/n0304024.html 画像の印刷は「XnView」でも使います。 http://forest.watch.impress.co.jp/library/software/xnview/ たぶん、工事台帳みたいなものを想定ですか? http://www.vector.co.jp/vpack/filearea/win/business/architec/photo/ フリーでエクセルのが多いですが、アクセスのもあるようです。（使ったことはないので、じしんで確認ください）
